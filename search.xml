<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ã€æ­¥éª¤å››ã€‘åˆ©ç”¨Rè¿›è¡Œæ•°æ®å¯è§†åŒ–åˆ†æ</title>
    <url>/posts/BigData-Case-Volume-Four/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç®€ä»‹ï¼šæœ¬æ–‡ç« åŸºäºå¦é—¨å¤§å­¦æä¾›çš„<a href="https://dblab.xmu.edu.cn/post/7499/">å¤§æ•°æ®è¯¾ç¨‹å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</a>ï¼Œé€šè¿‡ä½¿ç”¨ CentOS æ“ä½œç¼–å†™è€Œæ¥ã€‚å…·ä½“ä»‹ç»è¯·æ‰“å¼€é“¾æ¥è¿›è¡Œé˜…è¯»ã€‚</p>
<p><font color="red">è¿™é‡Œä»‹ç»å‡ ç‚¹å€¼å¾—ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ï¼š</font></p>
<p>1ã€å¯¹äºæ¡ˆä¾‹æ‰€æ¶‰åŠçš„ç³»ç»ŸåŠè½¯ä»¶æ­¤æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ç‰ˆæœ¬ï¼Œå…¶ä»–è½¯ä»¶ç‰ˆæœ¬éšæ„ï¼š</p>
<ul>
<li>Linuxç³»ç»Ÿï¼ˆCentOS7ï¼‰</li>
<li>MySQLï¼ˆ5.7ï¼‰</li>
<li>Hadoopï¼ˆ3.1.3ï¼‰</li>
<li>HBaseï¼ˆ2.2.2ï¼ŒHBaseç‰ˆæœ¬éœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Hiveï¼ˆ3.1.2ï¼ŒHiveéœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Sqoopï¼ˆ1.4.7ï¼‰</li>
<li>Rï¼ˆ3.6.0ï¼‰</li>
<li>IDEAï¼ˆ 2023.3.6 ç¤¾åŒºç‰ˆï¼‰</li>
</ul>
<p><font color="red"><strong>PSï¼šHadoop ä¸ HBaseã€Hive ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font>ğŸ˜ƒğŸ˜ƒğŸ˜ƒå…¶ä»–è½¯ä»¶éšæ„ã€‚</p>
<p>2ã€æœ¬æ–‡ç« æ‰€æœ‰<strong>ä¸‹è½½</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/</code> ç›®å½•ä¸‹ã€‚æ‰€æœ‰<strong>å®‰è£…</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/usr/local/</code> ç›®å½•ä¸‹ä»¥ <code>è½¯ä»¶å-ç‰ˆæœ¬å·</code> æ–¹å¼å‘½åã€‚åœ¨è¿›è¡Œæ¯ä¸ªè½¯ä»¶çš„å®‰è£…æ“ä½œä¹‹å‰è¯·å…ˆ<strong>æ•´ä½“é˜…è¯»</strong>æ•´ä¸ªè½¯ä»¶å®‰è£…æµç¨‹çš„æ–‡ç« æœ‰ä¸ªæ•´ä½“æ€è·¯ï¼Œ<strong>äº†è§£åˆ°å®‰è£…æ­¤è½¯ä»¶éœ€è¦åšå“ªäº›è®¾ç½®å†è¿›è¡Œæ“ä½œ</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p>3ã€<font color="red"><strong>æ­¤æ¡ˆä¾‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼Œè¯·æŒ‰ç…§æ­¥éª¤é¡ºåºè¿›è¡Œé˜…è¯»ï¼ï¼</strong>ğŸ™‚ğŸ™‚</font></p>
<h1 id="1-ç¯å¢ƒ"><a href="#1-ç¯å¢ƒ" class="headerlink" title="1. ç¯å¢ƒ"></a>1. ç¯å¢ƒ</h1><p>1ã€ç”±äºå®˜æ–¹ä»“åº“ä¸­æ²¡æœ‰ R çš„è½¯ä»¶åŒ…æ‰€ä»¥éœ€è¦å…ˆå®‰è£… epel-release è½¯ä»¶åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆå®‰è£…epel-releaseè½¯ä»¶åŒ…</span></span><br><span class="line">sudo yum install -y epel-release</span><br></pre></td></tr></table></figure>

<p>EPEL (Extra Packages for Enterprise Linux) æ˜¯ä¸€ä¸ªåŸºäºFedoraçš„é¡¹ç›®ï¼Œä¸º RHEL(Red Hat Enterprise Linux)åŠå…¶è¡ç”Ÿå‘è¡Œç‰ˆå¦‚ CentOSã€Scientific Linux ç­‰æä¾›é¢å¤–çš„è½¯ä»¶åŒ…ã€‚å®‰è£… epel-release è½¯ä»¶åŒ…å¯ä»¥æ‰©å±•è¿™äº›ç³»ç»Ÿä¸Šçš„è½¯ä»¶åŒ…é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯é‚£äº›å®˜æ–¹ä»“åº“ä¸­æ²¡æœ‰çš„è½¯ä»¶åŒ…æˆ–æ›´æ–°ç‰ˆæœ¬çš„è½¯ä»¶åŒ…ã€‚</p>
<p>2ã€å®‰è£… R è¯­è¨€</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum -y install R</span><br></pre></td></tr></table></figure>

<p>å®‰è£…ç»“æŸåï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ Rï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">R</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨åï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼Œå¹¶è¿›å…¥ <code>&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/R%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F.png"></p>
<p><code>&gt;</code> å°±æ˜¯ R çš„å‘½ä»¤æç¤ºç¬¦ï¼Œä½ å¯ä»¥åœ¨åé¢è¾“å…¥ R è¯­è¨€å‘½ä»¤ã€‚å¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤é€€å‡ºRï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">q<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h1 id="2-å¯è§†åŒ–åˆ†æMySQLä¸­çš„æ•°æ®"><a href="#2-å¯è§†åŒ–åˆ†æMySQLä¸­çš„æ•°æ®" class="headerlink" title="2. å¯è§†åŒ–åˆ†æMySQLä¸­çš„æ•°æ®"></a>2. å¯è§†åŒ–åˆ†æMySQLä¸­çš„æ•°æ®</h1><h2 id="2-1-å®‰è£…ä¾èµ–åº“"><a href="#2-1-å®‰è£…ä¾èµ–åº“" class="headerlink" title="2.1 å®‰è£…ä¾èµ–åº“"></a>2.1 å®‰è£…ä¾èµ–åº“</h2><p>ä¸ºäº†å®Œæˆå¯è§†åŒ–åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸º R å®‰è£…ä¸€äº›ä¾èµ–åº“ï¼ŒåŒ…æ‹¬ï¼š<code>RMySQL</code>ã€<code>ggplot2</code>ã€<code>devtools</code> å’Œ <code>recharts</code>ã€‚</p>
<ul>
<li><code>RMySQL</code> æ˜¯ä¸€ä¸ªæä¾›äº†è®¿é—® MySQL æ•°æ®åº“çš„Rè¯­è¨€æ¥å£ç¨‹åºçš„Rè¯­è¨€ä¾èµ–åº“ã€‚</li>
<li><code>ggplot2</code> å’Œ <code>recharts</code> åˆ™æ˜¯Rè¯­è¨€ä¸­æä¾›ç»˜å›¾å¯è§†åŒ–åŠŸèƒ½çš„ä¾èµ–åº“ã€‚</li>
</ul>
<p>å¯åŠ¨ R è¿›å…¥ R å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£… RMySQLï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;RMySQL&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å‘½ä»¤æ‰§è¡Œåï¼Œ å±å¹•ä¼šæç¤º <code>Would you like to user a personal library instead?(y/n)</code> ç­‰é—®é¢˜ï¼Œåªè¦é‡åˆ°æé—®ï¼Œéƒ½åœ¨é”®ç›˜è¾“å…¥yåå›è½¦å³å¯ã€‚ç„¶åï¼Œå±å¹•ä¼šæ˜¾ç¤º <code>---åœ¨æ­¤è¿çº¿é˜¶æ®µæ—¶è¯·é€‰ç”¨CRANçš„é•œå­---</code> ï¼Œå¹¶ä¼šå¼¹å‡ºä¸€ä¸ªç™½è‰²èƒŒæ™¯çš„ç«–æ¡å½¢çª—å£ï¼Œçª—å£æ ‡é¢˜æ˜¯ <code>HTTPS CRAN mirros</code>ï¼Œæ ‡é¢˜ä¸‹é¢åˆ—å‡ºäº†å¾ˆå¤šå›½å®¶çš„é•œåƒåˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½äº China çš„é•œåƒï¼Œæ¯”å¦‚ï¼Œé€‰æ‹© <code>China (Beijing 2) [https]</code> ï¼Œç„¶åç‚¹å‡» <code>Enter</code> æŒ‰é’®ï¼Œå°±å¼€å§‹å®‰è£…äº†ã€‚å®‰è£…è¿‡ç¨‹éœ€è¦å‡ åˆ†é’Ÿ(å½“ç„¶ï¼Œä¹Ÿå’Œå½“å‰ç½‘ç»œé€Ÿåº¦æœ‰å…³ç³»)ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%AF%B7%E9%80%89%E7%94%A8CRAN%E7%9A%84%E9%95%9C%E5%AD%90.png" style="zoom: 67%;">

<p>ç”±äºä¸åŒç”¨æˆ·çš„å¼€å‘ç¯å¢ƒ(è™šæ‹Ÿæœº)ä¸ä¸€æ ·ï¼Œå®‰è£…æœ‰å¾ˆå¤§å¯èƒ½å› ä¸ºç¼ºå°‘ç»„ä»¶å¯¼è‡´å¤±è´¥ï¼Œå¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%BC%BA%E5%B0%91%E7%BB%84%E4%BB%B6%E5%AF%BC%E8%87%B4%E5%A4%B1%E8%B4%A5.png" style="zoom:67%;">

<p>åªè¦æ ¹æ®é”™è¯¯ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼Œè¿›è¡Œæ“ä½œå³å¯ã€‚<code>q()</code> é€€å‡º R å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼Œå›åˆ° Shell çŠ¶æ€ï¼Œæ ¹æ®ä¸Šé¢çš„è‹±æ–‡é”™è¯¯ä¿¡æ¯ï¼Œå°±éœ€è¦åœ¨Shell å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤å®‰è£… <code>libmariadb-client-lgpl-dev</code> ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum -y install mariadb-devel</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œå†æ¬¡è¾“å…¥ä¸‹é¢å‘½ä»¤è¿›å…¥ R å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">R</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸä¼šå‡ºç°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸‹è½½çš„ç¨‹åºåŒ…åœ¨</span><br><span class="line">        â€˜/tmp/RtmpyKeMBU/downloaded_packagesâ€™é‡Œ</span><br></pre></td></tr></table></figure>

<p>å’Œä¸Šé¢ä¸€æ ·ç»§ç»­å®‰è£…ä»¥ä¸‹åŒ…ï¼Œå¦‚æœè¿˜å‡ºç°ç¼ºå°‘ç»„ä»¶çš„é”™è¯¯ï¼Œè¯·æŒ‰ç…§ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆè§£å†³ï¼ï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;ggplot2&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;devtools&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;DBI&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨ä¸Šé¢å®‰è£…åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œåˆå‡ºç°äº†é”™è¯¯ï¼Œå¤„ç†æ–¹æ³•å¾ˆç®€å•ï¼Œè¿˜æ˜¯æŒ‰ç…§ä¸Šé¢ä»‹ç»çš„æ–¹æ³•ï¼Œæ ¹æ®å±å¹•ä¸Šç»™å‡ºçš„è‹±æ–‡é”™è¯¯ä¿¡æ¯ï¼Œç¼ºå°‘ä»€ä¹ˆè½¯ä»¶ï¼Œå°±ç”¨ <code>sudo yum -y install</code> å‘½ä»¤å®‰è£…è¯¥è½¯ä»¶å°±å¯ä»¥äº†ã€‚æˆ‘åœ¨ CentOSä¸Šæ‰§è¡Œå®‰è£…æ—¶ï¼Œç”¨åˆ°äº†ä»¥ä¸‹å‡ ä¸ªè½¯ä»¶ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo yum -y install harfbuzz-devel fribidi-devel fontconfig-devel libfreetype6-dev libjpeg-turbo-devel</span><br></pre></td></tr></table></figure>

<p>ä½ åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸åŒçš„é”™è¯¯ï¼ŒæŒ‰ç…§åŒæ ·çš„å¤„ç†æ–¹æ³•å¯ä»¥é¡ºåˆ©è§£å†³ã€‚</p>
<p><font color="red">PSï¼šåœ¨ CentOS ç³»ç»Ÿå’Œ Ubuntu ç³»ç»Ÿè½¯ä»¶åå¯èƒ½ä¼šæœ‰å·®å¼‚ï¼Œåœ¨å®‰è£…æ—¶ä¼šæç¤ºæ‰¾ä¸åˆ°å¯ç”¨çš„åŒ…ï¼Œä½ å¯ä»¥åœ¨è‹±æ–‡é”™è¯¯ä¿¡æ¯ä¸­æ‰¾åˆ°è½¯ä»¶åŒ…å…³é”®å­—ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡ŒåŒ…çš„æŸ¥æ‰¾ã€‚</font>ğŸ˜€</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥æ‰¾ç‰¹å®šçš„åŒ…</span></span><br><span class="line">yum list | grep &lt;package_name&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„åŒ…å®‰è£…å¥½åï¼Œä¸‹é¢åœ¨ R å‘½ä»¤æç¤ºç¬¦ä¸‹å†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£… <code>taiyun/recharts</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">devtools::install_github(&#x27;taiyun/recharts&#x27;)</span><br></pre></td></tr></table></figure>

<h2 id="2-2-åˆ†æ"><a href="#2-2-åˆ†æ" class="headerlink" title="2.2 åˆ†æ"></a>2.2 åˆ†æ</h2><p>ä»¥ä¸‹åˆ†æä½¿ç”¨çš„å‡½æ•°æ–¹æ³•ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥è¯¢å‡½æ•°çš„ç›¸å…³æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼šæŸ¥è¯¢ <code>sort()</code> å‡½æ•°å¦‚ä½•ä½¿ç”¨</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">?</span>sort</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶ï¼Œå°±ä¼šè¿›å…¥å†’å· <code>:</code> æç¤ºç¬¦çŠ¶æ€(ä¹Ÿå°±æ˜¯å¸®åŠ©æ–‡æ¡£çŠ¶æ€)ï¼Œåœ¨å†’å·åé¢è¾“å…¥qå³å¯é€€å‡ºå¸®åŠ©æ–‡æ¡£çŠ¶æ€ï¼Œè¿”å›åˆ° R æç¤ºç¬¦çŠ¶æ€ï¼</p>
<p>è¿æ¥ MySQL è·å–æ•°æ®ï¼Œè¯·åœ¨ Linux ç³»ç»Ÿä¸­æ–°å»ºå¦å¤–ä¸€ä¸ªç»ˆç«¯ï¼Œç„¶åæ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ MySQL æ•°æ®åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›å…¥ MySQL å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>ä¼šæç¤ºä½ è¾“å…¥å¯†ç ï¼Œè¾“å…¥å¯†ç ï¼Œå°±è¿›å…¥äº† <code>mysql&gt;</code> æç¤ºç¬¦çŠ¶æ€ï¼Œä¸‹é¢å°±å¯ä»¥è¾“å…¥ä¸€äº› SQL è¯­å¥æŸ¥è¯¢æ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use dblab;</span><br><span class="line">select * from user_action limit 10;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œå°±å¯ä»¥æŸ¥çœ‹åˆ°æ•°æ®åº“ dblab ä¸­çš„ <code>user_action</code> è¡¨çš„å‰10è¡Œè®°å½•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">| id     | uid       | item_id   | behavior_type | item_category | visit_date | province  |</span><br><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">| 225651 | 102865660 | 237147749 | 1             | 5689          | 2014-12-04 | é»‘é¾™æ±Ÿ    |</span><br><span class="line">| 225652 | 102865660 | 395294600 | 1             | 3099          | 2014-12-11 | å±±è¥¿      |</span><br><span class="line">| 225653 | 102865660 | 164310319 | 1             | 5027          | 2014-12-08 | æ±Ÿè‹      |</span><br><span class="line">| 225654 | 102865660 | 72511722  | 1             | 1121          | 2014-12-13 | è¥¿è—      |</span><br><span class="line">| 225655 | 102865660 | 334372932 | 1             | 5027          | 2014-11-30 | ç”˜è‚ƒ      |</span><br><span class="line">| 225656 | 102865660 | 323237439 | 1             | 5027          | 2014-12-02 | å¹¿ä¸œ      |</span><br><span class="line">| 225657 | 102865660 | 323237439 | 1             | 5027          | 2014-12-07 | é‡åº†å¸‚    |</span><br><span class="line">| 225658 | 102865660 | 34102362  | 1             | 1863          | 2014-12-13 | å®å¤      |</span><br><span class="line">| 225659 | 102865660 | 373499226 | 1             | 12388         | 2014-11-26 | é»‘é¾™æ±Ÿ    |</span><br><span class="line">| 225660 | 102865660 | 271583890 | 1             | 5027          | 2014-12-06 | ç¦å»º      |</span><br><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ‡æ¢åˆ°åˆšæ‰å·²ç»æ‰“å¼€çš„Rå‘½ä»¤æç¤ºç¬¦ç»ˆç«¯çª—å£ï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>DBI<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RMySQL<span class="punctuation">)</span></span><br><span class="line">conn <span class="operator">&lt;-</span> dbConnect<span class="punctuation">(</span>MySQL<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>dbname<span class="operator">=</span><span class="string">&#x27;dblab&#x27;</span><span class="punctuation">,</span>username<span class="operator">=</span><span class="string">&#x27;root&#x27;</span><span class="punctuation">,</span>password<span class="operator">=</span><span class="string">&#x27;root&#x27;</span><span class="punctuation">,</span>host<span class="operator">=</span><span class="string">&quot;127.0.0.1&quot;</span><span class="punctuation">,</span>port<span class="operator">=</span><span class="number">3306</span><span class="punctuation">)</span></span><br><span class="line">user_action <span class="operator">&lt;-</span> dbGetQuery<span class="punctuation">(</span>conn<span class="punctuation">,</span><span class="string">&#x27;select * from user_action&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>1ã€åˆ†ææ¶ˆè´¹è€…å¯¹å•†å“çš„è¡Œä¸º</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">summary<span class="punctuation">(</span>user_action<span class="operator">$</span>behavior_type<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><code>summary()</code> å‡½æ•°å¯ä»¥å¾—åˆ°æ ·æœ¬æ•°æ®ç±»å‹å’Œé•¿åº¦,å¦‚æœæ ·æœ¬æ˜¯æ•°å€¼å‹,æˆ‘ä»¬è¿˜èƒ½å¾—åˆ°æ ·æœ¬æ•°æ®çš„æœ€å°å€¼ã€æœ€å¤§å€¼ã€å››åˆ†ä½æ•°ä»¥åŠå‡å€¼ä¿¡æ¯ã€‚<br>å¾—åˆ°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Length     Class      Mode </span><br><span class="line">300000 character character </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºåŸæ¥çš„ MySQL æ•°æ®ä¸­ï¼Œæ¶ˆè´¹è€…è¡Œä¸ºå˜é‡çš„ç±»å‹æ˜¯å­—ç¬¦å‹ã€‚è¿™æ ·ä¸å¥½åšæ¯”è¾ƒï¼Œéœ€è¦æŠŠæ¶ˆè´¹è€…è¡Œä¸ºå˜é‡è½¬æ¢ä¸ºæ•°å€¼å‹å˜é‡</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">summary<span class="punctuation">(</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>user_action<span class="operator">$</span>behavior_type<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span><br><span class="line">1.000   1.000   1.000   1.105   1.000   4.000 </span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ç”¨æŸ±çŠ¶å›¾è¡¨ç¤ºï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>user_action<span class="punctuation">,</span>aes<span class="punctuation">(</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>behavior_type<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_histogram<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ä½¿ç”¨ <code>ggplot2</code> åº“çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨libraryå¯¼å…¥åº“ã€‚ggplot()ç»˜åˆ¶æ—¶ï¼Œåˆ›å»ºç»˜å›¾å¯¹è±¡ï¼Œå³ç¬¬ä¸€ä¸ªå›¾å±‚ï¼ŒåŒ…å«ä¸¤ä¸ªå‚æ•°(æ•°æ®ä¸å˜é‡åç§°æ˜ å°„)ã€‚å˜é‡åç§°éœ€è¦è¢«åŒ…å«aeså‡½æ•°é‡Œé¢ã€‚<code>ggplot2</code> çš„å›¾å±‚ä¸å›¾å±‚ä¹‹é—´ç”¨ <code>+</code> è¿›è¡Œè¿æ¥ã€‚<code>ggplot2</code> åŒ…ä¸­çš„ <code>geom_histogram()</code> å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°ç›´æ–¹å›¾çš„ç»˜åˆ¶ã€‚</p>
<p>åˆ†æç»“æœå¦‚ä¸‹å›¾:</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%B1%E7%8A%B6%E5%9B%BE.png" style="zoom:50%;">

<p>ä»ä¸Šå›¾å¯ä»¥å¾—åˆ°ï¼šå¤§éƒ¨åˆ†æ¶ˆè´¹è€…è¡Œä¸ºä»…ä»…åªæ˜¯æµè§ˆã€‚åªæœ‰å¾ˆå°‘éƒ¨åˆ†çš„æ¶ˆè´¹è€…ä¼šè´­ä¹°å•†å“ã€‚</p>
<p>2ã€åˆ†æå“ªä¸€ç±»å•†å“è¢«è´­ä¹°æ€»é‡å‰åçš„å•†å“å’Œè¢«è´­ä¹°æ€»é‡</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–å­æ•°æ®é›†</span></span><br><span class="line">temp <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>user_action<span class="punctuation">,</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>behavior_type<span class="punctuation">)</span><span class="operator">==</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ’åº</span></span><br><span class="line">count <span class="operator">&lt;-</span> sort<span class="punctuation">(</span>table<span class="punctuation">(</span>temp<span class="operator">$</span>item_category<span class="punctuation">)</span><span class="punctuation">,</span>decreasing <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç¬¬1åˆ°10ä¸ªæ’åºç»“æœ</span></span><br><span class="line">print<span class="punctuation">(</span>count<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><code>subset()</code> å‡½æ•°ï¼Œä»æŸä¸€ä¸ªæ•°æ®æ¡†ä¸­é€‰æ‹©å‡ºç¬¦åˆæŸæ¡ä»¶çš„æ•°æ®æˆ–æ˜¯ç›¸å…³çš„åˆ—.table()å¯¹åº”çš„å°±æ˜¯ç»Ÿè®¡å­¦ä¸­çš„åˆ—è”è¡¨ï¼Œæ˜¯ä¸€ç§è®°å½•é¢‘æ•°çš„æ–¹æ³•ã€‚<code>sort()</code> è¿›è¡Œæ’åºï¼Œè¿”å›æ’åºåçš„æ•°å€¼å‘é‡ã€‚</p>
<p>å¾—åˆ°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6344  1863  5232 12189  7957  4370 13230 11537  1838  5894 </span><br><span class="line">  79    46    45    42    40    34    33    32    31    30 </span><br></pre></td></tr></table></figure>

<p>ç»“æœç¬¬ä¸€è¡Œè¡¨ç¤ºå•†å“åˆ†ç±»,è¯¥ç±»ä¸‹è¢«æ¶ˆè´¹çš„æ•°æ¬¡ã€‚</p>
<p>æ¥ä¸‹æ¥ç”¨æ•£ç‚¹å›¾è¡¨ç¤ºï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†countçŸ©é˜µç»“æœè½¬æ¢æˆæ•°æ®æ¡†</span></span><br><span class="line">result <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>count<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>result<span class="punctuation">,</span>aes<span class="punctuation">(</span>Var1<span class="punctuation">,</span>Freq<span class="punctuation">,</span>col<span class="operator">=</span>factor<span class="punctuation">(</span>Var1<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ <code>as.data.frame()</code> æŠŠçŸ©é˜µç­‰è½¬æ¢æˆä¸ºæ•°æ®æ¡†ã€‚</p>
<p>åˆ†æç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%95%A3%E7%82%B9%E5%9B%BE.png" style="zoom: 50%;">



<p>3ã€åˆ†ææ¯å¹´çš„å“ªä¸ªæœˆä»½è´­ä¹°å•†å“çš„é‡æœ€å¤š</p>
<p>ä» MySQL ç›´æ¥è·å–çš„æ•°æ®ä¸­ <code>visit_date</code> å˜é‡éƒ½æ˜¯ 2014 å¹´ä»½,å¹¶æ²¡æœ‰åˆ’åˆ†å‡ºå…·ä½“çš„æœˆä»½ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ•°æ®é›†å¢åŠ ä¸€åˆ—æœˆä»½æ•°æ®ã€‚</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># visit_dateå˜é‡ä¸­æˆªå–æœˆä»½</span></span><br><span class="line">month <span class="operator">&lt;-</span> substr<span class="punctuation">(</span>user_action<span class="operator">$</span>visit_date<span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># user_actionå¢åŠ ä¸€åˆ—æœˆä»½æ•°æ®</span></span><br><span class="line">user_action <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>user_action<span class="punctuation">,</span>month<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ç”¨æŸ±çŠ¶å›¾åˆ†åˆ«è¡¨ç¤ºæ¶ˆè´¹è€…è´­ä¹°é‡</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>user_action<span class="punctuation">,</span>aes<span class="punctuation">(</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>behavior_type<span class="punctuation">)</span><span class="punctuation">,</span>col<span class="operator">=</span>factor<span class="punctuation">(</span>month<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_histogram<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>facet_grid<span class="punctuation">(</span>.<span class="operator">~</span>month<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><code>aes()</code> å‡½æ•°ä¸­çš„ col å±æ€§å¯ä»¥ç”¨æ¥è®¾ç½®é¢œè‰²ã€‚<code>factor()</code> å‡½æ•°åˆ™æ˜¯æŠŠæ•°å€¼å˜é‡è½¬æ¢æˆåˆ†ç±»å˜é‡ï¼Œä½œç”¨æ˜¯ä»¥ä¸åŒçš„é¢œè‰²è¡¨ç¤ºã€‚å¦‚æœä¸ä½¿ç”¨<code>factor()</code> å‡½æ•°ï¼Œé¢œè‰²å°†ä»¥åŒä¸€ç§é¢œè‰²æ¸å˜çš„é¢œè‰²è¡¨ç°ã€‚ <code>facet_grid(.~month)</code> è¡¨ç¤ºæŸ±çŠ¶å›¾æŒ‰ç…§ä¸åŒæœˆä»½è¿›è¡Œåˆ†åŒºã€‚</p>
<p>ç”±äº MySQL è·å–çš„æ•°æ®ä¸­åªæœ‰11æœˆä»½å’Œ12æœˆä»½çš„æ•°æ®ï¼Œæ‰€ä»¥ä¸Šå›¾åªæœ‰æ˜¾ç¤ºä¸¤ä¸ªè¡¨æ ¼ã€‚</p>
<p>åˆ†æç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%B6%88%E8%B4%B9%E8%80%85%E8%B4%AD%E4%B9%B0%E9%87%8F%E6%9F%B1%E7%8A%B6%E5%9B%BE.png" style="zoom:50%;">

<p>4ã€åˆ†æå›½å†…å“ªä¸ªçœä»½çš„æ¶ˆè´¹è€…æœ€æœ‰è´­ä¹°æ¬²æœ›</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>recharts<span class="punctuation">)</span></span><br><span class="line">rel <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>table<span class="punctuation">(</span>temp<span class="operator">$</span>province<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">provinces <span class="operator">&lt;-</span> rel<span class="operator">$</span>Var1</span><br><span class="line">x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>n <span class="keyword">in</span> provinces<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">x<span class="punctuation">[</span><span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="operator">+</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">=</span> nrow<span class="punctuation">(</span>subset<span class="punctuation">(</span>temp<span class="punctuation">,</span><span class="punctuation">(</span>province<span class="operator">==</span>n<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®åœ°å›¾ä¿¡æ¯</span></span><br><span class="line">mapData <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>province<span class="operator">=</span>rel<span class="operator">$</span>Var1<span class="punctuation">,</span>count<span class="operator">=</span>x<span class="punctuation">,</span> stringsAsFactors<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”»å‡ºä¸­å›½åœ°å›¾</span></span><br><span class="line">eMap<span class="punctuation">(</span>mapData<span class="punctuation">,</span> namevar<span class="operator">=</span><span class="operator">~</span>province<span class="punctuation">,</span> datavar <span class="operator">=</span> <span class="operator">~</span>count<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><code>nrow()</code> ç”¨æ¥è®¡ç®—æ•°æ®é›†çš„è¡Œæ•°ã€‚</p>
<p>åˆ†æç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%85%A8%E5%9B%BD%E6%95%B0%E6%8D%AE%E5%9B%BE.png" style="zoom:50%;">

<p><strong>å¤§æ•°æ®æ¡ˆä¾‹ç½‘ç«™ç”¨æˆ·è´­ç‰©è¡Œä¸ºåˆ†ææ‰€æœ‰å®éªŒæ­¥éª¤åˆ°æ­¤ç»“æŸï¼ï¼ï¼ï¼ï¼</strong></p>
<p><strong>å¤§æ•°æ®æ¡ˆä¾‹ç½‘ç«™ç”¨æˆ·è´­ç‰©è¡Œä¸ºåˆ†ææ‰€æœ‰å®éªŒæ­¥éª¤åˆ°æ­¤ç»“æŸï¼ï¼ï¼ï¼ï¼</strong></p>
<p>ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€</p>
]]></content>
      <categories>
        <category>BigData</category>
      </categories>
      <tags>
        <tag>R</tag>
      </tags>
  </entry>
  <entry>
    <title>Springæ•´åˆ</title>
    <url>/posts/Accidence-Spring-Volume-Three/</url>
    <content><![CDATA[<p>Springå®˜ç½‘ï¼š<a href="https://spring.io/">https://spring.io/</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š</p>
<ul>
<li><a href="https://www.bilibili.com/video/BV1Ft4y1g7Fb/">Springè§†é¢‘é›¶åŸºç¡€å…¥é—¨åˆ°é«˜çº§ï¼ŒSpringå…¨å¥—è§†é¢‘æ•™ç¨‹è¯¦è§£</a></li>
<li><a href="https://www.bilibili.com/video/BV1Fi4y1S7ix/">é»‘é©¬ç¨‹åºå‘˜SSMæ¡†æ¶æ•™ç¨‹Springéƒ¨åˆ†</a></li>
</ul>
<p>æºç ä»“åº“ï¼š<a href="https://github.com/muyoukule/accidence-spring">muyoukule&#x2F;accidence-spring (github.com)</a></p>
<h1 id="Springæ•´åˆJdbcTemplate"><a href="#Springæ•´åˆJdbcTemplate" class="headerlink" title="Springæ•´åˆJdbcTemplate"></a>Springæ•´åˆJdbcTemplate</h1><p>JdbcTemplateæ˜¯Springæä¾›çš„ä¸€ä¸ªJDBCæ¨¡æ¿ç±»ï¼Œæ˜¯å¯¹JDBCçš„å°è£…ï¼Œç®€åŒ–JDBCä»£ç ã€‚</p>
<blockquote>
<p>ç¯å¢ƒå‡†å¤‡</p>
</blockquote>
<p>a. åˆ›å»ºæ•°æ®è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `tbl_user` (</span><br><span class="line">  `id` int NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `real_name` varchar(255) DEFAULT NULL,</span><br><span class="line">  `age` int DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;</span><br></pre></td></tr></table></figure>

<p>b. å¼•å…¥ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–°å¢çš„ä¾èµ–:mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–°å¢çš„ä¾èµ–ï¼šspring jdbcï¼Œè¿™ä¸ªä¾èµ–ä¸­æœ‰JdbcTemplate--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. å‡†å¤‡å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String realName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç¼–å†™Spring.xmlé…ç½®æ–‡ä»¶</p>
<p>JdbcTemplate æ˜¯ Spring æä¾›å¥½çš„ç±»ï¼Œè¿™ç±»çš„å®Œæ•´ç±»åæ˜¯ï¼š<code>org.springframework.jdbc.core.JdbcTemplate</code></p>
<p>æˆ‘ä»¬æ€ä¹ˆä½¿ç”¨è¿™ä¸ªç±»å‘¢ï¼Ÿnewå¯¹è±¡å°±å¯ä»¥äº†ã€‚æ€ä¹ˆnewå¯¹è±¡ï¼Ÿç›´æ¥å°†è¿™ä¸ªç±»é…ç½®åˆ°Springé…ç½®æ–‡ä»¶ä¸­ï¼Œçº³å…¥Beanç®¡ç†å³å¯ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JdbcTemplate ä¸­æœ‰ä¸€ä¸ª <code>DataSource</code> å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯æ•°æ®æºï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¿æ¥æ•°æ®åº“éœ€è¦ <code>Connection</code> å¯¹è±¡ï¼Œè€Œç”Ÿæˆ <code>Connection</code> å¯¹è±¡æ˜¯æ•°æ®æºè´Ÿè´£çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™ JdbcTemplate è®¾ç½®æ•°æ®æºå±æ€§ã€‚</p>
<p>æ‰€æœ‰çš„æ•°æ®æºéƒ½æ˜¯è¦å®ç° <code>javax.sql.DataSource</code> æ¥å£çš„ã€‚è¿™ä¸ªæ•°æ®æºå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥ç”¨å†™å¥½çš„ã€‚æ¯”å¦‚ï¼šé˜¿é‡Œå·´å·´çš„å¾·é²ä¼Šè¿æ¥æ± ï¼Œc3p0ï¼Œdbcpç­‰ã€‚</p>
<p>e. æ‰‹å†™ä¸€ä¸ªæ•°æ®æº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDataSource</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ 4ä¸ªå±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡ç‚¹å†™æ€ä¹ˆè·å–Connectionå¯¹è±¡å°±è¡Œã€‚å…¶ä»–æ–¹æ³•ä¸ç”¨ç®¡ã€‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line">            <span class="keyword">return</span> conn;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. æ•°æ®æºä¼ é€’ç»™JdbcTemplate</p>
<p>å†™å®Œæ•°æ®æºï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæ•°æ®æºä¼ é€’ç»™ JdbcTemplate ã€‚å› ä¸º JdbcTemplate ä¸­æœ‰ä¸€ä¸ª <code>DataSource</code> å±æ€§ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myDataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Datasource.MyDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myDataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œç¯å¢ƒå°±å‡†å¤‡å¥½äº†ã€‚</p>
<blockquote>
<p>æ–°å¢</p>
</blockquote>
<p>ç¼–å†™æµ‹è¯•ç¨‹åºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ’å…¥æ“ä½œ</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šinsert delete updateçš„sqlè¯­å¥ï¼Œéƒ½æ˜¯æ‰§è¡Œupdateæ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into tbl_user(id,real_name,age) values(?,?,?)&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> jdbcTemplate.update(sql, <span class="literal">null</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">30</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;æ’å…¥çš„è®°å½•æ¡æ•°ï¼š&quot;</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ’å…¥çš„è®°å½•æ¡æ•°ï¼š1</span><br></pre></td></tr></table></figure>

<p><code>update</code> æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¦æ‰§è¡Œçš„ SQL è¯­å¥ã€‚ï¼ˆSQLè¯­å¥ä¸­å¯èƒ½ä¼šæœ‰å ä½ç¬¦ ? ï¼‰</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯å˜é•¿å‚æ•°ï¼Œå‚æ•°çš„ä¸ªæ•°å¯ä»¥æ˜¯0ä¸ªï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªã€‚ä¸€èˆ¬æ˜¯ SQL è¯­å¥ä¸­æœ‰å‡ ä¸ªé—®å·ï¼Œåˆ™å¯¹åº”å‡ ä¸ªå‚æ•°ã€‚</li>
</ul>
<blockquote>
<p>ä¿®æ”¹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update tbl_user set real_name = ?, age = ? where id = ?&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> jdbcTemplate.update(sql, <span class="string">&quot;å¼ ä¸‰ä¸°&quot;</span>, <span class="number">55</span>, <span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;æ›´æ–°çš„è®°å½•æ¡æ•°ï¼š&quot;</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ›´æ–°çš„è®°å½•æ¡æ•°ï¼š1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ é™¤</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œdelete</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from tbl_user where id = ?&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> jdbcTemplate.update(sql, <span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;åˆ é™¤äº†å‡ æ¡è®°å½•ï¼š&quot;</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ é™¤äº†å‡ æ¡è®°å½•ï¼š1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥è¯¢ä¸€ä¸ªå¯¹è±¡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSelectOne</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œselect</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id, real_name, age from tbl_user where id = ?&quot;</span>;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class), <span class="number">2</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºåˆšæ‰å·²ç»å°†æ•°æ®åº“æ•°æ®åˆ é™¤äº†ï¼Œæ‰€ä»¥éœ€è¦å…ˆæ’å…¥å†æµ‹è¯•æŸ¥è¯¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(id=2, realName=å¼ ä¸‰, age=30)</span><br></pre></td></tr></table></figure>

<p>queryForObjectæ–¹æ³•ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šBeanå±æ€§å€¼å’Œæ•°æ®åº“è®°å½•è¡Œçš„æ˜ å°„å¯¹è±¡ã€‚åœ¨æ„é€ æ–¹æ³•ä¸­æŒ‡å®šæ˜ å°„çš„å¯¹è±¡ç±»å‹ã€‚</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå¯å˜é•¿å‚æ•°ï¼Œç»™sqlè¯­å¥çš„å ä½ç¬¦é—®å·ä¼ å€¼ã€‚</li>
</ul>
<blockquote>
<p>æŸ¥è¯¢å¤šä¸ªå¯¹è±¡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSelectAll</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œselect</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id, real_name, age from tbl_user&quot;</span>;</span><br><span class="line">    List&lt;User&gt; users = jdbcTemplate.query(sql, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class));</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢å‰å…ˆä½¿ç”¨ä¸åŒçš„æ•°æ®å¤šæ¬¡æ‰§è¡Œæ’å…¥æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[User(id=2, realName=å¼ ä¸‰, age=30), User(id=3, realName=æå››, age=31), User(id=4, realName=ç‹äº”, age=32)]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥è¯¢ä¸€ä¸ªå€¼</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSelectOneValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œselect</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(1) from tbl_user&quot;</span>;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> jdbcTemplate.queryForObject(sql, <span class="type">int</span>.class); <span class="comment">// è¿™é‡Œç”¨Integer.classä¹Ÿå¯ä»¥</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ€»è®°å½•æ¡æ•°ï¼š&quot;</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ€»è®°å½•æ¡æ•°ï¼š3</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰¹é‡æ·»åŠ </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAddBatch</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰¹é‡æ·»åŠ </span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into tbl_user(id,real_name,age) values(?,?,?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Object[] objs1 = &#123;<span class="literal">null</span>, <span class="string">&quot;å°èŠ±&quot;</span>, <span class="number">20</span>&#125;;</span><br><span class="line">    Object[] objs2 = &#123;<span class="literal">null</span>, <span class="string">&quot;å°æ˜&quot;</span>, <span class="number">21</span>&#125;;</span><br><span class="line">    Object[] objs3 = &#123;<span class="literal">null</span>, <span class="string">&quot;å°åˆš&quot;</span>, <span class="number">22</span>&#125;;</span><br><span class="line">    List&lt;Object[]&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(objs1);</span><br><span class="line">    list.add(objs2);</span><br><span class="line">    list.add(objs3);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>[] count = jdbcTemplate.batchUpdate(sql, list);</span><br><span class="line">    System.out.println(Arrays.toString(count));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[1, 1, 1]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰¹é‡ä¿®æ”¹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdateBatch</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰¹é‡ä¿®æ”¹</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update tbl_user set real_name = ?, age = ? where id = ?&quot;</span>;</span><br><span class="line">    Object[] objs1 = &#123;<span class="string">&quot;å°èŠ±11&quot;</span>, <span class="number">10</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    Object[] objs2 = &#123;<span class="string">&quot;å°æ˜22&quot;</span>, <span class="number">12</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    Object[] objs3 = &#123;<span class="string">&quot;å°åˆš33&quot;</span>, <span class="number">9</span>, <span class="number">7</span>&#125;;</span><br><span class="line">    List&lt;Object[]&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(objs1);</span><br><span class="line">    list.add(objs2);</span><br><span class="line">    list.add(objs3);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>[] count = jdbcTemplate.batchUpdate(sql, list);</span><br><span class="line">    System.out.println(Arrays.toString(count));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[1, 1, 1]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰¹é‡åˆ é™¤</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDeleteBatch</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from tbl_user where id = ?&quot;</span>;</span><br><span class="line">    Object[] objs1 = &#123;<span class="number">5</span>&#125;;</span><br><span class="line">    Object[] objs2 = &#123;<span class="number">6</span>&#125;;</span><br><span class="line">    Object[] objs3 = &#123;<span class="number">7</span>&#125;;</span><br><span class="line">    List&lt;Object[]&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(objs1);</span><br><span class="line">    list.add(objs2);</span><br><span class="line">    list.add(objs3);</span><br><span class="line">    <span class="type">int</span>[] count = jdbcTemplate.batchUpdate(sql, list);</span><br><span class="line">    System.out.println(Arrays.toString(count));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[1, 1, 1]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨å›è°ƒå‡½æ•°</p>
</blockquote>
<p>ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå¯ä»¥å‚ä¸çš„æ›´åŠ ç»†èŠ‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCallback</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–JdbcTemplateå¯¹è±¡</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;jdbcTemplate&quot;</span>, JdbcTemplate.class);</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id, real_name, age from tbl_user where id = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> jdbcTemplate.execute(sql, <span class="keyword">new</span> <span class="title class_">PreparedStatementCallback</span>&lt;User&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> User <span class="title function_">doInPreparedStatement</span><span class="params">(PreparedStatement ps)</span> <span class="keyword">throws</span> SQLException, DataAccessException &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            ps.setInt(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                user = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">                user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                user.setRealName(rs.getString(<span class="string">&quot;real_name&quot;</span>));</span><br><span class="line">                user.setAge(rs.getInt(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(id=2, realName=å¼ ä¸‰, age=30)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨å¾·é²ä¼Šè¿æ¥æ± </p>
</blockquote>
<p>ä¹‹å‰æ•°æ®æºæ˜¯ç”¨æˆ‘ä»¬è‡ªå·±å†™çš„ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«äººå†™å¥½çš„ã€‚ä¾‹å¦‚å¾·é²ä¼Šè¿æ¥æ± ã€‚</p>
<p>a. å¼•å…¥å¾·é²ä¼Šè¿æ¥æ± çš„ä¾èµ–ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. å°†å¾·é²ä¼Šä¸­çš„æ•°æ®æºé…ç½®åˆ° spring é…ç½®æ–‡ä»¶ä¸­ã€‚å’Œé…ç½®æˆ‘ä»¬è‡ªå·±å†™çš„ä¸€æ ·ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;druidDataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;druidDataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(id=2, realName=å¼ ä¸‰, age=30)</span><br></pre></td></tr></table></figure>

<h1 id="Springæ•´åˆMybatis"><a href="#Springæ•´åˆMybatis" class="headerlink" title="Springæ•´åˆMybatis"></a>Springæ•´åˆMybatis</h1><h2 id="1-Springæ•´åˆMybatisæ€è·¯åˆ†æ"><a href="#1-Springæ•´åˆMybatisæ€è·¯åˆ†æ" class="headerlink" title="1. Springæ•´åˆMybatisæ€è·¯åˆ†æ"></a>1. Springæ•´åˆMybatisæ€è·¯åˆ†æ</h2><blockquote>
<p>ç¯å¢ƒå‡†å¤‡</p>
</blockquote>
<p>åœ¨å‡†å¤‡ç¯å¢ƒçš„è¿‡ç¨‹ä¸­ï¼Œå…ˆå›é¡¾ä¸‹Mybatiså¼€å‘çš„ç›¸å…³å†…å®¹:</p>
<p>a. å‡†å¤‡æ•°æ®åº“è¡¨</p>
<p>Mybatisæ˜¯æ¥æ“ä½œæ•°æ®åº“è¡¨ï¼Œæ‰€ä»¥å…ˆåˆ›å»ºä¸€ä¸ªæ•°æ®åº“åŠè¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> database spring_db <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line">use spring_db;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tbl_account(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">35</span>),</span><br><span class="line">    money <span class="keyword">double</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>b. å¼•å…¥ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æ ¹æ®è¡¨åˆ›å»ºæ¨¡å‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. åˆ›å»º Dao æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into tbl_account(name,money)values(#&#123;name&#125;,#&#123;money&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from tbl_account where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update tbl_account set name = #&#123;name&#125; , money = #&#123;money&#125; where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account&quot;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. åˆ›å»º Service æ¥å£å’Œå®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.save(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.update(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        accountDao.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">findById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. æ·»åŠ  <code>jdbc.properties</code> æ–‡ä»¶</p>
<p>resources ç›®å½•ä¸‹æ·»åŠ ï¼Œç”¨äºé…ç½®æ•°æ®åº“è¿æ¥å››è¦ç´ </p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/spring_db?useSSL=false</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>useSSLï¼šå…³é—­ MySQL çš„ SSL è¿æ¥</p>
<p>g. æ·»åŠ  Mybatis æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆSqlMapConfig.xmlï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è¯»å–å¤–éƒ¨propertiesé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--åˆ«åæ‰«æçš„åŒ…è·¯å¾„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.muyoukule.Entity&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ•°æ®æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ˜ å°„æ–‡ä»¶æ‰«æåŒ…è·¯å¾„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.muyoukule.Dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>h. ç¼–å†™åº”ç”¨ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºSqlSessionFactoryBuilderå¯¹è±¡</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="comment">// 2. åŠ è½½SqlMapConfig.xmlé…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">// 3. åˆ›å»ºSqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">        <span class="comment">// 4. è·å–SqlSession</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession();</span><br><span class="line">        <span class="comment">// 5. æ‰§è¡ŒSqlSessionå¯¹è±¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–ç»“æœUser</span></span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> sqlSession.getMapper(AccountDao.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountDao.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(ac);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6. é‡Šæ”¾èµ„æº</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>i. è¿è¡Œç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">null</span><br></pre></td></tr></table></figure>

<p>ç»“æœä¸º null æ˜¯å› ä¸ºæ•°æ®åº“è¿˜æœªæ’å…¥æ•°æ®ã€‚</p>
<blockquote>
<p>æ•´åˆæ€è·¯åˆ†æ</p>
</blockquote>
<p>Mybatis çš„åŸºç¡€ç¯å¢ƒæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±å¾—åˆ†æä¸‹åœ¨ä¸Šè¿°çš„å†…å®¹ä¸­ï¼Œå“ªäº›å¯¹è±¡å¯ä»¥äº¤ç»™ Spring æ¥ç®¡ç†?</p>
<ul>
<li><p>Mybatisç¨‹åºæ ¸å¿ƒå¯¹è±¡åˆ†æ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/Mybatis%E7%A8%8B%E5%BA%8F%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1%E5%88%86%E6%9E%90.png" style="zoom:80%;">

<p>ä»å›¾ä¸­å¯ä»¥è·å–åˆ°ï¼ŒçœŸæ­£éœ€è¦äº¤ç»™Springç®¡ç†çš„æ˜¯ <code>SqlSessionFactory</code></p>
</li>
<li><p>æ•´åˆ Mybatisï¼Œå°±æ˜¯å°† Mybatis ç”¨åˆ°çš„å†…å®¹äº¤ç»™ Spring ç®¡ç†ï¼Œåˆ†æä¸‹é…ç½®æ–‡ä»¶</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%88%86%E6%9E%90Mybatis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" style="zoom:80%;">

<p><strong>è¯´æ˜:</strong></p>
<ul>
<li>ç¬¬ä¸€è¡Œè¯»å–å¤–éƒ¨ <code>properties</code> é…ç½®æ–‡ä»¶ï¼ŒSpringæœ‰æä¾›å…·ä½“çš„è§£å†³æ–¹æ¡ˆ <code>@PropertySource</code>ï¼Œéœ€è¦äº¤ç»™Spring</li>
<li>ç¬¬äºŒè¡Œèµ·åˆ«ååŒ…æ‰«æï¼Œä¸º <code>SqlSessionFactory</code> æœåŠ¡çš„ï¼Œéœ€è¦äº¤ç»™ Spring</li>
<li>ç¬¬ä¸‰è¡Œä¸»è¦ç”¨äºåšè¿æ¥æ± ï¼ŒSpring ä¹‹å‰æˆ‘ä»¬å·²ç»æ•´åˆäº† Druid è¿æ¥æ± ï¼Œè¿™å—ä¹Ÿéœ€è¦äº¤ç»™ Spring</li>
<li>å‰é¢ä¸‰è¡Œä¸€èµ·éƒ½æ˜¯ä¸ºäº†åˆ›å»º <code>SqlSession</code> å¯¹è±¡ç”¨çš„ï¼Œé‚£ä¹ˆç”¨ Spring ç®¡ç† <code>SqlSession</code> å¯¹è±¡å—ï¼Ÿå›å¿†ä¸‹ <code>SqlSession</code> æ˜¯ç”±<code>SqlSessionFactory</code> åˆ›å»ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥åªéœ€è¦å°† <code>SqlSessionFactory</code> äº¤ç»™ Spring ç®¡ç†å³å¯ã€‚</li>
<li>ç¬¬å››è¡Œæ˜¯ <code>Mapper</code> æ¥å£å’Œæ˜ å°„æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨æ³¨è§£å°±æ²¡æœ‰è¯¥æ˜ å°„æ–‡ä»¶ï¼‰ï¼Œè¿™ä¸ªæ˜¯åœ¨è·å–åˆ° <code>SqlSession</code> ä»¥åæ‰§è¡Œå…·ä½“æ“ä½œçš„æ—¶å€™ç”¨ï¼Œæ‰€ä»¥å®ƒå’Œ <code>SqlSessionFactory</code> åˆ›å»ºçš„æ—¶æœºéƒ½ä¸åœ¨åŒä¸€ä¸ªæ—¶é—´ï¼Œå¯èƒ½éœ€è¦å•ç‹¬ç®¡ç†ã€‚</li>
</ul>
</li>
</ul>
<h2 id="2-Springæ•´åˆMybatis"><a href="#2-Springæ•´åˆMybatis" class="headerlink" title="2. Springæ•´åˆMybatis"></a>2. Springæ•´åˆMybatis</h2><p>å‰é¢æˆ‘ä»¬å·²ç»åˆ†æäº† Spring ä¸ Mybatis çš„æ•´åˆï¼Œå¤§ä½“éœ€è¦åšä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li><p>Spring è¦ç®¡ç† MyBatis ä¸­çš„ <code>SqlSessionFactory</code></p>
</li>
<li><p>Spring è¦ç®¡ç† Mapper æ¥å£çš„æ‰«æ</p>
</li>
</ol>
<blockquote>
<p>å®ç°æ­¥éª¤</p>
</blockquote>
<p>a. é¡¹ç›®ä¸­å¯¼å…¥æ•´åˆéœ€è¦çš„ jar åŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--Springæ“ä½œæ•°æ®åº“éœ€è¦è¯¥jaråŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    Springä¸Mybatisæ•´åˆçš„jaråŒ…</span></span><br><span class="line"><span class="comment">    è¿™ä¸ªjaråŒ…mybatisåœ¨å‰é¢ï¼Œæ˜¯Mybatisæä¾›çš„</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. åˆ›å»º Spring çš„ä¸»é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é…ç½®ç±»æ³¨è§£</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//åŒ…æ‰«æï¼Œä¸»è¦æ‰«æçš„æ˜¯é¡¹ç›®ä¸­çš„AccountServiceImplç±»</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åˆ›å»ºæ•°æ®æºçš„é…ç½®ç±»</p>
<p>åœ¨é…ç½®ç±»ä¸­å®Œæˆæ•°æ®æºçš„åˆ›å»º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(driver);</span><br><span class="line">        ds.setUrl(url);</span><br><span class="line">        ds.setUsername(userName);</span><br><span class="line">        ds.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ä¸»é…ç½®ç±»ä¸­è¯» <code>properties</code> å¹¶å¼•å…¥æ•°æ®æºé…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. åˆ›å»º Mybatis é…ç½®ç±»å¹¶é…ç½® <code>SqlSessionFactory</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰beanï¼ŒSqlSessionFactoryBeanï¼Œç”¨äºäº§ç”ŸSqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">SqlSessionFactoryBean</span> <span class="variable">ssfb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">        <span class="comment">//è®¾ç½®æ¨¡å‹ç±»çš„åˆ«åæ‰«æ</span></span><br><span class="line">        ssfb.setTypeAliasesPackage(<span class="string">&quot;com.muyoukule.Entity&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ•°æ®æº</span></span><br><span class="line">        ssfb.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> ssfb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰beanï¼Œè¿”å›MapperScannerConfigurerå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.muyoukule.Dao&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜:</strong></p>
<ul>
<li><p>ä½¿ç”¨ <code>SqlSessionFactoryBean</code> å°è£… <code>SqlSessionFactory</code> éœ€è¦çš„ç¯å¢ƒä¿¡æ¯</p>
<ul>
<li><code>SqlSessionFactoryBean</code> æ˜¯å‰é¢æˆ‘ä»¬è®²è§£ <code>FactoryBean</code> çš„ä¸€ä¸ªå­ç±»ï¼Œåœ¨è¯¥ç±»ä¸­å°† <code>SqlSessionFactory</code> çš„åˆ›å»ºè¿›è¡Œäº†å°è£…ï¼Œç®€åŒ–å¯¹è±¡çš„åˆ›å»ºï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶éœ€è¦çš„å†…å®¹è®¾ç½®å³å¯ã€‚</li>
<li>æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªå‚æ•°ä¸º <code>dataSource</code>ï¼Œå½“å‰Springå®¹å™¨ä¸­å·²ç»åˆ›å»ºäº†Druidæ•°æ®æºï¼Œç±»å‹åˆšå¥½æ˜¯ <code>DataSource</code> ç±»å‹ï¼Œæ­¤æ—¶åœ¨åˆå§‹åŒ– <code>SqlSessionFactoryBean</code> è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå‘ç°éœ€è¦ä½¿ç”¨ <code>DataSource</code> å¯¹è±¡ï¼Œè€Œå®¹å™¨ä¸­åˆšå¥½æœ‰è¿™ä¹ˆä¸€ä¸ªå¯¹è±¡ï¼Œå°±è‡ªåŠ¨åŠ è½½äº† <code>DruidDataSource</code> å¯¹è±¡ã€‚</li>
</ul>
</li>
<li><p>ä½¿ç”¨ <code>MapperScannerConfigurer</code> åŠ è½½ Dao æ¥å£ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡ä¿å­˜åˆ° IOC å®¹å™¨ä¸­</p>
<ul>
<li>è¿™ä¸ª <code>MapperScannerConfigurer</code> å¯¹è±¡ä¹Ÿæ˜¯ MyBatis æä¾›çš„ä¸“ç”¨äºæ•´åˆçš„ jar åŒ…ä¸­çš„ç±»ï¼Œç”¨æ¥å¤„ç†åŸå§‹é…ç½®æ–‡ä»¶ä¸­çš„ mappers ç›¸å…³é…ç½®ï¼ŒåŠ è½½æ•°æ®å±‚çš„ Mapper æ¥å£ç±»</li>
<li><code>MapperScannerConfigurer</code> æœ‰ä¸€ä¸ªæ ¸å¿ƒå±æ€§ <code>basePackage</code>ï¼Œå°±æ˜¯ç”¨æ¥è®¾ç½®æ‰€æ‰«æçš„åŒ…è·¯å¾„</li>
</ul>
</li>
</ul>
<p>f. ä¸»é…ç½®ç±»ä¸­å¼•å…¥ Mybatis é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class, MybatisConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>g. ç¼–å†™è¿è¡Œç±»</p>
<p>åœ¨è¿è¡Œç±»ä¸­ï¼Œä» IOC å®¹å™¨ä¸­è·å– Service å¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•è·å–ç»“æœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> ctx.getBean(AccountService.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Account</span> <span class="variable">tom</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>(<span class="number">1</span>, <span class="string">&quot;Tom&quot;</span>, <span class="number">1000.00</span>);</span><br><span class="line">        accountService.save(tom);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountService.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(ac);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>h. è¿è¡Œç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Account(id=1, name=Tom, money=1000.0)</span><br></pre></td></tr></table></figure>

<h1 id="Springæ•´åˆJunit"><a href="#Springæ•´åˆJunit" class="headerlink" title="Springæ•´åˆJunit"></a>Springæ•´åˆJunit</h1><p>æ•´åˆ Junit ä¸æ•´åˆ Druid å’Œ MyBatis å·®å¼‚æ¯”è¾ƒå¤§ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ŸJunitæ˜¯ä¸€ä¸ªæå•å…ƒæµ‹è¯•ç”¨çš„å·¥å…·ï¼Œå®ƒä¸æ˜¯æˆ‘ä»¬ç¨‹åºçš„ä¸»ä½“ï¼Œä¹Ÿä¸ä¼šå‚åŠ æœ€ç»ˆç¨‹åºçš„è¿è¡Œï¼Œä»ä½œç”¨ä¸Šæ¥è¯´å°±å’Œä¹‹å‰çš„ä¸œè¥¿ä¸ä¸€æ ·ï¼Œå®ƒä¸æ˜¯åšåŠŸèƒ½çš„ï¼Œçœ‹åšæ˜¯ä¸€ä¸ªè¾…åŠ©å·¥å…·å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>ç¯å¢ƒå‡†å¤‡</p>
</blockquote>
<p>è¿™å—ç¯å¢ƒï¼Œå¤§å®¶å¯ä»¥ç›´æ¥ä½¿ç”¨ Spring ä¸ Mybatis æ•´åˆçš„ç¯å¢ƒå³å¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é‡æ–°åˆ›å»ºä¸€ä¸ªã€‚</p>
<blockquote>
<p>æ•´åˆJunit</p>
</blockquote>
<p>a. å¼•å…¥ä¾èµ–</p>
<p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™æµ‹è¯•ç±»</p>
<p>åœ¨ test\javaä¸‹åˆ›å»º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®ç±»è¿è¡Œå™¨</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="comment">//è®¾ç½®Springç¯å¢ƒå¯¹åº”çš„é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = &#123;SpringConfig.class&#125;)</span> <span class="comment">//åŠ è½½é…ç½®ç±»</span></span><br><span class="line"><span class="comment">//@ContextConfiguration(locations=&#123;&quot;classpath:applicationContext.xml&quot;&#125;)//åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceTest</span> &#123;</span><br><span class="line">    <span class="comment">//æ”¯æŒè‡ªåŠ¨è£…é…æ³¨å…¥bean</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindById</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(accountService.findById(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(accountService.findAll());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Account(id=1, name=Tom, money=1000.0)]</span><br><span class="line">Account(id=1, name=Tom, money=1000.0)</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„:</strong></p>
<ul>
<li>å•å…ƒæµ‹è¯•ï¼Œå¦‚æœæµ‹è¯•çš„æ˜¯æ³¨è§£é…ç½®ç±»ï¼Œåˆ™ä½¿ç”¨<code>@ContextConfiguration(classes = é…ç½®ç±».class)</code></li>
<li>å•å…ƒæµ‹è¯•ï¼Œå¦‚æœæµ‹è¯•çš„æ˜¯é…ç½®æ–‡ä»¶ï¼Œåˆ™ä½¿ç”¨<code>@ContextConfiguration(locations=&#123;é…ç½®æ–‡ä»¶å,...&#125;)</code></li>
<li>Junitè¿è¡Œåæ˜¯åŸºäº Spring ç¯å¢ƒè¿è¡Œçš„ï¼Œæ‰€ä»¥ Spring æä¾›äº†ä¸€ä¸ªä¸“ç”¨çš„ç±»è¿è¡Œå™¨ï¼Œè¿™ä¸ªåŠ¡å¿…è¦è®¾ç½®ï¼Œè¿™ä¸ªç±»è¿è¡Œå™¨å°±åœ¨ Spring çš„æµ‹è¯•ä¸“ç”¨åŒ…ä¸­æä¾›çš„ï¼Œå¯¼å…¥çš„åæ ‡å°±æ˜¯è¿™ä¸ªä¸œè¥¿<code>SpringJUnit4ClassRunner</code></li>
<li>ä¸Šé¢ä¸¤ä¸ªé…ç½®éƒ½æ˜¯å›ºå®šæ ¼å¼ï¼Œå½“éœ€è¦æµ‹è¯•å“ªä¸ª bean æ—¶ï¼Œä½¿ç”¨è‡ªåŠ¨è£…é…åŠ è½½å¯¹åº”çš„å¯¹è±¡ï¼Œä¸‹é¢çš„å·¥ä½œå°±å’Œä»¥å‰åš Junit å•å…ƒæµ‹è¯•å®Œå…¨ä¸€æ ·äº†ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ­¥éª¤ä¸€ã€‘æœ¬åœ°æ•°æ®é›†ä¸Šä¼ åˆ°æ•°æ®ä»“åº“Hive</title>
    <url>/posts/BigData-Case-Volume-One/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç®€ä»‹ï¼šæœ¬æ–‡ç« åŸºäºå¦é—¨å¤§å­¦æä¾›çš„<a href="https://dblab.xmu.edu.cn/post/7499/">å¤§æ•°æ®è¯¾ç¨‹å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</a>ï¼Œé€šè¿‡ä½¿ç”¨ CentOS æ“ä½œç¼–å†™è€Œæ¥ã€‚å…·ä½“ä»‹ç»è¯·æ‰“å¼€é“¾æ¥è¿›è¡Œé˜…è¯»ã€‚</p>
<p><font color="red">è¿™é‡Œä»‹ç»å‡ ç‚¹å€¼å¾—ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ï¼š</font></p>
<p>1ã€å¯¹äºæ¡ˆä¾‹æ‰€æ¶‰åŠçš„ç³»ç»ŸåŠè½¯ä»¶æ­¤æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ç‰ˆæœ¬ï¼Œå…¶ä»–è½¯ä»¶ç‰ˆæœ¬éšæ„ï¼š</p>
<ul>
<li>Linuxç³»ç»Ÿï¼ˆCentOS7ï¼‰</li>
<li>MySQLï¼ˆ5.7ï¼‰</li>
<li>Hadoopï¼ˆ3.1.3ï¼‰</li>
<li>HBaseï¼ˆ2.2.2ï¼ŒHBaseç‰ˆæœ¬éœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Hiveï¼ˆ3.1.2ï¼ŒHiveéœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Sqoopï¼ˆ1.4.7ï¼‰</li>
<li>Rï¼ˆ3.6.0ï¼‰</li>
<li>IDEAï¼ˆ 2023.3.6 ç¤¾åŒºç‰ˆï¼‰</li>
</ul>
<p><font color="red"><strong>PSï¼šHadoop ä¸ HBaseã€Hive ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font>ğŸ˜ƒğŸ˜ƒğŸ˜ƒå…¶ä»–è½¯ä»¶éšæ„ã€‚</p>
<p>2ã€æœ¬æ–‡ç« æ‰€æœ‰<strong>ä¸‹è½½</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/</code> ç›®å½•ä¸‹ã€‚æ‰€æœ‰<strong>å®‰è£…</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/usr/local/</code> ç›®å½•ä¸‹ä»¥ <code>è½¯ä»¶å-ç‰ˆæœ¬å·</code> æ–¹å¼å‘½åã€‚åœ¨è¿›è¡Œæ¯ä¸ªè½¯ä»¶çš„å®‰è£…æ“ä½œä¹‹å‰è¯·å…ˆ<strong>æ•´ä½“é˜…è¯»</strong>æ•´ä¸ªè½¯ä»¶å®‰è£…æµç¨‹çš„æ–‡ç« æœ‰ä¸ªæ•´ä½“æ€è·¯ï¼Œ<strong>äº†è§£åˆ°å®‰è£…æ­¤è½¯ä»¶éœ€è¦åšå“ªäº›è®¾ç½®å†è¿›è¡Œæ“ä½œ</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p>3ã€<font color="red"><strong>æ­¤æ¡ˆä¾‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼Œè¯·æŒ‰ç…§æ­¥éª¤é¡ºåºè¿›è¡Œé˜…è¯»ï¼ï¼</strong>ğŸ™‚ğŸ™‚</font></p>
<h1 id="1-å®éªŒæ•°æ®é›†çš„ä¸‹è½½"><a href="#1-å®éªŒæ•°æ®é›†çš„ä¸‹è½½" class="headerlink" title="1. å®éªŒæ•°æ®é›†çš„ä¸‹è½½"></a>1. å®éªŒæ•°æ®é›†çš„ä¸‹è½½</h1><p>æœ¬æ¡ˆä¾‹é‡‡ç”¨çš„æ•°æ®é›†ä¸º <code>user.zip</code>ï¼ŒåŒ…å«äº†ä¸€ä¸ªå¤§è§„æ¨¡æ•°æ®é›† <code>raw_user.csv</code> (åŒ…å«2000ä¸‡æ¡è®°å½•)ï¼Œå’Œä¸€ä¸ªå°æ•°æ®é›† <code>small_user.csv</code>(åªåŒ…å«30ä¸‡æ¡è®°å½•)ã€‚å°æ•°æ®é›† <code>small_user.csv</code> æ˜¯ä»å¤§è§„æ¨¡æ•°æ®é›† <code>raw_user.csv</code> ä¸­æŠ½å–çš„ä¸€å°éƒ¨åˆ†æ•°æ®ã€‚ä¹‹æ‰€ä»¥æŠ½å–å‡ºä¸€å°‘éƒ¨åˆ†è®°å½•å•ç‹¬æ„æˆä¸€ä¸ªå°æ•°æ®é›†ï¼Œæ˜¯å› ä¸ºï¼Œåœ¨ç¬¬ä¸€éè·‘é€šæ•´ä¸ªå®éªŒæµç¨‹æ—¶ï¼Œä¼šé‡åˆ°å„ç§é”™è¯¯ï¼Œå„ç§é—®é¢˜ï¼Œå…ˆç”¨å°æ•°æ®é›†æµ‹è¯•ï¼Œå¯ä»¥å¤§é‡èŠ‚çº¦ç¨‹åºè¿è¡Œæ—¶é—´ã€‚ç­‰åˆ°ç¬¬ä¸€æ¬¡å®Œæ•´å®éªŒæµç¨‹éƒ½é¡ºåˆ©è·‘é€šä»¥åï¼Œå°±å¯ä»¥æœ€åç”¨å¤§è§„æ¨¡æ•°æ®é›†è¿›è¡Œæœ€åçš„æµ‹è¯•ã€‚</p>
<p>ä¸‹é¢ï¼Œè¯·åœ¨æœ¬æœºå…ˆä¸‹è½½ <a href="http://pan.baidu.com/s/1nuOSo7B">user.zipæ•°æ®é›†</a> ï¼Œç„¶åä¸Šä¼ åˆ°è‡ªå·±çš„ Linux ç³»ç»Ÿã€‚æˆ–è€…ç›´æ¥åœ¨è™šæ‹Ÿæœºçš„æµè§ˆå™¨æ‰“å¼€ä¸‹è½½ã€‚</p>
<p>æˆ‘è¿™é‡Œå°†å®ƒä¸Šä¼ åˆ° Linux çš„ <code>/</code> ç›®å½•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ / ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ </span></span><br><span class="line">sudo rz</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šé¢å‘½ä»¤ï¼Œå°±è¿›å…¥åˆ°äº† user.zip æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°æœ‰ä¸ª user.zip æ–‡ä»¶ã€‚æ³¨æ„ï¼Œå¦‚æœä½ æŠŠ user.zip ä¸‹è½½åˆ°äº†å…¶ä»–ç›®å½•ï¼Œè¿™é‡Œè¯·è¿›å…¥åˆ°ä½ è‡ªå·±çš„å­˜æ”¾ user.zip çš„ç›®å½•ã€‚</p>
<p>ä¸‹é¢éœ€è¦æŠŠ user.zip è¿›è¡Œè§£å‹ç¼©ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆå»ºç«‹ä¸€ä¸ªç”¨äºè¿è¡Œæœ¬æ¡ˆä¾‹çš„ç›®å½• bigdatacaseï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line"></span><br><span class="line">sudo mkdir bigdatacase</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢ç»™ muyoukule ç”¨æˆ·èµ‹äºˆé’ˆå¯¹ bigdatacase ç›®å½•çš„å„ç§æ“ä½œæƒé™</span></span><br><span class="line">sudo chown -R muyoukule:muyoukule ./bigdatacase</span><br><span class="line"></span><br><span class="line">cd bigdatacase</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢åˆ›å»ºä¸€ä¸ªdatasetç›®å½•ï¼Œç”¨äºä¿å­˜æ•°æ®é›†</span></span><br><span class="line">mkdir dataset</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢å°±å¯ä»¥è§£å‹ç¼©user.zipæ–‡ä»¶</span></span><br><span class="line">sudo unzip /user.zip -d /usr/local/bigdatacase/dataset</span><br><span class="line"></span><br><span class="line">cd /usr/local/bigdatacase/dataset</span><br><span class="line"></span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ä½ å°±å¯ä»¥çœ‹åˆ°åœ¨datasetç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š<code>raw_user.csv</code> å’Œ <code>small_user.csv</code></p>
<p>æˆ‘ä»¬æ‰§è¡Œä¸‹é¢å‘½ä»¤å–å‡ºå‰é¢ 5 æ¡è®°å½•çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">head -5 raw_user.csv</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œå‰ 5 è¡Œè®°å½•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user_id,item_id,behavior_type,user_geohash,item_category,time</span><br><span class="line">10001082,285259775,1,97lk14c,4076,2014-12-08 18</span><br><span class="line">10001082,4368907,1,,5503,2014-12-12 12</span><br><span class="line">10001082,4368907,1,,5503,2014-12-12 12</span><br><span class="line">10001082,53616768,1,,9762,2014-12-02 15</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºï¼Œæ¯è¡Œè®°å½•éƒ½åŒ…å« 5 ä¸ªå­—æ®µï¼Œæ•°æ®é›†ä¸­çš„å­—æ®µåŠå…¶å«ä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user_id(ç”¨æˆ·id)</span><br><span class="line">item_id(å•†å“id)</span><br><span class="line">behaviour_type(åŒ…æ‹¬æµè§ˆã€æ”¶è—ã€åŠ è´­ç‰©è½¦ã€è´­ä¹°ï¼Œå¯¹åº”å–å€¼åˆ†åˆ«æ˜¯1ã€2ã€3ã€4)</span><br><span class="line">user_geohash(ç”¨æˆ·åœ°ç†ä½ç½®å“ˆå¸Œå€¼ï¼Œæœ‰äº›è®°å½•ä¸­æ²¡æœ‰è¿™ä¸ªå­—æ®µå€¼ï¼Œæ‰€ä»¥åé¢æˆ‘ä»¬ä¼šç”¨è„šæœ¬åšæ•°æ®é¢„å¤„ç†æ—¶æŠŠè¿™ä¸ªå­—æ®µå…¨éƒ¨åˆ é™¤)</span><br><span class="line">item_category(å•†å“åˆ†ç±»)</span><br><span class="line">time(è¯¥è®°å½•äº§ç”Ÿæ—¶é—´)</span><br></pre></td></tr></table></figure>

<h1 id="2-æ•°æ®é›†çš„é¢„å¤„ç†"><a href="#2-æ•°æ®é›†çš„é¢„å¤„ç†" class="headerlink" title="2. æ•°æ®é›†çš„é¢„å¤„ç†"></a>2. æ•°æ®é›†çš„é¢„å¤„ç†</h1><h2 id="2-1-åˆ é™¤æ–‡ä»¶ç¬¬ä¸€è¡Œè®°å½•ï¼Œå³å­—æ®µåç§°"><a href="#2-1-åˆ é™¤æ–‡ä»¶ç¬¬ä¸€è¡Œè®°å½•ï¼Œå³å­—æ®µåç§°" class="headerlink" title="2.1 åˆ é™¤æ–‡ä»¶ç¬¬ä¸€è¡Œè®°å½•ï¼Œå³å­—æ®µåç§°"></a>2.1 åˆ é™¤æ–‡ä»¶ç¬¬ä¸€è¡Œè®°å½•ï¼Œå³å­—æ®µåç§°</h2><p><code>raw_user</code> å’Œ <code>small_user</code> ä¸­çš„ç¬¬ä¸€è¡Œéƒ½æ˜¯å­—æ®µåç§°ï¼Œæˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­çš„æ•°æ®å¯¼å…¥åˆ°æ•°æ®ä»“åº“ Hive ä¸­æ—¶ï¼Œä¸éœ€è¦ç¬¬ä¸€è¡Œå­—æ®µåç§°ã€‚å› æ­¤ï¼Œè¿™é‡Œåœ¨åšæ•°æ®é¢„å¤„ç†æ—¶ï¼Œåˆ é™¤ç¬¬ä¸€è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/bigdatacase/dataset</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢åˆ é™¤raw_userä¸­çš„ç¬¬1è¡Œ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1dè¡¨ç¤ºåˆ é™¤ç¬¬1è¡Œï¼ŒåŒç†ï¼Œ3dè¡¨ç¤ºåˆ é™¤ç¬¬3è¡Œï¼Œndè¡¨ç¤ºåˆ é™¤ç¬¬nè¡Œ</span></span><br><span class="line">sed -i &#x27;1d&#x27; raw_user.csv </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢åˆ é™¤small_userä¸­çš„ç¬¬1è¡Œ</span></span><br><span class="line">sed -i &#x27;1d&#x27; small_user.csv </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹é¢å†ç”¨<span class="built_in">head</span>å‘½ä»¤å»æŸ¥çœ‹æ–‡ä»¶çš„å‰5è¡Œè®°å½•ï¼Œå°±çœ‹ä¸åˆ°å­—æ®µåç§°è¿™ä¸€è¡Œäº†</span></span><br><span class="line">head -5 raw_user.csv</span><br><span class="line">head -5 small_user.csv</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç”¨ <code>small_user.csv</code> è¿™ä¸ªå°æ•°æ®é›†è¿›è¡Œæ“ä½œï¼Œè¿™æ ·å¯ä»¥èŠ‚çœæ—¶é—´ã€‚ç­‰æ‰€æœ‰æµç¨‹éƒ½è·‘é€šä»¥åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨å¤§æ•°æ®é›† <code>raw_user.csv</code> å»æµ‹è¯•ä¸€éäº†ã€‚</p>
<h2 id="2-2-å¯¹å­—æ®µè¿›è¡Œé¢„å¤„ç†"><a href="#2-2-å¯¹å­—æ®µè¿›è¡Œé¢„å¤„ç†" class="headerlink" title="2.2 å¯¹å­—æ®µè¿›è¡Œé¢„å¤„ç†"></a>2.2 å¯¹å­—æ®µè¿›è¡Œé¢„å¤„ç†</h2><p>ä¸‹é¢å¯¹æ•°æ®é›†è¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼ŒåŒ…æ‹¬ä¸ºæ¯è¡Œè®°å½•å¢åŠ ä¸€ä¸ª <code>id</code> å­—æ®µ(è®©è®°å½•å…·æœ‰å”¯ä¸€æ€§)ã€å¢åŠ ä¸€ä¸ªçœä»½å­—æ®µ(ç”¨æ¥åç»­è¿›è¡Œå¯è§†åŒ–åˆ†æ)ï¼Œå¹¶ä¸”ä¸¢å¼ƒ <code>user_geohash</code> å­—æ®µ(åé¢åˆ†æä¸éœ€è¦è¿™ä¸ªå­—æ®µ)ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬è¦å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶ <code>pre_deal.sh</code>ï¼Œè¯·æŠŠè¿™ä¸ªè„šæœ¬æ–‡ä»¶æ”¾åœ¨ <code>dataset</code> ç›®å½•ä¸‹ï¼Œå’Œæ•°æ®é›† <code>small_user.csv</code> æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/bigdatacase/dataset</span><br><span class="line">vim pre_deal.sh</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä½¿ç”¨ vim ç¼–è¾‘å™¨æ–°å»ºäº†ä¸€ä¸ª <code>pre_deal.sh</code> è„šæœ¬æ–‡ä»¶ï¼Œè¯·åœ¨è¿™ä¸ªè„šæœ¬æ–‡ä»¶ä¸­åŠ å…¥ä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä¸‹é¢è®¾ç½®è¾“å…¥æ–‡ä»¶ï¼ŒæŠŠç”¨æˆ·æ‰§è¡Œpre_deal.shå‘½ä»¤æ—¶æä¾›çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥æ–‡ä»¶åç§°</span></span><br><span class="line">infile=$1</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä¸‹é¢è®¾ç½®è¾“å‡ºæ–‡ä»¶ï¼ŒæŠŠç”¨æˆ·æ‰§è¡Œpre_deal.shå‘½ä»¤æ—¶æä¾›çš„ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºè¾“å‡ºæ–‡ä»¶åç§°</span></span><br><span class="line">outfile=$2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ³¨æ„ï¼ï¼æœ€åçš„<span class="variable">$infile</span> &gt; <span class="variable">$outfile</span>å¿…é¡»è·Ÿåœ¨&#125;â€™è¿™ä¸¤ä¸ªå­—ç¬¦çš„åé¢</span></span><br><span class="line">awk -F &quot;,&quot; &#x27;BEGIN&#123;</span><br><span class="line">        srand();</span><br><span class="line">        id=0;</span><br><span class="line">        Province[0]=&quot;å±±ä¸œ&quot;;Province[1]=&quot;å±±è¥¿&quot;;Province[2]=&quot;æ²³å—&quot;;Province[3]=&quot;æ²³åŒ—&quot;;Province[4]=&quot;é™•è¥¿&quot;;Province[5]=&quot;å†…è’™å¤&quot;;Province[6]=&quot;ä¸Šæµ·å¸‚&quot;;</span><br><span class="line">        Province[7]=&quot;åŒ—äº¬å¸‚&quot;;Province[8]=&quot;é‡åº†å¸‚&quot;;Province[9]=&quot;å¤©æ´¥å¸‚&quot;;Province[10]=&quot;ç¦å»º&quot;;Province[11]=&quot;å¹¿ä¸œ&quot;;Province[12]=&quot;å¹¿è¥¿&quot;;Province[13]=&quot;äº‘å—&quot;; </span><br><span class="line">        Province[14]=&quot;æµ™æ±Ÿ&quot;;Province[15]=&quot;è´µå·&quot;;Province[16]=&quot;æ–°ç–†&quot;;Province[17]=&quot;è¥¿è—&quot;;Province[18]=&quot;æ±Ÿè¥¿&quot;;Province[19]=&quot;æ¹–å—&quot;;Province[20]=&quot;æ¹–åŒ—&quot;;</span><br><span class="line">        Province[21]=&quot;é»‘é¾™æ±Ÿ&quot;;Province[22]=&quot;å‰æ—&quot;;Province[23]=&quot;è¾½å®&quot;; Province[24]=&quot;æ±Ÿè‹&quot;;Province[25]=&quot;ç”˜è‚ƒ&quot;;Province[26]=&quot;é’æµ·&quot;;Province[27]=&quot;å››å·&quot;;</span><br><span class="line">        Province[28]=&quot;å®‰å¾½&quot;; Province[29]=&quot;å®å¤&quot;;Province[30]=&quot;æµ·å—&quot;;Province[31]=&quot;é¦™æ¸¯&quot;;Province[32]=&quot;æ¾³é—¨&quot;;Province[33]=&quot;å°æ¹¾&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;</span><br><span class="line">        id=id+1;</span><br><span class="line">        value=int(rand()*34);       </span><br><span class="line">        print id&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$5&quot;\t&quot;substr($6,1,10)&quot;\t&quot;Province[value]</span><br><span class="line">    &#125;&#x27; $infile &gt; $outfile</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç çš„åŸºæœ¬å½¢å¼æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">awk -F &quot;,&quot; &#x27;å¤„ç†é€»è¾‘&#x27; $infile &gt; $outfile</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>awk</code> å¯ä»¥é€è¡Œè¯»å–è¾“å…¥æ–‡ä»¶ï¼Œå¹¶å¯¹é€è¡Œè¿›è¡Œç›¸åº”æ“ä½œã€‚å…¶ä¸­ï¼Œ<code>-F</code> å‚æ•°ç”¨äºæŒ‡å‡ºæ¯è¡Œè®°å½•çš„ä¸åŒå­—æ®µä¹‹é—´ç”¨ä»€ä¹ˆå­—ç¬¦è¿›è¡Œåˆ†å‰²ï¼Œè¿™é‡Œæ˜¯ç”¨é€—å·è¿›è¡Œåˆ†å‰²ã€‚å¤„ç†é€»è¾‘ä»£ç éœ€è¦ç”¨ä¸¤ä¸ªè‹±æ–‡å•å¼•å·å¼•èµ·æ¥ã€‚  <code>$infile</code> æ˜¯è¾“å…¥æ–‡ä»¶çš„åç§°ï¼Œæˆ‘ä»¬è¿™é‡Œä¼šè¾“å…¥ <code>raw_user.csv</code>ï¼Œ<code>$outfile</code>  è¡¨ç¤ºå¤„ç†ç»“æŸåè¾“å‡ºçš„æ–‡ä»¶åç§°ï¼Œæˆ‘ä»¬åé¢ä¼šä½¿ç”¨ <code>user_table.txt</code> ä½œä¸ºè¾“å‡ºæ–‡ä»¶åç§°ã€‚</p>
<p>åœ¨ä¸Šé¢çš„ <code>pre_deal.sh</code> ä»£ç çš„å¤„ç†é€»è¾‘éƒ¨åˆ†ï¼Œ<code>srand()</code> ç”¨äºç”Ÿæˆéšæœºæ•°çš„ç§å­ï¼Œ<code>id</code> æ˜¯æˆ‘ä»¬ä¸ºæ•°æ®é›†æ–°å¢çš„ä¸€ä¸ªå­—æ®µï¼Œå®ƒæ˜¯ä¸€ä¸ªè‡ªå¢ç±»å‹ï¼Œæ¯æ¡è®°å½•å¢åŠ  1ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¯æ¡è®°å½•å…·æœ‰å”¯ä¸€æ€§ã€‚æˆ‘ä»¬ä¼šä¸ºæ•°æ®é›†æ–°å¢ä¸€ä¸ªçœä»½å­—æ®µï¼Œç”¨æ¥è¿›è¡Œåé¢çš„æ•°æ®å¯è§†åŒ–åˆ†æï¼Œä¸ºäº†ç»™æ¯æ¡è®°å½•å¢åŠ ä¸€ä¸ªçœä»½å­—æ®µçš„å€¼ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆç”¨ <code>Province[]</code> æ•°ç»„ç”¨æ¥ä¿å­˜å…¨å›½å„ä¸ªçœä»½ä¿¡æ¯ï¼Œç„¶åï¼Œåœ¨éå†æ•°æ®é›† <code>raw_user.csv</code> çš„æ—¶å€™ï¼Œæ¯å½“éå†åˆ°å…¶ä¸­ä¸€æ¡è®°å½•ï¼Œä½¿ç”¨ <code>value=int(rand()*34</code>) è¯­å¥éšæœºç”Ÿæˆä¸€ä¸ª 0-33 çš„æ•´æ•°ï¼Œä½œä¸º Province çœä»½å€¼ï¼Œç„¶åä» <code>Province[]</code> æ•°ç»„å½“ä¸­è·å–çœä»½åç§°ï¼Œå¢åŠ åˆ°è¯¥æ¡è®°å½•ä¸­ã€‚</p>
<p><code>substr ($6,1,10)</code> è¿™ä¸ªè¯­å¥æ˜¯ä¸ºäº†æˆªå–æ—¶é—´å­—æ®µ <code>time</code> çš„å¹´æœˆæ—¥ï¼Œæ–¹ä¾¿åç»­å­˜å‚¨ä¸º <code>date</code> æ ¼å¼ã€‚<code>awk</code> æ¯æ¬¡éå†åˆ°ä¸€æ¡è®°å½•æ—¶ï¼Œæ¯æ¡è®°å½•åŒ…å«äº†6ä¸ªå­—æ®µï¼Œå…¶ä¸­ï¼Œç¬¬6ä¸ªå­—æ®µæ˜¯æ—¶é—´å­—æ®µï¼Œ<code>substr($6,1,10)</code> è¯­å¥å°±è¡¨ç¤ºè·å–ç¬¬ 6 ä¸ªå­—æ®µçš„å€¼ï¼Œæˆªå–å‰ 10 ä¸ªå­—ç¬¦ï¼Œç¬¬ 6 ä¸ªå­—æ®µæ˜¯ç±»ä¼¼ <code>2014-12-08 18</code> è¿™æ ·çš„å­—ç¬¦ä¸²(ä¹Ÿå°±æ˜¯è¡¨ç¤º 2014å¹´12æœˆ8æ—¥18æ—¶)ï¼Œ<code>substr($6,1,10)</code>æˆªå–åï¼Œå°±ä¸¢å¼ƒäº†å°æ—¶ï¼Œåªä¿ç•™äº†å¹´æœˆæ—¥ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨ <code>print id&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$5&quot;\t&quot;substr($6,1,10)&quot;\t&quot;Province[value]</code> è¿™è¡Œè¯­å¥ä¸­ï¼Œæˆ‘ä»¬ä¸¢å¼ƒäº†æ¯è¡Œè®°å½•çš„ç¬¬4ä¸ªå­—æ®µï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰å‡ºç° <code>$4</code>ã€‚æˆ‘ä»¬ç”Ÿæˆåçš„æ–‡ä»¶æ˜¯ <code>\t</code> è¿›è¡Œåˆ†å‰²ï¼Œè¿™æ ·ï¼Œåç»­æˆ‘ä»¬å»æŸ¥çœ‹æ•°æ®çš„æ—¶å€™ï¼Œæ•ˆæœè®©äººçœ‹ä¸Šå»æ›´èˆ’æœï¼Œæ¯ä¸ªå­—æ®µåœ¨æ’ç‰ˆçš„æ—¶å€™ä¼šå¯¹é½æ˜¾ç¤ºï¼Œå¦‚æœç”¨é€—å·åˆ†éš”ï¼Œæ˜¾ç¤ºæ•ˆæœå°±æ¯”è¾ƒä¹±ã€‚</p>
<p>æœ€åï¼Œä¿å­˜ <code>pre_deal.sh</code> ä»£ç æ–‡ä»¶ï¼Œé€€å‡º vim ç¼–è¾‘å™¨ã€‚</p>
<p>ä¸‹é¢å°±å¯ä»¥æ‰§è¡Œ <code>pre_deal.sh</code> è„šæœ¬æ–‡ä»¶ï¼Œæ¥å¯¹ <code>small_user.csv</code> è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/bigdatacase/dataset</span><br><span class="line">bash ./pre_deal.sh small_user.csv user_table.txt  </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨ head å‘½ä»¤æŸ¥çœ‹ç”Ÿæˆçš„ <code>user_table.txt</code>ï¼Œä¸è¦ç›´æ¥æ‰“å¼€ï¼Œæ–‡ä»¶è¿‡å¤§ï¼Œä¼šå‡ºé”™ï¼Œä¸‹é¢æŸ¥çœ‹å‰ 10 è¡Œæ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">head -10 user_table.txt</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1       10001082        285259775       1       4076    2014-12-08      å‰æ—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      æ±Ÿè‹</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é’æµ·</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      å°æ¹¾</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      è¾½å®</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å†…è’™å¤</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å››å·</span><br></pre></td></tr></table></figure>

<h2 id="2-3-å¯¼å…¥æ•°æ®åº“"><a href="#2-3-å¯¼å…¥æ•°æ®åº“" class="headerlink" title="2.3 å¯¼å…¥æ•°æ®åº“"></a>2.3 å¯¼å…¥æ•°æ®åº“</h2><p>ä¸‹é¢è¦æŠŠ <code>user_table.txt</code> ä¸­çš„æ•°æ®æœ€ç»ˆå¯¼å…¥åˆ°æ•°æ®ä»“åº“ Hive ä¸­ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬ä¼šé¦–å…ˆæŠŠ <code>user_table.txt</code> ä¸Šä¼ åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ HDFS ä¸­ï¼Œç„¶åï¼Œåœ¨ Hive ä¸­åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è¡¨ï¼Œå®Œæˆæ•°æ®çš„å¯¼å…¥ã€‚</p>
<p>1ã€å¯åŠ¨HDFS</p>
<p>è¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ Hadoop(å¦‚æœä½ å·²ç»å¯åŠ¨äº† Hadoop å°±ä¸ç”¨å†æ¬¡å¯åŠ¨äº†)ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ Hadoop</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹</span></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°ä¸‹é¢è¿™äº›è¿›ç¨‹ï¼Œè¯´æ˜ Hadoop å¯åŠ¨æˆåŠŸäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NameNode</span><br><span class="line">DataNode</span><br><span class="line">NodeManager</span><br><span class="line">SecondaryNameNode</span><br><span class="line">ResourceManager</span><br><span class="line">Jps</span><br></pre></td></tr></table></figure>

<p>2ã€æŠŠ user_table.txt ä¸Šä¼ åˆ° HDFS ä¸­<br>ç°åœ¨ï¼Œæˆ‘ä»¬è¦æŠŠ Linux æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ <code>user_table.txt</code> ä¸Šä¼ åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ HDFS ä¸­ï¼Œå­˜æ”¾åœ¨ HDFS ä¸­çš„ <code>/bigdatacase/dataset</code> ç›®å½•ä¸‹ã€‚</p>
<p>é¦–å…ˆï¼Œè¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œåœ¨ HDFS çš„æ ¹ç›®å½•ä¸‹é¢åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½• bigdatacaseï¼Œå¹¶åœ¨è¿™ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå­ç›®å½• datasetï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line">hdfs dfs -mkdir -p /bigdatacase/dataset</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼ŒæŠŠ Linux æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ <code>user_table.txt</code> ä¸Šä¼ åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ HDFS çš„ <code>/bigdatacase/dataset</code> ç›®å½•ä¸‹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs dfs -put /usr/local/bigdatacase/dataset/user_table.txt /bigdatacase/dataset</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ HDFS ä¸­çš„ <code>user_table.txt</code> çš„å‰ 10 æ¡è®°å½•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hdfs dfs -cat /bigdatacase/dataset/user_table.txt | head -10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1       10001082        285259775       1       4076    2014-12-08      å‰æ—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      æ±Ÿè‹</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é’æµ·</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      å°æ¹¾</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      è¾½å®</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å†…è’™å¤</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å››å·</span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨ Hive ä¸Šåˆ›å»ºæ•°æ®åº“</p>
<p>å¯åŠ¨ MySQL æ•°æ®åº“ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ MySQL çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure>

<p>ç”±äº Hive æ˜¯åŸºäº Hadoop çš„æ•°æ®ä»“åº“ï¼Œä½¿ç”¨ HiveQL è¯­è¨€æ’°å†™çš„æŸ¥è¯¢è¯­å¥ï¼Œæœ€ç»ˆéƒ½ä¼šè¢« Hive è‡ªåŠ¨è§£ææˆ MapReduce ä»»åŠ¡ç”± Hadoopå»å…·ä½“æ‰§è¡Œï¼Œå› æ­¤ï¼Œéœ€è¦å¯åŠ¨ Hadoopï¼Œç„¶åå†å¯åŠ¨ Hiveã€‚ç”±äºå‰é¢æˆ‘ä»¬å·²ç»å¯åŠ¨äº† Hadoopï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œä¸éœ€è¦å†æ¬¡å¯åŠ¨ Hadoopã€‚ä¸‹é¢ï¼Œåœ¨è¿™ä¸ªæ–°çš„ç»ˆç«¯ä¸­æ‰§è¡Œä¸‹é¢å‘½ä»¤è¿›å…¥ Hiveï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨Hive</span></span><br><span class="line">hive</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æˆåŠŸä»¥åï¼Œå°±è¿›å…¥äº† <code>hive&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼Œå¯ä»¥è¾“å…¥ç±»ä¼¼ SQL è¯­å¥çš„ HiveQL è¯­å¥ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¦åœ¨ Hive ä¸­åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ dblabï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create database dblab;</span><br><span class="line"></span><br><span class="line">use dblab;</span><br></pre></td></tr></table></figure>

<p>4ã€åˆ›å»ºå¤–éƒ¨è¡¨</p>
<p>åœ¨æ•°æ®åº“ dblab ä¸­åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è¡¨ <code>bigdata_user</code>ï¼Œå®ƒåŒ…å«å­—æ®µ <code>id, uid, item_id, behavior_type, item_category, date, province</code> ï¼Œè¯·åœ¨ hive å‘½ä»¤æç¤ºç¬¦ä¸‹è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE dblab.bigdata_user(id INT,uid STRING,item_id STRING,behavior_type INT,item_category STRING,visit_date DATE,province STRING) COMMENT &#x27;Welcome to xmu dblab!&#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE LOCATION &#x27;/bigdatacase/dataset&#x27;;</span><br></pre></td></tr></table></figure>

<p>5ã€æŸ¥è¯¢æ•°æ®</p>
<p>ä¸Šé¢å·²ç»æˆåŠŸæŠŠ HDFS ä¸­çš„ <code>/bigdatacase/dataset</code> ç›®å½•ä¸‹çš„æ•°æ®åŠ è½½åˆ°äº†æ•°æ®ä»“åº“ Hive ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥è¯¢ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from bigdata_user limit 10;</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">1       10001082        285259775       1       4076    2014-12-08      å‰æ—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      æ±Ÿè‹</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é’æµ·</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      å°æ¹¾</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      è¾½å®</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å†…è’™å¤</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å››å·</span><br><span class="line">Time taken: 0.959 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select behavior_type from bigdata_user limit 10;</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">Time taken: 0.113 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>BigData</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ­¥éª¤äºŒã€‘Hiveæ•°æ®åˆ†æ</title>
    <url>/posts/BigData-Case-Volume-Two/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç®€ä»‹ï¼šæœ¬æ–‡ç« åŸºäºå¦é—¨å¤§å­¦æä¾›çš„<a href="https://dblab.xmu.edu.cn/post/7499/">å¤§æ•°æ®è¯¾ç¨‹å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</a>ï¼Œé€šè¿‡ä½¿ç”¨ CentOS æ“ä½œç¼–å†™è€Œæ¥ã€‚å…·ä½“ä»‹ç»è¯·æ‰“å¼€é“¾æ¥è¿›è¡Œé˜…è¯»ã€‚</p>
<p><font color="red">è¿™é‡Œä»‹ç»å‡ ç‚¹å€¼å¾—ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ï¼š</font></p>
<p>1ã€å¯¹äºæ¡ˆä¾‹æ‰€æ¶‰åŠçš„ç³»ç»ŸåŠè½¯ä»¶æ­¤æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ç‰ˆæœ¬ï¼Œå…¶ä»–è½¯ä»¶ç‰ˆæœ¬éšæ„ï¼š</p>
<ul>
<li>Linuxç³»ç»Ÿï¼ˆCentOS7ï¼‰</li>
<li>MySQLï¼ˆ5.7ï¼‰</li>
<li>Hadoopï¼ˆ3.1.3ï¼‰</li>
<li>HBaseï¼ˆ2.2.2ï¼ŒHBaseç‰ˆæœ¬éœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Hiveï¼ˆ3.1.2ï¼ŒHiveéœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Sqoopï¼ˆ1.4.7ï¼‰</li>
<li>Rï¼ˆ3.6.0ï¼‰</li>
<li>IDEAï¼ˆ 2023.3.6 ç¤¾åŒºç‰ˆï¼‰</li>
</ul>
<p><font color="red"><strong>PSï¼šHadoop ä¸ HBaseã€Hive ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font>ğŸ˜ƒğŸ˜ƒğŸ˜ƒå…¶ä»–è½¯ä»¶éšæ„ã€‚</p>
<p>2ã€æœ¬æ–‡ç« æ‰€æœ‰<strong>ä¸‹è½½</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/</code> ç›®å½•ä¸‹ã€‚æ‰€æœ‰<strong>å®‰è£…</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/usr/local/</code> ç›®å½•ä¸‹ä»¥ <code>è½¯ä»¶å-ç‰ˆæœ¬å·</code> æ–¹å¼å‘½åã€‚åœ¨è¿›è¡Œæ¯ä¸ªè½¯ä»¶çš„å®‰è£…æ“ä½œä¹‹å‰è¯·å…ˆ<strong>æ•´ä½“é˜…è¯»</strong>æ•´ä¸ªè½¯ä»¶å®‰è£…æµç¨‹çš„æ–‡ç« æœ‰ä¸ªæ•´ä½“æ€è·¯ï¼Œ<strong>äº†è§£åˆ°å®‰è£…æ­¤è½¯ä»¶éœ€è¦åšå“ªäº›è®¾ç½®å†è¿›è¡Œæ“ä½œ</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p>3ã€<font color="red"><strong>æ­¤æ¡ˆä¾‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼Œè¯·æŒ‰ç…§æ­¥éª¤é¡ºåºè¿›è¡Œé˜…è¯»ï¼ï¼</strong>ğŸ™‚ğŸ™‚</font></p>
<h1 id="1-æ“ä½œHive"><a href="#1-æ“ä½œHive" class="headerlink" title="1. æ“ä½œHive"></a>1. æ“ä½œHive</h1><p>1ã€å¯åŠ¨ MySQL æ•°æ®åº“</p>
<p>å› ä¸ºéœ€è¦å€ŸåŠ©äº MySQL ä¿å­˜ Hive çš„å…ƒæ•°æ®ï¼Œæ‰€ä»¥ï¼Œè¯·é¦–å…ˆå¯åŠ¨ MySQL æ•°æ®åº“ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ MySQL çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure>

<p>2ã€å¯åŠ¨ Hadoop</p>
<p>ç”±äº Hive æ˜¯åŸºäº Hadoop çš„æ•°æ®ä»“åº“ï¼Œä½¿ç”¨ HiveQL è¯­è¨€æ’°å†™çš„æŸ¥è¯¢è¯­å¥ï¼Œæœ€ç»ˆéƒ½ä¼šè¢« Hive è‡ªåŠ¨è§£ææˆ MapReduce ä»»åŠ¡ç”± Hadoop å»å…·ä½“æ‰§è¡Œï¼Œå› æ­¤ï¼Œéœ€è¦å¯åŠ¨ Hadoopï¼Œç„¶åå†å¯åŠ¨ Hiveã€‚</p>
<p>è¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ Hadoop(å¦‚æœä½ å·²ç»å¯åŠ¨äº† Hadoop å°±ä¸ç”¨å†æ¬¡å¯åŠ¨äº†)ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ Hadoop</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹</span></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°ä¸‹é¢è¿™äº›è¿›ç¨‹ï¼Œè¯´æ˜Hadoopå¯åŠ¨æˆåŠŸäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NameNode</span><br><span class="line">DataNode</span><br><span class="line">NodeManager</span><br><span class="line">Jps</span><br><span class="line">SecondaryNameNode</span><br><span class="line">ResourceManager</span><br></pre></td></tr></table></figure>

<p>3ã€å¯åŠ¨è¿›å…¥ Hiveï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šè¿°è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å®Œæˆäº† MySQLã€Hadoop å’Œ Hive ä¸‰è€…çš„å¯åŠ¨ã€‚</p>
<p>å¯åŠ¨æˆåŠŸä»¥åï¼Œå°±è¿›å…¥äº† <code>hive&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼Œå¯ä»¥è¾“å…¥ç±»ä¼¼ SQL è¯­å¥çš„ HiveQL è¯­å¥ã€‚</p>
<p>4ã€åœ¨ <code>hive&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨dblabæ•°æ®åº“</span><br><span class="line">use dblab;</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰è¡¨ã€‚</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ bigdata_user è¡¨çš„å„ç§å±æ€§ï¼›</span><br><span class="line">show create table bigdata_user;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">CREATE EXTERNAL TABLE `bigdata_user`(</span><br><span class="line">  `id` int, </span><br><span class="line">  `uid` string, </span><br><span class="line">  `item_id` string, </span><br><span class="line">  `behavior_type` int, </span><br><span class="line">  `item_category` string, </span><br><span class="line">  `visit_date` date, </span><br><span class="line">  `province` string)</span><br><span class="line">COMMENT &#x27;Welcome to xmu dblab!&#x27;</span><br><span class="line">ROW FORMAT SERDE </span><br><span class="line">  &#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27; </span><br><span class="line">WITH SERDEPROPERTIES ( </span><br><span class="line">  &#x27;field.delim&#x27;=&#x27;\t&#x27;, </span><br><span class="line">  &#x27;serialization.format&#x27;=&#x27;\t&#x27;) </span><br><span class="line">STORED AS INPUTFORMAT </span><br><span class="line">  &#x27;org.apache.hadoop.mapred.TextInputFormat&#x27; </span><br><span class="line">OUTPUTFORMAT </span><br><span class="line">  &#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><br><span class="line">LOCATION</span><br><span class="line">  &#x27;hdfs://localhost:9000/bigdatacase/dataset&#x27;</span><br><span class="line">TBLPROPERTIES (</span><br><span class="line">  &#x27;bucketing_version&#x27;=&#x27;2&#x27;, </span><br><span class="line">  &#x27;transient_lastDdlTime&#x27;=&#x27;1711268943&#x27;)</span><br><span class="line">Time taken: 0.124 seconds, Fetched: 23 row(s)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>5ã€æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹è¡¨çš„ç®€å•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">desc bigdata_user;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">id                      int                                         </span><br><span class="line">uid                     string                                      </span><br><span class="line">item_id                 string                                      </span><br><span class="line">behavior_type           int                                         </span><br><span class="line">item_category           string                                      </span><br><span class="line">visit_date              date                                        </span><br><span class="line">province                string                                      </span><br><span class="line">Time taken: 0.041 seconds, Fetched: 7 row(s)</span><br></pre></td></tr></table></figure>

<h1 id="2-ç®€å•æŸ¥è¯¢åˆ†æ"><a href="#2-ç®€å•æŸ¥è¯¢åˆ†æ" class="headerlink" title="2. ç®€å•æŸ¥è¯¢åˆ†æ"></a>2. ç®€å•æŸ¥è¯¢åˆ†æ</h1><p>1ã€å…ˆæµ‹è¯•ä¸€ä¸‹ç®€å•çš„æŒ‡ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># çœ‹å‰10ä½ç”¨æˆ·å¯¹å•†å“çš„è¡Œä¸º</span><br><span class="line">select behavior_type from bigdata_user limit 10;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">Time taken: 0.929 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>

<p>2ã€å¦‚æœè¦æŸ¥å‡ºæ¯ä½ç”¨æˆ·è´­ä¹°å•†å“æ—¶çš„å¤šç§ä¿¡æ¯ï¼Œè¾“å‡ºè¯­å¥æ ¼å¼ä¸º <code>select åˆ—1ï¼Œåˆ—2ï¼Œâ€¦.ï¼Œåˆ—n from</code> è¡¨åï¼›æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æŸ¥è¯¢å‰20ä½ç”¨æˆ·è´­ä¹°å•†å“æ—¶çš„æ—¶é—´å’Œå•†å“çš„ç§ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select visit_date,item_category from bigdata_user limit 20;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">2014-12-08      4076</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-02      9762</span><br><span class="line">2014-12-12      5232</span><br><span class="line">2014-12-02      9762</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-12      10894</span><br><span class="line">2014-12-12      6513</span><br><span class="line">2014-12-12      10894</span><br><span class="line">2014-12-12      2825</span><br><span class="line">2014-11-28      2825</span><br><span class="line">2014-12-15      3200</span><br><span class="line">2014-12-03      10576</span><br><span class="line">2014-11-20      10576</span><br><span class="line">2014-12-13      10576</span><br><span class="line">2014-12-08      10576</span><br><span class="line">2014-12-14      7079</span><br><span class="line">2014-12-02      6669</span><br><span class="line">2014-12-12      5232</span><br><span class="line">Time taken: 0.107 seconds, Fetched: 20 row(s)</span><br></pre></td></tr></table></figure>

<p>3ã€æœ‰æ—¶æˆ‘ä»¬åœ¨è¡¨ä¸­æŸ¥è¯¢å¯ä»¥åˆ©ç”¨åµŒå¥—è¯­å¥ï¼Œå¦‚æœåˆ—åå¤ªå¤æ‚å¯ä»¥è®¾ç½®è¯¥åˆ—çš„åˆ«åï¼Œä»¥ç®€åŒ–æˆ‘ä»¬æ“ä½œçš„éš¾åº¦ï¼Œä»¥ä¸‹æˆ‘ä»¬å¯ä»¥ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select e.bh, e.it from (select behavior_type as bh, item_category as it from bigdata_user) as e limit 20;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">1       4076</span><br><span class="line">1       5503</span><br><span class="line">1       5503</span><br><span class="line">1       9762</span><br><span class="line">1       5232</span><br><span class="line">4       9762</span><br><span class="line">1       5503</span><br><span class="line">1       10894</span><br><span class="line">1       6513</span><br><span class="line">1       10894</span><br><span class="line">1       2825</span><br><span class="line">1       2825</span><br><span class="line">1       3200</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       7079</span><br><span class="line">1       6669</span><br><span class="line">1       5232</span><br><span class="line">Time taken: 0.107 seconds, Fetched: 20 row(s)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç®€å•çš„åšä¸ªè®²è§£ï¼Œ<code>behavior_type as bh</code> , <code>item_category as it</code> å°±æ˜¯æŠŠ <code>behavior_type</code> è®¾ç½®åˆ«å <code>bh</code> ,<code>item_category</code> è®¾ç½®åˆ«å <code>it</code>ï¼Œ<code>FROM</code> çš„æ‹¬å·é‡Œçš„å†…å®¹æˆ‘ä»¬ä¹Ÿè®¾ç½®äº†åˆ«å <code>e</code>ï¼Œè¿™æ ·è°ƒç”¨æ—¶ç”¨ <code>e.bh</code>ï¼Œ<code>e.it</code>ï¼Œå¯ä»¥ç®€åŒ–ä»£ç ã€‚</p>
<h1 id="3-æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡åˆ†æ"><a href="#3-æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡åˆ†æ" class="headerlink" title="3. æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡åˆ†æ"></a>3. æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡åˆ†æ</h1><p>ç»è¿‡ç®€å•çš„æŸ¥è¯¢åæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥åœ¨selectååŠ å…¥æ›´å¤šçš„æ¡ä»¶å¯¹è¡¨è¿›è¡ŒæŸ¥è¯¢,ä¸‹é¢å¯ä»¥ç”¨å‡½æ•°æ¥æŸ¥æ‰¾æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚</p>
<p>1ã€ç”¨èšåˆå‡½æ•° <code>count()</code> è®¡ç®—å‡ºè¡¨å†…æœ‰å¤šå°‘æ¡è¡Œæ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç”¨èšåˆå‡½æ•°count()è®¡ç®—å‡ºè¡¨å†…æœ‰å¤šå°‘æ¡è¡Œæ•°æ® </span><br><span class="line">select count(*) from bigdata_user;</span><br></pre></td></tr></table></figure>

<p>å‡ºç°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ended Job = job_1711268571920_0001 with errors</span><br><span class="line">Error during job, obtaining debugging information...</span><br><span class="line">FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 FAIL</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br></pre></td></tr></table></figure>

<p>åŸå› ï¼šnamenode å†…å­˜ç©ºé—´ä¸å¤Ÿï¼Œjvm å‰©ä½™ç©ºé—´ä¸å¤Ÿæ–°çš„ job è¿è¡Œï¼›</p>
<p>è§£å†³æ–¹æ³•ï¼šå°† Hive è®¾ç½®æˆæœ¬åœ°æ¨¡å¼æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p><strong>ä¸´æ—¶è®¾ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set hive.exec.mode.local.auto=true;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·è®¾ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦æ¯æ¬¡æ‰§è¡Œè¯­å¥çš„æ—¶å€™è¾“å…¥è¿™æ¡å‘½ä»¤ï¼Œè€Œä¸”è¾“ä¸€æ¬¡å‘½ä»¤åªèƒ½æ‰§è¡Œä¸€æ¬¡è¯­å¥ï¼Œå†æ¬¡æ‰§è¡Œå…¶ä»–è¯­å¥çš„æ—¶å€™å°±ä¼šæç¤ºè¿›ç¨‹è¢«æ€æ­»ã€‚éœ€è¦ä»æ–°å¯åŠ¨ Hive ã€‚æ¯æ¬¡éƒ½è¦é‡æ–°å¯åŠ¨ä¸€æ¬¡ Hive ç„¶ååœ¨è¾“ä¸€æ¬¡è¿™æ¡è¯­å¥æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<p><strong>é•¿è¿œè®¾ç½®</strong></p>
<p>åœ¨ <code>hive-site.xml</code> æ–‡ä»¶æ·»åŠ é…ç½®ï¼Œè®¾ç½®äº†ä¹‹åä»æ–°å¯åŠ¨ Hive å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.mode.local.auto<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>è®¾ç½®å¥½åé‡æ–°æŸ¥è¯¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select count(*) from bigdata_user;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015155_7ae1692b-c09d-4234-9d4d-3404a61fb05c</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:51:57,388 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local2145470938_0001</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 31204930 HDFS Write: 81922062 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">300000</span><br><span class="line">Time taken: 1.461 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¾—å‡ºçš„ç»“æœä¸º OK ä¸‹çš„é‚£ä¸ªæ•°å­— <code>300000</code>(å› ä¸ºæˆ‘ä»¬çš„ <code>small_user.csv</code> ä¸­åŒ…å«äº† 300000 æ¡è®°å½•ï¼Œå¯¼å…¥åˆ° Hive ä¸­)ã€‚</p>
<p>2ã€åœ¨å‡½æ•°å†…éƒ¨åŠ ä¸Š <code>distinct</code>ï¼ŒæŸ¥å‡º <code>uid</code> ä¸é‡å¤çš„æ•°æ®æœ‰å¤šå°‘æ¡</p>
<p>ä¸‹é¢ç»§ç»­æ‰§è¡Œæ“ä½œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åœ¨å‡½æ•°å†…éƒ¨åŠ ä¸Š distinctï¼ŒæŸ¥å‡º uid ä¸é‡å¤çš„æ•°æ®æœ‰å¤šå°‘æ¡</span><br><span class="line">select count(distinct uid) from bigdata_user;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015507_77989e78-51e4-45c1-9eb1-200c0787c3ec</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:55:09,012 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1035121157_0002</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 62385496 HDFS Write: 81922271 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">270</span><br><span class="line">Time taken: 1.346 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥è¯¢ä¸é‡å¤çš„æ•°æ®æœ‰å¤šå°‘æ¡(ä¸ºäº†æ’é™¤å®¢æˆ·åˆ·å•æƒ…å†µ) </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select count(*) from (select uid,item_id,behavior_type,item_category,visit_date,province from bigdata_user group by uid,item_id,behavior_type,item_category,visit_date,province having count(*)=1)a;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015553_0c5051e4-2030-4be3-b27a-f981274e056d</span><br><span class="line">Total jobs = 2</span><br><span class="line">Launching Job 1 out of 2</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:55:55,036 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-03-24 01:55:57,044 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-03-24 01:55:58,049 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1915786213_0003</span><br><span class="line">Launching Job 2 out of 2</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Selecting local mode for task: Stage-2</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:56:00,021 Stage-2 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1303362696_0004</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 93566056 HDFS Write: 81927009 SUCCESS</span><br><span class="line">Stage-Stage-2:  HDFS Read: 93584837 HDFS Write: 81944726 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">284047</span><br><span class="line">Time taken: 6.41 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºï¼Œæ’é™¤æ‰é‡å¤ä¿¡æ¯ä»¥åï¼Œåªæœ‰ 284047 æ¡è®°å½•ã€‚</p>
<p><strong>PSï¼šåµŒå¥—è¯­å¥æœ€å¥½å–åˆ«åï¼Œå°±æ˜¯ä¸Šé¢çš„ aï¼Œå¦åˆ™å¾ˆå®¹æ˜“å‡ºç°å¦‚ä¸‹é”™è¯¯ã€‚</strong></p>
<h1 id="4-å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ"><a href="#4-å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ" class="headerlink" title="4. å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ"></a>4. å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ</h1><p>1ã€ä»¥å…³é”®å­—çš„å­˜åœ¨åŒºé—´ä¸ºæ¡ä»¶çš„æŸ¥è¯¢</p>
<p>ä½¿ç”¨ <code>where</code> å¯ä»¥ç¼©å°æŸ¥è¯¢åˆ†æçš„èŒƒå›´å’Œç²¾ç¡®åº¦ï¼Œä¸‹é¢ç”¨å®ä¾‹æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p>(1) æŸ¥è¯¢ 2014å¹´12æœˆ10æ—¥ åˆ° 2014å¹´12æœˆ13æ—¥ æœ‰å¤šå°‘äººæµè§ˆäº†å•†å“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select count(*) from bigdata_user where behavior_type=&#x27;1&#x27; and visit_date&lt;&#x27;2014-12-13&#x27; and visit_date&gt;&#x27;2014-12-10&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015825_ec7ac2f7-57a2-48cb-bda7-729a69bf164c</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:58:27,122 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local803845934_0007</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 155963028 HDFS Write: 81958359 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">26329</span><br><span class="line">Time taken: 1.395 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>(2) ä»¥æœˆçš„ç¬¬nå¤©ä¸ºç»Ÿè®¡å•ä½ï¼Œä¾æ¬¡æ˜¾ç¤ºç¬¬nå¤©ç½‘ç«™å–å‡ºå»çš„å•†å“çš„ä¸ªæ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select count(distinct uid), day(visit_date) from bigdata_user where behavior_type=&#x27;4&#x27; group by day(visit_date);</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015901_e5a2dc9f-ba6e-4c3b-918e-47ad98ff9bb7</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:59:02,325 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1221129954_0008</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 187143592 HDFS Write: 81959082 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">37      1</span><br><span class="line">48      2</span><br><span class="line">42      3</span><br><span class="line">38      4</span><br><span class="line">42      5</span><br><span class="line">33      6</span><br><span class="line">42      7</span><br><span class="line">36      8</span><br><span class="line">34      9</span><br><span class="line">40      10</span><br><span class="line">43      11</span><br><span class="line">98      12</span><br><span class="line">39      13</span><br><span class="line">43      14</span><br><span class="line">42      15</span><br><span class="line">44      16</span><br><span class="line">42      17</span><br><span class="line">66      18</span><br><span class="line">38      19</span><br><span class="line">50      20</span><br><span class="line">33      21</span><br><span class="line">34      22</span><br><span class="line">32      23</span><br><span class="line">47      24</span><br><span class="line">34      25</span><br><span class="line">31      26</span><br><span class="line">30      27</span><br><span class="line">34      28</span><br><span class="line">39      29</span><br><span class="line">38      30</span><br><span class="line">Time taken: 1.31 seconds, Fetched: 30 row(s)</span><br></pre></td></tr></table></figure>

<p>2ã€å…³é”®å­—èµ‹äºˆç»™å®šå€¼ä¸ºæ¡ä»¶ï¼Œå¯¹å…¶ä»–æ•°æ®è¿›è¡Œåˆ†æ</p>
<p>å–ç»™å®šæ—¶é—´å’Œç»™å®šåœ°ç‚¹ï¼Œæ±‚å½“å¤©å‘å‡ºåˆ°è¯¥åœ°ç‚¹çš„è´§ç‰©çš„æ•°é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select count(*) from bigdata_user where province=&#x27;æ±Ÿè¥¿&#x27; and visit_date=&#x27;2014-12-12&#x27; and behavior_type=&#x27;4&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324015952_f881672f-70ca-4303-b128-dd3f8c552945</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 01:59:53,388 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local479466284_0009</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 218325182 HDFS Write: 81959801 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">8</span><br><span class="line">Time taken: 1.264 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<h1 id="5-æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ"><a href="#5-æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ" class="headerlink" title="5. æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ"></a>5. æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ</h1><p>ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬åªç»™å‡ºæŸ¥è¯¢è¯­å¥ï¼Œå°†ä¸å†ç»™å‡ºæ‰§è¡Œç»“æœã€‚</p>
<p>1ã€æŸ¥è¯¢ä¸€ä»¶å•†å“åœ¨æŸå¤©çš„è´­ä¹°æ¯”ä¾‹æˆ–æµè§ˆæ¯”ä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢æœ‰å¤šå°‘ç”¨æˆ·åœ¨ 2014-12-11 è´­ä¹°äº†å•†å“</span><br><span class="line">select count(*) from bigdata_user where visit_date=&#x27;2014-12-11&#x27;and behavior_type=&#x27;4&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324020118_47a9bc8d-2397-42c8-a4ec-8d4ffc46674c</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 02:01:20,097 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-03-24 02:01:21,099 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1882990576_0010</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 249505738 HDFS Write: 81960004 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">69</span><br><span class="line">Time taken: 2.335 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢æœ‰å¤šå°‘ç”¨æˆ·åœ¨ 2014-12-11 ç‚¹å‡»äº†è¯¥åº—</span><br><span class="line">select count(*) from bigdata_user where visit_date =&#x27;2014-12-11&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324020155_4f1a4baf-b338-4ab9-8d05-a0064474caa7</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 02:01:56,329 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1753478999_0011</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 280686296 HDFS Write: 81960211 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">10649</span><br><span class="line">Time taken: 1.313 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ä¸Šé¢è¯­å¥å¾—åˆ°è´­ä¹°æ•°é‡å’Œç‚¹å‡»æ•°é‡ï¼Œä¸¤ä¸ªæ•°ç›¸é™¤å³å¯å¾—å‡ºå½“å¤©è¯¥å•†å“çš„è´­ä¹°ç‡ã€‚</p>
<p>2ã€æŸ¥è¯¢æŸä¸ªç”¨æˆ·åœ¨æŸä¸€å¤©ç‚¹å‡»ç½‘ç«™å è¯¥å¤©æ‰€æœ‰ç‚¹å‡»è¡Œä¸ºçš„æ¯”ä¾‹(ç‚¹å‡»è¡Œä¸ºåŒ…æ‹¬æµè§ˆï¼ŒåŠ å…¥è´­ç‰©è½¦ï¼Œæ”¶è—ï¼Œè´­ä¹°)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢ç”¨æˆ· 10001082 åœ¨ 2014-12-12 ç‚¹å‡»ç½‘ç«™çš„æ¬¡æ•°</span><br><span class="line">select count(*) from bigdata_user where uid=10001082 and visit_date=&#x27;2014-12-12&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324020405_c0631a79-6d8d-4029-812c-6592d727a478</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 02:04:06,828 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local877196646_0012</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 311866860 HDFS Write: 81960418 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">69</span><br><span class="line">Time taken: 1.307 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·åœ¨è¿™ä¸€å¤©ç‚¹å‡»è¯¥ç½‘ç«™çš„æ¬¡æ•°</span><br><span class="line">select count(*) from bigdata_user where visit_date=&#x27;2014-12-12&#x27;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324020425_b2082f31-ead2-4901-bd90-e24610fc4891</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 02:04:26,393 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local783450845_0013</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 343047418 HDFS Write: 81960625 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">17494</span><br><span class="line">Time taken: 1.332 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä¸¤æ¡è¯­å¥çš„ç»“æœç›¸é™¤ï¼Œå°±å¾—åˆ°äº†è¦è¦æ±‚çš„æ¯”ä¾‹ã€‚</p>
<p>3ã€ç»™å®šè´­ä¹°å•†å“çš„æ•°é‡èŒƒå›´ï¼ŒæŸ¥è¯¢æŸä¸€å¤©åœ¨è¯¥ç½‘ç«™çš„è´­ä¹°è¯¥æ•°é‡å•†å“çš„ç”¨æˆ·id</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥è¯¢æŸä¸€å¤©åœ¨è¯¥ç½‘ç«™è´­ä¹°å•†å“è¶…è¿‡ 5 æ¬¡çš„ç”¨æˆ· id</span><br><span class="line">select uid from bigdata_user where behavior_type=&#x27;4&#x27; and visit_date=&#x27;2014-12-12&#x27; group by uid having count(behavior_type=&#x27;4&#x27;)&gt;5;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Automatically selecting local only mode for query</span><br><span class="line">Query ID = muyoukule_20240324020454_4841d58d-313e-4319-87b3-01d8836606ca</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-03-24 02:04:55,645 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1954605595_0014</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 374227982 HDFS Write: 81961208 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">100226515</span><br><span class="line">100300684</span><br><span class="line">100555417</span><br><span class="line">100605</span><br><span class="line">10095384</span><br><span class="line">10142625</span><br><span class="line">101490976</span><br><span class="line">101982646</span><br><span class="line">102011320</span><br><span class="line">102030700</span><br><span class="line">102079825</span><br><span class="line">102349447</span><br><span class="line">102612580</span><br><span class="line">102650143</span><br><span class="line">103082347</span><br><span class="line">103139791</span><br><span class="line">103794013</span><br><span class="line">103995979</span><br><span class="line">Time taken: 1.298 seconds, Fetched: 18 row(s)</span><br></pre></td></tr></table></figure>

<h1 id="6-ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ"><a href="#6-ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ" class="headerlink" title="6. ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ"></a>6. ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ</h1><p>æŸä¸ªåœ°åŒºçš„ç”¨æˆ·å½“å¤©æµè§ˆç½‘ç«™çš„æ¬¡æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºæ–°çš„æ•°æ®è¡¨è¿›è¡Œå­˜å‚¨</span><br><span class="line">create table scan(province STRING,scan INT) COMMENT &#x27;This is the search of bigdataday&#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE;</span><br><span class="line"></span><br><span class="line"># å¯¼å…¥æ•°æ®</span><br><span class="line">insert overwrite table scan select province,count(behavior_type) from bigdata_user where behavior_type=&#x27;1&#x27; group by province;</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºç»“æœ</span><br><span class="line">select * from scan;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">ä¸Šæµ·å¸‚  8372</span><br><span class="line">äº‘å—    8220</span><br><span class="line">å†…è’™å¤  8195</span><br><span class="line">åŒ—äº¬å¸‚  8348</span><br><span class="line">å°æ¹¾    8327</span><br><span class="line">å‰æ—    8242</span><br><span class="line">å››å·    8234</span><br><span class="line">å¤©æ´¥å¸‚  8454</span><br><span class="line">å®å¤    8429</span><br><span class="line">å®‰å¾½    8340</span><br><span class="line">å±±ä¸œ    8449</span><br><span class="line">å±±è¥¿    8347</span><br><span class="line">å¹¿ä¸œ    8305</span><br><span class="line">å¹¿è¥¿    8378</span><br><span class="line">æ–°ç–†    8446</span><br><span class="line">æ±Ÿè‹    8400</span><br><span class="line">æ±Ÿè¥¿    8395</span><br><span class="line">æ²³åŒ—    8437</span><br><span class="line">æ²³å—    8277</span><br><span class="line">æµ™æ±Ÿ    8319</span><br><span class="line">æµ·å—    8389</span><br><span class="line">æ¹–åŒ—    8399</span><br><span class="line">æ¹–å—    8173</span><br><span class="line">æ¾³é—¨    8360</span><br><span class="line">ç”˜è‚ƒ    8283</span><br><span class="line">ç¦å»º    8459</span><br><span class="line">è¥¿è—    8424</span><br><span class="line">è´µå·    8282</span><br><span class="line">è¾½å®    8333</span><br><span class="line">é‡åº†å¸‚  8256</span><br><span class="line">é™•è¥¿    8379</span><br><span class="line">é’æµ·    8266</span><br><span class="line">é¦™æ¸¯    8242</span><br><span class="line">é»‘é¾™æ±Ÿ  8357</span><br><span class="line">Time taken: 0.07 seconds, Fetched: 34 row(s)</span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œï¼ŒHive æ•°æ®åˆ†æå®éªŒé¡ºåˆ©ç»“æŸã€‚</p>
]]></content>
      <categories>
        <category>BigData</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ­¥éª¤ä¸‰ã€‘Hiveã€MySQLã€HBaseæ•°æ®äº’å¯¼</title>
    <url>/posts/BigData-Case-Volume-Three/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç®€ä»‹ï¼šæœ¬æ–‡ç« åŸºäºå¦é—¨å¤§å­¦æä¾›çš„<a href="https://dblab.xmu.edu.cn/post/7499/">å¤§æ•°æ®è¯¾ç¨‹å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</a>ï¼Œé€šè¿‡ä½¿ç”¨ CentOS æ“ä½œç¼–å†™è€Œæ¥ã€‚å…·ä½“ä»‹ç»è¯·æ‰“å¼€é“¾æ¥è¿›è¡Œé˜…è¯»ã€‚</p>
<p><font color="red">è¿™é‡Œä»‹ç»å‡ ç‚¹å€¼å¾—ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ï¼š</font></p>
<p>1ã€å¯¹äºæ¡ˆä¾‹æ‰€æ¶‰åŠçš„ç³»ç»ŸåŠè½¯ä»¶æ­¤æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ç‰ˆæœ¬ï¼Œå…¶ä»–è½¯ä»¶ç‰ˆæœ¬éšæ„ï¼š</p>
<ul>
<li>Linuxç³»ç»Ÿï¼ˆCentOS7ï¼‰</li>
<li>MySQLï¼ˆ5.7ï¼‰</li>
<li>Hadoopï¼ˆ3.1.3ï¼‰</li>
<li>HBaseï¼ˆ2.2.2ï¼ŒHBaseç‰ˆæœ¬éœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Hiveï¼ˆ3.1.2ï¼ŒHiveéœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Sqoopï¼ˆ1.4.7ï¼‰</li>
<li>Rï¼ˆ3.6.0ï¼‰</li>
<li>IDEAï¼ˆ 2023.3.6 ç¤¾åŒºç‰ˆï¼‰</li>
</ul>
<p><font color="red"><strong>PSï¼šHadoop ä¸ HBaseã€Hive ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font>ğŸ˜ƒğŸ˜ƒğŸ˜ƒå…¶ä»–è½¯ä»¶éšæ„ã€‚</p>
<p>2ã€æœ¬æ–‡ç« æ‰€æœ‰<strong>ä¸‹è½½</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/</code> ç›®å½•ä¸‹ã€‚æ‰€æœ‰<strong>å®‰è£…</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/usr/local/</code> ç›®å½•ä¸‹ä»¥ <code>è½¯ä»¶å-ç‰ˆæœ¬å·</code> æ–¹å¼å‘½åã€‚åœ¨è¿›è¡Œæ¯ä¸ªè½¯ä»¶çš„å®‰è£…æ“ä½œä¹‹å‰è¯·å…ˆ<strong>æ•´ä½“é˜…è¯»</strong>æ•´ä¸ªè½¯ä»¶å®‰è£…æµç¨‹çš„æ–‡ç« æœ‰ä¸ªæ•´ä½“æ€è·¯ï¼Œ<strong>äº†è§£åˆ°å®‰è£…æ­¤è½¯ä»¶éœ€è¦åšå“ªäº›è®¾ç½®å†è¿›è¡Œæ“ä½œ</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p>3ã€<font color="red"><strong>æ­¤æ¡ˆä¾‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼Œè¯·æŒ‰ç…§æ­¥éª¤é¡ºåºè¿›è¡Œé˜…è¯»ï¼ï¼</strong>ğŸ™‚ğŸ™‚</font></p>
<h1 id="1-Hiveé¢„æ“ä½œ"><a href="#1-Hiveé¢„æ“ä½œ" class="headerlink" title="1. Hiveé¢„æ“ä½œ"></a>1. Hiveé¢„æ“ä½œ</h1><p>1ã€å¯åŠ¨ MySQL æ•°æ®åº“</p>
<p>å› ä¸ºéœ€è¦å€ŸåŠ©äº MySQL ä¿å­˜ Hive çš„å…ƒæ•°æ®ï¼Œæ‰€ä»¥ï¼Œè¯·é¦–å…ˆå¯åŠ¨ MySQL æ•°æ®åº“ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ MySQL çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure>

<p>2ã€å¯åŠ¨ Hadoop</p>
<p>ç”±äº Hive æ˜¯åŸºäº Hadoop çš„æ•°æ®ä»“åº“ï¼Œä½¿ç”¨ HiveQL è¯­è¨€æ’°å†™çš„æŸ¥è¯¢è¯­å¥ï¼Œæœ€ç»ˆéƒ½ä¼šè¢« Hive è‡ªåŠ¨è§£ææˆ MapReduce ä»»åŠ¡ç”± Hadoop å»å…·ä½“æ‰§è¡Œï¼Œå› æ­¤ï¼Œéœ€è¦å¯åŠ¨ Hadoopï¼Œç„¶åå†å¯åŠ¨ Hiveã€‚</p>
<p>è¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ Hadoop(å¦‚æœä½ å·²ç»å¯åŠ¨äº† Hadoop å°±ä¸ç”¨å†æ¬¡å¯åŠ¨äº†)ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ Hadoop</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹</span></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°ä¸‹é¢è¿™äº›è¿›ç¨‹ï¼Œè¯´æ˜Hadoopå¯åŠ¨æˆåŠŸäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NameNode</span><br><span class="line">DataNode</span><br><span class="line">NodeManager</span><br><span class="line">Jps</span><br><span class="line">SecondaryNameNode</span><br><span class="line">ResourceManager</span><br></pre></td></tr></table></figure>

<p>3ã€å¯åŠ¨è¿›å…¥ Hiveï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šè¿°è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å®Œæˆäº† MySQLã€Hadoop å’Œ Hive ä¸‰è€…çš„å¯åŠ¨ã€‚å¯åŠ¨æˆåŠŸä»¥åï¼Œå°±è¿›å…¥äº† <code>hive&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼Œå¯ä»¥è¾“å…¥ç±»ä¼¼SQL è¯­å¥çš„ HiveQL è¯­å¥ã€‚</p>
<p>ç„¶åï¼Œåœ¨ <code>hive&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<p>(1) åˆ›å»ºä¸´æ—¶è¡¨ user_action</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table dblab.user_action(id STRING,uid STRING, item_id STRING, behavior_type STRING, item_category STRING, visit_date DATE, province STRING) COMMENT &#x27;Welcome to XMU dblab! &#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‘½ä»¤æ‰§è¡Œå®Œä»¥åï¼ŒHive ä¼šè‡ªåŠ¨åœ¨ HDFS æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºå¯¹åº”çš„æ•°æ®æ–‡ä»¶<code>/user/hive/warehouse/dblab.db/user_action</code><br>æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ï¼Œç¡®è®¤è¿™ä¸ªæ•°æ®æ–‡ä»¶åœ¨ HDFS ä¸­ç¡®å®è¢«åˆ›å»ºäº†ï¼Œè¯·åœ¨æ–°å»ºçš„ç»ˆç«¯ä¸­æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hdfs dfs -ls /user/hive/warehouse/dblab.db</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drwxr-xr-x   - muyoukule supergroup          0 2024-03-24 02:06 /user/hive/warehouse/dblab.db/scan</span><br><span class="line">drwxr-xr-x   - muyoukule supergroup          0 2024-03-24 02:15 /user/hive/warehouse/dblab.db/user_action</span><br></pre></td></tr></table></figure>

<p>è¿™è¯´æ˜ï¼Œè¿™ä¸ªæ•°æ®æ–‡ä»¶åœ¨ HDFS ä¸­ç¡®å®è¢«åˆ›å»ºäº†ã€‚æ³¨æ„ï¼Œè¿™ä¸ª HDFS ä¸­çš„æ•°æ®æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬åé¢çš„ â€œä½¿ç”¨ HBase Java API æŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ° HBase ä¸­â€ æ“ä½œä¸­ä¼šä½¿ç”¨åˆ°ã€‚</p>
<p>(2) å°† <code>bigdata_user</code> è¡¨ä¸­çš„æ•°æ®æ’å…¥åˆ° <code>user_action</code> (æ‰§è¡Œæ—¶é—´ï¼š10ç§’å·¦å³)</p>
<p>åœ¨ç¬¬äºŒä¸ªæ­¥éª¤â€”â€” Hive æ•°æ®åˆ†æä¸­ï¼Œæˆ‘ä»¬å·²ç»åœ¨ Hive ä¸­çš„ dblab æ•°æ®åº“ä¸­åˆ›å»ºäº†ä¸€ä¸ªå¤–éƒ¨è¡¨ <code>bigdata_user</code>ã€‚ä¸‹é¢æŠŠ<code>dblab.bigdata_user</code> æ•°æ®æ’å…¥åˆ° <code>dblab.user_action</code> è¡¨ä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT OVERWRITE TABLE dblab.user_action select * from dblab.bigdata_user;</span><br></pre></td></tr></table></figure>

<p>è¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢ä¸Šé¢çš„æ’å…¥å‘½ä»¤æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from dblab.user_action limit 10;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OK</span><br><span class="line">1       10001082        285259775       1       4076    2014-12-08      å‰æ—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      æ±Ÿè‹</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é’æµ·</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      å°æ¹¾</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      è¾½å®</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å†…è’™å¤</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å››å·</span><br><span class="line">Time taken: 0.132 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>

<h1 id="2-ä½¿ç”¨-Sqoop-å°†æ•°æ®ä»-Hive-å¯¼å…¥-MySQL"><a href="#2-ä½¿ç”¨-Sqoop-å°†æ•°æ®ä»-Hive-å¯¼å…¥-MySQL" class="headerlink" title="2. ä½¿ç”¨ Sqoop å°†æ•°æ®ä» Hive å¯¼å…¥ MySQL"></a>2. ä½¿ç”¨ Sqoop å°†æ•°æ®ä» Hive å¯¼å…¥ MySQL</h1><p>1ã€å¯åŠ¨Hadoopé›†ç¾¤ã€MySQLæœåŠ¡</p>
<p>å‰é¢æˆ‘ä»¬å·²ç»å¯åŠ¨äº†Hadoopé›†ç¾¤å’ŒMySQLæœåŠ¡ã€‚è¿™é‡Œè¯·ç¡®è®¤å·²ç»æŒ‰ç…§å‰é¢æ“ä½œå¯åŠ¨æˆåŠŸã€‚</p>
<p>2ã€å°†å‰é¢ç”Ÿæˆçš„ä¸´æ—¶è¡¨æ•°æ®ä»Hiveå¯¼å…¥åˆ° MySQL ä¸­ï¼ŒåŒ…å«å¦‚ä¸‹å››ä¸ªæ­¥éª¤ã€‚</p>
<p>(1) ç™»å½• MySQL</p>
<p>è¯·åœ¨ Linux ç³»ç»Ÿä¸­æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ç®€åŒ–æ“ä½œï¼Œæœ¬æ•™ç¨‹ç›´æ¥ä½¿ç”¨ root ç”¨æˆ·ç™»å½• MySQL æ•°æ®åº“ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®åœ¨ MySQL ä¸­å†å¦å¤–åˆ›å»ºä¸€ä¸ªç”¨æˆ·ã€‚</p>
<p>æ‰§è¡Œä¸Šé¢å‘½ä»¤ä»¥åï¼Œå°±è¿›å…¥äº† <code>mysql&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ã€‚</p>
<p>(2) åˆ›å»ºæ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> #æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line">show databases;</span><br><span class="line"></span><br><span class="line">#åˆ›å»ºdblabæ•°æ®åº“</span><br><span class="line">create database dblab;</span><br><span class="line"></span><br><span class="line">#ä½¿ç”¨æ•°æ®åº“</span><br><span class="line">use dblab;</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šè¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ•°æ®åº“çš„ç¼–ç ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show variables like &quot;char%&quot;;</span><br></pre></td></tr></table></figure>

<p>ä¼šæ˜¾ç¤ºç±»ä¼¼ä¸‹é¢çš„ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | latin1                     |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | latin1                     |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql/charsets/ |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">8 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>è¯·ç¡®è®¤å½“å‰ç¼–ç ä¸º <code>utf8</code>ï¼Œå¦åˆ™æ— æ³•å¯¼å…¥ä¸­æ–‡ã€‚å¦‚æœä¸æ˜¯ <code>utf8</code>åˆ™éœ€è¦æ‰¾åˆ°è‡ªå·± MySQL çš„é…ç½®æ–‡ä»¶(ä¸åŒçš„å®‰è£…æ–¹å¼å¯¹åº”çš„é…ç½®æ–‡ä»¶ä½ç½®ä¸åŒ)ï¼Œ<code>yum</code> æ–¹å¼å®‰è£…çš„ MySQL é…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®ä¸º <code>/etc/my.cnf</code> ã€‚æ‰¾åˆ°ä¹‹åä½¿ç”¨ vim ç¼–è¾‘å™¨æ‰“å¼€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹ MySQL é…ç½®æ–‡ä»¶ï¼Œç›®å½•æ ¹æ®å®‰è£…æ—¶è‡ªè¡ŒæŸ¥æ‰¾</span></span><br><span class="line">sudo vim /etc/my.cnf</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ååœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  <code>character_set_server=utf8</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/MySQL%E9%85%8D%E7%BD%AE%E5%AD%97%E7%AC%A6%E9%9B%86.png" style="zoom: 50%;">

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹å®Œåé‡å¯ MySQL æœåŠ¡</span></span><br><span class="line">sudo systemctl restart mysqld</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ä¿®æ”¹äº†ç¼–ç æ ¼å¼åçš„ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | utf8                       |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | utf8                       |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql/charsets/ |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>(3) åˆ›å»ºè¡¨</p>
<p>ä¸‹é¢åœ¨ MySQL çš„æ•°æ®åº“ <code>dblab</code> ä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡¨ <code>user_action</code>ï¼Œå¹¶è®¾ç½®å…¶ç¼–ç ä¸º <code>utf-8</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `dblab`.`user_action` (`id` varchar(50),`uid` varchar(50),`item_id` varchar(50),`behavior_type` varchar(10),`item_category` varchar(50), `visit_date` DATE,`province` varchar(20)) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>

<p>PSï¼šè¯­å¥ä¸­çš„å¼•å·æ˜¯åå¼•å· &#96;ï¼Œä¸æ˜¯å•å¼•å· â€™ ã€‚</p>
<p>åˆ›å»ºæˆåŠŸåï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤é€€å‡º MySQLï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<p>(4) å¯¼å…¥æ•°æ®(æ‰§è¡Œæ—¶é—´ï¼š20ç§’å·¦å³)</p>
<p>æ³¨æ„ï¼Œåˆšæ‰å·²ç»é€€å‡º MySQLï¼Œå›åˆ°äº† Shell å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ã€‚ä¸‹é¢å°±å¯ä»¥æ‰§è¡Œæ•°æ®å¯¼å…¥æ“ä½œï¼Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¼å…¥å‘½ä»¤</span></span><br><span class="line">sqoop export --connect jdbc:mysql://localhost:3306/dblab?useSSL=false --username root --password root --table duser_action --export-dir &#x27;/user/hive/warehouse/dblab.db/user_action&#x27; --fields-terminated-by &#x27;\t&#x27;; </span><br></pre></td></tr></table></figure>

<p>å­—æ®µè§£é‡Šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqoop export			# è¡¨ç¤ºæ•°æ®ä» hive å¤åˆ¶åˆ° mysql ä¸­</span><br><span class="line">--connect jdbc:mysql://localhost:3306/dblab </span><br><span class="line">--username root			# mysqlç™»é™†ç”¨æˆ·å</span><br><span class="line">--password root			# ç™»å½•å¯†ç </span><br><span class="line">--table user_action		# mysql ä¸­çš„è¡¨ï¼Œå³å°†è¢«å¯¼å…¥çš„è¡¨åç§°  </span><br><span class="line">--export-dir &#x27;/user/hive/warehouse/dblab.db/user_action &#x27;	#hive ä¸­è¢«å¯¼å‡ºçš„æ–‡ä»¶ </span><br><span class="line">--fields-terminated-by &#x27;\t&#x27;		#Hive ä¸­è¢«å¯¼å‡ºçš„æ–‡ä»¶å­—æ®µçš„åˆ†éš”ç¬¦</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» <code>org.apache.hadoop.mapreduce.v2.app.MRAppMaster</code>ï¼š</p>
<p>åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå¹¶å°†è¿”å›çš„å†…å®¹å¤åˆ¶ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hadoop classpath</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hadoop%20classpath.png" style="zoom:67%;">

<p>å°†å¦‚ä¸Šä¿¡æ¯å…¨éƒ¨å¤åˆ¶ï¼Œæ‰¾åˆ°è‡ªå·±å®‰è£… Hadoop çš„è·¯å¾„æ‰“å¼€ <code>yarn-site.xml</code> æ–‡ä»¶ï¼Œåœ¨åé¢æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨ gedit ç¼–è¾‘å™¨è®°å¾—ç›´æ¥æ“ä½œè™šæ‹Ÿæœº</span></span><br><span class="line">gedit /usr/local/hadoop-3.1.3/etc/hadoop/yarn-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>è¾“å…¥åˆšæ‰è¿”å›çš„Hadoop classpathè·¯å¾„<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/yarn-site.xml%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE.png" style="zoom:50%;">

<p>åœ¨æ‰€æœ‰çš„ Master å’Œ Slave èŠ‚ç‚¹è¿›è¡Œå¦‚ä¸Šè®¾ç½®ï¼Œè®¾ç½®å®Œæ¯•åé‡å¯ Hadoop é›†ç¾¤ï¼Œé‡æ–°è¿è¡Œåˆšæ‰çš„ MapReduce ç¨‹åºï¼Œä¿®æ”¹åè¿è¡ŒæˆåŠŸï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2024-03-24 05:18:25,571 INFO mapreduce.Job: Job job_1711280620175_0004 completed successfully</span><br><span class="line">2024-03-24 05:18:25,655 INFO mapreduce.Job: Counters: 32</span><br><span class="line">        File System Counters</span><br><span class="line">                FILE: Number of bytes read=0</span><br><span class="line">                FILE: Number of bytes written=904948</span><br><span class="line">                FILE: Number of read operations=0</span><br><span class="line">                FILE: Number of large read operations=0</span><br><span class="line">                FILE: Number of write operations=0</span><br><span class="line">                HDFS: Number of bytes read=15607365</span><br><span class="line">                HDFS: Number of bytes written=0</span><br><span class="line">                HDFS: Number of read operations=19</span><br><span class="line">                HDFS: Number of large read operations=0</span><br><span class="line">                HDFS: Number of write operations=0</span><br><span class="line">        Job Counters </span><br><span class="line">                Launched map tasks=4</span><br><span class="line">                Data-local map tasks=4</span><br><span class="line">                Total time spent by all maps in occupied slots (ms)=37647</span><br><span class="line">                Total time spent by all reduces in occupied slots (ms)=0</span><br><span class="line">                Total time spent by all map tasks (ms)=37647</span><br><span class="line">                Total vcore-milliseconds taken by all map tasks=37647</span><br><span class="line">                Total megabyte-milliseconds taken by all map tasks=38550528</span><br><span class="line">        Map-Reduce Framework</span><br><span class="line">                Map input records=300000</span><br><span class="line">                Map output records=300000</span><br><span class="line">                Input split bytes=696</span><br><span class="line">                Spilled Records=0</span><br><span class="line">                Failed Shuffles=0</span><br><span class="line">                Merged Map outputs=0</span><br><span class="line">                GC time elapsed (ms)=1097</span><br><span class="line">                CPU time spent (ms)=14110</span><br><span class="line">                Physical memory (bytes) snapshot=1415909376</span><br><span class="line">                Virtual memory (bytes) snapshot=11207258112</span><br><span class="line">                Total committed heap usage (bytes)=1074266112</span><br><span class="line">                Peak Map Physical memory (bytes)=360275968</span><br><span class="line">                Peak Map Virtual memory (bytes)=2806079488</span><br><span class="line">        File Input Format Counters </span><br><span class="line">                Bytes Read=0</span><br><span class="line">        File Output Format Counters </span><br><span class="line">                Bytes Written=0</span><br><span class="line">2024-03-24 05:18:25,659 INFO mapreduce.ExportJobBase: Transferred 14.8843 MB in 31.3371 seconds (486.3743 KB/sec)</span><br><span class="line">2024-03-24 05:18:25,661 INFO mapreduce.ExportJobBase: Exported 300000 records.</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥çœ‹MySQLä¸­user_actionè¡¨æ•°æ®</p>
<p>ä¸‹é¢éœ€è¦å†æ¬¡å¯åŠ¨ MySQLï¼Œè¿›å…¥ <code>mysql&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>

<p>ä¼šæç¤ºä½ è¾“å…¥ MySQL çš„ root ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢ <code>user_action</code> è¡¨ä¸­çš„æ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use dblab;</span><br><span class="line">select * from user_action limit 10;</span><br></pre></td></tr></table></figure>

<p>ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„æŸ¥è¯¢ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">| id     | uid       | item_id   | behavior_type | item_category | visit_date | province  |</span><br><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">| 225651 | 102865660 | 237147749 | 1             | 5689          | 2014-12-04 | é»‘é¾™æ±Ÿ    |</span><br><span class="line">| 225652 | 102865660 | 395294600 | 1             | 3099          | 2014-12-11 | å±±è¥¿      |</span><br><span class="line">| 225653 | 102865660 | 164310319 | 1             | 5027          | 2014-12-08 | æ±Ÿè‹      |</span><br><span class="line">| 225654 | 102865660 | 72511722  | 1             | 1121          | 2014-12-13 | è¥¿è—      |</span><br><span class="line">| 225655 | 102865660 | 334372932 | 1             | 5027          | 2014-11-30 | ç”˜è‚ƒ      |</span><br><span class="line">| 225656 | 102865660 | 323237439 | 1             | 5027          | 2014-12-02 | å¹¿ä¸œ      |</span><br><span class="line">| 225657 | 102865660 | 323237439 | 1             | 5027          | 2014-12-07 | é‡åº†å¸‚    |</span><br><span class="line">| 225658 | 102865660 | 34102362  | 1             | 1863          | 2014-12-13 | å®å¤      |</span><br><span class="line">| 225659 | 102865660 | 373499226 | 1             | 12388         | 2014-11-26 | é»‘é¾™æ±Ÿ    |</span><br><span class="line">| 225660 | 102865660 | 271583890 | 1             | 5027          | 2014-12-06 | ç¦å»º      |</span><br><span class="line">+--------+-----------+-----------+---------------+---------------+------------+-----------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>ä»Hiveå¯¼å…¥æ•°æ®åˆ°MySQLä¸­ï¼ŒæˆåŠŸï¼</p>
<h1 id="3-ä½¿ç”¨-Sqoop-å°†æ•°æ®ä»-MySQL-å¯¼å…¥-HBase"><a href="#3-ä½¿ç”¨-Sqoop-å°†æ•°æ®ä»-MySQL-å¯¼å…¥-HBase" class="headerlink" title="3. ä½¿ç”¨ Sqoop å°†æ•°æ®ä» MySQL å¯¼å…¥ HBase"></a>3. ä½¿ç”¨ Sqoop å°†æ•°æ®ä» MySQL å¯¼å…¥ HBase</h1><p>1ã€å¯åŠ¨ Hadoop é›†ç¾¤ã€MySQL æœåŠ¡ã€HBase æœåŠ¡</p>
<p>ä¹‹å‰æˆ‘ä»¬å·²ç»å¯åŠ¨äº† Hadoop é›†ç¾¤ã€MySQL æœåŠ¡ï¼Œè¿™é‡Œè¯·ç¡®è®¤å·²ç»æŒ‰ç…§å‰é¢æ“ä½œå¯åŠ¨æˆåŠŸã€‚è¿™é‡Œæˆ‘ä»¬å†å¯åŠ¨ HBase æœåŠ¡ã€‚æœ¬æ•™ç¨‹ä¸­ï¼ŒHBaseçš„å®‰è£…ç›®å½•æ˜¯ <code>/usr/local/hbase-2.2.2</code>ï¼Œè€Œä¸”æœ¬æ•™ç¨‹ä¸­ï¼ŒHBase é…ç½®ä¸ºä½¿ç”¨ HDFS å­˜å‚¨æ•°æ®ã€‚</p>
<p>è¯·æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">start-hbase.sh</span><br><span class="line"></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HRegionServer</span><br><span class="line">Jps</span><br><span class="line">ResourceManager</span><br><span class="line">NameNode</span><br><span class="line">SecondaryNameNode</span><br><span class="line">NodeManager</span><br><span class="line">DataNode</span><br><span class="line">HQuorumPeer</span><br><span class="line">HMaster</span><br></pre></td></tr></table></figure>

<p>2ã€å¯åŠ¨ HBase shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hbase shell</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æˆåŠŸåï¼Œå°±è¿›å…¥äº† <code>hbase&gt;</code> å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ã€‚</p>
<p>3ã€åˆ›å»ºè¡¨ <code>user_action</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">create &#x27;user_action&#x27;, &#123; NAME =&gt; &#x27;f1&#x27;, VERSIONS =&gt; 5&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å‘½ä»¤åœ¨ HBase ä¸­åˆ›å»ºäº†ä¸€ä¸ª <code>user_action</code> è¡¨ï¼Œè¿™ä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªåˆ—æ— f1(ä½ æ„¿æ„æŠŠåˆ—æ—åç§°å–ä¸ºå…¶ä»–åç§°ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚åˆ—æ—åç§°ä¸º<code>userinfo</code> )ï¼Œå†å²ç‰ˆæœ¬ä¿ç•™æ•°é‡ä¸º 5 ã€‚</p>
<p>4ã€å¯¼å…¥æ•°æ®(æ‰§è¡Œæ—¶é—´ï¼š30ç§’å·¦å³)</p>
<p>ä¸‹é¢æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¯¼å…¥æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sqoop import --connect jdbc:mysql://localhost:3306/dblab?useSSL=false --username root --password root --table user_action --hbase-table user_action --column-family f1 --hbase-row-key id --hbase-create-table -m 1</span><br></pre></td></tr></table></figure>

<p><font color="red">PSï¼šIPéƒ¨åˆ†æ”¹ä¸ºæœ¬æœºIPåœ°å€æˆ–localhostã€‚åŒæ—¶ï¼ŒHBaseåªæ”¯æŒåå…­è¿›åˆ¶å­˜å‚¨ä¸­æ–‡ã€‚</font></p>
<p>å‘½ä»¤è§£é‡Šå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqoop import --connect jdbc:mysql://localhost:3306/dblab</span><br><span class="line">--username  root</span><br><span class="line">--password  root </span><br><span class="line">--table user_action</span><br><span class="line">--hbase-table user_action 	#HBaseä¸­è¡¨åç§°</span><br><span class="line">--column-family f1		#åˆ—ç°‡åç§°</span><br><span class="line">--hbase-row-key id		#HBase è¡Œé”®</span><br><span class="line">--hbase-create-table	#æ˜¯å¦åœ¨ä¸å­˜åœ¨æƒ…å†µä¸‹åˆ›å»ºè¡¨</span><br><span class="line">-m 1	#å¯åŠ¨ Map æ•°é‡</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç° <code>Exception in thread â€œmainâ€œ java.lang.NoSuchMethodError: org.apache.hadoop.hbase.client.HBaseAdmin.</code> çš„é”™è¯¯ï¼šæ ¹æ®æŠ¥é”™ä¿¡æ¯æç¤ºï¼ŒHBase ä¸­æ²¡æœ‰å¯¹åº”çš„æ–¹æ³•æ‰§è¡Œè¯­å¥ã€‚æŸ¥çœ‹é”™è¯¯ï¼Œå› ä¸ºå¯¹åº” HBase ç‰ˆæœ¬å¤ªé«˜å¯¼è‡´ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼šæ ¹æ®é“¾æ¥ä¸‹è½½ <a href="http://archive.apache.org/dist/hbase/1.6.0/">HBase1.6 ç‰ˆæœ¬</a>ï¼Œæœ¬åœ°è§£å‹ï¼Œå°† lib æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰ jar åŒ…ä¸Šä¼ è‡³è™šæ‹Ÿæœº <code>$SQOOP_HOME/lib</code> æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<p>ä¿®æ”¹åå†æ‰§è¡Œä¸Šé¢çš„ sqoop import å‘½ä»¤ä»¥åï¼Œä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ(çœç•¥äº†å¾ˆå¤šéé‡è¦çš„å±å¹•ä¿¡æ¯)ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">        File System Counters</span><br><span class="line">                FILE: Number of bytes read=0</span><br><span class="line">                FILE: Number of bytes written=277341</span><br><span class="line">                FILE: Number of read operations=0</span><br><span class="line">                FILE: Number of large read operations=0</span><br><span class="line">                FILE: Number of write operations=0</span><br><span class="line">                HDFS: Number of bytes read=87</span><br><span class="line">                HDFS: Number of bytes written=0</span><br><span class="line">                HDFS: Number of read operations=1</span><br><span class="line">                HDFS: Number of large read operations=0</span><br><span class="line">                HDFS: Number of write operations=0</span><br><span class="line">        Job Counters </span><br><span class="line">                Launched map tasks=1</span><br><span class="line">                Other local map tasks=1</span><br><span class="line">                Total time spent by all maps in occupied slots (ms)=13618</span><br><span class="line">                Total time spent by all reduces in occupied slots (ms)=0</span><br><span class="line">                Total time spent by all map tasks (ms)=13618</span><br><span class="line">                Total vcore-milliseconds taken by all map tasks=13618</span><br><span class="line">                Total megabyte-milliseconds taken by all map tasks=13944832</span><br><span class="line">        Map-Reduce Framework</span><br><span class="line">                Map input records=300000</span><br><span class="line">                Map output records=300000</span><br><span class="line">                Input split bytes=87</span><br><span class="line">                Spilled Records=0</span><br><span class="line">                Failed Shuffles=0</span><br><span class="line">                Merged Map outputs=0</span><br><span class="line">                GC time elapsed (ms)=217</span><br><span class="line">                CPU time spent (ms)=8620</span><br><span class="line">                Physical memory (bytes) snapshot=425291776</span><br><span class="line">                Virtual memory (bytes) snapshot=2816741376</span><br><span class="line">                Total committed heap usage (bytes)=321388544</span><br><span class="line">                Peak Map Physical memory (bytes)=425291776</span><br><span class="line">                Peak Map Virtual memory (bytes)=2816741376</span><br><span class="line">        File Input Format Counters </span><br><span class="line">                Bytes Read=0</span><br><span class="line">        File Output Format Counters </span><br><span class="line">                Bytes Written=0</span><br><span class="line">2024-03-24 07:06:38,422 INFO mapreduce.ImportJobBase: Transferred 0 bytes in 69.6995 seconds (0 bytes/sec)</span><br><span class="line">2024-03-24 07:06:38,425 INFO mapreduce.ImportJobBase: Retrieved 300000 records.</span><br></pre></td></tr></table></figure>

<p>5ã€æŸ¥çœ‹ HBase ä¸­ <code>user_action</code> è¡¨æ•°æ®</p>
<p>ç°åœ¨ï¼Œå†æ¬¡åˆ‡æ¢åˆ° HBase Shell è¿è¡Œçš„é‚£ä¸ªç»ˆç«¯çª—å£ï¼Œåœ¨ <code>hbase&gt;</code> å‘½ä»¤æç¤ºç¬¦ä¸‹ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢åˆšæ‰å¯¼å…¥çš„æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åªæŸ¥è¯¢å‰é¢10è¡Œ</span></span><br><span class="line">scan &#x27;user_action&#x27;,&#123;LIMIT=&gt;10&#125;  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ROW                         COLUMN+CELL                                                                    </span><br><span class="line"> 1                          column=f1:behavior_type, timestamp=1711289186613, value=1                      </span><br><span class="line"> 1                          column=f1:item_category, timestamp=1711289186613, value=4076                   </span><br><span class="line"> 1                          column=f1:item_id, timestamp=1711289186613, value=285259775                    </span><br><span class="line"> 1                          column=f1:province, timestamp=1711289186613, value=\xE6\xB1\x9F\xE8\xA5\xBF    </span><br><span class="line"> 1                          column=f1:uid, timestamp=1711289186613, value=10001082                         </span><br><span class="line"> 1                          column=f1:visit_date, timestamp=1711289186613, value=2014-12-08                </span><br><span class="line"> 10                         column=f1:behavior_type, timestamp=1711289186613, value=1                      </span><br><span class="line"> 10                         column=f1:item_category, timestamp=1711289186613, value=10894                  </span><br><span class="line"> 10                         column=f1:item_id, timestamp=1711289186613, value=323339743                    </span><br><span class="line"> 10                         column=f1:province, timestamp=1711289186613, value=\xE6\xB5\x99\xE6\xB1\x9F    </span><br><span class="line"> 10                         column=f1:uid, timestamp=1711289186613, value=10001082                         </span><br><span class="line"> 10                         column=f1:visit_date, timestamp=1711289186613, value=2014-12-12                </span><br><span class="line"> 100                        column=f1:behavior_type, timestamp=1711289186613, value=1                      </span><br><span class="line"> 100                        column=f1:item_category, timestamp=1711289186613, value=10576                  </span><br><span class="line"> 100                        column=f1:item_id, timestamp=1711289186613, value=275221686                    </span><br><span class="line"> 100                        column=f1:province, timestamp=1711289186613, value=\xE9\xBB\x91\xE9\xBE\x99\xE6</span><br><span class="line">                            \xB1\x9F                                                                       </span><br><span class="line"> 100                        column=f1:uid, timestamp=1711289186613, value=10001082                         </span><br><span class="line"> 100                        column=f1:visit_date, timestamp=1711289186613, value=2014-12-02                </span><br><span class="line"> 1000                       column=f1:behavior_type, timestamp=1711289186910, value=1                      </span><br><span class="line"> 1000                       column=f1:item_category, timestamp=1711289186910, value=3381                   </span><br><span class="line"> 1000                       column=f1:item_id, timestamp=1711289186910, value=168463559                    </span><br><span class="line"> 1000                       column=f1:province, timestamp=1711289186910, value=\xE9\xA6\x99\xE6\xB8\xAF    </span><br><span class="line"> 1000                       column=f1:uid, timestamp=1711289186910, value=100068031                        </span><br><span class="line"> 1000                       column=f1:visit_date, timestamp=1711289186910, value=2014-12-02                </span><br><span class="line"> 10000                      column=f1:behavior_type, timestamp=1711289188323, value=1                      </span><br><span class="line"> 10000                      column=f1:item_category, timestamp=1711289188323, value=12488                  </span><br><span class="line"> 10000                      column=f1:item_id, timestamp=1711289188323, value=45571867                     </span><br><span class="line"> 10000                      column=f1:province, timestamp=1711289188323, value=\xE6\x96\xB0\xE7\x96\x86    </span><br><span class="line"> 10000                      column=f1:uid, timestamp=1711289188323, value=100198255                        </span><br><span class="line"> 10000                      column=f1:visit_date, timestamp=1711289188323, value=2014-12-05                </span><br><span class="line"> 100000                     column=f1:behavior_type, timestamp=1711289190040, value=1                      </span><br><span class="line"> 100000                     column=f1:item_category, timestamp=1711289190040, value=6580                   </span><br><span class="line"> 100000                     column=f1:item_id, timestamp=1711289190040, value=78973192                     </span><br><span class="line"> 100000                     column=f1:province, timestamp=1711289190040, value=\xE5\xA4\xA9\xE6\xB4\xA5\xE5</span><br><span class="line">                            \xB8\x82                                                                       </span><br><span class="line"> 100000                     column=f1:uid, timestamp=1711289190040, value=101480065                        </span><br><span class="line"> 100000                     column=f1:visit_date, timestamp=1711289190040, value=2014-11-29                </span><br><span class="line"> 100001                     column=f1:behavior_type, timestamp=1711289190040, value=1                      </span><br><span class="line"> 100001                     column=f1:item_category, timestamp=1711289190040, value=3472                   </span><br><span class="line"> 100001                     column=f1:item_id, timestamp=1711289190040, value=34929314                     </span><br><span class="line"> 100001                     column=f1:province, timestamp=1711289190040, value=\xE5\xB9\xBF\xE8\xA5\xBF    </span><br><span class="line"> 100001                     column=f1:uid, timestamp=1711289190040, value=101480065                        </span><br><span class="line"> 100001                     column=f1:visit_date, timestamp=1711289190040, value=2014-12-15                </span><br><span class="line"> 100002                     column=f1:behavior_type, timestamp=1711289190040, value=1                      </span><br><span class="line"> 100002                     column=f1:item_category, timestamp=1711289190040, value=10392                  </span><br><span class="line"> 100002                     column=f1:item_id, timestamp=1711289190040, value=401104894                    </span><br><span class="line"> 100002                     column=f1:province, timestamp=1711289190040, value=\xE5\x8C\x97\xE4\xBA\xAC\xE5</span><br><span class="line">                            \xB8\x82                                                                       </span><br><span class="line"> 100002                     column=f1:uid, timestamp=1711289190040, value=101480065                        </span><br><span class="line"> 100002                     column=f1:visit_date, timestamp=1711289190040, value=2014-11-29                </span><br><span class="line"> 100003                     column=f1:behavior_type, timestamp=1711289190040, value=1                      </span><br><span class="line"> 100003                     column=f1:item_category, timestamp=1711289190040, value=5894                   </span><br><span class="line"> 100003                     column=f1:item_id, timestamp=1711289190040, value=217913901                    </span><br><span class="line"> 100003                     column=f1:province, timestamp=1711289190040, value=\xE7\x94\x98\xE8\x82\x83    </span><br><span class="line"> 100003                     column=f1:uid, timestamp=1711289190040, value=101480065                        </span><br><span class="line"> 100003                     column=f1:visit_date, timestamp=1711289190040, value=2014-12-04                </span><br><span class="line"> 100004                     column=f1:behavior_type, timestamp=1711289190040, value=1                      </span><br><span class="line"> 100004                     column=f1:item_category, timestamp=1711289190040, value=12189                  </span><br><span class="line"> 100004                     column=f1:item_id, timestamp=1711289190040, value=295053167                    </span><br><span class="line"> 100004                     column=f1:province, timestamp=1711289190040, value=\xE6\xB9\x96\xE5\x8C\x97    </span><br><span class="line"> 100004                     column=f1:uid, timestamp=1711289190040, value=101480065                        </span><br><span class="line"> 100004                     column=f1:visit_date, timestamp=1711289190040, value=2014-11-26                </span><br><span class="line">10 row(s)</span><br><span class="line">Took 0.3723 seconds </span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œæˆ‘ä»¬ç”¨ <code>limit10</code> æ˜¯è¿”å› HBase è¡¨ä¸­çš„å‰é¢10è¡Œæ•°æ®ï¼Œä½†æ˜¯ï¼Œä¸Šé¢çš„ç»“æœï¼Œä» â€œè¡Œæ•°â€ æ¥çœ‹ï¼Œç»™äººä¸€ç§é”™è¯¯ï¼Œä¼¼ä¹ä¸æ˜¯10è¡Œï¼Œè¦è¿œè¿œå¤šäº10è¡Œã€‚è¿™æ˜¯å› ä¸ºï¼ŒHBase åœ¨æ˜¾ç¤ºæ•°æ®çš„æ—¶å€™ï¼Œå’Œå…³ç³»å‹æ•°æ®åº“ MySQL æ˜¯ä¸åŒçš„ï¼Œæ¯è¡Œæ˜¾ç¤ºçš„ä¸æ˜¯ä¸€è¡Œè®°å½•ï¼Œè€Œæ˜¯ä¸€ä¸ª â€œå•å…ƒæ ¼â€ã€‚</p>
<h1 id="4-ä½¿ç”¨HBase-Java-APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­"><a href="#4-ä½¿ç”¨HBase-Java-APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­" class="headerlink" title="4. ä½¿ç”¨HBase Java APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­"></a>4. ä½¿ç”¨HBase Java APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­</h1><p>1ã€å¯åŠ¨ Hadoop é›†ç¾¤ã€HBase æœåŠ¡</p>
<p>è¯·é¦–å…ˆç¡®ä¿å¯åŠ¨äº† Hadoop é›†ç¾¤å’Œ HBase æœåŠ¡ã€‚å¦‚æœè¿˜æ²¡æœ‰å¯åŠ¨ï¼Œè¯·åœ¨Linux ç³»ç»Ÿä¸­æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ã€‚</p>
<p>é¦–å…ˆï¼ŒæŒ‰ç…§ä¸‹é¢å‘½ä»¤å¯åŠ¨ Hadoopã€HBaseï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ Hadoop</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ HBase</span></span><br><span class="line">start-hbase.sh</span><br></pre></td></tr></table></figure>

<p>2ã€æ•°æ®å‡†å¤‡</p>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™ Java ç¨‹åºï¼Œç›´æ¥ä» HDFS ä¸­è¯»å–æ•°æ®åŠ è½½åˆ° HBaseã€‚ä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬å±•ç¤ºçš„æ˜¯å¦‚ä½•ç”¨ JAVA ç¨‹åºæŠŠæœ¬åœ°æ•°æ®å¯¼å…¥åˆ° HBase ä¸­ã€‚ä½ åªè¦æŠŠç¨‹åºåšç®€å•ä¿®æ”¹ï¼Œå°±å¯ä»¥å®ç°ä» HDFS ä¸­è¯»å–æ•°æ®åŠ è½½åˆ° HBaseã€‚</p>
<p>é¦–å…ˆï¼Œè¯·å°†ä¹‹å‰çš„ <code>user_action</code> æ•°æ®ä» HDFS å¤åˆ¶åˆ° Linux ç³»ç»Ÿçš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/bigdatacase/dataset</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°† HDFS ä¸Šçš„ user_action æ•°æ®å¤åˆ¶åˆ°æœ¬åœ°å½“å‰ç›®å½•ï¼Œæ³¨æ„<span class="string">&#x27;.&#x27;</span>è¡¨ç¤ºå½“å‰ç›®å½•</span></span><br><span class="line">hdfs dfs -get /user/hive/warehouse/dblab.db/user_action .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å‰ 10 è¡Œæ•°æ®</span></span><br><span class="line">cat ./user_action/* | head -10</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1       10001082        285259775       1       4076    2014-12-08      æ±Ÿè¥¿</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é™•è¥¿</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      æ²³å—</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      é‡åº†å¸‚</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      äº‘å—</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å®‰å¾½</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      æµ™æ±Ÿ</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å°†00000*æ–‡ä»¶å¤åˆ¶ä¸€ä»½é‡å‘½åä¸ºuser_action.outputï¼Œ*è¡¨ç¤ºé€šé…ç¬¦</span></span><br><span class="line">cat ./user_action/00000* &gt; user_action.output</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹user_action.outputå‰10è¡Œ</span></span><br><span class="line">head user_action.output</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![muyoukule_2024-03-25_10-38-00](./æ•°æ®äº’å¯¼/muyoukule_2024-03-25_10-38-00.png)1       10001082        285259775       1       4076    2014-12-08      æ±Ÿè¥¿</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      è¥¿è—</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      è´µå·</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      å¹¿è¥¿</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é™•è¥¿</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      æ²³å—</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      é‡åº†å¸‚</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      äº‘å—</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å®‰å¾½</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      æµ™æ±Ÿ</span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™æ•°æ®å¯¼å…¥ç¨‹åº</p>
<p>è¿™é‡Œé‡‡ç”¨ IDEA ç¼–å†™ Java ç¨‹åºå®ç° HBase æ•°æ®å¯¼å…¥åŠŸèƒ½ã€‚</p>
<p>è¯·ä½¿ç”¨ IDEA ç¼–å†™ ImportHBase ç¨‹åºï¼ˆ Java ä»£ç åœ¨æœ¬æ–‡æœ€åçš„é™„å½•éƒ¨åˆ†ï¼‰ï¼Œå¹¶æ‰“åŒ…æˆå¯æ‰§è¡Œ jar åŒ…ï¼Œå‘½åä¸º ImportHBase.jarã€‚</p>
<p>ç„¶åï¼Œè¯·åœ¨ <code>/usr/local/bigdatacase/</code> ç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ª hbase å­ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾ ImportHBase.jarã€‚</p>
<p>IEDA æ‰“åŒ…æˆå¯æ‰§è¡Œ jar åŒ…ï¼š</p>
<p>å·¦ä¸Šè§’ <code>File</code> â€“&gt; Project Structure æ‰“å¼€å¦‚ä¸‹ç•Œé¢ï¼Œç‚¹å‡» <code>Artifacts</code> â€“&gt; <code>From moudles with dependencies</code> ï¼Œç„¶åä¾æ¬¡æ“ä½œï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IEDA%20%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%20jar%20%E5%8C%851.png" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IEDA%20%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%20jar%20%E5%8C%852.png" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IEDA%20%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%20jar%20%E5%8C%853.png" style="zoom: 50%;">

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IEDA%20%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%20jar%20%E5%8C%854.png"></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IEDA%20%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%20jar%20%E5%8C%855.png"></p>
<p>ç„¶åå°±å¯ä»¥åœ¨è®¾ç½®çš„ jar åŒ…è¾“å‡ºè·¯å¾„ä¸‹æ‰¾åˆ°å¯¹åº” jar åŒ…ã€‚</p>
<p>4ã€æ•°æ®å¯¼å…¥</p>
<p>ä½¿ç”¨ Java ç¨‹åºå°†æ•°æ®ä»æœ¬åœ°å¯¼å…¥ HBase ä¸­ï¼Œå¯¼å…¥å‰ï¼Œè¯·å…ˆæ¸…ç©º user_action è¡¨ã€‚</p>
<p>è¯·åœ¨ä¹‹å‰å·²ç»æ‰“å¼€çš„ HBase Shel lçª—å£ä¸­ï¼ˆä¹Ÿå°±æ˜¯åœ¨ <code>hbase&gt;</code> å‘½ä»¤æç¤ºç¬¦ä¸‹ï¼‰æ‰§è¡Œä¸‹é¢æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">truncate &#x27;user_action&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Truncating &#x27;user_action&#x27; table (it may take a while):</span><br><span class="line">Disabling table...</span><br><span class="line">Truncating table...</span><br><span class="line">Took 2.3970 seconds </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤ä»¥åå†æŸ¥çœ‹å°±æ²¡æœ‰è®°å½•äº†</span></span><br><span class="line">scan &#x27;user_action&#x27;,&#123;LIMIT=&gt;10&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ROW                   COLUMN+CELL                                               </span><br><span class="line">0 row(s)</span><br><span class="line">Took 0.0542 seconds </span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å°±å¯ä»¥è¿è¡Œ hadoop jar å‘½ä»¤è¿è¡Œç¨‹åºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hadoop jar /usr/local/bigdatacase/hbase/ImportHBase.jar HBaseImportTest /usr/local/bigdatacase/dataset/user_action.output</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤è§£é‡Šå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/local/hadoop/bin/hadoop jar  #hadoop jaråŒ…æ‰§è¡Œæ–¹å¼</span><br><span class="line">/usr/local/bigdatacase/hbase/ImportHBase.jar  #jaråŒ…çš„è·¯å¾„</span><br><span class="line">HBaseImportTest   #ä¸»å‡½æ•°å…¥å£ </span><br><span class="line">/usr/local/bigdatacase/dataset/user_action.output  #mainæ–¹æ³•æ¥æ”¶çš„å‚æ•°argsï¼Œç”¨æ¥æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„è·¯å¾„</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‘½ä»¤å¤§æ¦‚ä¼šæ‰§è¡Œ3åˆ†é’Ÿå·¦å³ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå±å¹•ä¸Šä¼šæ‰“å°å‡ºæ‰§è¡Œè¿›åº¦ï¼Œæ¯æ‰§è¡Œ1ä¸‡æ¡ï¼Œå¯¹æ‰“å°å‡ºä¸€è¡Œä¿¡æ¯ï¼Œæ‰€ä»¥ï¼Œæ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹å±å¹•ä¸Šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10000</span><br><span class="line">20000</span><br><span class="line">30000</span><br><span class="line">40000</span><br><span class="line">50000</span><br><span class="line">60000</span><br><span class="line">70000</span><br><span class="line">80000</span><br><span class="line">90000</span><br><span class="line">100000</span><br><span class="line">110000</span><br><span class="line">120000</span><br><span class="line">130000</span><br><span class="line">140000</span><br><span class="line">150000</span><br><span class="line">160000</span><br><span class="line">170000</span><br><span class="line">180000</span><br><span class="line">190000</span><br><span class="line">200000</span><br><span class="line">210000</span><br><span class="line">220000</span><br><span class="line">230000</span><br><span class="line">240000</span><br><span class="line">250000</span><br><span class="line">260000</span><br><span class="line">270000</span><br><span class="line">280000</span><br><span class="line">290000</span><br><span class="line">300000</span><br><span class="line">Total Time: 140506 ms</span><br></pre></td></tr></table></figure>

<p>5ã€æŸ¥çœ‹ HBase ä¸­ user_action è¡¨æ•°æ®</p>
<p>ä¸‹é¢ï¼Œå†æ¬¡åˆ‡æ¢åˆ° HBase Shell çª—å£ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åªæŸ¥è¯¢å‰é¢10è¡Œ</span></span><br><span class="line">scan &#x27;user_action&#x27;,&#123;LIMIT=&gt;10&#125;  </span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥å¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„æŸ¥è¯¢ç»“æœäº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ROW                                           COLUMN+CELL                                                                                                                         </span><br><span class="line"> 1                                            column=f1:behavior_type, timestamp=1711334492967, value=1                                                                           </span><br><span class="line"> 1                                            column=f1:date, timestamp=1711334492967, value=2014-12-08                                                                           </span><br><span class="line"> 1                                            column=f1:item_category, timestamp=1711334492967, value=4076                                                                        </span><br><span class="line"> 1                                            column=f1:item_id, timestamp=1711334492967, value=285259775                                                                         </span><br><span class="line"> 1                                            column=f1:province, timestamp=1711334492967, value=\xE6\xB1\x9F\xE8\xA5\xBF                                                         </span><br><span class="line"> 1                                            column=f1:uid, timestamp=1711334492967, value=10001082                                                                              </span><br><span class="line"> 10                                           column=f1:behavior_type, timestamp=1711334493000, value=1                                                                           </span><br><span class="line"> 10                                           column=f1:date, timestamp=1711334493000, value=2014-12-12                                                                           </span><br><span class="line"> 10                                           column=f1:item_category, timestamp=1711334493000, value=10894                                                                       </span><br><span class="line"> 10                                           column=f1:item_id, timestamp=1711334493000, value=323339743                                                                         </span><br><span class="line"> 10                                           column=f1:province, timestamp=1711334493000, value=\xE6\xB5\x99\xE6\xB1\x9F                                                         </span><br><span class="line"> 10                                           column=f1:uid, timestamp=1711334493000, value=10001082                                                                              </span><br><span class="line"> 100                                          column=f1:behavior_type, timestamp=1711334493295, value=1                                                                           </span><br><span class="line"> 100                                          column=f1:date, timestamp=1711334493295, value=2014-12-02                                                                           </span><br><span class="line"> 100                                          column=f1:item_category, timestamp=1711334493295, value=10576                                                                       </span><br><span class="line"> 100                                          column=f1:item_id, timestamp=1711334493295, value=275221686                                                                         </span><br><span class="line"> 100                                          column=f1:province, timestamp=1711334493295, value=\xE9\xBB\x91\xE9\xBE\x99\xE6\xB1\x9F                                             </span><br><span class="line"> 100                                          column=f1:uid, timestamp=1711334493295, value=10001082                                                                              </span><br><span class="line"> 1000                                         column=f1:behavior_type, timestamp=1711334494583, value=1                                                                           </span><br><span class="line"> 1000                                         column=f1:date, timestamp=1711334494583, value=2014-12-02                                                                           </span><br><span class="line"> 1000                                         column=f1:item_category, timestamp=1711334494583, value=3381                                                                        </span><br><span class="line"> 1000                                         column=f1:item_id, timestamp=1711334494583, value=168463559                                                                         </span><br><span class="line"> 1000                                         column=f1:province, timestamp=1711334494583, value=\xE9\xA6\x99\xE6\xB8\xAF                                                         </span><br><span class="line"> 1000                                         column=f1:uid, timestamp=1711334494583, value=100068031                                                                             </span><br><span class="line"> 10000                                        column=f1:behavior_type, timestamp=1711334500210, value=1                                                                           </span><br><span class="line"> 10000                                        column=f1:date, timestamp=1711334500210, value=2014-12-05                                                                           </span><br><span class="line"> 10000                                        column=f1:item_category, timestamp=1711334500210, value=12488                                                                       </span><br><span class="line"> 10000                                        column=f1:item_id, timestamp=1711334500210, value=45571867                                                                          </span><br><span class="line"> 10000                                        column=f1:province, timestamp=1711334500210, value=\xE6\x96\xB0\xE7\x96\x86                                                         </span><br><span class="line"> 10000                                        column=f1:uid, timestamp=1711334500210, value=100198255                                                                             </span><br><span class="line"> 100000                                       column=f1:behavior_type, timestamp=1711334543592, value=1                                                                           </span><br><span class="line"> 100000                                       column=f1:date, timestamp=1711334543592, value=2014-11-29                                                                           </span><br><span class="line"> 100000                                       column=f1:item_category, timestamp=1711334543592, value=6580                                                                        </span><br><span class="line"> 100000                                       column=f1:item_id, timestamp=1711334543592, value=78973192                                                                          </span><br><span class="line"> 100000                                       column=f1:province, timestamp=1711334543592, value=\xE5\xA4\xA9\xE6\xB4\xA5\xE5\xB8\x82                                             </span><br><span class="line"> 100000                                       column=f1:uid, timestamp=1711334543592, value=101480065                                                                             </span><br><span class="line"> 100001                                       column=f1:behavior_type, timestamp=1711334543592, value=1                                                                           </span><br><span class="line"> 100001                                       column=f1:date, timestamp=1711334543592, value=2014-12-15                                                                           </span><br><span class="line"> 100001                                       column=f1:item_category, timestamp=1711334543592, value=3472                                                                        </span><br><span class="line"> 100001                                       column=f1:item_id, timestamp=1711334543592, value=34929314                                                                          </span><br><span class="line"> 100001                                       column=f1:province, timestamp=1711334543592, value=\xE5\xB9\xBF\xE8\xA5\xBF                                                         </span><br><span class="line"> 100001                                       column=f1:uid, timestamp=1711334543592, value=101480065                                                                             </span><br><span class="line"> 100002                                       column=f1:behavior_type, timestamp=1711334543593, value=1                                                                           </span><br><span class="line"> 100002                                       column=f1:date, timestamp=1711334543593, value=2014-11-29                                                                           </span><br><span class="line"> 100002                                       column=f1:item_category, timestamp=1711334543593, value=10392                                                                       </span><br><span class="line"> 100002                                       column=f1:item_id, timestamp=1711334543593, value=401104894                                                                         </span><br><span class="line"> 100002                                       column=f1:province, timestamp=1711334543593, value=\xE5\x8C\x97\xE4\xBA\xAC\xE5\xB8\x82                                             </span><br><span class="line"> 100002                                       column=f1:uid, timestamp=1711334543593, value=101480065                                                                             </span><br><span class="line"> 100003                                       column=f1:behavior_type, timestamp=1711334543593, value=1                                                                           </span><br><span class="line"> 100003                                       column=f1:date, timestamp=1711334543593, value=2014-12-04                                                                           </span><br><span class="line"> 100003                                       column=f1:item_category, timestamp=1711334543593, value=5894                                                                        </span><br><span class="line"> 100003                                       column=f1:item_id, timestamp=1711334543593, value=217913901                                                                         </span><br><span class="line"> 100003                                       column=f1:province, timestamp=1711334543593, value=\xE7\x94\x98\xE8\x82\x83                                                         </span><br><span class="line"> 100003                                       column=f1:uid, timestamp=1711334543593, value=101480065                                                                             </span><br><span class="line"> 100004                                       column=f1:behavior_type, timestamp=1711334543593, value=1                                                                           </span><br><span class="line"> 100004                                       column=f1:date, timestamp=1711334543593, value=2014-11-26                                                                           </span><br><span class="line"> 100004                                       column=f1:item_category, timestamp=1711334543593, value=12189                                                                       </span><br><span class="line"> 100004                                       column=f1:item_id, timestamp=1711334543593, value=295053167                                                                         </span><br><span class="line"> 100004                                       column=f1:province, timestamp=1711334543593, value=\xE6\xB9\x96\xE5\x8C\x97                                                         </span><br><span class="line"> 100004                                       column=f1:uid, timestamp=1711334543593, value=101480065                                                                             </span><br><span class="line">10 row(s)</span><br><span class="line">Took 0.2652 seconds </span><br></pre></td></tr></table></figure>

<p>å®éªŒé¡ºåˆ©ç»“æŸï¼</p>
<h1 id="é™„å½•ï¼šImportHBase-java"><a href="#é™„å½•ï¼šImportHBase-java" class="headerlink" title="é™„å½•ï¼šImportHBase.java"></a>é™„å½•ï¼šImportHBase.java</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HBaseImportTest</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Configuration config;</span><br><span class="line">    <span class="keyword">public</span> Table table;</span><br><span class="line">    <span class="keyword">public</span> HBaseAdmin admin;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> ConnectionFactory.createConnection();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HBaseImportTest</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        config = HBaseConfiguration.create();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            table = connection.getTable(TableName.valueOf(<span class="string">&quot;user_action&quot;</span>));</span><br><span class="line">            <span class="comment">// æ ¹æ®é…ç½®åˆ›å»ºè¿æ¥</span></span><br><span class="line">            connection = ConnectionFactory.createConnection(config);</span><br><span class="line">            <span class="comment">// è·å–Adminå®ä¾‹</span></span><br><span class="line">            admin = (HBaseAdmin) connection.getAdmin();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (args.length == <span class="number">0</span>) &#123;       <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯¥jaræ‰€ä½¿ç”¨çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°æ®é›†æ‰€å­˜æ”¾çš„è·¯å¾„</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;You must set input path!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> args[args.length - <span class="number">1</span>];  <span class="comment">//è¾“å…¥çš„æ–‡ä»¶è·¯å¾„æ˜¯æœ€åä¸€ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="type">HBaseImportTest</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HBaseImportTest</span>();</span><br><span class="line">        test.importLocalFileToHBase(fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    /usr/local/bigdatacase/dataset/user_action.output</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">importLocalFileToHBase</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">st</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(Files.newInputStream(Paths.get(fileName))));</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                count++;</span><br><span class="line">                put(line);</span><br><span class="line">                <span class="keyword">if</span> (count % <span class="number">10000</span> == <span class="number">0</span>)</span><br><span class="line">                    System.out.println(count);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (br != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    br.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                table.close(); <span class="comment">// must close the client</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">en2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;Total Time: &quot;</span> + (en2 - st) + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;deprecation&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(String line)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        String[] arr = line.split(<span class="string">&quot;\t&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">        String[] column = &#123;<span class="string">&quot;id&quot;</span>, <span class="string">&quot;uid&quot;</span>, <span class="string">&quot;item_id&quot;</span>, <span class="string">&quot;behavior_type&quot;</span>, <span class="string">&quot;item_category&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;province&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (arr.length == <span class="number">7</span>) &#123;</span><br><span class="line">            <span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(Bytes.toBytes(arr[<span class="number">0</span>]));<span class="comment">// rowkey</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">                put.addColumn(Bytes.toBytes(<span class="string">&quot;f1&quot;</span>), Bytes.toBytes(column[i]), Bytes.toBytes(arr[i]));</span><br><span class="line">            &#125;</span><br><span class="line">            table.put(put); <span class="comment">// put to server</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">(String rowkey, String columnFamily, String column,</span></span><br><span class="line"><span class="params">                    <span class="type">int</span> versions)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">st</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="type">Get</span> <span class="variable">get</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Get</span>(Bytes.toBytes(rowkey));</span><br><span class="line">        get.addColumn(Bytes.toBytes(columnFamily), Bytes.toBytes(column));</span><br><span class="line"></span><br><span class="line">        <span class="type">Scan</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>(get);</span><br><span class="line">        scanner.setMaxVersions(versions);</span><br><span class="line"></span><br><span class="line">        <span class="type">ResultScanner</span> <span class="variable">rsScanner</span> <span class="operator">=</span> table.getScanner(scanner);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Result result : rsScanner) &#123;</span><br><span class="line">            <span class="keyword">final</span> List&lt;Cell&gt; list = result.listCells();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">final</span> Cell kv : list) &#123;</span><br><span class="line">                System.out.println(Bytes.toStringBinary(kv.getValueArray()) + <span class="string">&quot;\t&quot;</span></span><br><span class="line">                        + kv.getTimestamp()); <span class="comment">// mid + time</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        rsScanner.close();</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">en2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;Total Time: &quot;</span> + (en2 - st) + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>BigData</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
        <tag>MySQL</tag>
        <tag>HBase</tag>
        <tag>Sqoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå…¥é—¨ï¼ˆä¸Šï¼‰</title>
    <url>/posts/Accidence-Spring-Volume-One/</url>
    <content><![CDATA[<p>Springå®˜ç½‘ï¼š<a href="https://spring.io/">https://spring.io/</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š</p>
<ul>
<li><a href="https://www.bilibili.com/video/BV1Ft4y1g7Fb/">Springè§†é¢‘é›¶åŸºç¡€å…¥é—¨åˆ°é«˜çº§ï¼ŒSpringå…¨å¥—è§†é¢‘æ•™ç¨‹è¯¦è§£</a></li>
<li><a href="https://www.bilibili.com/video/BV1Fi4y1S7ix/">é»‘é©¬ç¨‹åºå‘˜SSMæ¡†æ¶æ•™ç¨‹Springéƒ¨åˆ†</a></li>
</ul>
<p>æºç ä»“åº“ï¼š<a href="https://github.com/muyoukule/accidence-spring">muyoukule&#x2F;accidence-spring (github.com)</a></p>
<h1 id="0-Springç®€ä»‹"><a href="#0-Springç®€ä»‹" class="headerlink" title="0. Springç®€ä»‹"></a>0. Springç®€ä»‹</h1><p>Springæ˜¯ä¸€ä¸ªå¼€æºçš„Java EEåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œç”±Rod Johnsonåœ¨2002å¹´åˆ›å»ºï¼Œæ—¨åœ¨è§£å†³ä¼ä¸šçº§ç¼–ç¨‹å¼€å‘ä¸­çš„å¤æ‚æ€§ï¼Œå®ç°æ•æ·å¼€å‘ã€‚Springæ¡†æ¶æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å®¹å™¨ï¼Œç”¨äºç®¡ç†ä¸šåŠ¡ç›¸å…³çš„å¯¹è±¡ã€‚å®ƒé€šè¿‡æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ç­‰ç‰¹æ€§ï¼Œé™ä½äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæé«˜äº†ä»£ç çš„å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰</strong>ï¼šè¿™æ˜¯Springæ¡†æ¶ç®¡ç†å¯¹è±¡é—´ä¾èµ–å…³ç³»çš„ä¸»è¦æ‰‹æ®µã€‚é€šè¿‡ä¾èµ–æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡çš„ä¾èµ–å…³ç³»ä»ä»£ç ä¸­è§£è€¦å‡ºæ¥ï¼Œäº¤ç”±Springå®¹å™¨æ¥ç®¡ç†ã€‚è¿™æ ·ï¼Œå½“ä¾èµ–å…³ç³»å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</li>
<li><strong>é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAspect-Oriented Programmingï¼ŒAOPï¼‰</strong>ï¼šSpring AOPé€šè¿‡å®šä¹‰æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€å®‰å…¨ã€äº‹åŠ¡ç®¡ç†ç­‰ï¼‰ï¼Œå°†è¿™äº›å…³æ³¨ç‚¹ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»¥æ¨¡å—åŒ–çš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚è¿™æœ‰åŠ©äºå‡å°‘ä»£ç çš„é‡å¤ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li>
<li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šSpringæ¡†æ¶æä¾›äº†å¼ºå¤§çš„äº‹åŠ¡ç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥è½»æ¾åœ°å¤„ç†äº‹åŠ¡æ“ä½œï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚</li>
<li><strong>æ•°æ®è®¿é—®</strong>ï¼šSpringæ¡†æ¶å¯¹å¤šç§æ•°æ®è®¿é—®æŠ€æœ¯æä¾›äº†è‰¯å¥½çš„æ”¯æŒï¼Œå¦‚JDBCã€ORMæ¡†æ¶ï¼ˆå¦‚Hibernateã€MyBatisï¼‰ç­‰ï¼Œç®€åŒ–äº†æ•°æ®è®¿é—®å±‚çš„å¼€å‘ã€‚</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p>
<p>Springæ¡†æ¶å¹¿æ³›åº”ç”¨äºå„ç§Javaä¼ä¸šçº§åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼ŒåŒ…æ‹¬Webåº”ç”¨ã€RESTfulæœåŠ¡ã€æ‰¹å¤„ç†åº”ç”¨ç­‰ã€‚æ— è®ºæ˜¯æ„å»ºå¤§å‹çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè¿˜æ˜¯å¼€å‘å°å‹çš„åº”ç”¨ç¨‹åºï¼ŒSpringéƒ½èƒ½æä¾›å¼ºå¤§çš„æ”¯æŒå’Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>æ¨¡å—ç»„æˆ</strong>ï¼š</p>
<p>Springæ¡†æ¶ç”±å¤šä¸ªæ¨¡å—ç»„æˆï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½å’Œç”¨é€”ã€‚æ ¸å¿ƒå®¹å™¨ï¼ˆCore Containerï¼‰æ˜¯å…¶ä»–æ¨¡å—å»ºç«‹çš„åŸºç¡€ï¼Œä¸»è¦ç”±Beansæ¨¡å—ã€Coreæ¨¡å—ã€Contextæ¨¡å—ã€Context-supportæ¨¡å—å’ŒSpELï¼ˆSpring Expression Languageï¼‰æ¨¡å—ç»„æˆã€‚æ­¤å¤–ï¼Œè¿˜æœ‰æ•°æ®è®¿é—®&#x2F;é›†æˆï¼ˆData Access&#x2F;Integrationï¼‰å±‚ï¼ŒåŒ…æ‹¬JDBCã€ORMã€OXMã€JMSå’ŒTransactionsæ¨¡å—ç­‰ã€‚</p>
<p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<p>åœ¨ä½¿ç”¨ Spring æ¡†æ¶æ—¶ï¼Œä¸€èˆ¬é€šè¿‡ Maven æˆ– Gradle ç­‰æ„å»ºå·¥å…·å¯¼å…¥æ‰€éœ€çš„ä¾èµ–ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™ Spring åº”ç”¨ç¨‹åºï¼Œåˆ©ç”¨Spring çš„ IoC å’Œ AOP ç­‰ç‰¹æ€§æ¥ç®¡ç†å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å’Œæ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨ Spring æä¾›çš„æ•°æ®è®¿é—®å’Œäº‹åŠ¡ç®¡ç†ç­‰åŠŸèƒ½æ¥ç®€åŒ–åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚</p>
<h1 id="1-å…¥é—¨ç¨‹åº"><a href="#1-å…¥é—¨ç¨‹åº" class="headerlink" title="1. å…¥é—¨ç¨‹åº"></a>1. å…¥é—¨ç¨‹åº</h1><h2 id="1-1-IOCå…¥é—¨æ¡ˆä¾‹"><a href="#1-1-IOCå…¥é—¨æ¡ˆä¾‹" class="headerlink" title="1.1 IOCå…¥é—¨æ¡ˆä¾‹"></a>1.1 IOCå…¥é—¨æ¡ˆä¾‹</h2><h3 id="1-1-1-å‡†å¤‡å·¥ä½œ"><a href="#1-1-1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1.1.1 å‡†å¤‡å·¥ä½œ"></a>1.1.1 å‡†å¤‡å·¥ä½œ</h3><p>a. æ‰“å¼€IDEAåˆ›å»ºEmpty Projectï¼šspring</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E8%BE%93%E5%85%A5%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0.png" style="zoom: 67%;">

<p>b. è®¾ç½®JDKç‰ˆæœ¬17ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬17</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E8%AE%BE%E7%BD%AEJDK%E7%89%88%E6%9C%AC.png" style="zoom:67%;">

<p>c. è®¾ç½®IDEAçš„Mavenï¼šå…³è”è‡ªå·±çš„Maven</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%85%B3%E8%81%94Maven.png" style="zoom:67%;">

<p>d. åœ¨ç©ºçš„å·¥ç¨‹ä¸­åˆ›å»ºç¬¬ä¸€ä¸ªæ¨¡å—ï¼šspring-001</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%9D%97.png" style="zoom: 80%;">

<p>e. åˆ›å»ºå¥½çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E7%AC%AC%E4%B8%80%E4%B8%AASpring%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" style="zoom: 67%;">

<h3 id="1-1-2-åˆ›å»ºé¡¹ç›®"><a href="#1-1-2-åˆ›å»ºé¡¹ç›®" class="headerlink" title="1.1.2 åˆ›å»ºé¡¹ç›®"></a>1.1.2 åˆ›å»ºé¡¹ç›®</h3><p>a. åœ¨ <code>pom.xml</code> æ·»åŠ  Spring çš„ä¾èµ–jaråŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring contextä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--junit--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“åŠ å…¥ <code>spring context</code> çš„ä¾èµ–ä¹‹åï¼Œä¼šå…³è”å¼•å…¥å…¶ä»–ä¾èµ–ï¼š</p>
<ul>
<li><p><code>spring aop</code> ï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹</p>
</li>
<li><p><code>spring beans</code> ï¼šIoCæ ¸å¿ƒ</p>
</li>
<li><p><code>spring core</code> ï¼šspringçš„æ ¸å¿ƒå·¥å…·åŒ…</p>
</li>
<li><p><code>spring jcl</code> ï¼šspringçš„æ—¥å¿—åŒ…</p>
</li>
<li><p><code>spring expression</code> ï¼šspringè¡¨è¾¾å¼</p>
</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/spring%20context%E4%BE%9D%E8%B5%96.png"></p>
<p>b. æ·»åŠ æ¡ˆä¾‹ä¸­éœ€è¦çš„ç±»,åˆ›å»º <code>User</code> ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello userBean....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ·»åŠ springé…ç½®æ–‡ä»¶ <code>applicationContext.xml</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%B7%BB%E5%8A%A0spring%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png">

<p>d. åœ¨ <code>applicationContext.xml</code> é…ç½®æ–‡ä»¶ä¸­å®Œæˆ <code>bean</code> çš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--beanæ ‡ç­¾æ ‡ç¤ºé…ç½®bean,idå±æ€§æ ‡ç¤ºç»™beanèµ·åå­—,classå±æ€§è¡¨ç¤ºç»™beanå®šä¹‰ç±»å‹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>e. è·å–IOCå®¹å™¨</p>
<p>ä½¿ç”¨Springæä¾›çš„æ¥å£å®ŒæˆIOCå®¹å™¨çš„åˆ›å»ºï¼Œåˆ›å»ºAppç±»ï¼Œç¼–å†™mainæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–IOCå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. ä»å®¹å™¨ä¸­è·å–å¯¹è±¡è¿›è¡Œæ–¹æ³•è°ƒç”¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–IOCå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–å‡ºçš„å¯¹è±¡ä¸ºObjectç±»å‹ï¼Œéœ€è¦è¿›è¡Œå¼ºè½¬</span></span><br><span class="line">        <span class="comment">//User userBean = (User) ctx.getBean(&quot;userBean&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æˆ–è€…åœ¨å‚æ•°åæŒ‡å®šè¿”å›å€¼çš„ç±»å‹</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">        userBean.hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>g. è¿è¡Œ <code>main()</code> æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hello userBean....</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼ŒSpringçš„IOCå…¥é—¨æ¡ˆä¾‹å·²ç»å®Œæˆã€‚</p>
<h2 id="1-2-IOCå…¥é—¨æ¡ˆä¾‹è¯¦è§£"><a href="#1-2-IOCå…¥é—¨æ¡ˆä¾‹è¯¦è§£" class="headerlink" title="1.2 IOCå…¥é—¨æ¡ˆä¾‹è¯¦è§£"></a>1.2 IOCå…¥é—¨æ¡ˆä¾‹è¯¦è§£</h2><blockquote>
<p> Bean æ ‡ç­¾çš„ id å±æ€§å¯ä»¥é‡å¤å—ï¼Ÿ</p>
</blockquote>
<p>æ–°å»ºä¸€ä¸ª <code>Vip</code> ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>applicationContext.xml</code> é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º <code>bean</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--beanæ ‡ç­¾æ ‡ç¤ºé…ç½®bean,idå±æ€§æ ‡ç¤ºç»™beanèµ·åå­—,classå±æ€§è¡¨ç¤ºç»™beanå®šä¹‰ç±»å‹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Vip&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œ <code>main()</code> æ–¹æ³•æµ‹è¯•ï¼Œç¨‹åºæŠ¥é”™æç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/id%E5%B1%9E%E6%80%A7%E9%87%8D%E5%A4%8D.png"></p>
<p>é€šè¿‡æµ‹è¯•å¾—å‡ºï¼šåœ¨ spring çš„é…ç½®æ–‡ä»¶ä¸­ id æ˜¯ä¸èƒ½é‡åã€‚</p>
<blockquote>
<p>åº•å±‚æ˜¯æ€ä¹ˆåˆ›å»ºå¯¹è±¡çš„ï¼Œæ˜¯é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ— å‚æ•°æ„é€ æ–¹æ³•å—ï¼Ÿ</p>
</blockquote>
<p>åœ¨ <code>User</code> ç±»ä¸­æ·»åŠ æ— å‚æ„é€ æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Userçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello userBean....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Userçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br><span class="line">hello userBean....</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šåˆ›å»ºå¯¹è±¡æ—¶ç¡®å®è°ƒç”¨äº†æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚</p>
<blockquote>
<p>å¦‚æœæä¾›ä¸€ä¸ªæœ‰å‚æ•°æ„é€ æ–¹æ³•ï¼Œä¸æä¾›æ— å‚æ•°æ„é€ æ–¹æ³•ä¼šæ€æ ·å‘¢ï¼Ÿ</p>
</blockquote>
<p>æ³¨é‡Šæ‰ User ç±»ä¸­çš„æ— å‚æ„é€ æ–¹æ³•ï¼Œåœ¨ User ç±»ä¸­æ·»åŠ æœ‰å‚æ„é€ æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="comment">/*    public User() &#123;</span></span><br><span class="line"><span class="comment">        System.out.println(&quot;Userçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Userçš„æœ‰å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello userBean....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%97%A0%E5%8F%82%E6%95%B0%E6%9E%84%E9%80%A0%E4%B8%8D%E5%AD%98%E5%9C%A8.png"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šspring æ˜¯é€šè¿‡è°ƒç”¨ç±»çš„æ— å‚æ•°æ„é€ æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡çš„ï¼Œæ‰€ä»¥è¦æƒ³è®© spring ç»™ä½ åˆ›å»ºå¯¹è±¡ï¼Œå¿…é¡»ä¿è¯æ— å‚æ•°æ„é€ æ–¹æ³•æ˜¯å­˜åœ¨çš„ã€‚</p>
<blockquote>
<p>Springæ˜¯å¦‚ä½•åˆ›å»ºå¯¹è±¡çš„å‘¢ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// dom4jè§£æbeans.xmlæ–‡ä»¶ï¼Œä»ä¸­è·å–classçš„å…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">// é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.muyoukule.Bean.User&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŠŠåˆ›å»ºå¥½çš„å¯¹è±¡å­˜å‚¨åˆ°ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„å½“ä¸­äº†å‘¢ï¼Ÿ</p>
</blockquote>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png" style="zoom: 80%;">

<blockquote>
<p>springé…ç½®æ–‡ä»¶çš„åå­—å¯ä»¥éšæ„å‘½åï¼Œä¸”å¯ä»¥åˆ›å»ºå¤šä¸ªï¼Œå¹¶ä¸”åœ¨è¯»å–çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¸€å¹¶è¯»å–</p>
</blockquote>
<p>åœ¨ <code>applicationContext2.xml</code> é…ç½®æ–‡ä»¶ä¸­é…ç½® <code>vipBean</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Vip&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–IOCå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>, <span class="string">&quot;applicationContext2.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//æˆ–è€…åœ¨å‚æ•°åæŒ‡å®šè¿”å›å€¼çš„ç±»å‹</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">        System.out.println(userBean);</span><br><span class="line">        <span class="type">Vip</span> <span class="variable">vipBean</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;vipBean&quot;</span>, Vip.class);</span><br><span class="line">        System.out.println(vipBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Userçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br><span class="line">com.muyoukule.Bean.User@345965f2</span><br><span class="line">com.muyoukule.Bean.Vip@429bd883</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„ç±»å¿…é¡»æ˜¯è‡ªå®šä¹‰çš„å—ï¼Œå¯ä»¥ä½¿ç”¨JDKä¸­çš„ç±»å—ï¼Œä¾‹å¦‚ï¼šjava.util.Dateï¼Ÿ</p>
</blockquote>
<p>åœ¨ <code>applicationContext.xml</code> é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ <code>bean</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dateBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–IOCå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//æˆ–è€…åœ¨å‚æ•°åæŒ‡å®šè¿”å›å€¼çš„ç±»å‹</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">        System.out.println(userBean);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">dateBean</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;dateBean&quot;</span>);</span><br><span class="line">        System.out.println(dateBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Userçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br><span class="line">com.muyoukule.Bean.User@4d339552</span><br><span class="line">Mon May 08 23:36:09 CST 2023</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œåœ¨ spring é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„beanå¯ä»¥ä»»æ„ç±»ï¼Œåªè¦è¿™ä¸ªç±»ä¸æ˜¯æŠ½è±¡çš„ï¼Œå¹¶ä¸”æä¾›äº†æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚</p>
<blockquote>
<p><code>getBean()</code> æ–¹æ³•è¿”å›çš„ç±»å‹æ˜¯ <code>Object</code> ï¼Œå¦‚æœè®¿é—®å­ç±»çš„ç‰¹æœ‰å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œè¿˜éœ€è¦å‘ä¸‹è½¬å‹ï¼Œæœ‰å…¶å®ƒåŠæ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>ClassPathXmlApplicationContext</code> æ˜¯ä»ç±»è·¯å¾„ä¸­åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰åœ¨ç±»è·¯å¾„å½“ä¸­ï¼Œåˆåº”è¯¥å¦‚ä½•åŠ è½½é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;d:/applicationContext.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰åœ¨ç±»è·¯å¾„ä¸­çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ <code>FileSystemXmlApplicationContext</code> ç±»è¿›è¡ŒåŠ è½½é…ç½®æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼è¾ƒå°‘ç”¨ã€‚ä¸€èˆ¬éƒ½æ˜¯å°†é…ç½®æ–‡ä»¶æ”¾åˆ°ç±»è·¯å¾„å½“ä¸­ï¼Œè¿™æ ·å¯ç§»æ¤æ€§æ›´å¼ºã€‚</p>
<blockquote>
<p><code>ApplicationContext</code> çš„è¶…çº§çˆ¶æ¥å£ <code>BeanFactory</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">vipBean</span> <span class="operator">=</span> beanFactory.getBean(<span class="string">&quot;vipBean&quot;</span>);</span><br><span class="line">System.out.println(vipBean);</span><br></pre></td></tr></table></figure>

<p><code>BeanFactory</code> æ˜¯ Spring å®¹å™¨çš„è¶…çº§æ¥å£ã€‚<code>ApplicationContext</code> æ˜¯ <code>BeanFactory</code> çš„å­æ¥å£ã€‚</p>
<h2 id="1-3-Springå¯ç”¨Log4j2æ—¥å¿—æ¡†æ¶"><a href="#1-3-Springå¯ç”¨Log4j2æ—¥å¿—æ¡†æ¶" class="headerlink" title="1.3 Springå¯ç”¨Log4j2æ—¥å¿—æ¡†æ¶"></a>1.3 Springå¯ç”¨Log4j2æ—¥å¿—æ¡†æ¶</h2><p>ä»Spring5ä¹‹åï¼ŒSpringæ¡†æ¶æ”¯æŒé›†æˆçš„æ—¥å¿—æ¡†æ¶æ˜¯ <code>Log4j2</code> ã€‚å¦‚ä½•å¯ç”¨æ—¥å¿—æ¡†æ¶ï¼š</p>
<p>a. å¼•å…¥ <code>Log4j2</code> çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--log4j2çš„ä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-slf4j2-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. åœ¨ç±»çš„æ ¹è·¯å¾„ä¸‹æä¾› <code>log4j2.xml</code> é…ç½®æ–‡ä»¶ï¼ˆæ–‡ä»¶åå›ºå®šä¸ºï¼š<code>log4j2.xml</code> ï¼Œæ–‡ä»¶å¿…é¡»æ”¾åˆ°ç±»æ ¹è·¯å¾„ä¸‹ã€‚ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            levelæŒ‡å®šæ—¥å¿—çº§åˆ«ï¼Œä»ä½åˆ°é«˜çš„ä¼˜å…ˆçº§ï¼š</span></span><br><span class="line"><span class="comment">                ALL &lt; TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;springlog&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¾“å‡ºæ—¥å¿—ä¿¡æ¯åˆ°æ§åˆ¶å°--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;springlog&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ§åˆ¶æ—¥å¿—è¾“å‡ºçš„æ ¼å¼--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss SSS&#125; [%t] %-3level %logger&#123;1024&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="2-Springå¯¹IoCçš„å®ç°"><a href="#2-Springå¯¹IoCçš„å®ç°" class="headerlink" title="2. Springå¯¹IoCçš„å®ç°"></a>2. Springå¯¹IoCçš„å®ç°</h1><h2 id="2-1-IoC-æ§åˆ¶åè½¬"><a href="#2-1-IoC-æ§åˆ¶åè½¬" class="headerlink" title="2.1 IoC æ§åˆ¶åè½¬"></a>2.1 IoC æ§åˆ¶åè½¬</h2><ul>
<li><p>æ§åˆ¶åè½¬æ˜¯ä¸€ç§æ€æƒ³ã€‚</p>
</li>
<li><p>æ§åˆ¶åè½¬æ˜¯ä¸ºäº†é™ä½ç¨‹åºè€¦åˆåº¦ï¼Œæé«˜ç¨‹åºæ‰©å±•åŠ›ï¼Œè¾¾åˆ°OCPåŸåˆ™ï¼Œè¾¾åˆ°DIPåŸåˆ™ã€‚</p>
</li>
<li><p>æ§åˆ¶åè½¬ï¼Œåè½¬çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>å°†å¯¹è±¡çš„åˆ›å»ºæƒåˆ©äº¤å‡ºå»ï¼Œäº¤ç»™ç¬¬ä¸‰æ–¹å®¹å™¨è´Ÿè´£ã€‚</li>
<li>å°†å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´å…³ç³»çš„ç»´æŠ¤æƒäº¤å‡ºå»ï¼Œäº¤ç»™ç¬¬ä¸‰æ–¹å®¹å™¨è´Ÿè´£ã€‚</li>
</ul>
</li>
<li><p>æ§åˆ¶åè½¬è¿™ç§æ€æƒ³å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<ul>
<li>DIï¼ˆDependency Injectionï¼‰ï¼šä¾èµ–æ³¨å…¥</li>
</ul>
</li>
</ul>
<h2 id="2-2-ä¾èµ–æ³¨å…¥"><a href="#2-2-ä¾èµ–æ³¨å…¥" class="headerlink" title="2.2 ä¾èµ–æ³¨å…¥"></a>2.2 ä¾èµ–æ³¨å…¥</h2><p>ä¾èµ–æ³¨å…¥å®ç°äº†æ§åˆ¶åè½¬çš„æ€æƒ³ã€‚Springé€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼æ¥å®ŒæˆBeanç®¡ç†çš„ã€‚</p>
<p>Beanç®¡ç†è¯´çš„æ˜¯ï¼š<code>Bean</code> å¯¹è±¡çš„åˆ›å»ºï¼Œä»¥åŠBeanå¯¹è±¡ä¸­å±æ€§çš„èµ‹å€¼ï¼ˆæˆ–è€…å«åš <code>Bean</code> å¯¹è±¡ä¹‹é—´å…³ç³»çš„ç»´æŠ¤ï¼‰ã€‚</p>
<p>ä¾èµ–æ³¨å…¥ï¼š</p>
<ul>
<li>ä¾èµ–æŒ‡çš„æ˜¯å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚</li>
<li>æ³¨å…¥æŒ‡çš„æ˜¯ä¸€ç§æ•°æ®ä¼ é€’è¡Œä¸ºï¼Œé€šè¿‡æ³¨å…¥è¡Œä¸ºæ¥è®©å¯¹è±¡å’Œå¯¹è±¡äº§ç”Ÿå…³ç³»ã€‚</li>
</ul>
<p>ä¾èµ–æ³¨å…¥å¸¸è§çš„å®ç°æ–¹å¼åŒ…æ‹¬ä¸¤ç§ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§ï¼šsetæ³¨å…¥</li>
<li>ç¬¬äºŒç§ï¼šæ„é€ æ³¨å…¥</li>
</ul>
<p>æ–°å»ºæ¨¡å—ï¼šspring-002</p>
<h3 id="2-2-1-setæ³¨å…¥"><a href="#2-2-1-setæ³¨å…¥" class="headerlink" title="2.2.1 setæ³¨å…¥"></a>2.2.1 setæ³¨å…¥</h3><p>set æ³¨å…¥ï¼ŒåŸºäº set æ–¹æ³•å®ç°çš„ï¼Œåº•å±‚ä¼šé€šè¿‡åå°„æœºåˆ¶è°ƒç”¨å±æ€§å¯¹åº”çš„ set æ–¹æ³•ç„¶åç»™å±æ€§èµ‹å€¼ã€‚è¿™ç§æ–¹å¼è¦æ±‚å±æ€§å¿…é¡»å¯¹å¤–æä¾› set æ–¹æ³•ã€‚</p>
<blockquote>
<p>å¯¹å¤–æä¾› set æ–¹æ³•</p>
</blockquote>
<p>a. åˆ›å»º <code>UserDao</code> ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åˆ›å»º <code>UserService</code> ç±»ï¼Œå¹¶ä¸º <code>UserDao</code> æä¾› <code>setter</code> æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨setæ–¹å¼æ³¨å…¥ï¼Œå¿…é¡»æä¾›setæ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment">// åå°„æœºåˆ¶è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ç»™å±æ€§èµ‹å€¼çš„ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserService...&quot;</span>);</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åœ¨é…ç½®æ–‡ä»¶ä¸­å®Œæˆ <code>bean</code> çš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--propertyæ ‡ç­¾è¡¨ç¤ºé…ç½®å½“å‰beançš„å±æ€§,nameå±æ€§è¡¨ç¤ºé…ç½®å“ªä¸€ä¸ªå…·ä½“çš„å±æ€§,refå±æ€§è¡¨ç¤ºå‚ç…§å“ªä¸€ä¸ªbean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSetDI</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userServiceBean&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. è¿è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UserService...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<p>å®ç°åŸç†ï¼š</p>
<ul>
<li><p>é€šè¿‡ <code>property</code> æ ‡ç­¾è·å–åˆ°å±æ€§åï¼š<code>userDao</code> ã€‚</p>
</li>
<li><p>é€šè¿‡å±æ€§åæ¨æ–­å‡ºsetæ–¹æ³•åï¼š<code>setUserDao</code> ã€‚</p>
</li>
<li><p>é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨ <code>setUserDao()</code> æ–¹æ³•ç»™å±æ€§èµ‹å€¼ã€‚</p>
</li>
<li><p><code>property</code> æ ‡ç­¾çš„ <code>name</code> æ˜¯å±æ€§åã€‚</p>
</li>
<li><p><code>property</code> æ ‡ç­¾çš„ <code>ref</code> æ˜¯è¦æ³¨å…¥çš„ <code>bean</code> å¯¹è±¡çš„ idã€‚ï¼ˆé€šè¿‡ <code>ref</code> å±æ€§æ¥å®Œæˆ <code>bean</code> çš„è£…é…ï¼Œè¿™æ˜¯ <code>bean</code>æœ€ç®€å•çš„ä¸€ç§è£…é…æ–¹å¼ã€‚è£…é…æŒ‡çš„æ˜¯ï¼šåˆ›å»ºç³»ç»Ÿç»„ä»¶ä¹‹é—´å…³è”çš„åŠ¨ä½œï¼‰</p>
</li>
</ul>
<blockquote>
<p>æŠŠsetæ–¹æ³•æ³¨é‡Šæ‰</p>
</blockquote>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/set%E6%96%B9%E6%B3%95%E8%A2%AB%E6%B3%A8%E9%87%8A.png"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œåº•å±‚å®é™…ä¸Šè°ƒç”¨äº† <code>setUserDao()</code> æ–¹æ³•ã€‚æ‰€ä»¥éœ€è¦ç¡®ä¿è¿™ä¸ªæ–¹æ³•çš„å­˜åœ¨ã€‚</p>
<blockquote>
<p>æŠŠå±æ€§åä¿®æ”¹ä¸€ä¸‹ï¼Œä½†æ–¹æ³•åè¿˜æ˜¯ <code>setUserDao()</code> </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao aaa;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨setæ–¹å¼æ³¨å…¥ï¼Œå¿…é¡»æä¾›setæ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment">// åå°„æœºåˆ¶è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ç»™å±æ€§èµ‹å€¼çš„ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aaa = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserService...&quot;</span>);</span><br><span class="line">        aaa.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UserService...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•çœ‹åˆ°ç¨‹åºä»ç„¶å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè¯´æ˜ <code>property</code> æ ‡ç­¾çš„ <code>name</code> æ˜¯ï¼š<code>setUserDao()</code> æ–¹æ³•åæ¼”å˜å¾—åˆ°çš„ã€‚æ¼”å˜çš„è§„å¾‹æ˜¯ï¼š</p>
<ul>
<li>setUsername() æ¼”å˜ä¸º username</li>
<li>setUserDao() æ¼”å˜ä¸º userDao</li>
</ul>
<p>å¦å¤–ï¼Œå¯¹äº <code>property</code> æ ‡ç­¾æ¥è¯´ï¼Œ<code>ref</code> å±æ€§ä¹Ÿå¯ä»¥é‡‡ç”¨æ ‡ç­¾çš„æ–¹å¼ï¼Œä½†ä½¿ç”¨ <code>ref</code> å±æ€§æ˜¯å¤šæ•°çš„ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼š<code>set</code> æ³¨å…¥çš„æ ¸å¿ƒå®ç°åŸç†ï¼šé€šè¿‡åå°„æœºåˆ¶è°ƒç”¨ <code>set</code> æ–¹æ³•æ¥ç»™å±æ€§èµ‹å€¼ï¼Œè®©ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´äº§ç”Ÿå…³ç³»ã€‚</p>
<h3 id="2-2-2-æ„é€ æ³¨å…¥"><a href="#2-2-2-æ„é€ æ³¨å…¥" class="headerlink" title="2.2.2 æ„é€ æ³¨å…¥"></a>2.2.2 æ„é€ æ³¨å…¥</h3><p>æ ¸å¿ƒåŸç†ï¼šé€šè¿‡è°ƒç”¨æ„é€ æ–¹æ³•æ¥ç»™å±æ€§èµ‹å€¼ã€‚</p>
<blockquote>
<p>æä¾›æ„é€ æ–¹æ³•</p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ä¸¤ä¸ªç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨åˆ é™¤è®¢å•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ„é€ æ–¹æ³•ç»™å±æ€§èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderService</span><span class="params">(OrderDao orderDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.orderDao = orderDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;OrderService...&quot;</span>);</span><br><span class="line">        orderDao.deleteById();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨ <code>spring.xml</code> ä¸‹é…ç½®å¦‚ä¸‹ <code>bean</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.OrderService&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--index=&quot;0&quot;è¡¨ç¤ºæ„é€ æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†orderDaoBeanå¯¹è±¡ä¼ é€’ç»™æ„é€ æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConstructorDI</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">orderServiceBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderServiceBean&quot;</span>, OrderService.class);</span><br><span class="line">    orderServiceBean.delete();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderService...</span><br><span class="line">æ­£åœ¨åˆ é™¤è®¢å•...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœæ„é€ æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ„é€ æ–¹æ³•ç»™å±æ€§èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderService</span><span class="params">(OrderDao orderDao, UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.orderDao = orderDao;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;OrderService...&quot;</span>);</span><br><span class="line">        orderDao.deleteById();</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.OrderService&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ç¬¬ä¸€ä¸ªå‚æ•°ä¸‹æ ‡æ˜¯0--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ç¬¬äºŒä¸ªå‚æ•°ä¸‹æ ‡æ˜¯1--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderService...</span><br><span class="line">æ­£åœ¨åˆ é™¤è®¢å•...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸ä½¿ç”¨å‚æ•°ä¸‹æ ‡ï¼Œä½¿ç”¨å‚æ•°çš„åå­—</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.OrderService&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--è¿™é‡Œä½¿ç”¨äº†æ„é€ æ–¹æ³•ä¸Šå‚æ•°çš„åå­—--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;orderDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸æŒ‡å®šå‚æ•°ä¸‹æ ‡ï¼Œä¸æŒ‡å®šå‚æ•°åå­—</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.OrderService&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--æ²¡æœ‰æŒ‡å®šä¸‹æ ‡ï¼Œä¹Ÿæ²¡æœ‰æŒ‡å®šå‚æ•°åå­—--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é…ç½®æ–‡ä»¶ä¸­æ„é€ æ–¹æ³•å‚æ•°çš„ç±»å‹é¡ºåºå’Œæ„é€ æ–¹æ³•å‚æ•°çš„ç±»å‹é¡ºåºä¸ä¸€è‡´</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.OrderService&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--é¡ºåºå·²ç»å’Œæ„é€ æ–¹æ³•çš„å‚æ•°é¡ºåºä¸åŒäº†--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šå‡ ç§æƒ…å†µæµ‹è¯•ç»“æœå‡ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderService...</span><br><span class="line">æ­£åœ¨åˆ é™¤è®¢å•...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œé€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥çš„æ—¶å€™ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡ä¸‹æ ‡</li>
<li>å¯ä»¥é€šè¿‡å‚æ•°å</li>
<li>ä¹Ÿå¯ä»¥ä¸æŒ‡å®šä¸‹æ ‡å’Œå‚æ•°åï¼Œå¯ä»¥ç±»å‹è‡ªåŠ¨æ¨æ–­ã€‚</li>
</ul>
<h2 id="2-3-setæ³¨å…¥ä¸“é¢˜"><a href="#2-3-setæ³¨å…¥ä¸“é¢˜" class="headerlink" title="2.3 setæ³¨å…¥ä¸“é¢˜"></a>2.3 setæ³¨å…¥ä¸“é¢˜</h2><h3 id="2-3-1-æ³¨å…¥å¤–éƒ¨-Bean"><a href="#2-3-1-æ³¨å…¥å¤–éƒ¨-Bean" class="headerlink" title="2.3.1 æ³¨å…¥å¤–éƒ¨ Bean"></a>2.3.1 æ³¨å…¥å¤–éƒ¨ Bean</h3><p>ä¹‹å‰çš„ä¸€ä¸ªæ¡ˆä¾‹ä¸­ä½¿ç”¨çš„æ¡ˆä¾‹å°±æ˜¯æ³¨å…¥å¤–éƒ¨ <code>Bean</code> çš„æ–¹å¼ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--propertyæ ‡ç­¾è¡¨ç¤ºé…ç½®å½“å‰beançš„å±æ€§,nameå±æ€§è¡¨ç¤ºé…ç½®å“ªä¸€ä¸ªå…·ä½“çš„å±æ€§,refå±æ€§è¡¨ç¤ºå‚ç…§å“ªä¸€ä¸ªbean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¤–éƒ¨Beançš„ç‰¹ç‚¹ï¼š<code>bean</code> å®šä¹‰åˆ°å¤–é¢ï¼Œåœ¨ <code>property</code> æ ‡ç­¾ä¸­ä½¿ç”¨ <code>ref</code> å±æ€§è¿›è¡Œæ³¨å…¥ã€‚é€šå¸¸è¿™ç§æ–¹å¼æ˜¯å¸¸ç”¨ã€‚</p>
<h3 id="2-3-2-æ³¨å…¥å†…éƒ¨-Bean"><a href="#2-3-2-æ³¨å…¥å†…éƒ¨-Bean" class="headerlink" title="2.3.2 æ³¨å…¥å†…éƒ¨ Bean"></a>2.3.2 æ³¨å…¥å†…éƒ¨ Bean</h3><p>å†…éƒ¨ Bean çš„æ–¹å¼ï¼šåœ¨ <code>bean</code> æ ‡ç­¾ä¸­åµŒå¥— <code>bean</code> æ ‡ç­¾ã€‚</p>
<p>a. æ–°å»º <code>spring-inner-bean.xml</code> æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹ <code>bean</code> </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™æµ‹è¯•ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInnerBean</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-inner-bean.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userServiceBean&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UserService...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-æ³¨å…¥ç®€å•ç±»å‹"><a href="#2-3-3-æ³¨å…¥ç®€å•ç±»å‹" class="headerlink" title="2.3.3 æ³¨å…¥ç®€å•ç±»å‹"></a>2.3.3 æ³¨å…¥ç®€å•ç±»å‹</h3><p>æˆ‘ä»¬ä¹‹å‰åœ¨è¿›è¡Œæ³¨å…¥çš„æ—¶å€™ï¼Œå¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹è±¡çš„å±æ€§æ˜¯ <code>int</code> ç±»å‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹è±¡çš„å±æ€§æ˜¯intç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæ˜¯é€šè¿‡ <code>set</code> æ³¨å…¥çš„æ–¹å¼ç»™è¯¥å±æ€§èµ‹å€¼ï¼Œå› ä¸ºåªè¦èƒ½å¤Ÿè°ƒç”¨ <code>set</code> æ–¹æ³•å°±å¯ä»¥ç»™å±æ€§èµ‹å€¼ã€‚</p>
<blockquote>
<p>ç¼–å†™ç¨‹åºç»™ä¸€ä¸ª User å¯¹è±¡çš„ age å±æ€§èµ‹å€¼20</p>
</blockquote>
<p>a. å®šä¹‰Userç±»ï¼Œæä¾› age å±æ€§ï¼Œæä¾› age å±æ€§çš„ <code>setter</code> æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™ spring é…ç½®æ–‡ä»¶ï¼š<code>spring-simple-type.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¦‚æœåƒè¿™ç§intç±»å‹çš„å±æ€§ï¼Œæˆ‘ä»¬ç§°ä¸ºç®€å•ç±»å‹ï¼Œè¿™ç§ç®€å•ç±»å‹åœ¨æ³¨å…¥çš„æ—¶å€™è¦ä½¿ç”¨valueå±æ€§ï¼Œä¸èƒ½ä½¿ç”¨ref--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name=&quot;age&quot; value=&quot;20&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>20<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSimpleType</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-simple-type.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;age=20&#125;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼šå¦‚æœç»™ç®€å•ç±»å‹èµ‹å€¼ï¼Œä½¿ç”¨ <code>value</code> å±æ€§æˆ– <code>value</code> æ ‡ç­¾ã€‚è€Œä¸æ˜¯ <code>ref</code> ã€‚</p>
<blockquote>
<p>ç®€å•ç±»å‹åŒ…æ‹¬å“ªäº›å‘¢ï¼Ÿ</p>
</blockquote>
<p>å¯ä»¥é€šè¿‡ Spring çš„æºç æ¥åˆ†æä¸€ä¸‹ï¼š<code>BeanUtils</code> ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanUtils</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Check if the given type represents a &quot;simple&quot; property: a simple value</span></span><br><span class="line"><span class="comment">	 * type or an array of simple value types.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;See &#123;<span class="doctag">@link</span> #isSimpleValueType(Class)&#125; for the definition of &lt;em&gt;simple</span></span><br><span class="line"><span class="comment">	 * value type&lt;/em&gt;.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;Used to determine properties to check for a &quot;simple&quot; dependency-check.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> type the type to check</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> whether the given type represents a &quot;simple&quot; property</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> org.springframework.beans.factory.support.RootBeanDefinition#DEPENDENCY_CHECK_SIMPLE</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#checkDependencies</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> #isSimpleValueType(Class)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSimpleProperty</span><span class="params">(Class&lt;?&gt; type)</span> &#123;</span><br><span class="line">		Assert.notNull(type, <span class="string">&quot;&#x27;type&#x27; must not be null&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> isSimpleValueType(type) || (type.isArray() &amp;&amp; isSimpleValueType(type.getComponentType()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Check if the given type represents a &quot;simple&quot; value type: a primitive or</span></span><br><span class="line"><span class="comment">	 * primitive wrapper, an enum, a String or other CharSequence, a Number, a</span></span><br><span class="line"><span class="comment">	 * Date, a Temporal, a URI, a URL, a Locale, or a Class.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;&#123;<span class="doctag">@code</span> Void&#125; and &#123;<span class="doctag">@code</span> void&#125; are not considered simple value types.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> type the type to check</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> whether the given type represents a &quot;simple&quot; value type</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> #isSimpleProperty(Class)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSimpleValueType</span><span class="params">(Class&lt;?&gt; type)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (Void.class != type &amp;&amp; <span class="keyword">void</span>.class != type &amp;&amp;</span><br><span class="line">				(ClassUtils.isPrimitiveOrWrapper(type) ||</span><br><span class="line">				Enum.class.isAssignableFrom(type) ||</span><br><span class="line">				CharSequence.class.isAssignableFrom(type) ||</span><br><span class="line">				Number.class.isAssignableFrom(type) ||</span><br><span class="line">				Date.class.isAssignableFrom(type) ||</span><br><span class="line">				Temporal.class.isAssignableFrom(type) ||</span><br><span class="line">				URI.class == type ||</span><br><span class="line">				URL.class == type ||</span><br><span class="line">				Locale.class == type ||</span><br><span class="line">				Class.class == type));</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡æºç åˆ†æå¾—çŸ¥ï¼Œç®€å•ç±»å‹åŒ…æ‹¬:</strong></p>
<p>åŸºæœ¬æ•°æ®ç±»å‹ã€åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»ã€<code>String</code> æˆ–å…¶ä»–çš„ <code>CharSequence</code> å­ç±»ã€<code>Number</code> å­ç±»ã€<code>Date</code> å­ç±»ã€<code>Enum</code> å­ç±»ã€<code>URI</code> ã€<code>URL</code> ã€<code>Temporal</code> å­ç±»ã€<code>Locale</code> ã€<code>Class</code> ã€å¦å¤–è¿˜åŒ…æ‹¬ä»¥ä¸Šç®€å•å€¼ç±»å‹å¯¹åº”çš„æ•°ç»„ç±»å‹ã€‚</p>
<blockquote>
<p>æµ‹è¯•Dataç±»å‹</p>
</blockquote>
<p>a. ç¼–å†™ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleValueType</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;svt&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.SimpleValueType&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŠ¥é”™äº†ï¼Œè¯´1970-10-11è¿™ä¸ªå­—ç¬¦ä¸²æ— æ³•è½¬æ¢æˆjava.util.Dateç±»å‹ã€‚--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name=&quot;birth&quot; value=&quot;1970-10-11&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¦‚æœä½ ç¡¬è¦æŠŠDateå½“åšç®€å•ç±»å‹çš„è¯ï¼Œä½¿ç”¨valueèµ‹å€¼çš„è¯ï¼Œè¿™ä¸ªæ—¥æœŸå­—ç¬¦ä¸²æ ¼å¼æœ‰è¦æ±‚--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šæŠŠDateå½“åšç®€å•ç±»å‹ï¼Œè™½ç„¶å®ƒæ˜¯ç®€å•ç±»å‹ã€‚ä¸€èˆ¬ä¼šé‡‡ç”¨refç»™Dateç±»å‹çš„å±æ€§èµ‹å€¼ã€‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Wed Oct 19 16:28:13 CST 2022&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSimpleTypeSet</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;date.xml&quot;</span>);</span><br><span class="line">    <span class="type">SimpleValueType</span> <span class="variable">svt</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;svt&quot;</span>, SimpleValueType.class);</span><br><span class="line">    System.out.println(svt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SimpleValueType(birth=Thu Oct 20 06:28:13 CST 2022)</span><br></pre></td></tr></table></figure>

<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p>
<ul>
<li>å¦‚æœæŠŠ <code>Date</code> å½“åšç®€å•ç±»å‹çš„è¯ï¼Œæ—¥æœŸå­—ç¬¦ä¸²æ ¼å¼ä¸èƒ½éšä¾¿å†™ã€‚æ ¼å¼å¿…é¡»ç¬¦åˆ <code>Date</code> çš„ <code>toString()</code> æ–¹æ³•æ ¼å¼ã€‚æ˜¾ç„¶è¿™å°±æ¯”è¾ƒé¸¡è‚‹äº†ã€‚å¦‚æœæˆ‘ä»¬æä¾›ä¸€ä¸ªè¿™æ ·çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼š2010-10-11ï¼Œåœ¨è¿™é‡Œæ˜¯æ— æ³•èµ‹å€¼ç»™ <code>Date</code> ç±»å‹çš„å±æ€§çš„ã€‚</li>
<li>spring6ä¹‹åï¼Œå½“æ³¨å…¥çš„æ˜¯ URLï¼Œé‚£ä¹ˆè¿™ä¸ª url å­—ç¬¦ä¸²æ˜¯ä¼šè¿›è¡Œæœ‰æ•ˆæ€§æ£€æµ‹çš„ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­˜åœ¨çš„ url ï¼Œé‚£å°±æ²¡é—®é¢˜ã€‚å¦‚æœä¸å­˜åœ¨åˆ™æŠ¥é”™ã€‚</li>
<li>å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹ä½¿ç”¨çš„æ˜¯ <code>&lt;property name=&quot;&quot; ref=&quot;&quot;/&gt;</code></li>
<li>å¯¹äºç®€å•æ•°æ®ç±»å‹ä½¿ç”¨çš„æ˜¯ <code>&lt;property name=&quot;&quot; value=&quot;&quot;/&gt;</code></li>
</ul>
<h3 id="2-3-4-çº§è”å±æ€§èµ‹å€¼ï¼ˆäº†è§£ï¼‰"><a href="#2-3-4-çº§è”å±æ€§èµ‹å€¼ï¼ˆäº†è§£ï¼‰" class="headerlink" title="2.3.4 çº§è”å±æ€§èµ‹å€¼ï¼ˆäº†è§£ï¼‰"></a>2.3.4 çº§è”å±æ€§èµ‹å€¼ï¼ˆäº†è§£ï¼‰</h3><p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Clazz</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Clazz clazz;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;clazzBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Clazz&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è¦ç‚¹1ï¼šä»¥ä¸‹ä¸¤è¡Œé…ç½®çš„é¡ºåºä¸èƒ½é¢ å€’--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;clazz&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;clazzBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è¦ç‚¹2ï¼šclazzå±æ€§å¿…é¡»æœ‰getteræ–¹æ³•--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;clazz.name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;é«˜ä¸‰ä¸€ç­&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCascade</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-cascade.xml&quot;</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;student&quot;</span>, Student.class);</span><br><span class="line">    System.out.println(student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Student(name=å¼ ä¸‰, clazz=Clazz(name=é«˜ä¸‰ä¸€ç­))</span><br></pre></td></tr></table></figure>

<p><strong>è¦ç‚¹ï¼š</strong></p>
<ul>
<li>åœ¨ spring é…ç½®æ–‡ä»¶ä¸­ï¼Œæ³¨æ„é¡ºåºï¼Œé…ç½®çš„é¡ºåºä¸èƒ½é¢ å€’ã€‚</li>
<li>åœ¨ spring é…ç½®æ–‡ä»¶ä¸­ï¼Œ<code>clazz</code> å±æ€§å¿…é¡»æä¾› <code>getter</code> æ–¹æ³•ã€‚</li>
</ul>
<h3 id="2-3-5-æ³¨å…¥æ•°ç»„"><a href="#2-3-5-æ³¨å…¥æ•°ç»„" class="headerlink" title="2.3.5 æ³¨å…¥æ•°ç»„"></a>2.3.5 æ³¨å…¥æ•°ç»„</h3><blockquote>
<p>æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯ç®€å•ç±»å‹</p>
</blockquote>
<p>a. ç¼–å†™Personç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String[] favoriteFoods;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-array-simple.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zxq.bean.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;favoriteFoods&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>é¸¡æ’<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ±‰å ¡<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>é¹…è‚<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testArraySimple</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-array-simple.xml&quot;</span>);</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;person&quot;</span>, Person.class);</span><br><span class="line">    System.out.println(person);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Person(favoriteFoods=[é¸¡æ’, æ±‰å ¡, é¹…è‚])</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯éç®€å•ç±»å‹</p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Goods</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸€ä¸ªè®¢å•ä¸­æœ‰å¤šä¸ªå•†å“</span></span><br><span class="line">    <span class="keyword">private</span> Goods[] goods;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-array.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;goods1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Goods&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è¥¿ç“œ&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;goods2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Goods&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è‹¹æœ&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;order&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--è¿™é‡Œä½¿ç”¨refæ ‡ç­¾å³å¯--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;goods1&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;goods2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testArray</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-array.xml&quot;</span>);</span><br><span class="line">    <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;order&quot;</span>, Order.class);</span><br><span class="line">    System.out.println(order);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Order(goods=[Goods(name=è¥¿ç“œ), Goods(name=è‹¹æœ)])</span><br></pre></td></tr></table></figure>

<p><strong>è¦ç‚¹ï¼š</strong></p>
<ul>
<li>å¦‚æœæ•°ç»„ä¸­æ˜¯ç®€å•ç±»å‹ï¼Œä½¿ç”¨ <code>value</code> æ ‡ç­¾ã€‚</li>
<li>å¦‚æœæ•°ç»„ä¸­æ˜¯éç®€å•ç±»å‹ï¼Œä½¿ç”¨ <code>ref</code> æ ‡ç­¾ã€‚</li>
</ul>
<h3 id="2-3-6-æ³¨å…¥-List-é›†åˆã€Set-é›†åˆã€Map-é›†åˆã€Properties"><a href="#2-3-6-æ³¨å…¥-List-é›†åˆã€Set-é›†åˆã€Map-é›†åˆã€Properties" class="headerlink" title="2.3.6 æ³¨å…¥ List é›†åˆã€Set é›†åˆã€Map é›†åˆã€Properties"></a>2.3.6 æ³¨å…¥ List é›†åˆã€Set é›†åˆã€Map é›†åˆã€Properties</h3><p> List é›†åˆï¼šæœ‰åºå¯é‡å¤ï¼› Set é›†åˆï¼šæ— åºä¸å¯é‡å¤ã€‚</p>
<p> <code>java.util.Properties</code> ç»§æ‰¿ <code>java.util.Hashtable</code> ï¼Œæ‰€ä»¥ <code>Properties</code> ä¹Ÿæ˜¯ä¸€ä¸ª Map é›†åˆã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; names;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; phones;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; addrs;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-collection.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;peopleBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.People&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;names&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>é“é”¤<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>ç‹¼<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;phones&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--éç®€å•ç±»å‹å¯ä»¥ä½¿ç”¨refï¼Œç®€å•ç±»å‹ä½¿ç”¨value--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>110<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>110<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>119<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>119<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;addrs&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--å¦‚æœkeyä¸æ˜¯ç®€å•ç±»å‹ï¼Œä½¿ç”¨ key-ref å±æ€§--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--å¦‚æœvalueä¸æ˜¯ç®€å•ç±»å‹ï¼Œä½¿ç”¨ value-ref å±æ€§--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;åŒ—äº¬å¤§å…´åŒº&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šæµ·æµ¦ä¸œåŒº&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ·±åœ³å®å®‰åŒº&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/spring<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCollection</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-collection.xml&quot;</span>);</span><br><span class="line">    <span class="type">People</span> <span class="variable">peopleBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;peopleBean&quot;</span>, People.class);</span><br><span class="line">    System.out.println(peopleBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">People(names=[é“é”¤, å¼ ä¸‰, å¼ ä¸‰, å¼ ä¸‰, ç‹¼], phones=[110, 120, 119], addrs=&#123;1=åŒ—äº¬å¤§å…´åŒº, 2=ä¸Šæµ·æµ¦ä¸œåŒº, 3=æ·±åœ³å®å®‰åŒº&#125;, properties=&#123;password=123456, driver=com.mysql.cj.jdbc.Driver, url=jdbc:mysql://localhost:3306/spring, username=root&#125;)</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ List  ã€Set é›†åˆï¼š</p>
<ul>
<li>ä½¿ç”¨ <list> ã€<set> æ ‡ç­¾</set></list></li>
<li>é›†åˆä¸­å…ƒç´ æ˜¯ç®€å•ç±»å‹çš„ä½¿ç”¨ <code>value</code> æ ‡ç­¾ï¼Œåä¹‹ä½¿ç”¨ <code>ref</code> æ ‡ç­¾ã€‚</li>
</ul>
<p>æ³¨å…¥ Map é›†åˆï¼š</p>
<ul>
<li>ä½¿ç”¨ <map> æ ‡ç­¾</map></li>
<li>å¦‚æœ key æ˜¯ç®€å•ç±»å‹ï¼Œä½¿ç”¨ key å±æ€§ï¼Œåä¹‹ä½¿ç”¨ <code>key-ref</code> å±æ€§ã€‚</li>
<li>å¦‚æœ value æ˜¯ç®€å•ç±»å‹ï¼Œä½¿ç”¨ value å±æ€§ï¼Œåä¹‹ä½¿ç”¨ <code>value-ref</code> å±æ€§ã€‚</li>
</ul>
<p>æ³¨å…¥ Propertiesï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>props</code> æ ‡ç­¾åµŒå¥— <code>prop</code> æ ‡ç­¾å®Œæˆã€‚</li>
</ul>
<h3 id="2-3-7-æ³¨å…¥nullå’Œç©ºå­—ç¬¦ä¸²"><a href="#2-3-7-æ³¨å…¥nullå’Œç©ºå­—ç¬¦ä¸²" class="headerlink" title="2.3.7 æ³¨å…¥nullå’Œç©ºå­—ç¬¦ä¸²"></a>2.3.7 æ³¨å…¥nullå’Œç©ºå­—ç¬¦ä¸²</h3><blockquote>
<p>æ³¨å…¥ç©ºå­—ç¬¦ä¸²ä½¿ç”¨ï¼š<value> æˆ–è€… value&#x3D;â€â€</value></p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-null.xml</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;vipBean&quot;</span> class=<span class="string">&quot;com.muyoukule.Bean.Vip&quot;</span>&gt;</span><br><span class="line">    &lt;!--ç©ºä¸²çš„ç¬¬ä¸€ç§æ–¹å¼--&gt;</span><br><span class="line">&lt;!--    &lt;property name=<span class="string">&quot;email&quot;</span> value=<span class="string">&quot;&quot;</span>/&gt;--&gt;</span><br><span class="line">    &lt;!--ç©ºä¸²çš„ç¬¬äºŒç§æ–¹å¼--&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;email&quot;</span>&gt;</span><br><span class="line">        &lt;value/&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testNull</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-null.xml&quot;</span>);</span><br><span class="line">    <span class="type">Vip</span> <span class="variable">vipBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;vipBean&quot;</span>, Vip.class);</span><br><span class="line">    System.out.println(vipBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Vip(email=)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨å…¥nullä½¿ç”¨ï¼š<null> æˆ–è€… ä¸ä¸ºè¯¥å±æ€§èµ‹å€¼</null></p>
</blockquote>
<p>a. ä¿®æ”¹ <code>spring-null.xml</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--ç¬¬ä¸€ç§æ–¹å¼ï¼šä¸ç»™å±æ€§èµ‹å€¼--&gt;</span><br><span class="line">&lt;!--&lt;bean id=<span class="string">&quot;vipBean&quot;</span> class=<span class="string">&quot;com.zxq.Bean.Vip&quot;</span>/&gt;--&gt;</span><br><span class="line">&lt;!--ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨&lt;<span class="literal">null</span>/&gt;--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;vipBean&quot;</span> class=<span class="string">&quot;com.muyoukule.Bean.Vip&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;email&quot;</span>&gt;</span><br><span class="line">        &lt;<span class="literal">null</span>/&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>b. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Vip(email=null)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-8-æ³¨å…¥çš„å€¼ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·"><a href="#2-3-8-æ³¨å…¥çš„å€¼ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·" class="headerlink" title="2.3.8 æ³¨å…¥çš„å€¼ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·"></a>2.3.8 æ³¨å…¥çš„å€¼ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·</h3><p>XMLä¸­æœ‰5ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt; ã€&gt; ã€â€™ ã€â€ ã€&amp;</p>
<p>ä»¥ä¸Š5ä¸ªç‰¹æ®Šç¬¦å·åœ¨ XML ä¸­ä¼šè¢«ç‰¹æ®Šå¯¹å¾…ï¼Œä¼šè¢«å½“åš XML è¯­æ³•çš„ä¸€éƒ¨åˆ†è¿›è¡Œè§£æï¼Œå¦‚æœè¿™äº›ç‰¹æ®Šç¬¦å·ç›´æ¥å‡ºç°åœ¨æ³¨å…¥çš„å­—ç¬¦ä¸²å½“ä¸­ï¼Œä¼šæŠ¥é”™ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ä¸¤ç§ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§ï¼šç‰¹æ®Šç¬¦å·ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ä»£æ›¿ã€‚</li>
<li>ç¬¬äºŒç§ï¼šå°†å«æœ‰ç‰¹æ®Šç¬¦å·çš„å­—ç¬¦ä¸²æ”¾åˆ°ï¼š&lt;![CDATA[]]&gt; å½“ä¸­ã€‚å› ä¸ºæ”¾åœ¨CDATAåŒºä¸­çš„æ•°æ®ä¸ä¼šè¢«XMLæ–‡ä»¶è§£æå™¨è§£æã€‚</li>
</ul>
<p>5ä¸ªç‰¹æ®Šå­—ç¬¦å¯¹åº”çš„è½¬ä¹‰å­—ç¬¦åˆ†åˆ«æ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>ç‰¹æ®Šå­—ç¬¦</strong></th>
<th align="center"><strong>è½¬ä¹‰å­—ç¬¦</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">&gt;</td>
<td align="center">&amp;gt;</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">&amp;lt;</td>
</tr>
<tr>
<td align="center">â€˜</td>
<td align="center">&amp;apos;</td>
</tr>
<tr>
<td align="center">â€œ</td>
<td align="center">&amp;quot;</td>
</tr>
<tr>
<td align="center">&amp;</td>
<td align="center">&amp;amp;</td>
</tr>
</tbody></table>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Math</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-special.xml</code></p>
<blockquote>
<p>ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ä»£æ›¿æ–¹å¼</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mathBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Math&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;result&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2 <span class="symbol">&amp;lt;</span> 3&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨CDATAæ–¹å¼</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mathBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Math&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;result&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åªèƒ½ä½¿ç”¨valueæ ‡ç­¾--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[2 &lt; 3]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSpecial</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œæ³¨æ„å¯¼å…¥ Math åŒ…çš„æ—¶å€™ä¸è¦å¯¼æˆ java.lang.Math äº†</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-special.xml&quot;</span>);</span><br><span class="line">    <span class="type">Math</span> <span class="variable">mathBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;mathBean&quot;</span>, Math.class);</span><br><span class="line">    System.out.println(mathBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Math(result=2 &lt; 3)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ CDATA æ—¶ï¼Œä¸èƒ½ä½¿ç”¨ <code>value</code> å±æ€§ï¼Œåªèƒ½ä½¿ç”¨ <code>value</code> æ ‡ç­¾ã€‚</p>
<h2 id="2-4-på‘½åç©ºé—´æ³¨å…¥"><a href="#2-4-på‘½åç©ºé—´æ³¨å…¥" class="headerlink" title="2.4 på‘½åç©ºé—´æ³¨å…¥"></a>2.4 på‘½åç©ºé—´æ³¨å…¥</h2><p>ç›®çš„ï¼šç®€åŒ–é…ç½®ã€‚</p>
<p>på‘½åç©ºé—´å®é™…ä¸Šæ˜¯å¯¹ <code>set</code> æ³¨å…¥çš„ç®€åŒ–ã€‚</p>
<p>ä½¿ç”¨på‘½åç©ºé—´æ³¨å…¥çš„å‰ææ¡ä»¶åŒ…æ‹¬ä¸¤ä¸ªï¼š</p>
<ul>
<li>åœ¨XMLå¤´éƒ¨ä¿¡æ¯ä¸­æ·»åŠ på‘½åç©ºé—´çš„é…ç½®ä¿¡æ¯ï¼šxmlns:p&#x3D;â€<a href="http://www.springframework.org/schema/p">http://www.springframework.org/schema/p</a>â€œ</li>
<li>på‘½åç©ºé—´æ³¨å…¥æ˜¯åŸºäº setter æ–¹æ³•çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹åº”çš„å±æ€§æä¾›setteræ–¹æ³•ã€‚</li>
</ul>
<p>æ–°å»ºspting_003æ¨¡å—</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">    <span class="comment">//på‘½åç©ºé—´æ³¨å…¥æ˜¯åŸºäºsetteræ–¹æ³•çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹åº”çš„å±æ€§æä¾›setteræ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-p.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;customerBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Customer&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;zhangsan&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testP</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-p.xml&quot;</span>);</span><br><span class="line">    <span class="type">Customer</span> <span class="variable">customerBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;customerBean&quot;</span>, Customer.class);</span><br><span class="line">    System.out.println(customerBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Customer(name=zhangsan, age=20)</span><br></pre></td></tr></table></figure>

<p>æŠŠ <code>setter</code> æ–¹æ³•å»æ‰ï¼ˆæ³¨é‡Šæ‰ <code>@Setter</code> ï¼‰ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%8A%8Asetter%E6%96%B9%E6%B3%95%E5%8E%BB%E6%8E%89.png"></p>
<h2 id="2-5-cå‘½åç©ºé—´æ³¨å…¥"><a href="#2-5-cå‘½åç©ºé—´æ³¨å…¥" class="headerlink" title="2.5 cå‘½åç©ºé—´æ³¨å…¥"></a>2.5 cå‘½åç©ºé—´æ³¨å…¥</h2><p>ç›®çš„ï¼šç®€åŒ–é…ç½®ã€‚</p>
<p>cå‘½åç©ºé—´æ˜¯ç®€åŒ–æ„é€ æ–¹æ³•æ³¨å…¥çš„ã€‚</p>
<p>ä½¿ç”¨cå‘½åç©ºé—´çš„ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š</p>
<ul>
<li><p>éœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¿¡æ¯ï¼šxmlns:c&#x3D;â€<a href="http://www.springframework.org/schema/c">http://www.springframework.org/schema/c</a>â€œ</p>
</li>
<li><p>éœ€è¦æä¾›æ„é€ æ–¹æ³•ã€‚</p>
</li>
</ul>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTime</span> &#123;</span><br><span class="line">    <span class="comment">//éœ€è¦æä¾›æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> year;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> month;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> day;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-c.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;bean id=&quot;myTimeBean&quot; class=&quot;com.muyoukule.Bean.MyTime&quot; c:year=&quot;1970&quot; c:month=&quot;1&quot; c:day=&quot;5&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myTimeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.MyTime&quot;</span> <span class="attr">c:_0</span>=<span class="string">&quot;2008&quot;</span> <span class="attr">c:_1</span>=<span class="string">&quot;8&quot;</span> <span class="attr">c:_2</span>=<span class="string">&quot;8&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testC</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-c.xml&quot;</span>);</span><br><span class="line">    <span class="type">MyTime</span> <span class="variable">myTimeBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;myTimeBean&quot;</span>, MyTime.class);</span><br><span class="line">    System.out.println(myTimeBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MyTime(year=2008, month=8, day=8)</span><br></pre></td></tr></table></figure>

<p>æŠŠæ„é€ æ–¹æ³•æ³¨é‡Šæ‰ï¼ˆæ³¨é‡Šæ‰ <code>@AllArgsConstructor</code> ï¼‰ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%B3%A8%E9%87%8A%E6%8E%89@AllArgsConstructor%20.png"></p>
<p><strong>æ³¨æ„ï¼šä¸ç®¡æ˜¯på‘½åç©ºé—´è¿˜æ˜¯cå‘½åç©ºé—´ï¼Œæ³¨å…¥çš„æ—¶å€™éƒ½å¯ä»¥æ³¨å…¥ç®€å•ç±»å‹ä»¥åŠéç®€å•ç±»å‹ã€‚</strong></p>
<h2 id="2-6-utilå‘½åç©ºé—´"><a href="#2-6-utilå‘½åç©ºé—´" class="headerlink" title="2.6 utilå‘½åç©ºé—´"></a>2.6 utilå‘½åç©ºé—´</h2><p>ä½¿ç”¨ util å‘½åç©ºé—´å¯ä»¥è®©é…ç½®å¤ç”¨ã€‚</p>
<p>ä½¿ç”¨ util å‘½åç©ºé—´çš„å‰ææ˜¯ï¼šåœ¨springé…ç½®æ–‡ä»¶å¤´éƒ¨æ·»åŠ é…ç½®ä¿¡æ¯ã€‚å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>xmlns:util&#x3D;â€<a href="http://www.springframework.org/schema/util">http://www.springframework.org/schema/util</a>â€œ</p>
</li>
<li><p><a href="http://www.springframework.org/schema/util">http://www.springframework.org/schema/util</a> <a href="http://www.springframework.org/schema/util/spring-util.xsd">http://www.springframework.org/schema/util/spring-util.xsd</a></p>
</li>
</ul>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDataSource1</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDataSource2</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-util.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">util:properties</span> <span class="attr">id</span>=<span class="string">&quot;prop&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/spring<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">util:properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.MyDataSource1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.MyDataSource2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUtil</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-util.xml&quot;</span>);</span><br><span class="line">    <span class="type">MyDataSource1</span> <span class="variable">dataSource1</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;dataSource1&quot;</span>, MyDataSource1.class);</span><br><span class="line">    System.out.println(dataSource1);</span><br><span class="line">    <span class="type">MyDataSource2</span> <span class="variable">dataSource2</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;dataSource2&quot;</span>, MyDataSource2.class);</span><br><span class="line">    System.out.println(dataSource2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MyDataSource1(properties=&#123;password=root, driver=com.mysql.cj.jdbc.Driver, url=jdbc:mysql://localhost:3306/spring, username=root&#125;)</span><br><span class="line">MyDataSource2(properties=&#123;password=root, driver=com.mysql.cj.jdbc.Driver, url=jdbc:mysql://localhost:3306/spring, username=root&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="2-7-åŸºäºXMLçš„è‡ªåŠ¨è£…é…"><a href="#2-7-åŸºäºXMLçš„è‡ªåŠ¨è£…é…" class="headerlink" title="2.7 åŸºäºXMLçš„è‡ªåŠ¨è£…é…"></a>2.7 åŸºäºXMLçš„è‡ªåŠ¨è£…é…</h2><p>Springè¿˜å¯ä»¥å®Œæˆè‡ªåŠ¨åŒ–çš„æ³¨å…¥ï¼Œè‡ªåŠ¨åŒ–æ³¨å…¥åˆè¢«ç§°ä¸ºè‡ªåŠ¨è£…é…ã€‚å®ƒå¯ä»¥æ ¹æ®åå­—è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</p>
<h3 id="2-7-1-æ ¹æ®åç§°è‡ªåŠ¨è£…é…"><a href="#2-7-1-æ ¹æ®åç§°è‡ªåŠ¨è£…é…" class="headerlink" title="2.7.1 æ ¹æ®åç§°è‡ªåŠ¨è£…é…"></a>2.7.1 æ ¹æ®åç§°è‡ªåŠ¨è£…é…</h3><p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao aaa;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªsetæ–¹æ³•éå¸¸å…³é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAaa</span><span class="params">(UserDao aaa)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aaa = aaa;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserService...&quot;</span>);</span><br><span class="line">        aaa.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-autowire.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--byNameè¡¨ç¤ºæ ¹æ®åå­—è‡ªåŠ¨è£…é…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.UserService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;aaa&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé…ç½®èµ·åˆ°å…³é”®ä½œç”¨ï¼š</p>
<ul>
<li>UserService Beanä¸­éœ€è¦æ·»åŠ  <code>autowire=&quot;byName&quot;</code>ï¼Œè¡¨ç¤ºé€šè¿‡åç§°è¿›è¡Œè£…é…ã€‚</li>
<li>UserService ç±»ä¸­æœ‰ä¸€ä¸ª UserDao å±æ€§ï¼Œè€ŒUserDaoå±æ€§çš„åå­—æ˜¯aaaï¼Œå¯¹åº”çš„ set æ–¹æ³•æ˜¯ <code>setAaa()</code> ï¼Œæ­£å¥½å’Œ UserDao Bean çš„ id æ˜¯ä¸€æ ·çš„ã€‚è¿™å°±æ˜¯æ ¹æ®åç§°è‡ªåŠ¨è£…é…ã€‚</li>
</ul>
<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAutowireByName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-autowire.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UserService...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä¸€ä¸‹ï¼Œ<code>byName</code> è£…é…æ˜¯å’Œå±æ€§åæœ‰å…³è¿˜æ˜¯å’Œsetæ–¹æ³•åæœ‰å…³ç³»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao aaa;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// setæ–¹æ³•åå˜åŒ–äº†</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDao</span><span class="params">(UserDao aaa)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aaa = aaa;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/aaa%E5%B1%9E%E6%80%A7%E8%B5%8B%E5%80%BC%E5%A4%B1%E8%B4%A5.png"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œaaa å±æ€§å¹¶æ²¡æœ‰èµ‹å€¼æˆåŠŸã€‚ä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰è£…é…æˆåŠŸã€‚</p>
<p>å°† spring é…ç½®æ–‡ä»¶ä¿®æ”¹ä»¥ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è¿™ä¸ªidä¿®æ”¹äº†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.UserDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UserService...</span><br><span class="line">æ­£åœ¨ä¿å­˜ç”¨æˆ·æ•°æ®...</span><br></pre></td></tr></table></figure>

<p>è¿™è¯´æ˜ï¼Œå¦‚æœæ ¹æ®åç§°è£…é…(<code>byName</code>)ï¼Œåº•å±‚ä¼šè°ƒç”¨ set æ–¹æ³•è¿›è¡Œæ³¨å…¥ã€‚</p>
<p>ä¾‹å¦‚ï¼š<code>setAge()</code> å¯¹åº”çš„åå­—æ˜¯ ageï¼Œ<code>setPassword()</code> å¯¹åº”çš„åå­—æ˜¯ passwordï¼Œ<code>setEmail()</code> å¯¹åº”çš„åå­—æ˜¯ emailã€‚</p>
<h3 id="2-7-2-æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…"><a href="#2-7-2-æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…" class="headerlink" title="2.7.2 æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…"></a>2.7.2 æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…</h3><p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨ä¿å­˜è´¦æˆ·ä¿¡æ¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAccountDao</span><span class="params">(AccountDao accountDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.accountDao = accountDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;AccountService...&quot;</span>);</span><br><span class="line">        accountDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-autowire.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--byTypeè¡¨ç¤ºæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.AccountService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.AccountDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAutowireByType</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-autowire.xml&quot;</span>);</span><br><span class="line">    <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;accountService&quot;</span>, AccountService.class);</span><br><span class="line">    accountService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AccountService...</span><br><span class="line">æ­£åœ¨ä¿å­˜è´¦æˆ·ä¿¡æ¯...</span><br></pre></td></tr></table></figure>

<p>æŠŠ <code>AccountService</code> ä¸­çš„ <code>set</code> æ–¹æ³•æ³¨é‡Šæ‰ï¼Œå†æ‰§è¡Œï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%8A%8AAccountService%E4%B8%AD%E7%9A%84set%E6%96%B9%E6%B3%95%E6%B3%A8%E9%87%8A%E6%8E%89.png"></p>
<p>å¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯ <code>byName</code> è¿˜æ˜¯ <code>byType</code> ï¼Œåœ¨è£…é…çš„æ—¶å€™éƒ½æ˜¯åŸºäº <code>set</code> æ–¹æ³•çš„ã€‚æ‰€ä»¥ <code>set</code> æ–¹æ³•æ˜¯å¿…é¡»è¦æä¾›çš„ã€‚æä¾›æ„é€ æ–¹æ³•æ˜¯ä¸è¡Œçš„ã€‚</p>
<blockquote>
<p>å¦‚æœ <code>byType</code>ï¼Œæ ¹æ®ç±»å‹è£…é…æ—¶ï¼Œå¦‚æœé…ç½®æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªç±»å‹ä¸€æ ·çš„ <code>bean</code> ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p>
</blockquote>
<p>ä¿®æ”¹<code>spring-autowire.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--byTypeè¡¨ç¤ºæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.AccountService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;x&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.AccountDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;y&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Dao.AccountDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶å½“æˆ‘ä»¬å†é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªç±»å‹ä¸€æ ·çš„ <code>bean</code> æ˜¯ideaä¹Ÿä¼šè¿›è¡Œæç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%8F%90%E7%A4%BA%E6%9C%89%E4%B8%A4%E4%B8%AA%E7%B1%BB%E5%9E%8B%E4%B8%80%E6%A0%B7%E7%9A%84%20bean.png"></p>
<p>æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E6%9F%90%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84Bean%E4%B8%8D%E5%94%AF%E4%B8%80.png"></p>
<p>æµ‹è¯•ç»“æœè¯´æ˜äº†ï¼Œå½“ <code>byType</code> è¿›è¡Œè‡ªåŠ¨è£…é…çš„æ—¶å€™ï¼Œé…ç½®æ–‡ä»¶ä¸­æŸç§ç±»å‹çš„ Bean å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½å‡ºç°å¤šä¸ªã€‚</p>
<h2 id="2-8-Springå¼•å…¥å¤–éƒ¨å±æ€§é…ç½®æ–‡ä»¶"><a href="#2-8-Springå¼•å…¥å¤–éƒ¨å±æ€§é…ç½®æ–‡ä»¶" class="headerlink" title="2.8 Springå¼•å…¥å¤–éƒ¨å±æ€§é…ç½®æ–‡ä»¶"></a>2.8 Springå¼•å…¥å¤–éƒ¨å±æ€§é…ç½®æ–‡ä»¶</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ç¼–å†™æ•°æ®æºçš„æ—¶å€™æ˜¯éœ€è¦è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯çš„ï¼Œä¾‹å¦‚ï¼šdriverã€urlã€usernameã€passwordç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥å•ç‹¬å†™åˆ°ä¸€ä¸ªå±æ€§é…ç½®æ–‡ä»¶ä¸­ã€‚</p>
<p>æ–°å»ºspting_004æ¨¡å—</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDataSource</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨ç±»è·¯å¾„ä¸‹æ–°å»º <code>jdbc.properties</code> æ–‡ä»¶ï¼Œå¹¶é…ç½®ä¿¡æ¯</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/spring</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>c. åœ¨ spring é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ <code>context</code> å‘½åç©ºé—´ï¼Œä½¿ç”¨ <code>jdbc.properties</code> æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.MyDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testProperties</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-properties.xml&quot;</span>);</span><br><span class="line">    <span class="type">MyDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;dataSource&quot;</span>, MyDataSource.class);</span><br><span class="line">    System.out.println(dataSource);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MyDataSource(driver=com.mysql.cj.jdbc.Driver, url=jdbc:mysql://localhost:3306/spring, username=æƒ, password=root)</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œè¯»å– <code>properties</code> é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å°±å·²ç»å®Œæˆï¼Œä½†æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ‰äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<blockquote>
<p>é”®å€¼å¯¹çš„keyä¸º <code>username</code> å¼•å‘çš„é—®é¢˜</p>
</blockquote>
<p>åœ¨propertiesä¸­é…ç½®é”®å€¼å¯¹çš„æ—¶å€™ï¼Œå¦‚æœkeyè®¾ç½®ä¸º<code>username</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=root</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>spring-properties.xml</code> æ³¨å…¥è¯¥å±æ€§</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.MyDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåï¼Œåœ¨æ§åˆ¶å°æ‰“å°çš„å´ä¸æ˜¯<code>root</code>ï¼Œè€Œæ˜¯è‡ªå·±ç”µè„‘çš„ç”¨æˆ·åã€‚</p>
<p>å‡ºç°é—®é¢˜çš„åŸå› æ˜¯ <code>&lt;context:property-placeholder/&gt;</code> æ ‡ç­¾ä¼šåŠ è½½ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œè€Œä¸”ç¯å¢ƒå˜é‡çš„å€¼ä¼šè¢«ä¼˜å…ˆåŠ è½½ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æŸ¥çœ‹ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    Map&lt;String, String&gt; env = System.getenv();</span><br><span class="line">    System.out.println(env);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§å®¶å¯ä»¥è‡ªè¡Œè¿è¡Œï¼Œåœ¨æ‰“å°å‡ºæ¥çš„ç»“æœä¸­ä¼šæœ‰ä¸€ä¸ªUSERNAME&#x3D;XXX[è‡ªå·±ç”µè„‘çš„ç”¨æˆ·åç§°]</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png"></p>
<p>ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä¸º xml æ–‡ä»¶çš„ <code>&lt;context:property-placeholder/&gt;</code> æ ‡ç­¾æ·»åŠ  <code>system-properties-mode:</code> å±æ€§å¹¶ä¸”è®¾ç½®ä¸º NEVER ï¼Œè¡¨ç¤ºä¸åŠ è½½ç³»ç»Ÿå±æ€§ã€‚</li>
<li>é¿å…ä½¿ç”¨ <code>username</code> ä½œä¸ºå±æ€§çš„ <code>key</code> ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è¿è¡Œæµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MyDataSource(driver=com.mysql.cj.jdbc.Driver, url=jdbc:mysql://localhost:3306/spring, username=root, password=root)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“æœ‰å¤šä¸ªpropertiesé…ç½®æ–‡ä»¶éœ€è¦è¢«åŠ è½½ï¼Œè¯¥å¦‚ä½•é…ç½®?</p>
</blockquote>
<p>a. è°ƒæ•´ä¸‹é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œåœ¨resourcesä¸‹æ·»åŠ  <code>jdbc.properties</code> ï¼Œ<code>jdbc2.properties</code> ï¼Œå†…å®¹å¦‚ä¸‹:</p>
<p><code>jdbc.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/spring</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p><code>jdbc2.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">username</span>=<span class="string">root666</span></span><br></pre></td></tr></table></figure>

<p>b. ä¿®æ”¹ <code>spring-properties.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–¹å¼ä¸€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties,jdbc2.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–¹å¼äºŒ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–¹å¼ä¸‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–¹å¼å››--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath*:*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜:</strong></p>
<ul>
<li>æ–¹å¼ä¸€ï¼šå¯ä»¥å®ç°ï¼Œå¦‚æœé…ç½®æ–‡ä»¶å¤šçš„è¯ï¼Œæ¯ä¸ªéƒ½éœ€è¦é…ç½®</li>
<li>æ–¹å¼äºŒï¼š<code>*.properties</code> ä»£è¡¨æ‰€æœ‰ä»¥ properties ç»“å°¾çš„æ–‡ä»¶éƒ½ä¼šè¢«åŠ è½½ï¼Œå¯ä»¥è§£å†³æ–¹å¼ä¸€çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸æ ‡å‡†</li>
<li>æ–¹å¼ä¸‰ï¼šæ ‡å‡†çš„å†™æ³•ï¼Œ<code>classpath: </code>ä»£è¡¨çš„æ˜¯ä»æ ¹è·¯å¾„ä¸‹å¼€å§‹æŸ¥æ‰¾ï¼Œä½†æ˜¯åªèƒ½æŸ¥è¯¢å½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„</li>
<li>æ–¹å¼å››ï¼šä¸ä»…å¯ä»¥åŠ è½½å½“å‰é¡¹ç›®è¿˜å¯ä»¥åŠ è½½å½“å‰é¡¹ç›®æ‰€ä¾èµ–çš„æ‰€æœ‰é¡¹ç›®çš„æ ¹è·¯å¾„ä¸‹çš„ properties é…ç½®æ–‡ä»¶</li>
</ul>
<h1 id="3-Beançš„ä½œç”¨åŸŸ"><a href="#3-Beançš„ä½œç”¨åŸŸ" class="headerlink" title="3. Beançš„ä½œç”¨åŸŸ"></a>3. Beançš„ä½œç”¨åŸŸ</h1><h2 id="3-1-singleton"><a href="#3-1-singleton" class="headerlink" title="3.1 singleton"></a>3.1 singleton</h2><blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring çš„ IoC å®¹å™¨åˆ›å»ºçš„ Bean å¯¹è±¡æ˜¯å•ä¾‹çš„ã€‚</p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBean</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-scope.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sb&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.SpringBean&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testScope</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-scope.xml&quot;</span>);</span><br><span class="line">    <span class="type">SpringBean</span> <span class="variable">sb1</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;sb&quot;</span>, SpringBean.class);</span><br><span class="line">    System.out.println(sb1);</span><br><span class="line">    <span class="type">SpringBean</span> <span class="variable">sb2</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;sb&quot;</span>, SpringBean.class);</span><br><span class="line">    System.out.println(sb2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.SpringBean@5d066c7d</span><br><span class="line">com.muyoukule.Bean.SpringBean@5d066c7d</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šSpringçš„IoCå®¹å™¨ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒBeanå¯¹è±¡æ˜¯å•ä¾‹çš„ã€‚</p>
<blockquote>
<p>è¿™ä¸ªå¯¹è±¡åœ¨ä»€ä¹ˆæ—¶å€™åˆ›å»ºçš„å‘¢ï¼Ÿ</p>
</blockquote>
<p>a. ä¸º <code>SpringBean</code> æä¾›ä¸€ä¸ªæ— å‚æ•°æ„é€ æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBean</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SpringBean</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SpringBeançš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. å°†æµ‹è¯•ç¨‹åºä¸­ <code>getBean()</code> æ‰€åœ¨è¡Œä»£ç æ³¨é‡Šæ‰ï¼Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testScope</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-scope.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*        SpringBean sb1 = applicationContext.getBean(&quot;sb&quot;, SpringBean.class);</span></span><br><span class="line"><span class="comment">    System.out.println(sb1);</span></span><br><span class="line"><span class="comment">    SpringBean sb2 = applicationContext.getBean(&quot;sb&quot;, SpringBean.class);</span></span><br><span class="line"><span class="comment">    System.out.println(sb2);*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SpringBeançš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒBeanå¯¹è±¡çš„åˆ›å»ºæ˜¯åœ¨åˆå§‹åŒ–Springä¸Šä¸‹æ–‡çš„æ—¶å€™å°±å®Œæˆçš„ã€‚</p>
<h2 id="3-2-prototype"><a href="#3-2-prototype" class="headerlink" title="3.2 prototype"></a>3.2 prototype</h2><p>å¦‚æœæƒ³è®©Springçš„Beanå¯¹è±¡ä»¥å¤šä¾‹çš„å½¢å¼å­˜åœ¨ï¼Œå¯ä»¥åœ¨ <code>bean</code> æ ‡ç­¾ä¸­æŒ‡å®š <code>scope</code> å±æ€§çš„å€¼ä¸ºï¼š<strong>prototype</strong>ï¼Œè¿™æ · Spring ä¼šåœ¨æ¯ä¸€æ¬¡æ‰§è¡Œ <code>getBean()</code> æ–¹æ³•çš„æ—¶å€™åˆ›å»ºBeanå¯¹è±¡ï¼Œè°ƒç”¨å‡ æ¬¡åˆ™åˆ›å»ºå‡ æ¬¡ã€‚</p>
<p>a. ä¿®æ”¹ <code>spring-scope.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sb&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.SpringBean&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testScope()&#123;</span><br><span class="line">    ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring-scope.xml&quot;);</span><br><span class="line"></span><br><span class="line">    SpringBean sb1 = applicationContext.getBean(&quot;sb&quot;, SpringBean.class);</span><br><span class="line">    System.out.println(sb1);</span><br><span class="line">    SpringBean sb2 = applicationContext.getBean(&quot;sb&quot;, SpringBean.class);</span><br><span class="line">    System.out.println(sb2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SpringBeançš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...</span><br><span class="line">com.muyoukule.Bean.SpringBean@3adcc812</span><br><span class="line">SpringBeançš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...</span><br><span class="line">com.muyoukule.Bean.SpringBean@35432107</span><br></pre></td></tr></table></figure>

<p>æŠŠæµ‹è¯•ä»£ç ä¸­çš„ <code>getBean()</code> æ–¹æ³•æ‰€åœ¨è¡Œä»£ç æ³¨é‡Šæ‰ï¼Œæ‰§è¡Œæµ‹è¯•ï¼Œç»“æœæ§åˆ¶å°æ— ä»»ä½•ä¿¡æ¯ã€‚</p>
<p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringåˆ›å»ºçš„ bean å¯¹è±¡éƒ½æ˜¯å•ä¾‹çš„</strong></p>
<p>ä»‹ç»å®Œ <code>scope</code> å±æ€§ä»¥åï¼Œæˆ‘ä»¬æ¥æ€è€ƒå‡ ä¸ªé—®é¢˜:</p>
<ul>
<li>ä¸ºä»€ä¹ˆ bean é»˜è®¤ä¸ºå•ä¾‹?<ul>
<li>bean ä¸ºå•ä¾‹çš„æ„æ€æ˜¯åœ¨ Spring çš„ IOC å®¹å™¨ä¸­åªä¼šæœ‰è¯¥ç±»çš„ä¸€ä¸ªå¯¹è±¡</li>
<li>bean å¯¹è±¡åªæœ‰ä¸€ä¸ªå°±é¿å…äº†å¯¹è±¡çš„é¢‘ç¹åˆ›å»ºä¸é”€æ¯ï¼Œè¾¾åˆ°äº† bean å¯¹è±¡çš„å¤ç”¨ï¼Œæ€§èƒ½é«˜</li>
</ul>
</li>
<li>bean åœ¨å®¹å™¨ä¸­æ˜¯å•ä¾‹çš„ï¼Œä¼šä¸ä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜?<ul>
<li>å¦‚æœå¯¹è±¡æ˜¯æœ‰çŠ¶æ€å¯¹è±¡ï¼Œå³è¯¥å¯¹è±¡æœ‰æˆå‘˜å˜é‡å¯ä»¥ç”¨æ¥å­˜å‚¨æ•°æ®çš„ï¼Œ</li>
<li>å› ä¸ºæ‰€æœ‰è¯·æ±‚çº¿ç¨‹å…±ç”¨ä¸€ä¸ª bean å¯¹è±¡ï¼Œæ‰€ä»¥ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>
<li>å¦‚æœå¯¹è±¡æ˜¯æ— çŠ¶æ€å¯¹è±¡ï¼Œå³è¯¥å¯¹è±¡æ²¡æœ‰æˆå‘˜å˜é‡æ²¡æœ‰è¿›è¡Œæ•°æ®å­˜å‚¨çš„ï¼Œ</li>
<li>å› æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡åœ¨æ–¹æ³•è°ƒç”¨å®Œæˆåä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥ä¸ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>
</ul>
</li>
<li>å“ªäº› bean å¯¹è±¡é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†?<ul>
<li>è¡¨ç°å±‚å¯¹è±¡</li>
<li>ä¸šåŠ¡å±‚å¯¹è±¡</li>
<li>æ•°æ®å±‚å¯¹è±¡</li>
<li>å·¥å…·å¯¹è±¡</li>
</ul>
</li>
<li>å“ªäº› bean å¯¹è±¡ä¸é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†?<ul>
<li>å°è£…å®ä¾‹çš„åŸŸå¯¹è±¡ï¼Œå› ä¸ºä¼šå¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥ä¸é€‚åˆã€‚</li>
</ul>
</li>
</ul>
<h2 id="3-3-å…¶å®ƒscope"><a href="#3-3-å…¶å®ƒscope" class="headerlink" title="3.3 å…¶å®ƒscope"></a>3.3 å…¶å®ƒscope</h2><p><strong>scopeå±æ€§çš„å€¼ä¸æ­¢ä¸¤ä¸ªï¼Œå®ƒä¸€å…±åŒ…æ‹¬8ä¸ªé€‰é¡¹ï¼š</strong></p>
<ul>
<li>singletonï¼šé»˜è®¤çš„ï¼Œå•ä¾‹ã€‚</li>
<li>prototypeï¼šåŸå‹ã€‚æ¯è°ƒç”¨ä¸€æ¬¡ <code>getBean()</code> æ–¹æ³•åˆ™è·å–ä¸€ä¸ªæ–°çš„Beanå¯¹è±¡ã€‚æˆ–æ¯æ¬¡æ³¨å…¥çš„æ—¶å€™éƒ½æ˜¯æ–°å¯¹è±¡ã€‚</li>
<li>requestï¼šä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ª Bean ã€‚<strong>ä»…é™äºåœ¨WEBåº”ç”¨ä¸­ä½¿ç”¨</strong>ã€‚</li>
<li>sessionï¼šä¸€ä¸ªä¼šè¯å¯¹åº”ä¸€ä¸ª Bean ã€‚<strong>ä»…é™äºåœ¨WEBåº”ç”¨ä¸­ä½¿ç”¨</strong>ã€‚</li>
<li>global sessionï¼š<strong>portletåº”ç”¨ä¸­ä¸“ç”¨çš„</strong>ã€‚å¦‚æœåœ¨ Servlet çš„ WEB åº”ç”¨ä¸­ä½¿ç”¨ <code>global session</code> çš„è¯ï¼Œå’Œ <code>session </code>ä¸€ä¸ªæ•ˆæœã€‚ï¼ˆportletå’Œservletéƒ½æ˜¯è§„èŒƒã€‚servletè¿è¡Œåœ¨servletå®¹å™¨ä¸­ï¼Œä¾‹å¦‚Tomcatã€‚portletè¿è¡Œåœ¨portletå®¹å™¨ä¸­ã€‚ï¼‰</li>
<li>applicationï¼šä¸€ä¸ªåº”ç”¨å¯¹åº”ä¸€ä¸ª Bean ã€‚<strong>ä»…é™äºåœ¨WEBåº”ç”¨ä¸­ä½¿ç”¨ã€‚</strong></li>
<li>websocketï¼šä¸€ä¸ª websocket ç”Ÿå‘½å‘¨æœŸå¯¹åº”ä¸€ä¸ª Bean ã€‚<strong>ä»…é™äºåœ¨WEBåº”ç”¨ä¸­ä½¿ç”¨ã€‚</strong></li>
<li>è‡ªå®šä¹‰scopeï¼šå¾ˆå°‘ä½¿ç”¨ã€‚</li>
</ul>
<h1 id="4-GoFä¹‹å·¥å‚æ¨¡å¼"><a href="#4-GoFä¹‹å·¥å‚æ¨¡å¼" class="headerlink" title="4. GoFä¹‹å·¥å‚æ¨¡å¼"></a>4. GoFä¹‹å·¥å‚æ¨¡å¼</h1><ul>
<li><p>è®¾è®¡æ¨¡å¼ï¼šä¸€ç§å¯ä»¥è¢«é‡å¤åˆ©ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><p>GoFï¼ˆGang of Fourï¼‰ï¼Œä¸­æ–‡åâ€”â€”å››äººç»„ã€‚</p>
</li>
<li><p>ã€ŠDesign Patterns: Elements of Reusable Object-Oriented Softwareã€‹ï¼ˆå³ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ï¼‰ï¼Œ1995å¹´ç”± Erich Gammaã€Richard Helmã€Ralph Johnson å’Œ John Vlissides åˆè‘—ã€‚è¿™å‡ ä½ä½œè€…å¸¸è¢«ç§°ä¸ºâ€å››äººç»„ï¼ˆGang of Fourï¼‰â€ã€‚</p>
</li>
<li><p>è¯¥ä¹¦ä¸­æè¿°äº†23ç§è®¾è®¡æ¨¡å¼ã€‚æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„è®¾è®¡æ¨¡å¼å°±æ˜¯æŒ‡è¿™23ç§è®¾è®¡æ¨¡å¼ã€‚</p>
</li>
<li><p>ä¸è¿‡é™¤äº†GoF23ç§è®¾è®¡æ¨¡å¼ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶å®ƒçš„è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚ï¼šJavaEEçš„è®¾è®¡æ¨¡å¼ï¼ˆDAOæ¨¡å¼ã€MVCæ¨¡å¼ç­‰ï¼‰ã€‚</p>
</li>
<li><p>GoF23ç§è®¾è®¡æ¨¡å¼å¯åˆ†ä¸ºä¸‰å¤§ç±»ï¼š</p>
<ul>
<li><strong>åˆ›å»ºå‹</strong>ï¼ˆ5ä¸ªï¼‰ï¼šè§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜ã€‚<ul>
<li>å•ä¾‹æ¨¡å¼</li>
<li>å·¥å‚æ–¹æ³•æ¨¡å¼</li>
<li>æŠ½è±¡å·¥å‚æ¨¡å¼</li>
<li>å»ºé€ è€…æ¨¡å¼</li>
<li>åŸå‹æ¨¡å¼</li>
</ul>
</li>
<li><strong>ç»“æ„å‹</strong>ï¼ˆ7ä¸ªï¼‰ï¼šä¸€äº›ç±»æˆ–å¯¹è±¡ç»„åˆåœ¨ä¸€èµ·çš„ç»å…¸ç»“æ„ã€‚<ul>
<li>ä»£ç†æ¨¡å¼</li>
<li>è£…é¥°æ¨¡å¼</li>
<li>é€‚é…å™¨æ¨¡å¼</li>
<li>ç»„åˆæ¨¡å¼</li>
<li>äº«å…ƒæ¨¡å¼</li>
<li>å¤–è§‚æ¨¡å¼</li>
<li>æ¡¥æ¥æ¨¡å¼</li>
</ul>
</li>
<li><strong>è¡Œä¸ºå‹</strong>ï¼ˆ11ä¸ªï¼‰ï¼šè§£å†³ç±»æˆ–å¯¹è±¡ä¹‹é—´çš„äº¤äº’é—®é¢˜ã€‚<ul>
<li>ç­–ç•¥æ¨¡å¼</li>
<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li>
<li>è´£ä»»é“¾æ¨¡å¼</li>
<li>è§‚å¯Ÿè€…æ¨¡å¼</li>
<li>è¿­ä»£å­æ¨¡å¼</li>
<li>å‘½ä»¤æ¨¡å¼</li>
<li>å¤‡å¿˜å½•æ¨¡å¼</li>
<li>çŠ¶æ€æ¨¡å¼</li>
<li>è®¿é—®è€…æ¨¡å¼</li>
<li>ä¸­ä»‹è€…æ¨¡å¼</li>
<li>è§£é‡Šå™¨æ¨¡å¼</li>
</ul>
</li>
</ul>
</li>
<li><p>å·¥å‚æ¨¡å¼æ˜¯è§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜çš„ï¼Œæ‰€ä»¥å·¥å‚æ¨¡å¼å±äºåˆ›å»ºå‹è®¾è®¡æ¨¡å¼ã€‚è¿™é‡Œä¸ºä»€ä¹ˆå­¦ä¹ å·¥å‚æ¨¡å¼å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º Spring æ¡†æ¶åº•å±‚ä½¿ç”¨äº†å¤§é‡çš„å·¥å‚æ¨¡å¼ã€‚</p>
</li>
</ul>
<h2 id="4-1-å·¥å‚æ¨¡å¼çš„ä¸‰ç§å½¢æ€"><a href="#4-1-å·¥å‚æ¨¡å¼çš„ä¸‰ç§å½¢æ€" class="headerlink" title="4.1 å·¥å‚æ¨¡å¼çš„ä¸‰ç§å½¢æ€"></a>4.1 å·¥å‚æ¨¡å¼çš„ä¸‰ç§å½¢æ€</h2><p>å·¥å‚æ¨¡å¼é€šå¸¸æœ‰ä¸‰ç§å½¢æ€ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§ï¼š<strong>ç®€å•å·¥å‚æ¨¡å¼ï¼ˆSimple Factoryï¼‰ï¼šä¸å±äº23ç§è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚ç®€å•å·¥å‚æ¨¡å¼åˆå«åšï¼šé™æ€ å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ç®€å•å·¥å‚æ¨¡å¼æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ç§ç‰¹æ®Šå®ç°ã€‚</strong></li>
<li>ç¬¬äºŒç§ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ï¼šæ˜¯23ç§è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</li>
<li>ç¬¬ä¸‰ç§ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰ï¼šæ˜¯23ç§è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</li>
</ul>
<h2 id="4-2-ç®€å•å·¥å‚æ¨¡å¼"><a href="#4-2-ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="4.2 ç®€å•å·¥å‚æ¨¡å¼"></a>4.2 ç®€å•å·¥å‚æ¨¡å¼</h2><p>ç®€å•å·¥å‚æ¨¡å¼çš„è§’è‰²åŒ…æ‹¬ä¸‰ä¸ªï¼š</p>
<ul>
<li>æŠ½è±¡äº§å“ è§’è‰²</li>
<li>å…·ä½“äº§å“ è§’è‰²</li>
<li>å·¥å‚ç±» è§’è‰²</li>
</ul>
<p>ç®€å•å·¥å‚æ¨¡å¼çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<p>æŠ½è±¡äº§å“è§’è‰²ï¼šWeapon</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰€æœ‰çš„æ­¦å™¨éƒ½æœ‰æ”»å‡»è¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“äº§å“è§’è‰²ï¼š</p>
<p>Tank</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tank</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¦å…‹å¼€ç‚®ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Fighter</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fighter</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ˜æ–—æœºæŠ•ä¸‹åŸå­å¼¹ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Dagger</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dagger</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç ä»–ä¸«çš„ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å·¥å‚ç±»è§’è‰²ï¼š</p>
<p>WeaponFactory</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Weapon <span class="title function_">get</span><span class="params">(String weaponType)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (weaponType == <span class="literal">null</span> || weaponType.trim().length() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;TANK&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Tank</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;FIGHTER&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Fighter</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;DAGGER&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Dagger</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸æ”¯æŒè¯¥æ­¦å™¨ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> weapon;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç¨‹åºï¼ˆå®¢æˆ·ç«¯ç¨‹åºï¼‰ï¼š</p>
<p>Client</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon1</span> <span class="operator">=</span> WeaponFactory.get(<span class="string">&quot;TANK&quot;</span>);</span><br><span class="line">        weapon1.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon2</span> <span class="operator">=</span> WeaponFactory.get(<span class="string">&quot;FIGHTER&quot;</span>);</span><br><span class="line">        weapon2.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon3</span> <span class="operator">=</span> WeaponFactory.get(<span class="string">&quot;DAGGER&quot;</span>);</span><br><span class="line">        weapon3.attack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¦å…‹å¼€ç‚®ï¼</span><br><span class="line">æˆ˜æ–—æœºæŠ•ä¸‹åŸå­å¼¹ï¼</span><br><span class="line">ç ä»–ä¸«çš„ï¼</span><br></pre></td></tr></table></figure>

<p>ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯ç¨‹åºä¸éœ€è¦å…³å¿ƒå¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ï¼Œéœ€è¦å“ªä¸ªå¯¹è±¡æ—¶ï¼Œåªéœ€è¦å‘å·¥å‚ç´¢è¦å³å¯ï¼Œåˆæ­¥å®ç°äº†è´£ä»»çš„åˆ†ç¦»ã€‚å®¢æˆ·ç«¯åªè´Ÿè´£â€œæ¶ˆè´¹â€ï¼Œå·¥å‚è´Ÿè´£â€œç”Ÿäº§â€ã€‚ç”Ÿäº§å’Œæ¶ˆè´¹åˆ†ç¦»ã€‚</li>
</ul>
<p>ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç¼ºç‚¹1ï¼šå·¥å‚ç±»é›†ä¸­äº†æ‰€æœ‰äº§å“çš„åˆ›é€ é€»è¾‘ï¼Œå½¢æˆä¸€ä¸ªæ— æ‰€ä¸çŸ¥çš„å…¨èƒ½ç±»ï¼Œæœ‰äººæŠŠå®ƒå«åšä¸Šå¸ç±»ã€‚æ˜¾ç„¶å·¥å‚ç±»éå¸¸å…³é”®ï¼Œä¸èƒ½å‡ºé—®é¢˜ï¼Œä¸€æ—¦å‡ºé—®é¢˜ï¼Œæ•´ä¸ªç³»ç»Ÿç˜«ç—ªã€‚</li>
<li>ç¼ºç‚¹2ï¼šä¸ç¬¦åˆOCPå¼€é—­åŸåˆ™ï¼Œåœ¨è¿›è¡Œç³»ç»Ÿæ‰©å±•æ—¶ï¼Œéœ€è¦ä¿®æ”¹å·¥å‚ç±»ã€‚</li>
</ul>
<p><strong>Springä¸­çš„BeanFactoryå°±ä½¿ç”¨äº†ç®€å•å·¥å‚æ¨¡å¼ã€‚</strong></p>
<h2 id="4-3-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#4-3-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="4.3 å·¥å‚æ–¹æ³•æ¨¡å¼"></a>4.3 å·¥å‚æ–¹æ³•æ¨¡å¼</h2><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ—¢ä¿ç•™äº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åˆè§£å†³äº†ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ã€‚</p>
<p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„è§’è‰²åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æŠ½è±¡å·¥å‚è§’è‰²</strong></li>
<li><strong>å…·ä½“å·¥å‚è§’è‰²</strong></li>
<li>æŠ½è±¡äº§å“è§’è‰²</li>
<li>å…·ä½“äº§å“è§’è‰²</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<p>æŠ½è±¡äº§å“è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰€æœ‰æ­¦å™¨éƒ½æœ‰æ”»å‡»è¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“äº§å“è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Gun</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼€æªå°„å‡»ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Fighter extends Weapon &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void attack() &#123;</span><br><span class="line">        System.out.println(&quot;æˆ˜æ–—æœºå‘å°„æ ¸å¼¹ï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠ½è±¡å·¥å‚è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    Weapon <span class="title function_">get</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“å·¥å‚è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GunFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Gun</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FighterFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Fighter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GunFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon</span> <span class="operator">=</span> factory.get();</span><br><span class="line">        weapon.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FighterFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon1</span> <span class="operator">=</span> factory1.get();</span><br><span class="line">        weapon1.attack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®¢æˆ·ç«¯ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼€æªå°„å‡»ï¼</span><br><span class="line">æˆ˜æ–—æœºå‘å°„æ ¸å¼¹</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³æ‰©å±•ä¸€ä¸ªæ–°çš„äº§å“ï¼Œåªè¦æ–°å¢ä¸€ä¸ªäº§å“ç±»ï¼Œå†æ–°å¢ä¸€ä¸ªè¯¥äº§å“å¯¹åº”çš„å·¥å‚å³å¯ï¼Œä¾‹å¦‚æ–°å¢ï¼šåŒ•é¦–ã€‚</p>
<p>å¢åŠ ï¼šå…·ä½“äº§å“è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dagger</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç ä¸«çš„ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¢åŠ ï¼šå…·ä½“å·¥å‚è§’è‰²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DaggerFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dagger</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GunFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon</span> <span class="operator">=</span> factory.get();</span><br><span class="line">        weapon.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FighterFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon1</span> <span class="operator">=</span> factory1.get();</span><br><span class="line">        weapon1.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DaggerFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon2</span> <span class="operator">=</span> factory2.get();</span><br><span class="line">        weapon2.attack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼€æªå°„å‡»ï¼</span><br><span class="line">æˆ˜æ–—æœºå‘å°„æ ¸å¼¹ï¼</span><br><span class="line">ç ä¸«çš„ï¼</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è¿›è¡ŒåŠŸèƒ½æ‰©å±•çš„æ—¶å€™ï¼Œä¸éœ€è¦ä¿®æ”¹ä¹‹å‰çš„æºä»£ç ï¼Œæ˜¾ç„¶å·¥å‚æ–¹æ³•æ¨¡å¼ç¬¦åˆOCPåŸåˆ™ã€‚</p>
<p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ä¸€ä¸ªè°ƒç”¨è€…æƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦çŸ¥é“å…¶åç§°å°±å¯ä»¥äº†ã€‚ </li>
<li>æ‰©å±•æ€§é«˜ï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ªäº§å“ï¼Œåªè¦æ‰©å±•ä¸€ä¸ªå·¥å‚ç±»å°±å¯ä»¥ã€‚</li>
<li>å±è”½äº§å“çš„å…·ä½“å®ç°ï¼Œè°ƒç”¨è€…åªå…³å¿ƒäº§å“çš„æ¥å£ã€‚</li>
</ul>
<p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>æ¯æ¬¡å¢åŠ ä¸€ä¸ªäº§å“æ—¶ï¼Œéƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå…·ä½“ç±»å’Œå¯¹è±¡å®ç°å·¥å‚ï¼Œä½¿å¾—ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°æˆå€å¢åŠ ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼ŒåŒæ—¶ä¹Ÿå¢åŠ äº†ç³»ç»Ÿå…·ä½“ç±»çš„ä¾èµ–ã€‚è¿™å¹¶ä¸æ˜¯ä»€ä¹ˆå¥½äº‹ã€‚</li>
</ul>
<h1 id="5-Beançš„å®ä¾‹åŒ–æ–¹å¼"><a href="#5-Beançš„å®ä¾‹åŒ–æ–¹å¼" class="headerlink" title="5. Beançš„å®ä¾‹åŒ–æ–¹å¼"></a>5. Beançš„å®ä¾‹åŒ–æ–¹å¼</h1><p>Springä¸ºBeanæä¾›äº†å¤šç§å®ä¾‹åŒ–æ–¹å¼ï¼Œé€šå¸¸åŒ…æ‹¬4ç§æ–¹å¼ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´åœ¨ Spring ä¸­ä¸º Bean å¯¹è±¡çš„åˆ›å»ºå‡†å¤‡äº†å¤šç§æ–¹æ¡ˆï¼Œç›®çš„æ˜¯ï¼šæ›´åŠ çµæ´»ï¼‰</p>
<ul>
<li>ç¬¬ä¸€ç§ï¼šé€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–</li>
<li>ç¬¬äºŒç§ï¼šé€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å®ä¾‹åŒ–</li>
<li>ç¬¬ä¸‰ç§ï¼šé€šè¿‡ <code>factory-bean</code> å®ä¾‹åŒ–</li>
<li>ç¬¬å››ç§ï¼šé€šè¿‡ <code>FactoryBean</code> æ¥å£å®ä¾‹åŒ–</li>
</ul>
<h2 id="5-1-é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–"><a href="#5-1-é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–" class="headerlink" title="5.1 é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–"></a>5.1 é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–</h2><p>æˆ‘ä»¬ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè°ƒç”¨ Bean çš„æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Userç±»çš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConstructor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Userç±»çš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ...</span><br><span class="line">com.muyoukule.Bean.User@5d066c7d</span><br></pre></td></tr></table></figure>

<h2 id="5-2-é€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å®ä¾‹åŒ–"><a href="#5-2-é€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å®ä¾‹åŒ–" class="headerlink" title="5.2 é€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å®ä¾‹åŒ–"></a>5.2 é€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å®ä¾‹åŒ–</h2><p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™ç®€å•å·¥å‚æ¨¡å¼å½“ä¸­çš„å·¥å‚ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class VipFactory &#123;</span><br><span class="line">    public static Vip get() &#123;</span><br><span class="line">        return new Vip();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šåˆ›å»ºè¯¥ Bean çš„æ–¹æ³•ï¼ˆä½¿ç”¨ <code>factory-method</code> å±æ€§æŒ‡å®šï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.VipFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;get&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSimpleFactory</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Vip</span> <span class="variable">vip</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;vipBean&quot;</span>, Vip.class);</span><br><span class="line">    System.out.println(vip);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.Vip@54e7df6a</span><br></pre></td></tr></table></figure>

<h2 id="5-3-é€šè¿‡factory-beanå®ä¾‹åŒ–"><a href="#5-3-é€šè¿‡factory-beanå®ä¾‹åŒ–" class="headerlink" title="5.3 é€šè¿‡factory-beanå®ä¾‹åŒ–"></a>5.3 é€šè¿‡factory-beanå®ä¾‹åŒ–</h2><p>è¿™ç§æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ï¼šé€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼è¿›è¡Œå®ä¾‹åŒ–ã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. å®šä¹‰å…·ä½“å·¥å‚ç±»ï¼Œå·¥å‚ç±»ä¸­å®šä¹‰å®ä¾‹æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Order <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Order</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š <code>factory-bean</code> ä»¥åŠ <code>factory-method</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.OrderFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderBean&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;orderFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;get&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSelfFactoryBean</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Order</span> <span class="variable">orderBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderBean&quot;</span>, Order.class);</span><br><span class="line">    System.out.println(orderBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.Order@32c4e8b2</span><br></pre></td></tr></table></figure>

<h2 id="5-4-é€šè¿‡FactoryBeanæ¥å£å®ä¾‹åŒ–"><a href="#5-4-é€šè¿‡FactoryBeanæ¥å£å®ä¾‹åŒ–" class="headerlink" title="5.4 é€šè¿‡FactoryBeanæ¥å£å®ä¾‹åŒ–"></a>5.4 é€šè¿‡FactoryBeanæ¥å£å®ä¾‹åŒ–</h2><p>ä»¥ä¸Šçš„ç¬¬ä¸‰ç§æ–¹å¼ä¸­ï¼Œ<code>factory-bean</code> æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ï¼Œ<code>factory-method</code> ä¹Ÿæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ã€‚</p>
<p>åœ¨Springä¸­ï¼Œå½“ä½ ç¼–å†™çš„ç±»ç›´æ¥å®ç° <code>FactoryBean</code> æ¥å£ä¹‹åï¼Œ<code>factory-bean</code> ä¸éœ€è¦æŒ‡å®šäº†ï¼Œf<code>actory-method</code> ä¹Ÿä¸éœ€è¦æŒ‡å®šäº†ã€‚</p>
<p><code>factory-bean</code> ä¼šè‡ªåŠ¨æŒ‡å‘å®ç° <code>FactoryBean</code> æ¥å£çš„ç±»ï¼Œ<code>factory-method</code> ä¼šè‡ªåŠ¨æŒ‡å‘ <code>getObject()</code> æ–¹æ³•ã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™ä¸€ä¸ªç±»å®ç° <code>FactoryBean</code> æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Person&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Person <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// trueè¡¨ç¤ºå•ä¾‹</span></span><br><span class="line">        <span class="comment">// falseè¡¨ç¤ºåŸå‹</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® <code>FactoryBean</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;personBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.PersonFactoryBean&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFactoryBean</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Person</span> <span class="variable">personBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;personBean&quot;</span>, Person.class);</span><br><span class="line">    System.out.println(personBean);</span><br><span class="line">    <span class="type">Person</span> <span class="variable">personBean2</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;personBean&quot;</span>, Person.class);</span><br><span class="line">    System.out.println(personBean2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>e. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.Person@4f0100a7</span><br><span class="line">com.muyoukule.Bean.Person@4f0100a7</span><br></pre></td></tr></table></figure>

<h2 id="5-5-BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«"><a href="#5-5-BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«" class="headerlink" title="5.5 BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«"></a>5.5 BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«</h2><blockquote>
<p>BeanFactory</p>
</blockquote>
<p>Spring IoC å®¹å™¨çš„é¡¶çº§å¯¹è±¡ï¼Œ<code>BeanFactory</code> è¢«ç¿»è¯‘ä¸º â€œBeanå·¥å‚â€ ï¼Œåœ¨ Spring çš„ IoC å®¹å™¨ä¸­ï¼Œâ€œBeanå·¥å‚â€ è´Ÿè´£åˆ›å»º Bean å¯¹è±¡ã€‚</p>
<p>BeanFactory æ˜¯å·¥å‚ã€‚</p>
<blockquote>
<p>FactoryBean</p>
</blockquote>
<p>FactoryBeanï¼šå®ƒæ˜¯ä¸€ä¸ª Beanï¼Œæ˜¯ä¸€ä¸ªèƒ½å¤Ÿ<strong>è¾…åŠ©Spring</strong>å®ä¾‹åŒ–å…¶å®ƒ Bean å¯¹è±¡çš„ä¸€ä¸ª Bean ã€‚</p>
<p>åœ¨Springä¸­ï¼ŒBeanå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç±»ï¼šæ™®é€šBean</li>
<li>ç¬¬äºŒç±»ï¼šå·¥å‚ Beanï¼ˆè®°ä½ï¼šå·¥å‚ Bean ä¹Ÿæ˜¯ä¸€ç§ Beanï¼Œåªä¸è¿‡è¿™ç§ Bean æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒå¯ä»¥è¾…åŠ© Spring å®ä¾‹åŒ–å…¶å®ƒ Bean å¯¹è±¡ã€‚ï¼‰</li>
</ul>
<h2 id="5-6-æ³¨å…¥è‡ªå®šä¹‰Date"><a href="#5-6-æ³¨å…¥è‡ªå®šä¹‰Date" class="headerlink" title="5.6 æ³¨å…¥è‡ªå®šä¹‰Date"></a>5.6 æ³¨å…¥è‡ªå®šä¹‰Date</h2><p>æˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œ<code>java.util.Date</code> åœ¨ Spring ä¸­è¢«å½“åšç®€å•ç±»å‹ï¼Œç®€å•ç±»å‹åœ¨æ³¨å…¥çš„æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨ value å±æ€§æˆ– value æ ‡ç­¾æ¥å®Œæˆã€‚ä½†æˆ‘ä»¬ä¹‹å‰å·²ç»æµ‹è¯•è¿‡äº†ï¼Œå¯¹äºDateç±»å‹æ¥è¯´ï¼Œé‡‡ç”¨ value å±æ€§æˆ– value æ ‡ç­¾èµ‹å€¼çš„æ—¶å€™ï¼Œå¯¹æ—¥æœŸå­—ç¬¦ä¸²çš„æ ¼å¼è¦æ±‚éå¸¸ä¸¥æ ¼ï¼Œå¿…é¡»æ˜¯è¿™ç§æ ¼å¼çš„ï¼šMon Oct 10 14:30:26 CST 2022ã€‚å…¶ä»–æ ¼å¼æ˜¯ä¸ä¼šè¢«è¯†åˆ«çš„ã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring-data.xml</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;studentBean&quot;</span> class=<span class="string">&quot;com.muyoukule.Bean.Student&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;birth&quot;</span> value=<span class="string">&quot;Mon Oct 10 14:30:26 CST 2002&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-data.xml&quot;</span>);</span><br><span class="line">    <span class="type">Student</span> <span class="variable">studentBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;studentBean&quot;</span>, Student.class);</span><br><span class="line">    System.out.println(studentBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Student(birth=Fri Oct 11 04:30:26 CST 2002)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæŠŠæ—¥æœŸæ ¼å¼ä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;studentBean&quot;</span> class=<span class="string">&quot;com.muyoukule.Bean.Student&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;birth&quot;</span> value=<span class="string">&quot;2002-10-10&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E9%94%99%E8%AF%AF.png"></p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>FactoryBean</code> æ¥å®Œæˆè¿™ä¸ªæ“ä½œã€‚</p>
<p>a. ç¼–å†™ <code>DateFactoryBean</code> å®ç° <code>FactoryBean</code> æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DateFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Date&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰å±æ€§æ¥æ”¶æ—¥æœŸå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">private</span> String date;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æ„é€ æ–¹æ³•ç»™æ—¥æœŸå­—ç¬¦ä¸²å±æ€§èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DateFactoryBean</span><span class="params">(String date)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.date = date;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sdf.parse(<span class="built_in">this</span>.date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™springé…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dateBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.DateFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1999-10-11&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;studentBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dateBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Student(birth=Mon Oct 11 00:00:00 CST 1999)</span><br></pre></td></tr></table></figure>

<h1 id="6-Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#6-Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="6. Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>6. Beançš„ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="6-1-ä»€ä¹ˆæ˜¯Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#6-1-ä»€ä¹ˆæ˜¯Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="6.1 ä»€ä¹ˆæ˜¯Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>6.1 ä»€ä¹ˆæ˜¯Beançš„ç”Ÿå‘½å‘¨æœŸ</h2><p>Springå…¶å®å°±æ˜¯ä¸€ä¸ªç®¡ç†Beanå¯¹è±¡çš„å·¥å‚ã€‚å®ƒè´Ÿè´£å¯¹è±¡çš„åˆ›å»ºï¼Œå¯¹è±¡çš„é”€æ¯ç­‰ã€‚</p>
<p>æ‰€è°“çš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ï¼šå¯¹è±¡ä»åˆ›å»ºå¼€å§‹åˆ°æœ€ç»ˆé”€æ¯çš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p>
<p>ä»€ä¹ˆæ—¶å€™åˆ›å»ºBeanå¯¹è±¡ï¼Ÿ</p>
<p>åˆ›å»ºBeanå¯¹è±¡çš„å‰åä¼šè°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Ÿ</p>
<p>Beanå¯¹è±¡ä»€ä¹ˆæ—¶å€™é”€æ¯ï¼Ÿ</p>
<p>Beanå¯¹è±¡çš„é”€æ¯å‰åè°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Ÿ</p>
<h2 id="6-2-ä¸ºä»€ä¹ˆè¦çŸ¥é“Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#6-2-ä¸ºä»€ä¹ˆè¦çŸ¥é“Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="6.2 ä¸ºä»€ä¹ˆè¦çŸ¥é“Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>6.2 ä¸ºä»€ä¹ˆè¦çŸ¥é“Beançš„ç”Ÿå‘½å‘¨æœŸ</h2><p>å…¶å®ç”Ÿå‘½å‘¨æœŸçš„æœ¬è´¨æ˜¯ï¼šåœ¨å“ªä¸ªæ—¶é—´èŠ‚ç‚¹ä¸Šè°ƒç”¨äº†å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å……åˆ†çš„äº†è§£åœ¨è¿™ä¸ªç”Ÿå‘½çº¿ä¸Šï¼Œéƒ½æœ‰å“ªäº›ç‰¹æ®Šçš„æ—¶é—´èŠ‚ç‚¹ã€‚</p>
<p>åªæœ‰æˆ‘ä»¬çŸ¥é“äº†ç‰¹æ®Šçš„æ—¶é—´èŠ‚ç‚¹éƒ½åœ¨å“ªï¼Œåˆ°æ—¶æˆ‘ä»¬æ‰å¯ä»¥ç¡®å®šä»£ç å†™åˆ°å“ªã€‚</p>
<p>æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æŸä¸ªç‰¹æ®Šçš„æ—¶é—´ç‚¹ä¸Šæ‰§è¡Œä¸€æ®µç‰¹å®šçš„ä»£ç ï¼Œè¿™æ®µä»£ç å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªèŠ‚ç‚¹ä¸Šã€‚å½“ç”Ÿå‘½çº¿èµ°åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œè‡ªç„¶ä¼šè¢«è°ƒç”¨ã€‚</p>
<h2 id="6-3-Beançš„ç”Ÿå‘½å‘¨æœŸä¹‹5æ­¥"><a href="#6-3-Beançš„ç”Ÿå‘½å‘¨æœŸä¹‹5æ­¥" class="headerlink" title="6.3 Beançš„ç”Ÿå‘½å‘¨æœŸä¹‹5æ­¥"></a>6.3 Beançš„ç”Ÿå‘½å‘¨æœŸä¹‹5æ­¥</h2><p>Bean ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œå¯ä»¥å‚è€ƒSpringçš„æºç ï¼š<code>AbstractAutowireCapableBeanFactory</code> ç±»çš„ <code>doCreateBean()</code> æ–¹æ³•</p>
<p>Bean ç”Ÿå‘½å‘¨æœŸå¯ä»¥ç²—ç•¥çš„åˆ’åˆ†ä¸ºäº”å¤§æ­¥ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šå®ä¾‹åŒ–Bean</li>
<li>ç¬¬äºŒæ­¥ï¼šBeanå±æ€§èµ‹å€¼</li>
<li>ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–Bean</li>
<li>ç¬¬å››æ­¥ï¼šä½¿ç”¨Bean</li>
<li>ç¬¬äº”æ­¥ï¼šé”€æ¯Bean</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B5%E6%AD%A5.png"></p>
<p>ç¼–å†™æµ‹è¯•ç¨‹åºï¼š</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1.å®ä¾‹åŒ–Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        System.out.println(<span class="string">&quot;2.Beanå±æ€§èµ‹å€¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBean</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;3.åˆå§‹åŒ–Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyBean</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;5.é”€æ¯Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--init-methodå±æ€§æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ã€‚destroy-methodå±æ€§æŒ‡å®šé”€æ¯æ–¹æ³•ã€‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLifecycle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;4.ä½¿ç”¨Bean&quot;</span>);</span><br><span class="line">    <span class="comment">// åªæœ‰æ­£å¸¸å…³é—­springå®¹å™¨æ‰ä¼šæ‰§è¡Œé”€æ¯æ–¹æ³•</span></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> (ClassPathXmlApplicationContext) applicationContext;</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å®ä¾‹åŒ–Bean</span><br><span class="line">2.Beanå±æ€§èµ‹å€¼</span><br><span class="line">3.åˆå§‹åŒ–Bean</span><br><span class="line">4.ä½¿ç”¨Bean</span><br><span class="line">5.é”€æ¯Bean</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„ï¼š</p>
<ul>
<li>ç¬¬ä¸€ï¼šåªæœ‰æ­£å¸¸å…³é—­ spring å®¹å™¨ï¼Œbean çš„é”€æ¯æ–¹æ³•æ‰ä¼šè¢«è°ƒç”¨ã€‚</li>
<li>ç¬¬äºŒï¼š<code>ClassPathXmlApplicationContext</code> ç±»æ‰æœ‰ close() æ–¹æ³•ã€‚</li>
<li>ç¬¬ä¸‰ï¼šé…ç½®æ–‡ä»¶ä¸­çš„ <code>init-method</code> æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ã€‚ <code>destroy-method</code> æŒ‡å®šé”€æ¯æ–¹æ³•ã€‚</li>
</ul>
<h2 id="6-4-Beanç”Ÿå‘½å‘¨æœŸä¹‹7æ­¥"><a href="#6-4-Beanç”Ÿå‘½å‘¨æœŸä¹‹7æ­¥" class="headerlink" title="6.4 Beanç”Ÿå‘½å‘¨æœŸä¹‹7æ­¥"></a>6.4 Beanç”Ÿå‘½å‘¨æœŸä¹‹7æ­¥</h2><p>åœ¨ä»¥ä¸Šçš„5æ­¥ä¸­ï¼Œç¬¬3æ­¥æ˜¯åˆå§‹åŒ– Bean ï¼Œå¦‚æœä½ è¿˜æƒ³åœ¨åˆå§‹åŒ–å‰å’Œåˆå§‹åŒ–åæ·»åŠ ä»£ç ï¼Œå¯ä»¥åŠ å…¥â€œ Bean åå¤„ç†å™¨â€ã€‚</p>
<p>a. ç¼–å†™ä¸€ä¸ªç±»å®ç° <code>BeanPostProcessor</code> ç±»ï¼Œå¹¶ä¸”é‡å†™ <code>before</code> å’Œ <code>after</code> æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Beanåå¤„ç†å™¨çš„beforeæ–¹æ³•æ‰§è¡Œï¼Œå³å°†å¼€å§‹åˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Beanåå¤„ç†å™¨çš„afteræ–¹æ³•æ‰§è¡Œï¼Œå·²å®Œæˆåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨ <code>spring.xml</code> æ–‡ä»¶ä¸­é…ç½®â€œ Bean åå¤„ç†å™¨â€ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--init-methodå±æ€§æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ã€‚destroy-methodå±æ€§æŒ‡å®šé”€æ¯æ–¹æ³•ã€‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®Beanåå¤„ç†å™¨ã€‚è¿™ä¸ªåå¤„ç†å™¨å°†ä½œç”¨äºå½“å‰é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„beanã€‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.LogBeanPostProcessor&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸€å®šè¦æ³¨æ„ï¼šåœ¨ <code>spring.xml</code> æ–‡ä»¶ä¸­é…ç½®çš„ Bean åå¤„ç†å™¨å°†ä½œç”¨äºå½“å‰é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„ Bean ã€‚</p>
<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å®ä¾‹åŒ–Bean</span><br><span class="line">2.Beanå±æ€§èµ‹å€¼</span><br><span class="line">Beanåå¤„ç†å™¨çš„beforeæ–¹æ³•æ‰§è¡Œï¼Œå³å°†å¼€å§‹åˆå§‹åŒ–</span><br><span class="line">3.åˆå§‹åŒ–Bean</span><br><span class="line">Beanåå¤„ç†å™¨çš„afteræ–¹æ³•æ‰§è¡Œï¼Œå·²å®Œæˆåˆå§‹åŒ–</span><br><span class="line">4.ä½¿ç”¨Bean</span><br><span class="line">5.é”€æ¯Bean</span><br></pre></td></tr></table></figure>

<h2 id="6-5-Beanç”Ÿå‘½å‘¨æœŸä¹‹10æ­¥"><a href="#6-5-Beanç”Ÿå‘½å‘¨æœŸä¹‹10æ­¥" class="headerlink" title="6.5 Beanç”Ÿå‘½å‘¨æœŸä¹‹10æ­¥"></a>6.5 Beanç”Ÿå‘½å‘¨æœŸä¹‹10æ­¥</h2><p>å¦‚æœæ ¹æ®æºç è·Ÿè¸ªï¼Œå¯ä»¥åˆ’åˆ†æ›´ç»†ç²’åº¦çš„æ­¥éª¤ï¼Œ10æ­¥ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B10%E6%AD%A5.png"></p>
<p>ä¸Šå›¾ä¸­æ£€æŸ¥ Bean æ˜¯å¦å®ç°äº† <code>Aware</code> çš„ç›¸å…³æ¥å£æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<p>Aware ç›¸å…³çš„æ¥å£åŒ…æ‹¬ï¼š<code>BeanNameAware</code> ã€<code>BeanClassLoaderAware</code> ã€<code>BeanFactoryAware</code></p>
<ul>
<li>å½“Beanå®ç°äº† <code>BeanNameAware</code> ï¼ŒSpring ä¼šå°† Bean çš„åå­—ä¼ é€’ç»™ Beanã€‚</li>
<li>å½“Beanå®ç°äº† <code>BeanClassLoaderAware</code> ï¼ŒSpring ä¼šå°†åŠ è½½è¯¥ Bean çš„ç±»åŠ è½½å™¨ä¼ é€’ç»™ Beanã€‚</li>
<li>å½“Beanå®ç°äº† <code>BeanFactoryAware</code> ï¼ŒSpringä¼šå°† Bean å·¥å‚å¯¹è±¡ä¼ é€’ç»™ Beanã€‚</li>
</ul>
<p>æµ‹è¯•ä»¥ä¸Š10æ­¥ï¼Œå¯ä»¥è®© Userç±»å®ç°5ä¸ªæ¥å£ï¼Œå¹¶å®ç°æ‰€æœ‰æ–¹æ³•ï¼š</p>
<ul>
<li>BeanNameAware</li>
<li>BeanClassLoaderAware</li>
<li>BeanFactoryAware</li>
<li>InitializingBean</li>
<li>DisposableBean</li>
</ul>
<p>a. ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">BeanNameAware</span>, BeanClassLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1.å®ä¾‹åŒ–Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        System.out.println(<span class="string">&quot;2.Beanå±æ€§èµ‹å€¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBean</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;6.åˆå§‹åŒ–Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyBean</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;10.é”€æ¯Bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanClassLoader</span><span class="params">(ClassLoader classLoader)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;3.ç±»åŠ è½½å™¨ï¼š&quot;</span> + classLoader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanFactory</span><span class="params">(BeanFactory beanFactory)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;3.Beanå·¥å‚ï¼š&quot;</span> + beanFactory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;3.beanåå­—ï¼š&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;9.DisposableBean destroy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;5.afterPropertiesSetæ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>LogBeanPostProcessor</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;4.Beanåå¤„ç†å™¨çš„beforeæ–¹æ³•æ‰§è¡Œï¼Œå³å°†å¼€å§‹åˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;7.Beanåå¤„ç†å™¨çš„afteræ–¹æ³•æ‰§è¡Œï¼Œå·²å®Œæˆåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLifecycle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;8.ä½¿ç”¨Bean&quot;</span>);</span><br><span class="line">    <span class="comment">// åªæœ‰æ­£å¸¸å…³é—­springå®¹å™¨æ‰ä¼šæ‰§è¡Œé”€æ¯æ–¹æ³•</span></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> (ClassPathXmlApplicationContext) applicationContext;</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å®ä¾‹åŒ–Bean</span><br><span class="line">2.Beanå±æ€§èµ‹å€¼</span><br><span class="line">3.beanåå­—ï¼šuserBean</span><br><span class="line">3.ç±»åŠ è½½å™¨ï¼šjdk.internal.loader.ClassLoaders$AppClassLoader@63947c6b</span><br><span class="line">3.Beanå·¥å‚ï¼šorg.springframework.beans.factory.support.DefaultListableBeanFactory@1bae316d: defining beans [userBean,com.muyoukule.Bean.LogBeanPostProcessor#0]; root of factory hierarchy</span><br><span class="line">4.Beanåå¤„ç†å™¨çš„beforeæ–¹æ³•æ‰§è¡Œï¼Œå³å°†å¼€å§‹åˆå§‹åŒ–</span><br><span class="line">5.afterPropertiesSetæ‰§è¡Œ</span><br><span class="line">6.åˆå§‹åŒ–Bean</span><br><span class="line">7.Beanåå¤„ç†å™¨çš„afteræ–¹æ³•æ‰§è¡Œï¼Œå·²å®Œæˆåˆå§‹åŒ–</span><br><span class="line">8.ä½¿ç”¨Bean</span><br><span class="line">9.DisposableBean destroy</span><br><span class="line">10.é”€æ¯Bean</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹å‡ºæ¥ï¼š</p>
<ul>
<li><code>InitializingBean</code> çš„æ–¹æ³•æ—©äº <code>init-method</code> çš„æ‰§è¡Œã€‚</li>
<li><code>DisposableBean</code> çš„æ–¹æ³•æ—©äº <code>destroy-method</code> çš„æ‰§è¡Œã€‚</li>
</ul>
<h2 id="6-6-Beançš„ä½œç”¨åŸŸä¸åŒï¼Œç®¡ç†æ–¹å¼ä¸åŒ"><a href="#6-6-Beançš„ä½œç”¨åŸŸä¸åŒï¼Œç®¡ç†æ–¹å¼ä¸åŒ" class="headerlink" title="6.6 Beançš„ä½œç”¨åŸŸä¸åŒï¼Œç®¡ç†æ–¹å¼ä¸åŒ"></a>6.6 Beançš„ä½œç”¨åŸŸä¸åŒï¼Œç®¡ç†æ–¹å¼ä¸åŒ</h2><p>Spring æ ¹æ® Bean çš„ä½œç”¨åŸŸæ¥é€‰æ‹©ç®¡ç†æ–¹å¼ã€‚</p>
<ul>
<li>å¯¹äº <code>singleton</code> ä½œç”¨åŸŸçš„ Beanï¼ŒSpring èƒ½å¤Ÿç²¾ç¡®åœ°çŸ¥é“è¯¥ Bean ä½•æ—¶è¢«åˆ›å»ºï¼Œä½•æ—¶åˆå§‹åŒ–å®Œæˆï¼Œä»¥åŠä½•æ—¶è¢«é”€æ¯ï¼›</li>
<li>è€Œå¯¹äº <code>prototype</code> ä½œç”¨åŸŸçš„ Beanï¼ŒSpring åªè´Ÿè´£åˆ›å»ºï¼Œå½“å®¹å™¨åˆ›å»ºäº† Bean çš„å®ä¾‹åï¼ŒBean çš„å®ä¾‹å°±äº¤ç»™å®¢æˆ·ç«¯ä»£ç ç®¡ç†ï¼ŒSpring å®¹å™¨å°†ä¸å†è·Ÿè¸ªå…¶ç”Ÿå‘½å‘¨æœŸã€‚</li>
</ul>
<p>a. æŠŠä¹‹å‰Userç±»çš„spring.xmlæ–‡ä»¶ä¸­çš„é…ç½® scope è®¾ç½®ä¸º <code>prototype</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--init-methodå±æ€§æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ã€‚destroy-methodå±æ€§æŒ‡å®šé”€æ¯æ–¹æ³•ã€‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.User&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyBean&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å®ä¾‹åŒ–Bean</span><br><span class="line">2.Beanå±æ€§èµ‹å€¼</span><br><span class="line">3.beanåå­—ï¼šuserBean</span><br><span class="line">3.ç±»åŠ è½½å™¨ï¼šjdk.internal.loader.ClassLoaders$AppClassLoader@63947c6b</span><br><span class="line">3.Beanå·¥å‚ï¼šorg.springframework.beans.factory.support.DefaultListableBeanFactory@1bae316d: defining beans [userBean,com.muyoukule.Bean.LogBeanPostProcessor#0]; root of factory hierarchy</span><br><span class="line">4.Beanåå¤„ç†å™¨çš„beforeæ–¹æ³•æ‰§è¡Œï¼Œå³å°†å¼€å§‹åˆå§‹åŒ–</span><br><span class="line">5.afterPropertiesSetæ‰§è¡Œ</span><br><span class="line">6.åˆå§‹åŒ–Bean</span><br><span class="line">7.Beanåå¤„ç†å™¨çš„afteræ–¹æ³•æ‰§è¡Œï¼Œå·²å®Œæˆåˆå§‹åŒ–</span><br><span class="line">8.ä½¿ç”¨Bean</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•ä¸€ç›®äº†ç„¶ã€‚åªæ‰§è¡Œäº†å‰8æ­¥ï¼Œç¬¬9å’Œ10éƒ½æ²¡æœ‰æ‰§è¡Œã€‚</p>
<h2 id="6-7-è‡ªå·±newçš„å¯¹è±¡å¦‚ä½•è®©Springç®¡ç†"><a href="#6-7-è‡ªå·±newçš„å¯¹è±¡å¦‚ä½•è®©Springç®¡ç†" class="headerlink" title="6.7 è‡ªå·±newçš„å¯¹è±¡å¦‚ä½•è®©Springç®¡ç†"></a>6.7 è‡ªå·±newçš„å¯¹è±¡å¦‚ä½•è®©Springç®¡ç†</h2><p>æœ‰äº›æ—¶å€™å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼ŒæŸä¸ªjavaå¯¹è±¡æ˜¯æˆ‘ä»¬è‡ªå·±newçš„ï¼Œç„¶åæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå¯¹è±¡è¢«Springå®¹å™¨ç®¡ç†ï¼Œæ€ä¹ˆå®ç°ï¼Ÿ</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBeanRegister</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è‡ªå·±newçš„å¯¹è±¡</span></span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">    System.out.println(student);</span><br><span class="line">    <span class="comment">// åˆ›å»º é»˜è®¤å¯åˆ—è¡¨BeanFactory å¯¹è±¡</span></span><br><span class="line">    <span class="type">DefaultListableBeanFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultListableBeanFactory</span>();</span><br><span class="line">    <span class="comment">// æ³¨å†ŒBean</span></span><br><span class="line">    factory.registerSingleton(<span class="string">&quot;studentBean&quot;</span>, student);</span><br><span class="line">    <span class="comment">// ä»springå®¹å™¨ä¸­è·å–bean</span></span><br><span class="line">    <span class="type">Student</span> <span class="variable">studentBean</span> <span class="operator">=</span> factory.getBean(<span class="string">&quot;studentBean&quot;</span>, Student.class);</span><br><span class="line">    System.out.println(studentBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.Student@6bdf28bb</span><br><span class="line">com.muyoukule.Bean.Student@6bdf28bb</span><br></pre></td></tr></table></figure>

<h1 id="7-Beançš„å¾ªç¯ä¾èµ–é—®é¢˜"><a href="#7-Beançš„å¾ªç¯ä¾èµ–é—®é¢˜" class="headerlink" title="7. Beançš„å¾ªç¯ä¾èµ–é—®é¢˜"></a>7. Beançš„å¾ªç¯ä¾èµ–é—®é¢˜</h1><h2 id="7-1-ä»€ä¹ˆæ˜¯Beançš„å¾ªç¯ä¾èµ–"><a href="#7-1-ä»€ä¹ˆæ˜¯Beançš„å¾ªç¯ä¾èµ–" class="headerlink" title="7.1 ä»€ä¹ˆæ˜¯Beançš„å¾ªç¯ä¾èµ–"></a>7.1 ä»€ä¹ˆæ˜¯Beançš„å¾ªç¯ä¾èµ–</h2><p>Aå¯¹è±¡ä¸­æœ‰Bå±æ€§ã€‚Bå¯¹è±¡ä¸­æœ‰Aå±æ€§ã€‚è¿™å°±æ˜¯å¾ªç¯ä¾èµ–ã€‚æˆ‘ä¾èµ–ä½ ï¼Œä½ ä¹Ÿä¾èµ–æˆ‘ã€‚</p>
<p>æ¯”å¦‚ï¼šä¸ˆå¤«ç±»Husbandï¼Œå¦»å­ç±»Wifeã€‚Husbandä¸­æœ‰Wifeçš„å¼•ç”¨ã€‚Wifeä¸­æœ‰Husbandçš„å¼•ç”¨ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/Bean%E7%9A%84%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96.png"></p>
<p>Husband</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Wife</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-singletonä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"><a href="#7-2-singletonä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–" class="headerlink" title="7.2 singletonä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"></a>7.2 singletonä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–</h2><p>æˆ‘ä»¬æ¥ç¼–å†™ç¨‹åºï¼Œæµ‹è¯•ä¸€ä¸‹åœ¨ singleton+setter çš„æ¨¡å¼ä¸‹äº§ç”Ÿçš„å¾ªç¯ä¾èµ–ï¼ŒSpringæ˜¯å¦èƒ½å¤Ÿè§£å†³ï¼Ÿ</p>
<p>a. ç»™ä¸Šé¢çš„ç±»æ·»åŠ æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// toString()æ–¹æ³•é‡å†™æ—¶éœ€è¦æ³¨æ„ï¼šä¸èƒ½ç›´æ¥è¾“å‡ºwifeï¼Œè¾“å‡ºwife.getName()ã€‚è¦ä¸ç„¶ä¼šå‡ºç°é€’å½’å¯¼è‡´çš„æ ˆå†…å­˜æº¢å‡ºé”™è¯¯ã€‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Husband&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, wife=&quot;</span> + wife.getName() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// toString()æ–¹æ³•é‡å†™æ—¶éœ€è¦æ³¨æ„ï¼šä¸èƒ½ç›´æ¥è¾“å‡ºhusbandï¼Œè¾“å‡ºhusband.getName()ã€‚è¦ä¸ç„¶ä¼šå‡ºç°é€’å½’å¯¼è‡´çš„æ ˆå†…å­˜æº¢å‡ºé”™è¯¯ã€‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wife&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, husband=&quot;</span> + husband.getName() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. <code>spring.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;husbandBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wifeBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wifeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°èŠ±&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;husbandBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSingletonAndSet</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Husband</span> <span class="variable">husbandBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;husbandBean&quot;</span>, Husband.class);</span><br><span class="line">    <span class="type">Wife</span> <span class="variable">wifeBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;wifeBean&quot;</span>, Wife.class);</span><br><span class="line">    System.out.println(husbandBean);</span><br><span class="line">    System.out.println(wifeBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Husband&#123;name=&#x27;å¼ ä¸‰&#x27;, wife=å°èŠ±&#125;</span><br><span class="line">Wife&#123;name=&#x27;å°èŠ±&#x27;, husband=å¼ ä¸‰&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šåœ¨ <code>singleton</code>  +  <code>set</code> æ³¨å…¥çš„æƒ…å†µä¸‹ï¼Œå¾ªç¯ä¾èµ–æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚Spring å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="7-3-prototypeä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"><a href="#7-3-prototypeä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–" class="headerlink" title="7.3 prototypeä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"></a>7.3 prototypeä¸‹çš„setæ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–</h2><p>æˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ï¼š<code>prototype</code> + <code>set</code> æ³¨å…¥çš„æ–¹å¼ä¸‹ï¼Œå¾ªç¯ä¾èµ–ä¼šä¸ä¼šå‡ºç°é—®é¢˜ï¼Ÿ</p>
<p>a. ä¿®æ”¹<code>spring.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;husbandBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wifeBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wifeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°èŠ±&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;husbandBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. æµ‹è¯•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%88%9B%E5%BB%BA%E5%90%8D%E4%B8%BAhusbandBean%E7%9A%84bean%E6%97%B6%E5%87%BA%E9%94%99.png"></p>
<p>ç¿»è¯‘ä¸ºï¼šåˆ›å»ºåä¸ºâ€œ <code>husbandBean</code> â€çš„ bean æ—¶å‡ºé”™ï¼šè¯·æ±‚çš„ bean å½“å‰æ­£åœ¨åˆ›å»ºä¸­ï¼šæ˜¯å¦å­˜åœ¨æ— æ³•è§£æçš„å¾ªç¯å¼•ç”¨ï¼Ÿ</p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œå½“å¾ªç¯ä¾èµ–çš„æ‰€æœ‰ Bean çš„ <code>scope=&quot;prototype&quot;</code> çš„æ—¶å€™ï¼Œäº§ç”Ÿçš„å¾ªç¯ä¾èµ–ï¼ŒSpring æ˜¯æ— æ³•è§£å†³çš„ï¼Œä¼šå‡ºç° <code>BeanCurrentlyInCreationException</code> å¼‚å¸¸ã€‚</p>
<p>å¤§å®¶å¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œä»¥ä¸Šä¸¤ä¸ª Beanï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ˜¯ <code>singleton</code> ï¼Œå¦ä¸€ä¸ªæ˜¯ <code>prototype</code> ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸¤ä¸ªBeanéƒ½æ˜¯ <code>prototype</code> æ—¶ä¼šå‡ºé”™å‘¢ï¼Ÿ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E4%B8%A4%E4%B8%AABean%E9%83%BD%E6%98%AFprototype%E6%97%B6%E5%87%BA%E9%94%99%E7%9A%84%E5%8E%9F%E5%9B%A0.png"></p>
<h2 id="7-4-singletonä¸‹çš„æ„é€ æ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"><a href="#7-4-singletonä¸‹çš„æ„é€ æ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–" class="headerlink" title="7.4 singletonä¸‹çš„æ„é€ æ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–"></a>7.4 singletonä¸‹çš„æ„é€ æ³¨å…¥äº§ç”Ÿçš„å¾ªç¯ä¾èµ–</h2><p>æˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹singleton + æ„é€ æ³¨å…¥çš„æ–¹å¼ä¸‹ï¼Œspringæ˜¯å¦èƒ½å¤Ÿè§£å†³è¿™ç§å¾ªç¯ä¾èµ–ã€‚</p>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b.  ä¿®æ”¹ <code>spring.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Bean.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°èŠ±&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;hBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSingletonAndConstructor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Husband</span> <span class="variable">hBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;hBean&quot;</span>, Husband.class);</span><br><span class="line">    <span class="type">Wife</span> <span class="variable">wBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;wBean&quot;</span>, Wife.class);</span><br><span class="line">    System.out.println(hBean);</span><br><span class="line">    System.out.println(wBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç»“æœ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%8F%90%E7%A4%BA%E4%BA%A7%E7%94%9F%E4%BA%86%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96.png"></p>
<p>å’Œä¸Šä¸€ä¸ªæµ‹è¯•ç»“æœç›¸åŒï¼Œéƒ½æ˜¯æç¤ºäº§ç”Ÿäº†å¾ªç¯ä¾èµ–ï¼Œå¹¶ä¸”Springæ˜¯æ— æ³•è§£å†³è¿™ç§å¾ªç¯ä¾èµ–çš„ã€‚è¿™æ˜¯é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥å¯¼è‡´çš„ï¼šå› ä¸ºæ„é€ æ–¹æ³•æ³¨å…¥ä¼šå¯¼è‡´å®ä¾‹åŒ–å¯¹è±¡çš„è¿‡ç¨‹å’Œå¯¹è±¡å±æ€§èµ‹å€¼çš„è¿‡ç¨‹æ²¡æœ‰åˆ†ç¦»å¼€ï¼Œå¿…é¡»åœ¨ä¸€èµ·å®Œæˆã€‚</p>
<h2 id="7-5-Springè§£å†³å¾ªç¯ä¾èµ–çš„æœºç†"><a href="#7-5-Springè§£å†³å¾ªç¯ä¾èµ–çš„æœºç†" class="headerlink" title="7.5 Springè§£å†³å¾ªç¯ä¾èµ–çš„æœºç†"></a>7.5 Springè§£å†³å¾ªç¯ä¾èµ–çš„æœºç†</h2><p>Spring ä¸ºä»€ä¹ˆå¯ä»¥è§£å†³ <code>set + singleton</code> æ¨¡å¼ä¸‹å¾ªç¯ä¾èµ–ï¼Ÿ</p>
<p>æ ¹æœ¬çš„åŸå› åœ¨äºï¼šè¿™ç§æ–¹å¼å¯ä»¥åšåˆ°å°†â€œå®ä¾‹åŒ– Bean â€å’Œâ€œç»™ Bean å±æ€§èµ‹å€¼â€è¿™ä¸¤ä¸ªåŠ¨ä½œåˆ†å¼€å»å®Œæˆã€‚</p>
<ul>
<li><p>å®ä¾‹åŒ– Bean çš„æ—¶å€™ï¼šè°ƒç”¨æ— å‚æ•°æ„é€ æ–¹æ³•æ¥å®Œæˆã€‚æ­¤æ—¶å¯ä»¥å…ˆä¸ç»™å±æ€§èµ‹å€¼ï¼Œå¯ä»¥æå‰å°†è¯¥ Bean å¯¹è±¡â€œæ›å…‰â€ç»™å¤–ç•Œã€‚</p>
</li>
<li><p>ç»™ Bean å±æ€§èµ‹å€¼çš„æ—¶å€™ï¼šè°ƒç”¨ <code>setter</code> æ–¹æ³•æ¥å®Œæˆã€‚</p>
</li>
</ul>
<p>ä¸¤ä¸ªæ­¥éª¤æ˜¯å®Œå…¨å¯ä»¥åˆ†ç¦»å¼€å»å®Œæˆçš„ï¼Œå¹¶ä¸”è¿™ä¸¤æ­¥ä¸è¦æ±‚åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šå®Œæˆã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒBean éƒ½æ˜¯å•ä¾‹çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ‰€æœ‰çš„å•ä¾‹ Bean å®ä¾‹åŒ–å‡ºæ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªé›†åˆå½“ä¸­ï¼ˆæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºç¼“å­˜ï¼‰ï¼Œæ‰€æœ‰çš„å•ä¾‹Bean å…¨éƒ¨å®ä¾‹åŒ–å®Œæˆä¹‹åï¼Œä»¥åæˆ‘ä»¬å†æ…¢æ…¢çš„è°ƒç”¨ <code>setter</code> æ–¹æ³•ç»™å±æ€§èµ‹å€¼ã€‚è¿™æ ·å°±è§£å†³äº†å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p>
<p>é‚£ä¹ˆåœ¨Springæ¡†æ¶åº•å±‚æºç çº§åˆ«ä¸Šæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿè¯·çœ‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/DeafaultSingletonBeanRegistry%E6%BA%90%E7%A0%81.png"></p>
<p>åœ¨ä»¥ä¸Šç±»ä¸­åŒ…å«ä¸‰ä¸ªé‡è¦çš„å±æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Cache of singleton objects: bean name to bean instance</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Object&gt; singletonObjects = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>(<span class="number">256</span>);</span><br></pre></td></tr></table></figure>

<p><strong><code>Cache of singleton objects: bean name to bean instance.</code> å•ä¾‹å¯¹è±¡çš„ç¼“å­˜ï¼škeyå­˜å‚¨ bean åç§°ï¼Œvalue å­˜å‚¨ Bean å¯¹è±¡ã€ä¸€çº§ç¼“å­˜ã€‘</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Cache of early singleton objects: bean name to bean instance</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>(<span class="number">16</span>);</span><br></pre></td></tr></table></figure>

<p><strong><code>Cache of early singleton objects: bean name to bean instance.</code> æ—©æœŸå•ä¾‹å¯¹è±¡çš„ç¼“å­˜ï¼škey å­˜å‚¨ bean åç§°ï¼Œvalue å­˜å‚¨æ—©æœŸçš„ Bean å¯¹è±¡ã€äºŒçº§ç¼“å­˜ã€‘</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Cache of singleton factories: bean name to ObjectFactory</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class="keyword">new</span> <span class="title class_">HashMap</span>(<span class="number">16</span>);</span><br></pre></td></tr></table></figure>

<p><strong><code>Cache of singleton factories: bean name to ObjectFactory.</code> å•ä¾‹å·¥å‚ç¼“å­˜ï¼škey å­˜å‚¨ bean åç§°ï¼Œvalue å­˜å‚¨è¯¥ Bean å¯¹åº”çš„ ObjectFactory å¯¹è±¡ã€ä¸‰çº§ç¼“å­˜ã€‘</strong></p>
<p>è¿™ä¸‰ä¸ªç¼“å­˜å…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸‰ä¸ªMapé›†åˆã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ï¼Œåœ¨è¯¥ç±»ä¸­æœ‰è¿™æ ·ä¸€ä¸ªæ–¹æ³• <code>addSingletonFactory()</code> ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯ï¼šå°†åˆ›å»º Bean å¯¹è±¡çš„ ObjectFactory å¯¹è±¡æå‰æ›å…‰ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/addSingletonFactory()%E6%96%B9%E6%B3%95.png" style="zoom:67%;">

<p>å†åˆ†æä¸‹é¢çš„æºç ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/getSingleton%E6%BA%90%E7%A0%81.png" style="zoom:67%;">

<p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œspring ä¼šå…ˆä»ä¸€çº§ç¼“å­˜ä¸­è·å– Beanï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œåˆ™ä»äºŒçº§ç¼“å­˜ä¸­è·å– Beanï¼Œå¦‚æœäºŒçº§ç¼“å­˜è¿˜æ˜¯è·å–ä¸åˆ°ï¼Œåˆ™ä»ä¸‰çº§ç¼“å­˜ä¸­è·å–ä¹‹å‰æ›å…‰çš„ ObjectFactory å¯¹è±¡ï¼Œé€šè¿‡ ObjectFactory å¯¹è±¡è·å– Bean å®ä¾‹ï¼Œè¿™æ ·å°±è§£å†³äº†å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<p>Spring åªèƒ½è§£å†³ <code>setter</code> æ–¹æ³•æ³¨å…¥çš„å•ä¾‹ bean ä¹‹é—´çš„å¾ªç¯ä¾èµ–ã€‚ClassA ä¾èµ– ClassB ï¼ŒClassB åˆä¾èµ–ClassA ï¼Œå½¢æˆä¾èµ–é—­ç¯ã€‚Spring åœ¨åˆ›å»º ClassA å¯¹è±¡åï¼Œä¸éœ€è¦ç­‰ç»™å±æ€§èµ‹å€¼ï¼Œç›´æ¥å°†å…¶æ›å…‰åˆ° bean ç¼“å­˜å½“ä¸­ã€‚åœ¨è§£æ ClassA çš„å±æ€§æ—¶ï¼Œåˆå‘ç°ä¾èµ–äº ClassB ï¼Œå†æ¬¡å»è·å– ClassBï¼Œå½“è§£æ ClassB çš„å±æ€§æ—¶ï¼Œåˆå‘ç°éœ€è¦ ClassA çš„å±æ€§ï¼Œä½†æ­¤æ—¶çš„ ClassA å·²ç»è¢«æå‰æ›å…‰åŠ å…¥äº†æ­£åœ¨åˆ›å»ºçš„ bean çš„ç¼“å­˜ä¸­ï¼Œåˆ™æ— éœ€åˆ›å»ºæ–°çš„çš„ ClassA çš„å®ä¾‹ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–å³å¯ã€‚ä»è€Œè§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ã€‚</p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Gitæ•™ç¨‹</title>
    <url>/posts/Git/</url>
    <content><![CDATA[<p>Gitå®˜ç½‘ï¼š<a href="https://git-scm.com/">https://git-scm.com/</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1MU4y1Y7h5/">é»‘é©¬ç¨‹åºå‘˜Gitå…¨å¥—æ•™ç¨‹ï¼Œå®Œæ•´çš„Gité¡¹ç›®ç®¡ç†å·¥å…·æ•™ç¨‹ï¼Œä¸€å¥—ç²¾é€šGit</a></p>
<h1 id="1-ç‰ˆæœ¬æ§åˆ¶"><a href="#1-ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="1. ç‰ˆæœ¬æ§åˆ¶"></a>1. ç‰ˆæœ¬æ§åˆ¶</h1><blockquote>
<p>ç‰ˆæœ¬ç®¡ç†æ¦‚å¿µ</p>
</blockquote>
<p>ç‰ˆæœ¬æ§åˆ¶æ˜¯æŒ‡å¯¹è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­å„ç§ç¨‹åºä»£ç ã€<a href="https://baike.baidu.com/item/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/286550?fromModule=lemma_inlink">é…ç½®æ–‡ä»¶</a>åŠè¯´æ˜æ–‡æ¡£ç­‰æ–‡ä»¶å˜æ›´çš„ç®¡ç†ï¼Œæ˜¯<a href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/3765602?fromModule=lemma_inlink">è½¯ä»¶é…ç½®ç®¡ç†</a>çš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ã€‚</p>
<blockquote>
<p>ç‰ˆæœ¬ç®¡ç†å·¥å…·æ¦‚å¿µ</p>
</blockquote>
<p>ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä¹Ÿè¢«ç§°ä¸ºç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªç”¨äºè®°å½•æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œä»¥ä¾¿å°†æ¥æŸ¥é˜…ç‰¹å®šç‰ˆæœ¬ä¿®è®¢æƒ…å†µçš„ç³»ç»Ÿã€‚å®ƒä¸»è¦ç”¨äºç®¡ç†è½¯ä»¶å¼€å‘ä¸­çš„æºä»£ç ã€é…ç½®æ–‡ä»¶å’Œæ–‡æ¡£ç­‰æ–‡ä»¶çš„å˜æ›´ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œç‰ˆæœ¬ç®¡ç†å·¥å…·å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ul>
<li><strong>å¤‡ä»½æ–‡ä»¶</strong>ï¼šæ¯ä¸€æ¬¡çš„æ–‡ä»¶å˜æ›´éƒ½ä¼šè¢«ä¿å­˜ä¸‹æ¥ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œè¿™æ ·å³ä½¿å‡ºç°é”™è¯¯æˆ–éœ€è¦å›æº¯ï¼Œä¹Ÿå¯ä»¥è½»æ¾åœ°æ¢å¤åˆ°ä¹‹å‰çš„ç‰ˆæœ¬ã€‚</li>
<li><strong>è®°å½•å†å²</strong>ï¼šå·¥å…·ä¼šè¯¦ç»†è®°å½•æ¯æ¬¡å˜æ›´çš„å†…å®¹ã€æ—¶é—´ä»¥åŠæ‰§è¡Œå˜æ›´çš„äººå‘˜ç­‰ä¿¡æ¯ï¼Œä¸ºå›¢é˜Ÿæä¾›å®Œæ•´çš„ç‰ˆæœ¬å†å²è®°å½•ã€‚</li>
<li><strong>å›åˆ°è¿‡å»</strong>ï¼šé€šè¿‡ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°æ¢å¤åˆ°è¿‡å»çš„ä»»ä½•ä¸€ä¸ªç‰ˆæœ¬ï¼Œè¿™å¯¹äºé”™è¯¯æ’æŸ¥ã€åŠŸèƒ½å›æ»šç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</li>
<li><strong>å¤šç«¯å…±äº«</strong>ï¼šç‰ˆæœ¬ç®¡ç†å·¥å…·æ”¯æŒåœ¨å¤šä¸ªè®¾å¤‡æˆ–å¹³å°ä¸Šè®¿é—®å’Œæ›´æ–°ä»£ç åº“ï¼Œä½¿å¾—å›¢é˜Ÿæˆå‘˜å¯ä»¥åœ¨ä¸åŒçš„å·¥ä½œç¯å¢ƒä¸­æ— ç¼åä½œã€‚</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šå®ƒæ”¯æŒå¤šäººåŒæ—¶å¤„ç†åŒä¸€ä»½æ–‡ä»¶ï¼Œé€šè¿‡åˆå¹¶å’Œå†²çªè§£å†³æœºåˆ¶ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„åä½œæ›´åŠ é«˜æ•ˆå’Œå‡†ç¡®ã€‚</li>
</ul>
<blockquote>
<p>ç‰ˆæœ¬ç®¡ç†å·¥å…·</p>
</blockquote>
<p>ä¸»æµçš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶æœ‰ï¼š</p>
<ul>
<li><p>Git</p>
</li>
<li><p>SVN(Subversion)</p>
</li>
<li><p>CVS(Concurrent Versions System)</p>
</li>
<li><p>VSS(Micorosoft Visual SourceSafe)</p>
</li>
<li><p>TFS(Team Foundation Server)</p>
</li>
<li><p>Visual Studio Online</p>
</li>
</ul>
<p>ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯ Git ä¸ SVNã€‚</p>
<blockquote>
<p>ç‰ˆæœ¬ç®¡ç†å‘å±•ç®€å²(ç»´åŸºç™¾ç§‘)</p>
</blockquote>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E8%BD%AF%E4%BB%B6.png"></p>
<p><strong>1ã€SVN(SubVersion)</strong></p>
<p>SVN æ˜¯é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç‰ˆæœ¬åº“æ˜¯é›†ä¸­æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨çš„ã€‚</p>
<p>å·¥ä½œæµç¨‹å¦‚ä¸‹:</p>
<ol>
<li>ä»ä¸­å¤®æœåŠ¡å™¨è¿œç¨‹ä»“åº“ä¸‹è½½ä»£ç </li>
<li>ä¿®æ”¹åå°†ä»£ç æäº¤åˆ°ä¸­å¤®æœåŠ¡å™¨è¿œç¨‹ä»“åº“</li>
</ol>
<p> ä¼˜ç‚¹ï¼šç®€å•ï¼Œæ˜“æ“ä½œã€‚</p>
<p> ç¼ºç‚¹ï¼šæ‰€æœ‰ä»£ç å¿…é¡»æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨ã€‚</p>
<ul>
<li>æœåŠ¡å™¨ä¸€æ—¦å®•æœºæ— æ³•æäº¤ä»£ç ,å³å®¹é”™æ€§è¾ƒå·®ã€‚</li>
<li>ç¦»çº¿æ— æ³•æäº¤ä»£ç ,æ— æ³•åŠæ—¶è®°å½•æˆ‘ä»¬çš„æäº¤è¡Œä¸ºã€‚</li>
</ul>
<p>SVN æµç¨‹å›¾</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/SVN.jpg"></p>
<p><strong>2ã€Git</strong></p>
<p>Git æ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(Distributed Version Control Systemï¼Œç®€ç§° DVCS)ï¼Œåˆ†ä¸ºä¸¤ç§ç±»å‹çš„ä»“åº“ï¼š<code>æœ¬åœ°ä»“åº“</code> å’Œ <code>è¿œç¨‹ä»“åº“</code></p>
<p>å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš†æˆ–æ‹‰å–ä»£ç åˆ°æœ¬åœ°ä»“åº“ (clone&#x2F;pull) ã€‚</li>
<li>ä»æœ¬åœ°è¿›è¡Œä»£ç ä¿®æ”¹ã€‚</li>
<li>åœ¨æäº¤å‰å…ˆå°†ä»£ç æäº¤åˆ°æš‚å­˜åŒºã€‚</li>
<li>æäº¤åˆ°æœ¬åœ°ä»“åº“ã€‚æœ¬åœ°ä»“åº“ä¸­ä¿å­˜ä¿®æ”¹çš„å„ä¸ªå†å²ç‰ˆæœ¬ã€‚</li>
<li>ä¿®æ”¹å®Œæˆåï¼Œéœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç æ—¶ï¼Œå°†ä»£ç  push åˆ°è¿œç¨‹ä»“åº“ã€‚</li>
</ol>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git.png"></p>
<p><strong>æ€»ç»“ï¼šGit å’Œ SVN çš„åŒºåˆ«</strong></p>
<ol>
<li>SVN æ˜¯é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼ŒGit æ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶å·¥å…·</li>
<li>SVN ä¸æ”¯æŒç¦»çº¿æäº¤ï¼ŒGit æ”¯æŒç¦»çº¿æäº¤ä»£ç </li>
</ol>
<h1 id="2-Git-å‘å±•ç®€å²"><a href="#2-Git-å‘å±•ç®€å²" class="headerlink" title="2. Git å‘å±•ç®€å²"></a>2. Git å‘å±•ç®€å²</h1><p>Git èµ·æºäº2005å¹´ï¼Œç”± Linux å†…æ ¸çš„ç¼”é€ è€… <a href="https://baike.baidu.com/item/%E6%9E%97%E7%BA%B3%E6%96%AF%C2%B7%E6%9C%AC%E7%BA%B3%E7%AC%AC%E5%85%8B%E7%89%B9%C2%B7%E6%89%98%E7%93%A6%E5%85%B9/1034429?fr=ge_ala">Linus Benedict Torvalds</a> åˆ›å»ºã€‚åœ¨ä¹‹å‰ï¼ŒLinux å†…æ ¸çš„ç»´æŠ¤ä¸»è¦ä¾èµ–äºè¡¥ä¸å’Œå­˜æ¡£æ–‡ä»¶ï¼Œä½†éšç€å‚ä¸è€…çš„å¢å¤šï¼Œè¿™ç§æ–¹å¼å˜å¾—ä½æ•ˆã€‚å°½ç®¡å½“æ—¶å­˜åœ¨å…¶ä»–ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œä½†å®ƒä»¬è¦ä¹ˆæ˜¯æ”¶è´¹çš„ï¼Œè¦ä¹ˆæ˜¯é‡‡ç”¨é›†ä¸­å¼ç®¡ç†æ–¹å¼ï¼Œæ— æ³•æ»¡è¶³ Linux å†…æ ¸ç¤¾åŒºçš„éœ€æ±‚ã€‚</p>
<p>2002å¹´ï¼ŒLinux å†…æ ¸é¡¹ç›®å¼€å§‹ä½¿ç”¨ BitKeeper è¿™ä¸€ä¸“æœ‰åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œä½†2005å¹´ï¼Œç”±äºå•†ä¸šåˆä½œå…³ç³»çš„ç ´è£‚ï¼ŒLinux å†…æ ¸ç¤¾åŒºå¤±å»äº†å…è´¹ä½¿ç”¨ BitKeeper çš„æƒåŠ›ã€‚</p>
<p>è¿™ä¸€äº‹ä»¶ä¿ƒä½¿ Linus Benedict Torvaldså’ŒLinux å¼€æºç¤¾åŒºå¼€å§‹å¼€å‘è‡ªå·±çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ä»–ä»¬åŸºäºä½¿ç”¨ BitKeeper æ—¶çš„ç»éªŒï¼Œè®¾å®šäº†æ–°ç³»ç»Ÿçš„ç›®æ ‡ï¼šé«˜é€Ÿã€ç®€å•è®¾è®¡ã€æ”¯æŒéçº¿æ€§å¼€å‘(å…è®¸æˆåƒä¸Šä¸‡ä¸ªå¹¶è¡Œåˆ†æ”¯)ã€å®Œå…¨åˆ†å¸ƒå¼ï¼Œå¹¶èƒ½æœ‰æ•ˆç®¡ç†å¤§å‹é¡¹ç›®ã€‚</p>
<p>ç»è¿‡ä¸¤å‘¨çš„å¼€å‘ï¼ŒLinus Torvalds ç”¨ C è¯­è¨€å†™å‡ºäº† Git è¿™ä¸€åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚Gitè‡ªè¯ç”Ÿä»¥æ¥ï¼Œä¸æ–­å‘å±•å’Œå®Œå–„ï¼Œæˆä¸ºé«˜åº¦æ˜“ç”¨ä¸”åŠŸèƒ½å¼ºå¤§çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œå¹¿æ³›åº”ç”¨äºå„ç±»è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ã€‚</p>
<p>Git çš„æˆåŠŸä¸ä»…åœ¨äºå…¶æŠ€æœ¯ä¸Šçš„ä¼˜è¶Šæ€§ï¼Œæ›´åœ¨äºå®ƒç¬¦åˆå¼€æºæ–‡åŒ–å’Œåä½œç²¾ç¥ï¼Œä¸ºå…¨çƒå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå…±åŒå­¦ä¹ å’Œè¿›æ­¥çš„å¹³å°ï¼Œæ¨åŠ¨äº†æ•´ä¸ªè½¯ä»¶å¼€å‘è¡Œä¸šçš„è¿›æ­¥ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E6%9D%8E%E7%BA%B3%E6%96%AF%E3%83%BB%E6%89%98%E6%B2%83%E5%85%B9.jpg"></p>
<center>Linux å’Œ Git ä¹‹çˆ¶ æ—çº³æ–¯Â·æœ¬çº³ç¬¬å…‹ç‰¹Â·æ‰˜ç“¦å…¹(Linus Benedict Torvalds)</center>

<h1 id="3-Git-å¿«é€Ÿå…¥é—¨"><a href="#3-Git-å¿«é€Ÿå…¥é—¨" class="headerlink" title="3. Git å¿«é€Ÿå…¥é—¨"></a>3. Git å¿«é€Ÿå…¥é—¨</h1><h2 id="3-1-Gitæ¦‚è¿°"><a href="#3-1-Gitæ¦‚è¿°" class="headerlink" title="3.1 Gitæ¦‚è¿°"></a>3.1 Gitæ¦‚è¿°</h2><p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E6%A6%82%E8%BF%B0.png"></p>
<p>Git æ˜¯ä¸€ä¸ªå…è´¹çš„ï¼Œå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥å¿«é€Ÿé«˜æ•ˆåœ°å¤„ç†ä»å°å‹æˆ–å¤§å‹çš„å„ç§é¡¹ç›®ã€‚Git æ˜“äºå­¦ä¹ ï¼Œå ç”¨ç©ºé—´å°ï¼Œæ€§èƒ½å¿«å¾—æƒŠäººã€‚</p>
<h2 id="3-2-Gitä¸‹è½½ä¸å®‰è£…"><a href="#3-2-Gitä¸‹è½½ä¸å®‰è£…" class="headerlink" title="3.2 Gitä¸‹è½½ä¸å®‰è£…"></a>3.2 Gitä¸‹è½½ä¸å®‰è£…</h2><blockquote>
<p>Git ä¸‹è½½</p>
</blockquote>
<p>ä¸€ã€<a href="https://git-scm.com/downloads">Git ä¸‹è½½å®˜ç½‘</a></p>
<p>è¿›å…¥å®˜ç½‘åæ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿçš„æƒ…å†µä¸‹è½½å¹¶è¿›è¡Œå®‰è£…ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD.png"></p>
<p>äºŒã€ å¦‚æœå®˜ç½‘ä¸‹è½½å¤ªæ…¢ï¼Œå¯ä»¥ä½¿ç”¨æ·˜å®é•œåƒä¸‹è½½ï¼š<a href="https://registry.npmmirror.com/binary.html?path=git-for-windows/">Git é•œåƒä¸‹è½½</a></p>
<p>è¿›å…¥é•œåƒåï¼Œæ‹–è‡³æœ€ä¸‹æ–¹ï¼Œè¿›å…¥ç¨³å®šç‰ˆçš„ä¸‹è½½ï¼Œç„¶åæ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿçš„æƒ…å†µä¸‹è½½å¹¶è¿›è¡Œå®‰è£…ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BD.png"></p>
<center>ä¸Šæ–¹ä¸å¸¦ rc çš„æ‰æ˜¯ç¨³å®šç‰ˆ</center>

<p>æœ€æ—© Git æ˜¯åœ¨ Linux ä¸Šå¼€å‘çš„ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ï¼ŒGit ä¹Ÿåªèƒ½åœ¨ Linux å’Œ Unix ç³»ç»Ÿä¸Šè·‘ã€‚ä¸è¿‡ï¼Œæ…¢æ…¢åœ°æœ‰äººæŠŠå®ƒç§»æ¤åˆ°äº† Windows ä¸Šã€‚ç°åœ¨ï¼ŒGit å¯ä»¥åœ¨ Linuxã€Unixã€Mac å’Œ Windows è¿™å‡ å¤§å¹³å°ä¸Šæ­£å¸¸è¿è¡Œäº†ã€‚ç”±äºå¼€å‘æœºå¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯ Windowsï¼Œæ‰€ä»¥æœ¬æ•™ç¨‹é€‰æ‹©ç›¸å¯¹ç®€å•çš„ Windows ç³»ç»Ÿè½¯ä»¶ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ï¼Œæ­¤å¤„æˆ‘ä»¬ä¸‹è½½ Windows ç³»ç»Ÿçš„ 2.44.0 ç‰ˆæœ¬è½¯ä»¶ã€‚</p>
<blockquote>
<p>Git å®‰è£…</p>
</blockquote>
<p>å®‰è£…æ—¶ä½¿ç”¨ <font color="red">â€œå‚»ç“œå¼â€</font> å®‰è£…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥å³å¯ã€‚<font color="red">PSï¼šæ³¨æ„æŒ‰è‡ªå·±éœ€æ±‚ä¿®æ”¹å®‰è£…è·¯å¾„ï¼</font>ğŸ˜</p>
<p>å®‰è£…æ—¶è¿˜å¯ä»¥ä¿®æ”¹é»˜è®¤ç¼–è¾‘å™¨ï¼Œé»˜è®¤æ˜¯ Vim ç¼–è¾‘å™¨ã€‚æ¯”å¦‚å°†é»˜è®¤ç¼–è¾‘å™¨ä¿®æ”¹ä¸º NotePad3ï¼Œæ‰¾åˆ° NotePad3 çš„ exe æ–‡ä»¶å¹¶é€‰æ‹©å³å¯ã€‚</p>
<p>å¦‚æœåœ¨å®‰è£…å®Œæˆåæƒ³è¦ä¿®æ”¹é»˜è®¤ç¼–è¾‘å™¨ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†é»˜è®¤ç¼–è¾‘å™¨ä¿®æ”¹ä¸º vim</span></span><br><span class="line">git config --global core.editor vim</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹ä¸º NotePad3(å®‰è£…è·¯å¾„è‡ªè¡Œä¿®æ”¹)</span></span><br><span class="line">git config --global core.editor &quot;D:\\Notepad3\\Notepad3.exe&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Git å¯åŠ¨æµ‹è¯•</p>
</blockquote>
<p>å®‰è£…æˆåŠŸååœ¨å¼€å§‹èœå•ä¸­ä¼šæœ‰å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E5%BC%80%E5%A7%8B%E8%8F%9C%E5%8D%95Git.png"></p>
<ul>
<li><p>Git Bashï¼š Unix ä¸ Linux é£æ ¼çš„å‘½ä»¤è¡Œ(ä½¿ç”¨æœ€å¤šï¼Œæ¨èä½¿ç”¨)</p>
</li>
<li><p>Git CMDï¼š Windows é£æ ¼çš„å‘½ä»¤è¡Œ</p>
</li>
<li><p>Git GUIï¼š å›¾å½¢ç•Œé¢çš„ Gitï¼Œä¸å»ºè®®åˆå­¦è€…ä½¿ç”¨ï¼Œå°½é‡å…ˆç†Ÿæ‚‰å¸¸ç”¨å‘½ä»¤</p>
</li>
</ul>
<p>å¯ä»¥åœ¨æŸä¸€ç›®å½•ä¸­ç‚¹å‡»å³é”®ï¼Œç‚¹å‡» â€œGit Bash Hereâ€ å°±å¯ä»¥å†å½“å‰ç›®å½•ä¸‹æ‰“å¼€ Git Bashã€‚</p>
<p>åœ¨Windowsæ¡Œé¢ç©ºç™½å¤„ï¼Œç‚¹å‡»é¼ æ ‡å³é”®ï¼Œå¼¹å‡ºå³é”®èœå•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95Git.png"></p>
<p>Gitè½¯ä»¶å®‰è£…åï¼Œä¼šåœ¨å³é”®èœå•ä¸­å¢åŠ ä¸¤ä¸ªèœå•</p>
<ul>
<li>Open Git GUI Here</li>
<li>Open Git Bash Here</li>
</ul>
<p>æ­¤å¤„ä»…ä»…æ˜¯ä¸ºäº†éªŒè¯ Git è½¯ä»¶å®‰è£…çš„æ•ˆæœï¼Œæ‰€ä»¥é€‰æ‹© <code>Git Bash Here</code> èœå•, é€‰æ‹©åï¼ŒWindows ç³»ç»Ÿå¼¹å‡º Git è½¯ä»¶çš„å‘½ä»¤è¡Œé»‘çª—å£ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%BB%91%E7%AA%97%E5%8F%A3.png"></p>
<p>çª—å£å¼¹å‡ºåï¼Œå¯ä»¥è¾“å…¥ Git è½¯ä»¶çš„æ“ä½œæŒ‡ä»¤ã€‚æ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨é”®ç›˜è¾“å…¥æ“ä½œæŒ‡ä»¤ï¼š<code>git -v</code> æˆ– <code>git --version</code>ï¼ŒæŸ¥çœ‹å½“å‰ Git è½¯ä»¶çš„å®‰è£…ç‰ˆæœ¬ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git -v</span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E7%9A%84%E5%AE%89%E8%A3%85%E7%89%88%E6%9C%AC.png"></p>
<p>è¾“å…¥æŒ‡ä»¤å›è½¦åï¼Œå¦‚æœé»‘çª—å£ä¸­æ‰“å°å‡ºå’±ä»¬å®‰è£…çš„è½¯ä»¶ç‰ˆæœ¬ 2.44.0ï¼ŒGit è½¯ä»¶å®‰è£…æˆåŠŸäº†ã€‚</p>
<h2 id="3-3-GitåŸºç¡€æŒ‡ä»¤"><a href="#3-3-GitåŸºç¡€æŒ‡ä»¤" class="headerlink" title="3.3 GitåŸºç¡€æŒ‡ä»¤"></a>3.3 GitåŸºç¡€æŒ‡ä»¤</h2><p>Git è½¯ä»¶æ˜¯å…è´¹ã€å¼€æºçš„ã€‚æœ€åˆ Git è½¯ä»¶æ˜¯ä¸ºè¾…åŠ© Linux å†…æ ¸å¼€å‘çš„ä¸€å¥—è½¯ä»¶ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶ï¼Œç®€å•å¸¸ç”¨çš„ Linux ç³»ç»Ÿæ“ä½œæŒ‡ä»¤æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>æŒ‡ä»¤</strong></th>
<th align="center"><strong>å«ä¹‰</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">cd ç›®å½•</td>
<td align="center">change directory</td>
<td align="center">æ”¹å˜æ“ä½œç›®å½•</td>
</tr>
<tr>
<td align="center">cd ..</td>
<td align="center"></td>
<td align="center">é€€å›åˆ°ä¸Šä¸€çº§ç›®å½•</td>
</tr>
<tr>
<td align="center">pwd</td>
<td align="center">Print work  directory</td>
<td align="center">æ‰“å°å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td align="center">ls</td>
<td align="center">list directory  contents</td>
<td align="center">æ˜¾ç¤ºå½“å‰ç›®å½•çš„æ–‡ä»¶åŠå­æ–‡ä»¶ç›®å½•</td>
</tr>
<tr>
<td align="center">ll</td>
<td align="center">ls -l ç®€åŒ–ç‰ˆæœ¬</td>
<td align="center">æ›´è¯¦ç»†åœ°æ˜¾ç¤ºå½“å‰ç›®å½•çš„æ–‡ä»¶åŠå­æ–‡ä»¶ç›®å½•</td>
</tr>
<tr>
<td align="center">mkdir æ–‡ä»¶å¤¹åç§°</td>
<td align="center">make directory</td>
<td align="center">æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td align="center">rm æ–‡ä»¶</td>
<td align="center">remove</td>
<td align="center">åˆ é™¤æ–‡ä»¶</td>
</tr>
<tr>
<td align="center">rm -r æ–‡ä»¶å¤¹</td>
<td align="center">Remove</td>
<td align="center">åˆ é™¤æ–‡ä»¶ç›®å½•</td>
</tr>
<tr>
<td align="center">touch æ–‡ä»¶</td>
<td align="center"></td>
<td align="center">å¦‚æœåˆ›å»ºçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶</td>
</tr>
<tr>
<td align="center">reset</td>
<td align="center"></td>
<td align="center">æ¸…å±</td>
</tr>
<tr>
<td align="center">clear</td>
<td align="center"></td>
<td align="center">æ¸…å±</td>
</tr>
<tr>
<td align="center">exit</td>
<td align="center"></td>
<td align="center">é€€å‡ºç»ˆç«¯çª—å£</td>
</tr>
</tbody></table>
<h2 id="3-4-Gité…ç½®"><a href="#3-4-Gité…ç½®" class="headerlink" title="3.4 Gité…ç½®"></a>3.4 Gité…ç½®</h2><blockquote>
<p>é…ç½®ä¿¡æ¯</p>
</blockquote>
<p>Git å®‰è£…ç›®å½•ä¸‹çš„ <code>gitconfig --system</code> ç³»ç»Ÿçº§é…ç½®æ–‡ä»¶ï¼š<code>Git å®‰è£…ç›®å½• \etc\gitconfig</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E7%B3%BB%E7%BB%9F%E7%BA%A7%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" style="zoom:67%;">

<p>åªé€‚ç”¨äºå½“å‰ç™»å½•ç”¨æˆ·çš„é…ç½® <code>--global</code> å…¨å±€é…ç½®æ–‡ä»¶ï¼š<code>C:\Users\ ä½ çš„ç”¨æˆ·å \ .gitconfig</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E7%9A%84%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" style="zoom:67%;">

<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸åŒçº§åˆ«çš„é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç³»ç»Ÿ config</span></span><br><span class="line">git config --system --list</span><br><span class="line"><span class="meta prompt_">ã€€ã€€</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰ç”¨æˆ·(global)é…ç½®</span></span><br><span class="line">git config --global  --list</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>è®¾ç½®åç§°å’Œé‚®ç®±</strong>   <font color="red"><strong>è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font></p>
</blockquote>
<p>å®‰è£…å®Œ Git åé¦–å…ˆè¦åšçš„äº‹æƒ…æ˜¯è®¾ç½®ç”¨æˆ·åå’Œ email åœ°å€ã€‚è¿™ éå¸¸é‡è¦ï¼Œå› ä¸ºæ¯æ¬¡ Git æäº¤éƒ½ä¼šä½¿ç”¨è¯¥ä¿¡æ¯ï¼Œå®ƒè¢«æ°¸è¿œçš„åµŒå…¥åˆ°äº†æäº¤ä¸­ã€‚<font color="red"><strong>æ‰€ä»¥ï¼ï¼ï¼æ˜¯ä¸€å®šè¦é…ç½®çš„ï¼ï¼ï¼</strong></font></p>
<p>å¦åˆ™å°±ä¼šå‡ºç°å¦‚ä¸‹æç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E6%9C%AA%E8%AE%BE%E7%BD%AE%E5%90%8D%E7%A7%B0%E5%92%8C%E9%82%AE%E7%AE%B1.png"></p>
<p>æ­¤æ—¶éœ€è¦æŒ‰ç…§ä¸‹é¢ä¸¤ä¸ªå‘½ä»¤æ¥è®¾ç½®ç”¨æˆ·åğŸƒå’Œé‚®ç®±ğŸ“§( muyoukule æ˜¯æˆ‘çš„ç”¨æˆ·åï¼Œ<a href="mailto:&#x79;&#111;&#117;&#x72;&#95;&#x65;&#109;&#97;&#105;&#x6c;&#x40;&#101;&#x78;&#x61;&#x6d;&#112;&#108;&#101;&#x2e;&#x63;&#111;&#x6d;">&#x79;&#111;&#117;&#x72;&#95;&#x65;&#109;&#97;&#105;&#x6c;&#x40;&#101;&#x78;&#x61;&#x6d;&#112;&#108;&#101;&#x2e;&#x63;&#111;&#x6d;</a> æ˜¯é‚®ç®±ï¼Œä½ éœ€è¦è®¾ç½®å±äºä½ è‡ªå·±çš„ç”¨æˆ·åå’Œé‚®ç®±)ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global user.name muyoukule</span><br><span class="line">git config --global user.email your_email@example.com</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½¿ç”¨äº† <code>--global</code> é€‰é¡¹ï¼Œè¡¨ç¤ºè®¾ç½®äº†å…¨å±€çš„ç”¨æˆ·åå’Œé‚®ç®±ã€‚å¦‚æœå¸Œæœ›åœ¨ä¸€ä¸ªç‰¹å®šçš„é¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå¯ä»¥åœ¨è¯¥é¡¹ç›®ä¸­è¿è¡Œè¯¥å‘½ä»¤è€Œä¸æ·»åŠ  â€“global é€‰é¡¹ã€‚æ€»ä¹‹ <code>--global</code> ä¸ºå…¨å±€é…ç½®ï¼Œä¸åŠ ä¸ºæŸä¸ªé¡¹ç›®çš„ç‰¹å®šé…ç½®ã€‚</p>
<p>è®¾ç½®å¥½ç”¨æˆ·åå’Œé‚®ç®±åï¼Œæ­¤æ—¶åœ¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·ç›®å½• <code>C:\Users\ä½ çš„ç”¨æˆ·å</code> ä¸‹ä¼šäº§ç”Ÿæ–°çš„é…ç½®æ–‡ä»¶ <code>.gitconfig</code>ï¼Œå¯ä»¥è¿è¡Œ <code>git config --global --list</code>ï¼Œå°±ä¼šæ˜¾ç¤ºè®¾ç½®çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>C:\Users\ä½ çš„ç”¨æˆ·å\.gitconfig</code> æ–‡ä»¶ä¸­çœ‹åˆ°è®¾ç½®çš„ä¿¡æ¯ã€‚</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global user.name</span><br><span class="line">git config --global user.email</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸ºå¸¸ç”¨æŒ‡ä»¤é…ç½®åˆ«å(å¯é€‰)</p>
</blockquote>
<p>æœ‰äº›å¸¸ç”¨çš„æŒ‡ä»¤å‚æ•°éå¸¸å¤šï¼Œæ¯æ¬¡éƒ½è¦è¾“å…¥å¥½å¤šå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ«åã€‚</p>
<p>1ã€æ‰“å¼€ç”¨æˆ·ç›®å½•ï¼Œåˆ›å»º .bashrc æ–‡ä»¶</p>
<p>éƒ¨åˆ†windowsç³»ç»Ÿä¸å…è®¸ç”¨æˆ·åˆ›å»ºç‚¹å·å¼€å¤´çš„æ–‡ä»¶ï¼Œå¯ä»¥æ‰“å¼€ GitBashï¼Œæ‰§è¡Œ touch ~&#x2F;.bashrc</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»º .bashrc æ–‡ä»¶</span></span><br><span class="line">touch ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œæˆåä¼šåœ¨ <code>C:\Users\ä½ çš„ç”¨æˆ·å</code> è·¯å¾„ä¸‹å¤šå‡º .bashrc æ–‡ä»¶</p>
<p>2ã€åœ¨ <code>.bashrc</code> æ–‡ä»¶ä¸­è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç”¨äºè¾“å‡ºgitæäº¤æ—¥å¿—</span></span><br><span class="line">alias git-log=&#x27;git log --pretty=oneline --all --graph --abbrev-commit&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç”¨äºè¾“å‡ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åŠåŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">alias ll=&#x27;ls -al&#x27;</span><br></pre></td></tr></table></figure>

<p>3ã€æ‰“å¼€ GitBashï¼Œæ‰§è¡Œ source ~&#x2F;.bashrc</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯å˜é‡é…ç½®</span></span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<h1 id="4-Git-åŸºæœ¬ç†è®º"><a href="#4-Git-åŸºæœ¬ç†è®º" class="headerlink" title="4. Git åŸºæœ¬ç†è®º"></a>4. Git åŸºæœ¬ç†è®º</h1><blockquote>
<p>ä¸‰å¤§åŒºåŸŸ</p>
</blockquote>
<p>Git æœ¬åœ°æœ‰ä¸‰ä¸ªå·¥ä½œåŒºåŸŸï¼šå·¥ä½œç›®å½•(Working Directory)ã€æš‚å­˜åŒº(Stage æˆ– Index)ã€èµ„æºåº“(å†å²è®°å½•åŒºã€ç‰ˆæœ¬åº“ã€æœ¬åœ°ä»“åº“ã€Historyã€Repository æˆ– Git Directory)ã€‚å¦‚æœåœ¨åŠ ä¸Šè¿œç¨‹çš„ Git ä»“åº“(Remote Directory)ä¹Ÿå¯ä»¥åˆ†ä¸ºå››ä¸ªå·¥ä½œåŒºåŸŸã€‚</p>
<p>æ–‡ä»¶åœ¨è¿™å››ä¸ªåŒºåŸŸä¹‹é—´çš„è½¬æ¢å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E4%B8%89%E5%A4%A7%E5%8C%BA%E5%9F%9F.png"></p>
<ul>
<li>Working Directoryï¼šå·¥ä½œåŒºï¼Œå¹³æ—¶å­˜æ”¾é¡¹ç›®ä»£ç çš„åœ°æ–¹ã€‚</li>
<li>Stage(Index)ï¼šæš‚å­˜åŒºï¼Œç”¨äºä¸´æ—¶å­˜æ”¾æ”¹åŠ¨ï¼Œäº‹å®ä¸Šå®ƒåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¿å­˜å³å°†æäº¤åˆ°æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ã€‚</li>
<li>Historyï¼šå†å²è®°å½•åŒºï¼Œå®‰å…¨å­˜æ”¾æ•°æ®çš„ä½ç½®ï¼Œé‡Œé¢æœ‰é¡¹ç›®æ‰€æœ‰ç‰ˆæœ¬çš„æ•°æ®ã€‚</li>
<li>Remote Directoryï¼šè¿œç¨‹ä»“åº“ï¼Œæ‰˜ç®¡ä»£ç çš„æœåŠ¡å™¨ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºæ˜¯é¡¹ç›®ç»„ä¸­ç”¨äºè¿œç¨‹æ•°æ®äº¤æ¢çš„ä¸€å°ç”µè„‘ã€‚</li>
</ul>
<blockquote>
<p>ä¸‰å¤§åŒºåŸŸçš„å¦ä¸€ç§å›¾ç¤º</p>
</blockquote>
<p>æœ¬åœ°çš„ä¸‰ä¸ªåŒºåŸŸç¡®åˆ‡çš„è¯´åº”è¯¥æ˜¯ Git ä»“åº“ä¸­ HEAD æŒ‡å‘çš„ç‰ˆæœ¬ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E5%9B%BE%E8%A7%A3%E4%B8%89%E5%A4%A7%E5%8C%BA%E5%9F%9F.png" style="zoom:67%;">

<ul>
<li><p>Directoryï¼šä½¿ç”¨ Git ç®¡ç†çš„ä¸€ä¸ªç›®å½•ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä»“åº“ï¼ŒåŒ…å«æˆ‘ä»¬çš„å·¥ä½œç©ºé—´å’Œ Git çš„ç®¡ç†ç©ºé—´ã€‚</p>
</li>
<li><p>WorkSpaceï¼šéœ€è¦é€šè¿‡ Git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„ç›®å½•å’Œæ–‡ä»¶ï¼Œè¿™äº›ç›®å½•å’Œæ–‡ä»¶ç»„æˆäº†å·¥ä½œç©ºé—´ã€‚</p>
</li>
<li><p>.gitï¼šå­˜æ”¾ Git ç®¡ç†ä¿¡æ¯çš„ç›®å½•ï¼Œåˆå§‹åŒ–ä»“åº“çš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºã€‚(<strong>ä¸€ä¸ªéšè—æ–‡ä»¶å¤¹</strong>)</p>
</li>
<li><p>Index&#x2F;Stageï¼šæš‚å­˜åŒºï¼Œæˆ–è€…å«å¾…æäº¤æ›´æ–°åŒºï¼Œåœ¨æäº¤è¿›å…¥ repo ä¹‹å‰ï¼Œå¯ä»¥æŠŠæ‰€æœ‰çš„æ›´æ–°æ”¾åœ¨æš‚å­˜åŒºã€‚</p>
</li>
<li><p>Local Repoï¼šæœ¬åœ°ä»“åº“ï¼Œä¸€ä¸ªå­˜æ”¾åœ¨æœ¬åœ°çš„ç‰ˆæœ¬åº“ï¼›HEAD ä¼šåªæ˜¯å½“å‰çš„å¼€å‘åˆ†æ”¯(branch)ã€‚</p>
</li>
<li><p>Stashï¼šéšè—ï¼Œæ˜¯ä¸€ä¸ªå·¥ä½œçŠ¶æ€ä¿å­˜æ ˆï¼Œç”¨äºä¿å­˜ &#x2F; æ¢å¤ WorkSpace ä¸­çš„ä¸´æ—¶çŠ¶æ€ã€‚</p>
</li>
</ul>
<blockquote>
<p>å·¥ä½œæµç¨‹</p>
</blockquote>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E6%B5%81%E7%A8%8B.png" style="zoom:67%;">

<p><strong>æœ¬åœ°ä»“åº“</strong>ï¼šæ˜¯åœ¨å¼€å‘äººå‘˜è‡ªå·±ç”µè„‘ä¸Šçš„ Git ä»“åº“,å­˜æ”¾æˆ‘ä»¬çš„ä»£ç (<strong>.git éšè—æ–‡ä»¶å¤¹å°±æ˜¯æˆ‘ä»¬çš„æœ¬åœ°ä»“åº“</strong>)ã€‚</p>
<p><strong>è¿œç¨‹ä»“åº“</strong>ï¼šæ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ Git ä»“åº“,å­˜æ”¾ä»£ç (å¯ä»¥æ˜¯ github.com æˆ–è€… gitee.com ä¸Šçš„ä»“åº“,æˆ–è€…è‡ªå·±è¯¥å…¬å¸çš„æœåŠ¡å™¨)ã€‚</p>
<p><strong>å·¥ä½œåŒº</strong>ï¼šæˆ‘ä»¬è‡ªå·±å†™ä»£ç (æ–‡æ¡£)çš„åœ°æ–¹ã€‚</p>
<p><strong>æš‚å­˜åŒº</strong>ï¼šåœ¨æœ¬åœ°ä»“åº“ä¸­çš„ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ (index) å«åšæš‚å­˜åŒº,ä¸´æ—¶å­˜å‚¨æˆ‘ä»¬å³å°†è¦æäº¤çš„æ–‡ä»¶ã€‚</p>
<p><strong>Clone</strong>ï¼šå…‹éš†ï¼Œå°±æ˜¯å°†è¿œç¨‹ä»“åº“å¤åˆ¶åˆ°æœ¬åœ°ä»“åº“ã€‚</p>
<p><strong>Push</strong>ï¼šæ¨é€ï¼Œå°±æ˜¯å°†æœ¬åœ°ä»“åº“ä»£ç ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ã€‚</p>
<p><strong>Pull</strong>ï¼šæ‹‰å–ï¼Œå°±æ˜¯å°†è¿œç¨‹ä»“åº“ä»£ç ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ï¼Œå¹¶å°†ä»£ç å…‹éš†åˆ°æœ¬åœ°å·¥ä½œåŒºã€‚</p>
<h1 id="5-Git-æœ¬åœ°ä»“åº“"><a href="#5-Git-æœ¬åœ°ä»“åº“" class="headerlink" title="5. Git æœ¬åœ°ä»“åº“"></a>5. Git æœ¬åœ°ä»“åº“</h1><p>è¦ä½¿ç”¨ Git å¯¹æˆ‘ä»¬çš„ä»£ç è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œé¦–å…ˆéœ€è¦è·å¾—æœ¬åœ°ä»“åº“ã€‚</p>
<blockquote>
<p>è·å¾—æœ¬åœ°ä»“åº“</p>
</blockquote>
<p>åˆ›å»ºæœ¬åœ°ä»“åº“çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯åˆ›å»ºå…¨æ–°çš„ä»“åº“ï¼Œå¦ä¸€ç§æ˜¯å…‹éš†è¿œç¨‹ä»“åº“ã€‚</p>
<p><strong>åˆ›å»ºå…¨æ–°çš„ä»“åº“</strong></p>
<ol>
<li><p>åœ¨ç”µè„‘ä»»æ„ä½ç½®åˆ›å»ºä¸€ä¸ªç©ºç›®å½•(ä¾‹å¦‚åœ¨æ¡Œé¢æ–°å»º repository æ–‡ä»¶å¤¹)ä½œä¸ºæœ¬åœ° Git ä»“åº“ã€‚</p>
</li>
<li><p>è¿›å…¥è¿™ä¸ªç›®å½•ï¼Œç‚¹å‡»å³é”®ç‚¹å‡» <code>Git Bash here</code> æ‰“å¼€çª—å£</p>
</li>
<li><p>åœ¨ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºå…¨æ–°çš„ä»“åº“ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ª Git ä»£ç åº“</span></span><br><span class="line">git init</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰§è¡Œååœ¨å½“å‰ç›®å½•ä¸‹æ–°å¢äº†ä¸€ä¸ª <code>.git</code> éšè—ç›®å½•ï¼Œå½“å‰é¡¹ç›®çš„ç‰ˆæœ¬ä¿¡æ¯å’Œé…ç½®ä¿¡æ¯éƒ½ä¼šå­˜æ”¾åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚</p>
</li>
</ol>
<p><strong>å…‹éš†è¿œç¨‹ä»“åº“</strong></p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æŸä¸ªé¡¹ç›®å…‹éš†(ä¸‹è½½)åˆ°æœ¬åœ°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…‹éš†ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²(ç‰ˆæœ¬ä¿¡æ¯)</span></span><br><span class="line">git clone [url]</span><br></pre></td></tr></table></figure>

<p>åœ¨ GitHub ä¸Šé€‰å®šä¸€ä¸ªé¡¹ç›®è¿›è¡Œæµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/GitHub%E9%80%89%E5%AE%9A%E9%A1%B9%E7%9B%AE.png" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E6%8B%89%E5%8F%96%E9%A1%B9%E7%9B%AE%E5%88%B0%E6%9C%AC%E5%9C%B0.png" style="zoom:67%;">

<h1 id="6-Git-æ–‡ä»¶æ“ä½œ"><a href="#6-Git-æ–‡ä»¶æ“ä½œ" class="headerlink" title="6. Git æ–‡ä»¶æ“ä½œ"></a>6. Git æ–‡ä»¶æ“ä½œ</h1><p>Git å·¥ä½œç›®å½•ä¸‹å¯¹äºæ–‡ä»¶çš„ä¿®æ”¹(å¢åŠ ã€åˆ é™¤ã€æ›´æ–°)ä¼šå­˜åœ¨å‡ ä¸ªçŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çš„çŠ¶æ€ä¼šéšç€æˆ‘ä»¬æ‰§è¡Œ Git çš„å‘½ä»¤è€Œå‘ç”Ÿå˜åŒ–ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/Git%E6%96%87%E4%BB%B6%E7%8A%B6%E6%80%81.png"></p>
<blockquote>
<p>æŸ¥çœ‹ä¿®æ”¹çš„çŠ¶æ€(status)</p>
</blockquote>
<p>ä½œç”¨ï¼šæŸ¥çœ‹çš„ä¿®æ”¹çš„çŠ¶æ€(æš‚å­˜åŒºã€å·¥ä½œåŒº) </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çŠ¶æ€</span></span><br><span class="line">git status [filename]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶çŠ¶æ€</span></span><br><span class="line">git status</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ·»åŠ å·¥ä½œåŒºåˆ°æš‚å­˜åŒº(add)</p>
</blockquote>
<p>ä½œç”¨ï¼šæ·»åŠ å·¥ä½œåŒºä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„ä¿®æ”¹åˆ°æš‚å­˜åŒº</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add .     </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æäº¤æš‚å­˜åŒºåˆ°æœ¬åœ°ä»“åº“(commit)</p>
</blockquote>
<p>ä½œç”¨ï¼šæäº¤æš‚å­˜åŒºå†…å®¹åˆ°æœ¬åœ°ä»“åº“çš„å½“å‰åˆ†æ”¯</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æäº¤æš‚å­˜åŒºä¸­çš„å†…å®¹åˆ°æœ¬åœ°ä»“åº“ -m æäº¤ä¿¡æ¯</span></span><br><span class="line">git commit -m &quot;æ¶ˆæ¯å†…å®¹&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†è·Ÿè¸ªçš„æ–‡ä»¶ç›´æ¥æ·»åŠ åˆ°æœ¬åœ°ä»“åº“(å¦‚æœæœ‰æ–°å¢æ–‡ä»¶ï¼Œè¿˜æ˜¯å¾—å…ˆæ‰§è¡Œ git add .)</span></span><br><span class="line">git commit -am &quot;æ¶ˆæ¯å†…å®¹&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹æäº¤æ—¥å¿—(log)</p>
</blockquote>
<p>ä½œç”¨ï¼šæŸ¥çœ‹æäº¤è®°å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git log [option]</span><br></pre></td></tr></table></figure>

<p>options</p>
<ul>
<li><p>ç©ºï¼šæŸ¥çœ‹å½“å‰åˆ†æ”¯ç‰ˆæœ¬ä¿¡æ¯</p>
</li>
<li><p>â€“allï¼šæ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯</p>
</li>
<li><p>â€“pretty&#x3D;onelineï¼šå°†æäº¤ä¿¡æ¯æ˜¾ç¤ºä¸ºä¸€è¡Œ</p>
</li>
<li><p>â€“abbrev-commitï¼šä½¿å¾—è¾“å‡ºçš„commitedæ›´ç®€çŸ­</p>
</li>
<li><p>â€“graphï¼šä»¥å›¾çš„å½¢å¼æ˜¾ç¤º</p>
</li>
</ul>
<blockquote>
<p>ç‰ˆæœ¬å›é€€</p>
</blockquote>
<p>ä½œç”¨ï¼šç‰ˆæœ¬åˆ‡æ¢</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git reset --hard commitID	# commitID å¯ä»¥ä½¿ git log æŒ‡ä»¤æŸ¥çœ‹</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹å·²ç»åˆ é™¤çš„è®°å½•</p>
</blockquote>
<p><code>git reflog</code> å¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•(åŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„ commit è®°å½•å’Œ reset çš„æ“ä½œ)ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure>

<p>æäº¤è®°å½•è¿‡å¤šæ—¶ï¼ŒæŒ‰ä¸‹ q å¯ç»“æŸæµè§ˆã€‚</p>
<blockquote>
<p>æ·»åŠ æ–‡ä»¶è‡³å¿½ç•¥åˆ—è¡¨</p>
</blockquote>
<p>æœ‰æ—¶ä¸æƒ³æŠŠæŸäº›æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œæ¯”å¦‚æ•°æ®åº“æ–‡ä»¶ï¼Œä¸´æ—¶æ–‡ä»¶ï¼Œè®¾è®¡æ–‡ä»¶ç­‰ï¼Œè¦æ±‚å¿½ç•¥è¿™äº›æ–‡ä»¶çš„ä¿®æ”¹ã€‚</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹ <code>.gitignore</code> æ–‡ä»¶ï¼Œå°†éœ€è¦è¢«å¿½ç•¥çš„æ–‡ä»¶åæ·»åŠ åˆ°æ­¤æ–‡ä»¶ä¸­ã€‚</p>
<p><code>.gitignore</code> æ–‡ä»¶å†…å®¹è§£æï¼š</p>
<ul>
<li><p>ä»¥äº•å· <code>#</code> å¼€å§‹çš„è¡Œè¡¨ç¤ºæ³¨é‡Šï¼›</p>
</li>
<li><p>å¯ä»¥ä½¿ç”¨ Linux é€šé…ç¬¦ã€‚ä¾‹å¦‚ï¼šæ˜Ÿå· <code>*</code> ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œé—®å· <code>?</code> ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œæ–¹æ‹¬å· <code>[]</code> ä»£è¡¨å¯é€‰å­—ç¬¦èŒƒå›´ï¼Œå¤§æ‹¬å· <code>&#123;&#125;</code> ä»£è¡¨å¯é€‰çš„å­—ç¬¦ä¸²ç­‰ï¼›</p>
</li>
<li><p>å¦‚æœåç§°çš„æœ€å‰é¢æœ‰ä¸€ä¸ªæ„Ÿå¹å· <code>!</code>ï¼Œè¡¨ç¤ºä¾‹å¤–è§„åˆ™ï¼Œæ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶ä¸ä¼šè¢«å¿½ç•¥ï¼›</p>
</li>
<li><p>å¦‚æœåç§°çš„æœ€å‰é¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ <code>/</code>ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ–‡ä»¶åœ¨æ ¹ç›®å½•ä¸‹ï¼›</p>
</li>
<li><p>å¦‚æœåç§°çš„æœ€åé¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ <code>/</code>ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ˜¯æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">*.txt        # å¿½ç•¥æ‰€æœ‰ .txt ç»“å°¾çš„æ–‡ä»¶</span><br><span class="line">!lib.txt     # lib.txt é™¤å¤–</span><br><span class="line">/temp        # å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ temp æ–‡ä»¶</span><br><span class="line">build/       # å¿½ç•¥ build ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">doc/*.txt    # å¿½ç•¥ doc ç›®å½•ä¸‹çš„æ‰€æœ‰ txt æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬å­ç›®å½•ä¸‹</span><br></pre></td></tr></table></figure>


<p>IDEA ä¸­å¸¸ç”¨çš„ <code>.gitignore</code> æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compiled class file</span></span><br><span class="line">*.class</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Log file</span></span><br><span class="line">*.log</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BlueJ files</span></span><br><span class="line">*.ctxt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mobile Tools <span class="keyword">for</span> Java (J2ME)</span></span><br><span class="line">.mtj.tmp/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Package Files <span class="comment">#</span></span></span><br><span class="line">*.jar</span><br><span class="line">*.war</span><br><span class="line">*.nar</span><br><span class="line">*.ear</span><br><span class="line">*.zip</span><br><span class="line">*.tar.gz</span><br><span class="line">*.rar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">virtual machine crash logs</span></span><br><span class="line">hs_err_pid*</span><br><span class="line">.classpath</span><br><span class="line">.project</span><br><span class="line">.settings</span><br><span class="line">target</span><br><span class="line">.idea</span><br><span class="line">*.iml</span><br></pre></td></tr></table></figure>

<h1 id="7-åˆ†æ”¯"><a href="#7-åˆ†æ”¯" class="headerlink" title="7. åˆ†æ”¯"></a>7. åˆ†æ”¯</h1><p>å‡ ä¹æ‰€æœ‰çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½ä»¥æŸç§å½¢å¼æ”¯æŒåˆ†æ”¯ã€‚ä½¿ç”¨åˆ†æ”¯æ„å‘³ç€ä½ å¯ä»¥æŠŠä½ çš„å·¥ä½œä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥è¿›è¡Œé‡å¤§çš„ Bug ä¿®æ”¹ã€å¼€å‘æ–°çš„åŠŸèƒ½ï¼Œä»¥å…å½±å“å¼€å‘ä¸»çº¿ã€‚</p>
<blockquote>
<p>Git ä¸­ä¸åˆ†æ”¯ç›¸å…³çš„å¸¸ç”¨æŒ‡ä»¤</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯ã€‚-a è¡¨ç¤ºåˆ—å‡ºæ‰€æœ‰åˆ†æ”¯ï¼ŒåŒ…æ‹¬è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch [-a]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -r</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span></span><br><span class="line">git branch [branch-name]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ‡æ¢åˆ°æŸä¸ªåˆ†æ”¯</span></span><br><span class="line">git checkout [branch-name]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span></span><br><span class="line">git checkout -b [branch]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line">git merge [branch]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -d [branch-name]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤æœªåˆå¹¶çš„æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -D [branch-name]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git push origin --delete [branch-name]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤è¿œç¨‹åˆ†æ”¯(ç›¸å½“äºä½¿ç”¨ä¸€ä¸ªç©ºåˆ†æ”¯æ¥è¦†ç›–åŸæ¥çš„åˆ†æ”¯)</span></span><br><span class="line">git push origin :branch-name</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯å’Œè¿½è¸ªæƒ…å†µ</span></span><br><span class="line">git remote show origin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å¯¹åˆ†æ”¯çš„è¿œç¨‹è·Ÿè¸ªï¼Œä½†è¿™ä¸ªåˆ†æ”¯ä»ç„¶åœ¨è¿œç¨‹</span></span><br><span class="line">git branch -dr [remote/branch]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ›´æ–°æœ¬åœ° git åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯åŒæ­¥(ä¿ç•™æœ¬åœ°å­˜åœ¨çš„åˆ†æ”¯)</span></span><br><span class="line">git remote update origin --prune</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤æœ¬åœ°å¤šä½™åˆ†æ”¯(å³è¿œç¨‹å·²ç»ä¸å­˜åœ¨çš„åˆ†æ”¯)</span></span><br><span class="line">git remote prune origin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¼€å‘ä¸­åˆ†æ”¯ä½¿ç”¨åŸåˆ™ä¸æµç¨‹</p>
</blockquote>
<p>å‡ ä¹æ‰€æœ‰çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½ä»¥æŸç§å½¢å¼æ”¯æŒåˆ†æ”¯ã€‚ ä½¿ç”¨åˆ†æ”¯æ„å‘³ç€ä½ å¯ä»¥æŠŠä½ çš„å·¥ä½œä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥è¿›è¡Œé‡å¤§çš„ Bug ä¿®æ”¹ã€å¼€å‘æ–°çš„åŠŸèƒ½ï¼Œä»¥å…å½±å“å¼€å‘ä¸»çº¿ã€‚</p>
<p>åœ¨å¼€å‘ä¸­ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹åˆ†æ”¯ä½¿ç”¨åŸåˆ™ä¸æµç¨‹ï¼š</p>
<ul>
<li>master (ç”Ÿäº§)åˆ†æ”¯ï¼šçº¿ä¸Šåˆ†æ”¯ï¼Œä¸»åˆ†æ”¯ï¼Œä¸­å°è§„æ¨¡é¡¹ç›®ä½œä¸ºçº¿ä¸Šè¿è¡Œçš„åº”ç”¨å¯¹åº”çš„åˆ†æ”¯ï¼›</li>
<li>develop (å¼€å‘)åˆ†æ”¯ï¼šæ˜¯ä» master åˆ›å»ºçš„åˆ†æ”¯ï¼Œä¸€èˆ¬ä½œä¸ºå¼€å‘éƒ¨é—¨çš„ä¸»è¦å¼€å‘åˆ†æ”¯ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¹¶è¡Œå¼€å‘ä¸åŒæœŸä¸Šçº¿è¦æ±‚ï¼Œéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬è¿›è¡Œå¼€å‘ï¼Œé˜¶æ®µå¼€å‘å®Œæˆåï¼Œéœ€è¦æ˜¯åˆå¹¶åˆ° master åˆ†æ”¯ï¼Œå‡†å¤‡ä¸Šçº¿ã€‚ </li>
<li>feature&#x2F;xxxx åˆ†æ”¯ï¼šä»developåˆ›å»ºçš„åˆ†æ”¯ï¼Œä¸€èˆ¬æ˜¯åŒæœŸå¹¶è¡Œå¼€å‘ï¼Œä½†ä¸åŒæœŸä¸Šçº¿æ—¶åˆ›å»ºçš„åˆ†æ”¯ï¼Œåˆ†æ”¯ä¸Šçš„ç ”å‘ä»»åŠ¡å®Œ æˆååˆå¹¶åˆ°developåˆ†æ”¯ã€‚ </li>
<li>hotfix&#x2F;xxxx åˆ†æ”¯ï¼šä» master æ´¾ç”Ÿçš„åˆ†æ”¯ï¼Œä¸€èˆ¬ä½œä¸ºçº¿ä¸Š bug ä¿®å¤ä½¿ç”¨ï¼Œä¿®å¤å®Œæˆåéœ€è¦åˆå¹¶åˆ° masterã€testã€ develop åˆ†æ”¯ã€‚</li>
</ul>
<p>è¿˜æœ‰ä¸€äº›å…¶ä»–åˆ†æ”¯ï¼Œåœ¨æ­¤ä¸å†è¯¦è¿°ï¼Œä¾‹å¦‚ test åˆ†æ”¯(ç”¨äºä»£ç æµ‹è¯•)ã€pre åˆ†æ”¯(é¢„ä¸Šçº¿åˆ†æ”¯)ç­‰ç­‰ã€‚</p>
<h1 id="8-Gitè¿œç¨‹ä»“åº“"><a href="#8-Gitè¿œç¨‹ä»“åº“" class="headerlink" title="8. Gitè¿œç¨‹ä»“åº“"></a>8. Gitè¿œç¨‹ä»“åº“</h1><blockquote>
<p> å¸¸ç”¨çš„æ‰˜ç®¡æœåŠ¡(è¿œç¨‹ä»“åº“)</p>
</blockquote>
<p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº† Git ä¸­å­˜åœ¨ä¸¤ç§ç±»å‹çš„ä»“åº“ï¼Œå³æœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ­å»ºGitè¿œç¨‹ä»“åº“å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å€ŸåŠ©äº’è”ç½‘ä¸Šæä¾›çš„ä¸€äº›ä»£ç æ‰˜ç®¡æœåŠ¡æ¥å®ç°ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æœ‰ GitHubã€ç äº‘(Gitee)ã€GitLab ç­‰ã€‚</p>
<ul>
<li><p><a href="https://github.com/">GitHub</a> æ˜¯ä¸€ä¸ªé¢å‘å¼€æºåŠç§æœ‰è½¯ä»¶é¡¹ç›®çš„æ‰˜ç®¡å¹³å°ï¼Œå› ä¸ºåªæ”¯æŒ Git ä½œä¸ºå”¯ä¸€çš„ç‰ˆæœ¬åº“æ ¼å¼è¿›è¡Œæ‰˜ç®¡ï¼Œæ•…åGitHubã€‚</p>
</li>
<li><p><a href="https://gitee.com/">ç äº‘(Gitee)</a> æ˜¯å›½å†…çš„ä¸€ä¸ªä»£ç æ‰˜ç®¡å¹³å°ï¼Œç”±äºæœåŠ¡å™¨åœ¨å›½å†…ï¼Œæ‰€ä»¥ç›¸æ¯”äº GitHubï¼Œç äº‘é€Ÿåº¦ä¼šæ›´å¿«ã€‚</p>
</li>
<li><p><a href="https://about.gitlab.com/">GitLab</a> æ˜¯ä¸€ä¸ªç”¨äºä»“åº“ç®¡ç†ç³»ç»Ÿçš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨ Git ä½œä¸ºä»£ç ç®¡ç†å·¥å…·ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ­å»ºèµ·æ¥çš„ Web æœåŠ¡ï¼Œä¸€èˆ¬ç”¨äºåœ¨ä¼ä¸šã€å­¦æ ¡ç­‰å†…éƒ¨ç½‘ç»œæ­å»º Git ç§æœã€‚</p>
</li>
</ul>
<blockquote>
<p>GitHub çš„ä½¿ç”¨</p>
</blockquote>
<p>å¯ä»¥ä½¿ç”¨ GitHub ä½œä¸ºä»£ç æ‰˜ç®¡å¹³å°ï¼Œå°½ç®¡ GitHub çš„è®¿é—®é€Ÿåº¦ä¸ä½³ï¼Œä½†ä¹Ÿä¸é€‰æ‹© Giteeï¼Œè€Œåœ¨å…¬å¸ä¸­ï¼Œè¿˜å¯èƒ½ä½¿ç”¨æ­å»ºçš„çš„ GitLab æœåŠ¡å™¨ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/GitHub%E5%AE%98%E7%BD%91.png"></p>
<ul>
<li><p>é¦–å…ˆéœ€è¦æ³¨å†Œ GitHubï¼›</p>
</li>
<li><p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œ<strong>å¼ºçƒˆå»ºè®®</strong> è®¾ç½®æœ¬æœºç»‘å®š SSH å…¬é’¥ï¼Œå®ç°å…å¯†ç ç™»å½•ï¼›</p>
</li>
</ul>
<h2 id="8-1-é…ç½®-SSH-å…¬é’¥"><a href="#8-1-é…ç½®-SSH-å…¬é’¥" class="headerlink" title="8.1 é…ç½® SSH å…¬é’¥"></a>8.1 é…ç½® SSH å…¬é’¥</h2><ol>
<li><p>è¿›å…¥ <code>C:\Users(ç”¨æˆ·)\ä½ çš„ç”¨æˆ·å</code> ç›®å½•</p>
</li>
<li><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡è®¾ç½®ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹çœ‹ä¸åˆ°.sshç›®å½•</p>
</li>
<li><p>åœ¨ä¸Šè¿°ç›®å½•ä¸‹å³é”®æ‰“å¼€ <code>â€œGit Bash Hereâ€</code> ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¹¶ç”Ÿæˆå…¬é’¥</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;é‚®ç®±æˆ–å…¶ä»–æè¿°æ€§æ–‡å­—&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rsaæ˜¯åŠ å¯†æ–¹å¼</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿è¡Œåæ— è„‘ä¸‹ä¸€æ­¥å³å¯</p>
</li>
</ol>
<blockquote>
<p>å¯¹è¾“å…¥çš„å‘½ä»¤ä»¥åŠæ‰§è¡Œå‘½ä»¤åéœ€è¦è¾“å‡ºçš„æƒ…å†µè¿›è¡Œè§£æ</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç çœç•¥äº† -f å‚æ•°ï¼Œå› æ­¤è¿è¡Œä¸Šé¢é‚£æ¡å‘½ä»¤åä¼šè¦æ±‚è¾“å…¥ä¸€ä¸ªæ–‡ä»¶åï¼Œç”¨äºä¿å­˜åˆšæ‰ç”Ÿæˆçš„ SSH key ä»£ç ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Generating public/private rsa key pair.</span><br><span class="line"># Enter file in which to save the key (/c/Users/you/.ssh/id_rsa): [Press enter]</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä¸è¾“å…¥æ–‡ä»¶åï¼Œä½¿ç”¨é»˜è®¤æ–‡ä»¶å(<strong>æ¨è</strong>)ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆ id_rsa å’Œ id_rsa.pub ä¸¤ä¸ªç§˜é’¥æ–‡ä»¶ã€‚</p>
<p>æ¥ç€åˆä¼šæç¤ºè¾“å…¥ä¸¤æ¬¡å¯†ç (è¯¥å¯†ç æ˜¯ push æ–‡ä»¶çš„æ—¶å€™è¦è¾“å…¥çš„å¯†ç ï¼Œè€Œä¸æ˜¯ GitHub ç®¡ç†è€…çš„å¯†ç )ï¼Œä¹Ÿå¯ä»¥ä¸è¾“å…¥å¯†ç ï¼Œç›´æ¥æŒ‰å›è½¦ã€‚é‚£ä¹ˆ push çš„æ—¶å€™å°±ä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œç›´æ¥æäº¤åˆ° GitHub ä¸Šäº†ï¼Œå¦‚ï¼š(æˆ‘åœ¨æ­¤ç›´æ¥å›è½¦ï¼Œä¸è¾“å…¥å¯†ç )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line"># Enter same passphrase again:</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°†ä¼šæ˜¾ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Your identification has been saved in /c/Users/you/.ssh/id_rsa.</span><br><span class="line"># Your public key has been saved in /c/Users/you/.ssh/id_rsa.pub.</span><br><span class="line"># The key fingerprint is:</span><br><span class="line"># 01:0f:f4:3b:ca:85:d6:17:a1:7d:f0:68:9d:f0:a2:db your_email@example.com</span><br></pre></td></tr></table></figure>

<p>å½“çœ‹åˆ°ä¸Šé¢è¿™äº›ä¿¡æ¯æ—¶å°±è¯´æ˜ SSH key å·²ç»åˆ›å»ºæˆåŠŸï¼Œæ¥ä¸‹æ¥å°†å…¶æ·»åŠ åˆ° GitHub çš„ SSH key ä¸Šå°±å¯ä»¥äº†ã€‚</p>
<ul>
<li><p>æ‰“å¼€ GitHub å¹¶è¿›è¡Œç™»å½•ï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒï¼Œé€‰æ‹© Settingsï¼Œè¿›å…¥è®¾ç½®é¡µé¢åï¼Œç‚¹å‡» Access ä¸‹çš„ SSH and GPG keysï¼Œä¹‹åç‚¹å‡» New SSH keyï¼›</p>
</li>
<li><p>æ‰“å¼€ç›®å½• <code>C:\Users(ç”¨æˆ·)\ä½ çš„ç”¨æˆ·å\.ssh</code>ï¼Œå°† id_rsa.pub æ–‡ä»¶å†…çš„å†…å®¹å¤åˆ¶åˆ°å…¬é’¥å¡«å†™å¤„ï¼Œç‚¹å‡» â€œç¡®å®šâ€ï¼Œè¾“å…¥ GitHub çš„å¯†ç å³å¯æ·»åŠ æˆåŠŸï¼</p>
</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E5%85%AC%E9%92%A5%E5%A4%8D%E5%88%B6.png" style="zoom: 50%;">

<p>PSï¼šid_rsa å­˜æ”¾çš„æ˜¯ç§é’¥ï¼Œid_rsa.pub å­˜æ”¾çš„æ˜¯å…¬é’¥ï¼Œéœ€è¦å¤åˆ¶çš„æ˜¯å…¬é’¥ id_rsa.pub çš„å†…å®¹ã€‚</p>
<ul>
<li><p>è¿è¡Œ Git Bashï¼Œè¾“å…¥å‘½ä»¤ <code>ssh -T git@github.com</code>(å¦‚æœä½¿ç”¨ Giteeï¼Œè¾“å…¥ <code>ssh -T git@gitee.com</code>)ï¼Œç„¶åè¾“å…¥ yesã€‚å‡ºç°ä»¥ä¸‹å†…å®¹åˆ™è¿æ¥æˆåŠŸï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/%E8%BF%9E%E6%8E%A5GitHub%E6%88%90%E5%8A%9F.png"></p>
</li>
<li><p>åˆ°æ­¤ï¼Œå®Œæˆ SSH å…å¯†ç™»å½•çš„é…ç½®ã€‚</p>
</li>
<li><p>å¦‚æœéœ€è¦æ–°å»ºä»“åº“ï¼Œç‚¹å‡»ä¸»ç•Œé¢å³ä¸Šæ–¹å¤´åƒæ—çš„ â€œ+â€ ç„¶åé€‰æ‹© â€œNew repositoryâ€ å³å¯ï¼š</p>
</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/GitHub%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%93.png">


<h2 id="8-2-æ“ä½œè¿œç¨‹ä»“åº“"><a href="#8-2-æ“ä½œè¿œç¨‹ä»“åº“" class="headerlink" title="8.2 æ“ä½œè¿œç¨‹ä»“åº“"></a>8.2 æ“ä½œè¿œç¨‹ä»“åº“</h2><p>æ‰§è¡Œæ“ä½œä¹‹å‰è¦ç¡®ä¿æ­¤æ–‡ä»¶å¤¹ä¸º Git æœ¬åœ°ä»“åº“ã€‚</p>
<blockquote>
<p>æ·»åŠ è¿œç¨‹ä»“åº“</p>
</blockquote>
<p>æ­¤æ“ä½œæ˜¯å…ˆåˆå§‹åŒ–æœ¬åœ°åº“ï¼Œç„¶åä¸å·²åˆ›å»ºçš„è¿œç¨‹åº“è¿›è¡Œå¯¹æ¥ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add &lt;è¿œç«¯åç§°&gt; &lt;ä»“åº“è·¯å¾„&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿œç«¯åç§°ï¼Œé»˜è®¤å¡«å†™originï¼Œå–å†³äºè¿œç«¯æœåŠ¡å™¨è®¾ç½® </li>
<li>ä»“åº“è·¯å¾„ï¼Œä»è¿œç«¯æœåŠ¡å™¨è·å–æ­¤URL</li>
</ul>
<blockquote>
<p>æŸ¥çœ‹è¿œç¨‹ä»“åº“</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¨é€åˆ°è¿œç¨‹ä»“åº“</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push [-f] [--set-upstream] [è¿œç«¯åç§° [æœ¬åœ°åˆ†æ”¯å][:è¿œç«¯åˆ†æ”¯å] ]</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¦‚æœè¿œç¨‹åˆ†æ”¯åå’Œæœ¬åœ°åˆ†æ”¯åç§°ç›¸åŒï¼Œåˆ™å¯ä»¥åªå†™æœ¬åœ°åˆ†æ”¯ </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
</li>
<li><p>-f è¡¨ç¤ºå¼ºåˆ¶è¦†ç›–</p>
</li>
<li><p><code>--set-upstream</code> æ¨é€åˆ°è¿œç«¯çš„åŒæ—¶å¹¶ä¸”å»ºç«‹èµ·å’Œè¿œç«¯åˆ†æ”¯çš„å…³è”å…³ç³»ã€‚ </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push --set-upstream origin master</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœå½“å‰åˆ†æ”¯å·²ç»å’Œè¿œç«¯åˆ†æ”¯å…³è”ï¼Œåˆ™å¯ä»¥çœç•¥åˆ†æ”¯åå’Œè¿œç«¯åã€‚</p>
<p><code>git push</code> å°† <code>master</code> åˆ†æ”¯æ¨é€åˆ°å·²å…³è”çš„è¿œç«¯åˆ†æ”¯ã€‚</p>
</li>
</ul>
<h1 id="9-åœ¨-IDEA-ä¸­ä½¿ç”¨-Git"><a href="#9-åœ¨-IDEA-ä¸­ä½¿ç”¨-Git" class="headerlink" title="9. åœ¨ IDEA ä¸­ä½¿ç”¨ Git"></a>9. åœ¨ IDEA ä¸­ä½¿ç”¨ Git</h1><p><strong>ä»¥ä¸‹å†…å®¹é€‚ç”¨äº IDEA 2022.2 ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬ä»…ä¾›å‚è€ƒã€‚</strong></p>
<h2 id="9-1-IDEA-é…ç½®-Git"><a href="#9-1-IDEA-é…ç½®-Git" class="headerlink" title="9.1 IDEA é…ç½® Git"></a>9.1 IDEA é…ç½® Git</h2><p>å®‰è£…å¥½ IntelliJ IDEA åï¼Œå¦‚æœ Git å®‰è£…åœ¨é»˜è®¤è·¯å¾„ä¸‹ï¼Œé‚£ä¹ˆ IDEA ä¼šè‡ªåŠ¨æ‰¾åˆ° Git çš„ä½ç½®ï¼Œå¦‚æœæ›´æ”¹äº† Git çš„å®‰è£…ä½ç½®åˆ™éœ€è¦æ‰‹åŠ¨é…ç½®ä¸‹ Git çš„è·¯å¾„ã€‚æŒ‰ç…§ä¸‹é¢æ­¥éª¤ï¼šFile â€” Settings â€” Version Control â€” Git â€” Path to Git executableï¼Œåœ¨æ­¤å¤„é…ç½® Git å®‰è£…ç›®å½•ä¸‹çš„ exe æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šD:\Git\cmd\git.exeï¼Œå…¶ä¸­ D:\Git æ˜¯å®‰è£…ç›®å½•ã€‚ç„¶åå¯ä»¥ç‚¹å‡» â€œTsetâ€ï¼Œå‡ºç° 5 åˆ™è¯´æ˜ IDEA æˆåŠŸè¯†åˆ«åˆ° Git ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/IDEA%E9%85%8D%E7%BD%AEGit.png" style="zoom:67%;">

<p>è¿˜å¯ä»¥é€‰æ‹© Settings â€” Version Control â€” GitHubï¼Œæ·»åŠ  GitHub è´¦å·åˆ° IDEA ä¸­ã€‚</p>
<h2 id="9-2-åœ¨-IDEA-ä¸­æ“ä½œ-Git"><a href="#9-2-åœ¨-IDEA-ä¸­æ“ä½œ-Git" class="headerlink" title="9.2 åœ¨ IDEA ä¸­æ“ä½œ Git"></a>9.2 åœ¨ IDEA ä¸­æ“ä½œ Git</h2><p>å¯ä»¥ä½¿ç”¨å³ä¸Šè§’ IDEA é›†æˆçš„ Git æŒ‰é’®è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥åœ¨ IDEA ä¸­çš„ Terminal æ‰§è¡Œ Git å‘½ä»¤å®Œæˆæ“ä½œã€‚</p>
<blockquote>
<p>æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“ç»‘å®š</p>
</blockquote>
<p>1ã€åˆå§‹åŒ–æœ¬åœ°ä»“åº“</p>
<p>å³ä¸Šè§’å·¥å…·æ  VCS â€” Create Git Repository â€” é€‰æ‹© Git ä»“åº“ç›®å½•ï¼Œé»˜è®¤æ˜¯å½“å‰é¡¹ç›®ç›®å½• â€” OK</p>
<p>2ã€è®¾ç½®è¿œç¨‹ä»“åº“</p>
<p>åˆå§‹åŒ–æœ¬åœ°ä»“åº“æˆåŠŸåå³ä¸Šè§’å·¥å…·æ ä¼šå‡ºç° Git é€‰é¡¹ï¼ŒGit â€” Manage Remotes â€” è¾“å…¥è¿œç¨‹åœ°å€ URL â€” OK</p>
<p><strong>PSï¼šè®¾ç½®è¿œç¨‹ä»“åº“æ—¶è¿œç¨‹ä»“åº“éœ€è¦ä¸ºç©ºã€‚</strong></p>
<p>3ã€æäº¤åˆ°æœ¬åœ°ä»“åº“</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/IDEA%E4%B8%AD%E6%8F%90%E4%BA%A4%E5%88%B0%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93.png" style="zoom: 67%;">

<p>4ã€æ¨é€åˆ°è¿œç¨‹ä»“åº“</p>
<p>å³ä¸Šè§’å·¥å…·æ  Git â€” Push â€” Push (Push çš„æ—¶å€™éœ€è¦ä½¿ç”¨ GitHub çš„ token)</p>
<p>6ã€åˆ›å»ºåˆ†æ”¯</p>
<p>å…‹éš†è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°æˆåŠŸååœ¨ IDEA å³ä¸‹è§’ä¼šå‡ºç° master æŒ‰é’®ï¼Œä¾æ¬¡ç‚¹å‡» master â€” New Branch â€” è¾“å…¥æ–°åˆ†æ”¯å â€” Createï¼Œå¯ä»¥çœ‹åˆ°å³ä¸‹è§’çš„ master åˆ†æ”¯åå˜æˆäº†è¾“å…¥çš„æ–°åˆ†æ”¯åï¼Œå³å½“å‰åœ¨æ–°åˆ†æ”¯ä¸‹ã€‚</p>
<p>7ã€åˆ‡æ¢åˆ†æ”¯åŠå…¶ä»–åˆ†æ”¯ç›¸å…³æ“ä½œ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/IEDEA%E4%B8%AD%E5%88%86%E6%94%AF%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C.png" style="zoom: 80%;">

<blockquote>
<p>å…‹éš†è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°</p>
</blockquote>
<p>å³ä¸Šè§’å·¥å…·æ  VCS â€” Get from Version Control â€” æ ¹æ®éœ€æ±‚è‡ªå·±é€‰æ‹©(å¯ä»¥æ˜¯ URL åœ°å€æˆ–è€…ç›´æ¥å°†è‡ªå·±çš„è¿œç¨‹ä»“åº“æ‹‰å–ä¸‹æ¥)</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Git/IDEA%E5%85%8B%E9%9A%86%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E5%88%B0%E6%9C%AC%E5%9C%B0.png" style="zoom:67%;">

<blockquote>
<p>IDEA é¡¹ç›®ç»‘å®š Git</p>
</blockquote>
<p>IDEA ç»‘å®š Git åå¯ä»¥åœ¨ IDEA è§‚å¯Ÿåˆ° <strong>æ–‡ä»¶é¢œè‰²çš„å˜åŒ–</strong>ï¼š</p>
<p><font color="#D06356">çº¢è‰²(æˆ–çº¢è¤è‰²)</font></p>
<ul>
<li>è¡¨ç¤ºæ–‡ä»¶å°šæœªè¢«æ·»åŠ åˆ° Git ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œå³æ–‡ä»¶è¿˜æœªè¢« <code>git add</code> å‘½ä»¤æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</li>
<li>é€šå¸¸è¿™äº›æ–‡ä»¶æ˜¯æ–°åˆ›å»ºçš„ï¼Œæˆ–è€…è™½ç„¶å­˜åœ¨ä½†å°šæœªè¢« Git è·Ÿè¸ªã€‚</li>
</ul>
<p><font color="#4E8854">ç»¿è‰²</font></p>
<ul>
<li>è¡¨ç¤ºæ–‡ä»¶å·²ç»è¢« <code>git add</code> å‘½ä»¤æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œä½†å°šæœªè¢« <code>git commit</code> å‘½ä»¤æäº¤ã€‚</li>
<li>æ¢å¥è¯è¯´ï¼Œè¿™äº›æ–‡ä»¶å·²ç»å¤„äºå¾…æäº¤çŠ¶æ€ã€‚</li>
</ul>
<p><font color="#5F96A6">è“è‰²</font></p>
<ul>
<li>è¡¨ç¤ºæ–‡ä»¶å·²ç»è¢« Git è·Ÿè¸ªï¼Œå¹¶ä¸”å·²ç»å‘ç”Ÿäº†ä¿®æ”¹ï¼Œä½†è¿™äº›ä¿®æ”¹å°šæœªè¢«æäº¤(å³æœªè¢« <code>git commit</code>)ã€‚</li>
<li>ä¸€æ—¦è¿™äº›ä¿®æ”¹è¢«æäº¤ï¼Œæ–‡ä»¶é¢œè‰²å¯èƒ½ä¼šå˜ä¸ºç™½è‰²(è¡¨ç¤ºæ–‡ä»¶å·²æäº¤ä¸”æ²¡æœ‰è¿›ä¸€æ­¥ä¿®æ”¹)ã€‚</li>
</ul>
<p><font color="#B8AFAB">ç™½è‰²</font></p>
<ul>
<li>è¡¨ç¤ºæ–‡ä»¶å·²ç»è¢« Git è·Ÿè¸ªï¼Œå¹¶ä¸”æœ€è¿‘çš„ä¿®æ”¹å·²ç»è¢«æäº¤ã€‚</li>
<li>è¿™äº›æ–‡ä»¶ç›®å‰æ²¡æœ‰æœªæäº¤çš„ä¿®æ”¹ã€‚</li>
</ul>
<p><font color="#87939A">ç°è‰²</font></p>
<ul>
<li>è¡¨ç¤ºæ–‡ä»¶è™½ç„¶å­˜åœ¨äºé¡¹ç›®ä¸­ï¼Œä½†å·²ç»è¢« <code>.gitignore</code> æ–‡ä»¶å¿½ç•¥ï¼Œå› æ­¤ä¸ä¼šè¢« Git è·Ÿè¸ªã€‚</li>
</ul>
<blockquote>
<p>å¿½ç•¥æ–‡ä»¶åˆ›å»º</p>
</blockquote>
<p>ä¸å¸Œæœ›å°† IDEA çš„é…ç½®æ–‡ä»¶(.idea)push åˆ°è¿œç¨‹ä»“åº“ï¼Œåœ¨ .gitignore æ–‡ä»¶ä¸­æ·»åŠ  <code>.idea/</code> å³å¯ã€‚å¦‚æœå½“å‰é¡¹ç›®ä¸­æ²¡æœ‰ .gitignore æ–‡ä»¶ï¼Œå°±éœ€è¦åˆ›å»º .gitignore æ–‡ä»¶ã€‚</p>
<p>ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>å¤åˆ¶ .gitignore æ–‡ä»¶åˆ°é¡¹ç›®ã€‚</p>
<p>å› ä¸º .gitignore æ¯”è¾ƒå›ºå®šï¼Œå‡ ä¹å¾ˆå¤šé¡¹ç›®éƒ½å¤§å·®ä¸å·®ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å»ç½‘ä¸Šå¤åˆ¶</p>
</li>
<li><p>å®‰è£…ä½¿ç”¨ .ignore æ’ä»¶ã€‚</p>
<p>ç‚¹å‡» IDEA ä¸­å·¦ä¸Šè§’ Fileâ€“ Settingsï¼Œå®‰è£… .ignore æ’ä»¶ï¼Œå®‰è£…å¥½åœ¨é¡¹ç›®å³é”®æ·»åŠ  .gitignore ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿å³å¯ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Dockeræ•™ç¨‹</title>
    <url>/posts/Docker/</url>
    <content><![CDATA[<p>Docker å®˜ç½‘ï¼š<a href="https://www.docker.com/">https://www.docker.com</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1HP4118797/">é»‘é©¬ç¨‹åºå‘˜Dockerå¿«é€Ÿå…¥é—¨åˆ°é¡¹ç›®éƒ¨ç½²ï¼ŒMySQLéƒ¨ç½²+Nginxéƒ¨ç½²+dockerè‡ªå®šä¹‰é•œåƒ+DockerComposeé¡¹ç›®å®æˆ˜ä¸€å¥—æå®š</a></p>
<h1 id="1-åˆè¯†-Docker"><a href="#1-åˆè¯†-Docker" class="headerlink" title="1. åˆè¯† Docker"></a>1. åˆè¯† Docker</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯-Docker"><a href="#1-1-ä»€ä¹ˆæ˜¯-Docker" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯ Docker"></a>1.1 ä»€ä¹ˆæ˜¯ Docker</h2><p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå®ƒå¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½• Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´æ²¡æœ‰ä»»ä½•æ¥å£(ç±»ä¼¼ iPhon eçš„ app)ï¼Œå‡ ä¹æ²¡æœ‰æ€§èƒ½å¼€é”€ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨æœºå™¨å’Œæ•°æ®ä¸­å¿ƒä¸­è¿è¡Œã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚</p>
<p>Docker çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>è½»é‡çº§ä¸å¯ç§»æ¤æ€§</strong>ï¼šDocker å®¹å™¨æ˜¯åŸºäº Linux å†…æ ¸çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä¸ä¾èµ–äºç‰¹å®šçš„ç¡¬ä»¶æ¶æ„æˆ–æ“ä½œç³»ç»Ÿã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥è½»æ¾åœ°ä»ä¸€ä¸ªç¯å¢ƒè¿ç§»åˆ°å¦ä¸€ä¸ªç¯å¢ƒï¼Œå®ç°åº”ç”¨çš„å¿«é€Ÿéƒ¨ç½²å’Œæ‰©å±•ã€‚</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šDocker å…è®¸å¼€å‘è€…åƒç®¡ç†ä»£ç ä¸€æ ·ç®¡ç†åŸºç¡€è®¾æ–½ã€‚è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶å·¥å…·(å¦‚ Git)æ¥è·Ÿè¸ªå®¹å™¨çš„å˜æ›´å†å²ï¼Œç¡®ä¿æ¯æ¬¡å˜æ›´éƒ½æ˜¯å¯è¿½è¸ªå’Œå¯é‡å¤çš„ã€‚</li>
<li><strong>éš”ç¦»æ€§</strong>ï¼šæ¯ä¸ª Docker å®¹å™¨éƒ½è¿è¡Œåœ¨è‡ªå·±çš„å‘½åç©ºé—´ä¸­ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæ ˆå’Œè¿›ç¨‹ç©ºé—´ã€‚è¿™ç§éš”ç¦»æ€§ç¡®ä¿äº†å®¹å™¨ä¹‹é—´çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢äº†æ½œåœ¨çš„å†²çªå’Œå¹²æ‰°ã€‚</li>
<li><strong>è‡ªåŠ¨åŒ–ä¸ç¼–æ’</strong>ï¼šDocker ä¸å„ç§è‡ªåŠ¨åŒ–å·¥å…·å’Œç¼–æ’å¹³å°(å¦‚ Kubernetesã€Docker Swarm ç­‰)é›†æˆï¼Œå¯ä»¥è½»æ¾åœ°å®ç°å®¹å™¨çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†ã€‚</li>
<li><strong>ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šDocker æ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¾¤ä½“å’Œä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿï¼ŒåŒ…æ‹¬å¤§é‡çš„å®˜æ–¹å’Œç¬¬ä¸‰æ–¹é•œåƒã€æ’ä»¶å’Œå·¥å…·ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥è½»æ¾åœ°æ‰¾åˆ°æ‰€éœ€çš„èµ„æºï¼ŒåŠ é€Ÿåº”ç”¨çš„å¼€å‘å’Œéƒ¨ç½²è¿‡ç¨‹ã€‚</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼ŒDocker æä¾›äº†ä¸€ç§é«˜æ•ˆã€å¯é å’Œçµæ´»çš„æ–¹å¼æ¥æ„å»ºã€éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ã€‚å®ƒç®€åŒ–äº†åº”ç”¨çš„å¼€å‘å’Œè¿ç»´è¿‡ç¨‹ï¼Œé™ä½äº†æˆæœ¬ï¼Œæé«˜äº†æ•ˆç‡ã€‚æ— è®ºæ˜¯ä¸ªäººå¼€å‘è€…è¿˜æ˜¯å¤§å‹ä¼ä¸šï¼Œéƒ½å¯ä»¥ä» Docker ä¸­å—ç›Šã€‚</p>
<h2 id="1-2-Docker-å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«"><a href="#1-2-Docker-å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«" class="headerlink" title="1.2 Docker å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«"></a>1.2 Docker å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«</h2><p>Docker å¯ä»¥è®©ä¸€ä¸ªåº”ç”¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸­éå¸¸æ–¹ä¾¿çš„è¿è¡Œã€‚è€Œä»¥å‰æˆ‘ä»¬æ¥è§¦çš„è™šæ‹Ÿæœºï¼Œä¹Ÿèƒ½åœ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸­ï¼Œè¿è¡Œå¦å¤–ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œä¿æŠ¤ç³»ç»Ÿä¸­çš„ä»»ä½•åº”ç”¨ã€‚ä¸¤è€…æœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿ</p>
<p><strong>è™šæ‹Ÿæœº</strong>(virtual machine)æ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸­<strong>æ¨¡æ‹Ÿ</strong>ç¡¬ä»¶è®¾å¤‡ï¼Œç„¶åè¿è¡Œå¦ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚åœ¨ Windows ç³»ç»Ÿé‡Œé¢è¿è¡Œ Ubuntu ç³»ç»Ÿï¼Œè¿™æ ·å°±å¯ä»¥è¿è¡Œä»»æ„çš„Ubuntuåº”ç”¨äº†ã€‚</p>
<p><strong>Docker</strong>ä»…ä»…æ˜¯å°è£…å‡½æ•°åº“ï¼Œå¹¶æ²¡æœ‰æ¨¡æ‹Ÿå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå¦‚å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%8C%BA%E5%88%AB.png" style="zoom: 33%;">

<p>å¯¹æ¯”æ¥çœ‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E7%89%B9%E5%BE%81.png" style="zoom:50%;">

<p><strong>å°ç»“</strong></p>
<p>Docker å’Œè™šæ‹Ÿæœºçš„å·®å¼‚ï¼š</p>
<ul>
<li><p>Docker æ˜¯ä¸€ä¸ªç³»ç»Ÿè¿›ç¨‹ï¼›è™šæ‹Ÿæœºæ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿ</p>
</li>
<li><p>Docker ä½“ç§¯å°ã€å¯åŠ¨é€Ÿåº¦å¿«ã€æ€§èƒ½å¥½ï¼›è™šæ‹Ÿæœºä½“ç§¯å¤§ã€å¯åŠ¨é€Ÿåº¦æ…¢ã€æ€§èƒ½ä¸€èˆ¬</p>
</li>
</ul>
<h2 id="1-3-Dockeræ¶æ„"><a href="#1-3-Dockeræ¶æ„" class="headerlink" title="1.3 Dockeræ¶æ„"></a>1.3 Dockeræ¶æ„</h2><h3 id="1-3-1-é•œåƒ-Image-å’Œå®¹å™¨-Container"><a href="#1-3-1-é•œåƒ-Image-å’Œå®¹å™¨-Container" class="headerlink" title="1.3.1 é•œåƒ(Image)å’Œå®¹å™¨(Container)"></a>1.3.1 é•œåƒ(Image)å’Œå®¹å™¨(Container)</h3><p>Docker ä¸­æœ‰å‡ ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p>
<p><strong>é•œåƒ</strong>ï¼šDockerå°†åº”ç”¨ç¨‹åºåŠå…¶æ‰€éœ€çš„ä¾èµ–ã€å‡½æ•°åº“ã€ç¯å¢ƒã€é…ç½®ç­‰æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œç§°ä¸ºé•œåƒã€‚</p>
<p><strong>å®¹å™¨</strong>ï¼šé•œåƒä¸­çš„åº”ç”¨ç¨‹åºè¿è¡Œåå½¢æˆçš„è¿›ç¨‹å°±æ˜¯<strong>å®¹å™¨</strong>ï¼Œåªæ˜¯Dockerä¼šç»™å®¹å™¨è¿›ç¨‹åšéš”ç¦»ï¼Œå¯¹å¤–ä¸å¯è§ã€‚</p>
<p>ä¸€åˆ‡åº”ç”¨æœ€ç»ˆéƒ½æ˜¯ä»£ç ç»„æˆï¼Œéƒ½æ˜¯ç¡¬ç›˜ä¸­çš„ä¸€ä¸ªä¸ªçš„å­—èŠ‚å½¢æˆçš„<strong>æ–‡ä»¶</strong>ã€‚åªæœ‰è¿è¡Œæ—¶ï¼Œæ‰ä¼šåŠ è½½åˆ°å†…å­˜ï¼Œå½¢æˆè¿›ç¨‹ã€‚</p>
<p><strong>é•œåƒ</strong>å°±æ˜¯æŠŠä¸€ä¸ªåº”ç”¨åœ¨ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ã€åŠå…¶è¿è¡Œç¯å¢ƒã€éƒ¨åˆ†ç³»ç»Ÿå‡½æ•°åº“æ–‡ä»¶ä¸€èµ·æ‰“åŒ…å½¢æˆçš„æ–‡ä»¶åŒ…ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…æ˜¯åªè¯»çš„ã€‚</p>
<p><strong>å®¹å™¨</strong>å°±æ˜¯å°†è¿™äº›æ–‡ä»¶ä¸­ç¼–å†™çš„ç¨‹åºã€å‡½æ•°åŠ è½½åˆ°å†…å­˜ä¸­å…è®¸ï¼Œå½¢æˆè¿›ç¨‹ï¼Œåªä¸è¿‡è¦éš”ç¦»èµ·æ¥ã€‚å› æ­¤ä¸€ä¸ªé•œåƒå¯ä»¥å¯åŠ¨å¤šæ¬¡ï¼Œå½¢æˆå¤šä¸ªå®¹å™¨è¿›ç¨‹ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%95%9C%E5%83%8F%E5%92%8C%E5%AE%B9%E5%99%A8.png" style="zoom: 33%;">

<p>ä¾‹å¦‚ä½ ä¸‹è½½äº†ä¸€ä¸ªQQï¼Œå¦‚æœæˆ‘ä»¬å°†QQåœ¨ç£ç›˜ä¸Šçš„è¿è¡Œ<strong>æ–‡ä»¶</strong>åŠå…¶è¿è¡Œçš„æ“ä½œç³»ç»Ÿä¾èµ–æ‰“åŒ…ï¼Œå½¢æˆQQé•œåƒã€‚ç„¶åä½ å¯ä»¥å¯åŠ¨å¤šæ¬¡ï¼ŒåŒå¼€ã€ç”šè‡³ä¸‰å¼€QQï¼Œè·Ÿå¤šä¸ªå¦¹å­èŠå¤©ã€‚ğŸ˜</p>
<h3 id="1-3-2-DockerHub"><a href="#1-3-2-DockerHub" class="headerlink" title="1.3.2 DockerHub"></a>1.3.2 DockerHub</h3><p>å¼€æºåº”ç”¨ç¨‹åºéå¸¸å¤šï¼Œæ‰“åŒ…è¿™äº›åº”ç”¨å¾€å¾€æ˜¯é‡å¤çš„åŠ³åŠ¨ã€‚ä¸ºäº†é¿å…è¿™äº›é‡å¤åŠ³åŠ¨ï¼Œäººä»¬å°±ä¼šå°†è‡ªå·±æ‰“åŒ…çš„åº”ç”¨é•œåƒï¼Œä¾‹å¦‚ Redisã€MySQL é•œåƒæ”¾åˆ°ç½‘ç»œä¸Šï¼Œå…±äº«ä½¿ç”¨ï¼Œå°±åƒ GitHub çš„ä»£ç å…±äº«ä¸€æ ·ã€‚</p>
<p>Docker å®˜æ–¹æä¾›äº†ä¸€ä¸ªä¸“é—¨ç®¡ç†ã€å­˜å‚¨é•œåƒçš„ç½‘ç«™ï¼Œå¹¶å¯¹å¤–å¼€æ”¾äº†é•œåƒä¸Šä¼ ã€ä¸‹è½½çš„æƒåˆ©ã€‚Docker å®˜æ–¹æä¾›äº†ä¸€äº›åŸºç¡€é•œåƒï¼Œç„¶åå„å¤§è½¯ä»¶å…¬å¸åˆåœ¨åŸºç¡€é•œåƒåŸºç¡€ä¸Šï¼Œåˆ¶ä½œäº†è‡ªå®¶è½¯ä»¶çš„é•œåƒï¼Œå…¨éƒ¨éƒ½å­˜æ”¾åœ¨è¿™ä¸ªç½‘ç«™ã€‚è¿™ä¸ªç½‘ç«™å°±æˆäº† Docker é•œåƒäº¤æµçš„ç¤¾åŒºï¼š<a href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<ul>
<li><p>DockerHubï¼šDockerHub æ˜¯ä¸€ä¸ªå®˜æ–¹çš„ Docker é•œåƒçš„æ‰˜ç®¡å¹³å°ã€‚è¿™æ ·çš„å¹³å°ç§°ä¸º Docker Registryã€‚</p>
</li>
<li><p>å›½å†…ä¹Ÿæœ‰ç±»ä¼¼äº DockerHub çš„å…¬å¼€æœåŠ¡ï¼Œæ¯”å¦‚ <a href="https://c.163yun.com/hub">ç½‘æ˜“äº‘é•œåƒæœåŠ¡</a>ã€<a href="https://cr.console.aliyun.com/">é˜¿é‡Œäº‘é•œåƒåº“</a>ç­‰ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬ä¸€æ–¹é¢å¯ä»¥å°†è‡ªå·±çš„é•œåƒå…±äº«åˆ° DockerHubï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥ä» DockerHub æ‹‰å–é•œåƒï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/DockerHub%E4%B8%8A%E4%BC%A0%E4%B8%8E%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F.png" style="zoom: 25%;">

<h3 id="1-3-3-Dockeræ¶æ„"><a href="#1-3-3-Dockeræ¶æ„" class="headerlink" title="1.3.3 Dockeræ¶æ„"></a>1.3.3 Dockeræ¶æ„</h3><p>Docker æ˜¯ä¸€ä¸ª CS æ¶æ„çš„ç¨‹åºï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li><p>æœåŠ¡ç«¯(server)ï¼šDocker å®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£å¤„ç† Docker æŒ‡ä»¤ï¼Œç®¡ç†é•œåƒã€å®¹å™¨ç­‰</p>
</li>
<li><p>å®¢æˆ·ç«¯(client)ï¼šé€šè¿‡å‘½ä»¤æˆ–RestAPIå‘DockeræœåŠ¡ç«¯å‘é€æŒ‡ä»¤ã€‚å¯ä»¥åœ¨æœ¬åœ°æˆ–è¿œç¨‹å‘æœåŠ¡ç«¯å‘é€æŒ‡ä»¤</p>
</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E6%9E%B6%E6%9E%84.png" style="zoom: 50%;">

<h1 id="2-å¿«é€Ÿå…¥é—¨"><a href="#2-å¿«é€Ÿå…¥é—¨" class="headerlink" title="2. å¿«é€Ÿå…¥é—¨"></a>2. å¿«é€Ÿå…¥é—¨</h1><h2 id="2-1-å®‰è£…-Docker"><a href="#2-1-å®‰è£…-Docker" class="headerlink" title="2.1 å®‰è£… Docker"></a>2.1 å®‰è£… Docker</h2><p>Docker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚</p>
<p>Docker CE åˆ†ä¸º <code>stable</code> <code>test</code> å’Œ <code>nightly</code> ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚</p>
<p>å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„ <a href="https://docs.docker.com/install/">å®‰è£…æŒ‡å—</a>ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker CE åœ¨ CentOSä¸Šçš„å®‰è£…ã€‚</p>
<p>1ã€å¸è½½æ—§ç‰ˆ</p>
<p>é¦–å…ˆå¦‚æœç³»ç»Ÿä¸­å·²ç»å­˜åœ¨æ—§çš„ Dockerï¼Œåˆ™å…ˆå¸è½½ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">    docker-client \</span><br><span class="line">    docker-client-latest \</span><br><span class="line">    docker-common \</span><br><span class="line">    docker-latest \</span><br><span class="line">    docker-latest-logrotate \</span><br><span class="line">    docker-logrotate \</span><br><span class="line">    docker-engine</span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½®Dockerçš„ yum åº“</p>
<p>é¦–å…ˆè¦å®‰è£…ä¸€ä¸ª yum å·¥å…·</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œé…ç½® Docker çš„ yum æºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<p>3ã€å®‰è£… Docker</p>
<p>æœ€åï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£… Docker</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨å’Œæ ¡éªŒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨Docker</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœæ­¢Docker</span></span><br><span class="line">systemctl stop docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œdocker pså‘½ä»¤ï¼Œå¦‚æœä¸æŠ¥é”™ï¼Œè¯´æ˜å®‰è£…å¯åŠ¨æˆåŠŸ</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ Docekr ç‰ˆæœ¬</span></span><br><span class="line">docker -v</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¿”å›å¦‚ä¸‹ä¿¡æ¯</span></span><br><span class="line">Docker version 26.0.0, build 2ae903e</span><br></pre></td></tr></table></figure>

<p>5ã€é…ç½®é•œåƒåŠ é€Ÿ</p>
<p>è¿™é‡Œä»¥é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿä¸ºä¾‹ã€‚</p>
<p>(1) æ³¨å†Œé˜¿é‡Œäº‘è´¦å·</p>
<p>é¦–å…ˆè®¿é—®<a href="https://www.aliyun.com/">é˜¿é‡Œäº‘ç½‘ç«™</a>æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚</p>
<p>(2) å¼€é€šé•œåƒæœåŠ¡</p>
<p>åœ¨é¦–é¡µçš„äº§å“ä¸­ï¼Œæ‰¾åˆ°é˜¿é‡Œäº‘çš„<strong>å®¹å™¨é•œåƒæœåŠ¡</strong>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F(1).png" style="zoom: 67%;">

<p>ç‚¹å‡»åè¿›å…¥æ§åˆ¶å°ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F(2).png" style="zoom:67%;">

<p>(3) é…ç½®é•œåƒåŠ é€Ÿ</p>
<p>æ‰¾åˆ°<strong>é•œåƒå·¥å…·</strong>ä¸‹çš„<strong>é•œåƒåŠ é€Ÿå™¨</strong>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F(3).png" style="zoom: 80%;">

<p>é¡µé¢å‘ä¸‹æ»šåŠ¨ï¼Œå³å¯æ‰¾åˆ°é…ç½®çš„æ–‡æ¡£è¯´æ˜ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F(4).png" style="zoom: 80%;">

<p>å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºç›®å½•</span></span><br><span class="line">mkdir -p /etc/docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¤åˆ¶å†…å®¹ï¼Œæ³¨æ„æŠŠå…¶ä¸­çš„é•œåƒåŠ é€Ÿåœ°å€æ”¹æˆä½ è‡ªå·±çš„</span></span><br><span class="line">tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://xxxx.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡æ–°åŠ è½½é…ç½®</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯Docker</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<h2 id="2-2-éƒ¨ç½²-MySQL"><a href="#2-2-éƒ¨ç½²-MySQL" class="headerlink" title="2.2 éƒ¨ç½² MySQL"></a>2.2 éƒ¨ç½² MySQL</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ©ç”¨ Docker æ¥å®‰è£…ä¸€ä¸ª MySQL è½¯ä»¶ï¼Œå¤§å®¶å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ä¹‹å‰ä¼ ç»Ÿçš„å®‰è£…æ–¹å¼ï¼Œçœ‹çœ‹å“ªä¸ªæ•ˆç‡æ›´é«˜ä¸€äº›ã€‚</p>
<p>å¦‚æœæ˜¯åˆ©ç”¨ä¼ ç»Ÿæ–¹å¼éƒ¨ç½² MySQLï¼Œå¤§æ¦‚çš„æ­¥éª¤æœ‰ï¼š</p>
<ul>
<li>æœç´¢å¹¶ä¸‹è½½ MySQL å®‰è£…åŒ…</li>
<li>ä¸Šä¼ è‡³Linuxç¯å¢ƒ</li>
<li>ç¼–è¯‘å’Œé…ç½®ç¯å¢ƒ</li>
<li>å®‰è£…</li>
</ul>
<p>è€Œä½¿ç”¨ Docker å®‰è£…ï¼Œä»…ä»…éœ€è¦ä¸€æ­¥å³å¯ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤(å»ºè®®é‡‡ç”¨ CV å¤§æ³•)ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name mysql \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=123 \</span><br><span class="line">  mysql</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæ•ˆæœå¦‚å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%83%A8%E7%BD%B2MySQL.png" style="zoom: 67%;">

<p>MySQL å®‰è£…å®Œæ¯•ï¼é€šè¿‡ä»»æ„å®¢æˆ·ç«¯å·¥å…·å³å¯è¿æ¥åˆ° MySQLã€‚</p>
<p>å¤§å®¶å¯ä»¥å‘ç°ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤åï¼ŒDocker åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…ï¼Œæ˜¯å»è‡ªåŠ¨æœç´¢å¹¶ä¸‹è½½äº† MySQLï¼Œç„¶åä¼šè‡ªåŠ¨è¿è¡Œ MySQLï¼Œæˆ‘ä»¬å®Œå…¨ä¸ç”¨æ’æ‰‹ï¼Œéå¸¸æ–¹ä¾¿ã€‚è€Œä¸”ï¼Œè¿™ç§å®‰è£…æ–¹å¼ä½ å®Œå…¨ä¸ç”¨è€ƒè™‘è¿è¡Œçš„æ“ä½œç³»ç»Ÿç¯å¢ƒã€‚</p>
<p><font color="red">PSï¼šè¿™é‡Œä¸‹è½½çš„ä¸æ˜¯å®‰è£…åŒ…ï¼Œè€Œæ˜¯<strong>é•œåƒã€‚</strong></font>ğŸ˜€ é•œåƒä¸­ä¸ä»…åŒ…å«äº† MySQL æœ¬èº«ï¼Œè¿˜åŒ…å«äº†å…¶è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒã€é…ç½®ã€ç³»ç»Ÿçº§å‡½æ•°åº“ã€‚å› æ­¤å®ƒåœ¨è¿è¡Œæ—¶å°±æœ‰è‡ªå·±ç‹¬ç«‹çš„ç¯å¢ƒï¼Œå°±å¯ä»¥è·¨ç³»ç»Ÿè¿è¡Œï¼Œä¹Ÿä¸éœ€è¦æ‰‹åŠ¨å†æ¬¡é…ç½®ç¯å¢ƒäº†ã€‚è¿™å¥—ç‹¬ç«‹è¿è¡Œçš„éš”ç¦»ç¯å¢ƒæˆ‘ä»¬ç§°ä¸º<strong>å®¹å™¨</strong>ã€‚</p>
<p>å› æ­¤ï¼ŒDocker å®‰è£…è½¯ä»¶çš„è¿‡ç¨‹ï¼Œå°±æ˜¯è‡ªåŠ¨æœç´¢ä¸‹è½½é•œåƒï¼Œç„¶ååˆ›å»ºå¹¶è¿è¡Œå®¹å™¨çš„è¿‡ç¨‹ã€‚ğŸ˜ğŸ˜Docker ä¼šæ ¹æ®å‘½ä»¤ä¸­çš„é•œåƒåç§°å» DockerHub è‡ªåŠ¨æœç´¢å¹¶ä¸‹è½½é•œåƒã€‚</p>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<p>Docker æœ¬èº«åŒ…å«ä¸€ä¸ªåå°æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Docker å‘½ä»¤å‘Šè¯‰ Docker æœåŠ¡ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿéƒ¨ç½²æŒ‡å®šçš„åº”ç”¨ã€‚Docker æœåŠ¡éƒ¨ç½²åº”ç”¨æ—¶ï¼Œé¦–å…ˆè¦å»æœç´¢å¹¶ä¸‹è½½åº”ç”¨å¯¹åº”çš„é•œåƒï¼Œç„¶åæ ¹æ®é•œåƒåˆ›å»ºå¹¶å…è®¸å®¹å™¨ï¼Œåº”ç”¨å°±éƒ¨ç½²å®Œæˆäº†ã€‚</p>
<h2 id="2-3-å‘½ä»¤è§£è¯»"><a href="#2-3-å‘½ä»¤è§£è¯»" class="headerlink" title="2.3 å‘½ä»¤è§£è¯»"></a>2.3 å‘½ä»¤è§£è¯»</h2><p>åˆ©ç”¨ Docker å¿«é€Ÿçš„å®‰è£…äº† MySQLï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œä¸è¿‡æˆ‘ä»¬æ‰§è¡Œçš„å‘½ä»¤åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name mysql \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=123 \</span><br><span class="line">  mysql</span><br></pre></td></tr></table></figure>

<p>è§£è¯»ï¼š</p>
<ul>
<li><code>docker run -d</code> ï¼šåˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œ<code>-d</code>åˆ™æ˜¯è®©å®¹å™¨ä»¥åå°è¿›ç¨‹è¿è¡Œ</li>
<li><code>--name mysql </code> : ç»™å®¹å™¨èµ·ä¸ªåå­—å«<code>mysql</code>ï¼Œä½ å¯ä»¥å«åˆ«çš„</li>
<li><code>-p 3306:3306</code> : è®¾ç½®ç«¯å£æ˜ å°„ã€‚<ul>
<li><strong>å®¹å™¨æ˜¯éš”ç¦»ç¯å¢ƒ</strong>ï¼Œå¤–ç•Œä¸å¯è®¿é—®ã€‚ä½†æ˜¯å¯ä»¥<strong>å°†å®¿ä¸»æœºç«¯å£æ˜ å°„å®¹å™¨å†…åˆ°ç«¯å£</strong>ï¼Œå½“è®¿é—®å®¿ä¸»æœºæŒ‡å®šç«¯å£æ—¶ï¼Œå°±æ˜¯åœ¨è®¿é—®å®¹å™¨å†…çš„ç«¯å£äº†ã€‚</li>
<li>å®¹å™¨å†…ç«¯å£å¾€å¾€æ˜¯ç”±å®¹å™¨å†…çš„è¿›ç¨‹å†³å®šï¼Œä¾‹å¦‚ MySQL è¿›ç¨‹é»˜è®¤ç«¯å£æ˜¯ 3306ï¼Œå› æ­¤å®¹å™¨å†…ç«¯å£ä¸€å®šæ˜¯ 3306ï¼›è€Œå®¿ä¸»æœºç«¯å£åˆ™å¯ä»¥ä»»æ„æŒ‡å®šï¼Œä¸€èˆ¬ä¸å®¹å™¨å†…ä¿æŒä¸€è‡´ã€‚</li>
<li>æ ¼å¼ï¼š <code>-p å®¿ä¸»æœºç«¯å£:å®¹å™¨å†…ç«¯å£</code>ï¼Œç¤ºä¾‹ä¸­å°±æ˜¯å°†å®¿ä¸»æœºçš„ 3306 æ˜ å°„åˆ°å®¹å™¨å†…çš„3306ç«¯å£</li>
</ul>
</li>
<li><code>-e TZ=Asia/Shanghai</code> : é…ç½®å®¹å™¨å†…è¿›ç¨‹è¿è¡Œæ—¶çš„ä¸€äº›å‚æ•°<ul>
<li>æ ¼å¼ï¼š<code>-e KEY=VALUE</code>ï¼ŒKEY å’Œ VALUE éƒ½ç”±å®¹å™¨å†…è¿›ç¨‹å†³å®š</li>
<li>æ¡ˆä¾‹ä¸­ï¼Œ<code>TZ=Asia/Shanghai</code>æ˜¯è®¾ç½®æ—¶åŒºï¼›<code>MYSQL_ROOT_PASSWORD=123</code>æ˜¯è®¾ç½® MySQL é»˜è®¤å¯†ç </li>
</ul>
</li>
<li><code>mysql</code> : è®¾ç½®<strong>é•œåƒ</strong>åç§°ï¼ŒDocker ä¼šæ ¹æ®è¿™ä¸ªåå­—æœç´¢å¹¶ä¸‹è½½é•œåƒ<ul>
<li>æ ¼å¼ï¼š<code>REPOSITORY:TAG</code>ï¼Œä¾‹å¦‚<code>mysql:8.0</code>ï¼Œå…¶ä¸­<code>REPOSITORY</code>å¯ä»¥ç†è§£ä¸ºé•œåƒåï¼Œ<code>TAG</code>æ˜¯ç‰ˆæœ¬å·</li>
<li>åœ¨æœªæŒ‡å®š<code>TAG</code>çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯<code>mysql:latest</code></li>
</ul>
</li>
</ul>
<p>é•œåƒçš„åç§°<font color="red">ä¸æ˜¯éšæ„çš„</font>ï¼Œè€Œæ˜¯è¦åˆ° DockerRegistry ä¸­å¯»æ‰¾ï¼Œé•œåƒè¿è¡Œæ—¶çš„é…ç½®<font color="red">ä¹Ÿä¸æ˜¯éšæ„çš„</font>ï¼Œè¦å‚è€ƒé•œåƒçš„å¸®åŠ©æ–‡æ¡£ï¼Œè¿™äº›åœ¨DockerHub ç½‘ç«™æˆ–è€…è½¯ä»¶çš„å®˜æ–¹ç½‘ç«™ä¸­éƒ½èƒ½æ‰¾åˆ°ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¦å®‰è£…å…¶å®ƒè½¯ä»¶ï¼Œä¹Ÿå¯ä»¥åˆ° DockerRegistry ä¸­å¯»æ‰¾å¯¹åº”çš„é•œåƒåç§°å’Œç‰ˆæœ¬ï¼Œé˜…è¯»ç›¸å…³é…ç½®å³å¯ã€‚</p>
<h1 id="3-Docker-åŸºç¡€"><a href="#3-Docker-åŸºç¡€" class="headerlink" title="3. Docker åŸºç¡€"></a>3. Docker åŸºç¡€</h1><p> Docker ä½¿ç”¨çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ Docker å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/">https://docs.docker.com/</a></p>
<h2 id="3-1-é•œåƒæ“ä½œ"><a href="#3-1-é•œåƒæ“ä½œ" class="headerlink" title="3.1 é•œåƒæ“ä½œ"></a>3.1 é•œåƒæ“ä½œ</h2><h3 id="3-1-1-é•œåƒåç§°"><a href="#3-1-1-é•œåƒåç§°" class="headerlink" title="3.1.1 é•œåƒåç§°"></a>3.1.1 é•œåƒåç§°</h3><p>é¦–å…ˆæ¥çœ‹ä¸‹é•œåƒçš„åç§°ç»„æˆï¼š</p>
<ul>
<li>é•œåç§°ä¸€èˆ¬åˆ†ä¸¤éƒ¨åˆ†ç»„æˆï¼š[repository]:[tag]</li>
<li>åœ¨æ²¡æœ‰æŒ‡å®š tag æ—¶ï¼Œé»˜è®¤æ˜¯ latestï¼Œä»£è¡¨æœ€æ–°ç‰ˆæœ¬çš„é•œåƒ</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%95%9C%E5%83%8F%E5%90%8D%E7%A7%B0.png" style="zoom: 50%;">

<h3 id="3-1-2-é•œåƒç›¸å…³å‘½ä»¤"><a href="#3-1-2-é•œåƒç›¸å…³å‘½ä»¤" class="headerlink" title="3.1.2 é•œåƒç›¸å…³å‘½ä»¤"></a>3.1.2 é•œåƒç›¸å…³å‘½ä»¤</h3><p>å¸¸è§çš„é•œåƒæ“ä½œå‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‘½ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>æ–‡æ¡£åœ°å€</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">docker pull</td>
<td align="center">æ‹‰å–é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/pull/">docker pull</a></td>
</tr>
<tr>
<td align="center">docker push</td>
<td align="center">æ¨é€é•œåƒåˆ°DockerRegistry</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/push/">docker push</a></td>
</tr>
<tr>
<td align="center">docker images</td>
<td align="center">æŸ¥çœ‹æœ¬åœ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/images/">docker images</a></td>
</tr>
<tr>
<td align="center">docker rmi</td>
<td align="center">åˆ é™¤æœ¬åœ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/rmi/">docker rmi</a></td>
</tr>
<tr>
<td align="center">docker save</td>
<td align="center">ä¿å­˜é•œåƒåˆ°æœ¬åœ°å‹ç¼©æ–‡ä»¶</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/save/">docker save</a></td>
</tr>
<tr>
<td align="center">docker load</td>
<td align="center">åŠ è½½æœ¬åœ°å‹ç¼©æ–‡ä»¶åˆ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/load/">docker load</a></td>
</tr>
</tbody></table>
<p>ç”¨ä¸€å‰¯å›¾æ¥è¡¨ç¤ºè¿™äº›å‘½ä»¤çš„å…³ç³»ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4%E5%85%B3%E7%B3%BB%E5%9B%BE.png" style="zoom: 33%;">

<blockquote>
<p>æ¼”ç¤º</p>
</blockquote>
<p>1ã€å» DockerHub æŸ¥çœ‹ nginx é•œåƒä»“åº“åŠç›¸å…³ä¿¡æ¯</p>
<p>2ã€æ‹‰å–Nginxé•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥çœ‹é•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">mysql        latest    82563e0cbf18   45 hours ago   632MB</span><br><span class="line">nginx        latest    92b11f67642b   6 weeks ago    187MB</span><br></pre></td></tr></table></figure>

<p>4ã€å°† nginx é•œåƒå¯¼å‡ºç£ç›˜</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åˆ©ç”¨docker xx --<span class="built_in">help</span>å‘½ä»¤å¯ä»¥æŸ¥çœ‹docker saveå’Œdocker loadçš„è¯­æ³•ï¼Œä¾‹å¦‚ï¼ŒæŸ¥çœ‹saveå‘½ä»¤ç”¨æ³•ï¼Œå¯ä»¥è¾“å…¥å‘½ä»¤ï¼š</span></span><br><span class="line">docker save --help</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/docker%20save%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95.png"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘½ä»¤æ ¼å¼</span></span><br><span class="line">docker save -o [ä¿å­˜çš„ç›®æ ‡æ–‡ä»¶åç§°] [é•œåƒåç§°]</span><br></pre></td></tr></table></figure>

<p>5ã€å°† nginx é•œåƒå¯¼å‡ºç£ç›˜</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker save -o nginx.tar nginx:latest</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E5%B0%86nginx%E9%95%9C%E5%83%8F%E5%AF%BC%E5%87%BA%E7%A3%81%E7%9B%98.png"></p>
<p>6ã€ä½¿ç”¨ load åŠ è½½é•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…ˆåˆ é™¤æœ¬åœ°çš„nginxé•œåƒ</span></span><br><span class="line">docker rmi nginx:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç„¶åè¿è¡Œå‘½ä»¤ï¼ŒåŠ è½½æœ¬åœ°æ–‡ä»¶</span></span><br><span class="line">docker load -i nginx.tar</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E4%BD%BF%E7%94%A8docker%20load%E5%8A%A0%E8%BD%BD%E9%95%9C%E5%83%8F.png">

<h2 id="3-2-å®¹å™¨æ“ä½œ"><a href="#3-2-å®¹å™¨æ“ä½œ" class="headerlink" title="3.2 å®¹å™¨æ“ä½œ"></a>3.2 å®¹å™¨æ“ä½œ</h2><h3 id="3-2-1-å®¹å™¨ç›¸å…³å‘½ä»¤"><a href="#3-2-1-å®¹å™¨ç›¸å…³å‘½ä»¤" class="headerlink" title="3.2.1 å®¹å™¨ç›¸å…³å‘½ä»¤"></a>3.2.1 å®¹å™¨ç›¸å…³å‘½ä»¤</h3><p>å¸¸è§çš„å®¹å™¨æ“ä½œå‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‘½ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>æ–‡æ¡£åœ°å€</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">docker run</td>
<td align="center">åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨(ä¸èƒ½é‡å¤åˆ›å»º)</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/run/">docker run</a></td>
</tr>
<tr>
<td align="center">docker stop</td>
<td align="center">åœæ­¢æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/stop/">docker stop</a></td>
</tr>
<tr>
<td align="center">docker start</td>
<td align="center">å¯åŠ¨æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/start/">docker start</a></td>
</tr>
<tr>
<td align="center">docker restart</td>
<td align="center">é‡æ–°å¯åŠ¨å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/restart/">docker restart</a></td>
</tr>
<tr>
<td align="center">docker rm</td>
<td align="center">åˆ é™¤æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/rm/">docs.docker.com</a></td>
</tr>
<tr>
<td align="center">docker ps</td>
<td align="center">æŸ¥çœ‹å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/ps/">docker ps</a></td>
</tr>
<tr>
<td align="center">docker logs</td>
<td align="center">æŸ¥çœ‹å®¹å™¨è¿è¡Œæ—¥å¿—</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/logs/">docker logs</a></td>
</tr>
<tr>
<td align="center">docker exec</td>
<td align="center">è¿›å…¥å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/exec/">docker exec</a></td>
</tr>
<tr>
<td align="center">docker inspect</td>
<td align="center">æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/inspect/">docker inspect</a></td>
</tr>
</tbody></table>
<p>ç”¨ä¸€å‰¯å›¾æ¥è¡¨ç¤ºè¿™äº›å‘½ä»¤çš„å…³ç³»ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4%E5%85%B3%E7%B3%BB%E5%9B%BE.png" style="zoom: 33%;">

<p>å®¹å™¨ä¿æŠ¤ä¸‰ä¸ªçŠ¶æ€ï¼š</p>
<ul>
<li>è¿è¡Œï¼šè¿›ç¨‹æ­£å¸¸è¿è¡Œ</li>
<li>æš‚åœï¼šè¿›ç¨‹æš‚åœï¼ŒCPU ä¸å†è¿è¡Œï¼Œå¹¶ä¸é‡Šæ”¾å†…å­˜</li>
<li>åœæ­¢ï¼šè¿›ç¨‹ç»ˆæ­¢ï¼Œå›æ”¶è¿›ç¨‹å ç”¨çš„å†…å­˜ã€CPU ç­‰èµ„æº</li>
</ul>
<blockquote>
<p>æ¼”ç¤º</p>
</blockquote>
<p>1ã€åˆ›å»ºå¹¶è¿è¡Œ nginx å®¹å™¨çš„å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºå¹¶è¿è¡ŒNginxå®¹å™¨</span></span><br><span class="line">docker run -d --name nginx -p 80:80 nginx</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºæˆåŠŸåä¼šè¿”å›ä¸€ä¸²æ•°å­—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f37101c8fff6fddcc5fa8207a53af1799a281a6b26fc2cc4139964b5f73fc05e</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤è§£è¯»ï¼š</p>
<ul>
<li><code>docker run</code> ï¼šåˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªå®¹å™¨</li>
<li><code>-d</code>ï¼šåå°è¿è¡Œå®¹å™¨</li>
<li><code>--name</code> : ç»™å®¹å™¨èµ·ä¸€ä¸ªåå­—ï¼Œæ¯”å¦‚å«åš nginx</li>
<li><code>-p</code> ï¼šå°†å®¿ä¸»æœºç«¯å£ä¸å®¹å™¨ç«¯å£æ˜ å°„ï¼Œå†’å·å·¦ä¾§æ˜¯å®¿ä¸»æœºç«¯å£ï¼Œå³ä¾§æ˜¯å®¹å™¨ç«¯å£</li>
<li><code>nginx</code>ï¼šé•œåƒåç§°ï¼Œä¾‹å¦‚nginx</li>
</ul>
<p>è¿™é‡Œçš„ <code>-p</code> å‚æ•°ï¼Œæ˜¯å°†å®¹å™¨ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºç«¯å£ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨æ˜¯éš”ç¦»ç¯å¢ƒï¼Œæˆ‘ä»¬ç›´æ¥è®¿é—®å®¿ä¸»æœºçš„ 80 ç«¯å£ï¼Œè‚¯å®šè®¿é—®ä¸åˆ°å®¹å™¨ä¸­çš„ nginxã€‚</p>
<p>ç°åœ¨ï¼Œå°†å®¹å™¨çš„ 80 ä¸å®¿ä¸»æœºçš„ 80 å…³è”èµ·æ¥ï¼Œå½“æˆ‘ä»¬è®¿é—®å®¿ä¸»æœºçš„ 80 ç«¯å£æ—¶ï¼Œå°±ä¼šè¢«æ˜ å°„åˆ°å®¹å™¨çš„ 80ï¼Œè¿™æ ·å°±èƒ½è®¿é—®åˆ° nginx äº†ã€‚</p>
<p>2ã€æŸ¥çœ‹å®¹å™¨æ˜¯å¦è¿è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è¿è¡Œä¸­å®¹å™¨</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¹Ÿå¯ä»¥åŠ æ ¼å¼åŒ–æ–¹å¼è®¿é—®ï¼Œæ ¼å¼ä¼šæ›´åŠ æ¸…çˆ½</span></span><br><span class="line">docker ps --format &quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>æ ¼å¼åŒ–åæŸ¥çœ‹åˆ° nginxï¼Œè¯´æ˜å·²ç»è¿è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">CONTAINER ID   IMAGE     PORTS                                                  STATUS         NAMES</span><br><span class="line">f37101c8fff6   nginx     0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp                      Up 2 minutes   nginx</span><br><span class="line">9e617ee3fdb5   mysql     0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   Up 2 hours     mysql</span><br></pre></td></tr></table></figure>

<p>3ã€åœæ‰å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker stop nginx</span><br></pre></td></tr></table></figure>

<p>4ã€åœæ‰å®¹å™¨åå†æ¬¡æ‰§è¡Œ <code>docker ps</code> å°±çœ‹ä¸åˆ° nginx äº†ï¼Œéœ€è¦ä½¿ç”¨ <code>-a</code> å‚æ•°æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">docker ps -a --format &quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç° nginx çš„ <code>STATUS</code> å˜ä¸ºäº† <code>Exited (0)</code> ï¼Œè¡¨ç¤ºå·²ç»åœæ‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">CONTAINER ID   IMAGE     PORTS                                                  STATUS                     NAMES</span><br><span class="line">f37101c8fff6   nginx                                                            Exited (0) 2 minutes ago   nginx</span><br><span class="line">9e617ee3fdb5   mysql     0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   Up 2 hours                 mysql</span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨ nginx å®¹å™¨ï¼Œå†æ¬¡æ‰§è¡Œ <code>docker ps</code> æŸ¥çœ‹è¿è¡Œä¸­å®¹å™¨å°±ä¼šå‘ç° nginx åˆè¿è¡Œèµ·æ¥äº†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨nginxå®¹å™¨</span></span><br><span class="line">docker start nginx</span><br></pre></td></tr></table></figure>

<p>6ã€æŸ¥çœ‹ nginx å®¹å™¨æ—¥å¿—</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker logs nginx  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯ä»¥åŠ  -f å‚æ•°ï¼Œä¸€ç›´æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">docker logs -f nginx</span><br></pre></td></tr></table></figure>

<p>7ã€è¿›å…¥å®¹å™¨</p>
<p>(1) è¿›å…¥æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ nginx å®¹å™¨ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it nginx bash</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤è§£è¯»ï¼š</p>
<ul>
<li><p><code>docker exec</code> ï¼šè¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œæ‰§è¡Œä¸€ä¸ªå‘½ä»¤</p>
</li>
<li><p><code>-it</code> : ç»™å½“å‰è¿›å…¥çš„å®¹å™¨åˆ›å»ºä¸€ä¸ªæ ‡å‡†è¾“å…¥ã€è¾“å‡ºç»ˆç«¯ï¼Œå…è®¸æˆ‘ä»¬ä¸å®¹å™¨äº¤äº’</p>
</li>
<li><p><code>nginx</code> ï¼šè¦è¿›å…¥çš„å®¹å™¨çš„åç§°</p>
</li>
<li><p><code>bash</code> ï¼šè¿›å…¥å®¹å™¨åæ‰§è¡Œçš„å‘½ä»¤ï¼Œbashæ˜¯ä¸€ä¸ªlinuxç»ˆç«¯äº¤äº’å‘½ä»¤</p>
</li>
</ul>
<p>è¿›å…¥ nginx çš„ HTML æ‰€åœ¨ç›®å½• &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;htmlï¼Œå®¹å™¨å†…éƒ¨ä¼šæ¨¡æ‹Ÿä¸€ä¸ªç‹¬ç«‹çš„ Linux æ–‡ä»¶ç³»ç»Ÿï¼Œçœ‹èµ·æ¥å¦‚åŒä¸€ä¸ª Linux æœåŠ¡å™¨ä¸€æ ·ã€‚nginx çš„ç¯å¢ƒã€é…ç½®ã€è¿è¡Œæ–‡ä»¶å…¨éƒ¨éƒ½åœ¨è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒåŒ…æ‹¬æˆ‘ä»¬è¦ä¿®æ”¹çš„ html æ–‡ä»¶ã€‚</p>
<p>(2) æŸ¥çœ‹ DockerHub ç½‘ç«™ä¸­çš„ nginx é¡µé¢ï¼Œå¯ä»¥çŸ¥é“ nginx çš„ html ç›®å½•ä½ç½®åœ¨ <code>/usr/share/nginx/html</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥ç›®å½•</span></span><br><span class="line">cd /usr/share/nginx/html</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/nginx%E7%9A%84html%E7%9B%AE%E5%BD%95%E5%9C%A8%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE.png"></p>
<p>(3) ä¿®æ”¹ index.html çš„å†…å®¹</p>
<p>å®¹å™¨å†…æ²¡æœ‰ vi å‘½ä»¤ï¼Œæ— æ³•ç›´æ¥ä¿®æ”¹ï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥ä¿®æ”¹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sed -i -e <span class="string">&#x27;s#Welcome to nginx#æœ¨åˆæ¯äº†#g&#x27;</span> -e <span class="string">&#x27;s#&lt;head&gt;#&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;#g&#x27;</span> index.html</span><br></pre></td></tr></table></figure>

<p>åœ¨æµè§ˆå™¨è®¿é—®è‡ªå·±çš„è™šæ‹Ÿæœºåœ°å€ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯ï¼š<a href="http://192.168.88.132ï¼Œå³å¯çœ‹åˆ°ç»“æœï¼š">http://192.168.88.132ï¼Œå³å¯çœ‹åˆ°ç»“æœï¼š</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84nginx%E9%A1%B5%E9%9D%A2.png"></p>
<p>8ã€åˆ é™¤å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker rm nginx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘ç°æ— æ³•åˆ é™¤ï¼Œå› ä¸ºå®¹å™¨è¿è¡Œä¸­ï¼Œå¼ºåˆ¶åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker rm -f nginx</span><br></pre></td></tr></table></figure>

<h2 id="3-3-å¸¸è§å‘½ä»¤æ€»ç»“"><a href="#3-3-å¸¸è§å‘½ä»¤æ€»ç»“" class="headerlink" title="3.3 å¸¸è§å‘½ä»¤æ€»ç»“"></a>3.3 å¸¸è§å‘½ä»¤æ€»ç»“</h2><p>Docker ä¸­çš„å¸¸è§å‘½ä»¤ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/engine/reference/commandline/cli/">https://docs.docker.com/engine/reference/commandline/cli/</a></p>
<h3 id="3-3-1-å‘½ä»¤ä»‹ç»"><a href="#3-3-1-å‘½ä»¤ä»‹ç»" class="headerlink" title="3.3.1 å‘½ä»¤ä»‹ç»"></a>3.3.1 å‘½ä»¤ä»‹ç»</h3><p>å…¶ä¸­ï¼Œæ¯”è¾ƒå¸¸è§çš„å‘½ä»¤æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‘½ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>æ–‡æ¡£åœ°å€</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">docker pull</td>
<td align="center">æ‹‰å–é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/pull/">docker pull</a></td>
</tr>
<tr>
<td align="center">docker push</td>
<td align="center">æ¨é€é•œåƒåˆ°DockerRegistry</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/push/">docker push</a></td>
</tr>
<tr>
<td align="center">docker images</td>
<td align="center">æŸ¥çœ‹æœ¬åœ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/images/">docker images</a></td>
</tr>
<tr>
<td align="center">docker rmi</td>
<td align="center">åˆ é™¤æœ¬åœ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/rmi/">docker rmi</a></td>
</tr>
<tr>
<td align="center">docker run</td>
<td align="center">åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨(ä¸èƒ½é‡å¤åˆ›å»º)</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/run/">docker run</a></td>
</tr>
<tr>
<td align="center">docker stop</td>
<td align="center">åœæ­¢æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/stop/">docker stop</a></td>
</tr>
<tr>
<td align="center">docker start</td>
<td align="center">å¯åŠ¨æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/start/">docker start</a></td>
</tr>
<tr>
<td align="center">docker restart</td>
<td align="center">é‡æ–°å¯åŠ¨å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/restart/">docker restart</a></td>
</tr>
<tr>
<td align="center">docker rm</td>
<td align="center">åˆ é™¤æŒ‡å®šå®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/rm/">docs.docker.com</a></td>
</tr>
<tr>
<td align="center">docker ps</td>
<td align="center">æŸ¥çœ‹å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/ps/">docker ps</a></td>
</tr>
<tr>
<td align="center">docker logs</td>
<td align="center">æŸ¥çœ‹å®¹å™¨è¿è¡Œæ—¥å¿—</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/logs/">docker logs</a></td>
</tr>
<tr>
<td align="center">docker exec</td>
<td align="center">è¿›å…¥å®¹å™¨</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/exec/">docker exec</a></td>
</tr>
<tr>
<td align="center">docker save</td>
<td align="center">ä¿å­˜é•œåƒåˆ°æœ¬åœ°å‹ç¼©æ–‡ä»¶</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/save/">docker save</a></td>
</tr>
<tr>
<td align="center">docker load</td>
<td align="center">åŠ è½½æœ¬åœ°å‹ç¼©æ–‡ä»¶åˆ°é•œåƒ</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/load/">docker load</a></td>
</tr>
<tr>
<td align="center">docker inspect</td>
<td align="center">æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/inspect/">docker inspect</a></td>
</tr>
</tbody></table>
<p>ç”¨ä¸€å‰¯å›¾æ¥è¡¨ç¤ºè¿™äº›å‘½ä»¤çš„å…³ç³»ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E5%85%B3%E7%B3%BB%E5%9B%BE.png"></p>
<p>PSï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯æ¬¡é‡å¯è™šæ‹Ÿæœºæˆ‘ä»¬éƒ½éœ€è¦æ‰‹åŠ¨å¯åŠ¨ Docker å’Œ Docker ä¸­çš„å®¹å™¨ã€‚é€šè¿‡å‘½ä»¤å¯ä»¥å®ç°å¼€æœºè‡ªå¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Dockerå¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Dockerå®¹å™¨å¼€æœºè‡ªå¯</span></span><br><span class="line">docker update --restart=always [å®¹å™¨å/å®¹å™¨id]</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2-å‘½ä»¤åˆ«å"><a href="#3-3-2-å‘½ä»¤åˆ«å" class="headerlink" title="3.3.2 å‘½ä»¤åˆ«å"></a>3.3.2 å‘½ä»¤åˆ«å</h3><p>ç»™å¸¸ç”¨ Docker å‘½ä»¤èµ·åˆ«åï¼Œæ–¹ä¾¿æˆ‘ä»¬è®¿é—®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹/root/.bashrcæ–‡ä»¶</span></span><br><span class="line">vi /root/.bashrc</span><br></pre></td></tr></table></figure>

<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># .bashrc</span><br><span class="line"></span><br><span class="line"># User specific aliases and functions</span><br><span class="line"></span><br><span class="line">alias rm=&#x27;rm -i&#x27;</span><br><span class="line">alias cp=&#x27;cp -i&#x27;</span><br><span class="line">alias mv=&#x27;mv -i&#x27;</span><br><span class="line">alias dps=&#x27;docker ps --format &quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;&#x27;</span><br><span class="line">alias dis=&#x27;docker images&#x27;</span><br><span class="line"></span><br><span class="line"># Source global definitions</span><br><span class="line">if [ -f /etc/bashrc ]; then</span><br><span class="line">        . /etc/bashrc</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæ‰§è¡Œå‘½ä»¤ä½¿åˆ«åç”Ÿæ•ˆ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /root/.bashrc</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ï¼Œè¯•è¯•çœ‹æ–°çš„å‘½ä»¤å§ã€‚</p>
<h2 id="3-4-æ•°æ®å·-volume"><a href="#3-4-æ•°æ®å·-volume" class="headerlink" title="3.4 æ•°æ®å·(volume)"></a>3.4 æ•°æ®å·(volume)</h2><p>å®¹å™¨æ˜¯éš”ç¦»ç¯å¢ƒï¼Œå®¹å™¨å†…ç¨‹åºçš„æ–‡ä»¶ã€é…ç½®ã€è¿è¡Œæ—¶äº§ç”Ÿçš„å®¹å™¨éƒ½åœ¨å®¹å™¨å†…éƒ¨ï¼Œæˆ‘ä»¬è¦è¯»å†™å®¹å™¨å†…çš„æ–‡ä»¶éå¸¸ä¸æ–¹ä¾¿ã€‚å¤§å®¶æ€è€ƒå‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¦‚æœè¦å‡çº§ MySQL ç‰ˆæœ¬ï¼Œéœ€è¦é”€æ¯æ—§å®¹å™¨ï¼Œé‚£ä¹ˆæ•°æ®å²‚ä¸æ˜¯è·Ÿç€è¢«é”€æ¯äº†ï¼Ÿ</li>
<li>MySQLã€Nginx å®¹å™¨è¿è¡Œåï¼Œå¦‚æœæˆ‘è¦ä¿®æ”¹å…¶ä¸­çš„æŸäº›é…ç½®è¯¥æ€ä¹ˆåŠï¼Ÿ</li>
<li>æˆ‘æƒ³è¦è®© Nginx ä»£ç†æˆ‘çš„é™æ€èµ„æºæ€ä¹ˆåŠï¼Ÿ</li>
</ul>
<p>å› æ­¤ï¼Œå®¹å™¨æä¾›ç¨‹åºçš„è¿è¡Œç¯å¢ƒï¼Œä½†æ˜¯<strong>ç¨‹åºè¿è¡Œäº§ç”Ÿçš„æ•°æ®ã€ç¨‹åºè¿è¡Œä¾èµ–çš„é…ç½®éƒ½åº”è¯¥ä¸å®¹å™¨è§£è€¦</strong>ã€‚</p>
<h3 id="3-4-1-ä»€ä¹ˆæ˜¯æ•°æ®å·"><a href="#3-4-1-ä»€ä¹ˆæ˜¯æ•°æ®å·" class="headerlink" title="3.4.1 ä»€ä¹ˆæ˜¯æ•°æ®å·"></a>3.4.1 ä»€ä¹ˆæ˜¯æ•°æ®å·</h3><p><strong>æ•°æ®å·</strong>æ˜¯ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼Œæ˜¯<strong>å®¹å™¨å†…ç›®å½•</strong> <strong>å®¿ä¸»æœºç›®å½•</strong>ä¹‹é—´æ˜ å°„çš„æ¡¥æ¢ã€‚</p>
<p>ä»¥ Nginx ä¸ºä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“ Nginx ä¸­æœ‰ä¸¤ä¸ªå…³é”®çš„ç›®å½•ï¼š</p>
<ul>
<li><code>html</code>ï¼šæ”¾ç½®ä¸€äº›é™æ€èµ„æº</li>
<li><code>conf</code>ï¼šæ”¾ç½®é…ç½®æ–‡ä»¶</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬è¦è®© Nginx ä»£ç†æˆ‘ä»¬çš„é™æ€èµ„æºï¼Œæœ€å¥½æ˜¯æ”¾åˆ° <code>html</code> ç›®å½•ï¼›å¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹ Nginx çš„é…ç½®ï¼Œæœ€å¥½æ˜¯æ‰¾åˆ° <code>conf</code> ä¸‹çš„<code>nginx.conf</code>æ–‡ä»¶ã€‚</p>
<p>ä½†é—æ†¾çš„æ˜¯ï¼Œå®¹å™¨è¿è¡Œçš„ Nginx æ‰€æœ‰çš„æ–‡ä»¶éƒ½åœ¨å®¹å™¨å†…éƒ¨ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åˆ©ç”¨æ•°æ®å·å°†ä¸¤ä¸ªç›®å½•ä¸å®¿ä¸»æœºç›®å½•å…³è”ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ“ä½œã€‚å¦‚å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%B0%86nginx%E4%B8%A4%E4%B8%AA%E7%9B%AE%E5%BD%95%E4%B8%8E%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95%E5%85%B3%E8%81%94.png" style="zoom: 50%;">

<p>åœ¨ä¸Šå›¾ä¸­ï¼š</p>
<ul>
<li>æˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ•°æ®å·ï¼š<code>conf</code>ã€<code>html</code></li>
<li>Nginx å®¹å™¨å†…éƒ¨çš„ <code>conf</code> ç›®å½•å’Œ <code>html</code> ç›®å½•åˆ†åˆ«ä¸ä¸¤ä¸ªæ•°æ®å·å…³è”ã€‚</li>
<li>è€Œæ•°æ®å· conf å’Œ html åˆ†åˆ«æŒ‡å‘äº†å®¿ä¸»æœºçš„ <code>/var/lib/docker/volumes/conf/_data</code> ç›®å½•å’Œ <code>/var/lib/docker/volumes/html/_data</code> ç›®å½•</li>
</ul>
<p>è¿™æ ·ä»¥æ¥ï¼Œå®¹å™¨å†…çš„ <code>conf</code>å’Œ<code>html</code> ç›®å½•å°± ä¸å®¿ä¸»æœºçš„ <code>conf</code> å’Œ <code>html</code> ç›®å½•å…³è”èµ·æ¥ï¼Œæˆ‘ä»¬ç§°ä¸º<strong>æŒ‚è½½</strong>ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬æ“ä½œå®¿ä¸»æœºçš„ <code>/var/lib/docker/volumes/html/_data</code> å°±æ˜¯åœ¨æ“ä½œå®¹å™¨å†…çš„ <code>/usr/share/nginx/html/_data</code>ç›®å½•ã€‚åªè¦æˆ‘ä»¬å°†é™æ€èµ„æºæ”¾å…¥å®¿ä¸»æœºå¯¹åº”ç›®å½•ï¼Œå°±å¯ä»¥è¢« Nginx ä»£ç†äº†ã€‚</p>
<blockquote>
<p>å°æç¤ºğŸ˜ƒ</p>
</blockquote>
<p><code>/var/lib/docker/volumes</code>è¿™ä¸ªç›®å½•å°±æ˜¯é»˜è®¤çš„å­˜æ”¾æ‰€æœ‰å®¹å™¨æ•°æ®å·çš„ç›®å½•ï¼Œå…¶ä¸‹å†æ ¹æ®æ•°æ®å·åç§°åˆ›å»ºæ–°ç›®å½•ï¼Œæ ¼å¼ä¸º<code>/æ•°æ®å·å/_data</code>ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸è®©å®¹å™¨ç›®å½•ç›´æ¥æŒ‡å‘å®¿ä¸»æœºç›®å½•å‘¢ï¼Ÿ</p>
<p>å› ä¸ºç›´æ¥æŒ‡å‘å®¿ä¸»æœºç›®å½•å°±ä¸å®¿ä¸»æœºå¼ºè€¦åˆäº†ï¼Œå¦‚æœåˆ‡æ¢äº†ç¯å¢ƒï¼Œå®¿ä¸»æœºç›®å½•å°±å¯èƒ½å‘ç”Ÿæ”¹å˜äº†ã€‚ç”±äºå®¹å™¨ä¸€æ—¦åˆ›å»ºï¼Œç›®å½•æŒ‚è½½å°±æ— æ³•ä¿®æ”¹ï¼Œè¿™æ ·å®¹å™¨å°±æ— æ³•æ­£å¸¸å·¥ä½œäº†ã€‚</p>
<p>ä½†æ˜¯å®¹å™¨æŒ‡å‘æ•°æ®å·ï¼Œä¸€ä¸ªé€»è¾‘åç§°ï¼Œè€Œæ•°æ®å·å†æŒ‡å‘å®¿ä¸»æœºç›®å½•ï¼Œå°±ä¸å­˜åœ¨å¼ºè€¦åˆã€‚å¦‚æœå®¿ä¸»æœºç›®å½•å‘ç”Ÿæ”¹å˜ï¼Œåªè¦æ”¹å˜æ•°æ®å·ä¸å®¿ä¸»æœºç›®å½•ä¹‹é—´çš„æ˜ å°„å…³ç³»å³å¯ã€‚</p>
<p>ä¸è¿‡ï¼Œæˆ‘ä»¬é€šè¿‡ç”±äºæ•°æ®å·ç›®å½•æ¯”è¾ƒæ·±ï¼Œä¸å¥½å¯»æ‰¾ï¼Œé€šå¸¸æˆ‘ä»¬ä¹Ÿ<strong>å…è®¸è®©å®¹å™¨ç›´æ¥ä¸å®¿ä¸»æœºç›®å½•æŒ‚è½½è€Œä¸ä½¿ç”¨æ•°æ®å·</strong>ã€‚</p>
<h3 id="3-4-2-æ•°æ®å·å‘½ä»¤"><a href="#3-4-2-æ•°æ®å·å‘½ä»¤" class="headerlink" title="3.4.2 æ•°æ®å·å‘½ä»¤"></a>3.4.2 æ•°æ®å·å‘½ä»¤</h3><p>æ•°æ®å·çš„ç›¸å…³å‘½ä»¤æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‘½ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>æ–‡æ¡£åœ°å€</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">docker volume create</td>
<td align="center">åˆ›å»ºæ•°æ®å·</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/volume_create/">docker volume create</a></td>
</tr>
<tr>
<td align="center">docker volume ls</td>
<td align="center">æŸ¥çœ‹æ‰€æœ‰æ•°æ®å·</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/volume_ls/">docs.docker.com</a></td>
</tr>
<tr>
<td align="center">docker volume rm</td>
<td align="center">åˆ é™¤æŒ‡å®šæ•°æ®å·</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/volume_prune/">docs.docker.com</a></td>
</tr>
<tr>
<td align="center">docker volume inspect</td>
<td align="center">æŸ¥çœ‹æŸä¸ªæ•°æ®å·çš„è¯¦æƒ…</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/volume_inspect/">docs.docker.com</a></td>
</tr>
<tr>
<td align="center">docker volume prune</td>
<td align="center">æ¸…é™¤æ•°æ®å·</td>
<td align="center"><a href="https://docs.docker.com/engine/reference/commandline/volume_prune/">docker volume prune</a></td>
</tr>
</tbody></table>
<p>åœ¨æ‰§è¡Œdocker runå‘½ä»¤æ—¶ï¼Œä½¿ç”¨ <code>-v æ•°æ®å·:å®¹å™¨å†…ç›®å½•</code> å¯ä»¥å®Œæˆæ•°æ®å·æŒ‚è½½ã€‚å½“åˆ›å»ºå®¹å™¨æ—¶ï¼Œå¦‚æœæŒ‚è½½äº†æ•°æ®å·ä¸”æ•°æ®å·ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®å·ã€‚</p>
<p><font color="red">PSï¼šæŒ‚è½½çš„åŠ¨ä½œä¸€å®šæ˜¯åœ¨docker run(å®¹å™¨åˆ›å»º)çš„æ—¶å€™æ‰§è¡Œï¼Œå®¹å™¨ä¸€æ—¦å·²ç»åˆ›å»ºæ˜¯æ²¡æœ‰åŠæ³•å†å»æŒ‚è½½çš„ï¼ï¼</font>ğŸ˜‰</p>
<blockquote>
<p>æ¼”ç¤º Nginx çš„ html ç›®å½•æŒ‚è½½</p>
</blockquote>
<p>1ã€åˆ›å»ºå®¹å™¨å¹¶æŒ‡å®šæ•°æ®å·ï¼Œæ³¨æ„é€šè¿‡ <code>-v</code> å‚æ•°æ¥æŒ‡å®šæ•°æ®å·</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d --name nginx -p 80:80 -v html:/usr/share/nginx/html nginx</span><br></pre></td></tr></table></figure>

<p>2ã€æŸ¥çœ‹æ•°æ®å·</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker volume ls</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     b388dcff529dd819f25d271e22f5b1438a12afc5afb5069228230b64b8d8e98a</span><br><span class="line">local     html</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥çœ‹æ•°æ®å·è¯¦æƒ…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker volume inspect html</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2024-03-27T22:58:31-07:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/html/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;html&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>4ã€æŸ¥çœ‹ &#x2F;var&#x2F;lib&#x2F;docker&#x2F;volumes&#x2F;html&#x2F;_data ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ll /var/lib/docker/volumes/html/_data</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ä¸nginxçš„htmlç›®å½•å†…å®¹ä¸€æ ·ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">total 8</span><br><span class="line">-rw-r--r--. 1 root root 497 Feb 14 08:03 50x.html</span><br><span class="line">-rw-r--r--. 1 root root 615 Feb 14 08:03 index.html</span><br></pre></td></tr></table></figure>

<p>5ã€è¿›å…¥è¯¥ç›®å½•ï¼Œå¹¶éšæ„ä¿®æ”¹index.htmlå†…å®¹ï¼Œä¿®æ”¹åæ‰“å¼€é¡µé¢ï¼ŒæŸ¥çœ‹æ•ˆæœ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /var/lib/docker/volumes/html/_data</span><br><span class="line">vim index.html</span><br></pre></td></tr></table></figure>

<p>6ã€è¿›å…¥å®¹å™¨å†…éƒ¨ï¼ŒæŸ¥çœ‹ &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html ç›®å½•å†…çš„æ–‡ä»¶æ˜¯å¦å˜åŒ–</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -it nginx bash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¼”ç¤º MySQL çš„åŒ¿åæ•°æ®å·</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹MySQLå®¹å™¨è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">docker inspect mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…³æ³¨å…¶ä¸­.Config.Volumeséƒ¨åˆ†å’Œ.Mountséƒ¨åˆ†</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å…³æ³¨ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œç¬¬ä¸€æ˜¯<code>.Config.Volumes</code>éƒ¨åˆ†ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Config&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... ç•¥</span></span><br><span class="line">    <span class="attr">&quot;Volumes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;/var/lib/mysql&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="comment">// ... ç•¥</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°è¿™ä¸ªå®¹å™¨å£°æ˜äº†ä¸€ä¸ªæœ¬åœ°ç›®å½•ï¼Œéœ€è¦æŒ‚è½½æ•°æ®å·ï¼Œä½†æ˜¯<strong>æ•°æ®å·æœªå®šä¹‰</strong>ã€‚è¿™å°±æ˜¯åŒ¿åå·ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å†çœ‹ç»“æœä¸­çš„<code>.Mounts</code>éƒ¨åˆ†ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Mounts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;volume&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/lib/mysql&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Driver&quot;</span><span class="punctuation">:</span> <span class="string">&quot;local&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªå…³é”®å±æ€§ï¼š</p>
<ul>
<li>Nameï¼šæ•°æ®å·åç§°ã€‚ç”±äºå®šä¹‰å®¹å™¨æœªè®¾ç½®å®¹å™¨åï¼Œè¿™é‡Œçš„å°±æ˜¯åŒ¿åå·è‡ªåŠ¨ç”Ÿæˆçš„åå­—ï¼Œä¸€ä¸²hashå€¼ã€‚</li>
<li>Sourceï¼šå®¿ä¸»æœºç›®å½•</li>
<li>Destination : å®¹å™¨å†…çš„ç›®å½•</li>
</ul>
<p>ä¸Šè¿°é…ç½®æ˜¯å°†å®¹å™¨å†…çš„<code>/var/lib/mysql</code>è¿™ä¸ªç›®å½•ï¼Œä¸æ•°æ®å·<code>29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f</code>æŒ‚è½½ã€‚äºæ˜¯åœ¨å®¿ä¸»æœºä¸­å°±æœ‰äº†<code>/var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data</code>è¿™ä¸ªç›®å½•ã€‚è¿™å°±æ˜¯åŒ¿åæ•°æ®å·å¯¹åº”çš„ç›®å½•ï¼Œå…¶ä½¿ç”¨æ–¹å¼ä¸æ™®é€šæ•°æ®å·æ²¡æœ‰å·®åˆ«ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥ç›®å½•ä¸‹çš„MySQLçš„dataæ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /var/lib/docker/volumes/29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f/_data</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šæ¯ä¸€ä¸ªä¸åŒçš„é•œåƒï¼Œå°†æ¥åˆ›å»ºå®¹å™¨åå†…éƒ¨æœ‰å“ªäº›ç›®å½•å¯ä»¥æŒ‚è½½ï¼Œå¯ä»¥å‚è€ƒDockerHubå¯¹åº”çš„é¡µé¢ã€‚</p>
<h3 id="3-4-3-æŒ‚è½½æœ¬åœ°ç›®å½•æˆ–æ–‡ä»¶"><a href="#3-4-3-æŒ‚è½½æœ¬åœ°ç›®å½•æˆ–æ–‡ä»¶" class="headerlink" title="3.4.3 æŒ‚è½½æœ¬åœ°ç›®å½•æˆ–æ–‡ä»¶"></a>3.4.3 æŒ‚è½½æœ¬åœ°ç›®å½•æˆ–æ–‡ä»¶</h3><p>å¯ä»¥å‘ç°ï¼Œæ•°æ®å·çš„ç›®å½•ç»“æ„è¾ƒæ·±ï¼Œå¦‚æœæˆ‘ä»¬å»æ“ä½œæ•°æ®å·ç›®å½•ä¼šä¸å¤ªæ–¹ä¾¿ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šç›´æ¥å°†å®¹å™¨ç›®å½•ä¸å®¿ä¸»æœºæŒ‡å®šç›®å½•æŒ‚è½½ã€‚æŒ‚è½½è¯­æ³•ä¸æ•°æ®å·ç±»ä¼¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‚è½½æœ¬åœ°ç›®å½•</span></span><br><span class="line">-v æœ¬åœ°ç›®å½•:å®¹å™¨å†…ç›®å½•</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‚è½½æœ¬åœ°æ–‡ä»¶</span></span><br><span class="line">-v æœ¬åœ°æ–‡ä»¶:å®¹å™¨å†…æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>PSï¼šæœ¬åœ°ç›®å½•æˆ–æ–‡ä»¶å¿…é¡»ä»¥ <code>/</code> æˆ– <code>./</code>å¼€å¤´ï¼Œå¦‚æœç›´æ¥ä»¥åå­—å¼€å¤´ï¼Œä¼šè¢«è¯†åˆ«ä¸ºæ•°æ®å·åè€Œéæœ¬åœ°ç›®å½•åã€‚</strong></font>ğŸ˜„ğŸ˜„ğŸ˜„ ä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¼šè¢«è¯†åˆ«ä¸ºä¸€ä¸ªæ•°æ®å·å«mysqlï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªæ•°æ®å·</span></span><br><span class="line">-v mysql:/var/lib/mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼šè¢«è¯†åˆ«ä¸ºå½“å‰ç›®å½•ä¸‹çš„mysqlç›®å½•ï¼Œè¿è¡Œæ—¶å¦‚æœä¸å­˜åœ¨ä¼šåˆ›å»ºç›®å½•</span></span><br><span class="line">-v ./mysql:/var/lib/mysql</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¼”ç¤ºåŸºäºå®¿ä¸»æœºç›®å½•å®ç° MySQL æ•°æ®ç›®å½•ã€é…ç½®æ–‡ä»¶ã€åˆå§‹åŒ–è„šæœ¬çš„æŒ‚è½½(æŸ¥é˜…å®˜æ–¹é•œåƒæ–‡æ¡£)ï¼š</p>
</blockquote>
<ul>
<li>æŒ‚è½½<code>/root/mysql/data</code>åˆ°å®¹å™¨å†…çš„<code>/var/lib/mysql</code>ç›®å½•</li>
<li>æŒ‚è½½<code>/root/mysql/init</code>åˆ°å®¹å™¨å†…çš„<code>/docker-entrypoint-initdb.d</code>ç›®å½•(åˆå§‹åŒ–çš„SQLè„šæœ¬ç›®å½•)</li>
<li>æŒ‚è½½<code>/root/mysql/conf</code>åˆ°å®¹å™¨å†…çš„<code>/etc/mysql/conf.d</code>ç›®å½•(è¿™ä¸ªæ˜¯MySQLé…ç½®æ–‡ä»¶ç›®å½•)</li>
</ul>
<p>å‡†å¤‡å¥½äº† mysql çš„åˆå§‹åŒ– SQL è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œåœ¨åˆ›å»º mysql å®¹å™¨åï¼Œä¸Šä¼ åˆ°å¯¹åº”æŒ‚è½½çš„æœ¬åœ°ç›®å½•ã€‚</p>
<p>å…¶ä¸­ï¼Œhm.cnf ä¸»è¦æ˜¯é…ç½®äº† MySQL çš„é»˜è®¤ç¼–ç ï¼Œæ”¹ä¸º utf8mb4ï¼›è€Œ hmall.sql åˆ™æ˜¯é»‘é©¬å•†åŸé¡¹ç›®çš„åˆå§‹åŒ– SQL è„šæœ¬ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¼”ç¤ºæœ¬åœ°ç›®å½•æŒ‚è½½ï¼š</p>
<p>1ã€åˆ é™¤åŸæ¥çš„ MySQL å®¹å™¨ï¼Œè¿›å…¥ root ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker rm -f mysql</span><br><span class="line">cd ~</span><br></pre></td></tr></table></figure>

<p>2ã€åˆ›å»ºå¹¶è¿è¡Œæ–° mysql å®¹å™¨ï¼ŒæŒ‚è½½æœ¬åœ°ç›®å½•(<strong>æ³¨æ„æŒ‚è½½çš„ç›®å½•æƒé™ï¼Œæƒé™ä¸è¶³ä¼šå¯¼è‡´æŒ‚è½½çš„ç›®å½•æ–‡ä»¶ä¸ç”Ÿæ•ˆ</strong>)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name mysql \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=123 \</span><br><span class="line">  -v ./mysql/data:/var/lib/mysql \</span><br><span class="line">  -v ./mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">  -v ./mysql/init:/docker-entrypoint-initdb.d \</span><br><span class="line">  mysql</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥çœ‹ root ç›®å½•ï¼Œå¯ä»¥å‘ç° ~&#x2F;mysql&#x2F;data ç›®å½•å·²ç»è‡ªåŠ¨åˆ›å»ºå¥½äº†</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls -l mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹dataç›®å½•ï¼Œä¼šå‘ç°é‡Œé¢æœ‰å¤§é‡æ•°æ®åº“æ•°æ®ï¼Œè¯´æ˜æ•°æ®åº“å®Œæˆäº†åˆå§‹åŒ–</span></span><br><span class="line">ls -l data</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ€»ç”¨é‡ 4</span><br><span class="line">drwxr-xr-x. 2 root    root   20 5æœˆ  19 15:11 conf</span><br><span class="line">drwxr-xr-x. 7 polkitd root 4096 5æœˆ  19 15:11 data</span><br><span class="line">drwxr-xr-x. 2 root    root   23 5æœˆ  19 15:11 init</span><br></pre></td></tr></table></figure>

<p>4ã€æŸ¥çœ‹MySQLå®¹å™¨å†…æ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥MySQL</span></span><br><span class="line">docker exec -it mysql mysql -uroot -p123</span><br></pre></td></tr></table></figure>

<p>(1) æŸ¥çœ‹ç¼–ç è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show variables like &quot;%char%&quot;;</span><br></pre></td></tr></table></figure>

<p>ç¼–ç æ˜¯ utf8mb4 åˆ™æ²¡æœ‰é—®é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------------------+--------------------------------+</span><br><span class="line">| Variable_name            | Value                          |</span><br><span class="line">+--------------------------+--------------------------------+</span><br><span class="line">| character_set_client     | utf8mb4                        |</span><br><span class="line">| character_set_connection | utf8mb4                        |</span><br><span class="line">| character_set_database   | utf8mb4                        |</span><br><span class="line">| character_set_filesystem | binary                         |</span><br><span class="line">| character_set_results    | utf8mb4                        |</span><br><span class="line">| character_set_server     | utf8mb4                        |</span><br><span class="line">| character_set_system     | utf8mb3                        |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql-8.0/charsets/ |</span><br><span class="line">+--------------------------+--------------------------------+</span><br></pre></td></tr></table></figure>

<p>(2) æŸ¥çœ‹æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p>ç»“æœæŸ¥çœ‹åˆ° hmall é»‘é©¬å•†åŸæ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| hmall              |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br></pre></td></tr></table></figure>

<p>(3) åˆ‡æ¢åˆ° hmall æ•°æ®åº“ï¼ŒæŸ¥çœ‹è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use hmall;</span><br><span class="line">show tables;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+-----------------+</span><br><span class="line">| Tables_in_hmall |</span><br><span class="line">+-----------------+</span><br><span class="line">| address         |</span><br><span class="line">| cart            |</span><br><span class="line">| item            |</span><br><span class="line">| order           |</span><br><span class="line">| order_detail    |</span><br><span class="line">| order_logistics |</span><br><span class="line">| pay_order       |</span><br><span class="line">| user            |</span><br><span class="line">+-----------------+</span><br></pre></td></tr></table></figure>

<p>(4) æŸ¥çœ‹ address è¡¨æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+</span><br><span class="line">| id | user_id | province | city   | town     | mobile      | street        | contact   | is_default | notes |</span><br><span class="line">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+</span><br><span class="line">| 59 |       1 | åŒ—äº¬     | åŒ—äº¬   | æœé˜³åŒº    | 13900112222 | é‡‘ç‡•é¾™åŠå…¬æ¥¼   | æä½³è¯š    | 0          | NULL  |</span><br><span class="line">| 60 |       1 | åŒ—äº¬     | åŒ—äº¬   | æœé˜³åŒº    | 13700221122 | ä¿®æ­£å¤§å¦       | æä½³çº¢    | 0          | NULL  |</span><br><span class="line">| 61 |       1 | ä¸Šæµ·     | ä¸Šæµ·   | æµ¦ä¸œæ–°åŒº  | 13301212233 | èˆªå¤´é•‡èˆªå¤´è·¯   | æä½³æ˜Ÿ    | 1          | NULL  |</span><br><span class="line">| 63 |       1 | å¹¿ä¸œ     | ä½›å±±   | æ°¸æ˜¥      | 13301212233 | æ°¸æ˜¥æ­¦é¦†       | ææ™“é¾™    | 0          | NULL  |</span><br><span class="line">+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>æ¨èæŒ‚è½½åˆ°ä¸€ä¸ªå›ºå®šçš„è‡ªå·±è®¾ç½®çš„æœ¬åœ°ç›®å½•ã€‚æŒ‚è½½åˆ°æœ¬åœ°ç›®å½•åï¼Œå³ä½¿å°† mysql å®¹å™¨åˆ æ‰ï¼Œå†æ¬¡åˆ›å»ºå¹¶è¿è¡Œæ–°mysqlå®¹å™¨ï¼Œåªè¦æŒ‚è½½çš„åœ°æ–¹ä¸å˜ï¼Œä¼šå‘ç°æ‰€æœ‰çš„æ•°æ®ä¾ç„¶ä¼šå­˜åœ¨ã€‚ä¹Ÿå°±æ˜¯è¯´<font color="red">åªè¦æŒ‚è½½çš„ç›®å½•è¿˜åœ¨ï¼Œæ•°æ®å°±ä¸ä¼šä¸¢å¤±ï¼Œå®ç°äº†æ•°æ®çš„æŒä¹…ä¿å­˜ã€‚</font></p>
<h2 id="3-5-é•œåƒ"><a href="#3-5-é•œåƒ" class="headerlink" title="3.5 é•œåƒ"></a>3.5 é•œåƒ</h2><p>å‰é¢æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨åˆ«äººå‡†å¤‡å¥½çš„é•œåƒï¼Œé‚£å¦‚æœæˆ‘è¦éƒ¨ç½²ä¸€ä¸ª Java é¡¹ç›®ï¼ŒæŠŠå®ƒæ‰“åŒ…ä¸ºä¸€ä¸ªé•œåƒè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<h3 id="3-5-1-é•œåƒç»“æ„"><a href="#3-5-1-é•œåƒç»“æ„" class="headerlink" title="3.5.1 é•œåƒç»“æ„"></a>3.5.1 é•œåƒç»“æ„</h3><p>é•œåƒä¹‹æ‰€ä»¥èƒ½è®©æˆ‘ä»¬å¿«é€Ÿè·¨æ“ä½œç³»ç»Ÿéƒ¨ç½²åº”ç”¨è€Œå¿½ç•¥å…¶è¿è¡Œç¯å¢ƒã€é…ç½®ï¼Œå°±æ˜¯å› ä¸ºé•œåƒä¸­åŒ…å«äº†ç¨‹åºè¿è¡Œéœ€è¦çš„ç³»ç»Ÿå‡½æ•°åº“ã€ç¯å¢ƒã€é…ç½®ã€ä¾èµ–ã€‚å› æ­¤ï¼Œè‡ªå®šä¹‰é•œåƒæœ¬è´¨å°±æ˜¯ä¾æ¬¡å‡†å¤‡å¥½ç¨‹åºè¿è¡Œçš„åŸºç¡€ç¯å¢ƒã€ä¾èµ–ã€åº”ç”¨æœ¬èº«ã€è¿è¡Œé…ç½®ç­‰æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰“åŒ…è€Œæˆã€‚</p>
<p>æˆ‘ä»¬æ‰“åŒ…é•œåƒä¹Ÿæ˜¯åˆ†æˆè¿™ä¹ˆå‡ æ­¥ï¼š</p>
<ul>
<li>å‡†å¤‡Linuxè¿è¡Œç¯å¢ƒ(Javaé¡¹ç›®å¹¶ä¸éœ€è¦å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œä»…ä»…æ˜¯åŸºç¡€è¿è¡Œç¯å¢ƒå³å¯)</li>
<li>å®‰è£…å¹¶é…ç½®JDK</li>
<li>æ‹·è´jaråŒ…</li>
<li>é…ç½®å¯åŠ¨è„šæœ¬</li>
</ul>
<p>ä¸Šè¿°æ­¥éª¤ä¸­çš„æ¯ä¸€æ¬¡æ“ä½œå…¶å®éƒ½æ˜¯åœ¨ç”Ÿäº§ä¸€äº›æ–‡ä»¶(ç³»ç»Ÿè¿è¡Œç¯å¢ƒã€å‡½æ•°åº“ã€é…ç½®æœ€ç»ˆéƒ½æ˜¯ç£ç›˜æ–‡ä»¶)ï¼Œæ‰€ä»¥<strong>é•œåƒå°±æ˜¯ä¸€å †æ–‡ä»¶çš„é›†åˆ</strong>ã€‚</p>
<p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé•œåƒæ–‡ä»¶ä¸æ˜¯éšæ„å †æ”¾çš„ï¼Œè€Œæ˜¯æŒ‰ç…§æ“ä½œçš„æ­¥éª¤åˆ†å±‚å åŠ è€Œæˆï¼Œæ¯ä¸€å±‚å½¢æˆçš„æ–‡ä»¶éƒ½ä¼šå•ç‹¬æ‰“åŒ…å¹¶æ ‡è®°ä¸€ä¸ªå”¯ä¸€ idï¼Œç§°ä¸º **Layer(å±‚)**ã€‚è¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬æ„å»ºæ—¶ç”¨åˆ°çš„æŸäº›å±‚å…¶ä»–äººå·²ç»åˆ¶ä½œè¿‡ï¼Œå°±å¯ä»¥ç›´æ¥æ‹·è´ä½¿ç”¨è¿™äº›å±‚ï¼Œè€Œä¸ç”¨é‡å¤åˆ¶ä½œã€‚</p>
<p>ä¾‹å¦‚ï¼Œç¬¬ä¸€æ­¥ä¸­éœ€è¦çš„ Linux è¿è¡Œç¯å¢ƒï¼Œé€šç”¨æ€§å°±å¾ˆå¼ºï¼Œæ‰€ä»¥ Docker å®˜æ–¹å°±åˆ¶ä½œäº†è¿™æ ·çš„åªåŒ…å« Linux è¿è¡Œç¯å¢ƒçš„é•œåƒã€‚æˆ‘ä»¬åœ¨åˆ¶ä½œJava é•œåƒæ—¶ï¼Œå°±æ— éœ€é‡å¤åˆ¶ä½œï¼Œç›´æ¥ä½¿ç”¨ Docker å®˜æ–¹æä¾›çš„ CentOS æˆ– Ubuntu é•œåƒä½œä¸ºåŸºç¡€é•œåƒã€‚ç„¶åå†æ­å»ºå…¶å®ƒå±‚å³å¯ï¼Œè¿™æ ·é€å±‚æ­å»ºï¼Œæœ€ç»ˆæ•´ä¸ª Java é¡¹ç›®çš„é•œåƒç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Docker%E9%95%9C%E5%83%8F%E7%BB%93%E6%9E%84.png" style="zoom:50%;">

<h3 id="3-5-2-Dockerfile"><a href="#3-5-2-Dockerfile" class="headerlink" title="3.5.2 Dockerfile"></a>3.5.2 Dockerfile</h3><p>ç”±äºåˆ¶ä½œé•œåƒçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é€å±‚å¤„ç†å’Œæ‰“åŒ…ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥ Docker å°±æä¾›äº†è‡ªåŠ¨æ‰“åŒ…é•œåƒçš„åŠŸèƒ½ã€‚æˆ‘ä»¬åªéœ€è¦å°†æ‰“åŒ…çš„è¿‡ç¨‹ï¼Œæ¯ä¸€å±‚è¦åšçš„äº‹æƒ…ç”¨å›ºå®šçš„è¯­æ³•å†™ä¸‹æ¥ï¼Œäº¤ç»™ Docker å»æ‰§è¡Œå³å¯ã€‚</p>
<p>è€Œè¿™ç§è®°å½•é•œåƒç»“æ„çš„æ–‡ä»¶å°±ç§°ä¸º <strong>Dockerfile</strong>ï¼Œå…¶å¯¹åº”çš„è¯­æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/engine/reference/builder/">https://docs.docker.com/engine/reference/builder/</a></p>
<p>å…¶ä¸­çš„è¯­æ³•æ¯”è¾ƒå¤šï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>æŒ‡ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>ç¤ºä¾‹</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>FROM</strong></td>
<td align="center">æŒ‡å®šåŸºç¡€é•œåƒ</td>
<td align="center"><code>FROM centos:6</code></td>
</tr>
<tr>
<td align="center"><strong>ENV</strong></td>
<td align="center">è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå¯åœ¨åé¢æŒ‡ä»¤ä½¿ç”¨</td>
<td align="center"><code>ENV key value</code></td>
</tr>
<tr>
<td align="center"><strong>COPY</strong></td>
<td align="center">æ‹·è´æœ¬åœ°æ–‡ä»¶åˆ°é•œåƒçš„æŒ‡å®šç›®å½•</td>
<td align="center"><code>COPY ./xx.jar /tmp/app.jar</code></td>
</tr>
<tr>
<td align="center"><strong>RUN</strong></td>
<td align="center">æ‰§è¡ŒLinuxçš„shellå‘½ä»¤ï¼Œä¸€èˆ¬æ˜¯å®‰è£…è¿‡ç¨‹çš„å‘½ä»¤</td>
<td align="center"><code>RUN yum install gcc</code></td>
</tr>
<tr>
<td align="center"><strong>EXPOSE</strong></td>
<td align="center">æŒ‡å®šå®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£ï¼Œæ˜¯ç»™é•œåƒä½¿ç”¨è€…çœ‹çš„</td>
<td align="center">EXPOSE 8080</td>
</tr>
<tr>
<td align="center"><strong>ENTRYPOINT</strong></td>
<td align="center">é•œåƒä¸­åº”ç”¨çš„å¯åŠ¨å‘½ä»¤ï¼Œå®¹å™¨è¿è¡Œæ—¶è°ƒç”¨</td>
<td align="center">ENTRYPOINT java -jar xx.jar</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚ï¼Œè¦åŸºäºUbuntué•œåƒæ¥æ„å»ºä¸€ä¸ª Java åº”ç”¨ï¼Œå…¶ Dockerfile å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šåŸºç¡€é•œåƒ</span></span><br><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">16.04</span></span><br><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡ï¼ŒJDKçš„å®‰è£…ç›®å½•ã€å®¹å™¨å†…æ—¶åŒº</span></span><br><span class="line"><span class="keyword">ENV</span> JAVA_DIR=/usr/local</span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="comment"># æ‹·è´JDKå’ŒJavaé¡¹ç›®çš„åŒ…</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./jdk8.tar.gz <span class="variable">$JAVA_DIR</span>/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./docker-demo.jar /tmp/app.jar</span></span><br><span class="line"><span class="comment"># è®¾å®šæ—¶åŒº</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">ln</span> -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br><span class="line"><span class="comment"># å®‰è£…JDK</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> <span class="variable">$JAVA_DIR</span> \</span></span><br><span class="line"><span class="language-bash"> &amp;&amp; tar -xf ./jdk8.tar.gz \</span></span><br><span class="line"><span class="language-bash"> &amp;&amp; <span class="built_in">mv</span> ./jdk1.8.0_144 ./java8</span></span><br><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="keyword">ENV</span> JAVA_HOME=$JAVA_DIR/java8</span><br><span class="line"><span class="keyword">ENV</span> PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"><span class="comment"># æŒ‡å®šé¡¹ç›®ç›‘å¬çš„ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="comment"># å…¥å£ï¼ŒJavaé¡¹ç›®çš„å¯åŠ¨å‘½ä»¤</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼šä»¥åæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šå¾ˆå¤š Java é¡¹ç›®éœ€è¦æ‰“åŒ…ä¸ºé•œåƒï¼Œä»–ä»¬éƒ½éœ€è¦ Linux ç³»ç»Ÿç¯å¢ƒã€JDK ç¯å¢ƒè¿™ä¸¤å±‚ï¼Œåªæœ‰ä¸Šé¢çš„3å±‚ä¸åŒ(å› ä¸ºjaråŒ…ä¸åŒ)ã€‚å¦‚æœæ¯æ¬¡åˆ¶ä½œ Java é•œåƒéƒ½é‡å¤åˆ¶ä½œå‰ä¸¤å±‚é•œåƒï¼Œæ˜¯ä¸æ˜¯å¾ˆéº»çƒ¦ã€‚</p>
<p>æ‰€ä»¥ï¼Œå°±æœ‰äººæä¾›äº†åŸºç¡€çš„ç³»ç»ŸåŠ  JDK ç¯å¢ƒï¼Œæˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šåˆ¶ä½œ Java é•œåƒï¼Œå°±å¯ä»¥çœå» JDK çš„é…ç½®äº†ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŸºç¡€é•œåƒ</span></span><br><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">11.0</span>-jre-buster</span><br><span class="line"><span class="comment"># è®¾å®šæ—¶åŒº</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">ln</span> -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br><span class="line"><span class="comment"># æ‹·è´jaråŒ…</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> docker-demo.jar /app.jar</span></span><br><span class="line"><span class="comment"># å…¥å£</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸æ˜¯ç®€å•å¤šäº†ã€‚</p>
<h3 id="3-5-3-æ„å»ºé•œåƒ"><a href="#3-5-3-æ„å»ºé•œåƒ" class="headerlink" title="3.5.3 æ„å»ºé•œåƒ"></a>3.5.3 æ„å»ºé•œåƒ</h3><p>å½“ Dockerfile æ–‡ä»¶å†™å¥½ä»¥åï¼Œå°±å¯ä»¥åˆ©ç”¨å‘½ä»¤æ¥æ„å»ºé•œåƒäº†ã€‚</p>
<p>å‡†å¤‡ä»¥ä¸‹ Dockerfile æ–‡ä»¶ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŸºç¡€é•œåƒ</span></span><br><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">11.0</span>-jre-buster</span><br><span class="line"><span class="comment"># è®¾å®šæ—¶åŒº</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">ln</span> -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br><span class="line"><span class="comment"># æ‹·è´jaråŒ…</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> docker-demo.jar /app.jar</span></span><br><span class="line"><span class="comment"># å…¥å£</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>å°†<code>docker-demo.jar</code>åŒ…ä»¥åŠ<code>Dockerfile</code>æ‹·è´åˆ°è™šæ‹Ÿæœºçš„<code>/root/demo</code>ç›®å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/docker-demo.jar%E5%8C%85%E5%92%8CDockerfile%E6%8B%B7%E8%B4%9D%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA.png"></p>
<p>ç„¶åï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œæ„å»ºé•œåƒï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥é•œåƒç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /root/demo</span><br><span class="line"><span class="comment"># å¼€å§‹æ„å»º</span></span><br><span class="line">docker build -t docker-demo:1.0 .</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤è¯´æ˜ï¼š</p>
<ul>
<li><p><code>docker build </code> : å°±æ˜¯æ„å»ºä¸€ä¸ªdockeré•œåƒ</p>
</li>
<li><p><code>-t docker-demo:1.0</code> ï¼š<code>-t</code>å‚æ•°æ˜¯æŒ‡å®šé•œåƒçš„åç§°(<code>repository</code>å’Œ<code>tag</code>)</p>
</li>
<li><p><code>.</code> : æœ€åçš„ç‚¹æ˜¯æŒ‡æ„å»ºæ—¶ Dockerfile æ‰€åœ¨è·¯å¾„ï¼Œç”±äºæˆ‘ä»¬è¿›å…¥äº† demo ç›®å½•ï¼Œæ‰€ä»¥æŒ‡å®šçš„æ˜¯<code>.</code>ä»£è¡¨å½“å‰ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®š Dockerfile ç›®å½•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æŒ‡å®šDockerfileç›®å½•</span></span><br><span class="line">docker build -t docker-demo:1.0 /root/demo</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E6%9E%84%E5%BB%BAdocker-demo%E9%95%9C%E5%83%8F.png"></p>
</li>
</ul>
<p>æŸ¥çœ‹é•œåƒåˆ—è¡¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒåˆ—è¡¨ï¼š</span></span><br><span class="line">docker images</span><br><span class="line"><span class="comment"># ç»“æœ</span></span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">docker-demo   1.0       135cfdff1520   4 minutes ago   315MB</span><br><span class="line">mysql         latest    82563e0cbf18   2 days ago      632MB</span><br><span class="line">nginx         latest    92b11f67642b   6 weeks ago     187MB</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°è¯•è¿è¡Œè¯¥é•œåƒï¼š</p>
<p>1ã€åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d --name dd -p 8080:8080 docker-demo:1.0</span><br></pre></td></tr></table></figure>

<p>2ã€æŸ¥çœ‹å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CONTAINER ID   IMAGE             PORTS                                                  STATUS              NAMES</span><br><span class="line">bf65aebe697b   docker-demo:1.0   0.0.0.0:8080-&gt;8080/tcp, :::8080-&gt;8080/tcp              Up About a minute   dd</span><br><span class="line">84f8c612dc9d   mysql             0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   Up 2 hours          mysql</span><br><span class="line">d38d34cb0b17   nginx             0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp                      Up 3 hours          nginx</span><br></pre></td></tr></table></figure>

<p>3ã€è®¿é—®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl localhost:8080/hello/count</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;h5&gt;æ¬¢è¿è®¿é—®é»‘é©¬å•†åŸ, è¿™æ˜¯æ‚¨ç¬¬1æ¬¡è®¿é—®&lt;h5&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-ç½‘ç»œ"><a href="#3-6-ç½‘ç»œ" class="headerlink" title="3.6 ç½‘ç»œ"></a>3.6 ç½‘ç»œ</h2><p>ä¸Šé¢æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Java é¡¹ç›®çš„å®¹å™¨ï¼Œè€Œ Java é¡¹ç›®å¾€å¾€éœ€è¦è®¿é—®å…¶å®ƒå„ç§ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ MySQLã€Redis ç­‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬çš„å®¹å™¨ä¹‹é—´èƒ½å¦äº’ç›¸è®¿é—®å‘¢ï¼Ÿæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸‹ MySQL å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œé‡ç‚¹å…³æ³¨å…¶ä¸­çš„ç½‘ç»œIPåœ°å€ï¼š</p>
<p>1ã€ç”¨åŸºæœ¬å‘½ä»¤ï¼Œå¯»æ‰¾Networks.bridge.IPAddresså±æ€§</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker inspect mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¹Ÿå¯ä»¥ä½¿ç”¨formatè¿‡æ»¤ç»“æœ</span></span><br><span class="line">docker inspect --format=&#x27;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;println .IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27; mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¾—åˆ°çš„ IP åœ°å€</span><br><span class="line">172.17.0.3</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶åé€šè¿‡å‘½ä»¤è¿›å…¥ddå®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -it dd bash</span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨å®¹å™¨å†…ï¼Œé€šè¿‡ ping å‘½ä»¤æµ‹è¯•ç½‘ç»œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping 172.17.0.3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.140 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.081 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.065 ms</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯ä»¥äº’è”ï¼Œæ²¡æœ‰é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯ï¼Œå®¹å™¨çš„ç½‘ç»œIPå…¶å®æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ IPï¼Œå…¶å€¼å¹¶ä¸å›ºå®šä¸æŸä¸€ä¸ªå®¹å™¨ç»‘å®šï¼Œå¦‚æœæˆ‘ä»¬åœ¨å¼€å‘æ—¶å†™æ­»æŸä¸ª IPï¼Œè€Œåœ¨éƒ¨ç½²æ—¶å¾ˆå¯èƒ½ MySQLå®¹å™¨çš„ IP ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿æ¥ä¼šå¤±è´¥ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»å€ŸåŠ©äºdockerçš„ç½‘ç»œåŠŸèƒ½æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/engine/reference/commandline/network/">https://docs.docker.com/engine/reference/commandline/network/</a></p>
<p>å¸¸è§å‘½ä»¤æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="left"><strong>å‘½ä»¤</strong></th>
<th align="left"><strong>è¯´æ˜</strong></th>
<th align="left"><strong>æ–‡æ¡£åœ°å€</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">docker network create</td>
<td align="left">åˆ›å»ºä¸€ä¸ªç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_create/">docker network create</a></td>
</tr>
<tr>
<td align="left">docker network ls</td>
<td align="left">æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_ls/">docs.docker.com</a></td>
</tr>
<tr>
<td align="left">docker network rm</td>
<td align="left">åˆ é™¤æŒ‡å®šç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_rm/">docs.docker.com</a></td>
</tr>
<tr>
<td align="left">docker network prune</td>
<td align="left">æ¸…é™¤æœªä½¿ç”¨çš„ç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_prune/">docs.docker.com</a></td>
</tr>
<tr>
<td align="left">docker network connect</td>
<td align="left">ä½¿æŒ‡å®šå®¹å™¨è¿æ¥åŠ å…¥æŸç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_connect/">docs.docker.com</a></td>
</tr>
<tr>
<td align="left">docker network disconnect</td>
<td align="left">ä½¿æŒ‡å®šå®¹å™¨è¿æ¥ç¦»å¼€æŸç½‘ç»œ</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_disconnect/">docker network disconnect</a></td>
</tr>
<tr>
<td align="left">docker network inspect</td>
<td align="left">æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯</td>
<td align="left"><a href="https://docs.docker.com/engine/reference/commandline/network_inspect/">docker network inspect</a></td>
</tr>
</tbody></table>
<blockquote>
<p>æ¼”ç¤ºè‡ªå®šä¹‰ç½‘ç»œ</p>
</blockquote>
<p>1ã€é¦–å…ˆé€šè¿‡å‘½ä»¤åˆ›å»ºä¸€ä¸ªç½‘ç»œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker network create hmall</span><br></pre></td></tr></table></figure>

<p>2ã€ç„¶åæŸ¥çœ‹ç½‘ç»œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker network ls</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">450aad7a52da   bridge    bridge    local</span><br><span class="line">a93df4a22e20   hmall     bridge    local</span><br><span class="line">7e4aae31adc0   host      host      local</span><br><span class="line">fdf56146d7d7   none      null      local</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œé™¤äº†hmallä»¥å¤–ï¼Œå…¶å®ƒéƒ½æ˜¯é»˜è®¤çš„ç½‘ç»œ</p>
<p>3ã€è®©ddå’Œmysqléƒ½åŠ å…¥è¯¥ç½‘ç»œï¼Œæ³¨æ„ï¼Œåœ¨åŠ å…¥ç½‘ç»œæ—¶å¯ä»¥é€šè¿‡â€“aliasç»™å®¹å™¨èµ·åˆ«åï¼Œè¿™æ ·è¯¥ç½‘ç»œå†…çš„å…¶å®ƒå®¹å™¨å¯ä»¥ç”¨åˆ«åäº’ç›¸è®¿é—®ï¼</p>
<p>(1) mysqlå®¹å™¨ï¼ŒæŒ‡å®šåˆ«åä¸ºdbï¼Œå¦å¤–æ¯ä¸€ä¸ªå®¹å™¨éƒ½æœ‰ä¸€ä¸ªåˆ«åæ˜¯å®¹å™¨å</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker network connect hmall mysql --alias db</span><br></pre></td></tr></table></figure>

<p>(2) dbå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„Javaé¡¹ç›®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker network connect hmall dd</span><br></pre></td></tr></table></figure>

<p>4ã€è¿›å…¥ dd å®¹å™¨ï¼Œå°è¯•åˆ©ç”¨åˆ«åè®¿é—® db</p>
<p>(1) è¿›å…¥å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -it dd bash</span><br></pre></td></tr></table></figure>

<p>(2) ç”¨ db åˆ«åè®¿é—®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping db</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING db (172.19.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=1 ttl=64 time=0.063 ms</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=2 ttl=64 time=0.071 ms</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=3 ttl=64 time=0.062 ms</span><br></pre></td></tr></table></figure>

<p>(3) ç”¨å®¹å™¨åè®¿é—®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING mysql (172.19.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=1 ttl=64 time=0.074 ms</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=2 ttl=64 time=0.057 ms</span><br><span class="line">64 bytes from mysql.hmall (172.19.0.2): icmp_seq=3 ttl=64 time=0.057 ms</span><br></pre></td></tr></table></figure>

<p>OKï¼Œç°åœ¨æ— éœ€è®°ä½ IP åœ°å€ä¹Ÿå¯ä»¥å®ç°å®¹å™¨äº’è”äº†ã€‚</p>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ul>
<li>åœ¨è‡ªå®šä¹‰ç½‘ç»œä¸­ï¼Œå¯ä»¥ç»™å®¹å™¨èµ·å¤šä¸ªåˆ«åï¼Œé»˜è®¤çš„åˆ«åæ˜¯å®¹å™¨åæœ¬èº«</li>
<li>åœ¨åŒä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥é€šè¿‡åˆ«åäº’ç›¸è®¿é—®</li>
</ul>
<h1 id="4-é¡¹ç›®éƒ¨ç½²"><a href="#4-é¡¹ç›®éƒ¨ç½²" class="headerlink" title="4. é¡¹ç›®éƒ¨ç½²"></a>4. é¡¹ç›®éƒ¨ç½²</h1><p>é¡¹ç›®è¯´æ˜ï¼š</p>
<ul>
<li>hmallï¼šå•†åŸçš„åç«¯ä»£ç </li>
<li>hmall-portalï¼šå•†åŸç”¨æˆ·ç«¯çš„å‰ç«¯ä»£ç </li>
<li>hmall-adminï¼šå•†åŸç®¡ç†ç«¯çš„å‰ç«¯ä»£ç </li>
</ul>
<p>éƒ¨ç½²çš„å®¹å™¨åŠç«¯å£è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>é¡¹ç›®</strong></th>
<th align="center"><strong>å®¹å™¨å</strong></th>
<th align="center"><strong>ç«¯å£</strong></th>
<th align="center"><strong>å¤‡æ³¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">hmall</td>
<td align="center">hmall</td>
<td align="center">8080</td>
<td align="center">é»‘é©¬å•†åŸåç«¯APIå…¥å£</td>
</tr>
<tr>
<td align="center">hmall-portal</td>
<td align="center">nginx</td>
<td align="center">18080</td>
<td align="center">é»‘é©¬å•†åŸç”¨æˆ·ç«¯å…¥å£</td>
</tr>
<tr>
<td align="center">hmall-admin</td>
<td align="center">nginx</td>
<td align="center">18081</td>
<td align="center">é»‘é©¬å•†åŸç®¡ç†ç«¯å…¥å£</td>
</tr>
<tr>
<td align="center">mysql</td>
<td align="center">mysql</td>
<td align="center">3306</td>
<td align="center">æ•°æ®åº“</td>
</tr>
</tbody></table>
<p>åœ¨æ­£å¼éƒ¨ç½²å‰ï¼Œæˆ‘ä»¬å…ˆåˆ é™¤ä¹‹å‰çš„ nginxã€dd ä¸¤ä¸ªå®¹å™¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> -f nginx <span class="built_in">dd</span></span><br></pre></td></tr></table></figure>

<p>mysqlå®¹å™¨ä¸­å·²ç»å‡†å¤‡å¥½äº†å•†åŸçš„æ•°æ®ï¼Œæ‰€ä»¥å°±ä¸å†åˆ é™¤äº†ã€‚</p>
<h2 id="4-1-éƒ¨ç½²Javaé¡¹ç›®"><a href="#4-1-éƒ¨ç½²Javaé¡¹ç›®" class="headerlink" title="4.1 éƒ¨ç½²Javaé¡¹ç›®"></a>4.1 éƒ¨ç½²Javaé¡¹ç›®</h2><p><code>hmall</code>é¡¹ç›®æ˜¯ä¸€ä¸ªmavenèšåˆé¡¹ç›®ï¼Œä½¿ç”¨IDEAæ‰“å¼€<code>hmall</code>é¡¹ç›®ï¼ŒæŸ¥çœ‹é¡¹ç›®ç»“æ„å¦‚å›¾ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png"></p>
<p>æˆ‘ä»¬è¦éƒ¨ç½²çš„å°±æ˜¯å…¶ä¸­çš„<code>hm-service</code>ï¼Œå…¶ä¸­çš„é…ç½®æ–‡ä»¶é‡‡ç”¨äº†å¤šç¯å¢ƒçš„æ–¹å¼ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E5%A4%9A%E7%8E%AF%E5%A2%83.png"></p>
<p>å…¶ä¸­çš„<code>application-dev.yaml</code>æ˜¯éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒçš„é…ç½®ï¼Œ<code>application-local.yaml</code>æ˜¯æœ¬åœ°è¿è¡Œæ—¶çš„é…ç½®ã€‚</p>
<p>æŸ¥çœ‹ <code>application.yaml</code>ï¼Œä½ ä¼šå‘ç°å…¶ä¸­çš„ JDBC åœ°å€å¹¶æœªå†™æ­»ï¼Œè€Œæ˜¯è¯»å–å˜é‡ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/JDBC%E5%9C%B0%E5%9D%80%E6%9C%AA%E5%86%99%E6%AD%BB.png"></p>
<p>è¿™ä¸¤ä¸ªå˜é‡åœ¨<code>application-dev.yaml</code>å’Œ<code>application-local.yaml</code>ä¸­å¹¶ä¸ç›¸åŒï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/host%E5%8F%98%E9%87%8F%E5%8C%BA%E5%88%AB.png"></p>
<p>åœ¨ dev å¼€å‘ç¯å¢ƒ(ä¹Ÿå°±æ˜¯ Docker éƒ¨ç½²æ—¶)é‡‡ç”¨äº† mysql ä½œä¸ºåœ°å€ï¼Œåˆšå¥½æ˜¯æˆ‘ä»¬çš„ mysql å®¹å™¨åï¼Œåªè¦ä¸¤è€…åœ¨ä¸€ä¸ªç½‘ç»œï¼Œå°±ä¸€å®šèƒ½äº’ç›¸è®¿é—®ã€‚</p>
<p>æˆ‘ä»¬å°†é¡¹ç›®æ‰“åŒ…ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E6%89%93%E5%8C%85hmall.png" style="zoom: 67%;">

<p>ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E6%89%93%E5%8C%85hmall%E7%BB%93%E6%9E%9C.png" style="zoom:80%;">

<p>å°†<code>hm-service</code>ç›®å½•ä¸‹çš„<code>Dockerfile</code>å’Œ<code>hm-service/target</code>ç›®å½•ä¸‹çš„<code>hm-service.jar</code>ä¸€èµ·ä¸Šä¼ åˆ°è™šæ‹Ÿæœºçš„<code>root</code>ç›®å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/Dockerfile%E5%92%8Chm-service.jar%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA.png"></p>
<p>éƒ¨ç½²é¡¹ç›®ï¼š</p>
<p>1ã€æ„å»ºé¡¹ç›®é•œåƒï¼Œä¸æŒ‡å®štagï¼Œåˆ™é»˜è®¤ä¸ºlatest</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker build -t hmall .</span><br></pre></td></tr></table></figure>

<p>2ã€æŸ¥çœ‹é•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED             SIZE</span><br><span class="line">hmall         latest    5edaf76e6b44   38 minutes ago      365MB</span><br><span class="line">docker-demo   1.0       135cfdff1520   About an hour ago   315MB</span><br><span class="line">mysql         latest    82563e0cbf18   2 days ago          632MB</span><br><span class="line">nginx         latest    92b11f67642b   6 weeks ago         187MB</span><br></pre></td></tr></table></figure>

<p>3ã€åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨ï¼Œå¹¶é€šè¿‡ <code>--network</code> å°†å…¶åŠ å…¥ <code>hmall</code> ç½‘ç»œï¼Œè¿™æ ·æ‰èƒ½é€šè¿‡å®¹å™¨åè®¿é—® <code>mysql</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d --name hmall --network hmall -p 8080:8080 hmall</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼š<a href="http://yourip:8080/search/list%EF%BC%8C%E6%9F%A5%E7%9C%8B%E5%88%B0%E5%AF%B9%E5%BA%94%E4%BF%A1%E6%81%AF%E5%B0%B1%E6%88%90%E5%8A%9F%E9%83%A8%E7%BD%B2%E3%80%82">http://YourIp:8080/search/listï¼ŒæŸ¥çœ‹åˆ°å¯¹åº”ä¿¡æ¯å°±æˆåŠŸéƒ¨ç½²ã€‚</a></p>
<h2 id="4-2-éƒ¨ç½²å‰ç«¯"><a href="#4-2-éƒ¨ç½²å‰ç«¯" class="headerlink" title="4.2 éƒ¨ç½²å‰ç«¯"></a>4.2 éƒ¨ç½²å‰ç«¯</h2><p><code>hmall-portal</code>å’Œ<code>hmall-admin</code>æ˜¯å‰ç«¯ä»£ç ï¼Œéœ€è¦åŸºäºnginxéƒ¨ç½²ã€‚nginxçš„éƒ¨ç½²ç›®å½•ï¼š</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>html</code>æ˜¯é™æ€èµ„æºç›®å½•ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ<code>hmall-portal</code>ä»¥åŠ<code>hmall-admin</code>éƒ½å¤åˆ¶è¿›å»</li>
<li><code>nginx.conf</code>æ˜¯nginxçš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ˜¯å®Œæˆå¯¹<code>html</code>ä¸‹çš„ä¸¤ä¸ªé™æ€èµ„æºç›®å½•åšä»£ç†</li>
</ul>
<p>æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯æŠŠæ•´ä¸ª nginx ç›®å½•ä¸Šä¼ åˆ°è™šæ‹Ÿæœºçš„ <code>/root</code> ç›®å½•ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/%E6%95%B4%E4%B8%AAnginx%E7%9B%AE%E5%BD%95%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA.png"></p>
<p>ç„¶ååˆ›å»º nginx å®¹å™¨å¹¶å®Œæˆä¸¤ä¸ªæŒ‚è½½ï¼š</p>
<ul>
<li>æŠŠ<code>/root/nginx/nginx.conf</code>æŒ‚è½½åˆ°<code>/etc/nginx/nginx.conf</code></li>
<li>æŠŠ<code>/root/nginx/html</code>æŒ‚è½½åˆ°<code>/usr/share/nginx/html</code></li>
</ul>
<p>ç”±äºéœ€è¦è®© nginx åŒæ—¶ä»£ç† hmall-portal å’Œ hmall-admin ä¸¤å¥—å‰ç«¯èµ„æºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æš´éœ²ä¸¤ä¸ªç«¯å£ï¼š</p>
<ul>
<li>18080ï¼šå¯¹åº”hmall-portal</li>
<li>18081ï¼šå¯¹åº”hmall-admin</li>
</ul>
<p>å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name nginx \</span><br><span class="line">  -p 18080:18080 \</span><br><span class="line">  -p 18081:18081 \</span><br><span class="line">  -v /root/nginx/html:/usr/share/nginx/html \</span><br><span class="line">  -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">  --network hmall \</span><br><span class="line">  nginx</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼š<a href="http://yourip:18080/">http://YourIp:18080</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/nginx%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E7%BB%93%E6%9E%9C.png"></p>
<h2 id="4-3-DockerCompose"><a href="#4-3-DockerCompose" class="headerlink" title="4.3 DockerCompose"></a>4.3 DockerCompose</h2><p>Docker Composeå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°<strong>å¤šä¸ªç›¸äº’å…³è”çš„Dockerå®¹å™¨çš„å¿«é€Ÿéƒ¨ç½²</strong>ã€‚å®ƒå…è®¸ç”¨æˆ·é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ <code>docker-compose.yml</code> æ¨¡æ¿æ–‡ä»¶(YAML æ ¼å¼)æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/Docker/DockerCompose.png" style="zoom:50%;">

<h3 id="4-3-1-åŸºæœ¬è¯­æ³•"><a href="#4-3-1-åŸºæœ¬è¯­æ³•" class="headerlink" title="4.3.1 åŸºæœ¬è¯­æ³•"></a>4.3.1 åŸºæœ¬è¯­æ³•</h3><p>docker-compose.ymlæ–‡ä»¶çš„åŸºæœ¬è¯­æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/compose/compose-file/compose-file-v3/">https://docs.docker.com/compose/compose-file/compose-file-v3/</a></p>
<p>docker-composeæ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªç›¸äº’å…³è”çš„åº”ç”¨å®¹å™¨ï¼Œæ¯ä¸€ä¸ªåº”ç”¨å®¹å™¨è¢«ç§°ä¸ºä¸€ä¸ªæœåŠ¡(service)ã€‚ç”±äº service å°±æ˜¯åœ¨å®šä¹‰æŸä¸ªåº”ç”¨çš„è¿è¡Œæ—¶å‚æ•°ï¼Œå› æ­¤ä¸ <code>docker run</code> å‚æ•°éå¸¸ç›¸ä¼¼ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨docker runéƒ¨ç½²MySQLçš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name mysql \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=123 \</span><br><span class="line">  -v ./mysql/data:/var/lib/mysql \</span><br><span class="line">  -v ./mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">  -v ./mysql/init:/docker-entrypoint-initdb.d \</span><br><span class="line">  --network hmall</span><br><span class="line">  mysql</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç”¨<code>docker-compose.yml</code>æ–‡ä»¶æ¥å®šä¹‰ï¼Œå°±æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="number">123</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./mysql/conf:/etc/mysql/conf.d&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./mysql/data:/var/lib/mysql&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">new</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">new:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hmall</span></span><br></pre></td></tr></table></figure>

<p>å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>docker run å‚æ•°</strong></th>
<th align="center"><strong>docker compose æŒ‡ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">â€“name</td>
<td align="center">container_name</td>
<td align="center">å®¹å™¨åç§°</td>
</tr>
<tr>
<td align="center">-p</td>
<td align="center">ports</td>
<td align="center">ç«¯å£æ˜ å°„</td>
</tr>
<tr>
<td align="center">-e</td>
<td align="center">environment</td>
<td align="center">ç¯å¢ƒå˜é‡</td>
</tr>
<tr>
<td align="center">-v</td>
<td align="center">volumes</td>
<td align="center">æ•°æ®å·é…ç½®</td>
</tr>
<tr>
<td align="center">â€“network</td>
<td align="center">networks</td>
<td align="center">ç½‘ç»œ</td>
</tr>
</tbody></table>
<p>é»‘é©¬å•†åŸéƒ¨ç½²æ–‡ä»¶ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="number">123</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./mysql/conf:/etc/mysql/conf.d&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./mysql/data:/var/lib/mysql&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./mysql/init:/docker-entrypoint-initdb.d&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">hm-net</span></span><br><span class="line">  <span class="attr">hmall:</span></span><br><span class="line">    <span class="attr">build:</span> </span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">hmall</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">hm-net</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;18080:18080&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;18081:18081&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./nginx/nginx.conf:/etc/nginx/nginx.conf&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;./nginx/html:/usr/share/nginx/html&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">hmall</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">hm-net</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">hm-net:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hmall</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-åŸºç¡€å‘½ä»¤"><a href="#4-3-2-åŸºç¡€å‘½ä»¤" class="headerlink" title="4.3.2 åŸºç¡€å‘½ä»¤"></a>4.3.2 åŸºç¡€å‘½ä»¤</h3><p>ç¼–å†™å¥½docker-compose.ymlæ–‡ä»¶ï¼Œå°±å¯ä»¥éƒ¨ç½²é¡¹ç›®äº†ã€‚å¸¸è§çš„å‘½ä»¤ï¼š<a href="https://docs.docker.com/compose/reference/">https://docs.docker.com/compose/reference/</a></p>
<p>åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker compose [OPTIONS] [COMMAND]</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼ŒOPTIONS å’Œ COMMAND éƒ½æ˜¯å¯é€‰å‚æ•°ï¼Œæ¯”è¾ƒå¸¸è§çš„æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>ç±»å‹</strong></th>
<th align="center"><strong>å‚æ•°æˆ–æŒ‡ä»¤</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">Options</td>
<td align="center">-f</td>
<td align="center">æŒ‡å®šcomposeæ–‡ä»¶çš„è·¯å¾„å’Œåç§°</td>
</tr>
<tr>
<td align="center">Options</td>
<td align="center">-p</td>
<td align="center">æŒ‡å®šprojectåç§°ã€‚projectå°±æ˜¯å½“å‰composeæ–‡ä»¶ä¸­è®¾ç½®çš„å¤šä¸ªserviceçš„é›†åˆï¼Œæ˜¯é€»è¾‘æ¦‚å¿µ</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">up</td>
<td align="center">åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰serviceå®¹å™¨</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">down</td>
<td align="center">åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œ</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">ps</td>
<td align="center">åˆ—å‡ºæ‰€æœ‰å¯åŠ¨çš„å®¹å™¨</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">logs</td>
<td align="center">æŸ¥çœ‹æŒ‡å®šå®¹å™¨çš„æ—¥å¿—</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">stop</td>
<td align="center">åœæ­¢å®¹å™¨</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">start</td>
<td align="center">å¯åŠ¨å®¹å™¨</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">restart</td>
<td align="center">é‡å¯å®¹å™¨</td>
</tr>
<tr>
<td align="center">Commands</td>
<td align="center">top</td>
<td align="center">æŸ¥çœ‹è¿è¡Œçš„è¿›ç¨‹</td>
</tr>
</tbody></table>
<blockquote>
<p>æ¼”ç¤º</p>
</blockquote>
<p>1ã€è¿›å…¥ root ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /root</span><br></pre></td></tr></table></figure>

<p>2ã€åˆ é™¤æ—§å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker rm -f $(docker ps -qa)</span><br></pre></td></tr></table></figure>

<p>3ã€åˆ é™¤hmallé•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker rmi hmall</span><br></pre></td></tr></table></figure>

<p>4ã€æ¸…ç©ºMySQLæ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rm -rf mysql/data</span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨æ‰€æœ‰ï¼Œ<code>-d</code> å‚æ•°æ˜¯åå°å¯åŠ¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[+] Building 15.5s (8/8) FINISHED</span><br><span class="line"> =&gt; [internal] load build definition from Dockerfile                                    0.0s</span><br><span class="line"> =&gt; =&gt; transferring dockerfile: 358B                                                    0.0s</span><br><span class="line"> =&gt; [internal] load .dockerignore                                                       0.0s</span><br><span class="line"> =&gt; =&gt; transferring context: 2B                                                         0.0s</span><br><span class="line"> =&gt; [internal] load metadata for docker.io/library/openjdk:11.0-jre-buster             15.4s</span><br><span class="line"> =&gt; [1/3] FROM docker.io/library/openjdk:11.0-jre-buster@sha256:3546a17e6fb4ff4fa681c3  0.0s</span><br><span class="line"> =&gt; [internal] load build context                                                       0.0s</span><br><span class="line"> =&gt; =&gt; transferring context: 98B                                                        0.0s</span><br><span class="line"> =&gt; CACHED [2/3] RUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; echo   0.0s</span><br><span class="line"> =&gt; CACHED [3/3] COPY hm-service.jar /app.jar                                           0.0s</span><br><span class="line"> =&gt; exporting to image                                                                  0.0s</span><br><span class="line"> =&gt; =&gt; exporting layers                                                                 0.0s</span><br><span class="line"> =&gt; =&gt; writing image sha256:32eebee16acde22550232f2eb80c69d2ce813ed099640e4cfed2193f71  0.0s</span><br><span class="line"> =&gt; =&gt; naming to docker.io/library/root-hmall                                           0.0s</span><br><span class="line">[+] Running 4/4</span><br><span class="line"> âœ” Network hmall    Created                                                             0.2s</span><br><span class="line"> âœ” Container mysql  Started                                                             0.5s</span><br><span class="line"> âœ” Container hmall  Started                                                             0.9s</span><br><span class="line"> âœ” Container nginx  Started                                                             1.5s</span><br></pre></td></tr></table></figure>

<p>6ã€æŸ¥çœ‹é•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker compose images</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CONTAINER           REPOSITORY          TAG                 IMAGE ID            SIZE</span><br><span class="line">hmall               root-hmall          latest              32eebee16acd        362MB</span><br><span class="line">mysql               mysql               latest              3218b38490ce        516MB</span><br><span class="line">nginx               nginx               latest              605c77e624dd        141MB</span><br></pre></td></tr></table></figure>

<p>7ã€æŸ¥çœ‹å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker compose ps</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NAME                IMAGE               COMMAND                  SERVICE             CREATED             STATUS              PORTS</span><br><span class="line">hmall               root-hmall          <span class="string">&quot;java -jar /app.jar&quot;</span>     hmall               54 seconds ago      Up 52 seconds       0.0.0.0:8080-&gt;8080/tcp, :::8080-&gt;8080/tcp</span><br><span class="line">mysql               mysql               <span class="string">&quot;docker-entrypoint.sâ€¦&quot;</span>   mysql               54 seconds ago      Up 53 seconds       0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp</span><br><span class="line">nginx               nginx               <span class="string">&quot;/docker-entrypoint.â€¦&quot;</span>   nginx               54 seconds ago      Up 52 seconds       80/tcp, 0.0.0.0:18080-18081-&gt;18080-18081/tcp, :::18080-18081-&gt;18080-18081/tcp</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š<a href="http://yourip:8080/">http://YourIp:8080</a></p>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå…¥é—¨ï¼ˆä¸‹ï¼‰</title>
    <url>/posts/Accidence-Spring-Volume-Two/</url>
    <content><![CDATA[<p>Springå®˜ç½‘ï¼š<a href="https://spring.io/">https://spring.io/</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š</p>
<ul>
<li><a href="https://www.bilibili.com/video/BV1Ft4y1g7Fb/">Springè§†é¢‘é›¶åŸºç¡€å…¥é—¨åˆ°é«˜çº§ï¼ŒSpringå…¨å¥—è§†é¢‘æ•™ç¨‹è¯¦è§£</a></li>
<li><a href="https://www.bilibili.com/video/BV1Fi4y1S7ix/">é»‘é©¬ç¨‹åºå‘˜SSMæ¡†æ¶æ•™ç¨‹Springéƒ¨åˆ†</a></li>
</ul>
<p>æºç ä»“åº“ï¼š<a href="https://github.com/muyoukule/accidence-spring">muyoukule&#x2F;accidence-spring (github.com)</a></p>
<h1 id="1-Spring-IoCæ³¨è§£å¼å¼€å‘"><a href="#1-Spring-IoCæ³¨è§£å¼å¼€å‘" class="headerlink" title="1. Spring IoCæ³¨è§£å¼å¼€å‘"></a>1. Spring IoCæ³¨è§£å¼å¼€å‘</h1><h2 id="1-1-å›é¡¾æ³¨è§£"><a href="#1-1-å›é¡¾æ³¨è§£" class="headerlink" title="1.1 å›é¡¾æ³¨è§£"></a>1.1 å›é¡¾æ³¨è§£</h2><p>æ³¨è§£çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ–XMLçš„é…ç½®ã€‚</p>
<p>æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ï¼š</p>
<ul>
<li>ç¬¬ä¸€ï¼šæ³¨è§£æ€ä¹ˆå®šä¹‰ï¼Œæ³¨è§£ä¸­çš„å±æ€§æ€ä¹ˆå®šä¹‰ï¼Ÿ</li>
<li>ç¬¬äºŒï¼šæ³¨è§£æ€ä¹ˆä½¿ç”¨ï¼Ÿ</li>
<li>ç¬¬ä¸‰ï¼šé€šè¿‡åå°„æœºåˆ¶æ€ä¹ˆè¯»å–æ³¨è§£ï¼Ÿ</li>
</ul>
<blockquote>
<p>æ³¨è§£æ€ä¹ˆå®šä¹‰ï¼Œæ³¨è§£ä¸­çš„å±æ€§æ€ä¹ˆå®šä¹‰ï¼Ÿ</p>
</blockquote>
<p>è‡ªå®šä¹‰æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæ˜¯è‡ªå®šä¹‰äº†ä¸€ä¸ªæ³¨è§£ï¼š<code>Component</code></p>
<p>è¯¥æ³¨è§£ä¸Šé¢ä¿®é¥°çš„æ³¨è§£åŒ…æ‹¬ï¼š<code>Target</code> æ³¨è§£å’Œ <code>Retention</code> æ³¨è§£ï¼Œè¿™ä¸¤ä¸ªæ³¨è§£è¢«ç§°ä¸ºå…ƒæ³¨è§£ã€‚</p>
<p><code>Target</code> æ³¨è§£ç”¨æ¥è®¾ç½® <code>Component</code> æ³¨è§£å¯ä»¥å‡ºç°çš„ä½ç½®ï¼Œä»¥ä¸Šä»£è¡¨è¡¨ç¤º <code>Component</code> æ³¨è§£åªèƒ½ç”¨åœ¨ç±»å’Œæ¥å£ä¸Šã€‚</p>
<p><code>Retention</code> æ³¨è§£ç”¨æ¥è®¾ç½® <code>Component</code> æ³¨è§£çš„ä¿æŒæ€§ç­–ç•¥ï¼Œä»¥ä¸Šä»£è¡¨ <code>Component</code> æ³¨è§£å¯ä»¥è¢«åå°„æœºåˆ¶è¯»å–ã€‚</p>
<p><code>String value();</code> æ˜¯ <code>Component</code> æ³¨è§£ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚è¯¥å±æ€§ç±»å‹ String ï¼Œå±æ€§åæ˜¯ value ã€‚</p>
<blockquote>
<p>æ³¨è§£æ€ä¹ˆä½¿ç”¨ï¼Ÿ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨æ³•ç®€å•ï¼Œè¯­æ³•æ ¼å¼ï¼š@æ³¨è§£ç±»å‹å(å±æ€§å&#x3D;å±æ€§å€¼, å±æ€§å&#x3D;å±æ€§å€¼, å±æ€§å&#x3D;å±æ€§å€¼â€¦â€¦)</p>
<p><code>userBean</code> ä¸ºä»€ä¹ˆä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå› ä¸º value å±æ€§æ˜¯ String ç±»å‹ï¼Œå­—ç¬¦ä¸²ã€‚</p>
<p>å¦å¤–å¦‚æœå±æ€§åæ˜¯ value ï¼Œåˆ™åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥çœç•¥å±æ€§åï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡åå°„æœºåˆ¶æ€ä¹ˆè¯»å–æ³¨è§£ï¼Ÿ</p>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å†™ä¸€æ®µç¨‹åºï¼Œå½“ Bean ç±»ä¸Šæœ‰ <code>Component</code> æ³¨è§£æ—¶ï¼Œåˆ™å®ä¾‹åŒ– Bean å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¸å®ä¾‹åŒ–å¯¹è±¡ã€‚</p>
<p>æˆ‘ä»¬å‡†å¤‡ä¸¤ä¸ª Bean ï¼Œä¸€ä¸ªä¸Šé¢æœ‰æ³¨è§£ï¼Œä¸€ä¸ªä¸Šé¢æ²¡æœ‰æ³¨è§£ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡è®¾æˆ‘ä»¬ç°åœ¨åªçŸ¥é“åŒ…åï¼š<code>com.muyoukule.bean</code> ã€‚è‡³äºè¿™ä¸ªåŒ…ä¸‹æœ‰å¤šå°‘ä¸ª Bean æˆ‘ä»¬ä¸çŸ¥é“ã€‚å“ªäº› Bean ä¸Šæœ‰æ³¨è§£ï¼Œå“ªäº› Bean ä¸Šæ²¡æœ‰æ³¨è§£ï¼Œè¿™äº›æˆ‘ä»¬éƒ½ä¸çŸ¥é“ï¼Œå¦‚ä½•é€šè¿‡ç¨‹åºå…¨è‡ªåŠ¨åŒ–åˆ¤æ–­ã€‚</p>
<p>a. åå°„è§£ææ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ComponentScan</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// å­˜æ”¾Beançš„Mapé›†åˆã€‚keyå­˜å‚¨beanIdã€‚valueå­˜å‚¨Beanã€‚</span></span><br><span class="line">        Map&lt;String, Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">packageName</span> <span class="operator">=</span> <span class="string">&quot;com.muyoukule.Bean&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> packageName.replaceAll(<span class="string">&quot;\\.&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader().getResource(path);</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url.getPath());</span><br><span class="line">        File[] files = file.listFiles();</span><br><span class="line">        Arrays.stream(files).forEach(f -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> packageName + <span class="string">&quot;.&quot;</span> + f.getName().split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">                <span class="keyword">if</span> (clazz.isAnnotationPresent(Component.class)) &#123;</span><br><span class="line">                    <span class="type">Component</span> <span class="variable">component</span> <span class="operator">=</span> clazz.getAnnotation(Component.class);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span> component.value();</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">bean</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                    beanMap.put(beanId, bean);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(beanMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;userBean=com.muyoukule.Bean.User@27fa135a&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨ï¼šå¦‚æœé¡¹ç›®å­˜æ”¾è·¯å¾„æœ‰ä¸­æ–‡æˆ–è€…ç©ºæ ¼å¯èƒ½ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸</strong></p>
<h2 id="1-2-å£°æ˜Beançš„æ³¨è§£"><a href="#1-2-å£°æ˜Beançš„æ³¨è§£" class="headerlink" title="1.2  å£°æ˜Beançš„æ³¨è§£"></a>1.2  å£°æ˜Beançš„æ³¨è§£</h2><p>è´Ÿè´£å£°æ˜ Bean çš„æ³¨è§£ï¼Œå¸¸è§çš„åŒ…æ‹¬å››ä¸ªï¼š</p>
<ul>
<li><code>@Component</code></li>
<li><code>@Controller</code></li>
<li><code>@Service</code></li>
<li><code>@Repository</code></li>
</ul>
<p>æºç å¦‚ä¸‹ï¼š</p>
<p><code>@Component</code> æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Controller</code> æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Controller &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Service</code> æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Service &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Repository</code> æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Repository &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æºç å¯ä»¥çœ‹åˆ°ï¼Œ<code>@Controller</code> ã€<code>@Service</code> ã€<code>@Repository</code> è¿™ä¸‰ä¸ªæ³¨è§£éƒ½æ˜¯ <code>@Component</code> æ³¨è§£çš„åˆ«åã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šè¿™å››ä¸ªæ³¨è§£çš„åŠŸèƒ½éƒ½ä¸€æ ·ã€‚ç”¨å“ªä¸ªéƒ½å¯ä»¥ã€‚</p>
<p>åªæ˜¯ä¸ºäº†å¢å¼ºç¨‹åºçš„å¯è¯»æ€§ï¼Œå»ºè®®ï¼š</p>
<ul>
<li>æ§åˆ¶å™¨ç±»ä¸Šä½¿ç”¨ï¼šController</li>
<li>Serviceç±»ä¸Šä½¿ç”¨ï¼šService</li>
<li>Daoç±»ä¸Šä½¿ç”¨ï¼šRepository</li>
</ul>
<p>ä»–ä»¬éƒ½æ˜¯åªæœ‰ä¸€ä¸ª value å±æ€§ã€‚valueå±æ€§ç”¨æ¥æŒ‡å®š bean çš„ idï¼Œä¹Ÿå°±æ˜¯ bean çš„åå­—ã€‚</p>
<h2 id="1-3-Springæ³¨è§£çš„ä½¿ç”¨"><a href="#1-3-Springæ³¨è§£çš„ä½¿ç”¨" class="headerlink" title="1.3 Springæ³¨è§£çš„ä½¿ç”¨"></a>1.3 Springæ³¨è§£çš„ä½¿ç”¨</h2><p>å¦‚ä½•ä½¿ç”¨ä»¥ä¸Šçš„æ³¨è§£å‘¢ï¼Ÿ</p>
<ol>
<li>åŠ å…¥aopçš„ä¾èµ–</li>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  <code>context</code> å‘½åç©ºé—´</li>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæ‰«æçš„åŒ…</li>
<li>åœ¨Beanç±»ä¸Šä½¿ç”¨æ³¨è§£</li>
</ol>
<p>a. åŠ å…¥aopçš„ä¾èµ–ï¼š</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“åŠ å…¥ <code>spring-contex</code>t ä¾èµ–ä¹‹åï¼Œä¼šå…³è”åŠ å…¥ <code>aop</code> çš„ä¾èµ–ã€‚æ‰€ä»¥è¿™ä¸€æ­¥ä¸ç”¨åšã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/aop%E7%9A%84%E4%BE%9D%E8%B5%96.png"></p>
<p>b. åœ¨é…ç½®æ–‡ä»¶ <code>spring.xml</code> ä¸­æ·»åŠ contextå‘½åç©ºé—´</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. åœ¨é…ç½®æ–‡ä»¶ <code>spring.xml</code> ä¸­æŒ‡å®šè¦æ‰«æçš„åŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Bean&quot;</span>/&gt;</span> </span><br></pre></td></tr></table></figure>

<p>d. åœ¨Beanç±»ä¸Šä½¿ç”¨æ³¨è§£</p>
<p>è¿™é‡Œä¸€å®šè¦æ³¨æ„æ˜¯ä½¿ç”¨ <code>org.springframework.stereotype</code> åŒ…ä¸‹çš„ <code>@Component</code> ï¼Œä¸æ˜¯ä¸Šé¢è‡ªå®šä¹‰çš„<code>@Component</code> ğŸ˜¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. ç¼–å†™æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBean</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(userBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.User@a43ce46</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ³¨è§£çš„å±æ€§åæ˜¯valueï¼Œé‚£ä¹ˆvalueæ˜¯å¯ä»¥çœç•¥çš„ã€‚</p>
<p>å¦‚æœæŠŠvalueå±æ€§å½»åº•å»æ‰ï¼Œspringä¼šè¢« Bean è‡ªåŠ¨å–åï¼Œå¹¶ä¸”é»˜è®¤åå­—çš„è§„å¾‹æ˜¯ï¼šBeanç±»åé¦–å­—æ¯å°å†™å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankDao</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª BankDao çš„ bean çš„åå­—ä¸ºï¼šbankDao</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.BankDao@2320fa6f</span><br></pre></td></tr></table></figure>

<p><strong>å¦‚æœæ˜¯å¤šä¸ªåŒ…æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå¤šä¸ªåŒ…ï¼Œç”¨é€—å·éš”å¼€ã€‚</li>
<li>æŒ‡å®šå¤šä¸ªåŒ…çš„å…±åŒçˆ¶åŒ…ã€‚</li>
</ol>
<blockquote>
<p>é€—å·ï¼ˆè‹±æ–‡ï¼‰çš„æ–¹å¼</p>
</blockquote>
<p>a. åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…ï¼šBean2ï¼Œå®šä¹‰ä¸€ä¸ªBeanç±»Order</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. é…ç½®æ–‡ä»¶ <code>spring.xml</code> ä¸­ä¿®æ”¹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--1.åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå¤šä¸ªåŒ…ï¼Œç”¨é€—å·éš”å¼€ã€‚--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;context:component-scan base-package=&quot;com.muyoukule.Bean,com.muyoukule.Bean2&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--2.æŒ‡å®šå¤šä¸ªåŒ…çš„å…±åŒçˆ¶åŒ…ã€‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Bean.BankDao@37052337</span><br><span class="line">com.muyoukule.Bean2.Order@2320fa6f</span><br></pre></td></tr></table></figure>

<h2 id="1-4-é€‰æ‹©æ€§å®ä¾‹åŒ–Bean"><a href="#1-4-é€‰æ‹©æ€§å®ä¾‹åŒ–Bean" class="headerlink" title="1.4 é€‰æ‹©æ€§å®ä¾‹åŒ–Bean"></a>1.4 é€‰æ‹©æ€§å®ä¾‹åŒ–Bean</h2><p>å‡è®¾åœ¨æŸä¸ªåŒ…ä¸‹æœ‰å¾ˆå¤š Beanï¼Œæœ‰çš„ Beanä¸Š æ ‡æ³¨äº† <code>@Component</code>ï¼Œæœ‰çš„æ ‡æ³¨äº† <code>@Controller</code>ï¼Œæœ‰çš„æ ‡æ³¨äº† <code>@Service</code>ï¼Œæœ‰çš„æ ‡æ³¨äº† <code>@Repository</code>ï¼Œç°åœ¨ç”±äºæŸç§ç‰¹æ®Šä¸šåŠ¡çš„éœ€è¦ï¼Œåªå…è®¸å…¶ä¸­æ‰€æœ‰çš„ <code>@Controller</code> å‚ä¸ Bean ç®¡ç†ï¼Œå…¶ä»–çš„éƒ½ä¸å®ä¾‹åŒ–ã€‚è¿™åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>a. ä¸ºäº†æ–¹ä¾¿ï¼Œå°†è¿™å‡ ä¸ªç±»éƒ½å®šä¹‰åˆ°åŒä¸€ä¸ªjavaæºæ–‡ä»¶ä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">A</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Açš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">B</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">C</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Cçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">D</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Dçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">E</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">E</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Eçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">F</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">F</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Fçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åªæƒ³å®ä¾‹åŒ– Bean3 åŒ…ä¸‹çš„ <code>@Controller</code>ã€‚é…ç½®æ–‡ä»¶è¿™æ ·å†™ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Bean3&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>use-default-filters=&quot;true&quot;</code> è¡¨ç¤ºï¼šä½¿ç”¨ spring é»˜è®¤çš„è§„åˆ™ï¼Œåªè¦æœ‰ <code>@Component</code> ã€<code>@Controller</code> ã€<code>@Service</code> ã€<code>@Repository</code>  ä¸­çš„ä»»æ„ä¸€ä¸ªæ³¨è§£æ ‡æ³¨ï¼Œåˆ™è¿›è¡Œå®ä¾‹åŒ–ã€‚</p>
<p><code>use-default-filters=&quot;false&quot;</code> è¡¨ç¤ºï¼šä¸å† spring é»˜è®¤å®ä¾‹åŒ–è§„åˆ™ï¼Œå³ä½¿æœ‰ <code>@Component</code> ã€<code>@Controller</code> ã€<code>@Service</code> ã€<code>@Repository</code>  è¿™äº›æ³¨è§£æ ‡æ³¨ï¼Œä¹Ÿä¸å†å®ä¾‹åŒ–ã€‚</p>
<p><code>&lt;context:include-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot;/&gt;</code> è¡¨ç¤ºåªæœ‰<code>@Controller</code> è¿›è¡Œå®ä¾‹åŒ–</p>
<p>c. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testChoose</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Bçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br><span class="line">Eçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br><span class="line">Fçš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥å°† <code>use-default-filters</code> è®¾ç½®ä¸º trueï¼ˆä¸å†™å°±æ˜¯trueï¼‰ï¼Œå¹¶ä¸”é‡‡ç”¨ <code>exclude-filter</code> æ–¹å¼æ’å‡ºå“ªäº›æ³¨è§£æ ‡æ³¨çš„ Bean ä¸å‚ä¸å®ä¾‹åŒ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Bean3&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Repository&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Service&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Açš„æ— å‚æ•°æ„é€ æ–¹æ³•æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<h2 id="1-5-è´Ÿè´£æ³¨å…¥çš„æ³¨è§£"><a href="#1-5-è´Ÿè´£æ³¨å…¥çš„æ³¨è§£" class="headerlink" title="1.5 è´Ÿè´£æ³¨å…¥çš„æ³¨è§£"></a>1.5 è´Ÿè´£æ³¨å…¥çš„æ³¨è§£</h2><p> <code>@Component</code> ã€<code>@Controller</code> ã€<code>@Service</code> ã€<code>@Repository</code>  è¿™å››ä¸ªæ³¨è§£æ˜¯ç”¨æ¥å£°æ˜ Bean çš„ï¼Œå£°æ˜åè¿™äº› Bean å°†è¢«å®ä¾‹åŒ–ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•ç»™ Bean çš„å±æ€§èµ‹å€¼ã€‚ç»™Beanå±æ€§èµ‹å€¼éœ€è¦ç”¨åˆ°è¿™äº›æ³¨è§£ï¼š</p>
<p><code>@Value</code> ã€<code>@Autowired</code> ã€<code>@Qualifier</code> ã€<code>@Resource</code></p>
<h3 id="1-5-1-Value"><a href="#1-5-1-Value" class="headerlink" title="1.5.1 @Value"></a>1.5.1 @Value</h3><blockquote>
<p>å±æ€§çš„ç±»å‹æ˜¯ç®€å•ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ @Value æ³¨è§£è¿›è¡Œæ³¨å…¥</p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Value(value = &quot;zhangsan&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;20&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. å¼€å¯åŒ…æ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Bean4&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(name=zhangsan, age=20)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç»™å±æ€§æä¾› <code>setter</code> æ–¹æ³•ï¼Œä½†ä»ç„¶å¯ä»¥å®Œæˆå±æ€§èµ‹å€¼ã€‚</p>
<blockquote>
<p>æä¾› setter æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ setter æ–¹æ³•ä¸Šæ·»åŠ  @Value æ³¨è§£ï¼Œä¹Ÿå¯ä»¥å®Œæˆæ³¨å…¥</p>
</blockquote>
<p>a. ä¿®æ”¹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;æå››&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;30&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(name=æå››, age=30)</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œä»¥åæˆ‘ä»¬ä¸€èˆ¬ä¸æä¾› <code>setter</code> æ–¹æ³•ï¼Œç›´æ¥åœ¨å±æ€§ä¸Šä½¿ç”¨ <code>@Value</code> æ³¨è§£å®Œæˆå±æ€§èµ‹å€¼ã€‚</p>
<blockquote>
<p>ä¹Ÿèƒ½å¤Ÿé€šè¿‡æ„é€ æ–¹æ³•å®Œæˆæ³¨å…¥</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(<span class="meta">@Value(&quot;éš”å£è€ç‹&quot;)</span> String name, <span class="meta">@Value(&quot;33&quot;)</span> <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(name=éš”å£è€ç‹, age=33)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼š<code>@Value</code> æ³¨è§£å¯ä»¥å‡ºç°åœ¨å±æ€§ä¸Šã€<code>setter</code> æ–¹æ³•ä¸Šã€æ„é€ æ–¹æ³•çš„å½¢å‚ä¸Šã€‚</p>
<h3 id="1-5-2-Autowiredä¸-Qualifier"><a href="#1-5-2-Autowiredä¸-Qualifier" class="headerlink" title="1.5.2 @Autowiredä¸@Qualifier"></a>1.5.2 @Autowiredä¸@Qualifier</h3><p><code>@Autowired</code> æ³¨è§£å¯ä»¥ç”¨æ¥æ³¨å…¥<strong>éç®€å•ç±»å‹</strong>ã€‚è¢«ç¿»è¯‘ä¸ºï¼šè‡ªåŠ¨è¿çº¿çš„ï¼Œæˆ–è€…è‡ªåŠ¨è£…é…ã€‚</p>
<p>å•ç‹¬ä½¿ç”¨ <code>@Autowired</code> æ³¨è§£ï¼Œ<strong>é»˜è®¤æ ¹æ®ç±»å‹è£…é…</strong>ã€‚ã€é»˜è®¤æ˜¯ byType ã€‘</p>
<p>çœ‹ä¸€ä¸‹ <code>@Autowiredæºç </code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.CONSTRUCTOR, ElementType.METHOD, ElementType.PARAMETER, ElementType.FIELD, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired &#123;</span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æºç ä¸­æœ‰ä¸¤å¤„éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€å¤„ï¼šè¯¥æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨å“ªé‡Œï¼Ÿ</p>
<ul>
<li>æ„é€ æ–¹æ³•ä¸Š</li>
<li>æ–¹æ³•ä¸Š</li>
<li>å½¢å‚ä¸Š</li>
<li>å±æ€§ä¸Š</li>
<li>æ³¨è§£ä¸Š</li>
</ul>
</li>
<li><p>ç¬¬äºŒå¤„ï¼šè¯¥æ³¨è§£æœ‰ä¸€ä¸ª <code>required</code> å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯ trueï¼Œè¡¨ç¤ºåœ¨æ³¨å…¥çš„æ—¶å€™è¦æ±‚è¢«æ³¨å…¥çš„ Bean å¿…é¡»æ˜¯å­˜åœ¨çš„ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æŠ¥é”™ã€‚å¦‚æœ <code>required</code> å±æ€§è®¾ç½®ä¸º falseï¼Œè¡¨ç¤ºæ³¨å…¥çš„ Bean å­˜åœ¨æˆ–è€…ä¸å­˜åœ¨éƒ½æ²¡å…³ç³»ï¼Œå­˜åœ¨çš„è¯å°±æ³¨å…¥ï¼Œä¸å­˜åœ¨çš„è¯ï¼Œä¹Ÿä¸æŠ¥é”™ã€‚</p>
</li>
</ul>
<blockquote>
<p>åœ¨å±æ€§ä¸Šä½¿ç”¨ @Autowired æ³¨è§£</p>
</blockquote>
<p>a. åˆ›å»ºå¦‚ä¸‹ç±»</p>
<p>UserDaoæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UserDaoå®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//çº³å…¥beanç®¡ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForMySQL</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å‘mysqlæ•°æ®åº“æ’å…¥Useræ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UserService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span> <span class="comment">// çº³å…¥beanç®¡ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span> <span class="comment">// åœ¨å±æ€§ä¸Šæ³¨å…¥</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ²¡æœ‰æä¾›æ„é€ æ–¹æ³•å’Œsetteræ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. é…ç½®åŒ…æ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Dao,com.muyoukule.Service&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAutowired</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘mysqlæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨setteræ–¹æ³•ä½¿ç”¨ @Autowired æ³¨è§£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨æ„é€ æ–¹æ³•ä½¿ç”¨ @Autowired æ³¨è§£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åªåœ¨æ„é€ æ–¹æ³•çš„å½¢å‚ä½¿ç”¨ @Autowired æ³¨è§£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">(<span class="meta">@Autowired</span> UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•åªæœ‰ä¸€ä¸ªæ—¶ï¼Œ@Autowired æ³¨è§£å¯ä»¥çœç•¥</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå‡ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘mysqlæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœæœ‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼Œ@Autowired è‚¯å®šæ˜¯ä¸èƒ½çœç•¥çš„</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E7%9C%81%E7%95%A5@Autowired.png"></p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ¸…æ¥š <code>@Autowired</code> æ³¨è§£å¯ä»¥å‡ºç°åœ¨å“ªäº›ä½ç½®äº†ã€‚</p>
<p><code>@Autowired</code> æ³¨è§£é»˜è®¤æ˜¯ <code>byType</code> è¿›è¡Œæ³¨å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ ¹æ®ç±»å‹æ³¨å…¥çš„ï¼Œå¦‚æœä»¥ä¸Šç¨‹åºä¸­ï¼ŒUserDao æ¥å£è¿˜æœ‰å¦å¤–ä¸€ä¸ªå®ç°ç±»ï¼Œä¼šå‡ºç°é—®é¢˜å—ï¼Ÿ</p>
<p><code>UserDaoForOracle</code> ï¼Œæ¥å£å¦ä¸€ä¸ªå®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//çº³å…¥beanç®¡ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ï¼Œç¨‹åºæŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">No qualifying bean of type &#x27;com.muyoukule.Dao.UserDao&#x27; available: expected single matching bean but found 2: userDaoForMySQL,userDaoForOracle</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡ <code>byName</code> ï¼Œæ ¹æ®åç§°è¿›è¡Œè£…é…è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><code>@Autowired</code> æ³¨è§£å’Œ <code>@Qualifier</code> æ³¨è§£è”åˆèµ·æ¥æ‰å¯ä»¥æ ¹æ®åç§°è¿›è¡Œè£…é…ï¼Œåœ¨ <code>@Qualifier</code> æ³¨è§£ä¸­æŒ‡å®š Bean åç§°</p>
<p>UserDaoForOracle</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">// è¿™é‡Œæ²¡æœ‰ç»™beanèµ·åï¼Œé»˜è®¤åå­—æ˜¯ï¼šuserDaoForOracle</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UserService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDaoForOracle&quot;)</span> <span class="comment">// è¿™ä¸ªæ˜¯beançš„åå­—ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼š</p>
<ul>
<li><code>@Autowired</code> æ³¨è§£å¯ä»¥å‡ºç°åœ¨ï¼šå±æ€§ä¸Šã€æ„é€ æ–¹æ³•ä¸Šã€æ„é€ æ–¹æ³•çš„å‚æ•°ä¸Šã€setteræ–¹æ³•ä¸Šã€‚</li>
<li>å½“å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼Œ<code>@Autowired</code> æ³¨è§£å¯ä»¥çœç•¥ã€‚</li>
<li><code>@Autowired</code> æ³¨è§£é»˜è®¤æ ¹æ®ç±»å‹æ³¨å…¥ã€‚å¦‚æœè¦æ ¹æ®åç§°æ³¨å…¥çš„è¯ï¼Œéœ€è¦é…åˆ <code>@Qualifier</code> æ³¨è§£ä¸€èµ·ä½¿ç”¨ã€‚</li>
</ul>
<h3 id="1-5-3-Resource"><a href="#1-5-3-Resource" class="headerlink" title="1.5.3 @Resource"></a>1.5.3 @Resource</h3><p><code>@Resource</code> æ³¨è§£ä¹Ÿå¯ä»¥å®Œæˆéç®€å•ç±»å‹æ³¨å…¥ã€‚é‚£å®ƒå’Œ <code>@Autowired</code> æ³¨è§£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li><code>@Resource</code> æ³¨è§£æ˜¯ JDK æ‰©å±•åŒ…ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å±äº JDK çš„ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥è¯¥æ³¨è§£æ˜¯æ ‡å‡†æ³¨è§£ï¼Œæ›´åŠ å…·æœ‰é€šç”¨æ€§ã€‚(JSR-250æ ‡å‡†ä¸­åˆ¶å®šçš„æ³¨è§£ç±»å‹ã€‚JSRæ˜¯Javaè§„èŒƒææ¡ˆã€‚)</li>
<li><code>@Autowired</code> æ³¨è§£æ˜¯ Spring æ¡†æ¶è‡ªå·±çš„ã€‚</li>
<li><code>@Resource</code> æ³¨è§£é»˜è®¤æ ¹æ®åç§°è£…é… <code>byName</code>ï¼ŒæœªæŒ‡å®š name æ—¶ï¼Œä½¿ç”¨å±æ€§åä½œä¸º nameã€‚é€šè¿‡ name æ‰¾ä¸åˆ°çš„è¯ä¼šè‡ªåŠ¨å¯åŠ¨é€šè¿‡ç±»å‹ <code>byType</code> è£…é…ã€‚</li>
<li><code>@Autowired</code> æ³¨è§£é»˜è®¤æ ¹æ®ç±»å‹è£…é… <code>byType</code>ï¼Œå¦‚æœæƒ³æ ¹æ®åç§°è£…é…ï¼Œéœ€è¦é…åˆ <code>@Qualifier</code> æ³¨è§£ä¸€èµ·ç”¨ã€‚</li>
<li><code>@Resource</code> æ³¨è§£ç”¨åœ¨å±æ€§ä¸Šã€<code>setter</code> æ–¹æ³•ä¸Šã€‚</li>
<li><code>@Autowired</code> æ³¨è§£ç”¨åœ¨å±æ€§ä¸Šã€<code>setter</code> æ–¹æ³•ä¸Šã€æ„é€ æ–¹æ³•ä¸Šã€æ„é€ æ–¹æ³•å‚æ•°ä¸Šã€‚</li>
</ul>
<p><code>@Resource</code> æ³¨è§£å±äº JDK æ‰©å±•åŒ…ï¼Œæ‰€ä»¥ä¸åœ¨ JDK å½“ä¸­ï¼Œéœ€è¦é¢å¤–å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼šã€<strong>å¦‚æœæ˜¯JDK8çš„è¯ä¸éœ€è¦é¢å¤–å¼•å…¥ä¾èµ–ã€‚é«˜äºJDK11æˆ–ä½äºJDK8éœ€è¦å¼•å…¥ä»¥ä¸‹ä¾èµ–ã€‚</strong>ã€‘</p>
<blockquote>
<p>Spring6+ç‰ˆæœ¬</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;<span class="number">2.1</span><span class="number">.1</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸€å®šè¦æ³¨æ„ï¼šå¦‚æœä½ ç”¨ Spring6ï¼Œè¦çŸ¥é“ Spring6 ä¸å†æ”¯æŒ JavaEEï¼Œå®ƒæ”¯æŒçš„æ˜¯ JakartaEE9ã€‚ï¼ˆOracle æŠŠ JavaEEè´¡çŒ®ç»™ Apache äº†ï¼ŒApache æŠŠ JavaEE çš„åå­—æ”¹æˆ JakartaEE äº†ï¼Œå¤§å®¶ä¹‹å‰æ‰€æ¥è§¦çš„æ‰€æœ‰çš„  javax.*  åŒ…åç»Ÿä¸€ä¿®æ”¹ä¸º  jakarta.* åŒ…åäº†ã€‚ï¼‰</p>
<blockquote>
<p>Spring5-ç‰ˆæœ¬</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ·»åŠ ä¾èµ–ï¼Œä½¿ç”¨ @Resource æ³¨è§£</p>
</blockquote>
<p>a. ç»™è¿™ä¸ª UserDaoForOracle èµ·å xyz</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;xyz&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨UserServiceä¸­ä½¿ç”¨ <code>@Resource</code> æ³¨è§£æ ¹æ® name æ³¨å…¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;xyz&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“ @Resource æ³¨è§£ä½¿ç”¨æ—¶æ²¡æœ‰æŒ‡å®šnameçš„æ—¶å€™ï¼Œè¿˜æ˜¯æ ¹æ® name è¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿™ä¸ª name æ˜¯å±æ€§å</p>
</blockquote>
<p>a. æŠŠ UserDaoForOracle çš„åå­— xyz ä¿®æ”¹ä¸º userDaoï¼Œè®©è¿™ä¸ª Bean çš„åå­—å’Œ UserService ç±»ä¸­çš„ UserDao å±æ€§åä¸€è‡´</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;userDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. UserServiceç±»ä¸­ <code>@Resource</code> æ³¨è§£å¹¶æ²¡æœ‰æŒ‡å®š name</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<p>æŠŠ UserService ç±»ä¸­çš„å±æ€§åä¿®æ”¹ä¸€ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao2.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœï¼Œç¨‹åºæŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">No qualifying bean of type &#x27;com.muyoukule.Dao.UserDao&#x27; available: expected single matching bean but found 2: userDaoForMySQL,userDao</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å¼‚å¸¸ä¿¡æ¯å¾—çŸ¥ï¼šå½“é€šè¿‡ name æ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œè‡ªç„¶ä¼šå¯åŠ¨ <code>byType</code> è¿›è¡Œæ³¨å…¥ã€‚ä»¥ä¸Šçš„é”™è¯¯æ˜¯å› ä¸º UserDao æ¥å£ä¸‹æœ‰ä¸¤ä¸ªå®ç°ç±»å¯¼è‡´çš„ã€‚æ‰€ä»¥æ ¹æ®ç±»å‹æ³¨å…¥å°±ä¼šæŠ¥é”™ã€‚</p>
<blockquote>
<p>@Resource æ³¨è§£å¯ä»¥åœ¨ setter æ–¹æ³•ä¸Šä½¿ç”¨</p>
</blockquote>
<p>UserServiceæ·»åŠ  <code>setter</code> æ–¹æ³•å¹¶ä½¿ç”¨æ³¨è§£æ ‡æ³¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™ä¸ª <code>setter</code> æ–¹æ³•çš„æ–¹æ³•åï¼ŒsetUserDao å»æ‰ set ä¹‹åï¼Œå°†é¦–å­—æ¯å˜å°å†™ userDaoï¼ŒuserDao å°±æ˜¯ name</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘Oracleæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥æŒ‡å®š name </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;userDaoForMySQL&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘mysqlæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“ï¼š</strong></p>
<p><code>@Resource</code> æ³¨è§£ï¼šé»˜è®¤ <code>byName</code> æ³¨å…¥ï¼Œæ²¡æœ‰æŒ‡å®š name æ—¶æŠŠå±æ€§åå½“åš nameï¼Œæ ¹æ® name æ‰¾ä¸åˆ°æ—¶ï¼Œæ‰ä¼š <code>byType</code> æ³¨å…¥ã€‚<code>byType</code> æ³¨å…¥æ—¶ï¼ŒæŸç§ç±»å‹çš„ Bean åªèƒ½æœ‰ä¸€ä¸ªã€‚</p>
<h2 id="1-6-å…¨æ³¨è§£å¼å¼€å‘"><a href="#1-6-å…¨æ³¨è§£å¼å¼€å‘" class="headerlink" title="1.6 å…¨æ³¨è§£å¼å¼€å‘"></a>1.6 å…¨æ³¨è§£å¼å¼€å‘</h2><p>ä¸Šé¢å·²ç»å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥é…ç½® bean ,ä½†æ˜¯ä¾ç„¶æœ‰ç”¨åˆ°é…ç½®æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­å¯¹åŒ…è¿›è¡Œäº†æ‰«æï¼ŒSpring åœ¨3.0ç‰ˆå·²ç»æ”¯æŒçº¯æ³¨è§£å¼€å‘</p>
<ul>
<li>Spring3.0å¼€å¯äº†çº¯æ³¨è§£å¼€å‘æ¨¡å¼ï¼Œä½¿ç”¨ Java ç±»æ›¿ä»£é…ç½®æ–‡ä»¶ï¼Œå¼€å¯äº† Spring å¿«é€Ÿå¼€å‘èµ›é“ï¼Œå…·ä½“å¦‚ä½•å®ç°?</li>
</ul>
<p>æ‰€è°“çš„å…¨æ³¨è§£å¼€å‘å°±æ˜¯ä¸å†ä½¿ç”¨ spring é…ç½®æ–‡ä»¶äº†ã€‚å†™ä¸€ä¸ªé…ç½®ç±»æ¥ä»£æ›¿é…ç½®æ–‡ä»¶ã€‚</p>
<blockquote>
<p>æ€è·¯åˆ†æ</p>
</blockquote>
<p>å®ç°æ€è·¯ä¸º: </p>
<ul>
<li>å°†é…ç½®æ–‡ä»¶ <code>spring.xml</code> åˆ é™¤æ‰ï¼Œä½¿ç”¨ç±»æ¥æ›¿æ¢ã€‚</li>
</ul>
<blockquote>
<p>å®ç°æ­¥éª¤</p>
</blockquote>
<p>a. åˆ›å»ºä¸€ä¸ªé…ç½®ç±»</p>
<p>åˆ›å»ºä¸€ä¸ªé…ç½®ç±» <code>SpringConfig</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. æ ‡è¯†è¯¥ç±»ä¸ºé…ç½®ç±»</p>
<p>åœ¨é…ç½®ç±»ä¸Šæ·»åŠ  <code>@Configuration</code> æ³¨è§£ï¼Œå°†å…¶æ ‡è¯†ä¸ºä¸€ä¸ªé…ç½®ç±»ï¼Œæ›¿æ¢ <code>spring.xml</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç”¨æ³¨è§£æ›¿æ¢åŒ…æ‰«æé…ç½®</p>
<p>åœ¨é…ç½®ç±»ä¸Šæ·»åŠ åŒ…æ‰«ææ³¨è§£ <code>@ComponentScan</code> æ›¿æ¢ <code>&lt;context:component-scan base-package=&quot;&quot;/&gt;</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. ç¼–å†™æµ‹è¯•ç¨‹åºï¼šä¸å† <code>new ClassPathXmlApplicationContext()</code> å¯¹è±¡äº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testNoXml</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨å‘mysqlæ•°æ®åº“æ’å…¥Useræ•°æ®...</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œçº¯æ³¨è§£å¼€å‘çš„æ–¹å¼å°±å·²ç»å®Œæˆäº†ï¼Œä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>Javaç±»æ›¿æ¢ Spring æ ¸å¿ƒé…ç½®æ–‡ä»¶</p>
</li>
<li><p><code>@Configuration</code> æ³¨è§£ç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»</p>
</li>
<li><p><code>@ComponentScan</code> æ³¨è§£ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨è§£åªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®è¯·ç”¨æ•°ç»„æ ¼å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@ComponentScan(&#123;&quot;com.muyoukule.service&quot;,&quot;com.muyoukule.dao&quot;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¯»å– Spring æ ¸å¿ƒé…ç½®æ–‡ä»¶åˆå§‹åŒ–å®¹å™¨å¯¹è±¡åˆ‡æ¢ä¸ºè¯»å– Java é…ç½®ç±»åˆå§‹åŒ–å®¹å™¨å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åŠ è½½é…ç½®æ–‡ä»¶åˆå§‹åŒ–å®¹å™¨</span></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line"><span class="comment">//åŠ è½½é…ç½®ç±»åˆå§‹åŒ–å®¹å™¨</span></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="1-7-IOC-DIæ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean"><a href="#1-7-IOC-DIæ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean" class="headerlink" title="1.7 IOC&#x2F;DIæ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean"></a>1.7 IOC&#x2F;DIæ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean</h2><blockquote>
<p>å‡†å¤‡ç¯å¢ƒ</p>
</blockquote>
<p>a. æ–°å»ºspring_009æ¨¡å—</p>
<p>b. <code>pom.xml</code> æ·»åŠ  Spring çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æ·»åŠ ä¸€ä¸ªé…ç½®ç±» <code>SpringConfig</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. æ·»åŠ BookDaoã€BookDaoImplç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. åˆ›å»ºè¿è¡Œç±»App</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-7-1-æ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean"><a href="#1-7-1-æ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean" class="headerlink" title="1.7.1 æ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean"></a>1.7.1 æ³¨è§£å¼€å‘ç®¡ç†ç¬¬ä¸‰æ–¹bean</h3><blockquote>
<p>åœ¨ä¸Šè¿°ç¯å¢ƒä¸­å®Œæˆå¯¹ Druid æ•°æ®æºçš„ç®¡ç†</p>
</blockquote>
<p>a. å¯¼å…¥å¯¹åº”çš„ jar åŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. åœ¨é…ç½®ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•</p>
<p>æ³¨æ„è¯¥æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯è¦åˆ›å»ºçš„ Bean å¯¹è±¡ç±»å‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. åœ¨æ–¹æ³•ä¸Šæ·»åŠ  <code>@Bean</code> æ³¨è§£</p>
<p><code>@Bean</code> æ³¨è§£çš„ä½œç”¨æ˜¯å°†æ–¹æ³•çš„è¿”å›å€¼åˆ¶ä½œä¸º Spring ç®¡ç†çš„ä¸€ä¸ª bean å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**æ³¨æ„ï¼šä¸èƒ½ä½¿ç”¨ <code>DataSource ds = new DruidDataSource()</code>  **ï¼Œå› ä¸º DataSource æ¥å£ä¸­æ²¡æœ‰å¯¹åº”çš„ <code>setter</code> æ–¹æ³•æ¥è®¾ç½®å±æ€§ã€‚</p>
<p>d. ä»IOCå®¹å™¨ä¸­è·å–å¯¹è±¡å¹¶æ‰“å°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> ctx.getBean(DataSource.class);</span><br><span class="line">        System.out.println(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	CreateTime:&quot;2023-03-16 15:05:54&quot;,</span><br><span class="line">	ActiveCount:0,</span><br><span class="line">	PoolingCount:0,</span><br><span class="line">	CreateCount:0,</span><br><span class="line">	DestroyCount:0,</span><br><span class="line">	CloseCount:0,</span><br><span class="line">	ConnectCount:0,</span><br><span class="line">	Connections:[</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰å¤šä¸ª bean è¦è¢« Spring ç®¡ç†ï¼Œç›´æ¥åœ¨é…ç½®ç±»ä¸­å¤šäº›å‡ ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•ä¸Šæ·»åŠ  <code>@Bean</code> æ³¨è§£å³å¯ã€‚</p>
<h3 id="1-7-2-å¼•å…¥å¤–éƒ¨é…ç½®ç±»"><a href="#1-7-2-å¼•å…¥å¤–éƒ¨é…ç½®ç±»" class="headerlink" title="1.7.2 å¼•å…¥å¤–éƒ¨é…ç½®ç±»"></a>1.7.2 å¼•å…¥å¤–éƒ¨é…ç½®ç±»</h3><p>å¦‚æœæŠŠæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹ bean éƒ½é…ç½®åˆ° Spring çš„é…ç½®ç±» <code>SpringConfig</code> ä¸­ï¼Œè™½ç„¶å¯ä»¥ï¼Œä½†æ˜¯ä¸åˆ©äºä»£ç é˜…è¯»å’Œåˆ†ç±»ç®¡ç†ï¼Œæ‰€æœ‰æˆ‘ä»¬å°±æƒ³èƒ½ä¸èƒ½æŒ‰ç…§ç±»åˆ«å°†è¿™äº›beané…ç½®åˆ°ä¸åŒçš„é…ç½®ç±»ä¸­?</p>
<p>å¯¹äºæ•°æ®æºçš„bean,æˆ‘ä»¬æ–°å»ºä¸€ä¸ª <code>JdbcConfig</code> é…ç½®ç±»ï¼Œå¹¶æŠŠæ•°æ®æºé…ç½®åˆ°è¯¥ç±»ä¸‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªé…ç½®ç±»å¦‚ä½•èƒ½è¢« Spring é…ç½®ç±»åŠ è½½åˆ°ï¼Œå¹¶åˆ›å»º DataSource å¯¹è±¡åœ¨ IOC å®¹å™¨ä¸­?</p>
<p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆ:</p>
<ol>
<li>ä½¿ç”¨åŒ…æ‰«æå¼•å…¥</li>
<li>ä½¿ç”¨ <code>@Import</code> å¼•å…¥</li>
</ol>
<blockquote>
<p>ä½¿ç”¨åŒ…æ‰«æå¼•å…¥</p>
</blockquote>
<p>a. åœ¨Springçš„é…ç½®ç±»ä¸Šæ·»åŠ åŒ…æ‰«æ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.Config&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨ JdbcConfig ä¸Šæ·»åŠ é…ç½®æ³¨è§£</p>
<p>JdbcConfig ç±»è¦æ”¾å…¥åˆ° <code>com.muyoukule.Config</code> åŒ…ä¸‹ï¼Œéœ€è¦è¢« Spring çš„é…ç½®ç±»æ‰«æåˆ°å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. è¿è¡Œç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	CreateTime:&quot;2023-03-16 15:22:46&quot;,</span><br><span class="line">	ActiveCount:0,</span><br><span class="line">	PoolingCount:0,</span><br><span class="line">	CreateCount:0,</span><br><span class="line">	DestroyCount:0,</span><br><span class="line">	CloseCount:0,</span><br><span class="line">	ConnectCount:0,</span><br><span class="line">	Connections:[</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼è™½ç„¶èƒ½å¤Ÿæ‰«æåˆ°ï¼Œä½†æ˜¯ä¸èƒ½å¾ˆå¿«çš„çŸ¥æ™“éƒ½å¼•å…¥äº†å“ªäº›é…ç½®ç±»ï¼Œæ‰€æœ‰è¿™ç§æ–¹å¼ä¸æ¨èä½¿ç”¨ã€‚</p>
<blockquote>
<p>ä½¿ç”¨ @Import å¼•å…¥</p>
</blockquote>
<p>æ–¹æ¡ˆä¸€å®ç°èµ·æ¥æœ‰ç‚¹å°å¤æ‚ï¼ŒSpring æ—©å°±æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œäºæ˜¯åˆç»™æˆ‘ä»¬æä¾›äº†ç¬¬äºŒç§æ–¹æ¡ˆã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆå¯ä»¥ä¸ç”¨åŠ  <code>@Configuration</code> æ³¨è§£ï¼Œä½†æ˜¯å¿…é¡»åœ¨Springé…ç½®ç±»ä¸Šä½¿ç”¨ <code>@Import</code> æ³¨è§£æ‰‹åŠ¨å¼•å…¥éœ€è¦åŠ è½½çš„é…ç½®ç±»</p>
<p>a. å»é™¤JdbcConfigç±»ä¸Šçš„æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨Springé…ç½®ç±»ä¸­å¼•å…¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//@ComponentScan(&quot;com.muyoukule.Config&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„:</strong></p>
<ul>
<li><p>æ‰«ææ³¨è§£å¯ä»¥ç§»é™¤</p>
</li>
<li><p><code>@Import</code> å‚æ•°éœ€è¦çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥å¼•å…¥å¤šä¸ªé…ç½®ç±»ã€‚</p>
</li>
<li><p><code>@Import</code> æ³¨è§£åœ¨é…ç½®ç±»ä¸­åªèƒ½å†™ä¸€æ¬¡ï¼Œä¸‹é¢çš„æ–¹å¼æ˜¯ä¸å…è®¸çš„ğŸ˜¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//@ComponentScan(&quot;com.zxq.config&quot;)</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="meta">@Import(Xxx.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>c. è¿è¡Œç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	CreateTime:&quot;2024-03-16 15:27:17&quot;,</span><br><span class="line">	ActiveCount:0,</span><br><span class="line">	PoolingCount:0,</span><br><span class="line">	CreateCount:0,</span><br><span class="line">	DestroyCount:0,</span><br><span class="line">	CloseCount:0,</span><br><span class="line">	ConnectCount:0,</span><br><span class="line">	Connections:[</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-7-3-æ³¨è§£å¼€å‘å®ç°ä¸ºç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº"><a href="#1-7-3-æ³¨è§£å¼€å‘å®ç°ä¸ºç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº" class="headerlink" title="1.7.3 æ³¨è§£å¼€å‘å®ç°ä¸ºç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº"></a>1.7.3 æ³¨è§£å¼€å‘å®ç°ä¸ºç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº</h3><p>åœ¨ä½¿ç”¨ @Bean åˆ›å»º bean å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœæ–¹æ³•åœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­éœ€è¦å…¶ä»–èµ„æºè¯¥æ€ä¹ˆåŠ?</p>
<p>è¿™äº›èµ„æºä¼šæœ‰ä¸¤å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ <code>ç®€å•æ•°æ®ç±»å‹</code>  å’Œ <code>å¼•ç”¨æ•°æ®ç±»å‹</code> ã€‚</p>
<h4 id="1-7-3-1-ç®€å•æ•°æ®ç±»å‹"><a href="#1-7-3-1-ç®€å•æ•°æ®ç±»å‹" class="headerlink" title="1.7.3.1 ç®€å•æ•°æ®ç±»å‹"></a>1.7.3.1 ç®€å•æ•°æ®ç±»å‹</h4><p>å¯¹äºä¸‹é¢ä»£ç å…³äºæ•°æ®åº“çš„å››è¦ç´ ä¸åº”è¯¥å†™æ­»åœ¨ä»£ç ä¸­ï¼Œåº”è¯¥æ˜¯ä»propertiesé…ç½®æ–‡ä»¶ä¸­è¯»å–ã€‚å¦‚ä½•æ¥ä¼˜åŒ–ä¸‹é¢çš„ä»£ç ?</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨å…¥ç®€å•æ•°æ®ç±»å‹</p>
</blockquote>
<p>a. ç±»ä¸­æä¾›å››ä¸ªå±æ€§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ä½¿ç”¨ @Value æ³¨è§£å¼•å…¥å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;com.mysql.jdbc.Driver&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;jdbc:mysql://localhost:3306/spring_db&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;root&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@Value(&quot;password&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(driver);</span><br><span class="line">        ds.setUrl(url);</span><br><span class="line">        ds.setUsername(userName);</span><br><span class="line">        ds.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰©å±•</p>
</blockquote>
<p>ç°åœ¨çš„æ•°æ®åº“è¿æ¥å››è¦ç´ è¿˜æ˜¯å†™åœ¨ä»£ç ä¸­ï¼Œéœ€è¦åšçš„æ˜¯å°†è¿™äº›å†…å®¹æå–åˆ°jdbc.propertiesé…ç½®æ–‡ä»¶ï¼Œè¯¥å¦‚ä½•å®ç°?</p>
<ol>
<li><p>resourcesç›®å½•ä¸‹æ·»åŠ  <code>jdbc.properties</code> </p>
</li>
<li><p>é…ç½®æ–‡ä»¶ä¸­æä¾›å››ä¸ªé”®å€¼å¯¹åˆ†åˆ«æ˜¯æ•°æ®åº“çš„å››è¦ç´ </p>
</li>
<li><p>ä½¿ç”¨ <code>@PropertySource</code> åŠ è½½ jdbc.properties é…ç½®æ–‡ä»¶</p>
</li>
<li><p>ä¿®æ”¹ <code>@Value</code> æ³¨è§£å±æ€§çš„å€¼ï¼Œå°†å…¶ä¿®æ”¹ä¸º<code>$&#123;key&#125;</code>ï¼Œkey å°±æ˜¯é”®å€¼å¯¹ä¸­çš„é”®çš„å€¼</p>
</li>
</ol>
<h4 id="1-7-3-2-å¼•ç”¨æ•°æ®ç±»å‹"><a href="#1-7-3-2-å¼•ç”¨æ•°æ®ç±»å‹" class="headerlink" title="1.7.3.2 å¼•ç”¨æ•°æ®ç±»å‹"></a>1.7.3.2 å¼•ç”¨æ•°æ®ç±»å‹</h4><p>å‡è®¾åœ¨æ„å»º DataSource å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ° BookDao å¯¹è±¡ï¼Œè¯¥å¦‚ä½•æŠŠ BookDao å¯¹è±¡æ³¨å…¥è¿›æ–¹æ³•å†…è®©å…¶ä½¿ç”¨å‘¢?</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨å…¥å¼•ç”¨æ•°æ®ç±»å‹</p>
</blockquote>
<p>a. åœ¨ SpringConfig ä¸­æ‰«æ BookDao</p>
<p>æ‰«æçš„ç›®çš„æ˜¯è®© Spring èƒ½ç®¡ç†åˆ° BookDao ,ä¹Ÿå°±æ˜¯è¯´è¦è®© IOC å®¹å™¨ä¸­æœ‰ä¸€ä¸ª bookDao å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.Dao&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. åœ¨ JdbcConfig ç±»çš„æ–¹æ³•ä¸Šæ·»åŠ å‚æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        System.out.println(bookDao);</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¼•ç”¨ç±»å‹æ³¨å…¥åªéœ€è¦ä¸ºbeanå®šä¹‰æ–¹æ³•è®¾ç½®å½¢å‚å³å¯ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹ <code>byType</code> è‡ªåŠ¨è£…é…å¯¹è±¡ã€‚</p>
<p>c. è¿è¡Œç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.muyoukule.Dao.BookDaoImpl@6572421</span><br><span class="line">&#123;</span><br><span class="line">	CreateTime:&quot;2023-03-16 15:38:04&quot;,</span><br><span class="line">	ActiveCount:0,</span><br><span class="line">	PoolingCount:0,</span><br><span class="line">	CreateCount:0,</span><br><span class="line">	DestroyCount:0,</span><br><span class="line">	CloseCount:0,</span><br><span class="line">	ConnectCount:0,</span><br><span class="line">	Connections:[</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-é¢å‘åˆ‡é¢ç¼–ç¨‹AOP"><a href="#2-é¢å‘åˆ‡é¢ç¼–ç¨‹AOP" class="headerlink" title="2. é¢å‘åˆ‡é¢ç¼–ç¨‹AOP"></a>2. é¢å‘åˆ‡é¢ç¼–ç¨‹AOP</h1><p>IoCä½¿è½¯ä»¶ç»„ä»¶æ¾è€¦åˆã€‚AOPè®©ä½ èƒ½å¤Ÿæ•æ‰ç³»ç»Ÿä¸­ç»å¸¸ä½¿ç”¨çš„åŠŸèƒ½ï¼ŒæŠŠå®ƒè½¬åŒ–æˆç»„ä»¶ã€‚</p>
<p>AOPï¼ˆAspect Oriented Programmingï¼‰ï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé¢å‘æ–¹é¢ç¼–ç¨‹ã€‚ï¼ˆAOPæ˜¯ä¸€ç§ç¼–ç¨‹æŠ€æœ¯ï¼‰</p>
<p>AOP æ˜¯å¯¹OOPçš„è¡¥å……å»¶ä¼¸ã€‚</p>
<p>AOP åº•å±‚ä½¿ç”¨çš„å°±æ˜¯åŠ¨æ€ä»£ç†æ¥å®ç°çš„ã€‚</p>
<p>Spring çš„ AOP ä½¿ç”¨çš„åŠ¨æ€ä»£ç†æ˜¯ï¼šJDK åŠ¨æ€ä»£ç† + CGLIB åŠ¨æ€ä»£ç†æŠ€æœ¯ã€‚Spring åœ¨è¿™ä¸¤ç§åŠ¨æ€ä»£ç†ä¸­çµæ´»åˆ‡æ¢ï¼Œå¦‚æœæ˜¯ä»£ç†æ¥å£ï¼Œä¼šé»˜è®¤ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦‚æœè¦ä»£ç†æŸä¸ªç±»ï¼Œè¿™ä¸ªç±»æ²¡æœ‰å®ç°æ¥å£ï¼Œå°±ä¼šåˆ‡æ¢ä½¿ç”¨ CGLIBã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å¼ºåˆ¶é€šè¿‡ä¸€äº›é…ç½®è®© Spring åªä½¿ç”¨ CGLIBã€‚</p>
<h2 id="2-1-AOPä»‹ç»"><a href="#2-1-AOPä»‹ç»" class="headerlink" title="2.1 AOPä»‹ç»"></a>2.1 AOPä»‹ç»</h2><p>ä¸€èˆ¬ä¸€ä¸ªç³»ç»Ÿå½“ä¸­éƒ½ä¼šæœ‰ä¸€äº›ç³»ç»ŸæœåŠ¡ï¼Œä¾‹å¦‚ï¼šæ—¥å¿—ã€äº‹åŠ¡ç®¡ç†ã€å®‰å…¨ç­‰ã€‚è¿™äº›ç³»ç»ŸæœåŠ¡è¢«ç§°ä¸ºï¼š<strong>äº¤å‰ä¸šåŠ¡</strong></p>
<p>è¿™äº›<strong>äº¤å‰ä¸šåŠ¡</strong>å‡ ä¹æ˜¯é€šç”¨çš„ï¼Œä¸ç®¡ä½ æ˜¯åšé“¶è¡Œè´¦æˆ·è½¬è´¦ï¼Œè¿˜æ˜¯åˆ é™¤ç”¨æˆ·æ•°æ®ã€‚æ—¥å¿—ã€äº‹åŠ¡ç®¡ç†ã€å®‰å…¨ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦åšçš„ã€‚</p>
<p>å¦‚æœåœ¨æ¯ä¸€ä¸ªä¸šåŠ¡å¤„ç†è¿‡ç¨‹å½“ä¸­ï¼Œéƒ½æºæ‚è¿™äº›äº¤å‰ä¸šåŠ¡ä»£ç è¿›å»çš„è¯ï¼Œå­˜åœ¨ä¸¤æ–¹é¢é—®é¢˜ï¼š</p>
<ol>
<li>äº¤å‰ä¸šåŠ¡ä»£ç åœ¨å¤šä¸ªä¸šåŠ¡æµç¨‹ä¸­åå¤å‡ºç°ï¼Œæ˜¾ç„¶è¿™ä¸ªäº¤å‰ä¸šåŠ¡ä»£ç æ²¡æœ‰å¾—åˆ°å¤ç”¨ã€‚å¹¶ä¸”ä¿®æ”¹è¿™äº›äº¤å‰ä¸šåŠ¡ä»£ç çš„è¯ï¼Œéœ€è¦ä¿®æ”¹å¤šå¤„ã€‚</li>
<li>ç¨‹åºå‘˜æ— æ³•ä¸“æ³¨æ ¸å¿ƒä¸šåŠ¡ä»£ç çš„ç¼–å†™ï¼Œåœ¨ç¼–å†™æ ¸å¿ƒä¸šåŠ¡ä»£ç çš„åŒæ—¶è¿˜éœ€è¦å¤„ç†è¿™äº›äº¤å‰ä¸šåŠ¡ã€‚</li>
</ol>
<p>ä½¿ç”¨AOPå¯ä»¥å¾ˆè½»æ¾çš„è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p>
<p>è¯·çœ‹ä¸‹å›¾ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿç†è§£AOPçš„æ€æƒ³ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E7%90%86%E8%A7%A3AOP%E7%9A%84%E6%80%9D%E6%83%B3.png" style="zoom:67%;">

<p><strong>ç”¨ä¸€å¥è¯æ€»ç»“AOPï¼šå°†ä¸æ ¸å¿ƒä¸šåŠ¡æ— å…³çš„ä»£ç ç‹¬ç«‹çš„æŠ½å–å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼Œç„¶åä»¥æ¨ªå‘äº¤å‰çš„æ–¹å¼åº”ç”¨åˆ°ä¸šåŠ¡æµç¨‹å½“ä¸­çš„è¿‡ç¨‹è¢«ç§°ä¸ºAOPã€‚</strong></p>
<p>AOPçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ä»£ç å¤ç”¨æ€§å¢å¼ºã€‚</li>
<li>ä»£ç æ˜“ç»´æŠ¤ã€‚</li>
<li>ä½¿å¼€å‘è€…æ›´å…³æ³¨ä¸šåŠ¡é€»è¾‘ã€‚</li>
</ul>
<h2 id="2-2-AOPçš„ä¸ƒå¤§æœ¯è¯­"><a href="#2-2-AOPçš„ä¸ƒå¤§æœ¯è¯­" class="headerlink" title="2.2 AOPçš„ä¸ƒå¤§æœ¯è¯­"></a>2.2 AOPçš„ä¸ƒå¤§æœ¯è¯­</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do1</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do2</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do3</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do4</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 4&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do5</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¸å¿ƒä¸šåŠ¡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span> &#123;</span><br><span class="line">        do1();</span><br><span class="line">        do2();</span><br><span class="line">        do3();</span><br><span class="line">        do5();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¿æ¥ç‚¹ Joinpoint</p>
<ul>
<li>åœ¨ç¨‹åºçš„æ•´ä¸ªæ‰§è¡Œæµç¨‹ä¸­ï¼Œå¯ä»¥ç»‡å…¥åˆ‡é¢çš„ä½ç½®ã€‚æ–¹æ³•çš„æ‰§è¡Œå‰åï¼Œå¼‚å¸¸æŠ›å‡ºä¹‹åç­‰ä½ç½®ã€‚</li>
</ul>
</li>
<li><p>åˆ‡ç‚¹ Pointcut</p>
<ul>
<li>åœ¨ç¨‹åºæ‰§è¡Œæµç¨‹ä¸­ï¼ŒçœŸæ­£ç»‡å…¥åˆ‡é¢çš„æ–¹æ³•ã€‚ï¼ˆä¸€ä¸ªåˆ‡ç‚¹å¯¹åº”å¤šä¸ªè¿æ¥ç‚¹ï¼‰</li>
</ul>
</li>
<li><p>é€šçŸ¥ Advice</p>
<ul>
<li><p>é€šçŸ¥åˆå«å¢å¼ºï¼Œå°±æ˜¯å…·ä½“ä½ è¦ç»‡å…¥çš„ä»£ç ã€‚</p>
</li>
<li><p>é€šçŸ¥åŒ…æ‹¬ï¼š</p>
<ul>
<li>å‰ç½®é€šçŸ¥</li>
<li>åç½®é€šçŸ¥</li>
<li>ç¯ç»•é€šçŸ¥</li>
<li>å¼‚å¸¸é€šçŸ¥</li>
<li>æœ€ç»ˆé€šçŸ¥</li>
</ul>
</li>
</ul>
</li>
<li><p>åˆ‡é¢ Aspect</p>
<ul>
<li>åˆ‡ç‚¹ + é€šçŸ¥å°±æ˜¯åˆ‡é¢ã€‚</li>
</ul>
</li>
<li><p>ç»‡å…¥ Weaving</p>
<ul>
<li>æŠŠé€šçŸ¥åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ä¸Šçš„è¿‡ç¨‹ã€‚</li>
</ul>
</li>
<li><p>ä»£ç†å¯¹è±¡ Proxy</p>
<ul>
<li>ä¸€ä¸ªç›®æ ‡å¯¹è±¡è¢«ç»‡å…¥é€šçŸ¥åäº§ç”Ÿçš„æ–°å¯¹è±¡ã€‚</li>
</ul>
</li>
<li><p>ç›®æ ‡å¯¹è±¡ Target</p>
<ul>
<li>è¢«ç»‡å…¥é€šçŸ¥çš„å¯¹è±¡ã€‚</li>
</ul>
</li>
</ul>
<p>é€šè¿‡ä¸‹å›¾ï¼Œå¤§å®¶å¯ä»¥å¾ˆå¥½çš„ç†è§£AOPçš„ç›¸å…³æœ¯è¯­ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E7%90%86%E8%A7%A3AOP%E7%9A%84%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD.png"></p>
<h2 id="2-3-åˆ‡ç‚¹è¡¨è¾¾å¼"><a href="#2-3-åˆ‡ç‚¹è¡¨è¾¾å¼" class="headerlink" title="2.3 åˆ‡ç‚¹è¡¨è¾¾å¼"></a>2.3 åˆ‡ç‚¹è¡¨è¾¾å¼</h2><p>åˆ‡ç‚¹è¡¨è¾¾å¼ç”¨æ¥å®šä¹‰é€šçŸ¥ï¼ˆAdviceï¼‰å¾€å“ªäº›æ–¹æ³•ä¸Šåˆ‡å…¥ã€‚</p>
<p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution([è®¿é—®æ§åˆ¶æƒé™ä¿®é¥°ç¬¦] è¿”å›å€¼ç±»å‹ [å…¨é™å®šç±»å]æ–¹æ³•å(å½¢å¼å‚æ•°åˆ—è¡¨) [å¼‚å¸¸])</span><br></pre></td></tr></table></figure>

<p>è®¿é—®æ§åˆ¶æƒé™ä¿®é¥°ç¬¦ï¼š</p>
<ul>
<li>å¯é€‰é¡¹ã€‚</li>
<li>æ²¡å†™ï¼Œå°±æ˜¯4ä¸ªæƒé™éƒ½åŒ…æ‹¬ã€‚</li>
<li>å†™ public å°±è¡¨ç¤ºåªåŒ…æ‹¬å…¬å¼€çš„æ–¹æ³•ã€‚</li>
</ul>
<p>è¿”å›å€¼ç±»å‹ï¼š</p>
<ul>
<li>å¿…å¡«é¡¹ã€‚</li>
<li>* è¡¨ç¤ºè¿”å›å€¼ç±»å‹ä»»æ„ã€‚</li>
</ul>
<p>å…¨é™å®šç±»åï¼š</p>
<ul>
<li>å¯é€‰é¡¹ã€‚</li>
<li>ä¸¤ä¸ªç‚¹â€œ..â€ä»£è¡¨å½“å‰åŒ…ä»¥åŠå­åŒ…ä¸‹çš„æ‰€æœ‰ç±»ã€‚</li>
<li>çœç•¥æ—¶è¡¨ç¤ºæ‰€æœ‰çš„ç±»ã€‚</li>
</ul>
<p>æ–¹æ³•åï¼š</p>
<ul>
<li>å¿…å¡«é¡¹ã€‚</li>
<li>*è¡¨ç¤ºæ‰€æœ‰æ–¹æ³•ã€‚</li>
<li>set*è¡¨ç¤ºæ‰€æœ‰çš„setæ–¹æ³•ã€‚</li>
</ul>
<p>å½¢å¼å‚æ•°åˆ—è¡¨ï¼š</p>
<ul>
<li><p>å¿…å¡«é¡¹</p>
</li>
<li><p>() è¡¨ç¤ºæ²¡æœ‰å‚æ•°çš„æ–¹æ³•</p>
</li>
<li><p>(..) å‚æ•°ç±»å‹å’Œä¸ªæ•°éšæ„çš„æ–¹æ³•</p>
</li>
<li><p>(*) åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•</p>
</li>
<li><p>(*, String) ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹éšæ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯Stringçš„ã€‚</p>
</li>
</ul>
<p>å¼‚å¸¸ï¼š</p>
<ul>
<li>å¯é€‰é¡¹ã€‚</li>
<li>çœç•¥æ—¶è¡¨ç¤ºä»»æ„å¼‚å¸¸ç±»å‹ã€‚</li>
</ul>
<p>ç†è§£ä»¥ä¸‹çš„åˆ‡ç‚¹è¡¨è¾¾å¼ï¼š</p>
<p>ServiceåŒ…ä¸‹æ‰€æœ‰çš„ç±»ä¸­ä»¥ delete å¼€å§‹çš„æ‰€æœ‰æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution(<span class="keyword">public</span> * com.muyoukule.Service.*.delete*(..))</span><br></pre></td></tr></table></figure>

<p>MallåŒ…ä¸‹æ‰€æœ‰çš„ç±»çš„æ‰€æœ‰çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution(* com.muyoukule.Mall..*(..))</span><br></pre></td></tr></table></figure>

<p>æ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution(* *(..))</span><br></pre></td></tr></table></figure>

<h2 id="2-4-ä½¿ç”¨Springçš„AOP"><a href="#2-4-ä½¿ç”¨Springçš„AOP" class="headerlink" title="2.4 ä½¿ç”¨Springçš„AOP"></a>2.4 ä½¿ç”¨Springçš„AOP</h2><p>Springå¯¹AOPçš„å®ç°åŒ…æ‹¬ä»¥ä¸‹3ç§æ–¹å¼ï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€ç§æ–¹å¼ï¼šSpringæ¡†æ¶ç»“åˆAspectJæ¡†æ¶å®ç°çš„AOPï¼ŒåŸºäºæ³¨è§£æ–¹å¼ã€‚</strong></li>
<li><strong>ç¬¬äºŒç§æ–¹å¼ï¼šSpringæ¡†æ¶ç»“åˆAspectJæ¡†æ¶å®ç°çš„AOPï¼ŒåŸºäºXMLæ–¹å¼ã€‚</strong></li>
<li>ç¬¬ä¸‰ç§æ–¹å¼ï¼šSpringæ¡†æ¶è‡ªå·±å®ç°çš„AOPï¼ŒåŸºäºXMLé…ç½®æ–¹å¼ã€‚</li>
</ul>
<p>å®é™…å¼€å‘ä¸­ï¼Œéƒ½æ˜¯ Spring+AspectJ æ¥å®ç° AOPã€‚æ‰€ä»¥æˆ‘ä»¬é‡ç‚¹å­¦ä¹ ç¬¬ä¸€ç§å’Œç¬¬äºŒç§æ–¹å¼ã€‚</p>
<p>ä»€ä¹ˆæ˜¯AspectJï¼Ÿï¼ˆEclipseç»„ç»‡çš„ä¸€ä¸ªæ”¯æŒAOPçš„æ¡†æ¶ã€‚AspectJæ¡†æ¶æ˜¯ç‹¬ç«‹äºSpringæ¡†æ¶ä¹‹å¤–çš„ä¸€ä¸ªæ¡†æ¶ï¼ŒSpringæ¡†æ¶ç”¨äº†AspectJï¼‰ </p>
<blockquote>
<p>ç¯å¢ƒå‡†å¤‡</p>
</blockquote>
<p>a. ä½¿ç”¨Spring+AspectJçš„AOPéœ€è¦å¼•å…¥çš„ä¾èµ–ï¼Œç”±äºåœ¨<code>spring-context</code>ä¸­å·²ç»åŒ…å«äº†<code>spring aop</code>ä¾èµ–ï¼Œæ‰€ä»¥åªéœ€å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/aop%E7%9A%84%E4%BE%9D%E8%B5%96.png"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring contextä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring aspectsä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--junit--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>b. Springé…ç½®æ–‡ä»¶ <code>spring.xml</code> ä¸­æ·»åŠ  <code>context</code> å‘½åç©ºé—´å’Œ <code>aop</code> å‘½åç©ºé—´</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-1-åŸºäºAspectJçš„AOPæ³¨è§£å¼å¼€å‘"><a href="#2-4-1-åŸºäºAspectJçš„AOPæ³¨è§£å¼å¼€å‘" class="headerlink" title="2.4.1 åŸºäºAspectJçš„AOPæ³¨è§£å¼å¼€å‘"></a>2.4.1 åŸºäºAspectJçš„AOPæ³¨è§£å¼å¼€å‘</h3><blockquote>
<p>å®ç°æ­¥éª¤</p>
</blockquote>
<p>a. å®šä¹‰ç›®æ ‡ç±»ä»¥åŠç›®æ ‡æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›®æ ‡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// ç›®æ ‡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¢å•å·²ç”Ÿæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. å®šä¹‰åˆ‡é¢ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç›®æ ‡ç±»å’Œåˆ‡é¢ç±»éƒ½çº³å…¥spring beanç®¡ç†</p>
<ul>
<li><p>åœ¨ç›®æ ‡ç±» OrderService ä¸Šæ·»åŠ  <code>@Service</code> æ³¨è§£ã€‚</p>
</li>
<li><p>åœ¨åˆ‡é¢ç±» MyAspect ç±»ä¸Šæ·»åŠ  <code>@Component</code> æ³¨è§£ã€‚</p>
</li>
</ul>
<p>d. åœ¨springé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç»„å»ºæ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼€å¯ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Service,com.muyoukule.Aspect&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>e. åœ¨åˆ‡é¢ç±»ä¸­æ·»åŠ é€šçŸ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™å°±æ˜¯éœ€è¦å¢å¼ºçš„ä»£ç ï¼ˆé€šçŸ¥ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">advice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªé€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. åœ¨é€šçŸ¥ä¸Šæ·»åŠ åˆ‡ç‚¹è¡¨è¾¾å¼ï¼ˆé€šçŸ¥+åˆ‡ç‚¹&#x3D;åˆ‡é¢ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ‡ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="comment">// è¿™å°±æ˜¯éœ€è¦å¢å¼ºçš„ä»£ç ï¼ˆé€šçŸ¥ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">advice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªé€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šæ³¨è§£ <code>@Before</code> è¡¨ç¤ºå‰ç½®é€šçŸ¥ã€‚</strong></p>
<p>g. åœ¨ spring é…ç½®æ–‡ä»¶ä¸­å¯ç”¨è‡ªåŠ¨ä»£ç†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼€å¯ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.Service&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¼€å¯è‡ªåŠ¨ä»£ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;aop:aspectj-autoproxy  proxy-target-class=&quot;true&quot;/&gt;</code>  å¼€å¯è‡ªåŠ¨ä»£ç†ä¹‹åï¼Œå‡¡æ˜¯å¸¦æœ‰ <code>@Aspect</code> æ³¨è§£çš„ bean éƒ½ä¼šç”Ÿæˆä»£ç†å¯¹è±¡ã€‚</p>
<p><code>proxy-target-class=&quot;true&quot;</code> è¡¨ç¤ºé‡‡ç”¨cglibåŠ¨æ€ä»£ç†ã€‚</p>
<p><code>proxy-target-class=&quot;false&quot;</code> è¡¨ç¤ºé‡‡ç”¨ jdk åŠ¨æ€ä»£ç†ã€‚é»˜è®¤å€¼æ˜¯ falseã€‚å³ä½¿å†™æˆ falseï¼Œå½“æ²¡æœ‰æ¥å£çš„æ—¶å€™ï¼Œä¹Ÿä¼šè‡ªåŠ¨é€‰æ‹© cglib ç”Ÿæˆä»£ç†ç±»ã€‚</p>
<p>h. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOP</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">    orderService.generate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>i. è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆ‘æ˜¯ä¸€ä¸ªé€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šçŸ¥ç±»å‹</p>
</blockquote>
<p>é€šçŸ¥ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li>å‰ç½®é€šçŸ¥ï¼š<code>@Before</code> ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰çš„é€šçŸ¥</li>
<li>åç½®é€šçŸ¥ï¼š<code>@AfterReturning</code> ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åçš„é€šçŸ¥</li>
<li>ç¯ç»•é€šçŸ¥ï¼š<code>@Around</code> ç›®æ ‡æ–¹æ³•ä¹‹å‰æ·»åŠ é€šçŸ¥ï¼ŒåŒæ—¶ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åæ·»åŠ é€šçŸ¥ã€‚</li>
<li>å¼‚å¸¸é€šçŸ¥ï¼š<code>@AfterThrowing</code> å‘ç”Ÿå¼‚å¸¸ä¹‹åæ‰§è¡Œçš„é€šçŸ¥</li>
<li>æœ€ç»ˆé€šçŸ¥ï¼š<code>@After</code> æ”¾åœ¨ finally è¯­å¥å—ä¸­çš„é€šçŸ¥</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæ”¹å†™ç¨‹åºæ¥æµ‹è¯•è¿™å‡ ä¸ªé€šçŸ¥çš„æ‰§è¡Œé¡ºåº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥å¼€å§‹&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥ç»“æŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‰ç½®é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åç½®é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼‚å¸¸é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€ç»ˆé€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæµ‹è¯•ï¼Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">æœ€ç»ˆé€šçŸ¥</span><br><span class="line">ç¯ç»•é€šçŸ¥ç»“æŸ</span><br></pre></td></tr></table></figure>

<p>ç»“æœä¸­æ²¡æœ‰å¼‚å¸¸é€šçŸ¥ï¼Œè¿™æ˜¯å› ä¸ºç›®æ ‡ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ã€‚</p>
<p>å°è¯•è®©ç›®æ ‡æ–¹æ³•å‘ç”Ÿå¼‚å¸¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›®æ ‡ç±»</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// ç›®æ ‡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¢å•å·²ç”Ÿæˆï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ¨¡æ‹Ÿå¼‚å¸¸å‘ç”Ÿ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br><span class="line">å¼‚å¸¸é€šçŸ¥</span><br><span class="line">æœ€ç»ˆé€šçŸ¥</span><br><span class="line"></span><br><span class="line">java.lang.RuntimeException: æ¨¡æ‹Ÿå¼‚å¸¸å‘ç”Ÿ</span><br><span class="line"></span><br><span class="line">    // --snip--</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œå½“å‘ç”Ÿå¼‚å¸¸ä¹‹åï¼Œæœ€ç»ˆé€šçŸ¥ä¹Ÿä¼šæ‰§è¡Œï¼Œå› ä¸ºæœ€ç»ˆé€šçŸ¥ <code>@After</code> ä¼šå‡ºç°åœ¨ finally è¯­å¥å—ä¸­ã€‚å‡ºç°å¼‚å¸¸ä¹‹åï¼Œåç½®é€šçŸ¥å’Œç¯ç»•é€šçŸ¥çš„ç»“æŸéƒ¨åˆ†ä¸ä¼šæ‰§è¡Œã€‚</p>
<blockquote>
<p>åˆ‡é¢çš„å…ˆåé¡ºåº</p>
</blockquote>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸šåŠ¡æµç¨‹å½“ä¸­ä¸ä¸€å®šåªæœ‰ä¸€ä¸ªåˆ‡é¢ï¼Œå¯èƒ½æœ‰çš„åˆ‡é¢æ§åˆ¶äº‹åŠ¡ï¼Œæœ‰çš„è®°å½•æ—¥å¿—ï¼Œæœ‰çš„è¿›è¡Œå®‰å…¨æ§åˆ¶ï¼Œå¦‚æœå¤šä¸ªåˆ‡é¢çš„è¯ï¼Œé¡ºåºå¦‚ä½•æ§åˆ¶ï¼šå¯ä»¥ä½¿ç”¨ <code>@Order</code> æ³¨è§£æ¥æ ‡è¯†åˆ‡é¢ç±»ï¼Œä¸º <code>@Order</code> æ³¨è§£çš„ value æŒ‡å®šä¸€ä¸ªæ•´æ•°å‹çš„æ•°å­—ï¼Œæ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</p>
<p>a. å†å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±»ï¼Œå¹¶è®¾ç½®ä¼˜å…ˆçº§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(1)</span> <span class="comment">//è®¾ç½®ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">YourAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectç¯ç»•é€šçŸ¥å¼€å§‹&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectç¯ç»•é€šçŸ¥ç»“æŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectå‰ç½®é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectåç½®é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectå¼‚å¸¸é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.muyoukule.Service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspectæœ€ç»ˆé€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. è®¾ç½®åˆ‡é¢ç±» MyAspect çš„ä¼˜å…ˆçº§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span> <span class="comment">//è®¾ç½®ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ‰§è¡Œæµ‹è¯•ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">YourAspectç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">YourAspectå‰ç½®é€šçŸ¥</span><br><span class="line">ç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">æœ€ç»ˆé€šçŸ¥</span><br><span class="line">ç¯ç»•é€šçŸ¥ç»“æŸ</span><br><span class="line">YourAspectåç½®é€šçŸ¥</span><br><span class="line">YourAspectæœ€ç»ˆé€šçŸ¥</span><br><span class="line">YourAspectç¯ç»•é€šçŸ¥ç»“æŸ</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¿®æ”¹ <code>@Order</code> æ³¨è§£çš„æ•´æ•°å€¼æ¥åˆ‡æ¢é¡ºåºï¼Œæ‰§è¡Œæµ‹è¯•ç¨‹åºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">YourAspectç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">YourAspectå‰ç½®é€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br><span class="line">YourAspectåç½®é€šçŸ¥</span><br><span class="line">YourAspectæœ€ç»ˆé€šçŸ¥</span><br><span class="line">YourAspectç¯ç»•é€šçŸ¥ç»“æŸ</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">æœ€ç»ˆé€šçŸ¥</span><br><span class="line">ç¯ç»•é€šçŸ¥ç»“æŸ</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¼˜åŒ–ä½¿ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼</p>
</blockquote>
<p>è§‚çœ‹åˆšæ‰ä»£ç ä¸­çš„åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œç¼ºç‚¹æ˜¯ï¼š</p>
<ul>
<li>åˆ‡ç‚¹è¡¨è¾¾å¼é‡å¤å†™äº†å¤šæ¬¡ï¼Œæ²¡æœ‰å¾—åˆ°å¤ç”¨ã€‚</li>
<li>å¦‚æœè¦ä¿®æ”¹åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œéœ€è¦ä¿®æ”¹å¤šå¤„ï¼Œéš¾ç»´æŠ¤ã€‚</li>
</ul>
<p>å¯ä»¥è¿™æ ·åšï¼šå°†åˆ‡ç‚¹è¡¨è¾¾å¼å•ç‹¬çš„å®šä¹‰å‡ºæ¥ï¼Œåœ¨éœ€è¦çš„ä½ç½®å¼•å…¥å³å¯ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰é€šç”¨çš„åˆ‡ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.muyoukule.Service..*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ–¹æ³•åªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæ–¹æ³•åéšæ„ï¼Œæ–¹æ³•ä½“ä¸­ä¹Ÿä¸éœ€è¦å†™ä»»ä½•ä»£ç ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥å¼€å§‹&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥ç»“æŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‰ç½®é€šçŸ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>@Pointcut</code> æ³¨è§£æ¥å®šä¹‰ç‹¬ç«‹çš„åˆ‡ç‚¹è¡¨è¾¾å¼ã€‚æ³¨æ„è¿™ä¸ª <code>@Pointcut</code> æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•éšæ„ï¼Œåªæ˜¯èµ·åˆ°ä¸€ä¸ªèƒ½å¤Ÿè®© <code>@Pointcut</code> æ³¨è§£ç¼–å†™çš„ä½ç½®ã€‚</p>
<p>è¿è¡Œæµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¯ç»•é€šçŸ¥å¼€å§‹</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">è®¢å•å·²ç”Ÿæˆï¼</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">æœ€ç»ˆé€šçŸ¥</span><br><span class="line">ç¯ç»•é€šçŸ¥ç»“æŸ</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¨æ³¨è§£å¼å¼€å‘AOP</p>
</blockquote>
<p>å°±æ˜¯ç¼–å†™ä¸€ä¸ªç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸Šé¢ä½¿ç”¨å¤§é‡æ³¨è§£æ¥ä»£æ›¿ spring çš„é…ç½®æ–‡ä»¶ï¼Œspring é…ç½®æ–‡ä»¶æ¶ˆå¤±äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.muyoukule.Service&quot;, &quot;com.muyoukule.Aspect&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>@EnableAspectJAutoProxy(proxyTargetClass = true)</code> æˆ–è€… <code>@EnableAspectJAutoProxy</code> å¼€å¯æ³¨è§£æ ¼å¼AOPåŠŸèƒ½ã€‚</li>
<li><code>proxyTargetClass = true</code> è¡¨ç¤ºé‡‡ç”¨ cglib åŠ¨æ€ä»£ç†ã€‚</li>
</ul>
<p>æµ‹è¯•ç¨‹åºä¹Ÿå˜åŒ–äº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOPWithAllAnnotation</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">    orderService.generate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-2-åŸºäºXMLé…ç½®æ–¹å¼çš„AOPï¼ˆäº†è§£ï¼‰"><a href="#2-4-2-åŸºäºXMLé…ç½®æ–¹å¼çš„AOPï¼ˆäº†è§£ï¼‰" class="headerlink" title="2.4.2 åŸºäºXMLé…ç½®æ–¹å¼çš„AOPï¼ˆäº†è§£ï¼‰"></a>2.4.2 åŸºäºXMLé…ç½®æ–¹å¼çš„AOPï¼ˆäº†è§£ï¼‰</h3><p>a. ç¼–å†™ç›®æ ‡ç±»ï¼ˆä¸æ·»åŠ æ³¨è§£ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›®æ ‡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VipService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿å­˜vipä¿¡æ¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b. ç¼–å†™åˆ‡é¢ç±»ï¼Œå¹¶ä¸”ç¼–å†™é€šçŸ¥ï¼ˆä¸æ·»åŠ  <code>@Component</code> æ³¨è§£ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è´Ÿè´£è®¡æ—¶çš„åˆ‡é¢ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">time</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">//æ‰§è¡Œç›®æ ‡</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;è€—æ—¶&quot;</span> + (end - begin) + <span class="string">&quot;æ¯«ç§’&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™ <code>spring.xml</code> é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd                       </span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--çº³å…¥spring beanç®¡ç†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Service.VipService&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;timerAspect&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.Aspect.TimerAspect&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--aopé…ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ‡ç‚¹è¡¨è¾¾å¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;p&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.muyoukule.Service.VipService.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ‡é¢--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;timerAspect&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--åˆ‡é¢=é€šçŸ¥ + åˆ‡ç‚¹--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;time&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;p&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>d. æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOPXml</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">    <span class="type">VipService</span> <span class="variable">vipService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;vipService&quot;</span>, VipService.class);</span><br><span class="line">    vipService.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¿å­˜vipä¿¡æ¯...</span><br><span class="line">è€—æ—¶9æ¯«ç§’</span><br></pre></td></tr></table></figure>

<h2 id="2-5-AOPçš„å®é™…æ¡ˆä¾‹ï¼šäº‹åŠ¡å¤„ç†"><a href="#2-5-AOPçš„å®é™…æ¡ˆä¾‹ï¼šäº‹åŠ¡å¤„ç†" class="headerlink" title="2.5 AOPçš„å®é™…æ¡ˆä¾‹ï¼šäº‹åŠ¡å¤„ç†"></a>2.5 AOPçš„å®é™…æ¡ˆä¾‹ï¼šäº‹åŠ¡å¤„ç†</h2><p>é¡¹ç›®ä¸­çš„äº‹åŠ¡æ§åˆ¶æ˜¯åœ¨æ‰€éš¾å…çš„ã€‚åœ¨ä¸€ä¸ªä¸šåŠ¡æµç¨‹å½“ä¸­ï¼Œå¯èƒ½éœ€è¦å¤šæ¡ DML è¯­å¥å…±åŒå®Œæˆï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨ï¼Œè¿™å¤šæ¡ DML è¯­å¥è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚è¿™å°±éœ€è¦æ·»åŠ äº‹åŠ¡æ§åˆ¶çš„ä»£ç ã€‚ä¾‹å¦‚ä»¥ä¸‹ä¼ªä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">class ä¸šåŠ¡ç±»<span class="number">1</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">1</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">2</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">3</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ä¸šåŠ¡ç±»<span class="number">2</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">1</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">2</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> ä¸šåŠ¡æ–¹æ³•<span class="number">3</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//......</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›ä¸šåŠ¡ç±»ä¸­çš„æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•éƒ½æ˜¯éœ€è¦æ§åˆ¶äº‹åŠ¡çš„ï¼Œè€Œæ§åˆ¶äº‹åŠ¡çš„ä»£ç åˆæ˜¯å›ºå®šçš„æ ¼å¼ï¼Œéƒ½æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">    startTransaction();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">    commitTransaction();</span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">    <span class="comment">// å›æ»šäº‹åŠ¡</span></span><br><span class="line">    rollbackTransaction();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ§åˆ¶äº‹åŠ¡çš„ä»£ç å°±æ˜¯å’Œä¸šåŠ¡é€»è¾‘æ²¡æœ‰å…³ç³»çš„ â€œ<strong>äº¤å‰ä¸šåŠ¡</strong>â€ ã€‚ä»¥ä¸Šä¼ªä»£ç å½“ä¸­å¯ä»¥çœ‹åˆ°è¿™äº›äº¤å‰ä¸šåŠ¡çš„ä»£ç æ²¡æœ‰å¾—åˆ°å¤ç”¨ï¼Œå¹¶ä¸”å¦‚æœè¿™äº›äº¤å‰ä¸šåŠ¡ä»£ç éœ€è¦ä¿®æ”¹ï¼Œé‚£å¿…ç„¶éœ€è¦ä¿®æ”¹å¤šå¤„ï¼Œéš¾ç»´æŠ¤ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿå¯ä»¥é‡‡ç”¨ AOP æ€æƒ³è§£å†³ã€‚å¯ä»¥æŠŠä»¥ä¸Šæ§åˆ¶äº‹åŠ¡çš„ä»£ç ä½œä¸ºç¯ç»•é€šçŸ¥ï¼Œåˆ‡å…¥åˆ°ç›®æ ‡ç±»çš„æ–¹æ³•å½“ä¸­ã€‚</p>
<p>a. æœ‰ä¸¤ä¸ªä¸šåŠ¡ç±»ï¼Œå¦‚ä¸‹</p>
<p>é“¶è¡Œè´¦æˆ·çš„ä¸šåŠ¡ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="comment">// ä¸šåŠ¡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">// è½¬è´¦ä¸šåŠ¡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨è¿›è¡Œé“¶è¡Œè´¦æˆ·è½¬è´¦...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å–æ¬¾ä¸šåŠ¡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨è¿›è¡Œå–æ¬¾æ“ä½œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¢å•ä¸šåŠ¡ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="comment">// ä¸šåŠ¡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè®¢å•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨ç”Ÿæˆè®¢å•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å–æ¶ˆè®¢å•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å–æ¶ˆè®¢å•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œä»¥ä¸Šä¸¤ä¸ªä¸šåŠ¡ç±»å·²ç»çº³å…¥spring beançš„ç®¡ç†ï¼Œå› ä¸ºéƒ½æ·»åŠ äº† <code>@Service</code> æ³¨è§£ã€‚</p>
<p>ç»™ä»¥ä¸Šä¸¤ä¸ªä¸šåŠ¡ç±»çš„4ä¸ªæ–¹æ³•æ·»åŠ äº‹åŠ¡æ§åˆ¶ä»£ç ï¼Œä½¿ç”¨ AOP æ¥å®Œæˆï¼š</p>
<p>b. äº‹åŠ¡åˆ‡é¢ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// äº‹åŠ¡åˆ‡é¢ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.muyoukule.Service..*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å¼€å¯äº‹åŠ¡&quot;</span>);</span><br><span class="line">            <span class="comment">// æ‰§è¡Œç›®æ ‡</span></span><br><span class="line">            proceedingJoinPoint.proceed();</span><br><span class="line">            System.out.println(<span class="string">&quot;æäº¤äº‹åŠ¡&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å›æ»šäº‹åŠ¡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. ç¼–å†™é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.muyoukule.Service&quot;, &quot;com.muyoukule.Aspect&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªäº‹åŠ¡æ§åˆ¶ä»£ç åªéœ€è¦å†™ä¸€æ¬¡å°±è¡Œäº†ï¼Œå¹¶ä¸”ä¿®æ”¹èµ·æ¥ä¹Ÿæ²¡æœ‰æˆæœ¬ã€‚</p>
<p>d. ç¼–å†™æµ‹è¯•ç¨‹åºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransaction</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">    <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;accountService&quot;</span>, AccountService.class);</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè®¢å•</span></span><br><span class="line">    orderService.generate();</span><br><span class="line">    <span class="comment">// å–æ¶ˆè®¢å•</span></span><br><span class="line">    orderService.cancel();</span><br><span class="line">    <span class="comment">// è½¬è´¦</span></span><br><span class="line">    accountService.transfer();</span><br><span class="line">    <span class="comment">// å–æ¬¾</span></span><br><span class="line">    accountService.withdraw();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. è¿è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼€å¯äº‹åŠ¡</span><br><span class="line">æ­£åœ¨ç”Ÿæˆè®¢å•...</span><br><span class="line">æäº¤äº‹åŠ¡</span><br><span class="line">å¼€å¯äº‹åŠ¡</span><br><span class="line">æ­£åœ¨å–æ¶ˆè®¢å•...</span><br><span class="line">æäº¤äº‹åŠ¡</span><br><span class="line">å¼€å¯äº‹åŠ¡</span><br><span class="line">æ­£åœ¨è¿›è¡Œé“¶è¡Œè´¦æˆ·è½¬è´¦...</span><br><span class="line">æäº¤äº‹åŠ¡</span><br><span class="line">å¼€å¯äº‹åŠ¡</span><br><span class="line">æ­£åœ¨è¿›è¡Œå–æ¬¾æ“ä½œ...</span><br><span class="line">æäº¤äº‹åŠ¡</span><br></pre></td></tr></table></figure>

<h2 id="2-6-AOPçš„å®é™…æ¡ˆä¾‹ï¼šå®‰å…¨æ—¥å¿—"><a href="#2-6-AOPçš„å®é™…æ¡ˆä¾‹ï¼šå®‰å…¨æ—¥å¿—" class="headerlink" title="2.6 AOPçš„å®é™…æ¡ˆä¾‹ï¼šå®‰å…¨æ—¥å¿—"></a>2.6 AOPçš„å®é™…æ¡ˆä¾‹ï¼šå®‰å…¨æ—¥å¿—</h2><p>éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šé¡¹ç›®å¼€å‘ç»“æŸäº†ï¼Œå·²ç»ä¸Šçº¿äº†ã€‚è¿è¡Œæ­£å¸¸ã€‚å®¢æˆ·æå‡ºäº†æ–°çš„éœ€æ±‚ï¼šå‡¡äº‹åœ¨ç³»ç»Ÿä¸­è¿›è¡Œä¿®æ”¹æ“ä½œçš„ï¼Œåˆ é™¤æ“ä½œçš„ï¼Œæ–°å¢æ“ä½œçš„ï¼Œéƒ½è¦æŠŠè¿™ä¸ªäººè®°å½•ä¸‹æ¥ã€‚å› ä¸ºè¿™å‡ ä¸ªæ“ä½œæ˜¯å±äºå±é™©è¡Œä¸ºã€‚ä¾‹å¦‚æœ‰ä¸šåŠ¡ç±»å’Œä¸šåŠ¡æ–¹æ³•ï¼š</p>
<p>ç”¨æˆ·ä¸šåŠ¡ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="comment">//ç”¨æˆ·ä¸šåŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿å­˜ç”¨æˆ·...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤ç”¨æˆ·...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿®æ”¹ç”¨æˆ·...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å•†å“ä¸šåŠ¡ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å•†å“ä¸šåŠ¡ç±»</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è·å–å•†å“ä¿¡æ¯....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿å­˜å•†å“....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤å•†å“....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿®æ”¹å•†å“....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨aopæ¥è§£å†³ä¸Šé¢çš„éœ€æ±‚ï¼šç¼–å†™ä¸€ä¸ªè´Ÿè´£å®‰å…¨çš„åˆ‡é¢ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.muyoukule.Service..save*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">savePointcut</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.muyoukule.Service..delete*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deletePointcut</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.muyoukule.Service..modify*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyPointcut</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;savePointcut() || deletePointcut() || modifyPointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdivce</span><span class="params">(JoinPoint joinpoint)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œ&quot;</span> + joinpoint.getSignature().getName() + <span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç¨‹åº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSecurity</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    <span class="type">ProductService</span> <span class="variable">productService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;productService&quot;</span>, ProductService.class);</span><br><span class="line">    userService.getUser();</span><br><span class="line">    userService.saveUser();</span><br><span class="line">    userService.deleteUser();</span><br><span class="line">    userService.modifyUser();</span><br><span class="line">    productService.getProduct();</span><br><span class="line">    productService.saveProduct();</span><br><span class="line">    productService.deleteProduct();</span><br><span class="line">    productService.modifyProduct();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.muyoukule.Service&quot;, &quot;com.muyoukule.Aspect&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è·å–ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œsaveUseræ–¹æ³•</span><br><span class="line">ä¿å­˜ç”¨æˆ·</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œdeleteUseræ–¹æ³•</span><br><span class="line">åˆ é™¤ç”¨æˆ·</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œmodifyUseræ–¹æ³•</span><br><span class="line">ä¿®æ”¹ç”¨æˆ·</span><br><span class="line">è·å–å•†å“ä¿¡æ¯</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œsaveProductæ–¹æ³•</span><br><span class="line">ä¿å­˜å•†å“</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œdeleteProductæ–¹æ³•</span><br><span class="line">åˆ é™¤å•†å“</span><br><span class="line">XXXæ“ä½œå‘˜æ­£åœ¨æ“ä½œmodifyProductæ–¹æ³•</span><br><span class="line">ä¿®æ”¹å•†å“</span><br></pre></td></tr></table></figure>

<h1 id="3-Springå¯¹äº‹åŠ¡çš„æ”¯æŒ"><a href="#3-Springå¯¹äº‹åŠ¡çš„æ”¯æŒ" class="headerlink" title="3. Springå¯¹äº‹åŠ¡çš„æ”¯æŒ"></a>3. Springå¯¹äº‹åŠ¡çš„æ”¯æŒ</h1><h2 id="3-1-äº‹åŠ¡æ¦‚è¿°"><a href="#3-1-äº‹åŠ¡æ¦‚è¿°" class="headerlink" title="3.1 äº‹åŠ¡æ¦‚è¿°"></a>3.1 äº‹åŠ¡æ¦‚è¿°</h2><ul>
<li><p>ä»€ä¹ˆæ˜¯äº‹åŠ¡</p>
<ul>
<li>åœ¨ä¸€ä¸ªä¸šåŠ¡æµç¨‹å½“ä¸­ï¼Œé€šå¸¸éœ€è¦å¤šæ¡DMLï¼ˆinsert delete updateï¼‰è¯­å¥å…±åŒè”åˆæ‰èƒ½å®Œæˆï¼Œè¿™å¤šæ¡DMLè¯­å¥å¿…é¡»åŒæ—¶æˆåŠŸï¼Œæˆ–è€…åŒæ—¶å¤±è´¥ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ•°æ®çš„å®‰å…¨ã€‚</li>
<li>å¤šæ¡DMLè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ï¼Œè¿™å«åšäº‹åŠ¡ã€‚</li>
<li>äº‹åŠ¡ï¼šTransactionï¼ˆtxï¼‰</li>
</ul>
</li>
<li><p>äº‹åŠ¡çš„å››ä¸ªå¤„ç†è¿‡ç¨‹ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šå¼€å¯äº‹åŠ¡ (start transaction)</li>
<li>ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡ä»£ç </li>
<li>ç¬¬ä¸‰æ­¥ï¼šæäº¤äº‹åŠ¡ï¼ˆå¦‚æœæ ¸å¿ƒä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼‰(commit transaction)</li>
<li>ç¬¬å››æ­¥ï¼šå›æ»šäº‹åŠ¡ï¼ˆå¦‚æœæ ¸å¿ƒä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼‰(rollback transaction)</li>
</ul>
</li>
<li><p>äº‹åŠ¡çš„å››ä¸ªç‰¹æ€§ï¼š</p>
<ul>
<li>A åŸå­æ€§ï¼šäº‹åŠ¡æ˜¯æœ€å°çš„å·¥ä½œå•å…ƒï¼Œä¸å¯å†åˆ†ã€‚</li>
<li>C ä¸€è‡´æ€§ï¼šäº‹åŠ¡è¦æ±‚è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚äº‹åŠ¡å‰å’Œäº‹åŠ¡åçš„æ€»é‡ä¸å˜ã€‚</li>
<li>I éš”ç¦»æ€§ï¼šäº‹åŠ¡å’Œäº‹åŠ¡ä¹‹é—´å› ä¸ºæœ‰éš”ç¦»æ€§ï¼Œæ‰å¯ä»¥ä¿è¯äº’ä¸å¹²æ‰°ã€‚</li>
<li>D æŒä¹…æ€§ï¼šæŒä¹…æ€§æ˜¯äº‹åŠ¡ç»“æŸçš„æ ‡å¿—ã€‚</li>
</ul>
</li>
<li><p>äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ã€‚</p>
</li>
<li><p>Springäº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–ä¸šåŠ¡å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ã€‚</p>
</li>
</ul>
<h2 id="3-2-Springäº‹åŠ¡æ¡ˆä¾‹"><a href="#3-2-Springäº‹åŠ¡æ¡ˆä¾‹" class="headerlink" title="3.2 Springäº‹åŠ¡æ¡ˆä¾‹"></a>3.2 Springäº‹åŠ¡æ¡ˆä¾‹</h2><p>æ•°æ®å±‚æœ‰äº‹åŠ¡æˆ‘ä»¬å¯ä»¥ç†è§£ï¼Œä¸ºä»€ä¹ˆä¸šåŠ¡å±‚ä¹Ÿéœ€è¦å¤„ç†äº‹åŠ¡å‘¢?</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<ul>
<li>è½¬è´¦ä¸šåŠ¡ä¼šæœ‰ä¸¤æ¬¡æ•°æ®å±‚çš„è°ƒç”¨ï¼Œä¸€æ¬¡æ˜¯åŠ é’±ä¸€æ¬¡æ˜¯å‡é’±ã€‚</li>
<li>æŠŠäº‹åŠ¡æ”¾åœ¨æ•°æ®å±‚ï¼ŒåŠ é’±å’Œå‡é’±å°±æœ‰ä¸¤ä¸ªäº‹åŠ¡ã€‚</li>
<li>æ²¡åŠæ³•ä¿è¯åŠ é’±å’Œå‡é’±åŒæ—¶æˆåŠŸæˆ–è€…åŒæ—¶å¤±è´¥ã€‚</li>
<li>è¿™ä¸ªæ—¶å€™å°±éœ€è¦å°†äº‹åŠ¡æ”¾åœ¨ä¸šåŠ¡å±‚è¿›è¡Œå¤„ç†ã€‚</li>
</ul>
<p>Spring ä¸ºäº†ç®¡ç†äº‹åŠ¡ï¼Œæä¾›äº†ä¸€ä¸ªå¹³å°äº‹åŠ¡ç®¡ç†å™¨ <code>PlatformTransactionManager</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PlatformTransactionManager</span> <span class="keyword">extends</span> <span class="title class_">TransactionManager</span> &#123;</span><br><span class="line">    TransactionStatus <span class="title function_">getTransaction</span><span class="params">(<span class="meta">@Nullable</span> TransactionDefinition definition)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">commit</span><span class="params">(TransactionStatus status)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">(TransactionStatus status)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>commit</code> æ˜¯ç”¨æ¥æäº¤äº‹åŠ¡ï¼Œ<code>rollback</code> æ˜¯ç”¨æ¥å›æ»šäº‹åŠ¡ã€‚</p>
<p><code>PlatformTransactionManager</code> åªæ˜¯ä¸€ä¸ªæ¥å£ï¼ŒSpringè¿˜ä¸ºå…¶æä¾›äº†ä¸€ä¸ªå…·ä½“çš„å®ç°ï¼š<code>DataSourceTransactionManager</code></p>
<p>ä»åç§°ä¸Šå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬åªéœ€è¦ç»™å®ƒä¸€ä¸ª DataSource å¯¹è±¡ï¼Œå®ƒå°±å¯ä»¥å¸®ä½ å»åœ¨ä¸šåŠ¡å±‚ç®¡ç†äº‹åŠ¡ã€‚å…¶å†…éƒ¨é‡‡ç”¨çš„æ˜¯ JDBC çš„äº‹åŠ¡ã€‚æ‰€ä»¥è¯´å¦‚æœä½ æŒä¹…å±‚é‡‡ç”¨çš„æ˜¯JDBCç›¸å…³çš„æŠ€æœ¯ï¼Œå°±å¯ä»¥é‡‡ç”¨è¿™ä¸ªäº‹åŠ¡ç®¡ç†å™¨æ¥ç®¡ç†ä½ çš„äº‹åŠ¡ã€‚è€Œ Mybatis å†…éƒ¨é‡‡ç”¨çš„å°±æ˜¯ JDBC çš„äº‹åŠ¡ï¼Œæ‰€ä»¥åæœŸæˆ‘ä»¬ Spring æ•´åˆ Mybatis å°±é‡‡ç”¨çš„è¿™ä¸ª <code>DataSourceTransactionManager</code> äº‹åŠ¡ç®¡ç†å™¨ã€‚</p>
<p>å°TipsğŸ˜€ï¼šå…³äºæ•´åˆçš„çŸ¥è¯†å¯ä»¥åœ¨æœ¬ç«™æœç´¢æŸ¥çœ‹ <code>accidence-spring-volumeThree</code> å­¦ä¹ ã€‚</p>
<h3 id="3-2-1-è½¬è´¦æ¡ˆä¾‹-éœ€æ±‚åˆ†æ"><a href="#3-2-1-è½¬è´¦æ¡ˆä¾‹-éœ€æ±‚åˆ†æ" class="headerlink" title="3.2.1 è½¬è´¦æ¡ˆä¾‹-éœ€æ±‚åˆ†æ"></a>3.2.1 è½¬è´¦æ¡ˆä¾‹-éœ€æ±‚åˆ†æ</h3><p>æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ¥å­¦ä¹ ä¸‹Springæ˜¯å¦‚ä½•æ¥ç®¡ç†äº‹åŠ¡çš„ã€‚</p>
<p>å…ˆæ¥åˆ†æä¸‹éœ€æ±‚:</p>
<p>éœ€æ±‚: å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ</p>
<p>éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±ï¼ŒBè´¦æˆ·åŠ é’±</p>
<p>ä¸ºäº†å®ç°ä¸Šè¿°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹é¢æ­¥éª¤æ¥å®ç°ä¸‹ï¼š</p>
<ol>
<li>æ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œï¼ŒæŒ‡å®šè´¦æˆ·å‡é’±ï¼ˆoutMoneyï¼‰ï¼ŒæŒ‡å®šè´¦æˆ·åŠ é’±ï¼ˆinMoneyï¼‰</li>
<li>ä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œï¼ˆtransferï¼‰ï¼Œè°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ</li>
<li>æä¾›2ä¸ªè´¦å·å’Œæ“ä½œé‡‘é¢æ‰§è¡Œè½¬è´¦æ“ä½œ</li>
<li>åŸºäº Spring æ•´åˆ MyBatis ç¯å¢ƒæ­å»ºä¸Šè¿°æ“ä½œ</li>
</ol>
<h3 id="3-2-2-è½¬è´¦æ¡ˆä¾‹-ç¯å¢ƒæ­å»º"><a href="#3-2-2-è½¬è´¦æ¡ˆä¾‹-ç¯å¢ƒæ­å»º" class="headerlink" title="3.2.2 è½¬è´¦æ¡ˆä¾‹-ç¯å¢ƒæ­å»º"></a>3.2.2 è½¬è´¦æ¡ˆä¾‹-ç¯å¢ƒæ­å»º</h3><p>a. å‡†å¤‡æ•°æ®åº“è¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> database spring_db <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line">use spring_db;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tbl_account(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">35</span>),</span><br><span class="line">    money <span class="keyword">double</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tbl_account <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;Tom&#x27;</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tbl_account <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;Jerry&#x27;</span>,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>b. åˆ›å»ºé¡¹ç›®å¯¼å…¥jaråŒ…ï¼Œé¡¹ç›®çš„ <code>pom.xml</code> æ·»åŠ ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring contextä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c. æ ¹æ®è¡¨åˆ›å»ºæ¨¡å‹ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. åˆ›å»º Dao æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update tbl_account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inMoney</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span> String name, <span class="meta">@Param(&quot;money&quot;)</span> Double money)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update tbl_account set money = money - #&#123;money&#125; where name = #&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">outMoney</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span> String name, <span class="meta">@Param(&quot;money&quot;)</span> Double money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. åˆ›å»º Service æ¥å£å’Œå®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬è´¦æ“ä½œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> out ä¼ å‡ºæ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in è½¬å…¥æ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span> &#123;</span><br><span class="line">        accountDao.outMoney(out,money);</span><br><span class="line">        accountDao.inMoney(in,money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f. æ·»åŠ  <code>jdbc.properties</code> æ–‡ä»¶</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/spring_db?useSSL=false</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>g. åˆ›å»º JdbcConfig é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(driver);</span><br><span class="line">        ds.setUrl(url);</span><br><span class="line">        ds.setUsername(userName);</span><br><span class="line">        ds.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>h. åˆ›å»º MybatisConfig é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">SqlSessionFactoryBean</span> <span class="variable">ssfb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">        ssfb.setTypeAliasesPackage(<span class="string">&quot;com.muyoukule.Entity&quot;</span>);</span><br><span class="line">        ssfb.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> ssfb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.muyoukule.Dao&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>i. åˆ›å»ºS pringConfig é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class, MybatisConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>j. ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = SpringConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransfer</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        accountService.transfer(<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jerry&quot;</span>,<span class="number">100D</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-äº‹åŠ¡ç®¡ç†"><a href="#3-2-3-äº‹åŠ¡ç®¡ç†" class="headerlink" title="3.2.3 äº‹åŠ¡ç®¡ç†"></a>3.2.3 äº‹åŠ¡ç®¡ç†</h3><p>ä¸Šè¿°ç¯å¢ƒï¼Œè¿è¡Œå•å…ƒæµ‹è¯•ç±»ï¼Œä¼šæ‰§è¡Œè½¬è´¦æ“ä½œï¼Œ<code>Tom</code>çš„è´¦æˆ·ä¼šå‡å°‘100ï¼Œ<code>Jerry</code>çš„è´¦æˆ·ä¼šåŠ 100ã€‚</p>
<p>è¿™æ˜¯æ­£å¸¸æƒ…å†µä¸‹çš„è¿è¡Œç»“æœï¼Œä½†æ˜¯å¦‚æœåœ¨è½¬è´¦çš„è¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå¦‚:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span> &#123;</span><br><span class="line">        accountDao.outMoney(out,money);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">        accountDao.inMoney(in,money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ—¶å€™å°±æ¨¡æ‹Ÿäº†è½¬è´¦è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸çš„æƒ…å†µï¼Œæ­£ç¡®çš„æ“ä½œåº”è¯¥æ˜¯è½¬è´¦å‡ºé—®é¢˜äº†ï¼Œ<code>Tom</code> åº”è¯¥è¿˜æ˜¯900ï¼Œ<code>Jerry</code> åº”è¯¥è¿˜æ˜¯1100ï¼Œä½†æ˜¯çœŸæ­£è¿è¡Œåä¼šå‘ç°ï¼Œå¹¶æ²¡æœ‰åƒæˆ‘ä»¬æƒ³è±¡çš„é‚£æ ·ï¼Œ<code>Tom</code> è´¦æˆ·ä¸º800è€Œ <code>Jerry</code> è¿˜æ˜¯1100ï¼Œ100å—é’±å‡­ç©ºæ¶ˆå¤±äº†ï¼Œé“¶è¡Œä¹ç–¯äº†ã€‚å¦‚æœæŠŠè½¬è´¦æ¢ä¸ªé¡ºåºï¼Œé“¶è¡Œå°±è¯¥å“­äº†ã€‚</p>
<p>ä¸ç®¡å“ªç§æƒ…å†µï¼Œéƒ½æ˜¯ä¸å…è®¸å‡ºç°çš„ï¼Œå¯¹åˆšæ‰çš„ç»“æœæˆ‘ä»¬åšä¸€ä¸ªåˆ†æ:</p>
<ol>
<li><p>ç¨‹åºæ­£å¸¸æ‰§è¡Œæ—¶ï¼Œè´¦æˆ·é‡‘é¢Aå‡BåŠ ï¼Œæ²¡æœ‰é—®é¢˜</p>
</li>
<li><p>ç¨‹åºå‡ºç°å¼‚å¸¸åï¼Œè½¬è´¦å¤±è´¥ï¼Œä½†æ˜¯å¼‚å¸¸ä¹‹å‰æ“ä½œæˆåŠŸï¼Œå¼‚å¸¸ä¹‹åæ“ä½œå¤±è´¥ï¼Œæ•´ä½“ä¸šåŠ¡å¤±è´¥</p>
</li>
</ol>
<p>å½“ç¨‹åºå‡ºé—®é¢˜åï¼Œæˆ‘ä»¬éœ€è¦è®©äº‹åŠ¡è¿›è¡Œå›æ»šï¼Œè€Œä¸”è¿™ä¸ªäº‹åŠ¡åº”è¯¥æ˜¯åŠ åœ¨ä¸šåŠ¡å±‚ä¸Šï¼Œè€Œ Spring çš„äº‹åŠ¡ç®¡ç†å°±æ˜¯ç”¨æ¥è§£å†³è¿™ç±»é—®é¢˜çš„ã€‚</p>
<blockquote>
<p>Spring äº‹åŠ¡ç®¡ç†å…·ä½“çš„å®ç°æ­¥éª¤</p>
</blockquote>
<p>a. åœ¨éœ€è¦è¢«äº‹åŠ¡ç®¡ç†çš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬è´¦æ“ä½œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> out ä¼ å‡ºæ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in è½¬å…¥æ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> &#123;</span><br><span class="line">        accountDao.outMoney(out, money);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">        accountDao.inMoney(in, money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„:</p>
<p><code>@Transactional</code> å¯ä»¥å†™åœ¨æ¥å£ç±»ä¸Šã€æ¥å£æ–¹æ³•ä¸Šã€å®ç°ç±»ä¸Šå’Œå®ç°ç±»æ–¹æ³•ä¸Š</p>
<ul>
<li>å†™åœ¨æ¥å£ç±»ä¸Šï¼Œè¯¥æ¥å£çš„æ‰€æœ‰å®ç°ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šæœ‰äº‹åŠ¡</li>
<li>å†™åœ¨æ¥å£æ–¹æ³•ä¸Šï¼Œè¯¥æ¥å£çš„æ‰€æœ‰å®ç°ç±»çš„è¯¥æ–¹æ³•éƒ½ä¼šæœ‰äº‹åŠ¡</li>
<li>å†™åœ¨å®ç°ç±»ä¸Šï¼Œè¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šæœ‰äº‹åŠ¡</li>
<li>å†™åœ¨å®ç°ç±»æ–¹æ³•ä¸Šï¼Œè¯¥æ–¹æ³•ä¸Šæœ‰äº‹åŠ¡</li>
<li>å»ºè®®å†™åœ¨å®ç°ç±»æˆ–å®ç°ç±»çš„æ–¹æ³•ä¸Š</li>
</ul>
<p>b. åœ¨ JdbcConfig ç±»ä¸­é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PlatformTransactionManager <span class="title function_">transactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼š</strong>äº‹åŠ¡ç®¡ç†å™¨è¦æ ¹æ®ä½¿ç”¨æŠ€æœ¯è¿›è¡Œé€‰æ‹©ï¼ŒMybatis æ¡†æ¶ä½¿ç”¨çš„æ˜¯ JDBC äº‹åŠ¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>DataSourceTransactionManager</code> </p>
<p>c. å¼€å¯äº‹åŠ¡æ³¨è§£</p>
<p>åœ¨ SpringConfig çš„é…ç½®ç±»ä¸­å¼€å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class, MybatisConfig.class&#125;)</span></span><br><span class="line"><span class="comment">//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. è¿è¡Œæµ‹è¯•ç±»</p>
<p>ä¼šå‘ç°åœ¨è½¬æ¢çš„ä¸šåŠ¡å‡ºç°é”™è¯¯åï¼Œäº‹åŠ¡å°±å¯ä»¥æ§åˆ¶å›é¡¾ï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€‚</p>
<h2 id="3-3-Springäº‹åŠ¡è§’è‰²"><a href="#3-3-Springäº‹åŠ¡è§’è‰²" class="headerlink" title="3.3 Springäº‹åŠ¡è§’è‰²"></a>3.3 Springäº‹åŠ¡è§’è‰²</h2><p>è¿™èŠ‚ä¸­æˆ‘ä»¬é‡ç‚¹è¦ç†è§£ä¸¤ä¸ªæ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯ <code>äº‹åŠ¡ç®¡ç†å‘˜</code> å’Œ <code>äº‹åŠ¡åè°ƒå‘˜</code> ã€‚</p>
<ol>
<li>æœªå¼€å¯Springäº‹åŠ¡ä¹‹å‰:</li>
</ol>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E6%9C%AA%E5%BC%80%E5%90%AFSpring%E4%BA%8B%E5%8A%A1%E4%B9%8B%E5%89%8D.png" style="zoom: 50%;">

<ul>
<li>AccountDao çš„ outMoney å› ä¸ºæ˜¯ä¿®æ”¹æ“ä½œï¼Œä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡T1</li>
<li>AccountDao çš„ inMoney å› ä¸ºæ˜¯ä¿®æ”¹æ“ä½œï¼Œä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡T2</li>
<li>AccountService çš„ transfer æ²¡æœ‰äº‹åŠ¡ï¼Œ<ul>
<li>è¿è¡Œè¿‡ç¨‹ä¸­å¦‚æœæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™T1å’ŒT2éƒ½æ­£å¸¸æäº¤ï¼Œæ•°æ®æ­£ç¡®</li>
<li>å¦‚æœåœ¨ä¸¤ä¸ªæ–¹æ³•ä¸­é—´æŠ›å‡ºå¼‚å¸¸ï¼ŒT1å› ä¸ºæ‰§è¡ŒæˆåŠŸæäº¤äº‹åŠ¡ï¼ŒT2å› ä¸ºæŠ›å¼‚å¸¸ä¸ä¼šè¢«æ‰§è¡Œ</li>
<li>å°±ä¼šå¯¼è‡´æ•°æ®å‡ºç°é”™è¯¯</li>
</ul>
</li>
</ul>
<ol start="2">
<li>å¼€å¯Springçš„äº‹åŠ¡ç®¡ç†å</li>
</ol>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E5%BC%80%E5%90%AFSpring%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%90%8E.png" style="zoom: 50%;">

<ul>
<li>transferä¸Šæ·»åŠ äº† <code>@Transactional</code> æ³¨è§£ï¼Œåœ¨è¯¥æ–¹æ³•ä¸Šå°±ä¼šæœ‰ä¸€ä¸ªäº‹åŠ¡T</li>
<li>AccountDaoçš„ outMoney æ–¹æ³•çš„äº‹åŠ¡T1åŠ å…¥åˆ° transfer çš„äº‹åŠ¡Tä¸­</li>
<li>AccountDaoçš„ inMoney æ–¹æ³•çš„äº‹åŠ¡T2åŠ å…¥åˆ° transfer çš„äº‹åŠ¡Tä¸­</li>
<li>è¿™æ ·å°±ä¿è¯ä»–ä»¬åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå½“ä¸šåŠ¡å±‚ä¸­å‡ºç°å¼‚å¸¸ï¼Œæ•´ä¸ªäº‹åŠ¡å°±ä¼šå›æ»šï¼Œä¿è¯æ•°æ®çš„å‡†ç¡®æ€§ã€‚</li>
</ul>
<p>é€šè¿‡ä¸Šé¢ä¾‹å­çš„åˆ†æï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ¦‚å¿µï¼š</p>
<ul>
<li>äº‹åŠ¡ç®¡ç†å‘˜ï¼šå‘èµ·äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸æŒ‡ä»£ä¸šåŠ¡å±‚å¼€å¯äº‹åŠ¡çš„æ–¹æ³•</li>
<li>äº‹åŠ¡åè°ƒå‘˜ï¼šåŠ å…¥äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸æŒ‡ä»£æ•°æ®å±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡å±‚æ–¹æ³•</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<p>ç›®å‰çš„äº‹åŠ¡ç®¡ç†æ˜¯åŸºäº <code>DataSourceTransactionManager</code> å’Œ <code>SqlSessionFactoryBean</code> ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªæ•°æ®æºã€‚</p>
<h2 id="3-4-Springäº‹åŠ¡å±æ€§"><a href="#3-4-Springäº‹åŠ¡å±æ€§" class="headerlink" title="3.4 Springäº‹åŠ¡å±æ€§"></a>3.4 Springäº‹åŠ¡å±æ€§</h2><p>ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ä¸¤ä¸ªæ¦‚å¿µï¼Œäº‹åŠ¡çš„ç®¡ç†å‘˜å’Œäº‹åŠ¡çš„ååŒå‘˜ï¼Œå¯¹äºè¿™ä¸¤ä¸ªæ¦‚å¿µå…·ä½“åšä»€ä¹ˆçš„ï¼Œæˆ‘ä»¬å¾…ä¼šé€šè¿‡æ¡ˆä¾‹æ¥ä½¿ç”¨ä¸‹ã€‚é™¤äº†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œè¿˜æœ‰å°±æ˜¯äº‹åŠ¡çš„å…¶ä»–ç›¸å…³é…ç½®éƒ½æœ‰å“ªäº›ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦å­¦ä¹ çš„å†…å®¹ã€‚</p>
<p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ ä¸‰éƒ¨åˆ†å†…å®¹ <code>äº‹åŠ¡é…ç½®</code> ã€ <code>è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—</code> ã€ <code>äº‹åŠ¡ä¼ æ’­è¡Œä¸º</code>ã€‚</p>
<h3 id="3-4-1-äº‹åŠ¡é…ç½®"><a href="#3-4-1-äº‹åŠ¡é…ç½®" class="headerlink" title="3.4.1 äº‹åŠ¡é…ç½®"></a>3.4.1 äº‹åŠ¡é…ç½®</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/Spring%E4%BA%8B%E5%8A%A1%E9%85%8D%E7%BD%AE.png" style="zoom: 50%;">

<p>ä¸Šé¢è¿™äº›å±æ€§éƒ½å¯ä»¥åœ¨ <code>@Transactional</code> æ³¨è§£çš„å‚æ•°ä¸Šè¿›è¡Œè®¾ç½®ï¼š</p>
<ul>
<li><p>readOnlyï¼štrue åªè¯»äº‹åŠ¡ï¼Œfalse è¯»å†™äº‹åŠ¡ï¼Œå¢åˆ æ”¹è¦è®¾ä¸º false,æŸ¥è¯¢è®¾ä¸º trueã€‚</p>
</li>
<li><p>timeoutï¼šè®¾ç½®è¶…æ—¶æ—¶é—´å•ä½ç§’ï¼Œåœ¨å¤šé•¿æ—¶é—´ä¹‹å†…äº‹åŠ¡æ²¡æœ‰æäº¤æˆåŠŸå°±è‡ªåŠ¨å›æ»šï¼Œ-1è¡¨ç¤ºä¸è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</p>
</li>
<li><p>rollbackForï¼šå½“å‡ºç°æŒ‡å®šå¼‚å¸¸è¿›è¡Œäº‹åŠ¡å›æ»š</p>
</li>
<li><p>noRollbackForï¼šå½“å‡ºç°æŒ‡å®šå¼‚å¸¸ä¸è¿›è¡Œäº‹åŠ¡å›æ»š</p>
<ul>
<li><p>æ€è€ƒï¼šå‡ºç°å¼‚å¸¸äº‹åŠ¡ä¼šè‡ªåŠ¨å›æ»šï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬ä¹‹å‰å°±å·²ç»çŸ¥é“çš„</p>
</li>
<li><p>noRollbackFor æ˜¯è®¾å®šå¯¹äºæŒ‡å®šçš„å¼‚å¸¸ä¸å›æ»šï¼Œè¿™ä¸ªå¥½ç†è§£</p>
</li>
<li><p>rollbackFor æ˜¯æŒ‡å®šå›æ»šå¼‚å¸¸ï¼Œå¯¹äºå¼‚å¸¸äº‹åŠ¡ä¸åº”è¯¥éƒ½å›æ»šä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦æŒ‡å®š?</p>
<ul>
<li><p>è¿™å—éœ€è¦æ›´æ­£ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¼‚å¸¸éƒ½ä¼šå›æ»šäº‹åŠ¡ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±ä¸ä¼šå›æ»š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬è´¦æ“ä½œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> out   ä¼ å‡ºæ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in    è½¬å…¥æ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        accountDao.outMoney(out, money);</span><br><span class="line">        <span class="comment">//int i = 1/0; //è¿™ä¸ªå¼‚å¸¸äº‹åŠ¡ä¼šå›æ»š</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(); <span class="comment">//è¿™ä¸ªå¼‚å¸¸äº‹åŠ¡å°±ä¸ä¼šå›æ»š</span></span><br><span class="line">        &#125;</span><br><span class="line">        accountDao.inMoney(in, money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>å‡ºç°è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼ŒSpringçš„äº‹åŠ¡åªä¼šå¯¹ <code>Error</code> å¼‚å¸¸ å’Œ <code>RuntimeException</code> å¼‚å¸¸åŠå…¶å­ç±»è¿›è¡Œäº‹åŠ¡å›é¡¾ï¼Œå…¶ä»–çš„å¼‚å¸¸ç±»å‹æ˜¯ä¸ä¼šå›æ»šçš„ï¼Œå¯¹åº” IOException ä¸ç¬¦åˆä¸Šè¿°æ¡ä»¶æ‰€ä»¥ä¸å›æ»š</p>
<ul>
<li><p>æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ rollbackFor å±æ€§æ¥è®¾ç½®å‡ºç° <code>IOException</code> å¼‚å¸¸ä¸å›æ»š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = &#123;IOException.class&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        accountDao.outMoney(out, money);</span><br><span class="line">        <span class="comment">//int i = 1/0; //è¿™ä¸ªå¼‚å¸¸äº‹åŠ¡ä¼šå›æ»š</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(); <span class="comment">//è¿™ä¸ªå¼‚å¸¸äº‹åŠ¡å°±ä¸ä¼šå›æ»š</span></span><br><span class="line">        &#125;</span><br><span class="line">        accountDao.inMoney(in, money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>rollbackForClassName ç­‰åŒäº rollbackForï¼Œåªä¸è¿‡å±æ€§ä¸ºå¼‚å¸¸çš„ç±»å…¨åå­—ç¬¦ä¸²</p>
</li>
<li><p>noRollbackForClassName ç­‰åŒäº noRollbackForï¼Œåªä¸è¿‡å±æ€§ä¸ºå¼‚å¸¸çš„ç±»å…¨åå­—ç¬¦ä¸²</p>
</li>
<li><p>isolation è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</p>
<ul>
<li>DEFAULTï¼šé»˜è®¤éš”ç¦»çº§åˆ«, ä¼šé‡‡ç”¨æ•°æ®åº“çš„éš”ç¦»çº§åˆ«</li>
<li>READ_UNCOMMITTEDï¼šè¯»æœªæäº¤</li>
<li>READ_COMMITTEDï¼šè¯»å·²æäº¤</li>
<li>REPEATABLE_READï¼šé‡å¤è¯»å–</li>
<li>SERIALIZABLEï¼šä¸²è¡ŒåŒ–</li>
</ul>
</li>
</ul>
<p>ä»‹ç»å®Œä¸Šè¿°å±æ€§åï¼Œè¿˜æœ‰æœ€åä¸€ä¸ªäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œä¸ºäº†è®²è§£è¯¥å±æ€§çš„è®¾ç½®ï¼Œæˆ‘ä»¬éœ€è¦å®Œæˆä¸‹é¢çš„æ¡ˆä¾‹ã€‚</p>
<h3 id="3-4-2-è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—æ¡ˆä¾‹"><a href="#3-4-2-è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—æ¡ˆä¾‹" class="headerlink" title="3.4.2 è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—æ¡ˆä¾‹"></a>3.4.2 è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—æ¡ˆä¾‹</h3><h4 id="3-4-2-1-éœ€æ±‚åˆ†æ"><a href="#3-4-2-1-éœ€æ±‚åˆ†æ" class="headerlink" title="3.4.2.1 éœ€æ±‚åˆ†æ"></a>3.4.2.1 éœ€æ±‚åˆ†æ</h4><p>åœ¨å‰é¢çš„è½¬æ¡ˆä¾‹çš„åŸºç¡€ä¸Šæ·»åŠ æ–°çš„éœ€æ±‚ï¼Œå®Œæˆè½¬è´¦åè®°å½•æ—¥å¿—ã€‚</p>
<ul>
<li>éœ€æ±‚ï¼šå®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œï¼Œå¹¶å¯¹æ¯æ¬¡è½¬è´¦æ“ä½œåœ¨æ•°æ®åº“è¿›è¡Œç•™ç—•</li>
<li>éœ€æ±‚å¾®ç¼©ï¼šAè´¦æˆ·å‡é’±ï¼ŒBè´¦æˆ·åŠ é’±ï¼Œæ•°æ®åº“è®°å½•æ—¥å¿—</li>
</ul>
<p>åŸºäºä¸Šè¿°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹è¯¥å¦‚ä½•å®ç°:</p>
<ol>
<li><p>åŸºäºè½¬è´¦æ“ä½œæ¡ˆä¾‹æ·»åŠ æ—¥å¿—æ¨¡å—ï¼Œå®ç°æ•°æ®åº“ä¸­è®°å½•æ—¥å¿—</p>
</li>
<li><p>ä¸šåŠ¡å±‚è½¬è´¦æ“ä½œï¼ˆtransferï¼‰ï¼Œè°ƒç”¨å‡é’±ã€åŠ é’±ä¸è®°å½•æ—¥å¿—åŠŸèƒ½</p>
</li>
</ol>
<p>éœ€è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼Œæˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹çš„é¢„æœŸæ•ˆæœä¸ºï¼šæ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå‡è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¥å¿—ç•™ç—•ã€‚</p>
<h4 id="3-4-2-2-ç¯å¢ƒå‡†å¤‡"><a href="#3-4-2-2-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="3.4.2.2 ç¯å¢ƒå‡†å¤‡"></a>3.4.2.2 ç¯å¢ƒå‡†å¤‡</h4><p>è¯¥ç¯å¢ƒæ˜¯åŸºäºè½¬è´¦ç¯å¢ƒæ¥å®Œæˆçš„ï¼Œåœ¨å…¶åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹å†™ï¼š</p>
<p>a. åˆ›å»ºæ—¥å¿—è¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tbl_log(</span><br><span class="line">   id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">   info <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">   createDate datetime</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>b. æ·»åŠ  LogDao æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LogDao</span> &#123;</span><br><span class="line">    <span class="meta">@Insert(&quot;insert into tbl_log (info,createDate) values(#&#123;info&#125;,now())&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String info)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>c. æ·»åŠ  LogService æ¥å£ä¸å®ç°ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LogService</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String out, String in, Double money)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">LogService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LogDao logDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String out, String in, Double money)</span> &#123;</span><br><span class="line">        logDao.log(<span class="string">&quot;è½¬è´¦æ“ä½œç”±&quot;</span> + out + <span class="string">&quot;åˆ°&quot;</span> + in + <span class="string">&quot;,é‡‘é¢ï¼š&quot;</span> + money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>d. åœ¨è½¬è´¦çš„ä¸šåŠ¡ä¸­æ·»åŠ è®°å½•æ—¥å¿—</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬è´¦æ“ä½œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> out   ä¼ å‡ºæ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in    è½¬å…¥æ–¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LogService logService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out, String in, Double money)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            accountDao.outMoney(out, money);</span><br><span class="line">            accountDao.inMoney(in, money);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            logService.log(out, in, money);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e. è¿è¡Œç¨‹åº</p>
<ul>
<li><p>å½“ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œtbl_account è¡¨ä¸­è½¬è´¦æˆåŠŸï¼Œtbl_log è¡¨ä¸­æ—¥å¿—è®°å½•æˆåŠŸ</p>
</li>
<li><p>å½“è½¬è´¦ä¸šåŠ¡ä¹‹é—´å‡ºç°å¼‚å¸¸(int i &#x3D;1&#x2F;0)ï¼Œè½¬è´¦å¤±è´¥ï¼Œtbl_account æˆåŠŸå›æ»šï¼Œä½†æ˜¯ tbl_log è¡¨æœªæ·»åŠ æ•°æ®</p>
</li>
<li><p>è¿™ä¸ªç»“æœå’Œæˆ‘ä»¬æƒ³è¦çš„ä¸ä¸€æ ·ï¼Œä»€ä¹ˆåŸå› ï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ</p>
</li>
<li><p>å¤±è´¥åŸå› ï¼šæ—¥å¿—çš„è®°å½•ä¸è½¬è´¦æ“ä½œéš¶å±åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒæˆåŠŸåŒå¤±è´¥</p>
</li>
<li><p>æœ€ç»ˆæ•ˆæœï¼šæ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸï¼Œæ—¥å¿—å¿…é¡»ä¿ç•™</p>
</li>
</ul>
<h3 id="3-4-3-äº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#3-4-3-äº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="3.4.3 äº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a>3.4.3 äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA.png" style="zoom:50%;">

<p>å¯¹äºä¸Šè¿°æ¡ˆä¾‹çš„åˆ†æï¼š</p>
<ul>
<li>log æ–¹æ³•ã€inMoney æ–¹æ³•å’Œ outMoney æ–¹æ³•éƒ½å±äºå¢åˆ æ”¹ï¼Œåˆ†åˆ«æœ‰äº‹åŠ¡T1ï¼ŒT2ï¼ŒT3</li>
<li>transfer å› ä¸ºåŠ äº† <code>@Transactional</code> æ³¨è§£ï¼Œä¹Ÿå¼€å¯äº†äº‹åŠ¡T</li>
<li>å‰é¢æˆ‘ä»¬è®²è¿‡ Spring äº‹åŠ¡ä¼šæŠŠT1ï¼ŒT2ï¼ŒT3éƒ½åŠ å…¥åˆ°äº‹åŠ¡Tä¸­</li>
<li>æ‰€ä»¥å½“è½¬è´¦å¤±è´¥åï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½å›æ»šï¼Œå¯¼è‡´æ—¥å¿—æ²¡æœ‰è®°å½•ä¸‹æ¥</li>
<li>è¿™å’Œæˆ‘ä»¬çš„éœ€æ±‚ä¸ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æƒ³èƒ½ä¸èƒ½è®© log æ–¹æ³•å•ç‹¬æ˜¯ä¸€ä¸ªäº‹åŠ¡å‘¢?</li>
</ul>
<p>è¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±éœ€è¦ç”¨åˆ°äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œæ‰€è°“çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºæŒ‡çš„æ˜¯ï¼š</p>
<p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹åŠ¡ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦ã€‚</p>
<p>å…·ä½“å¦‚ä½•è§£å†³ï¼Œå°±éœ€è¦ç”¨åˆ°ä¹‹å‰æˆ‘ä»¬æ²¡æœ‰è¯´çš„ <code>propagationå±æ€§</code>ã€‚</p>
<p>a. ä¿®æ”¹ logService æ”¹å˜äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">LogService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LogDao logDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//propagationè®¾ç½®äº‹åŠ¡å±æ€§ï¼šä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸ºå½“å‰æ“ä½œéœ€è¦æ–°äº‹åŠ¡</span></span><br><span class="line">    <span class="meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String out, String in, Double money)</span> &#123;</span><br><span class="line">        logDao.log(<span class="string">&quot;è½¬è´¦æ“ä½œç”±&quot;</span> + out + <span class="string">&quot;åˆ°&quot;</span> + in + <span class="string">&quot;,é‡‘é¢ï¼š&quot;</span> + money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåï¼Œå°±èƒ½å®ç°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œä¸ç®¡è½¬è´¦æ˜¯å¦æˆåŠŸï¼Œéƒ½ä¼šè®°å½•æ—¥å¿—ã€‚</p>
<p>b. äº‹åŠ¡ä¼ æ’­è¡Œä¸ºçš„å¯é€‰å€¼</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/accidence-spring/%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA%E7%9A%84%E5%8F%AF%E9%80%89%E5%80%BC.png" style="zoom: 50%;">

<p>å¯¹äºæˆ‘ä»¬å¼€å‘å®é™…ä¸­ä½¿ç”¨çš„è¯ï¼Œå› ä¸ºé»˜è®¤å€¼éœ€è¦äº‹åŠ¡æ˜¯å¸¸æ€çš„ã€‚æ ¹æ®å¼€å‘è¿‡ç¨‹é€‰æ‹©å…¶ä»–çš„å°±å¯ä»¥äº†ï¼Œä¾‹å¦‚æ¡ˆä¾‹ä¸­éœ€è¦æ–°äº‹åŠ¡å°±éœ€è¦æ‰‹å·¥é…ç½®ã€‚å…¶å®å…¥è´¦å’Œå‡ºè´¦æ“ä½œä¸Šä¹Ÿæœ‰äº‹åŠ¡ï¼Œé‡‡ç”¨çš„å°±æ˜¯é»˜è®¤å€¼ã€‚</p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEAï¼ï¼å¯åŠ¨ï¼ï¼ï¼</title>
    <url>/posts/How-To-Use-IDEA/</url>
    <content><![CDATA[<div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>æœ¬æ–‡å†…å®¹åŸºäº IDEA 2024.1</p>
</div>

<h1 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h1><h2 id="0-1-IDEA-ç®€ä»‹"><a href="#0-1-IDEA-ç®€ä»‹" class="headerlink" title="0.1 IDEA ç®€ä»‹"></a>0.1 IDEA ç®€ä»‹</h2><p>ç™¾åº¦ç™¾ç§‘ï¼š</p>
<p>IDEA å…¨ç§° IntelliJ IDEAï¼Œæ˜¯ Java ç¼–ç¨‹è¯­è¨€å¼€å‘çš„é›†æˆç¯å¢ƒã€‚IntelliJ IDEA åœ¨ä¸šç•Œè¢«å…¬è®¤ä¸ºæœ€å¥½çš„ Java å¼€å‘å·¥å…·ï¼Œå°¤å…¶åœ¨æ™ºèƒ½ä»£ç åŠ©æ‰‹ã€ä»£ç è‡ªåŠ¨æç¤ºã€é‡æ„ã€JavaEE æ”¯æŒã€å„ç±»ç‰ˆæœ¬å·¥å…·ï¼ˆGitã€SVN ç­‰ï¼‰ã€JUnitã€CVS æ•´åˆã€ä»£ç åˆ†æã€ åˆ›æ–°çš„ GUI è®¾è®¡ç­‰æ–¹é¢çš„åŠŸèƒ½å¯ä»¥è¯´æ˜¯è¶…å¸¸çš„ã€‚IDEA æ˜¯ <a href="https://baike.baidu.com/item/JetBrains">JetBrains</a> å…¬å¸çš„äº§å“ï¼Œè¿™å®¶å…¬å¸æ€»éƒ¨ä½äº <a href="https://baike.baidu.com/item/%E6%8D%B7%E5%85%8B/191121?fromtitle=%E6%8D%B7%E5%85%8B%E5%85%B1%E5%92%8C%E5%9B%BD&fromid=418555">æ·å…‹å…±å’Œå›½</a> çš„é¦–éƒ½ <a href="https://baike.baidu.com/item/%E5%B8%83%E6%8B%89%E6%A0%BC/632">å¸ƒæ‹‰æ ¼</a>ï¼Œå¼€å‘äººå‘˜ä»¥ä¸¥è°¨è‘—ç§°çš„ä¸œæ¬§ç¨‹åºå‘˜ä¸ºä¸»ã€‚å®ƒçš„æ——èˆ°ç‰ˆæœ¬è¿˜æ”¯æŒ HTMLï¼ŒCSSï¼ŒPHPï¼ŒMySQLï¼ŒPython ç­‰ã€‚å…è´¹ç‰ˆåªæ”¯æŒ Javaï¼ŒKotlin ç­‰å°‘æ•°è¯­è¨€ã€‚</p>
<h2 id="0-2-ç¼–å†™ç›®çš„"><a href="#0-2-ç¼–å†™ç›®çš„" class="headerlink" title="0.2 ç¼–å†™ç›®çš„"></a>0.2 ç¼–å†™ç›®çš„</h2><p>åœ¨å­¦ä¹  Java æ—¶ï¼Œé™¤äº†å®‰è£… Java ç¯å¢ƒå¤–ï¼Œè¿˜éœ€è¦å®‰è£…ä¸€ä¸ª IDEï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰ï¼Œæ¯”å¦‚ï¼š Eclipseã€MyEclipseã€IDEA ç­‰ç­‰ã€‚å¦‚ä»Šå¤§å®¶ä½¿ç”¨æœ€å¤šçš„ Java IDE æ˜¯ IDEAã€‚æˆ‘æœ€å¼€å§‹æ¥è§¦ IDE çš„æ—¶å€™æ˜¯åœ¨å¤§ä¸€ä¸‹å­¦æœŸï¼ˆå¥½åƒæ˜¯å§ï¼Œæœ‰ç‚¹å¿˜è®°äº†ğŸ˜…ï¼‰ï¼Œä½†æ˜¯é‚£æ—¶å€™ç”¨çš„æ˜¯Eclipseï¼Œè‡³äºåŸå› å˜›â€¦å½“ç„¶æ˜¯è€å¸ˆå«æˆ‘ä»¬å®‰è£…çš„å’¯ï¼ˆæˆ‘ä¹Ÿæ²¡åŠæ³•ï¼Œé‚£æ—¶å€™å•¥ä¹Ÿä¸æ‡‚ï¼ŒåªçŸ¥é“ä¾æ ·ç”»è‘«èŠ¦ï¼Œè€å¸ˆè¯´å•¥å°±æ˜¯å•¥ï¼Œä¸»æ‰“ä¸€ä¸ª<del>æ²¡ä¸»è§</del>å¬è¯ï¼‰ï¼Œåæ¥åˆ°æœŸæœ«å¾—åšé¡¹ç›®ï¼Œè¢«é€¼æ— å¥ˆå»ç½‘ä¸Šæ‰¾è§†é¢‘<del>å­¦ä¹ </del>è¡¥ä¹ ï¼ˆæˆ‘ä¿è¯ç»å¯¹ä¸æ˜¯å› ä¸ºå¹³æ—¶ä¸Šè¯¾æ²¡å¬ï¼Œåªæ˜¯å•çº¯è§‰å¾—è‡ªå·±å­¦å¾—è¿˜ä¸å¤ŸğŸ˜³ï¼‰ï¼Œå‘ç°ç½‘ä¸Šçš„å¤§ä½¬ä»¬éƒ½æ˜¯ä½¿ç”¨çš„IDEAä½œä¸ºå¼€å‘å·¥å…·ï¼Œçœ‹ç€å¤§ä½¬ä»¬ä½¿ç”¨IDEAç¼–å†™ä»£ç çœŸçš„å¥½ä¸æ»‘å•Š<del>IDEAçš„ç•Œé¢çœŸçš„æ¯”Eclipseå¥½çœ‹å¾—å¤ªå¤šå¤ªå¤šå•¦ï¼ï¼ï¼</del>ï¼Œäºæ˜¯æˆ‘æŒ‰æºä¸ä½æƒ³è¦å°è¯•ä¸€ä¸‹IDEAçš„å¿ƒï¼Œå°±å»ä¸‹è½½äº†ä¸ªIDEAï¼Œä¸€ç›´ç”¨åˆ°ç°åœ¨â€¦è™½ç„¶æˆ‘å·²ç»ä½¿ç”¨äº†å¾ˆä¹…çš„ IDEA äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç†Ÿç»ƒè¿ç”¨å…¶ç‰¹æ€§ï¼Œä»…ä»…ä½¿ç”¨äº†å®ƒçš„è‡ªåŠ¨è¡¥å…¨å’Œä¸€äº›é€šç”¨å¿«æ·é”®ã€‚</p>
<p>æœ¬æ–‡æ„åœ¨è®°å½•ä¸€äº›IDEAå¸¸ç”¨çš„ â€œåŸºæœ¬è®¾ç½®â€ å’Œ â€œåŸºæœ¬æ“ä½œâ€ ï¼Œæ–¹ä¾¿æœ¬äººé—å¿˜æ—¶å¿«é€ŸæŸ¥è¯¢ã€‚</p>
<p><font color="red"><strong>PSï¼šæœ¬æ–‡éšç€æœ¬äººåœ¨å­¦åˆ°æ–°çš„æ“ä½œåæŒç»­æ›´æ–°â€¦</strong></font></p>
<h2 id="0-3-IDEA-ä¸»è¦ä¼˜åŠ¿"><a href="#0-3-IDEA-ä¸»è¦ä¼˜åŠ¿" class="headerlink" title="0.3 IDEA ä¸»è¦ä¼˜åŠ¿"></a>0.3 IDEA ä¸»è¦ä¼˜åŠ¿</h2><p>ä¸ºä»€ä¹ˆé€‰æ‹©IDEAå‘¢ï¼Ÿå› ä¸ºIDEAåœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½åŒ–å’Œé«˜æ•ˆæ€§</strong>ï¼šIDEAèƒ½å¤Ÿå®æ—¶åˆ†æä»£ç ä¸Šä¸‹æ–‡ï¼Œæä¾›ç²¾å‡†çš„ä»£ç è¡¥å…¨ã€è‡ªåŠ¨å¯¼å…¥åŒ…ï¼Œç”šè‡³é¢„æµ‹å¯èƒ½çš„ä»£ç ç‰‡æ®µï¼Œä½¿å¾—ç¼–å†™ä»£ç å˜å¾—æ›´åŠ é«˜æ•ˆå’Œæµç•…ã€‚</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ”¯æŒ</strong>ï¼šIDEAæ”¯æŒå¤šç§ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¦‚Gitã€SVNç­‰ï¼Œæä¾›äº†å¯è§†åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ç•Œé¢ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿè½»æ¾ç®¡ç†ä»£ç å˜æ›´ã€åˆ†æ”¯å’Œåˆå¹¶æ“ä½œã€‚</li>
<li><strong>å¼ºå¤§çš„é‡æ„å·¥å…·</strong>ï¼šIDEAæ‹¥æœ‰å¼ºå¤§çš„é‡æ„å·¥å…·ï¼Œæ”¯æŒåŸºäºè¯­æ³•çš„é€‰æ‹©ï¼Œå¯ä»¥æ–¹ä¾¿åœ°é€‰å–æ–¹æ³•ã€å¾ªç¯ç­‰ï¼Œå¹¶åœ¨é‡æ„æ—¶æä¾›ä¾¿åˆ©ã€‚</li>
<li><strong>è°ƒè¯•åŠŸèƒ½</strong>ï¼šIDEAæä¾›äº†å¼ºå¤§çš„è°ƒè¯•å™¨ï¼Œæ”¯æŒæ–­ç‚¹ã€å˜é‡æŸ¥çœ‹ã€è°ƒç”¨æ ˆè¿½è¸ªç­‰åŠŸèƒ½ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚</li>
<li><strong>æ€§èƒ½åˆ†æ</strong>ï¼šé€šè¿‡å†…ç½®çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥æ£€æµ‹ä»£ç çš„ç“¶é¢ˆï¼Œä¼˜åŒ–ç¨‹åºæ€§èƒ½ï¼Œæé«˜è½¯ä»¶è¿è¡Œæ•ˆç‡ã€‚</li>
<li><strong>ä¸°å¯Œçš„æ’ä»¶æ‰©å±•</strong>ï¼šIDEAæ”¯æŒä¸°å¯Œçš„æ’ä»¶æ‰©å±•ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šåˆ¶å¼€å‘ç¯å¢ƒï¼Œæ‰©å±•åŠŸèƒ½èŒƒå›´ã€‚</li>
<li><strong>ç®€æ´æ˜“ç”¨çš„GUIç•Œé¢</strong>ï¼šIDEAå…·æœ‰ç®€æ´æ˜“ç”¨çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´ç›´è§‚åœ°ä½¿ç”¨å„é¡¹åŠŸèƒ½ã€‚</li>
</ul>
<p>ä»€ä¹ˆï¼Ÿçœ‹å®Œ IDEA ä¸»è¦ä¼˜åŠ¿æœ‰ç‚¹å¿ƒåŠ¨äº†ä½†æ˜¯è¿˜æ²¡æœ‰å®‰è£… IDEA ï¼Ÿé‚£ä¸å¦¨è¯•è¯•è¿™ä¸ªğŸ˜ï¼š<a href="https://blog.idejihuo.com/topics/jetbrains/idea">IDEAå…è´¹æ¿€æ´»æ•™ç¨‹å’Œæ–¹æ³•</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E4%B8%8A%E5%8F%B7.png" alt="IDEAä¸Šå·"></p>
<h1 id="1-IDEAè®¾ç½®"><a href="#1-IDEAè®¾ç½®" class="headerlink" title="1. IDEAè®¾ç½®"></a>1. IDEAè®¾ç½®</h1><h2 id="1-1-è®¾ç½®æ•´ä½“ä¸»é¢˜"><a href="#1-1-è®¾ç½®æ•´ä½“ä¸»é¢˜" class="headerlink" title="1.1 è®¾ç½®æ•´ä½“ä¸»é¢˜"></a>1.1 è®¾ç½®æ•´ä½“ä¸»é¢˜</h2><h3 id="1-1-1-è®¾ç½®ä¸»é¢˜"><a href="#1-1-1-è®¾ç½®ä¸»é¢˜" class="headerlink" title="1.1.1 è®¾ç½®ä¸»é¢˜"></a>1.1.1 è®¾ç½®ä¸»é¢˜</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E4%B8%BB%E9%A2%98.png" alt="IDEAè®¾ç½®-è®¾ç½®ä¸»é¢˜" style="zoom:50%;">

<h3 id="1-1-2-è®¾ç½®èœå•å’Œçª—å£å­—ä½“å’Œå¤§å°"><a href="#1-1-2-è®¾ç½®èœå•å’Œçª—å£å­—ä½“å’Œå¤§å°" class="headerlink" title="1.1.2 è®¾ç½®èœå•å’Œçª—å£å­—ä½“å’Œå¤§å°"></a>1.1.2 è®¾ç½®èœå•å’Œçª—å£å­—ä½“å’Œå¤§å°</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E8%8F%9C%E5%8D%95%E5%92%8C%E7%AA%97%E5%8F%A3%E5%AD%97%E4%BD%93%E5%92%8C%E5%A4%A7%E5%B0%8F.png" alt="IDEAè®¾ç½®-è®¾ç½®èœå•å’Œçª—å£å­—ä½“å’Œå¤§å°" style="zoom:50%;">

<h3 id="1-1-3-è®¾ç½®èƒŒæ™¯å›¾"><a href="#1-1-3-è®¾ç½®èƒŒæ™¯å›¾" class="headerlink" title="1.1.3 è®¾ç½®èƒŒæ™¯å›¾"></a>1.1.3 è®¾ç½®èƒŒæ™¯å›¾</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E8%83%8C%E6%99%AF%E5%9B%BE.png" alt="IDEAè®¾ç½®-è®¾ç½®èƒŒæ™¯å›¾" style="zoom:50%;">

<h2 id="1-2-è®¾ç½®ç¼–è¾‘å™¨ä¸»é¢˜æ ·å¼"><a href="#1-2-è®¾ç½®ç¼–è¾‘å™¨ä¸»é¢˜æ ·å¼" class="headerlink" title="1.2 è®¾ç½®ç¼–è¾‘å™¨ä¸»é¢˜æ ·å¼"></a>1.2 è®¾ç½®ç¼–è¾‘å™¨ä¸»é¢˜æ ·å¼</h2><h3 id="1-2-1-ç¼–è¾‘å™¨ä¸»é¢˜"><a href="#1-2-1-ç¼–è¾‘å™¨ä¸»é¢˜" class="headerlink" title="1.2.1 ç¼–è¾‘å™¨ä¸»é¢˜"></a>1.2.1 ç¼–è¾‘å™¨ä¸»é¢˜</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E7%BC%96%E8%BE%91%E5%99%A8%E4%B8%BB%E9%A2%98.png" alt="IDEAè®¾ç½®-ç¼–è¾‘å™¨ä¸»é¢˜" style="zoom:50%;">

<p>ä¸ªäººæ¯”è¾ƒæ¨èé»˜è®¤çš„ <code>Dark</code> ä¸»é¢˜ï¼ŒæŠ¤çœ¼åˆç‚«é…·ï¼Œæš—é»‘ç‚«é…·é£ï¼å¸…ï¼ï¼</p>
<h3 id="1-2-2-ç¼–è¾‘å™¨å­—ä½“å¤§å°"><a href="#1-2-2-ç¼–è¾‘å™¨å­—ä½“å¤§å°" class="headerlink" title="1.2.2 ç¼–è¾‘å™¨å­—ä½“å¤§å°"></a>1.2.2 ç¼–è¾‘å™¨å­—ä½“å¤§å°</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E7%BC%96%E8%BE%91%E5%99%A8%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F.png" alt="IDEAè®¾ç½®-ç¼–è¾‘å™¨å­—ä½“å¤§å°" style="zoom:50%;">

<p>ç¼–è¾‘å™¨æ›´è¯¦ç»†çš„å­—ä½“ä¸é¢œè‰²ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E7%BC%96%E8%BE%91%E5%99%A8%E6%9B%B4%E8%AF%A6%E7%BB%86%E7%9A%84%E5%AD%97%E4%BD%93%E4%B8%8E%E9%A2%9C%E8%89%B2.png" alt="IDEAè®¾ç½®-ç¼–è¾‘å™¨æ›´è¯¦ç»†çš„å­—ä½“ä¸é¢œè‰²" style="zoom:50%;">

<p>PSï¼šå¦‚æœé€‰æ‹©æŸä¸ªfontå­—ä½“ï¼Œä¸­æ–‡ä¹±ç ï¼Œå¯ä»¥åœ¨fallback fontï¼ˆå¤‡é€‰å­—ä½“ï¼‰ä¸­é€‰æ‹©ä¸€ä¸ªæ”¯æŒä¸­æ–‡çš„å­—ä½“ã€‚</p>
<h3 id="1-2-3-æ³¨é‡Šçš„å­—ä½“"><a href="#1-2-3-æ³¨é‡Šçš„å­—ä½“" class="headerlink" title="1.2.3 æ³¨é‡Šçš„å­—ä½“"></a>1.2.3 æ³¨é‡Šçš„å­—ä½“</h3><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E6%B3%A8%E9%87%8A%E7%9A%84%E5%AD%97%E4%BD%93.png" alt="IDEAè®¾ç½®-æ³¨é‡Šçš„å­—ä½“" style="zoom: 67%;">

<p><code>Block comment</code>ï¼šä¿®æ”¹å¤šè¡Œæ³¨é‡Šçš„å­—ä½“é¢œè‰² </p>
<p><code>Doc Comment</code> â€”&gt; <code>Text</code>ï¼šä¿®æ”¹æ–‡æ¡£æ³¨é‡Šçš„å­—ä½“é¢œè‰² </p>
<p><code>Line comment</code>ï¼šä¿®æ”¹å•è¡Œæ³¨é‡Šçš„å­—ä½“é¢œè‰²</p>
<p>æˆ‘è¿™é‡Œå°† <code>Block comment</code> å’Œ <code>Line comment</code> éƒ½è®¾ç½®ä¸ºäº† <font color="37A5B5"><code>37A5B5</code></font> ,ä¸ªäººè§‰å¾—é…åˆ Dark ä¸»é¢˜ä½¿ç”¨è¿˜æ˜¯å¾ˆå¸…çš„ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢åˆ°é¢œè‰²ğŸ¤­</p>
<h2 id="1-3-é»˜è®¤å¯åŠ¨é¡¹ç›®é…ç½®"><a href="#1-3-é»˜è®¤å¯åŠ¨é¡¹ç›®é…ç½®" class="headerlink" title="1.3 é»˜è®¤å¯åŠ¨é¡¹ç›®é…ç½®"></a>1.3 é»˜è®¤å¯åŠ¨é¡¹ç›®é…ç½®</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E9%BB%98%E8%AE%A4%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE.png" alt="IDEAè®¾ç½®-é»˜è®¤å¯åŠ¨é¡¹ç›®é…ç½®" style="zoom:50%;">

<p>å¯åŠ¨IDEAæ—¶ï¼Œé»˜è®¤è‡ªåŠ¨æ‰“å¼€ä¸Šæ¬¡å¼€å‘çš„é¡¹ç›®ï¼Ÿè¿˜æ˜¯è‡ªå·±é€‰æ‹©ï¼Ÿ </p>
<p>å¦‚æœå»æ‰<code>Reopen last project on startup</code>å‰é¢çš„ <code>âˆš</code> ï¼Œæ¯æ¬¡å¯åŠ¨IDEAå°±ä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E5%90%AF%E5%8A%A8%E7%95%8C%E9%9D%A2.png" alt="IDEAå¯åŠ¨ç•Œé¢" style="zoom: 50%;">

<h2 id="1-4-å–æ¶ˆè‡ªåŠ¨æ›´æ–°"><a href="#1-4-å–æ¶ˆè‡ªåŠ¨æ›´æ–°" class="headerlink" title="1.4 å–æ¶ˆè‡ªåŠ¨æ›´æ–°"></a>1.4 å–æ¶ˆè‡ªåŠ¨æ›´æ–°</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E5%8F%96%E6%B6%88%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0.png" alt="IDEAè®¾ç½®-å–æ¶ˆè‡ªåŠ¨æ›´æ–°" style="zoom:50%;">

<p>é»˜è®¤éƒ½æ‰“ <code>âˆš</code> äº†ï¼Œå»ºè®®æ£€æŸ¥IDEæ›´æ–°çš„ <code>âˆš</code> å»æ‰ï¼Œæ£€æŸ¥æ’ä»¶æ›´æ–°çš„ <code>âˆš</code> é€‰ä¸Šã€‚</p>
<h2 id="1-5-å¿½ç•¥å¤§å°å†™"><a href="#1-5-å¿½ç•¥å¤§å°å†™" class="headerlink" title="1.5 å¿½ç•¥å¤§å°å†™"></a>1.5 å¿½ç•¥å¤§å°å†™</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E5%BF%BD%E7%95%A5%E5%A4%A7%E5%B0%8F%E5%86%99.png" alt="IDEAè®¾ç½®-å¿½ç•¥å¤§å°å†™" style="zoom:50%;">

<p>IntelliJ IDEA çš„ä»£ç æç¤ºå’Œè¡¥å……åŠŸèƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼š <code>åŒºåˆ†å¤§å°å†™</code> ã€‚ å¦‚æœæƒ³ä¸åŒºåˆ†å¤§å°å†™çš„è¯ï¼Œå°±æŠŠè¿™ä¸ª <code>âˆš</code> å»æ‰ã€‚ <code>å»ºè®®å»æ‰å‹¾é€‰</code> ã€‚</p>
<h2 id="1-6-è‡ªåŠ¨å¯¼åŒ…é…ç½®"><a href="#1-6-è‡ªåŠ¨å¯¼åŒ…é…ç½®" class="headerlink" title="1.6 è‡ªåŠ¨å¯¼åŒ…é…ç½®"></a>1.6 è‡ªåŠ¨å¯¼åŒ…é…ç½®</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%87%AA%E5%8A%A8%E5%AF%BC%E5%8C%85%E9%85%8D%E7%BD%AE.png" alt="IDEAè®¾ç½®-è‡ªåŠ¨å¯¼åŒ…é…ç½®" style="zoom:50%;">

<p>é»˜è®¤éœ€è¦è‡ªå·±æ‰‹åŠ¨å¯¼åŒ…ï¼Œ<code>Alt+Enter</code> å¿«æ·é”®</p>
<p>è‡ªåŠ¨å¯¼åŒ…è®¾ç½® ï¼š</p>
<ul>
<li>åŠ¨æ€å¯¼å…¥æ˜ç¡®çš„åŒ…ï¼š<code>Add unambiguous imports on the fly</code>ï¼Œè¯¥è®¾ç½®å…·æœ‰å…¨å±€æ€§</li>
<li>ä¼˜åŒ–åŠ¨æ€å¯¼å…¥çš„åŒ…ï¼š<code>Optimize imports on the fly</code>ï¼Œè¯¥è®¾ç½®åªå¯¹å½“å‰é¡¹ç›®æœ‰æ•ˆ</li>
</ul>
<p>æ‡’äººä¸€å®šè¦åšçš„è®¾ç½®ğŸ˜„ï¼Œä¸è¿‡æœ‰æ—¶å€™éœ€è¦æ£€æŸ¥è‡ªåŠ¨å¯¼çš„åŒ…æ˜¯å¦æ­£ç¡®ï¼Œå¯¼åˆ°é”™è¯¯çš„åŒ…å°±éº»çƒ¦å’¯ğŸ¤£</p>
<h2 id="1-7-è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç "><a href="#1-7-è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç " class="headerlink" title="1.7 è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç "></a>1.7 è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç </h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81.png" alt="IDEAè®¾ç½®-è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç " style="zoom:50%;">

<p>è¯´æ˜ï¼š <code>Transparent native-to-ascii conversion</code> ä¸»è¦ç”¨äºè½¬æ¢ <code>ascii</code>ï¼Œæ˜¾å¼åŸç”Ÿå†…å®¹ã€‚ä¸€èˆ¬éƒ½è¦å‹¾é€‰ã€‚</p>
<h2 id="1-8-è®¾ç½®æ§åˆ¶å°çš„å­—ç¬¦ç¼–ç "><a href="#1-8-è®¾ç½®æ§åˆ¶å°çš„å­—ç¬¦ç¼–ç " class="headerlink" title="1.8 è®¾ç½®æ§åˆ¶å°çš„å­—ç¬¦ç¼–ç "></a>1.8 è®¾ç½®æ§åˆ¶å°çš„å­—ç¬¦ç¼–ç </h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81.png" alt="IDEAè®¾ç½®-è®¾ç½®æ§åˆ¶å°çš„å­—ç¬¦ç¼–ç " style="zoom:50%;">

<h2 id="1-9-ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯"><a href="#1-9-ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯" class="headerlink" title="1.9 ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯"></a>1.9 ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E4%BF%AE%E6%94%B9%E7%B1%BB%E5%A4%B4%E7%9A%84%E6%96%87%E6%A1%A3%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF.png" alt="IDEAè®¾ç½®-ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯" style="zoom:50%;">

<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Package: $&#123;PACKAGE_NAME&#125;</span></span><br><span class="line"><span class="comment">* ClassName: $&#123;NAME&#125;</span></span><br><span class="line"><span class="comment">* Description:</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Author</span> æœ¨åˆæ¯äº†</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Create</span> $&#123;DATE&#125; $&#123;TIME&#125;</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>

<p>å¸¸ç”¨çš„é¢„è®¾çš„å˜é‡ï¼Œè¿™é‡Œç›´æ¥è´´å‡ºå®˜ç½‘ç»™çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$&#123;PACKAGE_NAME&#125; â€” Name of the <span class="keyword">package</span> in which the <span class="keyword">new</span> <span class="title class_">file</span> is created</span><br><span class="line">$&#123;USER&#125; â€” Current user system login name</span><br><span class="line">$&#123;DATE&#125; â€” Current system date</span><br><span class="line">$&#123;TIME&#125; â€” Current system time</span><br><span class="line">$&#123;YEAR&#125; â€” Current year</span><br><span class="line">$&#123;MONTH&#125; â€” Current month</span><br><span class="line">$&#123;MONTH_NAME_SHORT&#125; â€” First <span class="number">3</span> letters of the current month name. Example: Jan, Feb, etc.</span><br><span class="line">$&#123;MONTH_NAME_FULL&#125; â€” Full name of the current month. Example: January, February, etc.</span><br><span class="line">$&#123;DAY&#125; â€” Current day of the month</span><br><span class="line">$&#123;DAY_NAME_SHORT&#125; â€” First <span class="number">3</span> letters of the current day name. Example: Mon, Tue, etc.</span><br><span class="line">$&#123;DAY_NAME_FULL&#125; â€” Full name of the current day. Example: Monday, Tuesday, etc.</span><br><span class="line">$&#123;HOUR&#125; â€” Current hour</span><br><span class="line">$&#123;MINUTE&#125; â€” Current minute</span><br><span class="line">$&#123;PROJECT_NAME&#125; â€” Name of the current project</span><br></pre></td></tr></table></figure>

<h2 id="1-10-è®¾ç½®è‡ªåŠ¨ç¼–è¯‘"><a href="#1-10-è®¾ç½®è‡ªåŠ¨ç¼–è¯‘" class="headerlink" title="1.10 è®¾ç½®è‡ªåŠ¨ç¼–è¯‘"></a>1.10 è®¾ç½®è‡ªåŠ¨ç¼–è¯‘</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/IDEA%E8%AE%BE%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%BC%96%E8%AF%91.png" alt="IDEAè®¾ç½®-è®¾ç½®è‡ªåŠ¨ç¼–è¯‘" style="zoom:50%;">

<h1 id="2-IDEAå¸¸ç”¨å¿«æ·é”®"><a href="#2-IDEAå¸¸ç”¨å¿«æ·é”®" class="headerlink" title="2. IDEAå¸¸ç”¨å¿«æ·é”®"></a>2. IDEAå¸¸ç”¨å¿«æ·é”®</h1><p>ä¸€äº›é€šç”¨çš„å¿«æ·é”®å°±æ‡’å¾—å†™äº†â€¦ğŸ¤£ç›´æ¥ä¸Šå¸…çš„</p>
<h2 id="2-1-æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸Šï¼‰"><a href="#2-1-æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸Šï¼‰" class="headerlink" title="2.1 æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸Šï¼‰"></a>2.1 æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸Šï¼‰</h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Ctrl + D</td>
<td align="center">å¤åˆ¶ä¸€è¡Œ</td>
</tr>
<tr>
<td align="center">Ctrl + Y</td>
<td align="center">åˆ é™¤ä¸€è¡Œ</td>
</tr>
<tr>
<td align="center">Ctrl + J</td>
<td align="center">æç¤ºä»£ç æ¨¡æ¿</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + T</td>
<td align="center">ä½¿ç”¨XXXä»£ç å—ç¯ç»•</td>
</tr>
<tr>
<td align="center">Alt + Enter</td>
<td align="center">æ™ºèƒ½æç¤º</td>
</tr>
<tr>
<td align="center">Alt + Insert</td>
<td align="center">è°ƒå‡ºç”Ÿæˆgetter&#x2F;setter&#x2F;æ„é€ å™¨ç­‰ç»“æ„</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + V</td>
<td align="center">è‡ªåŠ¨ç”Ÿæˆå˜é‡</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + Enter</td>
<td align="center">åœ¨ä¸Šä¸€è¡Œæ’å…¥</td>
</tr>
<tr>
<td align="center">Shift + Enter</td>
<td align="center">åœ¨ä¸‹ä¸€è¡Œæ’å…¥</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + æ–¹å‘é”®</td>
<td align="center">ç§»åŠ¨ä»£ç </td>
</tr>
<tr>
<td align="center">Ctrl + P</td>
<td align="center">æç¤ºæ–¹æ³•å‚æ•°</td>
</tr>
</tbody></table>
<p>Alt ä¸é¼ æ ‡ç»“åˆå¯ä»¥å®ç°æ‰¹é‡ä¿®æ”¹ï¼Œå…·ä½“æ“ä½œæ˜¯ï¼š æŒ‰ä½ Alt é”®ï¼Œå†æŒ‰ä½é¼ æ ‡å·¦é”®ï¼Œç„¶åç§»åŠ¨é¼ æ ‡ï¼Œå¯ä»¥è®©å…‰æ ‡å»¶é•¿å¤šè¡Œï¼Œä»¥å®ç°æ‰¹é‡ä¿®æ”¹ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F-Alt%E4%B8%8E%E9%BC%A0%E6%A0%87%E7%BB%93%E5%90%88%E5%AE%9E%E7%8E%B0%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9.gif" alt="å¿«æ·æ–¹å¼-Altä¸é¼ æ ‡ç»“åˆå®ç°æ‰¹é‡ä¿®æ”¹" style="zoom:67%;">

<h2 id="2-2-æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸‹ï¼‰"><a href="#2-2-æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸‹ï¼‰" class="headerlink" title="2.2 æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸‹ï¼‰"></a>2.2 æé«˜ç¼–å†™é€Ÿåº¦ï¼ˆä¸‹ï¼‰</h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Shift + F6</td>
<td align="center">æ‰¹é‡ä¿®æ”¹æŒ‡å®šçš„å˜é‡åã€æ–¹æ³•åã€ç±»åç­‰</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + M</td>
<td align="center">æŠ½å–æ–¹æ³•</td>
</tr>
<tr>
<td align="center">Ctrl + O</td>
<td align="center">é‡å†™çˆ¶ç±»çš„æ–¹æ³•</td>
</tr>
<tr>
<td align="center">Ctrl + I</td>
<td align="center">å®ç°æ¥å£çš„æ–¹æ³•</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + U</td>
<td align="center">é€‰ä¸­çš„ç»“æ„çš„å¤§å°å†™çš„åˆ‡æ¢</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + O</td>
<td align="center">æ‰¹é‡å¯¼åŒ…</td>
</tr>
</tbody></table>
<h2 id="2-3-ç±»ç»“æ„ã€æŸ¥æ‰¾å’ŒæŸ¥çœ‹æºç "><a href="#2-3-ç±»ç»“æ„ã€æŸ¥æ‰¾å’ŒæŸ¥çœ‹æºç " class="headerlink" title="2.3 ç±»ç»“æ„ã€æŸ¥æ‰¾å’ŒæŸ¥çœ‹æºç "></a>2.3 ç±»ç»“æ„ã€æŸ¥æ‰¾å’ŒæŸ¥çœ‹æºç </h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Shift + Shift</td>
<td align="center">å…¨èƒ½ï¼ æŸ¥çœ‹æ–‡ä»¶ã€ç±»ã€æ–¹æ³•ã€å†…å®¹ç­‰ç­‰</td>
</tr>
<tr>
<td align="center">Ctrl + é€‰ä¸­æŒ‡å®šçš„ç»“æ„ æˆ– Ctrl  + N</td>
<td align="center">æŸ¥çœ‹æºç </td>
</tr>
<tr>
<td align="center">Ctrl + F12</td>
<td align="center">æ˜¾ç¤ºå½“å‰ç±»ç»“æ„ï¼Œæ”¯æŒæœç´¢æŒ‡å®šçš„æ–¹æ³•ã€å±æ€§ç­‰</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + â†</td>
<td align="center">é€€å›åˆ°å‰ä¸€ä¸ªç¼–è¾‘çš„é¡µé¢</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + â†’</td>
<td align="center">è¿›å…¥åˆ°ä¸‹ä¸€ä¸ªç¼–è¾‘çš„é¡µé¢</td>
</tr>
<tr>
<td align="center">Alt + â†&#x2F;â†’</td>
<td align="center">æ‰“å¼€çš„ç±»æ–‡ä»¶ä¹‹é—´åˆ‡æ¢</td>
</tr>
<tr>
<td align="center">Ctrl + H</td>
<td align="center">å…‰æ ‡é€‰ä¸­æŒ‡å®šçš„ç±»ï¼ŒæŸ¥çœ‹ç»§æ‰¿æ ‘ç»“æ„</td>
</tr>
<tr>
<td align="center">Ctrl + Q</td>
<td align="center">æŸ¥çœ‹æ–¹æ³•æ–‡æ¡£</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + U</td>
<td align="center">ç±»çš„UMLå…³ç³»å›¾</td>
</tr>
<tr>
<td align="center">Ctrl + G</td>
<td align="center">å®šä½æŸè¡Œ</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + B</td>
<td align="center">å›æº¯å˜é‡æˆ–æ–¹æ³•çš„æ¥æº</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + -</td>
<td align="center">æŠ˜å æ–¹æ³•å®ç°</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + +</td>
<td align="center">å±•å¼€æ–¹æ³•å®ç°</td>
</tr>
</tbody></table>
<h2 id="2-4-æŸ¥æ‰¾ã€æ›¿æ¢ä¸å…³é—­"><a href="#2-4-æŸ¥æ‰¾ã€æ›¿æ¢ä¸å…³é—­" class="headerlink" title="2.4 æŸ¥æ‰¾ã€æ›¿æ¢ä¸å…³é—­"></a>2.4 æŸ¥æ‰¾ã€æ›¿æ¢ä¸å…³é—­</h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Ctrl + E</td>
<td align="center">æŸ¥çœ‹æœ€è¿‘è®¿é—®çš„æ–‡ä»¶</td>
</tr>
<tr>
<td align="center">Ctrl + F</td>
<td align="center">æ•´ä¸ªé¡µé¢ä¸­æŸ¥æ‰¾</td>
</tr>
<tr>
<td align="center">Ctrl + L</td>
<td align="center">å¿«é€ŸæŸ¥æ‰¾ï¼šé€‰ä¸­çš„Wordå¿«é€Ÿå®šä½åˆ°ä¸‹ä¸€ä¸ª</td>
</tr>
<tr>
<td align="center">Ctrl + R</td>
<td align="center">æŸ¥æ‰¾ä¸æ›¿æ¢</td>
</tr>
<tr>
<td align="center">Home</td>
<td align="center">ç›´æ¥å®šä½åˆ°å½“å‰è¡Œçš„é¦–ä½</td>
</tr>
<tr>
<td align="center">End</td>
<td align="center">ç›´æ¥å®šä½åˆ°å½“å‰è¡Œçš„æœ«ä½</td>
</tr>
<tr>
<td align="center">Ctrl + F7</td>
<td align="center">æŸ¥è¯¢å½“å‰å…ƒç´ åœ¨å½“å‰æ–‡ä»¶ä¸­çš„å¼•ç”¨ï¼Œç„¶åæŒ‰ F3 å¯ä»¥é€‰æ‹©</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + F</td>
<td align="center">å…¨é¡¹ç›®æœç´¢æ–‡æœ¬</td>
</tr>
<tr>
<td align="center">Ctrl + F4</td>
<td align="center">å…³é—­å½“å‰çª—å£</td>
</tr>
</tbody></table>
<h2 id="2-5-è°ƒæ•´æ ¼å¼"><a href="#2-5-è°ƒæ•´æ ¼å¼" class="headerlink" title="2.5 è°ƒæ•´æ ¼å¼"></a>2.5 è°ƒæ•´æ ¼å¼</h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Ctrl + &#x2F;</td>
<td align="center">å•è¡Œæ³¨é‡Š</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + &#x2F;</td>
<td align="center">å¤šè¡Œæ³¨é‡Š</td>
</tr>
<tr>
<td align="center">Ctrl + Alt + L</td>
<td align="center">æ ¼å¼åŒ–ä»£ç </td>
</tr>
<tr>
<td align="center">Tab</td>
<td align="center">é€‰ä¸­æ•°è¡Œï¼Œæ•´ä½“å¾€åç§»åŠ¨</td>
</tr>
<tr>
<td align="center">Shift + Tab</td>
<td align="center">é€‰ä¸­æ•°è¡Œï¼Œæ•´ä½“å¾€å‰ç§»åŠ¨</td>
</tr>
</tbody></table>
<h2 id="2-6-Debugå¿«æ·é”®"><a href="#2-6-Debugå¿«æ·é”®" class="headerlink" title="2.6 Debugå¿«æ·é”®"></a>2.6 Debugå¿«æ·é”®</h2><table>
<thead>
<tr>
<th align="center">å¿«æ·é”®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">F7</td>
<td align="center">å•æ­¥è°ƒè¯•ï¼ˆè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</td>
</tr>
<tr>
<td align="center">F8</td>
<td align="center">å•æ­¥è°ƒè¯•ï¼ˆä¸è¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</td>
</tr>
<tr>
<td align="center">Alt + Shift + F7</td>
<td align="center">å¼ºåˆ¶å•æ­¥è°ƒè¯•ï¼ˆè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</td>
</tr>
<tr>
<td align="center">Shift + F7</td>
<td align="center">é€‰æ‹©è¦è¿›å…¥çš„å‡½æ•°</td>
</tr>
<tr>
<td align="center">Shift + F8</td>
<td align="center">è·³å‡ºå‡½æ•°</td>
</tr>
<tr>
<td align="center">Alt + F9</td>
<td align="center">è¿è¡Œåˆ°æ–­ç‚¹</td>
</tr>
<tr>
<td align="center">F9</td>
<td align="center">ç»§ç»­æ‰§è¡Œï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–æ‰§è¡Œå®Œç¨‹åº</td>
</tr>
<tr>
<td align="center">Ctrl + F2</td>
<td align="center">åœæ­¢</td>
</tr>
<tr>
<td align="center">Ctrl + Shift + F8</td>
<td align="center">æŸ¥çœ‹æ–­ç‚¹</td>
</tr>
<tr>
<td align="center">Ctrl + F4</td>
<td align="center">å…³é—­</td>
</tr>
</tbody></table>
<h1 id="3-IDEAå¸¸ç”¨è‡ªåŠ¨è¡¥å…¨"><a href="#3-IDEAå¸¸ç”¨è‡ªåŠ¨è¡¥å…¨" class="headerlink" title="3. IDEAå¸¸ç”¨è‡ªåŠ¨è¡¥å…¨"></a>3. IDEAå¸¸ç”¨è‡ªåŠ¨è¡¥å…¨</h1><h2 id="3-1-åç¼€ä»£ç è¡¥å…¨"><a href="#3-1-åç¼€ä»£ç è¡¥å…¨" class="headerlink" title="3.1 åç¼€ä»£ç è¡¥å…¨"></a>3.1 åç¼€ä»£ç è¡¥å…¨</h2><p>ä½¿ç”¨åç¼€ä»£ç è‡ªåŠ¨è¡¥å…¨èƒ½å¤Ÿå‡å°‘åœ¨ç¼–ç¨‹æ—¶å…‰æ ‡å‘åè·³è·ƒã€‚</p>
<p>åç¼€æç¤ºå·²ç»æˆä¸ºåŸºæœ¬æç¤ºçš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”® <code>Ctrl + J</code> ç›´æ¥å‘¼å‡ºåç¼€æç¤ºã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%91%BC%E5%87%BA%E5%90%8E%E7%BC%80%E6%8F%90%E7%A4%BA.gif" alt="å‘¼å‡ºåç¼€æç¤º" style="zoom: 67%;">

<blockquote>
<p>å¸¸ç”¨åç¼€è¡¨è¾¾å¼</p>
</blockquote>
<p><strong>var</strong> ï¼š å£°æ˜å˜é‡ï¼Œæ•ˆæœä¸å¿«æ·é”® <code>Alt + Enter</code> ç±»ä¼¼</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-var.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-var" style="zoom:67%;">

<p><strong>null</strong> ï¼šåˆ¤æ–­æŸä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ºç©º</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-null.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-null" style="zoom:67%;">

<p><strong>notnull &#x2F; nn</strong> ï¼š åˆ¤æ–­æŸä¸ªè¡¨è¾¾å¼æ˜¯å¦éç©º</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-nnAndnotnull.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-nn / notnull" style="zoom:67%;">

<p><strong>for</strong> ï¼šå¢å¼ºå‹éå†</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-for.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-for" style="zoom:67%;">

<p><strong>fori</strong> ï¼šå¸¦ç´¢å¼•çš„éå†ï¼ˆæ­£åºï¼‰</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-fori.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-fori" style="zoom:67%;">

<p><strong>forr</strong> ï¼šå¸¦ç´¢å¼•çš„éå†ï¼ˆå€’åºï¼‰</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-forr.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-forr" style="zoom:67%;">

<p><strong>not</strong> ï¼šå¯¹å¸ƒå°”ç±»å‹å–å</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-not.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-not" style="zoom:67%;">

<p><strong>if</strong> ï¼šæ¡ä»¶åˆ¤æ–­</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-if.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-if" style="zoom:67%;">

<p><strong>cast</strong> ï¼š å¼ºåˆ¶ç±»å‹è½¬æ¢</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-cast.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-cast" style="zoom:67%;">

<p><strong>return</strong> ï¼š è¿”å›æŸä¸ªå€¼</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-return.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-return" style="zoom:67%;">

<p><strong>try</strong> ï¼šè‡ªåŠ¨æ·»åŠ try catch</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-try.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-try" style="zoom:67%;">

<p><strong>twr</strong> ï¼š åœ¨ try-with-resources å—ä¸­æ’å…¥è¯­å¥</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-twr.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-twr" style="zoom: 67%;">

<p><strong>while</strong> ï¼šå¸ƒå°”è¡¨è¾¾å¼ä¸º true æ—¶è¿›è¡Œå¾ªç¯</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E5%B8%B8%E7%94%A8%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F-while.gif" alt="å¸¸ç”¨åç¼€è¡¨è¾¾å¼-while" style="zoom:67%;">

<h2 id="3-2-ä»£ç æ¨¡æ¿"><a href="#3-2-ä»£ç æ¨¡æ¿" class="headerlink" title="3.2 ä»£ç æ¨¡æ¿"></a>3.2 ä»£ç æ¨¡æ¿</h2><p><strong>psvm</strong> ï¼šå¿«é€Ÿç”Ÿæˆ<code>main</code>æ–¹æ³•ï¼Œæˆ–è€…ç›´æ¥è¾“å…¥ <strong>main</strong> ä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœå“¦ğŸ˜</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-psvm.gif" alt="ä»£ç æ¨¡æ¿-psvm" style="zoom:67%;">

<p><strong>sout</strong> ï¼šå¿«é€Ÿç”Ÿæˆæ§åˆ¶å°è¾“å‡ºæ‰“å°è¯­å¥</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-sout.gif" alt="ä»£ç æ¨¡æ¿-sout" style="zoom:67%;">

<p><strong>soup</strong> ï¼šå¿«é€Ÿæ‰“å°æ‰€æœ‰å‚æ•°</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-soutp.gif" alt="ä»£ç æ¨¡æ¿-soutp" style="zoom:67%;">

<p><strong>dep</strong> ï¼šmavençš„pomé…ç½®è‡ªåŠ¨è¡¥å…¨dependency</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-dep.gif" alt="ä»£ç æ¨¡æ¿-dep" style="zoom:67%;">

<p><strong>pl</strong> ï¼šmavençš„pomé…ç½®è‡ªåŠ¨è¡¥å…¨plugin</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-pl.gif" alt="ä»£ç æ¨¡æ¿-pl" style="zoom:67%;">

<p><strong>repo</strong> ï¼šmavençš„pomé…ç½®è‡ªåŠ¨è¡¥å…¨repository</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF-repo.gif" alt="ä»£ç æ¨¡æ¿-repo" style="zoom:67%;">

<h1 id="4-ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜"><a href="#4-ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜" class="headerlink" title="4. ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜"></a>4. ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜</h1><blockquote>
<p>åœ¨æ·»åŠ webæ”¯æŒçš„æ—¶å€™webappç›®å½•æ²¡æœ‰å°è“ç‚¹æ€ä¹ˆåŠï¼Ÿ</p>
</blockquote>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/webapp%E7%9B%AE%E5%BD%95%E6%B2%A1%E6%9C%89%E5%B0%8F%E8%93%9D%E7%82%B9.png" alt="webappç›®å½•æ²¡æœ‰å°è“ç‚¹"></p>
<p>1ã€File â€”&gt; Project Structure â€”&gt; Modules â€”&gt; é€‰ä¸­æ²¡æœ‰webæ”¯æŒçš„æ¨¡å—</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E6%B7%BB%E5%8A%A0web%E6%94%AF%E6%8C%81.png" alt="æ·»åŠ webæ”¯æŒ" style="zoom: 67%;">

<p>2ã€é…ç½®web.xmlæ–‡ä»¶å’ŒWebèµ„æºæ–‡ä»¶å¤¹</p>
<p><code>web.xml</code> æ–‡ä»¶çš„ä½ç½®ï¼š\æ¨¡å—å\ <code>src\main\webapp\</code> WEB-INF\web.xml</p>
<p>Web Resource Directory çš„ä½ç½®ï¼š\æ¨¡å—å\src\main\webapp</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E9%85%8D%E7%BD%AEweb.xml%E6%96%87%E4%BB%B6%E5%92%8CWeb%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%A4%B9.png" alt="é…ç½®web.xmlæ–‡ä»¶å’ŒWebèµ„æºæ–‡ä»¶å¤¹" style="zoom:50%;">

<p>3ã€ç„¶åå°±å¯ä»¥çœ‹åˆ°å°è“ç‚¹äº†</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/ToolsIMG/IDEA/%E6%B7%BB%E5%8A%A0web%E6%94%AF%E6%8C%81%E6%88%90%E5%8A%9F.png" alt="æ·»åŠ webæ”¯æŒæˆåŠŸ"></p>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>IDEA</tag>
      </tags>
  </entry>
  <entry>
    <title>æ²¡æœ‰å¯¹è±¡æ€ä¹ˆåŠï¼Ÿâ€”â€”Javaä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•</title>
    <url>/posts/Java-Create-Object-Method/</url>
    <content><![CDATA[<h1 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h1><p>è¿˜åœ¨ä¸ºæ²¡æœ‰å¯¹è±¡è€Œå½·å¾¨å—ï¼ŸğŸ˜§è¿˜åœ¨ä¸ºæ²¡æœ‰å¯¹è±¡è€Œè¿·èŒ«å—ï¼ŸğŸ˜«è¿˜åœ¨ä¸ºæ²¡æœ‰å¯¹è±¡è€Œè‡ªæˆ‘æ€€ç–‘å—ï¼ŸğŸ˜­è¿˜åœ¨æ‹…å¿ƒæ²¡æœ‰å¯¹è±¡æ€ä¹ˆåŠï¼Ÿ</p>
<p>ç®€å•å•Šï¼Œè‡ªå·± <code>new</code> ä¸€ä¸ªå•Šï¼ï¼ä¼—æ‰€å‘¨çŸ¥ï¼Œç¨‹åºå‘˜æ˜¯<del>ä¸éœ€è¦</del>ä¸ç¼ºå¯¹è±¡çš„ï¼Œç‰¹åˆ«æ˜¯ JAVA ç¨‹åºå‘˜ğŸ˜²ã€‚é‚£é™¤äº†ç›´æ¥ä½¿ç”¨ <code>new</code> å…³é”®å­—åˆ›å»ºå¯¹è±¡ï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–æ–¹æ³•åˆ›å»ºå¯¹è±¡å—ï¼Ÿå½“ç„¶æœ‰äº†ã€‚æ¥ä¸‹æ¥å°±ç®€å•ä»‹ç»å‡ ç§åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ã€‚è¿˜æ˜¯å•èº«çš„ç¨‹åºå‘˜ä»¬åˆ«æ€•å•¦ï¼ï¼ğŸ˜œé©¬ä¸Šå°±å¯ä»¥ç²¾å¿ƒæŒ‘é€‰ä¸€ä¸ªè‡ªå·±æ»¡æ„çš„<del>å¯¹è±¡</del>æ–¹æ³•äº†ğŸ‰ğŸ‰ğŸ‰</p>
<p>å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªå¥³æœ‹å‹ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFriendFriend</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨è§£ä½¿ç”¨çš„æ˜¯ Lombok æ¡†æ¶æ³¨è§£ï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘ã€‚</p>
<h1 id="1-new-å…³é”®å­—"><a href="#1-new-å…³é”®å­—" class="headerlink" title="1.  new å…³é”®å­—"></a>1.  new å…³é”®å­—</h1><p>è¿™æ˜¯æœ€å¸¸è§çš„åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼Œé€šè¿‡ <code>new</code> å…³é”®å­—ï¼ŒJava ä¼šåœ¨å †å†…å­˜ä¸­ä¸ºå¯¹è±¡åˆ†é…ç©ºé—´ï¼Œå¹¶è¿”å›æŒ‡å‘è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GirlFriend</span>(<span class="string">&quot;å°è¯—è¯—&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        System.out.println(girl);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend(name=å°è¯—è¯—, age=18)</span><br></pre></td></tr></table></figure>

<h1 id="2-ç±»æ´¾å‘-åå°„"><a href="#2-ç±»æ´¾å‘-åå°„" class="headerlink" title="2.  ç±»æ´¾å‘(åå°„)"></a>2.  ç±»æ´¾å‘(åå°„)</h1><p>Class çš„ <code>getDeclaredConstructor().newInstance()</code> æ–¹æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ›å»ºä¸€ä¸ªç±»çš„æ–°å®ä¾‹ã€‚å®ƒç­‰æ•ˆäºä½¿ç”¨ <code>new</code> æ“ä½œç¬¦ï¼Œä½†æ˜¯è¯­æ³•æ›´åŠ åŠ¨æ€ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend</span> <span class="operator">=</span> GirlFriend.class.getDeclaredConstructor().newInstance();</span><br><span class="line">        girlFriend.setName(<span class="string">&quot;å°è¯—è¯—&quot;</span>);</span><br><span class="line">        girlFriend.setAge(<span class="number">18</span>);</span><br><span class="line">        System.out.println(girlFriend);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend&#123;name=&#x27;å°è¯—è¯—&#x27;, age=18&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-æ„é€ å™¨-åå°„"><a href="#3-æ„é€ å™¨-åå°„" class="headerlink" title="3.  æ„é€ å™¨(åå°„)"></a>3.  æ„é€ å™¨(åå°„)</h1><p>Constructor çš„ <code>newInstance()</code> æ–¹æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ›å»ºä¸€ä¸ªç±»çš„æ–°å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥ä¼ å…¥æ„é€ å‡½æ•°çš„å‚æ•°ã€‚è¿™ç§æ–¹å¼æ¯” Class çš„ <code>newInstance()</code> æ–¹æ³•æ›´åŠ çµæ´»ï¼Œå› ä¸ºå¯ä»¥é€‰æ‹©ä¸åŒçš„æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Constructor&lt;GirlFriend&gt; constructor = GirlFriend.class.getConstructor(String.class, Integer.class);</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;å°è¯—è¯—&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        System.out.println(girlFriend);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend(name=å°è¯—è¯—, age=18)</span><br></pre></td></tr></table></figure>

<h1 id="4-åŠ¨æ€åŠ è½½-åå°„"><a href="#4-åŠ¨æ€åŠ è½½-åå°„" class="headerlink" title="4. åŠ¨æ€åŠ è½½(åå°„)"></a>4. åŠ¨æ€åŠ è½½(åå°„)</h1><p>çŸ¥é“ç±»å…¨è·¯å¾„ï¼Œä½¿ç”¨ <code>Class.forName()</code> è·å–ç±»çš„ <code>Class</code> å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶ <code>newInstance()</code> æ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend</span> <span class="operator">=</span> (GirlFriend) Class.forName(<span class="string">&quot;com.muyoukule.GirlFriend&quot;</span>)</span><br><span class="line">                .getDeclaredConstructor().newInstance();</span><br><span class="line">        girlFriend.setName(<span class="string">&quot;å°è¯—è¯—&quot;</span>);</span><br><span class="line">        girlFriend.setAge(<span class="number">18</span>);</span><br><span class="line">        System.out.println(girlFriend);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend(name=å°è¯—è¯—, age=18)</span><br></pre></td></tr></table></figure>

<h1 id="5-clone-æ–¹æ³•"><a href="#5-clone-æ–¹æ³•" class="headerlink" title="5. clone()æ–¹æ³•"></a>5. clone()æ–¹æ³•</h1><p>å¦‚æœä¸€ä¸ªç±»å®ç°äº† <code>Cloneable</code> æ¥å£å¹¶é‡å†™äº† <code>Object</code> ç±»ä¸­çš„ <code>clone()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è°ƒç”¨å·²æœ‰å¯¹è±¡çš„ <code>clone()</code> æ–¹æ³•æ¥åˆ›å»ºè¯¥å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</p>
<p><strong>PSï¼š<code>clone()</code> æ–¹æ³•é»˜è®¤æ˜¯å—ä¿æŠ¤çš„ï¼Œå¹¶ä¸”å¯èƒ½æŠ›å‡º <code>CloneNotSupportedException</code> å¼‚å¸¸ã€‚</strong>ğŸ˜…</p>
<p>å› æ­¤å¦‚æœè¦åœ¨ç±»å¤–éƒ¨ä½¿ç”¨å®ƒï¼Œé€šå¸¸éœ€è¦å°†å…¶å£°æ˜ä¸ºå…¬å…±çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFriend</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®æƒé™ä¸º publicï¼Œå¹¶ä¸”è¿”å›å€¼å†™ä¸º girl</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> GirlFriend <span class="title function_">clone</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (GirlFriend) <span class="built_in">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AssertionError</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GirlFriend</span>(<span class="string">&quot;å°è¯—è¯—&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend2</span> <span class="operator">=</span> girlFriend1.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;girlFriend1===&gt;&quot;</span> + girlFriend1);</span><br><span class="line">        System.out.println(<span class="string">&quot;girlFriend2===&gt;&quot;</span> + girlFriend2);</span><br><span class="line">        System.out.println(girlFriend1 == girlFriend2); <span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">girlFriend1===&gt;GirlFriend(name=å°è¯—è¯—, age=18)</span><br><span class="line">girlFriend2===&gt;GirlFriend(name=å°è¯—è¯—, age=18)</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<h1 id="6-ååºåˆ—åŒ–"><a href="#6-ååºåˆ—åŒ–" class="headerlink" title="6. ååºåˆ—åŒ–"></a>6. ååºåˆ—åŒ–</h1><p>å¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—åŒ–è¡¨ç¤º(ä¾‹å¦‚ä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªå­—èŠ‚æµ)ï¼Œä½ å¯ä»¥ä½¿ç”¨ååºåˆ—åŒ–æ¥é‡æ–°åˆ›å»ºè¯¥å¯¹è±¡ã€‚è¿™é€šå¸¸é€šè¿‡ <code>ObjectInputStream</code>ç±»å®Œæˆã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFriend</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GirlFriend</span>(<span class="string">&quot;å°è¯—è¯—&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;girlFriend.txt&quot;</span>);</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(Files.newOutputStream(path));</span><br><span class="line">        oos.writeObject(girlFriend1);</span><br><span class="line">        oos.close();</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(Files.newInputStream(path));</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend2</span> <span class="operator">=</span> (GirlFriend) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;girlFriend1===&gt;&quot;</span> + girlFriend1);</span><br><span class="line">        System.out.println(<span class="string">&quot;girlFriend2===&gt;&quot;</span> + girlFriend2);</span><br><span class="line">        System.out.println(girlFriend1 == girlFriend2); <span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">girlFriend1===&gt;GirlFriend(name=å°è¯—è¯—, age=18)</span><br><span class="line">girlFriend2===&gt;GirlFriend(name=å°è¯—è¯—, age=18)</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<h1 id="7-å·¥å‚æ¨¡å¼"><a href="#7-å·¥å‚æ¨¡å¼" class="headerlink" title="7. å·¥å‚æ¨¡å¼"></a>7. å·¥å‚æ¨¡å¼</h1><p>å·¥å‚æ–¹æ³•æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºåˆ›å»ºå¯¹è±¡è€Œä¸ç›´æ¥ä½¿ç”¨ <code>new</code> å…³é”®å­—ã€‚å·¥å‚æ–¹æ³•é€šå¸¸å°è£…äº†å¯¹è±¡çš„åˆ›å»ºé€»è¾‘ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ä¸åŒçš„å‚æ•°è¿”å›ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚</p>
<p>1ã€å®šä¹‰ä¸€ä¸ª Girl æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Girl</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€è®© GirlFriend ç»§æ‰¿ Girlæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFriend</span> <span class="keyword">implements</span> <span class="title class_">Girl</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€åˆ›å»ºä¸€ä¸ª GirlFactory å·¥å‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Girl <span class="title function_">createGirl</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="literal">null</span> || type.trim().length() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Girl</span> <span class="variable">girl</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;GirlFriend&quot;</span>.equals(type)) &#123;</span><br><span class="line">            girl = <span class="keyword">new</span> <span class="title class_">GirlFriend</span>(<span class="string">&quot;å°è¯—è¯—&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Unsupported type: &quot;</span> + type);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> girl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">GirlFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GirlFactory</span>();</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend</span> <span class="operator">=</span> (GirlFriend) factory.createGirl(<span class="string">&quot;GirlFriend&quot;</span>);</span><br><span class="line">        System.out.println(girlFriend);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend(name=å°è¯—è¯—, age=18)</span><br></pre></td></tr></table></figure>

<h1 id="8-Builderæ¨¡å¼"><a href="#8-Builderæ¨¡å¼" class="headerlink" title="8. Builderæ¨¡å¼"></a>8. Builderæ¨¡å¼</h1><p>Builder æ¨¡å¼ç”¨äºåˆ›å»ºå¤æ‚çš„å¯¹è±¡ï¼Œå…è®¸ç”¨æˆ·ä»¥ä¸åŒçš„æ–¹å¼æ„å»ºå¯¹è±¡ã€‚å®ƒé€šå¸¸æ¶‰åŠåˆ°ä¸€ä¸ª <code>Builder</code> ç±»ï¼Œè¯¥ç±»åŒ…å«äº†ä¸€ç³»åˆ—è®¾ç½®å¯¹è±¡å±æ€§çš„æ–¹æ³•ï¼Œå¹¶æœ€ç»ˆè¿”å›ä¸€ä¸ªæ„å»ºå¥½çš„å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GirlFriend</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GirlFriend</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = builder.name;</span><br><span class="line">        <span class="built_in">this</span>.age = builder.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">withName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">withAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> GirlFriend <span class="title function_">build</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GirlFriend</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">GirlFriend</span> <span class="variable">girlFriend</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GirlFriend</span>.Builder()</span><br><span class="line">                .withName(<span class="string">&quot;å°è¯—è¯—&quot;</span>)</span><br><span class="line">                .withAge(<span class="number">18</span>)</span><br><span class="line">                .build();</span><br><span class="line">        System.out.println(girlFriend);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GirlFriend(name=å°è¯—è¯—, age=18)</span><br></pre></td></tr></table></figure>

<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ²¡æœ‰å¯¹è±¡ä¸è¦å½·å¾¨ã€ä¸è¦è¿·èŒ«ã€ä¸è¦è‡ªæˆ‘æ€€ç–‘ã€‚åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­ç²¾å¿ƒæŒ‘é€‰ä¸€ä¸ªè‡ªå·±æ»¡æ„çš„æ–¹æ³•å»é€ å¯¹è±¡å§ï¼ï¼ğŸ˜Š</p>
<p>è®°ä½ï¼Œæ²¡æœ‰å¯¹è±¡å°±è‡ªå·±zaoï¼Œä»¥ååˆ«å†è¯´è‡ªå·±æ²¡å¯¹è±¡äº†ï¼ŒJava ç¨‹åºå‘˜ä»ä¸è¯´è‡ªå·±æ²¡å¯¹è±¡ï¼ï¼ï¼</p>
<p>ä»°èµ·å•èº«ğŸ¶é«˜è´µçš„å¤´é¢…ğŸ˜¬ï¼ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ­¥éª¤é›¶ã€‘å®éªŒç¯å¢ƒå‡†å¤‡</title>
    <url>/posts/BigData-Case-Volume-Zero/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç®€ä»‹ï¼šæœ¬æ–‡ç« åŸºäºå¦é—¨å¤§å­¦æä¾›çš„<a href="https://dblab.xmu.edu.cn/post/7499/">å¤§æ•°æ®è¯¾ç¨‹å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</a>ï¼Œé€šè¿‡ä½¿ç”¨ CentOS æ“ä½œç¼–å†™è€Œæ¥ã€‚å…·ä½“ä»‹ç»è¯·æ‰“å¼€é“¾æ¥è¿›è¡Œé˜…è¯»ã€‚</p>
<p><font color="red">è¿™é‡Œä»‹ç»å‡ ç‚¹å€¼å¾—ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ï¼š</font></p>
<p>1ã€å¯¹äºæ¡ˆä¾‹æ‰€æ¶‰åŠçš„ç³»ç»ŸåŠè½¯ä»¶æ­¤æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ç‰ˆæœ¬ï¼Œå…¶ä»–è½¯ä»¶ç‰ˆæœ¬éšæ„ï¼š</p>
<ul>
<li>Linuxç³»ç»Ÿï¼ˆCentOS7ï¼‰</li>
<li>MySQLï¼ˆ5.7ï¼‰</li>
<li>Hadoopï¼ˆ3.1.3ï¼‰</li>
<li>HBaseï¼ˆ2.2.2ï¼ŒHBaseç‰ˆæœ¬éœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Hiveï¼ˆ3.1.2ï¼ŒHiveéœ€è¦å’ŒHadoopç‰ˆæœ¬å…¼å®¹ï¼‰</li>
<li>Sqoopï¼ˆ1.4.7ï¼‰</li>
<li>Rï¼ˆ3.6.0ï¼‰</li>
<li>IDEAï¼ˆ 2023.3.6 ç¤¾åŒºç‰ˆï¼‰</li>
</ul>
<p><font color="red"><strong>PSï¼šHadoop ä¸ HBaseã€Hive ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼ç‰ˆæœ¬ä¸€å®šè¦å…¼å®¹ï¼ï¼ï¼è¿™å¾ˆé‡è¦ï¼ï¼ï¼</strong></font>ğŸ˜ƒğŸ˜ƒğŸ˜ƒå…¶ä»–è½¯ä»¶éšæ„ã€‚</p>
<p>2ã€æœ¬æ–‡ç« æ‰€æœ‰<strong>ä¸‹è½½</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/</code> ç›®å½•ä¸‹ã€‚æ‰€æœ‰<strong>å®‰è£…</strong>çš„æ‰€æœ‰è½¯ä»¶å‡åœ¨ <code>/usr/local/</code> ç›®å½•ä¸‹ä»¥ <code>è½¯ä»¶å-ç‰ˆæœ¬å·</code> æ–¹å¼å‘½åã€‚åœ¨è¿›è¡Œæ¯ä¸ªè½¯ä»¶çš„å®‰è£…æ“ä½œä¹‹å‰è¯·å…ˆ<strong>æ•´ä½“é˜…è¯»</strong>æ•´ä¸ªè½¯ä»¶å®‰è£…æµç¨‹çš„æ–‡ç« æœ‰ä¸ªæ•´ä½“æ€è·¯ï¼Œ<strong>äº†è§£åˆ°å®‰è£…æ­¤è½¯ä»¶éœ€è¦åšå“ªäº›è®¾ç½®å†è¿›è¡Œæ“ä½œ</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p>3ã€<font color="red"><strong>æ­¤æ¡ˆä¾‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼Œè¯·æŒ‰ç…§æ­¥éª¤é¡ºåºè¿›è¡Œé˜…è¯»ï¼ï¼</strong>ğŸ™‚ğŸ™‚</font></p>
<h1 id="1-å®‰è£…-Linux-ç³»ç»Ÿ"><a href="#1-å®‰è£…-Linux-ç³»ç»Ÿ" class="headerlink" title="1. å®‰è£… Linux ç³»ç»Ÿ"></a>1. å®‰è£… Linux ç³»ç»Ÿ</h1><h2 id="1-1-Linux-çš„é€‰æ‹©"><a href="#1-1-Linux-çš„é€‰æ‹©" class="headerlink" title="1.1 Linux çš„é€‰æ‹©"></a>1.1 Linux çš„é€‰æ‹©</h2><p>åœ¨ Linux ç³»ç»Ÿå„ä¸ªå‘è¡Œç‰ˆä¸­ï¼ŒCentOS ç³»ç»Ÿå’Œ Ubuntu ç³»ç»Ÿåœ¨æœåŠ¡ç«¯å’Œæ¡Œé¢ç«¯ä½¿ç”¨å æ¯”æœ€é«˜ï¼Œé€‰æ‹© Ubuntu è¿˜æ˜¯ CentOS ä¸»è¦å–å†³äºä½ çš„å…·ä½“éœ€æ±‚å’Œä½¿ç”¨åœºæ™¯ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>CentOS æ›´é€‚åˆç”¨äºä¼ä¸šçº§æœåŠ¡å™¨ç¯å¢ƒï¼Œç‰¹åˆ«æ˜¯é‚£äº›éœ€è¦é•¿æ—¶é—´è¿è¡Œå’Œå¤§é‡æ•°æ®å¤„ç†çš„åœºæ™¯ã€‚å®ƒå±äºRed Hat Enterprise Linux(RHEL)çš„ç¤¾åŒºç‰ˆæœ¬ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ä¼ä¸šçº§ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</li>
<li>Ubuntu åˆ™æ›´æ³¨é‡ç”¨æˆ·å‹å¥½å’Œæ˜“ç”¨æ€§ï¼Œå› æ­¤æ›´é€‚åˆä¸ªäººç”µè„‘å’Œæ¡Œé¢åº”ç”¨ã€‚å®ƒä¹Ÿå¸¸ç”¨äºå­¦ä¹ å’Œæ¢ç´¢ Linux çš„åˆå­¦è€…ã€‚</li>
</ul>
<p><strong>ç¨³å®šæ€§</strong>ï¼š</p>
<ul>
<li>CentOS ä»¥å…¶ç¨³å®šæ€§è‘—ç§°ã€‚å®ƒç»è¿‡é•¿æ—¶é—´çš„æµ‹è¯•ï¼Œåªæœ‰ç»è¿‡éªŒè¯çš„ç¨³å®šç‰ˆæœ¬æ‰ä¼šè¢«å‘å¸ƒï¼Œå› æ­¤æ›´åŠ å®‰å…¨ç¨³å®šã€‚</li>
<li>Ubuntu çš„ LTS(é•¿æœŸæ”¯æŒ)ç‰ˆæœ¬ä¹Ÿéå¸¸ç¨³å®šï¼Œæä¾›é•¿è¾¾äº”å¹´çš„ç»´æŠ¤å’Œæ”¯æŒã€‚ç„¶è€Œï¼Œå…¶å‡çº§åŒ…æœ‰æ—¶å¯èƒ½ä¼šé€ æˆç³»ç»Ÿçš„ä¸ç¨³å®šå’Œä¸å®‰å…¨ã€‚</li>
</ul>
<p><strong>ä½¿ç”¨éš¾åº¦å’Œç•Œé¢</strong>ï¼š</p>
<ul>
<li>Ubuntu å¯¹æ–°æ‰‹æ›´ä¸ºå‹å¥½ï¼Œå®ƒæ‹¥æœ‰å¤§é‡çš„å¸®åŠ©æ–‡æ¡£å’Œæ•™ç¨‹ï¼Œç”¨æˆ·ç•Œé¢ä¹Ÿæ›´åŠ å‹å¥½ï¼Œé€‚åˆä¸ç†Ÿæ‚‰ Linux çš„ç”¨æˆ·ã€‚</li>
<li>CentOS åˆ™ç›¸å¯¹è¾ƒéš¾ä¸Šæ‰‹ï¼Œç‰¹åˆ«æ˜¯å¯¹æ–°ç”¨æˆ·æ¥è¯´ã€‚å®ƒçš„ç•Œé¢è®¾è®¡æ›´åŠ ç®€æ´ï¼Œä¾§é‡äºç¨³å®šæ€§å’Œå®‰å…¨æ€§ã€‚</li>
</ul>
<p><strong>è½¯ä»¶åŒ…å’Œå…¼å®¹æ€§</strong>ï¼š</p>
<ul>
<li>CentOS æ‹¥æœ‰åºå¤§çš„è½¯ä»¶åŒ…åº“ï¼Œæä¾›äº†å¤§é‡çš„å¼€æºè½¯ä»¶ã€‚</li>
<li>Ubuntu åˆ™ä¸ Canonical å…¬å¸ä»¥åŠå…¶ä»–è½¯ä»¶ä¾›åº”å•†æœ‰è‰¯å¥½çš„å…¼å®¹æ€§ï¼Œå¯¹äºä¸€äº›å•†ä¸šè½¯ä»¶çš„æ”¯æŒä¹Ÿæ›´å¥½ã€‚</li>
</ul>
<p><strong>ç¤¾åŒºæ”¯æŒ</strong>ï¼š</p>
<ul>
<li>Ubuntu ç”±äºå…¶å•†ä¸šæ”¯æŒè€…å’Œæ›´å¤§çš„ç¤¾åŒºï¼Œå¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹èƒ½æä¾›æ›´å¤šçš„å¸®åŠ©ã€‚</li>
<li>CentOS è™½ç„¶ä¹Ÿæœ‰ç¤¾åŒºæ”¯æŒï¼Œä½†å¯èƒ½ä¸å¦‚ Ubuntu çš„ç¤¾åŒºé‚£ä¹ˆæ´»è·ƒå’Œå¹¿æ³›ã€‚</li>
</ul>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªç¨³å®šä¸”é€‚ç”¨äºä¼ä¸šçº§æœåŠ¡å™¨ç¯å¢ƒçš„ç³»ç»Ÿï¼ŒCentOS å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚è€Œå¦‚æœä½ <font color="red">æ›´æ³¨é‡æ˜“ç”¨æ€§å’Œå‹å¥½çš„ç”¨æˆ·ç•Œé¢</font>ï¼Œæˆ–è€…ä½ æ˜¯ä¸€ä¸ª Linux åˆå­¦è€…ï¼Œé‚£ä¹ˆ Ubuntu å¯èƒ½æ›´é€‚åˆä½ ã€‚è¿™åªæ˜¯ä¸€ä¸ªå¤§è‡´çš„æŒ‡å¯¼ï¼Œå…·ä½“é€‰æ‹©è¿˜éœ€è¦æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚å’Œä½¿ç”¨åœºæ™¯è¿›è¡Œæƒè¡¡ã€‚</p>
<p><font color="red"><strong>PSï¼šæœ¬æ•™ç¨‹é€‰æ‹©çš„æ˜¯ CentOS7 ç‰ˆæœ¬ï¼ï¼ï¼</strong></font>ğŸ˜€ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å®‰è£… CentOS7 å§ï¼</p>
<h2 id="1-2-CentOS7-ä¸‹è½½åœ°å€"><a href="#1-2-CentOS7-ä¸‹è½½åœ°å€" class="headerlink" title="1.2 CentOS7 ä¸‹è½½åœ°å€"></a>1.2 CentOS7 ä¸‹è½½åœ°å€</h2><p><a href="https://vault.centos.org/7.6.1810/isos/x86_64/">å®˜ç½‘ä¸‹è½½</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/CentOS%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(1).png" style="zoom: 33%;">

<p>ç‚¹è¿›å»ä¹‹åä¾æ¬¡ç‚¹å‡» <code>isos/</code> â€“&gt; <code>x86_64/</code> ï¼Œæ‰¾åˆ°ä¸‹é¢æ–‡ä»¶è¿›è¡Œä¸‹è½½</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/CentOS%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(2).png" style="zoom: 33%;">

<p><a href="https://mirrors.aliyun.com/centos/7/isos/x86_64/?spm=a2c6h.25603864.0.0.62464511sV8QoX">é˜¿é‡Œé•œåƒç«™</a>ï¼šä¸ä¸Šé¢ç‰ˆæœ¬æœ‰äº›å°å·®å¼‚ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ã€‚éƒ½æ˜¯CentOS7ğŸ˜‰)</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/CentOS%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BD.png" style="zoom: 50%;">

<p>æ‰“å¼€ç½‘ç«™åä¸‹è½½å¯¹åº”çš„ <code>ios</code> æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p>
<h2 id="1-3-CentOS7-ç³»ç»Ÿå®‰è£…"><a href="#1-3-CentOS7-ç³»ç»Ÿå®‰è£…" class="headerlink" title="1.3 CentOS7 ç³»ç»Ÿå®‰è£…"></a>1.3 CentOS7 ç³»ç»Ÿå®‰è£…</h2><p>Linux ç³»ç»Ÿçš„å®‰è£…ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šè™šæ‹Ÿæœºå®‰è£…å’ŒåŒç³»ç»Ÿå®‰è£…ã€‚</p>
<p>è™šæ‹Ÿæœºå®‰è£…å’Œä½¿ç”¨ Linux çš„ç¡¬ä»¶é…ç½®æ¯”è¾ƒé«˜ï¼Œ<del>å»ºè®®</del><font color="red">è¦æ±‚</font>ç”µè„‘è‡³å°‘æœ‰<strong>8G</strong>è¿è¡Œå†…å­˜ä¸”å‰©ä½™çš„å­˜å‚¨å®¹é‡<strong>è¶³å¤Ÿå¤§</strong>ã€‚ç”µè„‘è¾ƒæ—§æˆ–è¿è¡Œå†…å­˜å°äºç­‰äº 4G çš„ç”µè„‘å¼ºçƒˆå»ºè®®é€‰æ‹©åŒç³»ç»Ÿå®‰è£…ã€‚å¦åˆ™ï¼Œåœ¨é…ç½®è¾ƒä½çš„ç”µè„‘ä¸Šè¿è¡Œ Linux è™šæ‹Ÿæœºï¼Œ<del>ç³»ç»Ÿè¿è¡Œé€Ÿåº¦ä¼šéå¸¸æ…¢</del><font color="red">ç”µè„‘ä¼šå¡æ­»</font>ğŸ˜“ã€‚</p>
<p>ä»€ä¹ˆæ˜¯è¿è¡Œå†…å­˜å’Œå­˜å‚¨å®¹é‡ï¼Ÿ</p>
<p>é€šä¿—çš„è¯´ï¼Œè¿è¡Œå†…å­˜å†³å®šäº†åŒæ—¶è¿è¡Œçš„ç¨‹åºå¤šå°‘ï¼Œå­˜å‚¨ç©ºé—´å†³å®šäº†èƒ½è£…æ–‡ä»¶çš„å¤šå°‘ã€‚å£è¯­ä¸­ä¹ æƒ¯ä¸Šç”¨è¿è¡Œå†…å­˜ï¼‹å­˜å‚¨ç©ºé—´ç®€å•æè¿°è®¾å¤‡ä¸»è¦æŒ‡æ ‡ã€‚</p>
<p>å¦‚ä½•æŸ¥çœ‹ç”µè„‘è¿è¡Œå†…å­˜å’Œå­˜å‚¨å®¹é‡ï¼Ÿ</p>
<ul>
<li><p>è¿è¡Œå†…å­˜ï¼š</p>
<p>åŒå‡» <code>æ­¤ç”µè„‘</code> æ‰“å¼€å¦‚ä¸‹ç•Œé¢ï¼Œç„¶ååœ¨ç©ºç™½å¤„å³é”®ï¼Œç‚¹å‡» <code>å±æ€§</code>ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8B%E7%94%B5%E8%84%91%E8%BF%90%E8%A1%8C%E5%86%85%E5%AD%98.png" style="zoom: 67%;">

<p>ç„¶åä¼šå‡ºç°è¿™ä¸ªç•Œé¢ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„ <code>RAM</code> å°±æ˜¯ç”µè„‘çš„è¿è¡Œå†…å­˜äº†ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%94%B5%E8%84%91%E8%BF%90%E8%A1%8C%E5%86%85%E5%AD%98.png" style="zoom: 67%;">
</li>
<li><p>å­˜å‚¨å®¹é‡ï¼š</p>
<p>ç®€å•çš„æ¥è¯´å°±æ˜¯ä½ ç”µè„‘æ‰€æœ‰ç›˜ç¬¦çš„å¤§å°ï¼ŒåŒå‡» <code>æ­¤ç”µè„‘</code> å°±å¯ä»¥çœ‹åˆ°è‡ªå·±ç”µè„‘æ‰€æœ‰ç›˜ç¬¦çš„ä¿¡æ¯ã€‚</p>
</li>
</ul>
<p>ç”±äºæˆ‘çš„ç”µè„‘æ˜¯<strong>16G + 512G</strong> ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä½¿ç”¨<strong>è™šæ‹Ÿæœºå®‰è£…</strong>ã€‚</p>
<blockquote>
<p>è™šæ‹Ÿæœº VMware å®‰è£…</p>
</blockquote>
<p><a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">å®˜ç½‘ä¸‹è½½</a></p>
<p>ç‚¹å¼€åé¼ æ ‡å‘ä¸‹æ»‘ï¼Œç‚¹å‡» <code>VMware Workstation 17 Pro</code> æ ä¸‹çš„ <code>DOWNLOAD NOW</code> ä¹‹åå¼€å§‹ä¸‹è½½ VMwareã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/VMware%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD.png" style="zoom: 50%;">

<p>å®‰è£…æ—¶ä½¿ç”¨ <font color="red">â€œå‚»ç“œå¼â€</font> å®‰è£…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥å³å¯ã€‚<font color="red">PSï¼šæ³¨æ„æŒ‰è‡ªå·±éœ€æ±‚ä¿®æ”¹å®‰è£…è·¯å¾„ï¼</font>ğŸ˜</p>
<p>å®‰è£…å®Œåéœ€è¦äº§å“è®¸å¯è¯æ¿€æ´»è½¯ä»¶ï¼Œå¤§å®¶å¯ä»¥åœ¨ç½‘ä¸Šè‡ªè¡Œæœç´¢ã€‚</p>
<p>å®‰è£…æˆåŠŸåï¼Œ<code>Win + i</code> æ‰“å¼€ <code>Windows</code> è®¾ç½®æ‰¾åˆ° <code>ç½‘ç»œå’Œ Internet</code>ï¼Œç‚¹å‡» <code>é«˜çº§ç½‘ç»œè®¾ç½®</code> é‡Œçš„ <code>æ›´æ”¹è®¾é…å™¨é€‰é¡¹</code>ï¼Œå‡ºç°äº†ä¸‹é¢ä¸¤ä¸ª<strong>ç½‘ç»œé€‚é…å™¨</strong>åˆ™è¯´æ˜å®‰è£…æˆåŠŸäº†ã€‚å¦‚æœæ²¡æœ‰å‡ºç°å°±è¯´æ˜ç½‘ç»œé€‚é…å™¨æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œé‚£å¯èƒ½å°±è¦é‡è£… VMware å’¯ğŸ˜£ã€‚<font color="red">PSï¼šé‡è£…ä¹‹å‰è®°å¾—å°†ä»¥å‰å®‰è£…çš„ VMware åˆ é™¤å¹²å‡€ ï¼ï¼ï¼ï¼ï¼</font>ğŸ˜‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%BD%91%E7%BB%9C%E9%80%82%E9%85%8D%E5%99%A8.png" style="zoom: 67%;">

<blockquote>
<p>åœ¨ Windows ä½¿ç”¨ VMware å®‰è£… CentOS7</p>
</blockquote>
<p>1ã€æ‰“å¼€ VMware ç‚¹å‡» åˆ›å»ºæ–°çš„è™šæ‹Ÿæœº ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(1).png" style="zoom: 50%;">

<p>2ã€é€‰æ‹© è‡ªå®šä¹‰(é«˜çº§)ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<p>å…¸å‹å®‰è£…ï¼šVMware ä¼šå°†ä¸»æµçš„é…ç½®åº”ç”¨åœ¨è™šæ‹Ÿæœºçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œå¯¹äºæ–°æ‰‹æ¥å¾ˆå‹å¥½ã€‚</p>
<p>è‡ªå®šä¹‰å®‰è£…ï¼šè‡ªå®šä¹‰å®‰è£…å¯ä»¥é’ˆå¯¹æ€§çš„æŠŠä¸€äº›èµ„æºåŠ å¼ºï¼ŒæŠŠä¸éœ€è¦çš„èµ„æºç§»é™¤ã€‚é¿å…èµ„æºçš„æµªè´¹ã€‚</p>
<p>è¿™é‡Œæˆ‘é€‰æ‹©<strong>è‡ªå®šä¹‰å®‰è£…</strong>ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(2).png" style="zoom: 67%;">

<p>3ã€è¿ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥æ¥åˆ°è¿™ä¸ªç•Œé¢ï¼Œæ‰¾åˆ°æ‹© <code>iso</code> æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(3).png" style="zoom:67%;">

<p>4ã€è®¾ç½® Linux åç§°ã€ç”¨æˆ·åã€å¯†ç ï¼Œè®¾ç½®å®Œæˆç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<p>å¯†ç å»ºè®®å°½é‡ç®€å•ä¸€äº›ï¼Œæˆ‘è¿™é‡Œè®¾ç½®çš„æ˜¯ <code>123456</code> ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(4).png" style="zoom: 67%;">

<p>5ã€è®¾ç½®è™šæ‹Ÿæœºåç§°å’Œä½ç½®ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<p>è™šæ‹Ÿæœºå®‰è£…å®Œæˆåæ‰€åœ¨çš„ç›®å½•ï¼Œå»ºè®®æ”¾åœ¨ C ç›˜ä»¥å¤–çš„ç›˜ç¬¦ã€‚</p>
<p>æˆ‘è¿™é‡Œè®¾ç½®æˆ C ç›˜ä»…ä»…æ˜¯æ•™å­¦éœ€è¦ï¼Œå› ä¸ºæˆ‘ç”µè„‘å…¶ä»–ç›˜ç¬¦å·²ç» <font color="red">çº¢</font> äº†ã€‚ğŸ˜­ğŸ˜­ğŸ˜­</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(5).png" style="zoom:67%;">

<p>6ã€é€‰æ‹©å¤„ç†å™¨æ•°é‡ä»¥åŠæ¯ä¸ªå¤„ç†å™¨çš„å†…æ ¸æ•°é‡(ä¸¤è€…ä¹˜ç§¯ä¸èƒ½è¶…è¿‡æœ¬æœºçš„CPUå†…æ ¸æ•°)ï¼Œæˆ‘è¿™é‡Œéƒ½è®¾ç½®æˆ <code>2</code> ï¼Œå¤§å®¶éšæ„ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(6).png" style="zoom:67%;">

<p>7ã€é€‰æ‹©å†…å­˜å¤§å°(æ ¹æ®æœ¬æœºå†…å­˜å¤§å°é€‚å½“é€‰æ‹©ï¼Œå»ºè®®ä¸è¦é€‰æ‹©è¶…è¿‡æœ¬æœºä¸€åŠçš„å†…å­˜ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯ 16Gï¼Œæ‰€ä»¥æˆ‘é€‰æ‹© 4G å†…å­˜)ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(7).png" style="zoom: 67%;">

<p>8ã€è¿ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥æ¥åˆ°è¿™ä¸ªç•Œé¢ï¼Œé€‰æ‹©ç£ç›˜å¤§å°(æ ¹æ®æœ¬æœºå¤§å°è‡ªå·±å®šï¼Œå»ºè®®æœ¬æœºç£ç›˜å……è£•çš„æƒ…å†µä¸‹è¶Šå¤§è¶Šå¥½ï¼Œæˆ‘è¿™é‡Œé€‰æ‹© 40G )ï¼Œå°†è™šæ‹Ÿæœºç£ç›˜æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(8).png" style="zoom:67%;">

<p>9ã€è¿ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥æ¥åˆ°è¿™ä¸ªç•Œé¢ï¼Œæ ¸å¯¹ä¿¡æ¯æ— è¯¯åç‚¹å‡» å®Œæˆ å³å¯ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85CentOS7(9).png" style="zoom:67%;">

<p>è‡³æ­¤ CentOS7 çš„å®‰è£…å°±ç»“æŸå•¦ï¼ç°åœ¨åªéœ€è¦ç­‰å¾…è™šæ‹Ÿæœºå¼€æœºå³å¯ã€‚<strong>PSï¼šè™šæ‹Ÿæœºç¬¬ä¸€æ¬¡å¼€æœºè¾ƒä¹…ï¼Œå¤§å®¶éœ€è¦è€å¿ƒç­‰å¾…å“¦ã€‚</strong>ğŸ˜Š</p>
<p>åŠ è½½å®Œæˆåä¼šå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%BC%80%E6%9C%BA%E7%95%8C%E9%9D%A2.png" style="zoom: 50%;">

<p>åªéœ€è¦ç‚¹å‡»ä¸€ä¸‹ç”¨æˆ·ç„¶åè¾“å…¥å¯†ç ï¼Œå†ç‚¹å‡» <code>Sign In</code> å³å¯è¿›å…¥è™šæ‹Ÿæœºä¸»ç•Œé¢(ç¬¬ä¸€æ¬¡å¼€æœºç³»ç»Ÿä¼šå¼¹å‡ºæç¤ºï¼Œç›´æ¥ç‚¹å‡»å³ä¸Šè§’ â€œXâ€ æ‰å³å¯)ï¼Œè¿™å°±æˆåŠŸè¿›å…¥è™šæ‹Ÿæœºäº†ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%BB%E7%95%8C%E9%9D%A2.png" style="zoom: 50%;">

<p>è‡³æ­¤ Linux ç³»ç»Ÿå·²ç»æˆåŠŸå®‰è£…å¥½å•¦ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<p><strong>å¦‚ä½•æŸ¥çœ‹è‡ªå·±è™šæ‹Ÿæœºçš„ ip åœ°å€ï¼Ÿ</strong></p>
<p>æ¡Œé¢ç©ºç™½å¤„å³é”®ç‚¹å‡» <code>Open Terminal</code> æ‰“å¼€ Terminal ï¼Œè¾“å…¥ <code>ifconfig</code> ååœ¨ ens33 ä¸‹çœ‹åˆ°çš„è¿™ä¸ªå°±æ˜¯è™šæ‹Ÿæœºçš„ ip åœ°å€ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%99%9A%E6%8B%9F%E6%9C%BAip%E5%9C%B0%E5%9D%80.png" style="zoom:50%;">

<h1 id="è¿œç¨‹è¿æ¥å·¥å…·"><a href="#è¿œç¨‹è¿æ¥å·¥å…·" class="headerlink" title="è¿œç¨‹è¿æ¥å·¥å…·"></a>è¿œç¨‹è¿æ¥å·¥å…·</h1><p>æˆ‘ä»¬ä½¿ç”¨ VMware å¯ä»¥å¾—åˆ° Linux è™šæ‹Ÿæœºï¼Œä½†æ˜¯åœ¨ VMware ä¸­æ“ä½œ Linux çš„å‘½ä»¤è¡Œé¡µé¢ä¸å¤ªæ–¹ä¾¿ï¼Œä¸»è¦æ˜¯ï¼š<del>å’ŒLinuxç³»ç»Ÿçš„å„ç±»äº¤äº’ï¼Œè·¨è¶Š VMware ä¸æ–¹ä¾¿</del>ç•Œé¢ä¸å¥½çœ‹ã€‚ğŸ˜</p>
<p>è¿™é‡Œä»‹ç»çš„æ˜¯ FinalShell ï¼Œæˆ‘ä¸ºä»€ä¹ˆé€‰æ‹© FinalShell å‘¢ï¼Ÿä¸»è¦æ˜¯ FinalShell <del>æ˜¯å›½äº§SSHå·¥å…·(çº¯ä¸­æ–‡)</del>æˆ‘ç”¨ä¹ æƒ¯äº†è€Œå·²ğŸ˜ï¼Œå½“ç„¶å¸‚é¢ä¸Šä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–çš„è¿œç¨‹è¿æ¥å·¥å…·ï¼Œä½ å¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚ğŸ¤”</p>
<h2 id="FinalShell-ä¸‹è½½å®‰è£…"><a href="#FinalShell-ä¸‹è½½å®‰è£…" class="headerlink" title="FinalShell ä¸‹è½½å®‰è£…"></a>FinalShell ä¸‹è½½å®‰è£…</h2><p><a href="https://www.hostbuf.com/t/988.html">ä¸‹è½½å®˜ç½‘</a>ï¼Œç‚¹è¿›å»é€‰æ‹©ç›¸åº”çš„ç‰ˆæœ¬å³å¯ã€‚</p>
<p>å®‰è£…ï¼šå®‰è£…ï¼Ÿå®‰è£…æ—¶ä½¿ç”¨ <font color="red">â€œå‚»ç“œå¼â€</font> å®‰è£…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥å³å¯ã€‚<font color="red">PSï¼šæ³¨æ„æŒ‰è‡ªå·±éœ€æ±‚ä¿®æ”¹å®‰è£…è·¯å¾„ï¼</font>ğŸ˜</p>
<h2 id="FinalShell-ä½¿ç”¨"><a href="#FinalShell-ä½¿ç”¨" class="headerlink" title="FinalShell ä½¿ç”¨"></a>FinalShell ä½¿ç”¨</h2><blockquote>
<p>FinalShell æ–°å»ºè¿æ¥</p>
</blockquote>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%96%B0%E5%BB%BA%E8%BF%9E%E6%8E%A5(1).png" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%96%B0%E5%BB%BA%E8%BF%9E%E6%8E%A5(2).png" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%96%B0%E5%BB%BA%E8%BF%9E%E6%8E%A5(3).png" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%96%B0%E5%BB%BA%E8%BF%9E%E6%8E%A5(4).png" style="zoom: 50%;">

<blockquote>
<p>FinalShell æ–‡ä»¶ä¸Šä¼ </p>
</blockquote>
<p>åœ¨å®‰è£…å„ç§è½¯ä»¶çš„æ—¶å€™ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½æ˜¯å°†è½¯ä»¶åœ¨æœ¬æœºä¸‹è½½å¥½ç„¶åå†ä¸Šä¼ åˆ° Linux ç³»ç»Ÿè¿›è¡Œå®‰è£…ï¼Œé‚£ä¹ˆæ€æ ·å°†æœ¬æœºä¸‹è½½çš„è½¯ä»¶ä¸Šä¼ åˆ° Linux å‘¢ï¼Ÿ</p>
<p>ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>å‘½ä»¤ä¸Šä¼ (éœ€è¦ <code>sudo yum -y install lrzsz</code> å®‰è£…)</li>
<li>ç›´æ¥æ‹–åŠ¨æ–‡ä»¶(éœ€è¦åˆ‡æ¢ root ç”¨æˆ·è¿æ¥ Linux)</li>
</ul>
<p><strong>ç¬¬ä¸€ç§ï¼šå‘½ä»¤ä¸Šä¼ </strong></p>
<p><font color="red">PSï¼šåœ¨ä¸Šä¼ æ–‡ä»¶ä¹‹å‰è¯·å‰ç”¨ <code>cd</code> å‘½ä»¤åˆ‡æ¢åˆ°æ–‡ä»¶è¦ä¸Šä¼ çš„ç›®å½•ã€‚</font>ğŸ˜Š</p>
<p>æ‰§è¡Œ <code>sudo rz</code> å‘½ä»¤åä¼šå¼¹å‡ºä»¥ä¸‹ç•Œé¢(ç¬¬ä¸€æ¬¡ä½¿ç”¨éœ€è¦ <code>sudo yum -y install lrzsz</code> å®‰è£…ä¸€ä¸‹)ï¼Œé€‰æ‹©ä¸‹è½½çš„æ–‡ä»¶åç‚¹å‡»ç¡®å®š(æˆ–è€…ç›´æ¥åŒå‡»æ–‡ä»¶)</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E5%91%BD%E4%BB%A4%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6(1).png" style="zoom:67%;">

<p>ç­‰å¾…ä¸Šä¼ è¿›åº¦ 100% å³å¯</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E5%91%BD%E4%BB%A4%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6(2).png" style="zoom: 50%;">

<p>ä¸Šä¼ å®Œæˆåå¯ä»¥é€šè¿‡ <code>ll</code> å‘½ä»¤æŸ¥çœ‹ï¼Œåœ¨ç›®å½•ä¸‹å‡ºç°äº†å¯¹åº”å®‰è£…åŒ…ï¼Œåˆ™ä¸Šä¼ æˆåŠŸ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F.png" style="zoom: 50%;">

<p><strong>ç¬¬äºŒç§ï¼šç›´æ¥æ‹–åŠ¨æ–‡ä»¶</strong></p>
<p><font color="red">PSï¼šä½¿ç”¨è¿™ç§æ–¹å¼ä¸€å®šè¦ç”¨ root ç”¨æˆ·è¿æ¥Linuxï¼Œæ™®é€šç”¨æˆ·ä¼šä¸Šä¼ å¤±è´¥</font>ğŸ˜Š</p>
<p>æ€ä¹ˆåˆ‡æ¢ç”¨æˆ·ï¼Ÿ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E5%88%87%E6%8D%A2%E7%94%A8%E6%88%B7.png" style="zoom: 50%;">

<p>åˆ‡æ¢ç”¨æˆ·åç‚¹å‡» FinalShell å³ä¸‹è§’ç®­å¤´</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%8B%96%E5%8A%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(1).png" style="zoom:50%;">

<p>ç„¶åç‚¹å‡»é€‰æ‹©æ–‡ä»¶è¦ä¸Šä¼ åˆ°çš„ç›®å½•ï¼Œåœ¨ Windows ä¸­ç›´æ¥å°†æ–‡ä»¶æ‹–åˆ°æ­¤ç›®å½•å³å¯</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%8B%96%E5%8A%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(2).png" style="zoom:50%;">

<p>ä¹‹åå°±å¯ä»¥é€šè¿‡å›¾å½¢åŒ–ç•Œé¢åœ¨ç›®å½•ä¸­çœ‹åˆ°åˆšåˆšä¸Šä¼ çš„æ–‡ä»¶äº†</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/FinalShell%E6%8B%96%E5%8A%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(3).png" style="zoom:50%;">

<p><font color="red">PSï¼šä¸Šä¼ å®Œä¹‹åè®°å¾—åˆ‡æ¢å›æ™®é€šç”¨æˆ·ï¼Œé¿å…è¯¯æ“å¸¦æ¥ç³»ç»ŸæŸåã€‚</font>ğŸ˜Š</p>
<p><strong>åœ¨åé¢æ¶‰åŠåˆ°æ–‡ä»¶ä¸Šä¼ çš„å†…å®¹å‡é‡‡ç”¨ä»¥ä¸Šä¸¤ç§æ–¹å¼(æŒ‰éœ€è‡ªé€‰å…¶ä¸€å³å¯)ï¼Œæ‰€ä»¥åé¢ä¸å†è¿‡å¤šèµ˜è¿°ã€‚</strong></p>
<h1 id="2-Hadoop"><a href="#2-Hadoop" class="headerlink" title="2. Hadoop"></a>2. Hadoop</h1><p>Hadoop æ˜¯ä¸€ä¸ªç”± Apache åŸºé‡‘ä¼šå¼€å‘çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¡†æ¶ï¼Œå®ƒåˆ©ç”¨é›†ç¾¤çš„å¼ºå¤§è®¡ç®—èƒ½åŠ›è¿›è¡Œå¤§æ•°æ®çš„å­˜å‚¨å’Œå¤„ç†ï¼Œé€šè¿‡ HDFS å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå¹¶é€šè¿‡ MapReduce å®ç°åˆ†å¸ƒå¼è®¡ç®—ï¼Œä¸ºä¼ä¸šæä¾›äº†é«˜æ•ˆã€å¯é ã€å¯æ‰©å±•çš„å¤§æ•°æ®å¤„ç†èƒ½åŠ›ã€‚</p>
<h2 id="2-1-Hadoop-å®‰è£…å‡†å¤‡"><a href="#2-1-Hadoop-å®‰è£…å‡†å¤‡" class="headerlink" title="2.1 Hadoop å®‰è£…å‡†å¤‡"></a>2.1 Hadoop å®‰è£…å‡†å¤‡</h2><blockquote>
<p>é…ç½®æ“ä½œæƒé™</p>
</blockquote>
<p>å®‰è£…ä¹‹å‰æˆ‘ä»¬è¦å…ˆäº†è§£åˆ°ï¼šæˆ‘ä»¬åˆšæ‰åœ¨å®‰è£… CentOS çš„æ—¶å€™è®¾ç½®çš„ç”¨æˆ·ååªæ˜¯æ™®é€šç”¨æˆ·ï¼Œè€Œæ™®é€šç”¨æˆ·åœ¨è®¸å¤šåœ°æ–¹çš„æƒé™æ˜¯å—é™çš„ã€‚é‚£è¦æ€ä¹ˆè§£å†³æ™®é€šç”¨æˆ·åœ¨ Linux ç³»ç»Ÿä¸‹æƒé™å—é™çš„é—®é¢˜å‘¢ï¼Ÿ</p>
<p>ä¸¤ä¸ªæ–¹æ¡ˆ(<font color="red">æ¨èä½¿ç”¨ç¬¬äºŒç§ï¼Œä¸å»ºè®®é•¿æœŸä½¿ç”¨ root ç”¨æˆ·ï¼Œé¿å…å¸¦æ¥ç³»ç»ŸæŸå</font>)ï¼š</p>
<ul>
<li>ä½¿ç”¨ root ç”¨æˆ·è¿›è¡Œæ“ä½œ( root ç”¨æˆ·æ‹¥æœ‰æœ€å¤§çš„ç³»ç»Ÿæ“ä½œæƒé™)ã€‚</li>
<li>ä¸ºæ™®é€šç”¨æˆ·é…ç½® sudo è®¤è¯(ä¸ºæ™®é€šç”¨æˆ·å¢åŠ ç®¡ç†å‘˜æƒé™)ã€‚(<font color="red">æ¨è</font>)</li>
</ul>
<p><strong>ç¬¬ä¸€ç§ï¼šä½¿ç”¨ root ç”¨æˆ·è¿›è¡Œæ“ä½œ</strong></p>
<p>ç›´æ¥ä½¿ç”¨å‘½ä»¤ç„¶åè¾“å…¥å¯†ç å³å¯åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚(è¾“å…¥å¯†ç æ—¶å¯èƒ½ä¸ä¼šæ˜¾ç¤ºï¼Œè¾“å…¥å¯†ç åç›´æ¥ <code>Enter</code> ç¡®è®¤å°±è¡Œ)ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ° root ç”¨æˆ·</span></span><br><span class="line">su - root</span><br></pre></td></tr></table></figure>

<p>åˆ‡æ¢ç”¨æˆ·åï¼Œå¯ä»¥é€šè¿‡ <code>exit</code> å‘½ä»¤é€€å›ä¸Šä¸€ä¸ªç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼š<code>ctrl + d</code> ã€‚</p>
<p>ä½¿ç”¨æ™®é€šç”¨æˆ·ï¼Œåˆ‡æ¢åˆ°å…¶å®ƒç”¨æˆ·éœ€è¦è¾“å…¥å¯†ç ï¼Œå¦‚åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p>
<p>ä½¿ç”¨ root ç”¨æˆ·åˆ‡æ¢åˆ°å…¶å®ƒç”¨æˆ·ï¼Œæ— éœ€å¯†ç ï¼Œå¯ä»¥ç›´æ¥åˆ‡æ¢ã€‚</p>
<p><strong>ç¬¬äºŒç§ï¼šä¸ºæ™®é€šç”¨æˆ·é…ç½® sudo è®¤è¯</strong></p>
<p>ä¸ºæ™®é€šç”¨æˆ·é…ç½® sudo è®¤è¯åï¼Œåœ¨æ‰§è¡Œå…¶å®ƒå‘½ä»¤ä¹‹å‰ï¼Œå¸¦ä¸Š sudo ï¼Œå³å¯ä¸ºè¿™ä¸€æ¡å‘½ä»¤ä¸´æ—¶èµ‹äºˆ root æˆæƒã€‚</p>
<p>1ã€åˆ‡æ¢åˆ° root ç”¨æˆ·ï¼Œä½¿ç”¨å‘½ä»¤ç„¶åè¾“å…¥å¯†ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ° root ç”¨æˆ·</span></span><br><span class="line">su - root</span><br></pre></td></tr></table></figure>

<p>2ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨é€šè¿‡ vi ç¼–è¾‘å™¨æ‰“å¼€ï¼š&#x2F;etc&#x2F;sudoers</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">visudo	<span class="comment">#æˆ–è€…æ‰§è¡Œ vi /etc/sudoers</span></span><br></pre></td></tr></table></figure>

<p>3ã€å…ˆæŒ‰ä¸€ä¸‹é”®ç›˜ä¸Šçš„ <code>ESC</code> é”®ï¼Œå†è¾“å…¥<code>:set nu</code> æ˜¾ç¤ºè¡Œå·ï¼Œæ‰¾åˆ° <code>root ALL=(ALL) ALL</code> è¿™è¡Œï¼Œç„¶åè¾“å…¥ <code>:101</code> (è·³åˆ°ç¬¬101è¡Œ )ï¼Œç„¶ååœ¨è¿™è¡Œå¢åŠ ä¸€è¡Œå†…å®¹ï¼š<code>muyoukule ALL=(ALL)	NOPASSWD:ALL</code> (å…¶ä¸­ <code>muyoukule</code> æ˜¯éœ€è¦é…ç½® <code>sudo</code> è®¤è¯çš„æ™®é€šç”¨æˆ·ï¼Œ<code>NOPASSWD:ALL</code> è¡¨ç¤ºä½¿ç”¨ sudo å‘½ä»¤æ—¶æ— éœ€è¾“å…¥å¯†ç ï¼Œä¸­é—´çš„é—´éš”ä¸º <code>tab</code> )ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/sudo%E8%AE%A4%E8%AF%81.png"></p>
<p>4ã€æ·»åŠ ä¸Šä¸€è¡Œå†…å®¹åï¼Œå…ˆæŒ‰ä¸€ä¸‹é”®ç›˜ä¸Šçš„ <code>ESC</code> é”®ï¼Œç„¶åè¾“å…¥ <code>:wq</code> å†æŒ‰å›è½¦é”®ä¿å­˜é€€å‡ºå°±å¯ä»¥äº†ã€‚</p>
<p>5ã€æœ€åä½¿ç”¨ <code>ctrl + d</code> æ³¨é”€å½“å‰ root ç”¨æˆ·ï¼Œå›åˆ°åˆšæ‰è‡ªå·±åˆ›å»ºçš„ç”¨æˆ·ï¼Œè‡³æ­¤ä¸ºæ™®é€šç”¨æˆ·é…ç½® <code>sudo</code> è®¤è¯æˆåŠŸã€‚</p>
<blockquote>
<p>æ£€æŸ¥ç½‘ç»œ</p>
</blockquote>
<p>ä½¿ç”¨ <code>muyoukule</code> ç”¨æˆ·ç™»å½•åï¼Œè¿˜éœ€è¦å®‰è£…å‡ ä¸ªè½¯ä»¶æ‰èƒ½å®‰è£… Hadoopã€‚</p>
<p>CentOS ä½¿ç”¨ yum æ¥å®‰è£…è½¯ä»¶ï¼Œéœ€è¦è”ç½‘ç¯å¢ƒï¼Œé¦–å…ˆåº”æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦è¿ä¸Šäº†ç½‘ç»œã€‚</p>
<p>æä¾›ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¡Œé¢å³ä¸Šè§’çš„ç½‘ç»œå›¾æ ‡è‹¥æ˜¾ç¤º <font color="green">ç»¿</font> ç‚¹ï¼Œåˆ™è¡¨æ˜è¿˜è”ç½‘ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE.png" style="zoom: 50%;">
</li>
<li><p>ä½¿ç”¨ <code>ping www.baidu.com</code>ï¼Œping å¾—é€šè¯´æ˜å¯ä»¥è”ç½‘ã€‚</p>
</li>
</ul>
<blockquote>
<p>å®‰è£… SSHã€é…ç½® SSH æ— å¯†ç ç™»é™†</p>
</blockquote>
<p>é›†ç¾¤ã€å•èŠ‚ç‚¹æ¨¡å¼éƒ½éœ€è¦ç”¨åˆ° SSH ç™»é™†(ç±»ä¼¼äºè¿œç¨‹ç™»é™†ï¼Œä½ å¯ä»¥ç™»å½•æŸå° Linux ä¸»æœºï¼Œå¹¶ä¸”åœ¨ä¸Šé¢è¿è¡Œå‘½ä»¤)ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒCentOS é»˜è®¤å·²å®‰è£…äº† SSH clientã€SSH serverï¼Œæ‰“å¼€ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ£€éªŒï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€éªŒæ˜¯å¦å®‰è£…äº† SSH clientã€SSH server</span></span><br><span class="line">rpm -qa | grep ssh</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿”å›çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŒ…å«äº† SSH client è·Ÿ SSH serverï¼Œåˆ™ä¸éœ€è¦å†å®‰è£…ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5SSH.png"></p>
<p>è‹¥éœ€è¦å®‰è£…ï¼Œåˆ™å¯ä»¥é€šè¿‡ yum è¿›è¡Œå®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum -y install openssh-clients</span><br><span class="line">sudo yum -y install openssh-server</span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ SSH æ˜¯å¦å¯ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh localhost</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä¼šæœ‰å¦‚ä¸‹æç¤º(SSHé¦–æ¬¡ç™»é™†æç¤º)ï¼Œè¾“å…¥ yes ã€‚ç„¶åæŒ‰æç¤ºè¾“å…¥å¯†ç  <code>123456</code> (è¾“å…¥ä½ è‡ªå·±å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™è¾“å…¥çš„å¯†ç )ï¼Œè¿™æ ·å°±ç™»é™†åˆ°æœ¬æœºäº†ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%B5%8B%E8%AF%95SSH%20.png"></p>
<p>ä½†è¿™æ ·ç™»é™†æ˜¯éœ€è¦æ¯æ¬¡è¾“å…¥å¯†ç çš„ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æˆ SSH æ— å¯†ç ç™»é™†æ¯”è¾ƒæ–¹ä¾¿ã€‚</p>
<p>é¦–å…ˆè¾“å…¥ <code>exit</code> é€€å‡ºåˆšæ‰çš„ sshï¼Œå°±å›åˆ°äº†æˆ‘ä»¬åŸå…ˆçš„ç»ˆç«¯çª—å£ï¼Œç„¶ååˆ©ç”¨ ssh-keygen ç”Ÿæˆå¯†é’¥ï¼Œå¹¶å°†å¯†é’¥åŠ å…¥åˆ°æˆæƒä¸­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€€å‡ºåˆšæ‰çš„ ssh localhost</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥æ²¡æœ‰è¯¥ç›®å½•ï¼Œè¯·å…ˆæ‰§è¡Œä¸€æ¬¡ssh localhost</span></span><br><span class="line"><span class="built_in">cd</span> ~/.ssh/</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼šæœ‰æç¤ºï¼Œéƒ½æŒ‰å›è½¦å°±å¯ä»¥</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å…¥æˆæƒ</span></span><br><span class="line"><span class="built_in">cat</span> id_rsa.pub &gt;&gt; authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> 600 ./authorized_keys</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å†ç”¨ <code>ssh localhost</code> å‘½ä»¤ï¼Œæ— éœ€è¾“å…¥å¯†ç å°±å¯ä»¥ç›´æ¥ç™»é™†äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/SSH%E6%97%A0%E5%AF%86%E7%99%BB%E5%85%A5.png"></p>
<blockquote>
<p>å‡†å¤‡ Java ç¯å¢ƒ</p>
</blockquote>
<p>å‡†å¤‡ Java ç¯å¢ƒä¹‹å‰æˆ‘ä»¬è¦çŸ¥é“ä¸¤ä»¶äº‹ï¼š</p>
<ul>
<li>è½¯ä»¶å®‰è£…çš„é‚£äº›äº‹ï¼š<a href="https://www.php.cn/faq/502305.html">Linuxè½¯ä»¶å®‰è£…åœ¨å“ªä¸ªç›®å½•ï¼Ÿ</a> <font color="red">å¾ˆé‡è¦ï¼ï¼ï¼ï¼ä¸€å®šè¦ä»”ç»†é˜…è¯»ï¼ï¼ï¼é¿å…åç»­è‡ªå·±æ‰¾ä¸åˆ°å®‰è£…çš„è½¯ä»¶ï¼ï¼ï¼</font>ğŸ˜…</li>
<li><strong>JRE å’Œ JDK çš„ä¸»è¦åŒºåˆ«ï¼š</strong>JRE ( Java è¿è¡Œç¯å¢ƒ)ä»…ç”¨äºè¿è¡Œå·² <font color="red">ç¼–è¯‘</font> çš„ Java ç¨‹åºï¼Œè€Œ  JDK ( Java å¼€å‘å·¥å…·åŒ…)åˆ™åŒ…å«äº† <font color="red">ç¼–è¯‘ã€è°ƒè¯•ã€è¿è¡Œ</font> Java ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å·¥å…·ï¼Œç”¨äº Java ç¨‹åºçš„å¼€å‘ã€‚ç®€å•æ¥è¯´ï¼ŒJRE æ˜¯è¿è¡Œ Java çš„ï¼Œè€Œ JDK æ˜¯å¼€å‘ Java çš„ã€‚</li>
</ul>
<p>åœ¨Linuxç³»ç»Ÿä¸­ï¼ŒJava ç¯å¢ƒçš„é€‰æ‹©å’Œé…ç½®å¯¹äºè¿è¡Œ Hadoop ç­‰ Java åº”ç”¨è‡³å…³é‡è¦ï¼Œå› ä¸º Hadoop æ˜¯åŸºäº Java å¼€å‘çš„ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®‰è£… Java ç¯å¢ƒ(<font color="red">æ¨èç¬¬äºŒç§æ–¹å¼</font>)ï¼š</p>
<ul>
<li>å®‰è£… OpenJDK ã€‚</li>
<li>å®‰è£… Oracle çš„ JDK ã€‚(<font color="red">æ¨è</font>)</li>
</ul>
<p>Linux ç³»ç»Ÿé€šè¿‡ yum å®‰è£… OpenJDK æ›´ä¸ºç®€ä¾¿ä¸”å¼€æºå…è´¹ï¼Œè€Œå®‰è£… Oracle JDK åˆ™éœ€æ‰‹åŠ¨ä¸‹è½½å¹¶å¯èƒ½æ¶‰åŠå•†ä¸šæˆæƒï¼Œä½†äº«æœ‰ Oracle çš„ä¸“ä¸šæŠ€æœ¯æ”¯æŒï¼Œä¸¤è€…åœ¨ç‰ˆæœ¬æ›´æ–°å’Œç¨³å®šæ€§ä¸Šä¹Ÿæœ‰æ‰€ä¸åŒï¼Œé€‰æ‹©å–å†³äºå…·ä½“éœ€æ±‚å’Œåå¥½ã€‚</p>
<p><strong>ç¬¬ä¸€ç§ï¼šå®‰è£… OpenJDK</strong></p>
<p>OpenJDK æ˜¯å¼€æºçš„ï¼Œå¹¶ä¸”è¢«å¹¿å¤§ç¤¾åŒºæ‰€æ”¯æŒï¼Œå› æ­¤åœ¨è®¸å¤š Linux å‘è¡Œç‰ˆä¸­ï¼ŒåŒ…æ‹¬CentOS ï¼ŒOpenJDK è¢«ä½œä¸ºé»˜è®¤çš„ Java ç¯å¢ƒå®‰è£…ã€‚ä»¥ CentOS7 ä¸ºä¾‹ï¼Œå®ƒé»˜è®¤å®‰è£…äº† OpenJDK 1.8 çš„ Java è¿è¡Œç¯å¢ƒ(JRE)ã€‚å¯ä»¥ä½¿ç”¨ <code>java -version</code> æŸ¥çœ‹åˆ°ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%BB%98%E8%AE%A4OpenJDK.png"></p>
<p>ä½†æ˜¯<strong>ä¸èƒ½</strong>åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­æŸ¥çœ‹åˆ° <code>JAVA_HOME</code> ï¼Œç”±äº Hadoop éœ€è¦è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥åé¢éœ€è¦<strong>è¿›è¡Œ Java çš„ç›¸å…³ç¯å¢ƒå˜é‡é…ç½®</strong>ã€‚</p>
<p>ç„¶è€Œï¼Œå¯¹äº Hadoop ç­‰ Java åº”ç”¨çš„å¼€å‘å’Œè¿è¡Œï¼Œé€šå¸¸éœ€è¦å®Œæ•´çš„ Java å¼€å‘å·¥å…·åŒ…(JDK)ï¼Œè€Œä¸ä»…ä»…æ˜¯ JRE ã€‚å› æ­¤ï¼Œä¸ºäº†å¼€å‘æ–¹ä¾¿å’Œç¡®ä¿ Hadoop ç­‰åº”ç”¨çš„æ­£å¸¸è¿è¡Œï¼Œç”¨æˆ·éœ€è¦å®‰è£… JDK ã€‚</p>
<p>åœ¨ CentOS ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>yum</code> åŒ…ç®¡ç†å™¨æ¥å®‰è£… JDKã€‚å…·ä½“è¿‡ç¨‹è¯·å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_43699958/article/details/134532819">ä½¿ç”¨ yum å®‰è£… jdk å¹¶é…ç½®ç¯å¢ƒå˜é‡</a></p>
<p><strong>ç¬¬äºŒç§ï¼šå®‰è£… Oracle çš„ JDK</strong></p>
<p><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">JDK ä¸‹è½½å®˜ç½‘</a></p>
<p>æ‰“å¼€åä¸‹æ‹‰æ‰¾åˆ°ç›¸åº”çš„ç‰ˆæœ¬ä¸‹è½½å³å¯ï¼Œç‚¹å‡»ä¸‹è½½ååœ¨å¼¹å‡ºçš„é¡µé¢ä¸­è¾“å…¥ Oracle çš„è´¦æˆ·å¯†ç å³å¯ä¸‹è½½(å¦‚æ— è´¦æˆ·ï¼Œè¯·è‡ªè¡Œæ³¨å†Œï¼Œæ³¨å†Œæ˜¯å…è´¹çš„)ã€‚<font color="red">PSï¼šä¸€å®šè¦ä¸‹è½½ä»¥ <code>.tar.gz</code> ç»“å°¾çš„æ–‡ä»¶ï¼Œä¸è¦ä¸‹è½½é”™äº†å“¦ï¼ï¼</font>ğŸ˜Š</p>
<p>ä¸‹è½½å¥½ä¹‹åå°±å¯ä»¥å¼€å§‹å®‰è£…äº†ï¼š</p>
<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© JDK å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œè§£å‹å®Œæˆåå¯ä»¥è¿›å…¥åˆ° &#x2F;usr&#x2F;local ç›®å½•æŸ¥çœ‹æ˜¯å¦å¤šäº†ä»¥ä¸‹æ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼© JDK å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf jdk-8u162-linux-x64.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8B%E8%A7%A3%E5%8E%8B%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F.png"></p>
<p>3ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Javaç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/jdk1.8.0_162</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEJava%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom: 67%;">

<p>4ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>5ã€æ£€æŸ¥å®‰è£…ç»“æœï¼Œå¦‚æœè®¾ç½®æ­£ç¡®çš„è¯ï¼Œ<code>$JAVA_HOME/bin/java -version</code> ä¼šè¾“å‡º java çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸”å’Œ <code>java -version</code> çš„è¾“å‡ºç»“æœä¸€æ ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$JAVA_HOME</span>/bin/java -version</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5Java%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png"></p>
<p>è¿™æ ·ï¼ŒHadoop æ‰€éœ€çš„ Java è¿è¡Œç¯å¢ƒå°±å®‰è£…å¥½äº†ã€‚</p>
<h2 id="2-2-Hadoopä¸‹è½½å®‰è£…"><a href="#2-2-Hadoopä¸‹è½½å®‰è£…" class="headerlink" title="2.2 Hadoopä¸‹è½½å®‰è£…"></a>2.2 Hadoopä¸‹è½½å®‰è£…</h2><p><a href="https://archive.apache.org/dist/hadoop/common/">å®˜ç½‘ä¸‹è½½</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hadoop%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(1).png" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hadoop%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(2).png" style="zoom:50%;">

<p>æ‰“ä¸å¼€å®˜ç½‘ï¼Ÿè¯•è¯•<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hadoop/common/">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ä¸‹è½½</a>ï¼Œä¸è¿‡å¥½åƒåªæœ‰æ–°ç‰ˆã€‚ğŸ¤”</p>
<p>ä¸‹è½½å¥½ä¹‹åå°±å¯ä»¥å¼€å§‹å®‰è£…äº†ï¼š</p>
<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© Hadoop å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œè§£å‹å®Œæˆåå¯ä»¥è¿›å…¥åˆ° &#x2F;usr&#x2F;local ç›®å½•æŸ¥çœ‹æ˜¯å¦æˆåŠŸã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼©å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf hadoop-3.1.3.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† hadoop-3.1.3 ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹ä¸º muyoukuleï¼Œ</span></span><br><span class="line"><span class="comment"># hadoop-3.1.3 æ˜¯ hadoop-3.1.3.tar.gz è§£å‹åå¾—åˆ°çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment"># muyoukule æ˜¯å½“å‰ç”¨æˆ·çš„ç”¨æˆ·å</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule:muyoukule ./hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>3ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hadoop ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/usr/local/hadoop-3.1.3</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEHadoop%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom:67%;">

<p>4ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>5ã€æ£€æŸ¥å®‰è£…ç»“æœï¼Œå‡ºç°ä¸‹é¢ä¿¡æ¯ä»£è¡¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ Hadoop ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">hadoop version</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5Hadoop%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png">

<p>è¿™æ ·ï¼ŒHadoop å°±å®‰è£…å¥½äº†ã€‚</p>
<h2 id="2-3-Hadoop-å•æœºé…ç½®"><a href="#2-3-Hadoop-å•æœºé…ç½®" class="headerlink" title="2.3 Hadoop å•æœºé…ç½®"></a>2.3 Hadoop å•æœºé…ç½®</h2><p>Hadoop é»˜è®¤æ¨¡å¼ä¸ºéåˆ†å¸ƒå¼æ¨¡å¼ï¼Œæ— éœ€è¿›è¡Œå…¶ä»–é…ç½®å³å¯è¿è¡Œã€‚éåˆ†å¸ƒå¼å³å• Java è¿›ç¨‹ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¾‹å­æ¥æ„Ÿå—ä¸‹ Hadoop çš„è¿è¡Œã€‚Hadoop é™„å¸¦äº†ä¸°å¯Œçš„ä¾‹å­ï¼ŒåŒ…æ‹¬ wordcountã€terasortã€joinã€grep ç­‰ã€‚</p>
<ul>
<li>WordCount æ˜¯ä¸€ä¸ªåŸºç¡€ç¤ºä¾‹ç¨‹åºï¼Œç”¨äºè®¡ç®—æ–‡æœ¬ä¸­æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œé€šè¿‡MapReduceæ¨¡å‹å®ç°æ•°æ®çš„åˆ†å¸ƒå¼å¤„ç†ã€‚</li>
<li>Terasort æ˜¯ Hadoop ä¸­çš„ä¸€ä¸ªæ’åºç®—æ³•ï¼Œèƒ½å¤Ÿå¤„ç†å¤§è§„æ¨¡æ•°æ®é›†çš„æ’åºé—®é¢˜ï¼Œé€šè¿‡åˆ†å¸ƒå¼è®¡ç®—å’Œ trie æ ‘çš„æ€§è´¨æé«˜æ’åºæ•ˆç‡ã€‚</li>
<li>Join æ“ä½œåœ¨ Hadoop ä¸­è™½ç„¶ä¸ç›´æ¥æ”¯æŒï¼Œä½†å¯ä»¥é€šè¿‡ç¼–ç¨‹å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ Reduce side join å’Œ Map side joinï¼Œç”¨äºæ•´åˆä¸åŒæ•°æ®æºä¸­çš„æ•°æ®ã€‚</li>
<li>Grep åˆ™æ˜¯ä¸€ç§æ–‡æœ¬æœç´¢å·¥å…·ï¼Œåœ¨ Hadoop ä¸­å¯ä»¥ç”¨äºæœç´¢å­˜å‚¨åœ¨ HDFS ä¸­çš„å¤§è§„æ¨¡æ–‡æœ¬æ–‡ä»¶ï¼Œé€šè¿‡ç¼–å†™è‡ªå®šä¹‰çš„ Mapper ç¨‹åºå®ç°ç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ° /usr/local/hadoop-3.1.3</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¾‹å­</span></span><br><span class="line">hadoop jar ./share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hadoop%E4%BE%8B%E5%AD%90.png" style="zoom:67%;">

<p>åœ¨æ­¤æˆ‘ä»¬é€‰æ‹©è¿è¡Œ grep ä¾‹å­ï¼Œæˆ‘ä»¬å°† input æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œç­›é€‰å½“ä¸­ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼  <code>dfs[a-z.]+</code>  çš„å•è¯å¹¶ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°ï¼Œæœ€åè¾“å‡ºç»“æœåˆ° output æ–‡ä»¶å¤¹ä¸­ã€‚éœ€è¦æ³¨æ„ï¼šå¦‚æœ output ç›®å½•å·²ç»å­˜åœ¨ï¼ŒHadoop ä¼šæŠ¥é”™ï¼Œ<strong>å› ä¸ºè¾“å‡ºç›®å½•å¿…é¡»æ˜¯ç©ºçš„</strong>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ° /usr/local/hadoop-3.1.3</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å½“å‰çš„ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º input çš„ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> ./input</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† ./etc/hadoop/ ç›®å½•ä¸‹çš„æ‰€æœ‰ .xml æ–‡ä»¶å¤åˆ¶åˆ°åˆšåˆšåˆ›å»ºçš„ input ç›®å½•ä¸­</span></span><br><span class="line"><span class="built_in">cp</span> ./etc/hadoop/*.xml ./input</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ input ç›®å½•ä¸­æœç´¢æ‰€æœ‰ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ dfs[a-z.]+ çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†æœç´¢ç»“æœè¾“å‡ºåˆ° output ç›®å½•</span></span><br><span class="line">hadoop jar ./share/hadoop/mapreduce/hadoop-mapreduce-examples-*.jar grep ./input ./output <span class="string">&#x27;dfs[a-z.]+&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ output ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å†…å®¹ï¼Œå³ grep ä»»åŠ¡çš„è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="built_in">cat</span> ./output/*</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œåå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/grep%E4%BE%8B%E5%AD%90.png" style="zoom: 67%;">

<h2 id="2-4-Hadoop-ä¼ªåˆ†å¸ƒå¼é…ç½®"><a href="#2-4-Hadoop-ä¼ªåˆ†å¸ƒå¼é…ç½®" class="headerlink" title="2.4 Hadoop ä¼ªåˆ†å¸ƒå¼é…ç½®"></a>2.4 Hadoop ä¼ªåˆ†å¸ƒå¼é…ç½®</h2><p>Hadoop çš„ä¼ªåˆ†å¸ƒå¼é…ç½®å…è®¸ Hadoop åœ¨å•èŠ‚ç‚¹ä¸Šä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œå°½ç®¡æ‰€æœ‰çš„ Hadoop è¿›ç¨‹éƒ½è¿è¡Œåœ¨åŒä¸€å°æœºå™¨ä¸Šã€‚åœ¨è¿™ç§é…ç½®ä¸­ï¼ŒHadoop è¿›ç¨‹ä»¥åˆ†ç¦»çš„ Java è¿›ç¨‹æ¥è¿è¡Œï¼ŒèŠ‚ç‚¹æ—¢ä½œä¸º NameNode ä¹Ÿä½œä¸º DataNodeï¼ŒåŒæ—¶è¯»å–çš„æ˜¯ HDFS(Hadoop Distributed File System)ä¸­çš„æ–‡ä»¶ã€‚</p>
<p><code>cd</code> è¿›å…¥ Hadoop å®‰è£…åŒ…å†…ï¼Œé€šè¿‡ <code>ll</code> å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å¤¹å†…éƒ¨ç»“æ„ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hadoop%E6%96%87%E4%BB%B6%E5%A4%B9%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84.png"></p>
<p>å„ä¸ªæ–‡ä»¶å¤¹å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li>binï¼Œå­˜æ”¾Hadoopçš„å„ç±»ç¨‹åº(å‘½ä»¤)</li>
<li>etcï¼Œå­˜æ”¾Hadoopçš„é…ç½®æ–‡ä»¶</li>
<li>includeï¼ŒCè¯­è¨€çš„ä¸€äº›å¤´æ–‡ä»¶</li>
<li>libï¼Œå­˜æ”¾Linuxç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“(.soæ–‡ä»¶)</li>
<li>libexecï¼Œå­˜æ”¾é…ç½®Hadoopç³»ç»Ÿçš„è„šæœ¬æ–‡ä»¶(.shå’Œ.cmd)</li>
<li>sbinï¼Œç®¡ç†å‘˜ç¨‹åº(super bin)</li>
<li>shareï¼Œå­˜æ”¾äºŒè¿›åˆ¶æºç (Java jaråŒ…)</li>
</ul>
<p>é…ç½® Hadoop ä¼ªåˆ†å¸ƒå¼ï¼Œæˆ‘ä»¬ä¸»è¦æ¶‰åŠåˆ°å¦‚ä¸‹æ–‡ä»¶çš„ä¿®æ”¹ï¼š</p>
<ul>
<li>core-site.xmlï¼š Hadoop æ ¸å¿ƒé…ç½®æ–‡ä»¶</li>
<li>hdfs-site.xmlï¼š HDFS æ ¸å¿ƒé…ç½®æ–‡ä»¶</li>
</ul>
<p>è¿™äº›æ–‡ä»¶å‡å­˜åœ¨ä¸ <code>$HADOOP_HOME/etc/hadoop</code> æ–‡ä»¶å¤¹ä¸­ï¼Œç”¨äºè®¾ç½® Hadoop é›†ç¾¤çš„å„ç§å‚æ•°ï¼Œå¦‚ HDFS çš„ç«¯å£å·ã€NameNode çš„åœ°å€ç­‰ã€‚Hadoop çš„é…ç½®æ–‡ä»¶æ˜¯ xml æ ¼å¼ï¼Œæ¯ä¸ªé…ç½®ä»¥å£°æ˜ property çš„ name å’Œ value çš„æ–¹å¼æ¥å®ç°ã€‚</p>
<p><strong>PSï¼š$HADOOP_HOMEæ˜¯è®¾ç½®çš„ç¯å¢ƒå˜é‡ï¼Œå…¶æŒ‡ä»£ Hadoop å®‰è£…æ–‡ä»¶å¤¹å³ &#x2F;usr&#x2F;local&#x2F;hadoop-3.1.3</strong></p>
<p>1ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ core-site.xml </p>
<p><strong>hadoop.tmp.dir</strong></p>
<p><code>hadoop.tmp.dir</code> æ˜¯ Hadoop æ¡†æ¶ä¸­çš„å…³é”®é…ç½®å‚æ•°ï¼Œç”¨äºæŒ‡å®šä¸´æ—¶æ•°æ®å’Œå…³é”®å…ƒæ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚å®ƒå¯¹äº Hadoop çš„ç¨³å®šè¿è¡Œå’Œæ•°æ®å®‰å…¨è‡³å…³é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†æ—¶ã€‚åˆç†é…ç½®è¿™ä¸ªç›®å½•ï¼Œå¯ä»¥ç¡®ä¿ä¸­é—´æ–‡ä»¶å’Œå…³é”®ä¿¡æ¯å¾—åˆ°å¦¥å–„ä¿å­˜ï¼Œé¿å…å› ç³»ç»Ÿé‡å¯æˆ–ä¸´æ—¶ç›®å½•è¢«æ¸…ç©ºè€Œå¯¼è‡´çš„æ•°æ®ä¸¢å¤±ã€‚å› æ­¤ï¼Œåœ¨éƒ¨ç½²å’Œé…ç½® Hadoop æ—¶ï¼Œå»ºè®®æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ <code>hadoop.tmp.dir</code> çš„è·¯å¾„ï¼Œå¹¶ç¡®ä¿å…¶æŒ‡å‘æŒä¹…åŒ–çš„å­˜å‚¨ä½ç½®ã€‚è¿™é‡Œæˆ‘ä»¬ç»™å®ƒè®¾ç½®ä¸º Hadoop å®‰è£…ç›®å½•ä¸‹çš„ <code>tmp</code> æ–‡ä»¶å¤¹ï¼Œå¯¹äºæˆ‘çš„å®‰è£…ç›®å½•æ¥è¯´ï¼Œå…·ä½“è·¯å¾„åœ¨ <code>/usr/local/hadoop-3.1.3/tmp</code>ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å®‰è£…ç›®å½•è¿›è¡Œä¸€å®šçš„è°ƒæ•´ã€‚</p>
<p><strong>fs.defaultFS</strong></p>
<p><code>fs.defaultFS</code> æ˜¯ Hadoop æ¡†æ¶ä¸­ä¸€ä¸ªé‡è¦çš„é…ç½®å‚æ•°ï¼Œå®ƒç”¨äºæŒ‡å®šé›†ç¾¤ä¸­é»˜è®¤çš„æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ã€‚è¿™ä¸ªè·¯å¾„é€šå¸¸æ˜¯ HDFS(Hadoop Distributed FileSystem)çš„ URIï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€Amazon S3 ç­‰ã€‚é€šè¿‡é…ç½® <code>fs.defaultFS</code>ï¼ŒHadoop åº”ç”¨ç¨‹åºå¯ä»¥æ— ç¼åœ°è®¿é—®å’Œæ“ä½œå­˜å‚¨åœ¨è¿™äº›æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®ã€‚</p>
<p>è¿™æ¬¡æˆ‘ä»¬é€‰æ‹©ç”¨ gedit è€Œä¸æ˜¯ vim æ¥ç¼–è¾‘ã€‚gedit æ˜¯æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç±»ä¼¼äº Windows ä¸­çš„è®°äº‹æœ¬ï¼Œä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚ä¿å­˜åè®°å¾—å…³æ‰æ•´ä¸ª gedit ç¨‹åºï¼Œå¦åˆ™ä¼šå ç”¨ç»ˆç«¯ã€‚</p>
<p><font color="red">PSï¼šä½¿ç”¨ gedit éœ€è¦ç›´æ¥æ“ä½œè™šæ‹Ÿæœºï¼Œä¸èƒ½åœ¨è¿œç¨‹è¿æ¥å·¥å…·æ“ä½œï¼Œå¦åˆ™å¯èƒ½ä¼šæ‰“ä¸å¼€å›¾å½¢åŒ–ç¼–è¾‘å™¨ã€‚</font>ğŸ˜…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ° /usr/local/hadoop-3.1.3</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸€æ¬¡ä½¿ç”¨å…ˆè¿›è¡Œå®‰è£…</span></span><br><span class="line">sudo yum -y install gedit</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ core-site.xml æ–‡ä»¶</span></span><br><span class="line">gedit ./etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure>

<p>å°†å½“ä¸­çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸ºä¸‹é¢é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½® Hadoop æ•°æ®æ ¹ç›®å½•ä¸º /usr/local/hadoop-3.1.3/tmp ç›®å½• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop-3.1.3/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Abase for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/gedit%E7%BC%96%E8%BE%91core-site.xml.png" style="zoom:50%;">

<p>2ã€åŒç†ä¿®æ”¹é…ç½®æ–‡ä»¶ hdfs-site.xml</p>
<p><strong>dfs.replication</strong></p>
<p><code>dfs.replication</code>  æ˜¯ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ(HDFS)ä¸­çš„å…³é”®å‚æ•°ï¼Œç”¨äºæŒ‡å®šæ¯ä¸ªæ•°æ®å—åœ¨HDFSä¸­å­˜å‚¨çš„å‰¯æœ¬æ•°ã€‚åˆç†é…ç½®è¯¥å‚æ•°å¯ä»¥å¹³è¡¡æ•°æ®å¯é æ€§ã€å­˜å‚¨èµ„æºæ¶ˆè€—å’Œæ€§èƒ½éœ€æ±‚ï¼Œç¡®ä¿HDFSåœ¨é«˜å¯ç”¨æ€§å’Œå®¹é”™æ€§æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚</p>
<p><strong>dfs.namenode.name.dir å’Œ dfs.datanode.data.dir</strong></p>
<p><code>dfs.namenode.name.dir</code> ç”¨äºæŒ‡å®šä¿å­˜ HDFS å…ƒæ•°æ®çš„ç›®å½•ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´ã€å±æ€§åŠå—ä½ç½®ç­‰ä¿¡æ¯ï¼Œç¡®ä¿å…ƒæ•°æ®çš„å®‰å…¨å­˜å‚¨å’Œå¯é è®¿é—®ã€‚</p>
<p><code>dfs.datanode.data.dir</code> åˆ™ç”¨äºæŒ‡å®šå­˜æ”¾ HDFS æ•°æ®å—æ–‡ä»¶çš„ç›®å½•ï¼Œæ˜¯æ•°æ®èŠ‚ç‚¹å­˜å‚¨å®é™…æ•°æ®çš„æœ¬åœ°è·¯å¾„ï¼Œç¡®ä¿æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨å’Œé«˜æ•ˆè®¿é—®ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€ hdfs-site.xml æ–‡ä»¶</span></span><br><span class="line">gedit ./etc/hadoop/hdfs-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®ç›®å½•ä¸º /usr/local/hadoop-3.1.3/tmp/dfs/name ç›®å½• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop-3.1.3/tmp/dfs/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®ç›®å½•ä¸º /usr/local/hadoop-3.1.3/tmp/dfs/data ç›®å½• --&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop-3.1.3/tmp/dfs/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€é…ç½®å®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ ¼å¼åŒ– NameNode ï¼ŒæˆåŠŸçš„è¯ä¼šçœ‹åˆ° <code>successfully formatted</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼åŒ– NameNode</span></span><br><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/NameNode%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96.png"></p>
<p>4ã€æ¥ç€æ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼Œå¼€å¯ NameNode å’Œ DataNode å®ˆæŠ¤è¿›ç¨‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># start-dfs.sh æ˜¯ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸­é—´æ²¡æœ‰ç©ºæ ¼</span></span><br><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure>

<p>è‹¥å‡ºç° SSH çš„æç¤º <code>Are you sure you want to continue connecting</code>ï¼Œè¾“å…¥ <code>yes</code> å³å¯ã€‚æœ€ç»ˆå‡ºç°å¦‚ä¸‹ç”»é¢ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%BC%80%E5%90%AF%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E6%88%90%E5%8A%9F.png"></p>
<p>å‡å¦‚å‡ºç°ä»¥ä¸‹å¼‚å¸¸è¯·å‚è€ƒï¼š<a href="https://www.bilibili.com/read/cv16023845/">è§£å†³Hadoopä¼ªåˆ†å¸ƒå¼ä¸­localhost: ERROR: JAVA_HOME is not set and could not be found)</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/JavaHome%E6%89%BE%E4%B8%8D%E5%88%B0.png"></p>
<p>å¯åŠ¨å®Œæˆåï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ <code>jps</code> æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸå¯åŠ¨ï¼Œè‹¥æˆåŠŸå¯åŠ¨åˆ™ä¼šåˆ—å‡ºå¦‚ä¸‹è¿›ç¨‹ï¼š â€œNameNodeâ€ã€â€DataNodeâ€å’ŒSecondaryNameNode(å¦‚æœ SecondaryNameNode æ²¡æœ‰å¯åŠ¨ï¼Œè¯·è¿è¡Œ <code>stop-dfs.sh</code> å…³é—­è¿›ç¨‹ï¼Œç„¶åå†æ¬¡å°è¯•å¯åŠ¨å°è¯•)ã€‚å¦‚æœæ²¡æœ‰ NameNode æˆ– DataNode ï¼Œé‚£å°±æ˜¯é…ç½®ä¸æˆåŠŸï¼Œè¯·ä»”ç»†æ£€æŸ¥ä¹‹å‰æ­¥éª¤ï¼Œæˆ–é€šè¿‡æŸ¥çœ‹å¯åŠ¨æ—¥å¿—æ’æŸ¥åŸå› ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ¤æ–­æ˜¯å¦æˆåŠŸå¯åŠ¨</span></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hadoop%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E6%88%90%E5%8A%9F.png"></p>
<p>æˆåŠŸå¯åŠ¨åï¼Œå¯ä»¥è®¿é—® Web ç•Œé¢æŸ¥çœ‹ HDFS çš„ NameNode çŠ¶æ€ï¼Œå¯ä»¥åœ¨çº¿æŸ¥çœ‹ HDFS ä¸­çš„æ–‡ä»¶ã€‚</p>
<p><font color="red">PSï¼šè®¿é—® WEB ç•Œé¢æ—¶ï¼Œhadoop 3.x ä»¥ä¸‹ç‰ˆæœ¬çš„ç«¯å£ä¸º <code>50070</code>ï¼Œhadoop 3.x ä»¥ä¸Šç‰ˆæœ¬çš„ç«¯å£ä¸º <code>9870</code>ã€‚ä¸€å®šè¦ä½¿ç”¨ç›¸åº”çš„ç‰ˆæœ¬è®¿é—®ç›¸åº”çš„ç«¯å£ï¼Œä¸ç„¶è®¿é—®ä¸æˆåŠŸï¼ï¼ï¼ï¼</font>ğŸ˜±ğŸ˜±ğŸ˜±</p>
<p>å…¶å®åœ¨æœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä¹Ÿä¸çŸ¥é“ hadoop 3.x ä»¥ä¸Šç‰ˆæœ¬çš„ç«¯å£å·å‘ç”Ÿäº†å˜åŒ–ğŸ˜­ï¼Œè€Œæˆ‘è‡ªå·±å®‰è£…çš„ hadoop ç‰ˆæœ¬ä¸º 3.1.3ï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘è®¿é—® 50070 ç«¯å£æ—¶è‚¯å®šæ˜¯å¤±è´¥çš„ğŸ˜«ã€‚åœ¨ç½‘ä¸Šè¿›è¡ŒæŸ¥é˜…ï¼Œå‘ç°ç½‘ä¸Šæè¿°å‡ºç°è¿™ä¸ªæƒ…å†µçš„åŸå› æ— éä»¥ä¸‹å‡ ç‚¹ï¼šé˜²ç«å¢™æ²¡å…³é—­ï¼›ç«¯å£è¢«å ç”¨ï¼›$HADOOP_HOME&#x2F;etc&#x2F;hadoop ä¸‹çš„ core-site.xml å’Œ hdfs-site.xml æ²¡æœ‰é…ç½®å¥½ã€‚æˆ‘ä¹Ÿæ ¹æ®è¿™äº›é—®é¢˜ä¸€ä¸€è¿›è¡Œæ’æŸ¥ï¼Œå°½ç®¡æ²¡æœ‰å‡ºç°ä»¥ä¸Šé—®é¢˜ç»“æœè¿˜æ˜¯è®¿é—®ä¸äº†ï¼Œäºæ˜¯æˆ‘ç™¾æ€ä¸å¾—å…¶è§£ï¼Œè·‘å» Hadoop å®˜ç½‘æŸ¥çœ‹é»˜è®¤é…ç½®é¡¹æ‰å‘ç°ç«¯å£å·å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/NameNode%20Web%20UI%E7%9B%91%E5%90%AC%E7%9A%84%E5%9C%B0%E5%9D%80%E5%92%8C%E5%9F%BA%E7%AB%AF%E5%8F%A3.png"></p>
<p>åœ¨Hadoopä¸­ï¼Œ<code>dfs.namenode.http-address</code> æ˜¯é…ç½®å‚æ•°ï¼Œç”¨äºæŒ‡å®š NameNode Web UI ç›‘å¬çš„åœ°å€å’ŒåŸºç«¯å£ã€‚è¿™ä¸ª Web UI æä¾›äº†å…³äº HDFS é›†ç¾¤çŠ¶æ€ã€é…ç½®ã€ä»¥åŠæ–‡ä»¶æµè§ˆç­‰ä¿¡æ¯çš„å¯è§†åŒ–ç•Œé¢ã€‚</p>
<p>å‘ç°ç«¯å£å‘ç”Ÿæ”¹å˜åæˆ‘å»ç½‘ä¸ŠæŸ¥é˜…ï¼Œæœ€åæ‰çŸ¥é“ hadoop 3.x ä»¥ä¸‹ç‰ˆæœ¬çš„ç«¯å£ä¸º <code>50070</code>ï¼Œhadoop 3.x ä»¥ä¸Šç‰ˆæœ¬çš„ç«¯å£å˜åŒ–ä¸ºäº† <code>9870</code>ã€‚</p>
<p>æœ€åå°†Hadoop å®˜ç½‘æŸ¥çœ‹é»˜è®¤é…ç½®é¡¹é“¾æ¥æ”¾åœ¨è¿™å„¿ï¼š<a href="https://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html">Apache Hadoop 3.4.0 â€“ MapReduce Tutorial</a> ã€‚å¤§å®¶æ‰“å¼€åä¸‹æ‹‰åœ¨å·¦ä¸‹è§’æ‰¾åˆ° <code>Configuration</code> ç„¶åç‚¹å‡» <code>hdfs-site.xml</code> è¿›å…¥é¡µé¢åœ¨ <code>dfs.namenode.http-address</code> é…ç½®å‚æ•°å°±å¯ä»¥æŸ¥çœ‹åˆ°ç«¯å£ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hadoop%E7%9A%84Configurationp.png"></p>
<p>ä¸¤ç§è®¿é—®æ–¹å¼ï¼š</p>
<ul>
<li>è™šæ‹Ÿæœºè®¿é—®</li>
<li>æœ¬æœºè®¿é—®</li>
</ul>
<p><strong>ç¬¬ä¸€ç§ï¼šè™šæ‹Ÿæœºè®¿é—®</strong></p>
<p><font color="red">PSï¼šéœ€è¦ç›´æ¥æ“ä½œè™šæ‹Ÿæœºï¼Œä¸èƒ½åœ¨è¿œç¨‹è¿æ¥å·¥å…·æ“ä½œï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</font>ğŸ˜…</p>
<p>CentOS è‡ªå¸¦æœ‰ Firefox æµè§ˆå™¨ï¼Œä¸è¿‡ä¸€èˆ¬æ¯”è¾ƒæ—§ï¼Œæœ‰å¾ˆå¤šå…¼å®¹æ€§é—®é¢˜ï¼Œå¯ä»¥å…ˆå¸è½½æ‰å†å®‰è£…æ–°ç‰ˆçš„ Firefox ï¼Œå®‰è£…æˆåŠŸåå†æŸ¥çœ‹ç‰ˆæœ¬ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¸è½½ Firefox</span></span><br><span class="line">sudo yum -y remove firefox</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Firefox</span></span><br><span class="line">sudo yum -y install firefox</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰ˆæœ¬</span></span><br><span class="line">firefox -version</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ Firefox ç‰ˆæœ¬ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8BFirefox%E7%89%88%E6%9C%AC.png"></p>
<p>è¾“å…¥å‘½ä»¤ç›´æ¥æ‰“å¼€ Firefox æµè§ˆå™¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€ Firefox æµè§ˆå™¨</span></span><br><span class="line">firefox</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%88%90%E5%8A%9F%E6%89%93%E5%BC%80Firefox.png" style="zoom:50%;">

<p>æµè§ˆå™¨è¾“å…¥ <a href="http://localhost:9870/">http://localhost:9870</a> æˆåŠŸè®¿é—®åˆ° Web ç•Œé¢ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/CentOS%E6%9F%A5%E7%9C%8BHDFS.png" style="zoom:50%;">

<p><strong>ç¬¬äºŒç§ï¼šæœ¬æœºè®¿é—®</strong></p>
<p><font color="red">PSï¼šæœ¬æœºè®¿é—®éœ€è¦å…³é—­è™šæ‹Ÿæœºé˜²ç«å¢™ï¼Œä¸ç„¶è®¿é—®ä¸äº†ã€‚</font>(è‡ªå·±è™šæ‹Ÿæœºçš„é˜²ç«å¢™æ— æ‰€è°“éšä¾¿å…³é—­ï¼ŒçœŸå®çš„ç¯å¢ƒä¸­<del>ä¸å»ºè®®</del><font color="red">ç»å¯¹ä¸èƒ½</font>è¿™æ ·åšï¼ŒçœŸå®çš„ç¯å¢ƒä¸€èˆ¬æ˜¯å¼€æ”¾æŒ‡å®šç«¯å£)ğŸ˜¶</p>
<p>é¦–å…ˆæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ã€‚å‡ºç°ç»¿è‰² <code>Activeï¼šactive (running)</code> è¡¨ç¤ºå¼€å¯ï¼Œå‡ºç°ç™½è‰² <code>Activeï¼šinactive (dead)</code> è¡¨ç¤ºå…³é—­ã€‚ç„¶åè‡ªè¡Œå¯¹å…¶è¿›è¡Œè®¾ç½®ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span></span><br><span class="line">systemctl status firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯é˜²ç«å¢™ </span></span><br><span class="line">sudo systemctl start firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­é˜²ç«å¢™ </span></span><br><span class="line">sudo systemctl stop firewalld</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ‰“å¼€æœ¬æœºæµè§ˆå™¨è¾“å…¥ <a href="http://192.168.88.131:9870/">http://192.168.88.131:9870/</a> æˆåŠŸè®¿é—®åˆ° Web ç•Œé¢ã€‚<font color="red">PSï¼šè¿™é‡Œçš„ 192.168.88.131 æ˜¯è™šæ‹Ÿæœº ip åœ°å€ã€‚</font></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9C%AC%E6%9C%BA%E6%9F%A5%E7%9C%8BHDFS.png" style="zoom: 50%;">

<p><strong>PSï¼šåœ¨å¯åŠ¨ Hadoop çš„æ—¶å€™å¦‚æœå·²æœ‰ Hadoop èŠ‚ç‚¹åœ¨è¿è¡Œï¼Œè¦å…ˆå…³é—­æ‰€æœ‰ Hadoop æœåŠ¡å†å¯åŠ¨ã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…³é—­ Hadoop</span></span><br><span class="line">stop-dfs.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯ Hadoop</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸Šé¢ä¸¤å¥æ“çºµä¹Ÿæ˜¯å…³é—­å’Œå¼€å¯hadoopæ“ä½œ</span></span><br></pre></td></tr></table></figure>

<h2 id="2-5-è¿è¡Œ-Hadoop-ä¼ªåˆ†å¸ƒå¼å®ä¾‹"><a href="#2-5-è¿è¡Œ-Hadoop-ä¼ªåˆ†å¸ƒå¼å®ä¾‹" class="headerlink" title="2.5 è¿è¡Œ Hadoop ä¼ªåˆ†å¸ƒå¼å®ä¾‹"></a>2.5 è¿è¡Œ Hadoop ä¼ªåˆ†å¸ƒå¼å®ä¾‹</h2><p>ä¸Šé¢çš„å•æœºæ¨¡å¼ï¼Œgrep ä¾‹å­è¯»å–çš„æ˜¯æœ¬åœ°æ•°æ®ï¼Œä¼ªåˆ†å¸ƒå¼è¯»å–çš„åˆ™æ˜¯ HDFS ä¸Šçš„æ•°æ®ã€‚è¦ä½¿ç”¨ HDFSï¼Œé¦–å…ˆéœ€è¦åœ¨ HDFS ä¸­åˆ›å»ºç”¨æˆ·ç›®å½•(ç”¨æˆ·åç›®å½•åå¯ä»¥éšæ„è¾“å…¥ï¼Œæˆ‘è¿™é‡Œè¾“å…¥çš„æ˜¯ muyoukule )ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ° /usr/local/hadoop-3.1.3</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ HDFS ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º muyoukule çš„ç›®å½•ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ /user ç›®å½•ä¸‹</span></span><br><span class="line">hdfs dfs -<span class="built_in">mkdir</span> -p /user/muyoukule</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡º HDFS ä¸Š /user ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> /user</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡º HDFS ä¸Š /user/muyoukule ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> /user/muyoukule</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºæˆåŠŸåå¯ä»¥åœ¨ &#x2F;user ç›®å½•ä¸‹æŸ¥çœ‹åˆ°ç”¨æˆ·ç›®å½•ï¼ŒæŸ¥çœ‹ç”¨æˆ·ç›®å½•åº”è¯¥ä¸ºç©ºï¼Œå› ä¸ºç›®å½•ä¸‹æ²¡æœ‰å†…å®¹ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HDFS%E4%B8%AD%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E7%9B%AE%E5%BD%95.png"></p>
<p>æ¥ç€å°† <code>./etc/hadoop</code> ä¸­çš„ xml æ–‡ä»¶ä½œä¸ºè¾“å…¥æ–‡ä»¶å¤åˆ¶åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå³å°† <code>/usr/local/hadoop-3.1.3/etc/hadoop</code> å¤åˆ¶åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„ <code>/user/muyoukule/input</code> ä¸­ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ muyoukuleç”¨æˆ·ï¼Œå¹¶ä¸”å·²åˆ›å»ºç›¸åº”çš„ç”¨æˆ·ç›®å½• <code>/user/muyoukule</code>ï¼Œå› æ­¤åœ¨å‘½ä»¤ä¸­å°±å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¦‚ inputï¼Œå…¶å¯¹åº”çš„ç»å¯¹è·¯å¾„å°±æ˜¯ <code>/user/muyoukule/input</code>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨ HDFS ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º input çš„ç›®å½•</span></span><br><span class="line">hdfs dfs -<span class="built_in">mkdir</span> input</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Š ./etc/hadoop/ ç›®å½•ä¸‹æ‰€æœ‰çš„ .xml æ–‡ä»¶ä¸Šä¼ åˆ° HDFS çš„ input ç›®å½•ä¸­</span></span><br><span class="line">hdfs dfs -put ./etc/hadoop/*.xml input</span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶å®Œæˆåï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">ls</span> input</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HDFS%E4%B8%8Binput%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8.png"></p>
<p>ä¼ªåˆ†å¸ƒå¼è¿è¡Œ MapReduce ä½œä¸šçš„æ–¹å¼è·Ÿå•æœºæ¨¡å¼ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºä¼ªåˆ†å¸ƒå¼è¯»å–çš„æ˜¯ HDFS ä¸­çš„æ–‡ä»¶(å¯ä»¥å°†å•æœºæ­¥éª¤ä¸­åˆ›å»ºçš„æœ¬åœ° input æ–‡ä»¶å¤¹ï¼Œè¾“å‡ºç»“æœ output æ–‡ä»¶å¤¹éƒ½åˆ æ‰æ¥éªŒè¯è¿™ä¸€ç‚¹)ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œä¸€ä¸ª MapReduce ä½œä¸šï¼Œè¯¥ä½œä¸šä½¿ç”¨ Hadoop è‡ªå¸¦çš„ grep ç¤ºä¾‹ç¨‹åºæ¥æœç´¢ input ç›®å½•ä¸­åŒ¹é…ç»™å®šæ¨¡å¼çš„è¡Œï¼Œå¹¶å°†ç»“æœå†™å…¥ output ç›®å½•</span></span><br><span class="line">hadoop jar ./share/hadoop/mapreduce/hadoop-mapreduce-examples-*.jar grep input output <span class="string">&#x27;dfs[a-z.]+&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹è¿è¡Œç»“æœçš„å‘½ä»¤(æŸ¥çœ‹çš„æ˜¯ä½äº HDFS ä¸­çš„è¾“å‡ºç»“æœ)ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">cat</span> output/*</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°ï¼š<code>INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false</code> è¡¨ç¤ºSASLæ•°æ®ä¼ è¾“å®¢æˆ·ç«¯åœ¨è¿›è¡ŒåŠ å¯†ä¿¡ä»»æ£€æŸ¥æ—¶ï¼Œå‘ç°æœ¬åœ°ä¸»æœº(localHost)å’Œè¿œç¨‹ä¸»æœº(remoteHost)éƒ½æ²¡æœ‰è¢«ä¿¡ä»»ã€‚å¯ä»¥ä¸ç”¨ç®¡å®ƒã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HDFS%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png"></p>
<p>å°†è¿è¡Œç»“æœå–å›åˆ°æœ¬åœ°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ output ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹(å¦‚æœå­˜åœ¨)</span></span><br><span class="line"><span class="built_in">rm</span> -r ./output</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä» HDFS ä¸Šçš„ output ç›®å½•å¤åˆ¶æ–‡ä»¶åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ output ç›®å½•</span></span><br><span class="line">hdfs dfs -get output ./output</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæœ¬åœ° output ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line"><span class="built_in">cat</span> ./output/*</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HDFS%E7%BB%93%E6%9E%9C%E5%8F%96%E5%9B%9E%E5%88%B0%E6%9C%AC%E5%9C%B0.png"></p>
<p>Hadoop è¿è¡Œç¨‹åºæ—¶ï¼Œè¾“å‡ºç›®å½•ä¸èƒ½å­˜åœ¨ï¼Œå¦åˆ™ä¼šæç¤ºé”™è¯¯ï¼Œå› æ­¤è‹¥è¦å†æ¬¡æ‰§è¡Œï¼Œéœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ é™¤ output æ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤ HDFS ä¸Šçš„ output ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹</span></span><br><span class="line">hdfs dfs -<span class="built_in">rm</span> -r output</span><br></pre></td></tr></table></figure>

<p>è‹¥è¦å…³é—­ Hadoopï¼Œåˆ™è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stop-dfs.sh</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%85%B3%E9%97%ADHadoop.png"></p>
<p>æ³¨æ„ï¼šä¸‹æ¬¡å¯åŠ¨ Hadoop æ—¶ï¼Œæ— éœ€è¿›è¡Œ NameNode çš„åˆå§‹åŒ–ï¼Œåªéœ€è¦è¿è¡Œ <code>start-dfs.sh</code> å°±å¯ä»¥ï¼</p>
<h2 id="2-6-å¯åŠ¨-YARN"><a href="#2-6-å¯åŠ¨-YARN" class="headerlink" title="2.6 å¯åŠ¨ YARN"></a>2.6 å¯åŠ¨ YARN</h2><p><strong>PSï¼šä¼ªåˆ†å¸ƒå¼ä¸å¯åŠ¨ YARN ä¹Ÿå¯ä»¥ï¼Œä¸€èˆ¬ä¸ä¼šå½±å“ç¨‹åºæ‰§è¡Œã€‚</strong></p>
<p>YARN æ˜¯ä» MapReduce ä¸­åˆ†ç¦»å‡ºæ¥çš„ï¼Œè´Ÿè´£èµ„æºç®¡ç†ä¸ä»»åŠ¡è°ƒåº¦ã€‚YARN è¿è¡Œäº MapReduce ä¹‹ä¸Šï¼Œæä¾›äº†é«˜å¯ç”¨æ€§ã€é«˜æ‰©å±•æ€§ï¼ŒYARN çš„æ›´å¤šä»‹ç»åœ¨æ­¤ä¸å±•å¼€ï¼Œæœ‰å…´è¶£çš„å¯æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚</p>
<p>ä¸Šè¿°é€šè¿‡ <code>start-dfs.sh</code> å¯åŠ¨ Hadoopï¼Œä»…ä»…æ˜¯å¯åŠ¨äº† MapReduce ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨ YARN ï¼Œè®© YARN æ¥è´Ÿè´£èµ„æºç®¡ç†ä¸ä»»åŠ¡è°ƒåº¦ã€‚</p>
<p>1ã€ä¿®æ”¹ yarn-site.xml æ–‡ä»¶ï¼ŒåŒæ ·ä½¿ç”¨ gedit ç¼–è¾‘ä¼šæ¯”è¾ƒæ–¹ä¾¿äº›ã€‚( gedit ç¼–è¾‘å™¨ä½¿ç”¨æ–¹æ³•è¯·å‚ç…§ä¸Šæ–‡ <strong>Hadoop ä¼ªåˆ†å¸ƒå¼é…ç½®</strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ° /usr/local/hadoop-3.1.3</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ yarn-site.xml æ–‡ä»¶</span></span><br><span class="line">gedit ./etc/hadoop/yarn-site.xml</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸ºå¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€ä¿®æ”¹ mapred-site.xml æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦ä» mapred-site.xml.template å¤åˆ¶ä¸€ä»½ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€ mapred-site.xml æ–‡ä»¶</span></span><br><span class="line">gedit ./etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€å¯åŠ¨YARNæœåŠ¡ï¼Œ(éœ€è¦å…ˆæ‰§è¡Œè¿‡ <code>start-dfs.sh</code>)ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨YARN</span></span><br><span class="line">start-yarn.sh</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%90%AF%E5%8A%A8YARN%E6%9C%8D%E5%8A%A1.png"></p>
<p>4ã€éªŒè¯æ˜¯å¦å¯åŠ¨æˆåŠŸ</p>
<p>æ–¹å¼ä¸€ï¼šæ‰§è¡Œ <code>jps</code> å‘½ä»¤æŸ¥çœ‹ NodeManager å’Œ ResourceManager æœåŠ¡æ˜¯å¦å·²ç»å¯åŠ¨ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%90%AF%E5%8A%A8YARN%E6%9C%8D%E5%8A%A1%E6%88%90%E5%8A%9F.png"></p>
<p>æ–¹å¼äºŒï¼šè™šæ‹Ÿæœºæµè§ˆå™¨è¾“å…¥ <a href="http://localhost:8088/">http://localhost:8088</a> æˆåŠŸè®¿é—®åˆ° Web ç•Œé¢ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/CentOS%E6%9F%A5%E7%9C%8BYARN.png" style="zoom:50%;">

<p>ä½† YARN ä¸»è¦æ˜¯ä¸ºé›†ç¾¤æä¾›æ›´å¥½çš„èµ„æºç®¡ç†ä¸ä»»åŠ¡è°ƒåº¦ï¼Œç„¶è€Œè¿™åœ¨å•æœºä¸Šä½“ç°ä¸å‡ºä»·å€¼ï¼Œåè€Œä¼šä½¿ç¨‹åºè·‘å¾—ç¨æ…¢äº›ã€‚å› æ­¤åœ¨å•æœºä¸Šæ˜¯å¦å¼€å¯ YARN å°±çœ‹å®é™…æƒ…å†µäº†ã€‚</p>
<blockquote>
<p>ä¸å¯åŠ¨ YARN éœ€é‡å‘½å mapred-site.xml</p>
</blockquote>
<p>å¦‚æœä¸æƒ³å¯åŠ¨ YARNï¼ŒåŠ¡å¿…æŠŠé…ç½®æ–‡ä»¶ <strong>mapred-site.xml</strong> é‡å‘½åï¼Œæ”¹æˆ mapred-site.xml.templateï¼Œéœ€è¦ç”¨æ—¶æ”¹å›æ¥å°±è¡Œã€‚å¦åˆ™åœ¨è¯¥é…ç½®æ–‡ä»¶å­˜åœ¨ï¼Œè€Œæœªå¼€å¯ YARN çš„æƒ…å†µä¸‹ï¼Œè¿è¡Œç¨‹åºä¼šæç¤º â€œRetrying connect to server: 0.0.0.0&#x2F;0.0.0.0:8032â€ çš„é”™è¯¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é‡å‘½å</span></span><br><span class="line"><span class="built_in">mv</span> ./etc/hadoop/mapred-site.xml ./etc/hadoop/mapred-site.xml.template</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ï¼Œå…³é—­ YARN çš„è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…³é—­ YARN</span></span><br><span class="line">stop-yarn.sh</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œä½ å·²ç»æŒæ¡ Hadoop çš„é…ç½®å’ŒåŸºæœ¬ä½¿ç”¨äº†ã€‚</p>
<h2 id="2-7-Hadoop-é›†ç¾¤é…ç½®"><a href="#2-7-Hadoop-é›†ç¾¤é…ç½®" class="headerlink" title="2.7 Hadoop é›†ç¾¤é…ç½®"></a>2.7 Hadoop é›†ç¾¤é…ç½®</h2><p>ä¼ªåˆ†å¸ƒå¼é…ç½®ä¸»è¦ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒï¼Œå› ä¸ºå®ƒå°† NameNode å’Œ DataNode æ”¾åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå¯èƒ½æ— æ³•å……åˆ†åˆ©ç”¨å¤šèŠ‚ç‚¹çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨å®Œå…¨åˆ†å¸ƒå¼é…ç½®ï¼Œä»¥åˆ©ç”¨é›†ç¾¤ä¸­å¤šå°æœºå™¨çš„è®¡ç®—å’Œå­˜å‚¨èƒ½åŠ›ã€‚</p>
<p>é…ç½®å®‰è£…é›†ç¾¤åŒ–è½¯ä»¶ï¼Œé¦–è¦æ¡ä»¶å°±æ˜¯è¦æœ‰å¤šå°LinuxæœåŠ¡å™¨å¯ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ VMware æä¾›çš„å…‹éš†åŠŸèƒ½ï¼ŒåŸºäºä¸€å°è™šæ‹Ÿæœºå»å…‹éš†åˆ›å»ºå¤šå°è™šæ‹Ÿæœºï¼Œæ‰€ä»¥è¿™å¯¹ç”µè„‘é…ç½®è¦æ±‚å¾ˆé«˜(è‡³å°‘æœ‰ <strong>8G</strong> è¿è¡Œå†…å­˜å’Œ <strong>512G</strong> å­˜å‚¨å®¹é‡)ã€‚ä½†æ˜¯ç”±äºæˆ‘çš„ç”µè„‘å‰©ä½™å­˜å‚¨ç©ºé—´å®¹é‡æœ‰é™â€¦â€¦ğŸ˜­ğŸ˜­ğŸ˜­ä¸”åœ¨æ­¤å®éªŒæ¡ˆä¾‹æ•™ç¨‹åç»­è¿˜æ¶‰åŠå¾ˆå¤šè½¯ä»¶çš„å®‰è£…ï¼Œæ‰€ä»¥æˆ‘çš„ç”µè„‘å·²ç»ä¸å†æ”¯æŒæˆ‘é…ç½®å®‰è£…é›†ç¾¤åŒ–è½¯ä»¶ã€‚ä½†æ˜¯å¦‚æœä½ <del>å¯¹Hadoop é›†ç¾¤é…ç½®æ„Ÿå…´è¶£</del>ç”µè„‘è¿è¡Œå†…å­˜å’Œå‰©ä½™å­˜å‚¨å®¹é‡è¶³å¤Ÿå¤§ï¼Œä¸å¦¨å¯ä»¥è‡ªå·±åœ¨ç½‘ä¸Šæ‰¾æ‰¾æ•™ç¨‹åŠ¨æ‰‹è¯•è¯•ã€‚ğŸ˜„</p>
<h1 id="3-MySQL"><a href="#3-MySQL" class="headerlink" title="3. MySQL"></a>3. MySQL</h1><p>MySQL æ˜¯ä¸€ä¸ªå¼€æºçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå®ƒä½¿ç”¨ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€(SQL)è¿›è¡Œæ•°æ®åº“ç®¡ç†ã€‚MySQL å…·æœ‰é«˜å¯é æ€§ã€é«˜æ€§èƒ½ã€æ˜“ç”¨æ€§å’Œçµæ´»æ€§ç­‰ç‰¹ç‚¹ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡æ•°æ®ï¼Œå¹¶æ”¯æŒå¤šç§å­˜å‚¨å¼•æ“ä»¥æ»¡è¶³ä¸åŒåº”ç”¨éœ€æ±‚ã€‚å®ƒå¹¿æ³›åº”ç”¨äºå„ç±»ç½‘ç«™ã€åº”ç”¨åŠä¼ä¸šçº§ç³»ç»Ÿä¸­ï¼Œæ˜¯ä¼—å¤šå¼€å‘è€…å’Œä¼ä¸šçš„é¦–é€‰æ•°æ®åº“è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ MySQLï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå®ç°é«˜æ•ˆçš„æ•°æ®ç®¡ç†ã€‚</p>
<h2 id="3-1-MySQL-ä¸‹è½½ä¸å®‰è£…"><a href="#3-1-MySQL-ä¸‹è½½ä¸å®‰è£…" class="headerlink" title="3.1 MySQL ä¸‹è½½ä¸å®‰è£…"></a>3.1 MySQL ä¸‹è½½ä¸å®‰è£…</h2><p>å…³äºå®‰è£… MySQLçš„æ–¹å¼æœ‰å¾ˆå¤šè¿™é‡Œåªç¤ºä¾‹å…¶ä¸­ä¸€ç§ï¼š<strong>ä½¿ç”¨ yum å®‰è£…ã€‚</strong></p>
<p>yum å®‰è£…æ–¹å¼è‡ªåŠ¨å¤„ç†ä¾èµ–ã€ç®€åŒ–å®‰è£…è¿‡ç¨‹ã€æä¾›ç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ä¸”æ˜“äºç®¡ç†å’Œç»´æŠ¤ï¼Œé€‚åˆå¤§å¤šæ•°ç”¨æˆ·ã€‚å®Œå…¨å¯ä»¥æ»¡è¶³æœ¬æ¡ˆä¾‹éœ€æ±‚ã€‚</p>
<p>1ã€é¦–å…ˆæ‰“å¼€ <a href="https://dev.mysql.com/downloads/repo/yum/">MySQL Yum Repository</a> </p>
<p>æ‰“å¼€åæ ¹æ®ä½ æœåŠ¡å™¨çš„é…ç½®é€‰æ‹©ï¼Œæˆ‘æœåŠ¡å™¨æ˜¯ CentOS7 æ‰€ä»¥é€‰æ‹© <code>Red Hat Enterprise Linux 7 / Oracle Linux 7 (Architecture Independent), RPM Package</code> ï¼Œç„¶åç‚¹å‡» <code>Download</code> ä¸‹è½½è¿›å…¥ä¸‹è½½é¡µé¢ï¼Œè¿›å…¥é¡µé¢åé¼ æ ‡å…‰æ ‡å®šä½åˆ° <code>No thanks, just start my download.</code> å³é”®ç‚¹å‡» <code>å¤åˆ¶é“¾æ¥</code> (<a href="https://dev.mysql.com/get/mysql80-community-release-el7-11.noarch.rpm)%E3%80%82">https://dev.mysql.com/get/mysql80-community-release-el7-11.noarch.rpm)ã€‚</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/yum%E5%AE%89%E8%A3%85MySQL(1).png" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/yum%E5%AE%89%E8%A3%85MySQL(2).png" style="zoom: 50%;">

<p>2ã€å®‰è£…å‰éœ€è¦å¯¹ç³»ç»Ÿè¿›è¡Œæ£€æŸ¥ï¼š</p>
<p>RPM(Red-Hat Package Manager)æ˜¯è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œæ˜¯çº¢å¸½ Linux ç”¨äºç®¡ç†å’Œå®‰è£…è½¯ä»¶çš„å·¥å…·ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœå½“å‰ç³»ç»Ÿå·²ç»å®‰è£…è¿‡ Mysql æ•°æ®åº“å®‰è£…å°†å¤±è´¥ã€‚CentOS è‡ªå¸¦ mariadbï¼Œä¸ Mysql æ•°æ®åº“å†²çªã€‚</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦å®‰è£…äº†MySQL</span></span><br><span class="line">sudo rpm -qa | grep mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦å®‰è£…äº†mariadb</span></span><br><span class="line">sudo rpm -qa | grep mariadb</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¦‚æœæœ‰ï¼Œå°†å…¶å¸è½½</span></span><br><span class="line">sudo rpm -e --nodeps &lt;è½¯ä»¶åŒ…å&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/MySQL%E5%AE%89%E8%A3%85%E5%89%8D%E6%A3%80%E6%9F%A5.png"></p>
<p>3ã€å¼€å§‹å®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ›´æ–°å¯†é’¥</span></span><br><span class="line">sudo rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£… MySQL yum åº“ é“¾æ¥æ˜¯åˆšåˆšåœ¨Yum Repositoryå¤åˆ¶çš„</span></span><br><span class="line">sudo rpm -Uvh https://dev.mysql.com/get/mysql80-community-release-el7-11.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>4ã€é€‰æ‹©è¦å®‰è£…çš„ MySQL ç‰ˆæœ¬ï¼š</p>
<p>æ·»åŠ å®Œ yum æºä¹‹åï¼Œå¦‚æœä»€ä¹ˆéƒ½ä¸åšç›´æ¥å®‰è£…çš„è¯ï¼Œä¼šé»˜è®¤å®‰è£…æœ€æ–°çš„ MySQL ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ mysql8.0 çš„æœ€æ–°å‘è¡Œç‰ˆã€‚å¤§å®¶å¯ä»¥è‡ªè¡Œè¿›è¡Œé€‰æ‹©ã€‚æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ <code>mysql5.7</code> ï¼Œæ‰€ä»¥è¦æ”¹ä¸€ä¸‹é…ç½®(<strong>æƒ³ç›´æ¥è£…æœ€æ–°ç‰ˆæœ¬çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥</strong>)ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å½“å‰ mysql yum æºä¸‹å“ªäº›å­æºå¯ç”¨(ä¸åŒçš„ mysql ç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„å­ä»“åº“</span></span><br><span class="line">yum repolist all | grep mysql</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/mysql%20yum%E6%BA%90.png" style="zoom:67%;">

<p>å¯ä»¥çœ‹åˆ°é»˜è®¤å¼€å¯çš„æ˜¯ mysql8.0 çš„ä»“åº“ã€‚</p>
<p>å¼€å¯ 5.7ï¼Œç¦ç”¨ 8.0 æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ç”¨å‘½ä»¤ä¿®æ”¹ <code>/etc/yum.repos.d/mysql-community.repo</code> æ–‡ä»¶ã€‚å¦ä¸€ä¸ªæ˜¯åƒä¸‹é¢è¿™æ ·ä½¿ç”¨å‘½ä»¤ç›´æ¥ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¦ç”¨åä¸º mysql80-community çš„è½¯ä»¶ä»“åº“</span></span><br><span class="line">sudo yum-config-manager --<span class="built_in">disable</span> mysql80-community</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨åä¸º mysql57-community çš„è½¯ä»¶ä»“åº“</span></span><br><span class="line">sudo yum-config-manager --<span class="built_in">enable</span> mysql57-community</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†æ‰§è¡ŒæŸ¥çœ‹è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ° mysql 5.7 å·²ç»å¯ç”¨äº†ï¼Œ8.0 å·²ç»ç¦ç”¨äº†ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/mysql%205.7%E5%90%AF%E7%94%A8.png" style="zoom:67%;">

<p>5ã€å®‰è£… MySQL</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># yum å®‰è£… mysql-community-server è¿™ä¸ªåŒ…</span></span><br><span class="line">sudo yum -y install mysql-community-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld   </span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºå¯åŠ¨(å¯ä¸è®¾ç½®)</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æŸ¥ MySQL æœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld</span><br></pre></td></tr></table></figure>

<p>å‡ºç° <code>Activeï¼šactive(running)</code> ä»£è¡¨ MySQL å¯åŠ¨æˆåŠŸã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/MySQL%E5%90%AF%E5%8A%A8%E6%88%90%E5%8A%9F.png"></p>
<p>6ã€ç™»å½• MySQL</p>
<p>æŸ¥çœ‹é»˜è®¤å¯†ç ï¼šç¬¬ä¸€æ¬¡å¯åŠ¨ MySQL ä¼šåœ¨æ—¥å¿—æ–‡ä»¶ &#x2F;var&#x2F;log&#x2F;mysqld.log ä¸­ç”Ÿæˆ root ç”¨æˆ·çš„ä¸€ä¸ªéšæœºå¯†ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¯†ç </span></span><br><span class="line">sudo <span class="built_in">cat</span> /var/log/mysqld.log | grep password</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/MySQL%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81.png"></p>
<p><strong>PSï¼šæ²¡æœ‰å‰é¢çš„ç©ºæ ¼ï¼Œæ¯”å¦‚æˆ‘å¯†ç çš„æ˜¯ <code>fcIVZvOBk9)r</code> ã€‚</strong></p>
<p>ç„¶åæ‰§è¡Œå‘½ä»¤ç™»å½• MySQL æ•°æ®åº“æœåŠ¡å™¨ï¼Œä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œè¾“å…¥å¯†ç æ—¶å¯†ç ä¸ä¼šæ˜¾ç¤ºï¼Œè¾“å…¥å®Œç›´æ¥ <code>Enter</code> å°±è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç™»å½•åˆ° MySQL æ•°æ®åº“æœåŠ¡å™¨</span><br><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%99%BB%E5%BD%95MySQL.png"></p>
<p>ç™»å½•åˆ° MySQL åå¯ä»¥æ‰§è¡Œä»¥ä¸‹ SQL è¯­å¥æŸ¥çœ‹æ•°æ®åº“ï¼Œä¸ä¸‹é¢ä¸€è‡´è¯´æ˜å®‰è£…æˆåŠŸã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ—å‡ºæœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æ•°æ®åº“</span><br><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93.png"></p>
<p>é€€å‡ºMySQLï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit	# æˆ–è€…å¿«æ·é”® Ctrl + d</span><br></pre></td></tr></table></figure>

<h2 id="3-2-å…³äº-MySQL-çš„è¡¥å……"><a href="#3-2-å…³äº-MySQL-çš„è¡¥å……" class="headerlink" title="3.2 å…³äº MySQL çš„è¡¥å……"></a>3.2 å…³äº MySQL çš„è¡¥å……</h2><h3 id="3-2-1-ä¿®æ”¹-root-ç”¨æˆ·å¯†ç "><a href="#3-2-1-ä¿®æ”¹-root-ç”¨æˆ·å¯†ç " class="headerlink" title="3.2.1 ä¿®æ”¹ root ç”¨æˆ·å¯†ç "></a>3.2.1 ä¿®æ”¹ root ç”¨æˆ·å¯†ç </h3><p>å¦‚æœä½ è§‰å¾— MySQL è‡ªåŠ¨ç”Ÿæˆçš„å¯†ç å¤ªéš¾è®°å¿†çš„è¯ï¼Œå¯ä»¥è¿æ¥ MySQL ä¹‹åè¿›è¡Œä¿®æ”¹å¯†ç ã€‚åœ¨ Linux ä¸Šå®‰è£… MySQL æ—¶ä¼šè‡ªåŠ¨å®‰è£…ä¸€ä¸ªæ ¡éªŒå¯†ç çš„æ’ä»¶ï¼Œé»˜è®¤å¯†ç æ£€æŸ¥ç­–ç•¥è¦æ±‚å¯†ç å¿…é¡»åŒ…å«ï¼šå¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·ï¼Œå¹¶ä¸”é•¿åº¦ä¸èƒ½å°‘äº8ä½ã€‚ä¿®æ”¹å¯†ç æ—¶æ–°å¯†ç æ˜¯å¦ç¬¦åˆå½“å‰çš„ç­–ç•¥ï¼Œä¸æ»¡è¶³åˆ™ä¼šæç¤ºERRORã€‚</p>
<p>å¦‚æœä½ æƒ³è®¾ç½®ç®€å•å¯†ç ï¼Œéœ€è¦é™ä½ MySQL çš„å¯†ç å®‰å…¨çº§åˆ«ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è®¾ç½®å¯†ç å®‰å…¨çº§åˆ«ä½</span><br><span class="line">set global validate_password_policy = 0;</span><br><span class="line">#å¯†ç é•¿åº¦æœ€ä½4ä½å³å¯</span><br><span class="line">set global validate_password_length = 4;</span><br><span class="line"></span><br><span class="line">#è®¾ç½®ç®€å•å¯†ç (è¿™é‡Œä½¿ç”¨ç®€å•å¯†ç æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼ŒçœŸå®ç¯å¢ƒä¸­ä¸è¦è¿™æ ·)</span><br><span class="line">ALTER USER &#x27;root &#x27;@&#x27;locaLhost&#x27; IDENTIFIED BY &#x27;root&#x27;;	#å‰é¢çš„ root ä¸ºç”¨æˆ·åï¼Œåé¢çš„ root æ˜¯å¯†ç </span><br></pre></td></tr></table></figure>

<p><font color="red">PSï¼šè‹¥åœ¨æ‰§è¡Œ <code>set global validate_password_policy = 0;</code> æ—¶æç¤º <code>You must reset your password using ALTER USER statement before executing this statement.</code> ä½ å¯ä»¥<strong>å…ˆ</strong>è®¾ç½®ä¸€ä¸ªæ»¡è¶³é»˜è®¤ç­–ç•¥çš„å¯†ç å¦‚ï¼š<code>@Root123456</code>Â ï¼Œæ›¿æ¢æ‰é»˜è®¤ç”Ÿæˆçš„å¯†ç ï¼Œä¹‹å<strong>å†</strong>è¿›è¡Œå¯†ç å®‰å…¨çº§åˆ«çš„é™ä½ï¼Œå°±å¯ä»¥æˆåŠŸäº†ã€‚</font></p>
<p><font color="red"><strong>å¦å¤–ï¼šå›  mysql çš„ç‰ˆæœ¬ä¸åŒè°ƒæ•´å¯†ç ç­–ç•¥çš„æ–¹æ³•ä¹Ÿä¸åŒï¼Œå…³äºæ›´å¤šçš„å¯†ç æ£€æŸ¥ç­–ç•¥è¯·å‚è€ƒ<a href="https://dev.mysql.com/doc/refman/8.3/en/">å®˜æ–¹æ–‡æ¡£</a>ã€‚</strong></font></p>
<p>åœ¨æ–‡æ¡£ä¸­å…ˆé€‰æ‹©å¯¹åº”ç‰ˆæœ¬å†æœç´¢ï¼š<code>validate_password</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AF%86%E7%A0%81%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99(1).png" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AF%86%E7%A0%81%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99(2).png" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AF%86%E7%A0%81%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99(3).png" style="zoom: 50%;">

<p>ä¸Šé¢è¿™ä¸ªå°±æ˜¯å¯†ç æ£€æŸ¥ç­–ç•¥äº†ã€‚</p>
<h3 id="3-2-2-åˆ›å»ºç”¨æˆ·ä¸æƒé™åˆ†é…"><a href="#3-2-2-åˆ›å»ºç”¨æˆ·ä¸æƒé™åˆ†é…" class="headerlink" title="3.2.2 åˆ›å»ºç”¨æˆ·ä¸æƒé™åˆ†é…"></a>3.2.2 åˆ›å»ºç”¨æˆ·ä¸æƒé™åˆ†é…</h3><p>é»˜è®¤çš„ root ç”¨æˆ·åªèƒ½å½“å‰èŠ‚ç‚¹ localhost è®¿é—®ï¼Œæ˜¯æ— æ³•è¿œç¨‹è®¿é—®çš„ã€‚</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦æˆ·ï¼Œç”¨äºè¿œç¨‹è®¿é—®ï¼Œæˆ–è€…ç›´æ¥ç»™ root ç”¨æˆ·æ·»åŠ æƒé™ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æˆäºˆæ¥è‡ªä»»ä½•ä¸»æœºçš„ root ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œæ‰€æœ‰è¡¨çš„æ‰€æœ‰æƒé™ï¼Œå¹¶å…è®¸å…¶å°†è¿™äº›æƒé™æˆäºˆå…¶ä»–ç”¨æˆ·ã€‚</span><br><span class="line">grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; with grant option;</span><br><span class="line"></span><br><span class="line"># åˆ·æ–° MySQL çš„æƒé™ï¼Œä½¿æ–°è®¾ç½®çš„æƒé™ç«‹å³ç”Ÿæ•ˆ</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>

<p>æˆæƒåå°±å¯ä»¥ä½¿ç”¨åœ¨æœ¬æœºä½¿ç”¨å›¾å½¢åŒ–å·¥å…·è¿œç¨‹è®¿é—®è™šæ‹Ÿæœºçš„ MySQL ã€‚(è¿™é‡Œä½¿ç”¨çš„æ˜¯ <code>Navicat</code> )</p>
<p>é¦–å…ˆæ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ï¼Œå…³é—­é˜²ç«å¢™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span></span><br><span class="line">systemctl status firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯é˜²ç«å¢™ </span></span><br><span class="line">sudo systemctl start firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­é˜²ç«å¢™ </span></span><br><span class="line">sudo systemctl stop firewalld</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ Navicat è¿›è¡Œæ“ä½œï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E8%99%9A%E6%8B%9F%E6%9C%BAMySQL(1).png" style="zoom: 50%;">

<p>åœ¨ Navicat ä¸Šçœ‹åˆ°çš„æ•°æ®åº“ä¸è™šæ‹Ÿæœºä¸€è‡´ï¼Œè¿œç¨‹è¿æ¥æˆåŠŸã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E8%99%9A%E6%8B%9F%E6%9C%BAMySQL(2).png" style="zoom:50%;">

<h1 id="4-HBase"><a href="#4-HBase" class="headerlink" title="4. HBase"></a>4. HBase</h1><p>HBase æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€é¢å‘åˆ—çš„å¼€æºæ•°æ®åº“ï¼ŒåŸºäº Hadoop æ„å»ºï¼Œä»¥ BigTable ä¸ºè®¾è®¡è“æœ¬ï¼Œå…·æœ‰é«˜å¯é æ€§ã€é«˜æ‰©å±•æ€§å’Œé«˜æ€§èƒ½ï¼Œé€‚ç”¨äºå­˜å‚¨å’Œå¤„ç†æµ·é‡éç»“æ„åŒ–åŠåŠç»“æ„åŒ–æ•°æ®ï¼Œå¹¿æ³›åº”ç”¨äºå¤§æ•°æ®åœºæ™¯ä¸‹çš„æ•°æ®å­˜å‚¨å’Œå®æ—¶åˆ†æã€‚</p>
<p>å¼€å¯ HBase éœ€è¦å…ˆå¼€å¯ Hadoopï¼Œè€Œå…³é—­ Hadoop å¿…é¡»å…ˆå…³é—­ HBaseï¼Œæ‰€ä»¥æ€»çš„æµç¨‹é¡ºåºå°±æ˜¯ï¼š</p>
<p><font color="red"><strong>å¼€å¯ Hadoop â€“&gt; å¼€å¯ HBase â€“&gt; å…³é—­ HBase â€“&gt; å…³é—­ Hadoop</strong></font>ğŸ˜€</p>
<p><font color="red">è¯·ä¸€å®šä¸¥æ ¼æŒ‰ç…§é¡ºåºè¿›è¡Œï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œå¦‚æœä¸ç¡®å®šæ˜¯å¦æœ‰å¼€å¯å…¶ä¸­çš„æŸä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>jps</code> å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹è¿›ç¨‹ <code>id</code>ã€‚</font></p>
<h2 id="4-1-HBase-ä¸‹è½½ä¸å®‰è£…"><a href="#4-1-HBase-ä¸‹è½½ä¸å®‰è£…" class="headerlink" title="4.1 HBase ä¸‹è½½ä¸å®‰è£…"></a>4.1 HBase ä¸‹è½½ä¸å®‰è£…</h2><p><a href="https://archive.apache.org/dist/hbase/">å®˜ç½‘ä¸‹è½½</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HBase%E4%B8%8B%E8%BD%BD(1).png"></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HBase%E4%B8%8B%E8%BD%BD(2).png" style="zoom: 67%;">

<p>æ‰“ä¸å¼€å®˜ç½‘ï¼Ÿè¯•è¯•<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ä¸‹è½½</a>ã€‚ä¸è¿‡å¥½åƒåªæœ‰æ–°ç‰ˆğŸ¤”</p>
<p>ä¸‹è½½å¥½ä¹‹åå°±å¯ä»¥å¼€å§‹å®‰è£…äº†ï¼š</p>
<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© Hadoop å®‰è£…æ–‡ä»¶åˆ°  &#x2F;usr&#x2F;local ç›®å½•ï¼Œè§£å‹å®Œæˆåå¯ä»¥è¿›å…¥åˆ° &#x2F;usr&#x2F;local ç›®å½•æŸ¥çœ‹æ˜¯å¦æˆåŠŸã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼©å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf hbase-2.2.2-bin.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>3ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># HBase ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/usr/local/hbase-2.2.2</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HBASE_HOME</span>/bin</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEHBase%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom: 67%;">

<p>4ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>5ã€æ·»åŠ  HBase æƒé™</p>
<p>è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼ŒæŠŠ hbase ç›®å½•æƒé™èµ‹äºˆç»™ muyoukule ç”¨æˆ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† hbase-2.2.2 ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹ä¸º muyoukuleï¼Œmuyoukule æ˜¯å½“å‰ç”¨æˆ·çš„ç”¨æˆ·å</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule ./hbase-2.2.2</span><br></pre></td></tr></table></figure>

<p>6ã€æ£€æŸ¥å®‰è£…ç»“æœï¼Œå‡ºç°ä¸‹é¢ä¿¡æ¯ä»£è¡¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ hbase ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">hbase version</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5HBase%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png"></p>
<p>å‡å¦‚å‡ºç° <code>æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» org.apache.hadoop.hbase.util.GetJavaProperty</code> çš„é”™è¯¯ï¼Œè§£å†³æ–¹æ³•ï¼š</p>
<p>ä¿®æ”¹ &#x2F;usr&#x2F;local&#x2F;hbase&#x2F;conf&#x2F;hbase-env.sh é…ç½®æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /usr/local/hbase-2.2.2/conf/hbase-env.sh</span><br></pre></td></tr></table></figure>

<p>åˆ°é…ç½®æ–‡ä»¶åº•éƒ¨ï¼Œå°† <code># export HBASE_DISABLE_HADOOP_CLASSPATH_LOOKUP=&quot;true&quot;</code>  å‰çš„æ³¨é‡Š( <code>#</code> å·)åˆ é™¤å³å¯ï¼Œåˆ é™¤åä¿å­˜å¹¶é€€å‡ºå³å¯ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hbase-env.sh.png" style="zoom: 67%;">

<p>è¿™æ ·ï¼ŒHBase å°±å®‰è£…å¥½äº†ã€‚</p>
<h2 id="4-2-HBase-å•æœºæ¨¡å¼é…ç½®"><a href="#4-2-HBase-å•æœºæ¨¡å¼é…ç½®" class="headerlink" title="4.2 HBase å•æœºæ¨¡å¼é…ç½®"></a>4.2 HBase å•æœºæ¨¡å¼é…ç½®</h2><p>HBaseå•æœºæ¨¡å¼é…ç½®æ—¶æ¶‰åŠçš„ä¸¤ä¸ªä¸»è¦é…ç½®æ–‡ä»¶æ˜¯ <code>hbase-env.sh</code> å’Œ <code>hbase-site.xml</code> ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«ç”¨äºè®¾ç½® HBase çš„è¿è¡Œç¯å¢ƒå’Œå®šä¹‰ HBase çš„æ ¸å¿ƒé…ç½®å‚æ•°ã€‚</p>
<p><strong>hbase-env.sh</strong></p>
<p><code>hbase-env.sh</code> æ˜¯ä¸€ä¸ª shell è„šæœ¬æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº† HBase å¯åŠ¨å’Œè¿è¡Œæ‰€éœ€çš„ç¯å¢ƒå˜é‡è®¾ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹é…ç½® HBase æ—¶ï¼Œéœ€è¦æ£€æŸ¥å¹¶å¯èƒ½ä¿®æ”¹ä»¥ä¸‹å‡ ä¸ªå…³é”®çš„é…ç½®é¡¹ï¼š</p>
<ul>
<li><code>JAVA_HOME</code>ï¼šè¿™ä¸ªå˜é‡éœ€è¦æŒ‡å‘ä½ å®‰è£…çš„ JDK çš„ç›®å½•ã€‚ç¡®ä¿ HBase å¯ä»¥æ‰¾åˆ°å¹¶ä½¿ç”¨æ­£ç¡®çš„ Java ç‰ˆæœ¬ã€‚</li>
<li><code>HBASE_MANAGES_ZK</code>ï¼šè¿™ä¸ªå˜é‡æ§åˆ¶ HBase æ˜¯å¦åº”è¯¥ç®¡ç†å…¶è‡ªå·±çš„ ZooKeeper å®ä¾‹ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸º <code>true</code>ï¼Œè¿™æ · HBase å°±ä¼šå¯åŠ¨å®ƒè‡ªå·±çš„ ZooKeeper å®ä¾‹ã€‚</li>
<li>å…¶ä»–ç¯å¢ƒå˜é‡ï¼šæ ¹æ®å…·ä½“çš„ç³»ç»Ÿé…ç½®å’Œéœ€æ±‚ï¼Œå¯èƒ½è¿˜éœ€è¦è®¾ç½®å…¶ä»–ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<p><strong>hbase-site.xml</strong></p>
<p><code>hbase-site.xml</code>æ˜¯ HBase çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº† HBase é›†ç¾¤çš„å„ç§å‚æ•°è®¾ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹é…ç½® HBase æ—¶ï¼Œä½ éœ€è¦ä¿®æ”¹æˆ–æ·»åŠ ä»¥ä¸‹å…³é”®é…ç½®é¡¹ï¼š</p>
<ul>
<li><code>hbase.rootdir</code>ï¼šè¿™ä¸ªå‚æ•°å®šä¹‰äº† HBase æ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„æŸä¸ªè·¯å¾„ï¼Œä¾‹å¦‚<code>file:///tmp/hbase</code>ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„ HBase æ•°æ®éƒ½å°†å­˜å‚¨åœ¨è¿™ä¸ªæŒ‡å®šçš„æœ¬åœ°ç›®å½•ä¸­ã€‚</li>
<li><code>hbase.zookeeper.property.dataDir</code>ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº† ZooKeeper ä½¿ç”¨çš„æ•°æ®ç›®å½•ã€‚ç”±äºåœ¨å•æœºæ¨¡å¼ä¸‹ HBase é€šå¸¸ä¼šç®¡ç†è‡ªå·±çš„ ZooKeeper å®ä¾‹ï¼Œå› æ­¤éœ€è¦è®¾ç½®è¿™ä¸ªå‚æ•°æ¥æŒ‡å®š ZooKeeper æ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚</li>
<li><code>hbase.cluster.distributed</code>ï¼šè¿™ä¸ªå‚æ•°æ§åˆ¶ HBase æ˜¯å¦ä»¥åˆ†å¸ƒå¼æ¨¡å¼è¿è¡Œã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸º<code>false</code>ã€‚</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºé…ç½®æ–‡ä»¶çš„ä¿®æ”¹ï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯ç›¸åº”çš„ HBase æœåŠ¡ã€‚æ›´æ”¹é…ç½®æ–‡ä»¶åï¼Œè¯·è¿è¡Œ <code>stop-hbase.sh</code> ä»¥åœæ­¢ HBase æœåŠ¡ï¼Œé…ç½®å®Œæˆåå†è¿è¡Œ<code>start-hbase.sh</code> ä»¥å¯åŠ¨æœåŠ¡ã€‚</p>
<blockquote>
<p>é…ç½® hbase-env.sh</p>
</blockquote>
<p>åœ¨å¯åŠ¨HBaseå‰ï¼Œéœ€è®¾ç½®  JAVA_HOME ç¯å¢ƒå˜é‡ã€‚ä¸ºæ–¹ä¾¿ç”¨æˆ·ï¼ŒHBase å…è®¸åœ¨ <code>conf/hbase-env.sh</code> æ–‡ä»¶ä¸­ç›´æ¥è®¾ç½®ã€‚ç”¨æˆ·éœ€æ‰¾åˆ° Java å®‰è£…ä½ç½®åç¼–è¾‘ <code>conf/hbase-env.sh</code>ï¼Œå–æ¶ˆå¯¹ <code>#export JAVA_HOME=</code> è¡Œçš„æ³¨é‡Šï¼Œå¹¶è®¾ç½®ä¸º Java å®‰è£…è·¯å¾„ã€‚</p>
<p>å…ˆæŸ¥æ‰¾ Java å®‰è£…ä½ç½®(å¦‚æœä½ çŸ¥é“å¯ä»¥å¿½ç•¥)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾ Java å®‰è£…ä½ç½®</span></span><br><span class="line">whereis java</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸æ­¢ä¸€ä¸ªè·¯å¾„ï¼Œæˆ‘ä»¬éœ€è¦è‡ªè¡Œè¿›è¡Œåˆ¤æ–­ï¼Œæˆ‘çš„æ˜¯ <code>/usr/local/jdk1.8.0_162</code></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E6%89%BEJava%E5%AE%89%E8%A3%85%E4%BD%8D%E7%BD%AE.png"></p>
<p>1ã€ä½¿ç”¨ vim ç¼–è¾‘å™¨æ‰“å¼€ hbase-env.sh æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /usr/local/hbase-2.2.2/conf/hbase-env.sh</span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½® Java çš„ç¯å¢ƒå˜é‡</p>
<p>å…·ä½“ä½œç”¨æ˜¯å‘Šè¯‰ HBase ä½¿ç”¨å“ªä¸€ä¸ª jdkï¼Œæˆ‘è¿™é‡Œ Java çš„å®‰è£…ç›®å½•æ˜¯ <code>/usr/local/jdk1.8.0_162</code>ï¼Œè¿˜éœ€è¦é…ç½®ä»¤ ZooKeeper ç”± HBase è‡ªå·±ç®¡ç†ï¼Œä¸éœ€è¦å•ç‹¬çš„ ZooKeeperï¼Œå…·ä½“éœ€è¦æ·»åŠ çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½® Java çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/jdk1.8.0_162</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® ZooKeeper çš„ç®¡ç†è€…</span></span><br><span class="line"><span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">true</span> </span><br></pre></td></tr></table></figure>

<p>å› ä¸ºåœ¨ <code>hbase-env.sh</code> æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨æœ‰ <code>JAVA_HOME</code>ã€<code>HBASE_MANAGES_ZK</code> è¿™ä¸¤ä¸ªå˜é‡ï¼Œä½†åªæ˜¯è¢«æ³¨é‡Šæ‰äº†ï¼Œä¹Ÿå°±æ˜¯å‰é¢å¸¦äº† <code>#</code> å·ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥ç›´æ¥å¯»æ‰¾åˆ°å¯¹åº”çš„å˜é‡ï¼Œå°†å‰é¢èµ·æ³¨é‡Šä½œç”¨çš„ <code>#</code> å·åˆ å»ï¼Œç„¶åä¿®æ”¹åé¢çš„å€¼å³å¯ã€‚</p>
<p><strong>PSï¼švim ç¼–è¾‘å™¨æ€æ ·æœç´¢å­—ç¬¦ä¸²ï¼Ÿ</strong></p>
<ul>
<li>æ™®é€šæ¨¡å¼ä¸‹ï¼ŒæŒ‰ä¸‹ <code>/</code> é”®ï¼Œç„¶åè¾“å…¥ä½ æƒ³è¦æœç´¢çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ä¸‹ <code>Enter</code> é”®å¼€å§‹æœç´¢ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>n</code>ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸Šä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>N</code>ã€‚</li>
</ul>
<p>ä½†æ˜¯æˆ‘å¾ˆæ‡’ä¸æƒ³å»æ‰¾ğŸ™„ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å†™åœ¨æ–‡ä»¶é¡¶éƒ¨äº†ï¼Œè¿™ä¸ªæ˜¯ä¸å½±å“è¿è¡Œæ“ä½œçš„ï¼Œå…·ä½“å›¾ç¤ºå¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEhbase-env.sh.png" style="zoom:67%;">

<blockquote>
<p>é…ç½® hbase-site.xml</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ–‡ä»¶ä¸­çš„ <code>hbase.rootdir</code> ã€<code>hbase.unsafe.stream.capability.enforce</code> ä¸¤ä¸ªå‚æ•°ï¼š</p>
<p><code>hbase.rootdir</code> æ˜¯ HBase é…ç½®ä¸­çš„ä¸€ä¸ªå…³é”®å‚æ•°ï¼Œç”¨äºæŒ‡å®š HBase æ•°æ®å’Œå…ƒæ•°æ®çš„æ ¹å­˜å‚¨ç›®å½•ã€‚è¯¥ç›®å½•æ˜¯ HBase ç”¨æ¥å­˜æ”¾æ‰€æœ‰è¡¨æ•°æ®ã€ç´¢å¼•ã€æ—¥å¿—æ–‡ä»¶ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯çš„æ ¸å¿ƒä½ç½®ã€‚é€šè¿‡æ­£ç¡®é…ç½® <code>hbase.rootdir</code>ï¼Œå¯ä»¥ç¡®ä¿ HBase æ•°æ®è¢«å­˜å‚¨åœ¨ä¸€ä¸ªæŒä¹…åŒ–ã€å¯é ä¸”å¯æ‰©å±•çš„å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œä»è€Œä¿éšœ HBase çš„ç¨³å®šè¿è¡Œå’Œæ•°æ®çš„å®‰å…¨æ€§ã€‚è¿™é‡Œæˆ‘ä»¬ç»™å®ƒè®¾ç½®ä¸º HBase å®‰è£…ç›®å½•ä¸‹çš„ <code>hbase-tmp</code> æ–‡ä»¶å¤¹ï¼Œå¯¹äºæˆ‘çš„å®‰è£…ç›®å½•æ¥è¯´ï¼Œå…·ä½“è·¯å¾„åœ¨ <code>/usr/local/hbase-2.2.2/hbase-tmp</code>ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å®‰è£…ç›®å½•è¿›è¡Œä¸€å®šçš„è°ƒæ•´ã€‚</p>
<p><code>hbase.unsafe.stream.capability.enforce</code>ï¼šè¿™ä¸ªé…ç½®é¡¹ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ <code>TFramedTransport</code>æˆ–è€…<code>TLowDelayTransport</code>çš„å¸§å¤§å°æ£€æŸ¥ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šå¯ç”¨å¸§å¤§å°æ£€æŸ¥ï¼Œç”¨äºä¿è¯ç½‘ç»œè¿æ¥å’Œæ•°æ®ä¼ è¾“çš„ç¨³å®šæ€§ï¼Œä¹Ÿå°±æ˜¯æŠŠä»–çš„å€¼è®¾ç½®ä¸º <code>true</code>ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯ä¼ªåˆ†å¸ƒæ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿è¯ç¨³å®šæ€§ï¼Œå¯ä»¥é€‰æ‹©ç¦ç”¨å¸§å¤§å°æ£€æŸ¥ï¼Œä»è€Œæå‡æ•°æ®ä¼ è¾“æ€§èƒ½ï¼Œå°±æ˜¯å°†å®ƒçš„å€¼è®¾ç½®ä¸º <code>flase</code>ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸ç®¡è¿™ä¸ªé…ç½®é¡¹ï¼Œä¸»è¦æ˜¯çœ‹ä¸ªäººéœ€æ±‚ã€‚</p>
<p>1ã€ä½¿ç”¨ <code>gedit</code> ç¼–è¾‘å™¨ä¿®æ”¹å…¶æ–‡ä»¶å†…å®¹ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gedit /usr/local/hbase-2.2.2/conf/hbase-site.xml</span><br></pre></td></tr></table></figure>

<p>å°†å½“ä¸­çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸ºä¸‹é¢é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½® HBase æ•°æ®æ ¹ç›®å½•ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ hbase-tmp ç›®å½• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///usr/local/hbase-2.2.2/hbase-tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.unsafe.stream.capability.enforce<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æµ‹è¯•è¿è¡Œ</p>
<p>å¯åŠ¨ HBaseï¼Œå¹¶ä¸”æ‰“å¼€ <code>shell</code> å‘½ä»¤è¡Œæ¨¡å¼ï¼ŒæˆåŠŸæ‰“å¼€åï¼Œç”¨æˆ·å°±å¯ä»¥é€šè¿‡è¾“å…¥ <code>shell</code> å‘½ä»¤æ¥ä½¿ç”¨æ“ä½œ HBase æ•°æ®åº“äº†ã€‚å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ HBase</span></span><br><span class="line">start-hbase.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‰“å¼€ shell å‘½ä»¤è¡Œæ¨¡å¼</span></span><br><span class="line">hbase shell </span><br></pre></td></tr></table></figure>

<p>å‡ºç°ä¸‹é¢å›¾ç¤ºçš„æ ·å­ï¼Œå°±è¯´æ˜ <code>shell</code> å‘½ä»¤è¡Œè¢«æˆåŠŸæ‰“å¼€äº†ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿˜æœ‰ <code>hbase(main)</code> çš„å­—æ ·ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/shell%E5%91%BD%E4%BB%A4%E6%88%90%E5%8A%9F%E6%89%93%E5%BC%80.png"></p>
<p>è¾“å…¥ <code>help</code>ï¼Œå¯ä»¥è·å–å¸®åŠ©ä¿¡æ¯ï¼Œå¸®åŠ©ä½ æ›´å¥½çš„ç†Ÿæ‚‰ä½¿ç”¨æ–¹æ³•ï¼Œè¿˜å¯ä»¥çœ‹è§å½“å‰ HBase çš„ç‰ˆæœ¬ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HBase-help.png"></p>
<p>3ã€è¾“å…¥ <code>exit</code>æˆ–è€… <code>Ctrl + d</code> å°±å¯ä»¥é€€å‡ºè¯¥æ¨¡å¼ï¼Œè¿”å›ç»ˆç«¯æ§åˆ¶å°ã€‚</p>
<p>4ã€åœæ­¢ HBase è¿è¡Œï¼Œåœ¨ç»ˆç«¯è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ HBase è¿è¡Œ</span></span><br><span class="line">stop-hbase.sh</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šå¦‚æœåœ¨æ“ä½œ HBase çš„è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥é€šè¿‡ {HBASE_HOME}ç›®å½•(&#x2F;usr&#x2F;local&#x2F;hbase-2.2.2)ä¸‹çš„ logs å­ç›®å½•ä¸­çš„æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹é”™è¯¯åŸå› ã€‚</strong></p>
<h2 id="4-3-HBase-ä¼ªåˆ†å¸ƒå¼æ¨¡å¼é…ç½®"><a href="#4-3-HBase-ä¼ªåˆ†å¸ƒå¼æ¨¡å¼é…ç½®" class="headerlink" title="4.3 HBase ä¼ªåˆ†å¸ƒå¼æ¨¡å¼é…ç½®"></a>4.3 HBase ä¼ªåˆ†å¸ƒå¼æ¨¡å¼é…ç½®</h2><p>HBaseä¼ªåˆ†å¸ƒå¼æ¨¡å¼é…ç½®æ—¶æ¶‰åŠçš„ä¸¤ä¸ªä¸»è¦é…ç½®æ–‡ä»¶æ˜¯ <code>hbase-env.sh</code> å’Œ <code>hbase-site.xml</code> ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«ç”¨äºè®¾ç½® HBase çš„è¿è¡Œç¯å¢ƒå’Œå®šä¹‰ HBase çš„æ ¸å¿ƒé…ç½®å‚æ•°ã€‚</p>
<p><strong>hbase-env.sh</strong></p>
<p><code>hbase-env.sh</code> æ˜¯ä¸€ä¸ª shell è„šæœ¬æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº† HBase å¯åŠ¨å’Œè¿è¡Œæ‰€éœ€çš„ç¯å¢ƒå˜é‡è®¾ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹é…ç½® HBase æ—¶ï¼Œéœ€è¦æ£€æŸ¥å¹¶å¯èƒ½ä¿®æ”¹ä»¥ä¸‹å‡ ä¸ªå…³é”®çš„é…ç½®é¡¹ï¼š</p>
<ul>
<li><code>JAVA_HOME</code>ï¼šè¿™ä¸ªå˜é‡éœ€è¦æŒ‡å‘ä½ å®‰è£…çš„ JDK çš„ç›®å½•ã€‚ç¡®ä¿ HBase å¯ä»¥æ‰¾åˆ°å¹¶ä½¿ç”¨æ­£ç¡®çš„ Java ç‰ˆæœ¬ã€‚</li>
<li><code>HBASE_MANAGES_ZK</code>ï¼šè¿™ä¸ªå˜é‡æ§åˆ¶ HBase æ˜¯å¦åº”è¯¥ç®¡ç†å…¶è‡ªå·±çš„ ZooKeeper å®ä¾‹ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸º<code>true</code>ï¼Œè¿™æ · HBase å°±ä¼šå¯åŠ¨å®ƒè‡ªå·±çš„ ZooKeeper å®ä¾‹ã€‚</li>
<li>å…¶ä»–ç¯å¢ƒå˜é‡ï¼šæ ¹æ®å…·ä½“çš„ç³»ç»Ÿé…ç½®å’Œéœ€æ±‚ï¼Œå¯èƒ½è¿˜éœ€è¦è®¾ç½®å…¶ä»–ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<p><strong>hbase-site.xml</strong></p>
<p><code>hbase-site.xml</code>æ˜¯ HBase çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº† HBase é›†ç¾¤çš„å„ç§å‚æ•°è®¾ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹é…ç½® HBase æ—¶ï¼Œä½ éœ€è¦ä¿®æ”¹æˆ–æ·»åŠ ä»¥ä¸‹å…³é”®é…ç½®é¡¹ï¼š</p>
<ul>
<li><code>hbase.rootdir</code>ï¼šè¿™ä¸ªå‚æ•°å®šä¹‰äº† HBase æ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„æŸä¸ªè·¯å¾„ï¼Œä¾‹å¦‚<code>file:///tmp/hbase</code>ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„ HBase æ•°æ®éƒ½å°†å­˜å‚¨åœ¨è¿™ä¸ªæŒ‡å®šçš„æœ¬åœ°ç›®å½•ä¸­ã€‚</li>
<li><code>hbase.zookeeper.property.dataDir</code>ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº† ZooKeeper ä½¿ç”¨çš„æ•°æ®ç›®å½•ã€‚ç”±äºåœ¨å•æœºæ¨¡å¼ä¸‹ HBase é€šå¸¸ä¼šç®¡ç†è‡ªå·±çš„ ZooKeeper å®ä¾‹ï¼Œå› æ­¤éœ€è¦è®¾ç½®è¿™ä¸ªå‚æ•°æ¥æŒ‡å®š ZooKeeper æ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚</li>
<li><code>hbase.cluster.distributed</code>ï¼šè¿™ä¸ªå‚æ•°æ§åˆ¶ HBase æ˜¯å¦ä»¥åˆ†å¸ƒå¼æ¨¡å¼è¿è¡Œã€‚åœ¨å•æœºæ¨¡å¼ä¸‹ï¼Œé€šå¸¸å°†å…¶è®¾ç½®ä¸º<code>false</code>ã€‚</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºé…ç½®æ–‡ä»¶çš„ä¿®æ”¹ï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯ç›¸åº”çš„ HBase æœåŠ¡ã€‚æ›´æ”¹é…ç½®æ–‡ä»¶åï¼Œè¯·è¿è¡Œ <code>stop-hbase.sh</code> ä»¥åœæ­¢ HBase æœåŠ¡ï¼Œé…ç½®å®Œæˆåå†è¿è¡Œ<code>start-hbase.sh</code> ä»¥å¯åŠ¨æœåŠ¡ã€‚</p>
<blockquote>
<p>é…ç½® hbase-env.sh</p>
</blockquote>
<p>åœ¨å¯åŠ¨HBaseå‰ï¼Œéœ€è®¾ç½®  JAVA_HOME ç¯å¢ƒå˜é‡ã€‚ä¸ºæ–¹ä¾¿ç”¨æˆ·ï¼ŒHBase å…è®¸åœ¨ <code>conf/hbase-env.sh</code> æ–‡ä»¶ä¸­ç›´æ¥è®¾ç½®ã€‚ç”¨æˆ·éœ€æ‰¾åˆ° Java å®‰è£…ä½ç½®åç¼–è¾‘ <code>conf/hbase-env.sh</code>ï¼Œå–æ¶ˆå¯¹ <code>#export JAVA_HOME=</code> è¡Œçš„æ³¨é‡Šï¼Œå¹¶è®¾ç½®ä¸ºJavaå®‰è£…è·¯å¾„ã€‚</p>
<p>å…ˆæŸ¥æ‰¾ Java å®‰è£…ä½ç½®(å¦‚æœä½ çŸ¥é“å¯ä»¥å¿½ç•¥)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾ Java å®‰è£…ä½ç½®</span></span><br><span class="line">whereis java</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸æ­¢ä¸€ä¸ªè·¯å¾„ï¼Œæˆ‘ä»¬éœ€è¦è‡ªè¡Œè¿›è¡Œåˆ¤æ–­ï¼Œæˆ‘çš„æ˜¯ <code>/usr/local/jdk1.8.0_162</code></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E6%89%BEJava%E5%AE%89%E8%A3%85%E4%BD%8D%E7%BD%AE.png"></p>
<p>1ã€ä½¿ç”¨ vim ç¼–è¾‘å™¨æ‰“å¼€ hbase-env.sh æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /usr/local/hbase-2.2.2/conf/hbase-env.sh</span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½® <code>JAVA_HOME</code>ï¼Œå…·ä½“ä½œç”¨æ˜¯å‘Šè¯‰ HBase ä½¿ç”¨å“ªä¸€ä¸ª jdkï¼Œæˆ‘è¿™é‡Œ Java çš„å®‰è£…ç›®å½•æ˜¯ <code>/usr/local/jdk1.8.0_162</code>ï¼›<code>HBASE_MANAGES_ZK</code> é…ç½®ä»¤ ZooKeeper ç”± HBase è‡ªå·±ç®¡ç†ï¼Œä¸éœ€è¦å•ç‹¬çš„ ZooKeeperã€‚<code>HBASE_CLASSPATH</code> å˜é‡å¯ç”¨äºç¡®å®šè¿è¡Œè‡ªå®šä¹‰ HBase æ“ä½œæ‰€éœ€çš„å…¶ä»– JAR æ–‡ä»¶å’Œç›®å½•çš„ä¼˜å…ˆçº§ã€‚æœ€åæ˜¯å…·ä½“éœ€è¦æ·»åŠ çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½® Java çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/jdk1.8.0_162</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® ZooKeeper çš„ç®¡ç†è€…</span></span><br><span class="line"><span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸ºæœ¬æœº HBase å®‰è£…ç›®å½•ä¸‹çš„ conf ç›®å½•</span></span><br><span class="line"><span class="built_in">export</span> HBASE_CLASSPATH=/usr/local/hbase-2.2.2/conf</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºåœ¨ <code>hbase-env.sh</code> æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨æœ‰ <code>JAVA_HOME</code>ã€<code>HBASE_MANAGES_ZK</code>ã€<code>HBASE_CLASSPATH</code> è¿™ä¸‰ä¸ªå˜é‡ï¼Œåªæ˜¯è¢«æ³¨é‡Šæ‰äº†ï¼Œä¹Ÿå°±æ˜¯å‰é¢å¸¦äº† <code>#</code> å·ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥ç›´æ¥å¯»æ‰¾åˆ°å¯¹åº”çš„å˜é‡ï¼Œå°†å‰é¢èµ·æ³¨é‡Šä½œç”¨çš„ <code>#</code> å·åˆ å»ï¼Œç„¶åä¿®æ”¹åé¢çš„å€¼å³å¯ã€‚</p>
<p><strong>PSï¼švim ç¼–è¾‘å™¨æ€æ ·æœç´¢å­—ç¬¦ä¸²ï¼Ÿ</strong></p>
<ul>
<li>æ™®é€šæ¨¡å¼ä¸‹ï¼ŒæŒ‰ä¸‹ <code>/</code> é”®ï¼Œç„¶åè¾“å…¥ä½ æƒ³è¦æœç´¢çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ä¸‹ <code>Enter</code> é”®å¼€å§‹æœç´¢ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>n</code>ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸Šä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>N</code>ã€‚</li>
</ul>
<p>ä½†æ˜¯æˆ‘å¾ˆæ‡’ä¸æƒ³å»æ‰¾ğŸ™„ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å†™åœ¨æ–‡ä»¶é¡¶éƒ¨äº†ï¼Œè¿™ä¸ªæ˜¯ä¸å½±å“è¿è¡Œæ“ä½œçš„ï¼Œå…·ä½“å›¾ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AEhbase-env.sh.png"></p>
<blockquote>
<p>é…ç½® hbase-site.xml</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ–‡ä»¶ä¸­çš„ <code>hbase.rootdir</code>ã€<code>hbase.cluster.distributed</code>ã€<code>hbase.unsafe.stream.capability.enforce</code> ä¸‰ä¸ªå‚æ•°ã€‚</p>
<p><code>hbase.rootdir</code>ï¼šä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè¦æŒ‡å®š HDFS å®ä¾‹çš„ Namenode åœ¨ <code>nameenode.example.org</code> ä¸Šè¿è¡Œçš„ HDFS ç›®å½• <code>/hbase-2.2.2</code>ï¼Œç«¯å£ä¸º <code>9000</code>ï¼Œåˆ™éœ€è¦å°†æ­¤å€¼è®¾ç½®ä¸ºï¼š<code>hdfs://namenode.example.org:9000/hbase-2.2.2</code>ï¼Œå› ä¸ºæˆ‘ä»¬åšçš„æ˜¯ä¼ªåˆ†å¸ƒï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±å°†å®ƒè®¾ç½®åœ¨æœ¬æœºçš„ <code>9000</code> ç«¯å£å·ä¸Šã€‚</p>
<p><code>hbase.cluster.distributed</code>ï¼šè¿™ä¸ªå‚æ•°ç”¨äºè®¾ç½®ç¾¤é›†å°†å¤„äºçš„æ¨¡å¼ã€‚å¯¹äºåˆ†å¸ƒå¼æ¨¡å¼ï¼Œå€¼è®¾ç½®ä¸º <code>true</code>ï¼Œå› ä¸ºæˆ‘ä»¬åšçš„æ˜¯ä¼ªåˆ†å¸ƒæ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶å€¼è®¾ç½®ä¸º <code>true</code>ã€‚</p>
<p><code>hbase.unsafe.stream.capability.enforce</code>ï¼šè¿™ä¸ªé…ç½®é¡¹ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ <code>TFramedTransport</code>æˆ–è€…<code>TLowDelayTransport</code>çš„å¸§å¤§å°æ£€æŸ¥ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šå¯ç”¨å¸§å¤§å°æ£€æŸ¥ï¼Œç”¨äºä¿è¯ç½‘ç»œè¿æ¥å’Œæ•°æ®ä¼ è¾“çš„ç¨³å®šæ€§ï¼Œä¹Ÿå°±æ˜¯æŠŠä»–çš„å€¼è®¾ç½®ä¸º <code>true</code>ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯ä¼ªåˆ†å¸ƒæ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿è¯ç¨³å®šæ€§ï¼Œå¯ä»¥é€‰æ‹©ç¦ç”¨å¸§å¤§å°æ£€æŸ¥ï¼Œä»è€Œæå‡æ•°æ®ä¼ è¾“æ€§èƒ½ï¼Œå°±æ˜¯å°†å®ƒçš„å€¼è®¾ç½®ä¸º <code>flase</code>ï¼Œå¦å¤–ï¼Œæ­¤å±æ€§å¯èƒ½ä¼šå‡å°‘æ•…éšœåˆ‡æ¢é€‰é¡¹ï¼Œæ‰€ä»¥åœ¨å¯ç”¨çš„æ—¶å€™éœ€è¦è°¨æ…ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç¦ç”¨å®ƒä¹Ÿæœ‰è¿™ä¸€å±‚åŸå› ã€‚</p>
<p>1ã€ä½¿ç”¨ <code>gedit</code> ç¼–è¾‘å™¨ä¿®æ”¹å…¶æ–‡ä»¶å†…å®¹ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gedit /usr/local/hbase-2.2.2/conf/hbase-site.xml</span><br></pre></td></tr></table></figure>

<p>å°†å½“ä¸­çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸ºä¸‹é¢é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000/hbase-2.2.2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.unsafe.stream.capability.enforce<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æ¥ä¸‹æ¥æµ‹è¯•è¿è¡Œ HBase</p>
<p>ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆç™»é™† sshï¼Œä¹‹å‰è®¾ç½®äº†æ— å¯†ç ç™»é™†ï¼Œå› æ­¤è¿™é‡Œä¸éœ€è¦å¯†ç ï¼›å†å¯åŠ¨ Hadoop(å¦‚æœå·²ç»å¯åŠ¨ Hadoopè¯·è·³è¿‡æ­¤æ­¥éª¤)ï¼Œ</p>
<p>å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç™»é™† ssh</span></span><br><span class="line">ssh localhost</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ Hadoop</span></span><br><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥å‘½ä»¤ <code>jps</code>ï¼Œèƒ½çœ‹åˆ° NameNode,DataNode å’Œ SecondaryNameNode éƒ½å·²ç»æˆåŠŸå¯åŠ¨ï¼Œè¡¨ç¤º hadoop å¯åŠ¨æˆåŠŸï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hbase%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E5%90%AF%E5%8A%A8%E6%88%90%E5%8A%9F.png"></p>
<p>ç¬¬äºŒæ­¥ï¼šå†å¯åŠ¨ HBase å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ HBase </span></span><br><span class="line">start-hbase.sh</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æˆåŠŸï¼Œè¾“å…¥ <code>jps</code> åå°±å¯ä»¥çœ‹è§æœ‰ <code>HQuorumPeer</code>ã€<code>HRegionServer</code>ã€<code>HMaster</code>ï¼Œè¯´æ˜éƒ½å·²ç»æˆåŠŸå¯åŠ¨ã€‚</p>
<ul>
<li><strong>HQuorumPeer</strong>ï¼šZooKeeper ä¸­çš„åŒæ­¥å’Œé€‰ä¸»çº¿ç¨‹ï¼Œç¡®ä¿é›†ç¾¤èŠ‚ç‚¹åŒæ­¥å¹¶å¤„ç†é¢†å¯¼é€‰ä¸¾ã€‚</li>
<li><strong>HRegionServer</strong>ï¼šHBase ä¸­è´Ÿè´£å¤„ç†ç”¨æˆ· I&#x2F;O è¯·æ±‚ã€ç®¡ç†HRegionå’Œå­˜å‚¨æ•°æ®çš„èŠ‚ç‚¹ã€‚</li>
<li><strong>HMaster</strong>ï¼šHBase é›†ç¾¤çš„ä¸»æœåŠ¡å™¨ï¼Œç›‘æ§ RegionServerã€ç®¡ç†å…ƒæ•°æ®æ›´æ”¹å’Œè´Ÿè´£è¡¨çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hbase%E5%90%AF%E5%8A%A8%E6%88%90%E5%8A%9F.png"></p>
<p>ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥ shell ç•Œé¢ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase shell</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hbase%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9Fshell%E5%91%BD%E4%BB%A4%E6%88%90%E5%8A%9F%E6%89%93%E5%BC%80.png"></p>
<p>è¾“å…¥ <code>exit</code>æˆ–è€… <code>Ctrl + d</code> å°±å¯ä»¥é€€å‡ºè¯¥æ¨¡å¼ï¼Œè¿”å›ç»ˆç«¯æ§åˆ¶å°ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">exit   # æˆ–è€… Ctrl + d</span><br></pre></td></tr></table></figure>

<p>3ã€åœæ­¢ HBase è¿è¡Œï¼Œåœ¨ç»ˆç«¯è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ HBase è¿è¡Œ</span></span><br><span class="line">stop-hbase.sh</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šå¦‚æœåœ¨æ“ä½œHBaseçš„è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥é€šè¿‡{HBASE_HOME}ç›®å½•(&#x2F;usr&#x2F;local&#x2F;hbase-2.2.2)ä¸‹çš„logså­ç›®å½•ä¸­çš„æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹é”™è¯¯åŸå› ã€‚</strong></p>
<h2 id="4-4-ç¼–ç¨‹å®è·µ"><a href="#4-4-ç¼–ç¨‹å®è·µ" class="headerlink" title="4.4 ç¼–ç¨‹å®è·µ"></a>4.4 ç¼–ç¨‹å®è·µ</h2><h3 id="4-4-1-åˆ©ç”¨Shellå‘½ä»¤"><a href="#4-4-1-åˆ©ç”¨Shellå‘½ä»¤" class="headerlink" title="4.4.1 åˆ©ç”¨Shellå‘½ä»¤"></a>4.4.1 åˆ©ç”¨Shellå‘½ä»¤</h3><p>å…ˆå¯åŠ¨ Hadoop å†å¯åŠ¨ HBase ï¼Œå†è¾“å…¥ <code>jps</code> è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ(HDFS)çš„å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ HBase çš„æ‰€æœ‰å¿…è¦å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">start-hbase.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯æ˜¯å¦å·²ç»æˆåŠŸå¯åŠ¨äº†ç›¸åº”çš„å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">jps</span><br></pre></td></tr></table></figure>

<p>å‡ºç°ä»¥ä¸‹ä¿¡æ¯è¯´æ˜å¯åŠ¨æˆåŠŸï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HMaster</span><br><span class="line">DataNode</span><br><span class="line">Jps</span><br><span class="line">SecondaryNameNode</span><br><span class="line">HRegionServer</span><br><span class="line">HQuorumPeer</span><br><span class="line">NameNode</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›å…¥ shell ç•Œé¢</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase shell</span><br></pre></td></tr></table></figure>

<blockquote>
<p>HBaseä¸­åˆ›å»ºè¡¨</p>
</blockquote>
<p>HBase ä¸­ç”¨ <code>create</code> å‘½ä»¤åˆ›å»ºè¡¨ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">create &#x27;student&#x27;,&#x27;Sname&#x27;,&#x27;Ssex&#x27;,&#x27;Sage&#x27;,&#x27;Sdept&#x27;,&#x27;course&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/HBase%E7%94%A8create%E5%91%BD%E4%BB%A4%E5%88%9B%E5%BB%BA%E8%A1%A8.png"></p>
<p>æ­¤æ—¶ï¼Œå³åˆ›å»ºäº†ä¸€ä¸ª student è¡¨ï¼Œå±æ€§æœ‰ï¼šSnameï¼ŒSsexï¼ŒSageï¼ŒSdeptï¼Œcourseã€‚å› ä¸º HBase çš„è¡¨ä¸­ä¼šæœ‰ä¸€ä¸ªç³»ç»Ÿé»˜è®¤çš„å±æ€§ä½œä¸ºè¡Œé”®ï¼Œæ— éœ€è‡ªè¡Œåˆ›å»ºï¼Œé»˜è®¤ä¸º <code>put</code> å‘½ä»¤æ“ä½œä¸­è¡¨ååç¬¬ä¸€ä¸ªæ•°æ®ã€‚åˆ›å»ºå®Œ student è¡¨åï¼Œå¯é€šè¿‡ <code>describe</code> å‘½ä»¤æŸ¥çœ‹ student è¡¨çš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ â€œstudentâ€ è¡¨çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">describe &#x27;student&#x27;</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/student%E8%A1%A8%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF.png" style="zoom:67%;">

<blockquote>
<p>HBaseæ•°æ®åº“åŸºæœ¬æ“ä½œ</p>
</blockquote>
<p>æœ¬å°èŠ‚ä¸»è¦ä»‹ç» HBase çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥æ“ä½œã€‚åœ¨æ·»åŠ æ•°æ®æ—¶ï¼ŒHBase ä¼šè‡ªåŠ¨ä¸ºæ·»åŠ çš„æ•°æ®æ·»åŠ ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œæ•…åœ¨éœ€è¦ä¿®æ”¹æ•°æ®æ—¶ï¼Œåªéœ€ç›´æ¥æ·»åŠ æ•°æ®ï¼ŒHBase å³ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œä»è€Œå®Œæˆ â€œæ”¹â€ æ“ä½œï¼Œæ—§çš„ç‰ˆæœ¬ä¾æ—§ä¿ç•™ï¼Œç³»ç»Ÿä¼šå®šæ—¶å›æ”¶åƒåœ¾æ•°æ®ï¼Œåªç•™ä¸‹æœ€æ–°çš„å‡ ä¸ªç‰ˆæœ¬ï¼Œä¿å­˜çš„ç‰ˆæœ¬æ•°å¯ä»¥åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™æŒ‡å®šã€‚</p>
<p><strong>æ·»åŠ æ•°æ®</strong></p>
<p>HBase ä¸­ç”¨ <code>put</code> å‘½ä»¤æ·»åŠ æ•°æ®ã€‚</p>
<p><font color="red">PSï¼šä¸€æ¬¡åªèƒ½ä¸ºä¸€ä¸ªè¡¨çš„ä¸€è¡Œæ•°æ®çš„ä¸€ä¸ªåˆ—ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå•å…ƒæ ¼æ·»åŠ ä¸€ä¸ªæ•°æ®ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ shell å‘½ä»¤æ’å…¥æ•°æ®æ•ˆç‡å¾ˆä½ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ©ç”¨ç¼–ç¨‹æ“ä½œæ•°æ®ã€‚</font></p>
<p>å‘ student è¡¨ä¸­æ·»åŠ æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸º student è¡¨æ·»åŠ äº†å­¦å·ä¸º 95001ï¼Œåå­—ä¸º LiYing çš„ä¸€è¡Œæ•°æ®ï¼Œå…¶è¡Œé”®ä¸º 95001</span></span><br><span class="line">put &#x27;student&#x27;,&#x27;95001&#x27;,&#x27;Sname&#x27;,&#x27;LiYing&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸º 95001 è¡Œä¸‹çš„ course:math åˆ—æ·»åŠ ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">put &#x27;student&#x27;,&#x27;95001&#x27;,&#x27;course:math&#x27;,&#x27;80&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸º 95001 è¡Œä¸‹çš„ Ssex åˆ—æ·»åŠ ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">put &#x27;student&#x27;,&#x27;95001&#x27;,&#x27;Ssex&#x27;,&#x27;Male&#x27;</span><br></pre></td></tr></table></figure>

<p>æ¯æ¡å‘½ä»¤æ‰§è¡Œåå¦‚æ·»åŠ æˆåŠŸï¼Œå‡è¿”å›ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Took 0.0548 seconds</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ åæ‰§è¡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥çœ‹åˆ°åˆšæ‰æ·»åŠ çš„ 3 æ¡æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ£€ç´¢ student è¡¨ä¸­é”®ä¸º 95001 çš„è¡Œçš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">get &#x27;student&#x27;,&#x27;95001&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%B7%BB%E5%8A%A0%E7%9A%843%E6%9D%A1%E6%95%B0%E6%8D%AE.png"></p>
<p><strong>æŸ¥çœ‹æ•°æ®</strong></p>
<p>HBase ä¸­æœ‰ä¸¤ä¸ªç”¨äºæŸ¥çœ‹æ•°æ®çš„å‘½ä»¤ï¼š</p>
<ul>
<li><code>get</code> å‘½ä»¤ï¼Œç”¨äºæŸ¥çœ‹è¡¨çš„æŸä¸€è¡Œæ•°æ®ã€‚</li>
<li><code>scan</code> å‘½ä»¤ç”¨äºæŸ¥çœ‹æŸä¸ªè¡¨çš„å…¨éƒ¨æ•°æ®ã€‚</li>
</ul>
<p><code>get</code> å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€ç´¢ student è¡¨ä¸­é”®ä¸º 95001 çš„è¡Œçš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">get <span class="string">&#x27;student&#x27;</span>,<span class="string">&#x27;95001&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%B7%BB%E5%8A%A0%E7%9A%843%E6%9D%A1%E6%95%B0%E6%8D%AE.png"></p>
<p><code>scan</code> å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ£€ç´¢ student è¡¨ä¸­æ‰€æœ‰æ•°æ®</span></span><br><span class="line">scan &#x27;student&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E7%B4%A2student%E8%A1%A8%E4%B8%AD%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE.png"></p>
<p><strong>åˆ é™¤æ•°æ®</strong></p>
<p>åœ¨ HBaseä¸­ ç”¨ <code>delete</code> ä»¥åŠ <code>deleteall</code> å‘½ä»¤è¿›è¡Œåˆ é™¤æ•°æ®æ“ä½œï¼Œå®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><code>delete</code> ç”¨äºåˆ é™¤ä¸€ä¸ªæ•°æ®ï¼Œæ˜¯ <code>put</code> çš„åå‘æ“ä½œï¼›</li>
<li><code>deleteall</code> æ“ä½œç”¨äºåˆ é™¤ä¸€è¡Œæ•°æ®ã€‚</li>
</ul>
<p><code>delete</code> å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤ student è¡¨ä¸­è¡Œé”®ä¸º 95001 çš„è¡Œçš„ Ssex åˆ—çš„æ•°æ®ã€‚</span></span><br><span class="line">delete &#x27;student&#x27;,&#x27;95001&#x27;,&#x27;Ssex&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Took 0.0091 seconds</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ£€ç´¢ student è¡¨ä¸­é”®ä¸º 95001 çš„è¡Œçš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">get &#x27;student&#x27;,&#x27;95001&#x27;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° Ssex åˆ—çš„ä¸è§äº†ï¼Œåˆ é™¤äº† student è¡¨ä¸­ 95001 è¡Œä¸‹çš„ Ssex åˆ—çš„æ‰€æœ‰æ•°æ®ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%88%A0%E9%99%A4Ssex%E5%88%97%E7%9A%84%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE.png"></p>
<p><code>deleteall</code> å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤ student è¡¨ä¸­çš„ 95001 è¡Œçš„å…¨éƒ¨æ•°æ®ã€‚</span></span><br><span class="line">deleteall &#x27;student&#x27;,&#x27;95001&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Took 0.0052 seconds</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ£€ç´¢ student è¡¨ä¸­é”®ä¸º 95001 çš„è¡Œçš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">get &#x27;student&#x27;,&#x27;95001&#x27;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ‰€æœ‰åˆ—ä¸è§äº†ï¼Œå³åˆ é™¤äº† student è¡¨ä¸­çš„ 95001 è¡Œçš„å…¨éƒ¨æ•°æ®ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%88%A0%E9%99%A495001%E8%A1%8C%E7%9A%84%E5%85%A8%E9%83%A8%E6%95%B0%E6%8D%AE%E3%80%82.png"></p>
<p><strong>åˆ é™¤è¡¨</strong></p>
<p>åˆ é™¤è¡¨æœ‰ä¸¤æ­¥ï¼š</p>
<ol>
<li>å…ˆè®©è¯¥è¡¨ä¸å¯ç”¨ã€‚</li>
<li>åˆ é™¤è¡¨ã€‚</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®©è¯¥è¡¨ä¸å¯ç”¨</span></span><br><span class="line">disable &#x27;student&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤è¡¨</span></span><br><span class="line">drop &#x27;student&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰çš„è¡¨</span></span><br><span class="line">list</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/hbase%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E7%9A%84%E8%A1%A8.png"></p>
<blockquote>
<p>æŸ¥è¯¢è¡¨å†å²æ•°æ®</p>
</blockquote>
<p>æŸ¥è¯¢è¡¨çš„å†å²ç‰ˆæœ¬ï¼Œéœ€è¦ä¸¤æ­¥ï¼š</p>
<ol>
<li>åˆ›å»ºè¡¨å¹¶æ’å…¥&#x2F;æ›´æ–°æ•°æ®ã€‚</li>
<li>æŸ¥è¯¢æŒ‡å®šç‰ˆæœ¬çš„æ•°æ®ã€‚</li>
</ol>
<p>1ã€åˆ›å»ºè¡¨æŒ‡å®šä¿å­˜çš„ç‰ˆæœ¬æ•°(å‡è®¾æŒ‡å®šä¸º5)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">create &#x27;teacher&#x27;,&#123;NAME=&gt;&#x27;username&#x27;,VERSIONS=&gt;5&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Created table teacher</span><br><span class="line">Took 0.7303 seconds                                                                                                 </span><br><span class="line">=&gt; Hbase::Table - teacher</span><br></pre></td></tr></table></figure>

<p>2ã€æ’å…¥æ•°æ®ç„¶åæ›´æ–°æ•°æ®ï¼Œä½¿å…¶äº§ç”Ÿå†å²ç‰ˆæœ¬æ•°æ®ã€‚<strong>PSï¼šè¿™é‡Œæ’å…¥æ•°æ®å’Œæ›´æ–°æ•°æ®éƒ½æ˜¯ç”¨ <code>put</code> å‘½ä»¤</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary&#x27;</span><br><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary1&#x27;</span><br><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary2&#x27;</span><br><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary3&#x27;</span><br><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary4&#x27;  </span><br><span class="line">put &#x27;teacher&#x27;,&#x27;91001&#x27;,&#x27;username&#x27;,&#x27;Mary5&#x27;</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥è¯¢æ—¶ï¼ŒæŒ‡å®šæŸ¥è¯¢çš„å†å²ç‰ˆæœ¬æ•°ã€‚é»˜è®¤ä¼šæŸ¥è¯¢å‡ºæœ€æ–°çš„æ•°æ®ã€‚(æœ‰æ•ˆå–å€¼ä¸º1åˆ°5)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">get &#x27;teacher&#x27;,&#x27;91001&#x27;,&#123;COLUMN=&gt;&#x27;username&#x27;,VERSIONS=&gt;5&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%AC%E7%9A%84%E6%95%B0%E6%8D%AE.png"></p>
<blockquote>
<p>é€€å‡ºHBaseæ•°æ®åº“è¡¨æ“ä½œ</p>
</blockquote>
<p>æœ€åé€€å‡ºæ•°æ®åº“æ“ä½œï¼Œè¾“å…¥ <code>exit</code> å‘½ä»¤å³å¯é€€å‡ºã€‚</p>
<p><strong>PSï¼šè¿™é‡Œé€€å‡º HBase æ•°æ®åº“æ˜¯é€€å‡ºå¯¹æ•°æ®åº“è¡¨çš„æ“ä½œï¼Œè€Œä¸æ˜¯åœæ­¢å¯åŠ¨ HBase æ•°æ®åº“åå°è¿è¡Œã€‚</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">exit   # æˆ–è€… Ctrl + d</span><br></pre></td></tr></table></figure>

<h3 id="4-4-2-Java-API-ç¼–ç¨‹å®è·µ"><a href="#4-4-2-Java-API-ç¼–ç¨‹å®è·µ" class="headerlink" title="4.4.2 Java API ç¼–ç¨‹å®è·µ"></a>4.4.2 Java API ç¼–ç¨‹å®è·µ</h3><p>æœ¬å®ä¾‹é‡‡ç”¨ IDEA å¼€å‘å·¥å…·ã€‚ç‰ˆæœ¬ï¼š2023.3.6</p>
<p>å…³äºåœ¨ Linux å®‰è£…ä½¿ç”¨ IDEA å¯ä»¥å‚è€ƒä¸‹æ–‡ <strong>Linux å®‰è£…ä½¿ç”¨ IDEA</strong>ã€‚</p>
<p>å…³äºåœ¨ IDEA ä¸­ä½¿ç”¨ Maven å¯ä»¥å‚è€ƒä¸‹æ–‡ <strong>IDEA ä¸­ä½¿ç”¨ Maven</strong>ã€‚</p>
<p><font color="red">PSï¼šåœ¨å¼€å§‹è¿è¡Œç¨‹åºä¹‹å‰ï¼Œéœ€è¦å¯åŠ¨ HDFS å’Œ HBase ã€‚è¿™å¾ˆé‡è¦ï¼ï¼åƒä¸‡ä¸è¦å¿˜è®°äº†ã€‚</font>ğŸ˜“</p>
<p>1ã€åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œé¡¹ç›®åä¸º HBaseExample</p>
<p>ä¿®æ”¹ <code>pom.xml</code> æ–‡ä»¶ï¼Œå¯¼å…¥ HBase çš„ Java API çš„ä¾èµ–åŒ…ã€‚<strong>PSï¼šè®°å¾—åˆ·æ–°ä¾èµ–</strong>ã€‚ğŸ˜„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hbase<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hbase-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AF%BC%E5%85%A5HBase%E4%BE%9D%E8%B5%96%E5%8C%85.png" style="zoom: 50%;">

<p>2ã€æ“ä½œä¹‹å‰è¯·ç¡®ä¿æ²¡æœ‰ student è¡¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ‰“å¼€ shell å‘½ä»¤è¡Œæ¨¡å¼</span></span><br><span class="line">hbase shell </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰çš„è¡¨ï¼ŒæŸ¥çœ‹æ˜¯å¦å·²ç»æœ‰ student è¡¨</span></span><br><span class="line">list</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæœ‰è¯·å…ˆåˆ é™¤ student è¡¨</span></span><br><span class="line"><span class="comment"># è®©è¯¥è¡¨ä¸å¯ç”¨</span></span><br><span class="line"><span class="built_in">disable</span> <span class="string">&#x27;student&#x27;</span></span><br><span class="line"><span class="comment"># åˆ é™¤è¡¨</span></span><br><span class="line">drop <span class="string">&#x27;student&#x27;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™ <code>ExampleForHBase.java</code> </p>
<p><font color="red">PSï¼šæ³¨æ„ä¿®æ”¹ä¸€ä¸‹ <code>configuration.set(&quot;hbase.rootdir&quot;, &quot;hdfs://localhost:9000/hbase-2.2.2&quot;)</code> ä¸ Hbase é…ç½®æ–‡ä»¶çš„å†…å®¹ä¸€è‡´ã€‚</font>ğŸ˜€</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleForHBase</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        init();</span><br><span class="line">        createTable(<span class="string">&quot;student&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;score&quot;</span>&#125;);</span><br><span class="line">        insertData(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;score&quot;</span>, <span class="string">&quot;English&quot;</span>, <span class="string">&quot;69&quot;</span>);</span><br><span class="line">        insertData(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;score&quot;</span>, <span class="string">&quot;Math&quot;</span>, <span class="string">&quot;86&quot;</span>);</span><br><span class="line">        insertData(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;score&quot;</span>, <span class="string">&quot;Computer&quot;</span>, <span class="string">&quot;77&quot;</span>);</span><br><span class="line">        getData(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;score&quot;</span>, <span class="string">&quot;English&quot;</span>);</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        configuration = HBaseConfiguration.create();</span><br><span class="line">        <span class="comment">//æ³¨æ„ä¿®æ”¹è¿™é‡Œï¼Œéœ€è¦ä¸ Hbase é…ç½®æ–‡ä»¶ä¿æŒä¸€è‡´</span></span><br><span class="line">        configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>, <span class="string">&quot;hdfs://localhost:9000/hbase-2.2.2&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line">            admin = connection.getAdmin();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (admin != <span class="literal">null</span>) &#123;</span><br><span class="line">                admin.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createTable</span><span class="params">(String myTableName, String[] colFamily)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">TableName</span> <span class="variable">tableName</span> <span class="operator">=</span> TableName.valueOf(myTableName);</span><br><span class="line">        <span class="keyword">if</span> (admin.tableExists(tableName)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;talbe is exists!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">TableDescriptorBuilder</span> <span class="variable">tableDescriptor</span> <span class="operator">=</span> TableDescriptorBuilder.newBuilder(tableName);</span><br><span class="line">            <span class="keyword">for</span> (String str : colFamily) &#123;</span><br><span class="line">                <span class="type">ColumnFamilyDescriptor</span> <span class="variable">family</span> <span class="operator">=</span></span><br><span class="line">                        ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes(str)).build();</span><br><span class="line">                tableDescriptor.setColumnFamily(family);</span><br><span class="line">            &#125;</span><br><span class="line">            admin.createTable(tableDescriptor.build());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertData</span><span class="params">(String tableName, String rowKey, String colFamily, String col, String val)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        <span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(rowKey.getBytes());</span><br><span class="line">        put.addColumn(colFamily.getBytes(), col.getBytes(), val.getBytes());</span><br><span class="line">        table.put(put);</span><br><span class="line">        table.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(String tableName, String rowKey, String colFamily, String col)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        <span class="type">Get</span> <span class="variable">get</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Get</span>(rowKey.getBytes());</span><br><span class="line">        get.addColumn(colFamily.getBytes(), col.getBytes());</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> table.get(get);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(result.getValue(colFamily.getBytes(), col == <span class="literal">null</span> ? <span class="literal">null</span> : col.getBytes())));</span><br><span class="line">        table.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆç¼–å†™å¥½çš„é¡¹ç›®ç»“æ„å’Œä»£ç å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81(1).png" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81(2).png" style="zoom: 67%;">

<p>é¡¹ç›®ç©ºç™½å¤„å³é”® <code>Run</code> å¼€å§‹è¿è¡Œç¨‹åºï¼Œç¨‹åºè¿è¡ŒæˆåŠŸä»¥åï¼Œä¼šåœ¨è¿è¡Œç»“æœä¸­å‡ºç°  <code>69</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C69.png" style="zoom: 67%;">

<p>æ‰“å°å‡ºæ¥çš„ <code>69</code> ä¸Šé¢æ˜¯æ—¥å¿—çš„è­¦å‘Šä¿¡æ¯ï¼Œå¯ä»¥å¿½ç•¥ã€‚</p>
<p>è¿™æ—¶ï¼Œå¯ä»¥åˆ° HBase Shell äº¤äº’å¼ç¯å¢ƒä¸­ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ student è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰çš„è¡¨</span></span><br><span class="line">list</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ student è¡¨çš„å…¨éƒ¨æ•°æ®</span></span><br><span class="line">scan &#x27;student&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8Bjava%E5%88%9B%E5%BB%BAstudent%E8%A1%A8%E7%BB%93%E6%9E%9C.png"></p>
<p>è‡³æ­¤ä½¿ç”¨ Java ä»£ç æ“ä½œ HBase æˆåŠŸï¼ï¼ï¼ï¼</p>
<h1 id="5-Hive"><a href="#5-Hive" class="headerlink" title="5. Hive"></a>5. Hive</h1><p>å®˜æ–¹ä»‹ç»ï¼šApache Hive is a distributed, fault-tolerant data warehouse system that enables analytics at a massive scale. Hive Metastore(HMS) provides a central repository of metadata that can easily be analyzed to make informed, data driven decisions, and therefore it is a critical component of many data lake architectures. Hive is built on top of Apache Hadoop and supports storage on S3, adls, gs etc though hdfs. Hive allows users to read, write, and manage petabytes of data using SQL.</p>
<h2 id="5-1-Hive-ä¸‹è½½ä¸å®‰è£…"><a href="#5-1-Hive-ä¸‹è½½ä¸å®‰è£…" class="headerlink" title="5.1 Hive ä¸‹è½½ä¸å®‰è£…"></a>5.1 Hive ä¸‹è½½ä¸å®‰è£…</h2><p><a href="https://downloads.apache.org/hive/">å®˜ç½‘ä¸‹è½½</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hive%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(1).png" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hive%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD(2).png" style="zoom: 80%;">

<p>æ‰“ä¸å¼€å®˜ç½‘ï¼Ÿè¯•è¯•æ¸…<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/">åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ä¸‹è½½</a>ğŸ˜€</p>
<p>ä¸‹è½½å¥½ä¹‹åå°±å¯ä»¥å¼€å§‹å®‰è£…äº†ï¼š</p>
<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© Hive å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå¹¶å¯¹è§£å‹ç¼©ä¹‹åçš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œæˆæƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼© Hive  å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf apache-hive-3.1.2-bin.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">mv</span> ./apache-hive-3.1.2-bin ./hive-3.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™</span></span><br><span class="line"><span class="comment"># muyoukule:muyoukule æ˜¯ç”¨æˆ·ç»„å’Œç”¨æˆ·åï¼Œè®°å¾—æ¢æˆå½“å‰ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule:muyoukule hive-3.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>3ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hive ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/usr/local/hive-3.1.2</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEHive%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom:67%;">

<p>4ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>5ã€ä¿®æ”¹<code>/usr/local/hive-3.1.2/conf</code>ä¸‹çš„ hive-site.xml(<strong>æ³¨æ„è‡ªå·±çš„è·¯å¾„</strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/hive-3.1.2/conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† hive-default.xml.template é‡å‘½åä¸º hive-default.xml</span></span><br><span class="line"><span class="built_in">mv</span> hive-default.xml.template hive-default.xml</span><br></pre></td></tr></table></figure>

<p>6ã€ä½¿ç”¨ gedit ç¼–è¾‘å™¨æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ <code>hive-site.xml</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æ“ä½œè™šæ‹Ÿæœºä½¿ç”¨ gedit ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo gedit /usr/local/hive-3.1.2/conf/hive-site.xml</span><br></pre></td></tr></table></figure>

<p>7ã€åœ¨ <code>hive-site.xml</code> ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- jdbc è¿æ¥çš„ URLï¼šhive æ˜¯æ•°æ®åº“åç§°ï¼Œåç§°éšæ„ä½†è¦ä¸åé¢åˆ›å»ºçš„æ•°æ®åº“åç§°ç›¸å¯¹åº”--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true<span class="symbol">&amp;amp;</span>useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>JDBC connect string for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- jdbc è¿æ¥çš„ Driverï¼šæ ¹æ®è‡ªå·±MySQL çš„ç‰ˆæœ¬é€‰æ‹©å¯¹åº”çš„Driverï¼Œ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Driver class name for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- jdbc è¿æ¥çš„ username--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>username to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- jdbc è¿æ¥çš„ password--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>password to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ·»åŠ åä¿å­˜å¹¶é€€å‡ºå³å¯ã€‚</p>
<h2 id="5-2-é…ç½®-MySQL"><a href="#5-2-é…ç½®-MySQL" class="headerlink" title="5.2 é…ç½® MySQL"></a>5.2 é…ç½® MySQL</h2><p>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ MySQL æ•°æ®åº“ä¿å­˜ Hive çš„å…ƒæ•°æ®ï¼Œè€Œä¸æ˜¯é‡‡ç”¨ Hive è‡ªå¸¦çš„ derby æ¥å­˜å‚¨å…ƒæ•°æ®ã€‚</p>
<p><strong>ä¸‹è½½ mysql jdbc åŒ…</strong></p>
<p><a href="https://dev.mysql.com/downloads/connector/j/">å®˜ç½‘ä¸‹è½½</a></p>
<p>æ‰“å¼€é»˜è®¤æ˜¯æœ€æ–°ç‰ˆï¼Œä¹Ÿå¯ä»¥ç‚¹å‡» <code>Archives</code> é€‰æ‹©å†å²ç‰ˆæœ¬ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/mysql%20jdbc%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD.png" style="zoom: 50%;">

<p>é€‰æ‹©å†å²ç‰ˆæœ¬åç‚¹å‡» <code>Download</code> è¿›è¡Œä¸‹è½½ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/mysql%20jdbc%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD.png" style="zoom: 50%;">

<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼©æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå¹¶å¯¹å°† <code>mysql-connector-java-5.1.40-bin.jar</code> æ‹·è´åˆ° hive çš„ lib ç›®å½•ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼©æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf mysql-connector-java-5.1.48.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† mysql-connector-java-5.1.48-bin.jar æ‹·è´åˆ° /usr/local/hive-3.1.2/lib ç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.48/mysql-connector-java-5.1.48-bin.jar  /usr/local/hive-3.1.2/lib </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´åå¯ä»¥æŸ¥çœ‹æ˜¯å¦æ‹·è´æˆåŠŸ</span></span><br><span class="line">find ./hive-3.1.2/lib -<span class="built_in">type</span> f -name <span class="string">&quot;mysql-connector-java-5.1.48-bin.jar&quot;</span></span><br></pre></td></tr></table></figure>

<p>3ã€å¯åŠ¨å¹¶ç™»é™† mysql shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨mysqlæœåŠ¡</span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç™»é™† shell ç•Œé¢</span></span><br><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>4ã€æ–°å»º Hive æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è¿™ä¸ª hive æ•°æ®åº“ä¸ hive-site.xml ä¸­localhost:3306/hiveçš„ hive å¯¹åº”ï¼Œç”¨æ¥ä¿å­˜ hive å…ƒæ•°æ®</span><br><span class="line">create database hive;    </span><br></pre></td></tr></table></figure>

<p>5ã€é…ç½® MySQL å…è®¸ Hive æ¥å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å°†æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨çš„æ‰€æœ‰æƒé™èµ‹ç»™hiveç”¨æˆ·ï¼Œåé¢çš„ hive æ˜¯é…ç½® hive-site.xml ä¸­é…ç½®çš„è¿æ¥å¯†ç </span><br><span class="line">grant all on *.* to root@localhost identified by &#x27;root&#x27;;</span><br><span class="line"></span><br><span class="line"># åˆ·æ–° mysql ç³»ç»Ÿæƒé™å…³ç³»è¡¨</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>

<p>6ã€å¯åŠ¨ Hive(å¯åŠ¨ Hive ä¹‹å‰ï¼Œè¯·å…ˆå¯åŠ¨ Hadoop )</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯åŠ¨hadoop</span></span><br><span class="line">start-all.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨hive</span></span><br><span class="line">hive</span><br></pre></td></tr></table></figure>

<p>å‡å¦‚åœ¨å¯åŠ¨æ—¶æŠ¥é”™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">org.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : &quot;`VERSION`&quot; in Catalog &quot;&quot; Schema &quot;&quot;. DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable &quot;datanucleus.schema.autoCreateTables&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Hive%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99.png"></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>å…ˆé€€å‡º Hiveï¼Œå†æ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€€å‡º Hive</span></span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– Hive çš„å…ƒæ•°æ®å­˜å‚¨çš„ schema</span></span><br><span class="line">schematool -dbType mysql -initSchema</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°å¦‚ä¸‹å†…å®¹å³ä»£è¡¨åˆå§‹åŒ–å®Œæ¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%88%90%E5%8A%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E5%85%83%E6%95%B0%E6%8D%AE%E5%BA%93.png"></p>
<p>åˆå§‹åŒ–åå†æ¬¡ä½¿ç”¨ <code>hive</code> å¯åŠ¨ Hiveï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸå¯åŠ¨ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%88%90%E5%8A%9F%E5%90%AF%E5%8A%A8Hive.png"></p>
<p>å¯åŠ¨è¿›å…¥ Hive çš„äº¤äº’å¼æ‰§è¡Œç¯å¢ƒä»¥åï¼Œä¼šå‡ºç°å¦‚ä¸‹å‘½ä»¤æç¤ºç¬¦ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive&gt;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨é‡Œé¢è¾“å…¥ SQL è¯­å¥ï¼Œå¦‚æœè¦é€€å‡º Hive äº¤äº’å¼æ‰§è¡Œç¯å¢ƒï¼Œå¯ä»¥è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">exit;	# æˆ–è€… Ctrl <span class="operator">+</span> d</span><br></pre></td></tr></table></figure>

<h1 id="6-Sqoop"><a href="#6-Sqoop" class="headerlink" title="6. Sqoop"></a>6. Sqoop</h1><p>Sqoop æ˜¯ä¸€æ¬¾å¼€æºå·¥å…·ï¼Œä¸“æ³¨äºåœ¨ Hadoop(Hive)ä¸ä¼ ç»Ÿæ•°æ®åº“(å¦‚ MySQLã€PostgreSQL ç­‰)ä¹‹é—´é«˜æ•ˆä¼ è¾“å¤§æ‰¹é‡æ•°æ®ã€‚å®ƒå¯ä»¥å°†å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®å¯¼å…¥åˆ° Hadoop çš„ HDFSã€Hiveã€HBase ç­‰æ•°æ®å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œä¹Ÿå¯ä»¥ä» Hadoop çš„æ–‡ä»¶ç³»ç»Ÿä¸­å¯¼å‡ºæ•°æ®åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚Sqoop çš„æ ¸å¿ƒè®¾è®¡æ€æƒ³æ˜¯åˆ©ç”¨MapReduceåŠ å¿«æ•°æ®ä¼ è¾“é€Ÿåº¦ï¼Œå®ç°æ‰¹å¤„ç†æ–¹å¼è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>
<h2 id="6-1-Sqoopä¸‹è½½ä¸å®‰è£…"><a href="#6-1-Sqoopä¸‹è½½ä¸å®‰è£…" class="headerlink" title="6.1 Sqoopä¸‹è½½ä¸å®‰è£…"></a>6.1 Sqoopä¸‹è½½ä¸å®‰è£…</h2><p><a href="https://archive.apache.org/dist/sqoop/">å®˜ç½‘ä¸‹è½½</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/sqoop%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD1.png" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/sqoop%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD2.png" style="zoom:67%;">

<p>ä¸‹è½½å¥½ä¹‹åå°±å¯ä»¥å¼€å§‹å®‰è£…äº†ï¼š</p>
<p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© Sqoop å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå¹¶å¯¹è§£å‹ç¼©ä¹‹åçš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œæˆæƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼© Sqoop å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">mv</span> ./sqoop-1.4.7.bin__hadoop-2.6.0 ./sqoop-1.4.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™</span></span><br><span class="line"><span class="comment"># muyoukule:muyoukule æ˜¯ç”¨æˆ·ç»„å’Œç”¨æˆ·åï¼Œè®°å¾—æ¢æˆå½“å‰ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule:muyoukule sqoop-1.4.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>sqoop-env.sh</code></p>
<p>è¿›å…¥åˆ° conf æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ° <code>sqoop-env-template.sh</code>ï¼Œä¿®æ”¹å…¶åç§°ä¸º <code>sqoop-env.sh</code> ã€‚ç„¶åç¼–è¾‘ <code>sqoop-env.sh</code> æ–‡ä»¶ï¼Œè®¾ç½®<code>HADOOP_COMMON_HOME</code>ï¼Œ<code>HADOOP_MAPRED_HOME</code>ï¼Œ<code>HIVE_HOME</code> ç­‰ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°† sqoop-env-template.sh å¤åˆ¶ä¸€ä»½å¹¶å‘½åä¸º sqoop-env.sh</span></span><br><span class="line"><span class="built_in">cp</span> ./sqoop-1.4.7/conf/sqoop-env-template.sh ./sqoop-1.4.7/conf/sqoop-env.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘ sqoop-env.sh</span></span><br><span class="line">vim ./sqoop-1.4.7/conf/sqoop-env.sh</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ <code>sqoop-env.sh</code> çš„å¦‚ä¸‹ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½® Hadoop çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=/usr/local/hadoop-3.1.3</span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=/usr/local/hadoop-3.1.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® HBase çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/usr/local/hbase-2.2.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® Hive çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/usr/local/hive-3.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¦‚æœé…ç½®äº† ZooKeeper,ä¹Ÿéœ€è¦åœ¨æ­¤é…ç½® ZooKeeper çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">#export ZOOCFGDIR= </span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºåœ¨ <code>sqoop-env.sh</code> æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨æœ‰å¦‚ä¸Šè¿™å‡ ä¸ªå˜é‡ï¼Œåªæ˜¯è¢«æ³¨é‡Šæ‰äº†ï¼Œä¹Ÿå°±æ˜¯å‰é¢å¸¦äº† <code>#</code> å·ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥ç›´æ¥å¯»æ‰¾åˆ°å¯¹åº”çš„å˜é‡ï¼Œå°†å‰é¢èµ·æ³¨é‡Šä½œç”¨çš„ <code>#</code> å·åˆ å»ï¼Œç„¶åä¿®æ”¹åé¢çš„å€¼å³å¯ã€‚</p>
<p><strong>PSï¼švim ç¼–è¾‘å™¨æ€æ ·æœç´¢å­—ç¬¦ä¸²ï¼Ÿ</strong></p>
<ul>
<li>æ™®é€šæ¨¡å¼ä¸‹ï¼ŒæŒ‰ä¸‹ <code>/</code> é”®ï¼Œç„¶åè¾“å…¥ä½ æƒ³è¦æœç´¢çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ä¸‹ <code>Enter</code> é”®å¼€å§‹æœç´¢ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>n</code>ã€‚</li>
<li>è¦æŸ¥æ‰¾ä¸Šä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ <code>N</code>ã€‚</li>
</ul>
<p>ä½†æ˜¯æˆ‘å¾ˆæ‡’ä¸æƒ³å»æ‰¾ğŸ™„ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å†™åœ¨æ–‡ä»¶é¡¶éƒ¨äº†ï¼Œè¿™ä¸ªæ˜¯ä¸å½±å“è¿è¡Œæ“ä½œçš„ï¼Œå…·ä½“å›¾ç¤ºå¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/sqoop-env.sh.png" style="zoom: 67%;">

<p>4ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sqoop ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> SQOOP_HOME=/usr/local/sqoop-1.4.7</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SQOOP_HOME</span>/bin</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AESqoop%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom:67%;">

<p>5ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>6ã€æ£€æŸ¥å®‰è£…ç»“æœï¼Œå‡ºç°ä¸‹é¢ä¿¡æ¯ä»£è¡¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ Sqoop ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">sqoop version</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%A3%80%E6%9F%A5Sqoop%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png"></p>
<p>ä¸Šé¢çš„è­¦å‘Šæ˜¯å› ä¸ºä¸€äº›ç»„ä»¶(HCatalogã€Accumuloå’ŒZookeeper)å¯¼è‡´çš„ï¼Œæˆ‘ä»¬åç»­ä¸ä¼šç”¨åˆ°è¿™äº›ç»„ä»¶æ‰€ä»¥ä¸ç”¨ç®¡å®ƒã€‚</p>
<p>è¿™æ ·ï¼ŒSqoop å°±å®‰è£…å¥½äº†ã€‚</p>
<h2 id="6-2-é…ç½®-MySQL"><a href="#6-2-é…ç½®-MySQL" class="headerlink" title="6.2 é…ç½® MySQL"></a>6.2 é…ç½® MySQL</h2><p>1ã€æ·»åŠ  MySQL é©±åŠ¨</p>
<p>å°† MySQL çš„ JDBC é©±åŠ¨åŒ…(ä¾‹å¦‚ <code>mysql-connector-java-5.1.40-bin.jar</code> )æ·»åŠ åˆ° Sqoop çš„ lib ç›®å½•ä¸‹ã€‚<strong>PSï¼šä½ çš„ MySQL é©±åŠ¨è¦å’Œä½ çš„æ•°æ®åº“ç‰ˆæœ¬å…¼å®¹ã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† mysql-connector-java-5.1.48-bin.jar æ‹·è´åˆ° /usr/local/sqoop-1.4.7/lib ç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">cp</span> ./mysql-connector-java-5.1.48/mysql-connector-java-5.1.48-bin.jar /usr/local/sqoop-1.4.7/lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´åå¯ä»¥æŸ¥çœ‹æ˜¯å¦æ‹·è´æˆåŠŸ</span></span><br><span class="line">find ./sqoop-1.4.7/lib -<span class="built_in">type</span> f -name <span class="string">&quot;mysql-connector-java-5.1.48-bin.jar&quot;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æµ‹è¯•ä¸ MySQL çš„è¿æ¥</p>
<p>é¦–å…ˆè¯·ç¡®ä¿ MySQL æœåŠ¡å·²ç»å¯åŠ¨äº†ï¼Œå¦‚æœæ²¡æœ‰å¯åŠ¨ï¼Œè¯·æ‰§è¡Œä¸‹é¢å‘½ä»¤å¯åŠ¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ£€æŸ¥ MySQL æœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ MySQL</span></span><br><span class="line">sudo systemctl start mysqld   </span><br></pre></td></tr></table></figure>

<p>3ã€ç„¶åå°±å¯ä»¥æµ‹è¯• Sqoop ä¸ MySQL ä¹‹é—´çš„è¿æ¥æ˜¯å¦æˆåŠŸï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://127.0.0.1:3306/ --username root -P</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°é”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WARN: Establishing SSL connection without server&#x27;s identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn&#x27;t set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to &#x27;false&#x27;. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.</span><br><span class="line">2024-03-23 21:20:32,889 ERROR manager.CatalogQueryManager: Failed to list databases</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆæ£€æŸ¥åœ¨é…ç½® jdbc è¿æ¥çš„ URLæ˜¯æ˜¯å¦åŠ äº† <code>useSSL=false</code> å‚æ•°ã€‚å¦‚æœæ²¡åŠ ï¼Œå°†å®ƒåŠ ä¸Šåå†æ¬¡æµ‹è¯•ï¼›å¦‚æœåŠ äº†ä¹ŸæŠ¥è¿™ä¸ªé”™è¯¯åˆ™ä¾æ¬¡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç™»å…¥æ•°æ®åº“</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ˜¯å¦å¼€å¯SSL</span></span><br><span class="line">SHOW VARIABLES LIKE &#x27;%ssl%&#x27;;</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8B%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AFSSL.png" style="zoom: 80%;">

<p>çœ‹åˆ° <code>have_ssl</code> çš„å€¼ä¸º <code>YES</code>ï¼Œè¡¨ç¤ºå·²å¼€å¯ SSLã€‚( <code>have_openssl</code>  è¡¨ç¤ºæ˜¯å¦æ”¯æŒSSL)ã€‚éœ€è¦å°† SSL å…³é—­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ MySQL é…ç½®æ–‡ä»¶ï¼Œç›®å½•æ ¹æ®å®‰è£…æ—¶è‡ªè¡ŒæŸ¥æ‰¾</span></span><br><span class="line">sudo vim /etc/my.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  disable_ssl å’Œ skip_ssl å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å®Œåé‡å¯ MySQL æœåŠ¡</span></span><br><span class="line">sudo systemctl restart mysqld</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE.png" style="zoom: 67%;">

<p>é‡å¯åå†æ¬¡æµ‹è¯• ï¼ŒMySQL çš„æ•°æ®åº“åˆ—è¡¨æ˜¾ç¤ºåœ¨å±å¹•ä¸Šè¡¨ç¤ºè¿æ¥æˆåŠŸï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://127.0.0.1:3306/ --username root -P</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97%E8%A1%A8.png"></p>
<h1 id="Linux-å®‰è£…ä½¿ç”¨-IDEA"><a href="#Linux-å®‰è£…ä½¿ç”¨-IDEA" class="headerlink" title="Linux å®‰è£…ä½¿ç”¨ IDEA"></a>Linux å®‰è£…ä½¿ç”¨ IDEA</h1><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ <strong>IDEA 2023.3.6 ç‰ˆæœ¬å’Œ CentOS7 ç³»ç»Ÿ</strong>	å…¶ä»–ç‰ˆæœ¬å’Œç³»ç»Ÿä»…ä½œå‚è€ƒã€‚</p>
<p><font color="red">PSï¼šLinux ä¸­å®‰è£…ä½¿ç”¨ IDEA å¿…é¡»ç›´æ¥æ“ä½œè™šæ‹Ÿæœºï¼Œä¸èƒ½åœ¨è¿œç¨‹è¿æ¥å·¥å…·æ“ä½œï¼Œå¦åˆ™ä¼šæ‰“ä¸å¼€ IDEAã€‚</font>ğŸ˜…</p>
<p>æˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯<del>å…è´¹</del>ç¤¾åŒºç‰ˆï¼Œç¤¾åŒºç‰ˆåŠŸèƒ½å°‘è™½ç„¶å°‘ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå¤Ÿç”¨ã€‚ä½†æ˜¯å¦‚æœä½ æœ‰ç‰¹å®šéœ€æ±‚ï¼Œéœ€è¦æ›´å¤šçš„é«˜çº§åŠŸèƒ½å’Œå®šåˆ¶é€‰é¡¹ï¼Œå»ºè®®é€‰æ‹©<del>æ”¶è´¹</del>ä¼ä¸šç‰ˆğŸ˜ï¼Œå½“ç„¶ç ´è§£ç ç½‘ä¸Šéƒ½å¯ä»¥æ‰¾åˆ°ï¼Œå®‰è£…æ­¥éª¤æ˜¯ä¸€æ ·çš„ï¼Œå¤§å®¶æœ‰éœ€æ±‚å¯ä»¥è‡ªè¡Œå»ç½‘ä¸ŠæŸ¥æ‰¾ç›¸å…³æ•™ç¨‹ã€‚</p>
<h2 id="IDEA-çš„ä¸‹è½½"><a href="#IDEA-çš„ä¸‹è½½" class="headerlink" title="IDEA çš„ä¸‹è½½"></a>IDEA çš„ä¸‹è½½</h2><p>æˆ‘è¿™é‡Œæ˜¯åœ¨æœ¬æœºä¸Šä¸‹è½½å®‰è£…åŒ…ç„¶åä¸Šä¼ åˆ°è™šæ‹Ÿæœºï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ Linux ä¸­æ‰“å¼€ Firefox æµè§ˆå™¨è¿›è¡Œä¸‹è½½ã€‚</p>
<p><a href="https://www.jetbrains.com/zh-cn/idea/download/other.html">ä¸‹è½½å®˜ç½‘</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BDidea.png">

<h2 id="IDEA-çš„å®‰è£…"><a href="#IDEA-çš„å®‰è£…" class="headerlink" title="IDEA çš„å®‰è£…"></a>IDEA çš„å®‰è£…</h2><p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© IDEA å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå¹¶å¯¹è§£å‹ç¼©ä¹‹åçš„æ–‡ä»¶è¿›è¡Œé‡å‘½å</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼© IDEA å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf ideaIC-2023.3.6.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">mv</span> ./idea-IC-233.15026.9 ./idea-2023.3.6</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥æ–‡ä»¶ idea-2023.3.6 çš„ bin ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> idea-2023.3.6/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° bin ç›®å½•ä¸‹æœ‰ä¸ª idea.sh æ–‡ä»¶ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8Bidea%E7%9A%84bin%E7%9B%AE%E5%BD%95.png"></p>
<p>3ã€è¿è¡Œ idea.sh æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./idea.sh</span><br></pre></td></tr></table></figure>

<p>å‡å¦‚ä½ è§‰å¾—æ¯æ¬¡é€šè¿‡ <code>./idea.sh</code> æŒ‡ä»¤å¯åŠ¨ IDEA è¦è¿›å…¥åˆ° IDEA çš„ç¯å¢ƒç›®å½•å¾ˆéº»çƒ¦ï¼Œä½ ä¹Ÿå¯ä»¥ä¸º IDEA é…ç½®ç¯å¢ƒå˜é‡(ä¸è§‰å¾—éº»çƒ¦çš„å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ğŸ˜„)ï¼š</p>
<p>1ã€ä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># IDEA ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> IDEA_HOME=/usr/local/idea-2023.3.6</span><br><span class="line"><span class="built_in">export</span> PATH=:<span class="variable">$PATH</span>:<span class="variable">$&#123;IDEA_HOME&#125;</span>/bin</span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEIDEA%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom: 67%;">

<p>2ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>3ã€ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ç›®å½•ä¸‹è¾“å…¥ <code>idea.sh</code> å¯åŠ¨ IDEA å›¾å½¢åŒ–ç•Œé¢äº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ IDEA å›¾å½¢åŒ–ç•Œé¢</span></span><br><span class="line">idea.sh</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€æ¬¡å¯åŠ¨ IDEA å›¾å½¢åŒ–ç•Œé¢åä¼šä¾æ¬¡å¼¹å‡ºä»¥ä¸‹ç•Œé¢ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤æ“ä½œå³å¯ï¼š</p>
<p>1ã€æ‰“é’©å¹¶ç‚¹å‡» <code>Continue</code> </p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E5%90%AF%E5%8A%A8(1).png" style="zoom: 67%;">

<p>2ã€å‡ºç° â€œDate Sharingâ€  çª—å£ï¼Œç‚¹å‡» <code>Don&#39;t Send</code> </p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E5%90%AF%E5%8A%A8(2).png" style="zoom:67%;">

<p>3ã€å‰é¢æ­¥éª¤æ“ä½œå®Œåï¼Œä¼šå‡ºç° IDEA ç•Œé¢</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E5%90%AF%E5%8A%A8(3).png" style="zoom: 50%;">

<p>è‡³æ­¤ IDEA å®‰è£…å®Œæˆï¼ï¼æ˜¯ä¸æ˜¯è¶…çº§ç®€å•ï¼ï¼!ğŸ˜€</p>
<h2 id="IDEA-çš„ä½¿ç”¨"><a href="#IDEA-çš„ä½¿ç”¨" class="headerlink" title="IDEA çš„ä½¿ç”¨"></a>IDEA çš„ä½¿ç”¨</h2><p>1ã€ç‚¹å‡» <code>New Project</code> æ–°å»ºé¡¹ç›®</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(1).png" style="zoom:50%;">

<p>2ã€ä¿®æ”¹é¡¹ç›®åç§°ï¼Œé€‰æ‹© JDK( IDEA ä¼šè¯†åˆ«åˆ°ç³»ç»Ÿä¸‹å®‰è£…è¿‡çš„ JDK ä½œä¸ºé»˜è®¤é¡¹)ï¼Œå¦‚æœæ²¡æœ‰ JDKï¼Œéœ€è¦ç‚¹å‡» <code>Download JDK</code> è¿›è¡Œä¸‹è½½</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(2).png" style="zoom:50%;">

<p>2ã€IDEA æç¤º Untrusted Serverâ€™s certificate ï¼Œè¯ä¹¦ä¸å¯ç”¨( Serverâ€™s certificate is not trusted )ï¼Œä¸ç”¨ç®¡ï¼Œç‚¹å‡»  <code>Accept</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(3).png" style="zoom:50%;">

<p>4ã€IDEA é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œç­‰å¾…å³ä¸‹è§’ JDK åŠ è½½å®Œæˆååœ¨é¡¹ç›®ç©ºç™½å¤„å³é”®ç‚¹å‡» <code>Run</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(4).png" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(5).png" style="zoom:50%;">

<p>5ã€ä¹‹åçœ‹è§æ§åˆ¶å°æˆåŠŸè¾“å‡ºç»“æœï¼ŒæˆåŠŸï¼ï¼ï¼</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E7%9A%84%E4%BD%BF%E7%94%A8(6).png" style="zoom:50%;">

<p> è‡³æ­¤ï¼ŒIDEA æ–°å»ºé¡¹ç›®æˆåŠŸï¼å°±å¯ä»¥è¿›è¡Œ Java ä»£ç çš„ç¼–å†™äº†ï¼ï¼ï¼</p>
<h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><p>Mavenæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œä¸»è¦æœåŠ¡äºJavaé¡¹ç›®ã€‚å®ƒé€šè¿‡å¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ ‡å‡†åŒ–å’Œè‡ªåŠ¨åŒ–ï¼Œå®ç°äº†ä¾èµ–ç®¡ç†çš„ç®€åŒ–ï¼Œä»è€Œæå¤§åœ°æå‡äº†å¼€å‘æ•ˆç‡ï¼Œå¹¶ç¡®ä¿äº†é¡¹ç›®çš„é«˜è´¨é‡è¾“å‡ºã€‚Mavençš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬é¡¹ç›®æ„å»ºã€ä¾èµ–ç®¡ç†å’Œé¡¹ç›®ä¿¡æ¯ç®¡ç†ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªç»Ÿä¸€ã€é«˜æ•ˆçš„å¹³å°æ¥ç®¡ç†å¤æ‚çš„Javaé¡¹ç›®ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº Maven çš„çŸ¥è¯†è¯·ä¸Šç½‘æŸ¥é˜…ï¼Œè¿™é‡Œåªåšç®€å•ä»‹ç»ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨åˆ°äº†ä¾èµ–ç®¡ç†åŠŸèƒ½ï¼šé‡‡ç”¨ <code>pom.xml</code> æ¥å¯¼å…¥ä¾èµ–ï¼Œå¯ä»¥è‡ªåŠ¨ä¸‹è½½ jarï¼Œä»¥åŠå…¶æ‰€ä¾èµ– jarï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½ï¼Œæ‹·è´ jar åˆ°é¡¹ç›®ä¸­ã€‚ç®€å•ç†è§£å°±æ˜¯æ‰¾ jar åŒ…å¤ªéº»çƒ¦äº†ï¼Œæˆ‘æ‡’å¾—è‡ªå·±æ‰¾ï¼Œè®© Maven å¸®æˆ‘æ‰¾ã€‚ğŸ˜</p>
<h2 id="Maven-ä¸‹è½½"><a href="#Maven-ä¸‹è½½" class="headerlink" title="Maven ä¸‹è½½"></a>Maven ä¸‹è½½</h2><p><a href="https://maven.apache.org/download.cgi">ä¸‹è½½å®˜ç½‘</a></p>
<p>ç›´æ¥ç‚¹å‡»ä¸‹è½½æœ€æ–°ç‰ˆæˆ–è€…ä¸‹è½½ä»¥å‰çš„ç‰ˆæœ¬</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Maven%E4%B8%8B%E8%BD%BD%E5%AE%98%E7%BD%91%20.png"></p>
<p>ç‚¹å‡» <code>legacy archives</code> è¿›å…¥é¡µé¢è‡ªè¡Œé€‰æ‹©ç›¸åº”ç‰ˆæœ¬å³å¯ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/maven%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC.png" style="zoom: 67%;">

<p>æ‰“ä¸å¼€å®˜ç½‘ï¼Ÿè¯•è¯•<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/maven/">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ä¸‹è½½</a>ã€‚</p>
<h2 id="Maven-å®‰è£…"><a href="#Maven-å®‰è£…" class="headerlink" title="Maven å®‰è£…"></a>Maven å®‰è£…</h2><p>1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ° Linux çš„ &#x2F; ç›®å½•(å…·ä½“è¯·å‚è€ƒä¸Šæ–‡ <strong>FinalShell æ–‡ä»¶ä¸Šä¼ </strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"></span><br><span class="line">sudo rz</span><br></pre></td></tr></table></figure>

<p>2ã€è§£å‹ç¼© Maven å®‰è£…æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local ç›®å½•ï¼Œå¹¶å¯¹è§£å‹ç¼©ä¹‹åçš„æ–‡ä»¶è¿›è¡Œé‡å‘½å</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼© Maven å®‰è£…æ–‡ä»¶åˆ° /usr/local ç›®å½•</span></span><br><span class="line">sudo tar -zxvf apache-maven-3.9.6-bin.tar.gz -C /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥åˆ° /usr/local ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">mv</span> ./apache-maven-3.9.6 ./maven-3.9.6</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">ll</span><br></pre></td></tr></table></figure>

<p>3ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ä¿®æ”¹ &#x2F;etc&#x2F;profile æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ /etc/profile æ–‡ä»¶</span></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maven ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/usr/local/maven-3.9.6</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$MAVEN_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E9%85%8D%E7%BD%AEMaven%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png" style="zoom:67%;">

<p>4ã€é‡å¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>5ã€æ£€æŸ¥å®‰è£…ç»“æœï¼Œå‡ºç°ä¸‹é¢ä¿¡æ¯ä»£è¡¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ Maven ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">mvn -version</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8BMaven%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF.png"></p>
<p>è¿™æ ·ï¼ŒMaven å°±å®‰è£…å¥½äº†ã€‚</p>
<h2 id="Maven-ä»“åº“é…ç½®"><a href="#Maven-ä»“åº“é…ç½®" class="headerlink" title="Maven ä»“åº“é…ç½®"></a>Maven ä»“åº“é…ç½®</h2><blockquote>
<p>æ€ä¹ˆç†è§£ Maven ä»“åº“ï¼Ÿ</p>
</blockquote>
<p>Maven ä»“åº“ä¸»è¦ç”¨äºç®¡ç†é¡¹ç›®çš„ä¾èµ–å’Œæ’ä»¶ã€‚å®ƒæ˜¯ Maven çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œå¯¹äº Maven é¡¹ç›®çš„æ„å»ºå’Œç®¡ç†èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒMaven ä»“åº“å¯ä»¥åˆ†ä¸ºæœ¬åœ°ä»“åº“ã€ä¸­å¤®ä»“åº“å’Œè¿œç¨‹ä»“åº“ã€‚æœ¬åœ°ä»“åº“ä½äºç”¨æˆ·çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œç”¨äºå­˜å‚¨é¡¹ç›®æ‰€éœ€çš„ä¾èµ–(jaråŒ…)å’Œæ’ä»¶ã€‚å½“ Maven æ„å»ºé¡¹ç›®æ—¶ï¼Œå®ƒé¦–å…ˆä¼šåœ¨æœ¬åœ°ä»“åº“ä¸­æŸ¥æ‰¾æ‰€éœ€çš„ä¾èµ–å’Œæ’ä»¶ã€‚å¦‚æœæœ¬åœ°ä»“åº“ä¸­æ²¡æœ‰ï¼ŒMaven ä¼šå°è¯•ä»ä¸­å¤®ä»“åº“æˆ–è¿œç¨‹ä»“åº“ä¸­ä¸‹è½½ã€‚</p>
<p>ä¸­å¤®ä»“åº“æ˜¯ Maven çš„å®˜æ–¹ä»“åº“ï¼Œå…¶ä¸­åŒ…å«äº†å¤§é‡å¼€æºçš„ Java åº“å’Œæ’ä»¶ã€‚å®ƒä½äº Maven çš„æœåŠ¡å™¨ä¸Šï¼Œæ˜¯ Maven ç¤¾åŒºå…±äº«èµ„æºçš„åœ°æ–¹ã€‚é€šè¿‡ä¸­å¤®ä»“åº“ï¼ŒMavenç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°è·å–åˆ°å„ç§å¼€æºé¡¹ç›®çš„ä¾èµ–å’Œæ’ä»¶ã€‚</p>
<p>é™¤äº†ä¸­å¤®ä»“åº“å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„è¿œç¨‹ä»“åº“ï¼Œå®ƒä»¬å¯èƒ½ç”±ç¬¬ä¸‰æ–¹æä¾›ï¼Œç”¨äºå­˜å‚¨ç‰¹å®šçš„ä¾èµ–å’Œæ’ä»¶ã€‚è¿™äº›è¿œç¨‹ä»“åº“å¯ä»¥ä½œä¸ºä¸­å¤®ä»“åº“çš„è¡¥å……ï¼Œä½¿å¾—Mavenç”¨æˆ·å¯ä»¥è·å–åˆ°æ›´å¤šçš„èµ„æºã€‚</p>
<blockquote>
<p>é…ç½®æœ¬åœ°ä»“åº“</p>
</blockquote>
<p>1ã€æ–°å»ºå­˜æ”¾ä»“åº“çš„æ–‡ä»¶å¤¹(æœ¬åœ°ä»“åº“)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨ /usr/local/ ä¸‹åˆ›å»º åä¸º maven_repo çš„æœ¬åœ°ä»“åº“</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> /usr/local/maven_repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠ Maven æœ¬åœ°ä»“åº“ç›®å½•æƒé™èµ‹äºˆç»™ muyoukule ç”¨æˆ·(å½“å‰ç™»é™†ç”¨æˆ·)</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule /usr/local/maven_repo</span><br></pre></td></tr></table></figure>

<p>2ã€æ‰“å¼€ <code>setting.xml</code> æ–‡ä»¶(<strong>æ³¨æ„è‡ªå·±å­˜æ”¾çš„è·¯å¾„</strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æ“ä½œè™šæ‹Ÿæœºä½¿ç”¨ gedit ä¿®æ”¹ maven é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo gedit /usr/local/maven-3.9.6/conf/settings.xml</span><br></pre></td></tr></table></figure>

<p>3ã€æ·»åŠ è·¯å¾„(<strong>æ³¨æ„è‡ªå·±å­˜æ”¾çš„è·¯å¾„</strong>)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/usr/local/maven_repo<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Maven%E9%85%8D%E7%BD%AE%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93.png" style="zoom: 80%;">

<blockquote>
<p>é…ç½®è¿œç¨‹ä»“åº“</p>
</blockquote>
<p>ä¹Ÿå¯ä»¥ä¸é…ç½®ï¼Œä½†æ˜¯ä¸‹è½½ä¾èµ–é€Ÿåº¦å°±ä¼šå¾ˆæ…¢ã€‚ğŸ˜‚</p>
<p>åœ¨ <code>settings.xml</code> ä¸­æ·»åŠ é˜¿é‡Œäº‘çš„é•œåƒèµ„æºã€‚(æ³¨æ„æ·»åŠ çš„ä½ç½®)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Maven%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%A4%AE%E4%BB%93%E5%BA%93.png" style="zoom: 50%;">

<h2 id="Maven-å‘½ä»¤"><a href="#Maven-å‘½ä»¤" class="headerlink" title="Maven å‘½ä»¤"></a>Maven å‘½ä»¤</h2><p>ä»¥ä¸‹æ˜¯ Maven çš„å¸¸ç”¨å‘½ä»¤ï¼š</p>
<ul>
<li><code>mvn clean</code>ï¼šæ¸…ç†æ„å»ºäº§ç”Ÿçš„æ–‡ä»¶ã€‚</li>
<li><code>mvn compile</code>ï¼šç¼–è¯‘é¡¹ç›®çš„æºä»£ç ã€‚</li>
<li><code>mvn test</code>ï¼šè¿è¡Œé¡¹ç›®çš„å•å…ƒæµ‹è¯•ã€‚</li>
<li><code>mvn package</code>ï¼šæ‰“åŒ…é¡¹ç›®ï¼Œç”Ÿæˆ JAR æˆ– WAR æ–‡ä»¶ã€‚</li>
<li><code>mvn install</code>ï¼šå°†é¡¹ç›®å®‰è£…åˆ°æœ¬åœ° Maven ä»“åº“ã€‚</li>
<li><code>mvn deploy</code>ï¼šå°†é¡¹ç›®å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ã€‚</li>
<li><code>mvn site</code>ï¼šç”Ÿæˆé¡¹ç›®æ–‡æ¡£å’ŒæŠ¥å‘Šã€‚</li>
<li><code>mvn archetype:generate</code> æˆ– <code>mvn archetype:create</code>ï¼šåŸºäºåŸå‹åˆ›å»ºæ–°çš„ Maven é¡¹ç›®ã€‚</li>
<li><code>mvn version</code> æˆ– <code>mvn -v</code>ï¼šæ˜¾ç¤º Maven ç‰ˆæœ¬ä¿¡æ¯å’Œç¯å¢ƒé…ç½®ã€‚</li>
</ul>
<h2 id="IDEA-ä¸­ä½¿ç”¨-Maven"><a href="#IDEA-ä¸­ä½¿ç”¨-Maven" class="headerlink" title="IDEA ä¸­ä½¿ç”¨ Maven"></a>IDEA ä¸­ä½¿ç”¨ Maven</h2><p><strong>PSï¼šIDEA ä¸­è‡ªå¸¦ Mavenï¼Œå¦‚æœä½ æ²¡æœ‰ä¸‹è½½Apache Mavenï¼Œç›´æ¥åˆ›å»º Maven é¡¹ç›®ä¹Ÿè¡Œã€‚</strong></p>
<blockquote>
<p>IDEA ä¸­è‡ªå¸¦çš„ Maven</p>
</blockquote>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E8%87%AA%E5%B8%A6%E7%9A%84Maven.png" style="zoom:50%;">

<blockquote>
<p>é…ç½®è‡ªå·±ä¸‹è½½çš„ Maven</p>
</blockquote>
<p><font color="red"><strong>PSï¼šé…ç½® Maven ä¹‹å‰ä¸€å®šè¦åšçš„è®¾ç½®ï¼ï¼è¿™å¾ˆé‡è¦ï¼è¿™å¾ˆé‡è¦ï¼è¿™å¾ˆé‡è¦ * 3 ï¼ï¼ï¼ï¼å¦åˆ™ Maven ä¸‹è½½ä¾èµ–ä¼šå¤±è´¥ï¼Œä¼šçˆ†çº¢ï¼ï¼ï¼ï¼</strong></font> ğŸ˜£ğŸ˜£ğŸ˜£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŠŠ Maven æœ¬åœ°ä»“åº“ç›®å½•æƒé™èµ‹äºˆç»™ muyoukule ç”¨æˆ·</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R muyoukule /usr/local/maven_repo</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æ‰“å¼€æœ‰é¡¹ç›®å…ˆå°†å®ƒå…³é—­ï¼Œåœ¨ <code>Customize</code> ä¸‹ç‚¹å‡» <code>All settings</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/All%20settings.png" style="zoom: 50%;">

<p>åœ¨å·¦ä¸Šè§’æœç´¢ <code>maven</code>ï¼Œæ‰¾åˆ°å¦‚ä¸‹ç•Œé¢è¿›è¡Œé…ç½®</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E4%B8%AD%E8%AE%BE%E7%BD%AEMaven.png" style="zoom: 50%;">

<p>é…ç½®å¥½äº†å°±å¯ä»¥åˆ›å»º Maven é¡¹ç›®äº†ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/IDEA%E5%88%9B%E5%BB%BAMaven%E9%A1%B9%E7%9B%AE.png" style="zoom:50%;">

<p>ç¬¬ä¸€æ¬¡åˆ›å»º Maven é¡¹ç›®éœ€è¦è€å¿ƒç­‰å¾…ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡åˆ›å»º Maven é¡¹ç›®æœ¬åœ°ä»“åº“ä¸ºç©ºï¼Œæ‰€æœ‰ä¾èµ–éƒ½è¦å»è¿œç¨‹ä»“åº“ä¸‹è½½ã€‚</p>
<p><font color="red"><strong>PSï¼šæ¯æ¬¡åˆ›å»ºå®Œé¡¹ç›®åè®°å¾—è¦å†æ¬¡æ£€æŸ¥ä¸€ä¸‹ Maven é…ç½®æ˜¯å¦æˆåŠŸï¼ï¼ï¼ï¼</strong></font>ğŸ˜«ğŸ˜«ğŸ˜«</p>
<p>IDEA å·¦ä¸Šè§’ç‚¹å‡» <code>File</code> â€“&gt; <code>Settings</code> è¿›è¡Œæ£€æŸ¥ã€‚å› ä¸ºæœ‰äº› IDEA ç‰ˆæœ¬<del>å¾ˆåƒåœ¾</del>æœ‰ BUGï¼Œåœ¨ <code>Customize</code> ç‚¹å‡» <code>All settings</code> ä¸‹é…ç½® Maven æ—¶å¤±æ•ˆã€‚<font color="red"><strong>æ‰€ä»¥æ¯æ¬¡åˆ›å»ºå®Œé¡¹ç›®ä¸€å®šè¦å¯¹ Maven é…ç½®è¿›è¡Œæ£€æŸ¥ï¼ï¼</strong></font></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Maven%E9%A1%B9%E7%9B%AE%E5%8A%A0%E8%BD%BD%E4%BE%9D%E8%B5%96.png" style="zoom: 50%;">

<p>å‡ºç° <code>BUILE SUCCESS</code> è¡¨ç¤ºä¾èµ–åŠ è½½æˆåŠŸï¼Œé»˜è®¤æ‰“å¼€çš„ <code>pom.xml</code> å°±æ˜¯ç®¡ç† jar åŒ…çš„åœ°æ–¹ï¼Œä»¥åé¡¹ç›®æ‰€æœ‰çš„ä¾èµ–éƒ½å†™åœ¨è¿™é‡Œé¢ï¼Œæ— éœ€æ‰‹åŠ¨å¯¼å…¥ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/Maven%E9%A1%B9%E7%9B%AE%E5%8A%A0%E8%BD%BD%E4%BE%9D%E8%B5%96%E6%88%90%E5%8A%9F.png" style="zoom: 50%;">

<p>åˆ›å»ºçš„ Maven é¡¹ç›®åœ¨å³ä¾§ä¼šå‡ºç° Maven æŒ‰é’®ï¼Œç‚¹å¼€åä¼šçœ‹åˆ°æœ‰ <code>Lifecycle</code>(ç”Ÿå‘½å‘¨æœŸ)ã€<code>Plugins</code>(æ’ä»¶)å’Œ <code>Dependencies</code>(ä¾èµ–)ã€‚å…¶ä¸­åœ¨ <code>Dependencies</code> é‡Œçœ‹åˆ°å·²ç»æœ‰ä¸€ä¸ª <code>junit</code> ä¾èµ–ï¼Œè¿™æ˜¯åˆ›å»ºé¡¹ç›®æ—¶è‡ªåŠ¨æ·»åŠ ï¼Œç”¨æ¥åšå•å…ƒæµ‹è¯•çš„ï¼Œå…¶ä¸­ä¸éš¾å‘ç°å®ƒä¸ <code>pom.xml</code> æ–‡ä»¶é‡Œ <code>&lt;dependencies&gt;&lt;/dependencies&gt;</code> ä¸‹çš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›¸å¯¹åº”ï¼Œè¿™æ˜¯ Maven å¼•å…¥å¤–éƒ¨ä¾èµ–çš„æ–¹å¼ï¼Œåç»­æˆ‘ä»¬ä½¿ç”¨åˆ°çš„å…¶ä»–ä¾èµ–ä¹Ÿæ˜¯ä½¿ç”¨è¿™ç§å½¢å¼å¼•å…¥é¡¹ç›®ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯å¼•å…¥ä¾èµ–åéœ€è¦ç‚¹å‡»ä»¥ä¸‹åˆ·æ–°æŒ‰é’®ï¼Œåœ¨ <code>Dependencies</code> ä¸­çœ‹åˆ°äº†ç›¸åº”çš„ä¾èµ–æ‰å¯ä»¥è¿›è¡Œä½¿ç”¨ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/BigDataIMG/%E6%9F%A5%E7%9C%8B%E4%BE%9D%E8%B5%96.png" style="zoom: 80%;">

<p> è‡³æ­¤ï¼ŒIDEA æ–°å»º Maven é¡¹ç›®æˆåŠŸï¼å°±å¯ä»¥è¿›è¡Œä»£ç çš„ç¼–å†™äº†ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>BigData</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
        <tag>Hive</tag>
        <tag>MySQL</tag>
        <tag>HBase</tag>
        <tag>Sqoop</tag>
        <tag>IDEA</tag>
        <tag>Maven</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬3ç« ã€‘ ç´¢å¼•</title>
    <url>/posts/MySQL-Advanced-Chapter-Three-Index/</url>
    <content><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯ç´¢å¼•"><a href="#1-ä»€ä¹ˆæ˜¯ç´¢å¼•" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ç´¢å¼•"></a>1. ä»€ä¹ˆæ˜¯ç´¢å¼•</h1><p>ç´¢å¼•æ˜¯ä¸€ç§èƒ½å¤Ÿæé«˜æ£€ç´¢ï¼ˆæŸ¥è¯¢ï¼‰æ•ˆç‡çš„æå‰æ’å¥½åºçš„æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ï¼šä¹¦çš„ç›®å½•å°±æ˜¯ä¸€ç§ç´¢å¼•æœºåˆ¶ã€‚ç´¢å¼•æ˜¯è§£å†³SQLæ…¢æŸ¥è¯¢çš„ä¸€ç§æ–¹å¼ã€‚</p>
<h1 id="2-ç´¢å¼•çš„åˆ›å»ºå’Œåˆ é™¤"><a href="#2-ç´¢å¼•çš„åˆ›å»ºå’Œåˆ é™¤" class="headerlink" title="2. ç´¢å¼•çš„åˆ›å»ºå’Œåˆ é™¤"></a>2. ç´¢å¼•çš„åˆ›å»ºå’Œåˆ é™¤</h1><h2 id="2-1-ä¸»é”®ä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•"><a href="#2-1-ä¸»é”®ä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•" class="headerlink" title="2.1 ä¸»é”®ä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•"></a>2.1 ä¸»é”®ä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•</h2><p>ä¸»é”®å­—æ®µä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•ï¼Œä¸éœ€è¦ç¨‹åºå‘˜å¹²æ¶‰ï¼Œä¸»é”®å­—æ®µä¸Šçš„ç´¢å¼•è¢«ç§°ä¸º<code>ä¸»é”®ç´¢å¼•</code></p>
<h2 id="2-2-uniqueçº¦æŸçš„å­—æ®µè‡ªåŠ¨æ·»åŠ ç´¢å¼•"><a href="#2-2-uniqueçº¦æŸçš„å­—æ®µè‡ªåŠ¨æ·»åŠ ç´¢å¼•" class="headerlink" title="2.2 uniqueçº¦æŸçš„å­—æ®µè‡ªåŠ¨æ·»åŠ ç´¢å¼•"></a>2.2 uniqueçº¦æŸçš„å­—æ®µè‡ªåŠ¨æ·»åŠ ç´¢å¼•</h2><p>uniqueçº¦æŸçš„å­—æ®µä¹Ÿä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•ï¼Œä¸éœ€è¦ç¨‹åºå‘˜å¹²æ¶‰ï¼Œè¿™ç§å­—æ®µä¸Šæ·»åŠ çš„ç´¢å¼•ç§°ä¸º<code>å”¯ä¸€ç´¢å¼•</code></p>
<h2 id="2-3-ç»™æŒ‡å®šçš„å­—æ®µæ·»åŠ ç´¢å¼•"><a href="#2-3-ç»™æŒ‡å®šçš„å­—æ®µæ·»åŠ ç´¢å¼•" class="headerlink" title="2.3 ç»™æŒ‡å®šçš„å­—æ®µæ·»åŠ ç´¢å¼•"></a>2.3 ç»™æŒ‡å®šçš„å­—æ®µæ·»åŠ ç´¢å¼•</h2><p>å»ºè¡¨æ—¶æ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp (</span><br><span class="line">    ...</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    ...</span><br><span class="line">    INDEX idx_name (name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¡¨å·²ç»åˆ›å»ºå¥½äº†ï¼ŒåæœŸç»™å­—æ®µæ·»åŠ ç´¢å¼•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">ADD</span> INDEX idx_name (name);</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥è¿™æ ·æ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> emp(name);</span><br></pre></td></tr></table></figure>


<h2 id="2-4-åˆ é™¤æŒ‡å®šå­—æ®µä¸Šçš„ç´¢å¼•"><a href="#2-4-åˆ é™¤æŒ‡å®šå­—æ®µä¸Šçš„ç´¢å¼•" class="headerlink" title="2.4 åˆ é™¤æŒ‡å®šå­—æ®µä¸Šçš„ç´¢å¼•"></a>2.4 åˆ é™¤æŒ‡å®šå­—æ®µä¸Šçš„ç´¢å¼•</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">DROP</span> INDEX idx_name;</span><br></pre></td></tr></table></figure>
<h2 id="2-5-æŸ¥çœ‹æŸå¼ è¡¨ä¸Šæ·»åŠ äº†å“ªäº›ç´¢å¼•"><a href="#2-5-æŸ¥çœ‹æŸå¼ è¡¨ä¸Šæ·»åŠ äº†å“ªäº›ç´¢å¼•" class="headerlink" title="2.5 æŸ¥çœ‹æŸå¼ è¡¨ä¸Šæ·»åŠ äº†å“ªäº›ç´¢å¼•"></a>2.5 æŸ¥çœ‹æŸå¼ è¡¨ä¸Šæ·»åŠ äº†å“ªäº›ç´¢å¼•</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> è¡¨å;</span><br></pre></td></tr></table></figure>


<h1 id="3-ç´¢å¼•çš„åˆ†ç±»"><a href="#3-ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="3. ç´¢å¼•çš„åˆ†ç±»"></a>3. ç´¢å¼•çš„åˆ†ç±»</h1><p>ä¸åŒçš„<code>å­˜å‚¨å¼•æ“</code>æœ‰ä¸åŒçš„ç´¢å¼•ç±»å‹å’Œå®ç°ï¼š</p>
<ul>
<li>æŒ‰ç…§æ•°æ®ç»“æ„åˆ†ç±»ï¼š<ul>
<li>B+æ ‘ ç´¢å¼•ï¼ˆmysqlçš„InnoDBå­˜å‚¨å¼•æ“é‡‡ç”¨çš„å°±æ˜¯è¿™ç§ç´¢å¼•ï¼‰é‡‡ç”¨ B+æ ‘  çš„æ•°æ®ç»“æ„</li>
<li>Hash ç´¢å¼•ï¼ˆä»… <code>memory</code> å­˜å‚¨å¼•æ“æ”¯æŒï¼‰ï¼šé‡‡ç”¨  å“ˆå¸Œè¡¨  çš„æ•°æ®ç»“æ„</li>
</ul>
</li>
<li>æŒ‰ç…§ç‰©ç†å­˜å‚¨åˆ†ç±»ï¼š<ul>
<li>èšé›†ç´¢å¼•ï¼šç´¢å¼•å’Œè¡¨ä¸­æ•°æ®åœ¨ä¸€èµ·ï¼Œæ•°æ®å­˜å‚¨çš„æ—¶å€™å°±æ˜¯æŒ‰ç…§ç´¢å¼•é¡ºåºå­˜å‚¨çš„ã€‚ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚</li>
<li>éèšé›†ç´¢å¼•ï¼šç´¢å¼•å’Œè¡¨ä¸­æ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œç´¢å¼•æ˜¯ç‹¬ç«‹äºè¡¨ç©ºé—´çš„ï¼Œä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªéèšé›†ç´¢å¼•ã€‚</li>
</ul>
</li>
<li>æŒ‰ç…§å­—æ®µç‰¹æ€§åˆ†ç±»ï¼š<ul>
<li>ä¸»é”®ç´¢å¼•ï¼ˆprimary keyï¼‰</li>
<li>å”¯ä¸€ç´¢å¼•ï¼ˆuniqueï¼‰</li>
<li>æ™®é€šç´¢å¼•ï¼ˆindexï¼‰</li>
<li>å…¨æ–‡ç´¢å¼•ï¼ˆfulltextï¼šä»… <code>InnoDBå’ŒMyISAM</code> å­˜å‚¨å¼•æ“æ”¯æŒï¼‰</li>
</ul>
</li>
<li>æŒ‰ç…§å­—æ®µä¸ªæ•°åˆ†ç±»ï¼š<ul>
<li>å•åˆ—ç´¢å¼•ã€è”åˆç´¢å¼•ï¼ˆä¹Ÿå«å¤åˆç´¢å¼•ã€ç»„åˆç´¢å¼•ï¼‰</li>
</ul>
</li>
</ul>
<h1 id="4-MySQLç´¢å¼•é‡‡ç”¨äº†B-æ ‘æ•°æ®ç»“æ„"><a href="#4-MySQLç´¢å¼•é‡‡ç”¨äº†B-æ ‘æ•°æ®ç»“æ„" class="headerlink" title="4. MySQLç´¢å¼•é‡‡ç”¨äº†B+æ ‘æ•°æ®ç»“æ„"></a>4. MySQLç´¢å¼•é‡‡ç”¨äº†B+æ ‘æ•°æ®ç»“æ„</h1><p>å¸¸è§çš„æ ‘ç›¸å…³çš„æ•°æ®ç»“æ„åŒ…æ‹¬ï¼š</p>
<ul>
<li>äºŒå‰æ ‘</li>
<li>çº¢é»‘æ ‘</li>
<li>Bæ ‘</li>
<li>B+æ ‘</li>
</ul>
<p>åŒºåˆ«ï¼šæ ‘çš„é«˜åº¦ä¸åŒã€‚æ ‘çš„é«˜åº¦è¶Šä½ï¼Œæ€§èƒ½è¶Šé«˜ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ¬¡I&#x2F;O</p>
<h2 id="4-1-äºŒå‰æ ‘"><a href="#4-1-äºŒå‰æ ‘" class="headerlink" title="4.1 äºŒå‰æ ‘"></a>4.1 äºŒå‰æ ‘</h2><p>æœ‰è¿™æ ·ä¸€å¼ è¡¨</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(1).png" alt="ç´¢å¼•-è¡¨(1)" style="zoom: 67%;">

<p>å¦‚æœä¸ç»™idå­—æ®µæ·»åŠ ç´¢å¼•ï¼Œé»˜è®¤è¿›è¡Œå…¨è¡¨æ‰«æï¼Œå‡è®¾æŸ¥è¯¢id&#x3D;10çš„æ•°æ®ï¼Œé‚£è‡³å°‘è¦è¿›è¡Œ10æ¬¡ç£ç›˜IOã€‚æ•ˆç‡ä½ã€‚å¯ä»¥ç»™idå­—æ®µæ·»åŠ ç´¢å¼•ï¼Œå‡è®¾è¯¥ç´¢å¼•ä½¿ç”¨äº†äºŒå‰æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªäºŒå‰æ ‘æ˜¯è¿™æ ·çš„ï¼ˆ<strong>æ¨èä¸€ä¸ªæ•°æ®ç»“æ„å¯è§†åŒ–ç½‘ç«™<a href="https://www.cs.usfca.edu/~galles/visualization/Algorithms.html">Data Structure Visualizations</a>ï¼Œæ˜¯æ—§é‡‘å±±å¤§å­¦ï¼ˆUSFCAï¼‰çš„ä¸€ä¸ªç½‘ç«™</strong>ï¼‰</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E4%BA%8C%E5%8F%89%E6%A0%91.png" alt="ç´¢å¼•-äºŒå‰æ ‘" style="zoom:80%;">

<p>å¦‚æœè¿™ä¸ªæ—¶å€™è¦æ‰¾id&#x3D;10çš„æ•°æ®ï¼Œéœ€è¦çš„IOæ¬¡æ•°æ˜¯ï¼Ÿ4æ¬¡ã€‚æ•ˆç‡æ˜¾è‘—æå‡äº†ã€‚</p>
<p>ä½†æ˜¯MySQLå¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¿™ç§æ™®é€šçš„äºŒå‰æ ‘ï¼Œè¿™ç§æ™®é€šäºŒå‰æ ‘åœ¨<code>æ•°æ®æç«¯</code>çš„æƒ…å†µä¸‹ï¼Œæ•ˆç‡è¾ƒä½ã€‚æ¯”å¦‚ä¸‹é¢çš„æ•°æ®ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(2).png" alt="ç´¢å¼•-è¡¨(2)" style="zoom:67%;">

<p>å¦‚æœç»™idå­—æ®µæ·»åŠ ç´¢å¼•ï¼Œå¹¶ä¸”è¯¥ç´¢å¼•åº•å±‚ä½¿ç”¨äº†æ™®é€šäºŒå‰æ ‘ï¼Œè¿™æ£µæ ‘ä¼šæ˜¯è¿™æ ·çš„ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91.png" alt="ç´¢å¼•-æ™®é€šäºŒå‰æ ‘" style="zoom:67%;">

<p>ä½ è™½ç„¶ä½¿ç”¨äº†äºŒå‰æ ‘ï¼Œä½†è¿™æ›´åƒä¸€ä¸ªé“¾è¡¨ã€‚æŸ¥æ‰¾æ•ˆç‡ç­‰åŒäºé“¾è¡¨æŸ¥è¯¢O(n)ã€<strong>æŸ¥æ‰¾ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯çº¿æ€§çš„</strong>ã€‘ã€‚æŸ¥æ‰¾æ•ˆç‡æä½ã€‚</p>
<p>å› æ­¤å¯¹äºMySQLæ¥è¯´ï¼Œå®ƒå¹¶æ²¡æœ‰é€‰æ‹©è¿™ç§æ•°æ®ç»“æ„ä½œä¸ºç´¢å¼•ã€‚</p>
<h2 id="4-2-çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡äºŒå‰æ ‘ï¼‰"><a href="#4-2-çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡äºŒå‰æ ‘ï¼‰" class="headerlink" title="4.2 çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡äºŒå‰æ ‘ï¼‰"></a>4.2 çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡äºŒå‰æ ‘ï¼‰</h2><p>é€šè¿‡è‡ªæ—‹å¹³è¡¡è§„åˆ™è¿›è¡Œæ—‹è½¬ï¼Œå­èŠ‚ç‚¹ä¼šè‡ªåŠ¨åˆ†å‰ä¸º2ä¸ªåˆ†æ”¯ï¼Œä»è€Œå‡å°‘æ ‘çš„é«˜åº¦ï¼Œå½“æ•°æ®æœ‰åºæ’å…¥æ—¶æ¯”äºŒå‰æ ‘æ•°æ®æ£€ç´¢æ€§èƒ½æ›´å¥½ã€‚</p>
<p>ä¾‹å¦‚æœ‰ä»¥ä¸‹æ•°æ®</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(3).png" alt="ç´¢å¼•-è¡¨(3)" style="zoom:67%;">

<p>ç»™idå­—æ®µæ·»åŠ ç´¢å¼•ï¼Œå¹¶ä¸”è¯¥ç´¢å¼•ä½¿ç”¨äº†<code>çº¢é»‘æ ‘</code>æ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆä¼šæ˜¯è¿™æ ·ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E7%BA%A2%E9%BB%91%E6%A0%91.png" alt="ç´¢å¼•-çº¢é»‘æ ‘" style="zoom:67%;">

<p>å¦‚æœæŸ¥æ‰¾id&#x3D;10çš„æ•°æ®ï¼Œç£ç›˜IOæ¬¡æ•°ä¸ºï¼š5æ¬¡ã€‚æ•ˆç‡æ¯”æ™®é€šäºŒå‰æ ‘è¦é«˜ä¸€äº›ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ•°æ®é‡åºå¤§ï¼Œä¾‹å¦‚500ä¸‡æ¡æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ ‘çš„é«˜åº¦å¾ˆé«˜ï¼Œç£ç›˜IOæ¬¡æ•°ä»ç„¶å¾ˆå¤šï¼ŒæŸ¥è¯¢æ•ˆç‡ä¹Ÿä¼šæ¯”è¾ƒä½ã€‚</p>
<p>å› æ­¤MySQLå¹¶æ²¡æœ‰ä½¿ç”¨çº¢é»‘æ ‘è¿™ç§æ•°æ®ç»“æ„ä½œä¸ºç´¢å¼•ã€‚</p>
<h2 id="4-3-B-Treesï¼ˆBæ ‘ï¼‰"><a href="#4-3-B-Treesï¼ˆBæ ‘ï¼‰" class="headerlink" title="4.3 B Treesï¼ˆBæ ‘ï¼‰"></a>4.3 B Treesï¼ˆBæ ‘ï¼‰</h2><p>B Treesé¦–å…ˆæ˜¯ä¸€ä¸ª<code>è‡ªå¹³è¡¡</code>çš„ã€‚</p>
<p>B Treesæ¯ä¸ªèŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹æ•°é‡ &gt; 2ã€‚</p>
<p>B Treesæ¯ä¸ªèŠ‚ç‚¹ä¸­ä¹Ÿä¸æ˜¯å­˜å‚¨å•ä¸ªæ•°æ®ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªæ•°æ®ã€‚</p>
<p>B Treesåˆç§°ä¸º<code>å¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘</code>ã€‚</p>
<p>B Treesåˆ†æ”¯çš„æ•°é‡ä¸æ˜¯2ï¼Œæ˜¯å¤§äº2ï¼Œå…·ä½“æ˜¯å¤šå°‘ä¸ªåˆ†æ”¯ï¼Œç”±<code>é˜¶</code>å†³å®šã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>3é˜¶çš„B Treesï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸‹æœ€å¤šæœ‰3ä¸ªå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­æœ€å¤šæœ‰2ä¸ªæ•°æ®ã€‚</li>
<li>4é˜¶çš„B Treesï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸‹æœ€å¤šæœ‰4ä¸ªå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­æœ€å¤šæœ‰3ä¸ªæ•°æ®ã€‚</li>
<li>5é˜¶ï¼ˆ5, 4ï¼‰</li>
<li>6é˜¶ï¼ˆ6, 5ï¼‰</li>
<li>â€¦.</li>
<li>16é˜¶ï¼ˆ16, 15ï¼‰ã€MySQLé‡‡ç”¨äº†16é˜¶ã€‘</li>
</ul>
<p>é‡‡ç”¨B Treesï¼Œä½ ä¼šå‘ç°ç›¸åŒçš„æ•°æ®é‡ï¼Œ<strong>B Tree æ ‘çš„é«˜åº¦æ›´ä½</strong>ã€‚ç£ç›˜IOæ¬¡æ•°æ›´å°‘ã€‚</p>
<p>3é˜¶çš„B Treesï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/3%E9%98%B6%E7%9A%84B%E6%A0%91.png" alt="3é˜¶çš„Bæ ‘" style="zoom: 80%;">

<p><strong>å‡è®¾idå­—æ®µæ·»åŠ äº†ç´¢å¼•ï¼Œå¹¶ä¸”é‡‡ç”¨äº†B Treesæ•°æ®ç»“æ„ï¼ŒæŸ¥æ‰¾id&#x3D;10çš„æ•°æ®ï¼Œåªéœ€è¦3æ¬¡ç£ç›˜IOã€‚</strong></p>
<p>4é˜¶çš„B Treesï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/4%E9%98%B6%E7%9A%84B%E6%A0%91.png" alt="4é˜¶çš„Bæ ‘" style="zoom: 80%;">



<p>æ›´åŠ è¯¦ç»†çš„å­˜å‚¨æ˜¯è¿™æ ·çš„ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(4).png" alt="ç´¢å¼•-è¡¨(4)" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/B%E6%A0%91%E8%AF%A6%E7%BB%86%E7%9A%84%E5%AD%98%E5%82%A8.png" alt="Bæ ‘è¯¦ç»†çš„å­˜å‚¨" style="zoom:67%;">

<p>åœ¨B Treesä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸ä»…å­˜å‚¨äº†<code>ç´¢å¼•å€¼</code>ï¼Œè¿˜å­˜å‚¨è¯¥ç´¢å¼•å€¼å¯¹åº”çš„<code>æ•°æ®è¡Œ</code>ã€‚</p>
<p>å¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹ä¸­çš„p1 p2 p3æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</p>
<p>B Treesæ•°æ®ç»“æ„å­˜åœ¨çš„ç¼ºç‚¹æ˜¯ï¼šä¸é€‚åˆåšåŒºé—´æŸ¥æ‰¾ï¼Œå¯¹äºåŒºé—´æŸ¥æ‰¾æ•ˆç‡è¾ƒä½ã€‚å‡è®¾è¦æŸ¥idåœ¨[3~7]ä¹‹é—´çš„ï¼Œéœ€è¦æŸ¥æ‰¾çš„æ˜¯3,4,5,6,7ã€‚é‚£ä¹ˆæŸ¥è¿™æ¯ä¸ªç´¢å¼•å€¼éƒ½éœ€è¦ä»å¤´èŠ‚ç‚¹å¼€å§‹ã€‚</p>
<p>å› æ­¤MySQLä½¿ç”¨äº†B+ Treesè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="4-4-B-Treesï¼ˆB-æ ‘ï¼‰"><a href="#4-4-B-Treesï¼ˆB-æ ‘ï¼‰" class="headerlink" title="4.4 B+ Treesï¼ˆB+ æ ‘ï¼‰"></a>4.4 B+ Treesï¼ˆB+ æ ‘ï¼‰</h2><p>B+ Trees ç›¸è¾ƒäº B Treesæ”¹è¿›äº†å“ªäº›ï¼Ÿ</p>
<ul>
<li>B+æ ‘å°†æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ã€‚å¹¶ä¸”å¶å­èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨é“¾è¡¨è¿æ¥ï¼Œè¿™æ ·å¾ˆé€‚åˆèŒƒå›´æŸ¥è¯¢ã€‚</li>
<li>B+æ ‘çš„éå¶å­èŠ‚ç‚¹ä¸Šåªæœ‰ç´¢å¼•å€¼ï¼Œæ²¡æœ‰æ•°æ®ï¼Œæ‰€ä»¥éå¶å­èŠ‚ç‚¹å¯ä»¥å­˜å‚¨æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œè¿™æ ·è®©B+æ ‘æ›´çŸ®æ›´èƒ–ï¼Œæé«˜æ£€ç´¢æ•ˆç‡ã€‚</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-B%E5%8A%A0%E6%A0%91.png" alt="ç´¢å¼•-B+æ ‘" style="zoom:80%;">

<p>å‡è®¾æœ‰è¿™æ ·ä¸€å¼ è¡¨ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(5).png" alt="ç´¢å¼•-è¡¨(5)" style="zoom:67%;">

<p>B+ Treesæ–¹å¼å­˜å‚¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/B%E5%8A%A0%E6%A0%91%E6%96%B9%E5%BC%8F%E5%AD%98%E5%82%A8.png" alt="B+æ ‘æ–¹å¼å­˜å‚¨.png" style="zoom: 50%;">

<p><strong>ç»å…¸é¢è¯•é¢˜ï¼š</strong>mysqlä¸ºä»€ä¹ˆé€‰æ‹©B+æ ‘ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸æ˜¯Bæ ‘ï¼Ÿ</p>
<ol>
<li>éå¶å­èŠ‚ç‚¹ä¸Šå¯ä»¥å­˜å‚¨æ›´å¤šçš„é”®å€¼ï¼Œé˜¶æ•°å¯ä»¥æ›´å¤§ï¼Œæ›´çŸ®æ›´èƒ–ï¼Œç£ç›˜IOæ¬¡æ•°å°‘ï¼Œæ•°æ®æŸ¥è¯¢æ•ˆç‡é«˜ã€‚</li>
<li>æ‰€æœ‰æ•°æ®éƒ½æ˜¯æœ‰åºå­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè®©èŒƒå›´æŸ¥æ‰¾ï¼Œåˆ†ç»„æŸ¥æ‰¾æ•ˆç‡æ›´é«˜ã€‚</li>
<li>æ•°æ®é¡µä¹‹é—´ã€æ•°æ®è®°å½•ä¹‹é—´é‡‡ç”¨é“¾è¡¨é“¾æ¥ï¼Œè®©å‡åºé™åºæ›´åŠ æ–¹ä¾¿æ“ä½œã€‚</li>
</ol>
<p><strong>ç»å…¸é¢è¯•é¢˜ï¼š</strong>å¦‚æœä¸€å¼ è¡¨æ²¡æœ‰ä¸»é”®ç´¢å¼•ï¼Œé‚£è¿˜ä¼šåˆ›å»ºB+æ ‘å—ï¼Ÿ</p>
<p>å½“ä¸€å¼ è¡¨æ²¡æœ‰ä¸»é”®ç´¢å¼•æ—¶ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªéšè—çš„å†…ç½®çš„èšé›†ç´¢å¼•ï¼ˆclustered indexï¼‰ã€‚è¿™ä¸ªèšé›†ç´¢å¼•æ˜¯åŸºäºè¡¨çš„ç‰©ç†å­˜å‚¨é¡ºåºæ„å»ºçš„ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨B+æ ‘æ¥å®ç°çš„ã€‚</p>
<h1 id="5-å…¶ä»–ç´¢å¼•åŠç›¸å…³è°ƒä¼˜"><a href="#5-å…¶ä»–ç´¢å¼•åŠç›¸å…³è°ƒä¼˜" class="headerlink" title="5. å…¶ä»–ç´¢å¼•åŠç›¸å…³è°ƒä¼˜"></a>5. å…¶ä»–ç´¢å¼•åŠç›¸å…³è°ƒä¼˜</h1><h2 id="5-1-Hashç´¢å¼•"><a href="#5-1-Hashç´¢å¼•" class="headerlink" title="5.1 Hashç´¢å¼•"></a>5.1 Hashç´¢å¼•</h2><p>æ”¯æŒHashç´¢å¼•çš„å­˜å‚¨å¼•æ“æœ‰ï¼š</p>
<ul>
<li>InnoDBï¼ˆä¸æ”¯æŒæ‰‹åŠ¨åˆ›å»ºHashç´¢å¼•ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç»´æŠ¤ä¸€ä¸ª<code>è‡ªé€‚åº”çš„Hashç´¢å¼•</code>ï¼‰<ul>
<li>å¯¹äºInnoDBæ¥è¯´ï¼Œå³ä½¿æ‰‹åŠ¨æŒ‡å®šäº†æŸå­—æ®µé‡‡ç”¨Hashç´¢å¼•ï¼Œæœ€ç»ˆ<code>show index from è¡¨å</code>çš„æ—¶å€™ï¼Œè¿˜æ˜¯<code>BTREE</code>ã€‚</li>
</ul>
</li>
<li>Memoryï¼ˆæ”¯æŒHashç´¢å¼•ï¼‰</li>
</ul>
<p>Hashç´¢å¼•åº•å±‚çš„æ•°æ®ç»“æ„å°±æ˜¯å“ˆå¸Œè¡¨ã€‚ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯é“¾è¡¨ã€‚å’Œjavaä¸­HashMapä¸€æ ·ã€‚å“ˆå¸Œè¡¨ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯key valueç»“æ„ã€‚keyå­˜å‚¨<code>ç´¢å¼•å€¼</code>ï¼Œvalueå­˜å‚¨<code>è¡ŒæŒ‡é’ˆ</code>ã€‚</p>
<p>åŸç†å¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(6).png" alt="ç´¢å¼•-è¡¨(6)"></p>
<p>å¦‚æœnameå­—æ®µä¸Šæ·»åŠ äº†Hashç´¢å¼•idx_name</p>
<p>Hashç´¢å¼•é•¿è¿™ä¸ªæ ·å­ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(7).png" alt="ç´¢å¼•-è¡¨(7)" style="zoom:67%;">

<p>æ£€ç´¢åŸç†ï¼šå‡è®¾ name&#x3D;â€™å­™è¡Œè€…â€™ã€‚é€šè¿‡å“ˆå¸Œç®—æ³•å°†â€™å­™è¡Œè€…â€™è½¬æ¢ä¸ºæ•°ç»„ä¸‹æ ‡ï¼Œé€šè¿‡ä¸‹æ ‡æ‰¾é“¾è¡¨ï¼Œåœ¨é“¾è¡¨ä¸Šéå†æ‰¾åˆ°å­™è¡Œè€…çš„è¡ŒæŒ‡é’ˆã€‚</p>
<p>æ³¨æ„ï¼šä¸åŒçš„å­—ç¬¦ä¸²ï¼Œç»è¿‡å“ˆå¸Œç®—æ³•å¾—åˆ°çš„æ•°ç»„ä¸‹æ ‡å¯èƒ½ç›¸åŒï¼Œè¿™å«åš<strong>å“ˆå¸Œç¢°æ’&#x2F;å“ˆå¸Œå†²çª</strong>ã€‚ã€ä¸è¿‡ï¼Œå¥½çš„å“ˆå¸Œç®—æ³•åº”è¯¥å…·æœ‰å¾ˆä½çš„ç¢°æ’æ¦‚ç‡ã€‚å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•å¦‚MD5ã€SHA-1ã€SHA-256ç­‰éƒ½è¢«è®¾è®¡ä¸ºå°½å¯èƒ½å‡å°‘ç¢°æ’çš„å‘ç”Ÿã€‚ã€‘</p>
<p>Hashç´¢å¼•ä¼˜ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šåªèƒ½ç”¨åœ¨ç­‰å€¼æ¯”è¾ƒä¸­ï¼Œæ•ˆç‡å¾ˆé«˜ã€‚ä¾‹å¦‚ï¼šname&#x3D;â€™å­™æ‚Ÿç©ºâ€™</li>
<li>ç¼ºç‚¹ï¼šä¸æ”¯æŒæ’åºï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥æ‰¾ã€‚</li>
</ul>
<h2 id="5-2-èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼•"><a href="#5-2-èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼•" class="headerlink" title="5.2 èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼•"></a>5.2 èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼•</h2><p>æŒ‰ç…§æ•°æ®çš„ç‰©ç†å­˜å‚¨æ–¹å¼ä¸åŒï¼Œå¯ä»¥å°†ç´¢å¼•åˆ†ä¸ºèšé›†ç´¢å¼•ï¼ˆèšç°‡ç´¢å¼•ï¼‰å’Œéèšé›†ç´¢å¼•ï¼ˆéèšç°‡ç´¢å¼•ï¼‰ã€‚</p>
<p>å­˜å‚¨å¼•æ“æ˜¯InnoDBçš„ï¼Œä¸»é”®ä¸Šçš„ç´¢å¼•å±äºèšé›†ç´¢å¼•ã€‚</p>
<p>å­˜å‚¨å¼•æ“æ˜¯MyISAMçš„ï¼Œä»»æ„å­—æ®µä¸Šçš„ç´¢å¼•éƒ½æ˜¯éèšé›†ç´¢å¼•ã€‚</p>
<p>InnoDBçš„ç‰©ç†å­˜å‚¨æ–¹å¼ï¼šå½“åˆ›å»ºä¸€å¼ è¡¨t_userï¼Œå¹¶ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“æ—¶ï¼Œä¼šåœ¨ç¡¬ç›˜ä¸Šç”Ÿæˆè¿™æ ·ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>t_user.ibd ï¼ˆInnoDB dataè¡¨ç´¢å¼• + æ•°æ®ï¼‰</li>
<li>t_user.frm ï¼ˆå­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯ï¼‰</li>
</ul>
<p>MyISAMçš„ç‰©ç†å­˜å‚¨æ–¹å¼ï¼šå½“åˆ›å»ºä¸€å¼ è¡¨t_userï¼Œå¹¶ä½¿ç”¨MyISAMå­˜å‚¨å¼•æ“æ—¶ï¼Œä¼šåœ¨ç¡¬ç›˜ä¸Šç”Ÿæˆè¿™æ ·ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>t_user.MYD ï¼ˆè¡¨æ•°æ®ï¼‰</li>
<li>t_user.MYI ï¼ˆè¡¨ç´¢å¼•ï¼‰</li>
<li>t_user.frm ï¼ˆè¡¨ç»“æ„ï¼‰</li>
</ul>
<p><strong>æ³¨æ„ï¼šä»MySQL8.0å¼€å§‹ï¼Œä¸å†ç”Ÿæˆfrmæ–‡ä»¶äº†ï¼Œå¼•å…¥äº†æ•°æ®å­—å…¸ï¼Œç”¨æ•°æ®å­—å…¸æ¥ç»Ÿä¸€å­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</strong></p>
<ul>
<li><strong>information_schema.TABLES ï¼ˆè¡¨åŒ…å«äº†æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è¡¨åã€æ•°æ®åº“åã€å¼•æ“ç±»å‹ç­‰ï¼‰</strong></li>
<li><strong>information_schema.COLUMNSï¼ˆè¡¨åŒ…å«äº†æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„åˆ—ä¿¡æ¯ï¼Œä¾‹å¦‚åˆ—åã€æ•°æ®ç±»å‹ã€é»˜è®¤å€¼ç­‰ï¼‰</strong></li>
</ul>
<p>èšé›†ç´¢å¼•çš„åŸç†å›¾ï¼šï¼ˆB+æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¸Šå­˜å‚¨äº†ç´¢å¼•å€¼ + æ•°æ®ï¼‰</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="èšé›†ç´¢å¼•çš„åŸç†å›¾" style="zoom: 50%;">

<p>éèšé›†ç´¢å¼•çš„åŸç†å›¾ï¼šï¼ˆB+æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¸Šå­˜å‚¨äº†ç´¢å¼•å€¼ + è¡ŒæŒ‡é’ˆï¼‰</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="éèšé›†ç´¢å¼•çš„åŸç†å›¾" style="zoom: 50%;">

<p>èšé›†ç´¢å¼•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šèšé›†ç´¢å¼•å°†æ•°æ®å­˜å‚¨åœ¨ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹ä¸Šã€‚å¯ä»¥å‡å°‘ä¸€æ¬¡æŸ¥è¯¢ï¼Œå› ä¸ºæŸ¥è¯¢ç´¢å¼•æ ‘çš„åŒæ—¶å¯ä»¥è·å–æ•°æ®ã€‚</li>
<li>ç¼ºç‚¹ï¼šå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹æˆ–åˆ é™¤æ—¶éœ€è¦æ›´æ–°ç´¢å¼•æ ‘ï¼Œä¼šå¢åŠ ç³»ç»Ÿçš„å¼€é”€ã€‚</li>
</ul>
<h2 id="5-3-äºŒçº§ç´¢å¼•"><a href="#5-3-äºŒçº§ç´¢å¼•" class="headerlink" title="5.3 äºŒçº§ç´¢å¼•"></a>5.3 äºŒçº§ç´¢å¼•</h2><p>äºŒçº§ç´¢å¼•ä¹Ÿå±äºéèšé›†ç´¢å¼•ã€‚ä¹Ÿæœ‰äººæŠŠäºŒçº§ç´¢å¼•ç§°ä¸ºè¾…åŠ©ç´¢å¼•ã€‚</p>
<p>æœ‰è¡¨t_userï¼Œ<code>id</code>æ˜¯ä¸»é”®ã€‚<code>age</code>æ˜¯éä¸»é”®ã€‚åœ¨<code>age</code>å­—æ®µä¸Šæ·»åŠ çš„ç´¢å¼•ç§°ä¸ºäºŒçº§ç´¢å¼•ã€‚ï¼ˆæ‰€æœ‰éä¸»é”®ç´¢å¼•éƒ½æ˜¯äºŒçº§ç´¢å¼•ï¼‰</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95-%E8%A1%A8(8).png" alt="ç´¢å¼•-è¡¨(8)"></p>
<p>äºŒçº§ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png" alt="äºŒçº§ç´¢å¼•çš„æ•°æ®ç»“æ„"></p>
<p>äºŒçº§ç´¢å¼•çš„æŸ¥è¯¢åŸç†ï¼š</p>
<p>å‡è®¾æŸ¥è¯¢è¯­å¥ä¸ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_user <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">30</span>;</span><br></pre></td></tr></table></figure>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95%E5%9B%9E%E8%A1%A8.png" alt="äºŒçº§ç´¢å¼•å›è¡¨" style="zoom:67%;">

<p>ä¸ºä»€ä¹ˆä¼šâ€œå›è¡¨â€ï¼Ÿå› ä¸ºä½¿ç”¨äº†<code>select *</code></p>
<p>é¿å…â€œå›è¡¨ã€å›åˆ°åŸæ•°æ®è¡¨ã€‘â€æ˜¯æé«˜SQLæ‰§è¡Œæ•ˆç‡çš„æ‰‹æ®µã€‚ä¾‹å¦‚ï¼šselect id from t_user where age &#x3D; 30ï¼›è¿™æ ·çš„SQLè¯­å¥æ˜¯ä¸éœ€è¦å›è¡¨çš„ã€‚</p>
<h2 id="5-4-è¦†ç›–ç´¢å¼•"><a href="#5-4-è¦†ç›–ç´¢å¼•" class="headerlink" title="5.4 è¦†ç›–ç´¢å¼•"></a>5.4 è¦†ç›–ç´¢å¼•</h2><p>è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯æŒ‡æŸä¸ªæŸ¥è¯¢è¯­å¥å¯ä»¥é€šè¿‡ç´¢å¼•çš„è¦†ç›–æ¥å®Œæˆï¼Œè€Œä¸éœ€è¦å›è¡¨æŸ¥è¯¢çœŸå®æ•°æ®ã€‚å…¶ä¸­çš„è¦†ç›–æŒ‡çš„æ˜¯åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥æ—¶ï¼ŒæŸ¥è¯¢éœ€è¦çš„æ‰€æœ‰åˆ—éƒ½å¯ä»¥ä»ç´¢å¼•ä¸­æå–åˆ°ï¼Œè€Œä¸éœ€è¦å†å»æŸ¥è¯¢å®é™…æ•°æ®è¡Œè·å–æŸ¥è¯¢æ‰€éœ€æ•°æ®ã€‚</p>
<p>å½“ä½¿ç”¨è¦†ç›–ç´¢å¼•æ—¶ï¼ŒMySQLå¯ä»¥ç›´æ¥é€šè¿‡ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•ä¸Šçš„æ•°æ®æ¥è·å–æ‰€éœ€çš„ç»“æœï¼Œè€Œä¸å¿…å†å»æŸ¥æ‰¾è¡¨ä¸­çš„æ•°æ®ã€‚è¿™æ ·å¯ä»¥æ˜¾è‘—æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>å‡è®¾æœ‰ä¸€ä¸ªç”¨æˆ·è¡¨ï¼ˆuserï¼‰åŒ…å«ä»¥ä¸‹åˆ—ï¼šid, username, email, ageã€‚</p>
<p>å¸¸è§çš„æŸ¥è¯¢æ˜¯æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„é‚®ç®±ã€‚å¦‚æœä¸ºäº†æé«˜è¿™ä¸ªæŸ¥è¯¢çš„æ€§èƒ½ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªè¦†ç›–ç´¢å¼•ï¼ŒåŒ…å«ï¼ˆusername, emailï¼‰è¿™ä¸¤åˆ—ã€‚</p>
<p>åˆ›å»ºè¦†ç›–ç´¢å¼•çš„SQLè¯­å¥å¯ä»¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_user_username_email <span class="keyword">ON</span> <span class="keyword">user</span> (username, email);</span><br></pre></td></tr></table></figure>

<p>å½“æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢æ—¶ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> email <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> username <span class="operator">=</span> <span class="string">&#x27;lucy&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>MySQLå¯ä»¥ç›´æ¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆidx_user_username_emailï¼‰æ¥è·å–æŸ¥è¯¢ç»“æœï¼Œè€Œä¸å¿…å†å»æŸ¥æ‰¾ç”¨æˆ·è¡¨ä¸­çš„æ•°æ®ã€‚è¿™æ ·å¯ä»¥å‡å°‘ç£ç›˜I&#x2F;Oå¹¶æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚è€Œå¦‚æœæ²¡æœ‰è¦†ç›–ç´¢å¼•ï¼ŒMySQLä¼šå…ˆä½¿ç”¨ç´¢å¼•ï¼ˆusernameï¼‰æ¥æ‰¾åˆ°åŒ¹é…çš„è¡Œï¼Œç„¶åå†å›è¡¨æŸ¥è¯¢è·å–é‚®ç®±ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå¢åŠ æ›´å¤šçš„ç£ç›˜I&#x2F;Oå’ŒæŸ¥è¯¢æ—¶é—´ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¦†ç›–ç´¢å¼•çš„åˆ›å»ºéœ€è¦è€ƒè™‘æŸ¥è¯¢çš„å­—æ®µé€‰æ‹©ã€‚å¦‚æœæŸ¥è¯¢éœ€è¦çš„å­—æ®µè¾ƒå¤šï¼Œå¯èƒ½éœ€è¦åˆ›å»ºåŒ…å«æ›´å¤šåˆ—çš„è¦†ç›–ç´¢å¼•ï¼Œä»¥æ»¡è¶³å®Œå…¨è¦†ç›–æŸ¥è¯¢çš„éœ€è¦ã€‚</p>
<p>è¦†ç›–ç´¢å¼•å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æé«˜æŸ¥è¯¢æ€§èƒ½ï¼šè¦†ç›–ç´¢å¼•èƒ½å¤Ÿæ»¡è¶³æŸ¥è¯¢çš„æ‰€æœ‰éœ€æ±‚ï¼ŒåŒæ—¶ä¸éœ€è¦è®¿é—®è¡¨ä¸­çš„å®é™…æ•°æ®è¡Œï¼Œä»è€Œå¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚è¿™æ˜¯å› ä¸ºDBMSå¯ä»¥ç›´æ¥ä½¿ç”¨ç´¢å¼•æ¥æ‰§è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸éœ€è¦ä»ç£ç›˜è¯»å–å®é™…çš„æ•°æ®è¡Œã€‚</li>
<li>å‡å°‘ç£ç›˜å’Œå†…å­˜è®¿é—®æ¬¡æ•°ï¼šå½“ä½¿ç”¨è¦†ç›–ç´¢å¼•æ—¶ï¼ŒDBMSä¸éœ€è¦è®¿é—®å®é™…çš„æ•°æ®è¡Œã€‚è¿™æ ·å¯ä»¥å‡å°‘ç£ç›˜å’Œå†…å­˜è®¿é—®æ¬¡æ•°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>å‡å°‘ç½‘ç»œä¼ è¾“ï¼šç”±äºåœ¨è¦†ç›–ç´¢å¼•ä¸­å¯ä»¥å­˜å‚¨æ‰€æœ‰æŸ¥è¯¢æ‰€éœ€çš„åˆ—ï¼Œå› æ­¤å¯ä»¥å‡å°‘æ•°æ®çš„ç½‘ç»œä¼ è¾“æ¬¡æ•°ï¼Œä»è€Œæé«˜æŸ¥è¯¢çš„æ€§èƒ½ã€‚</li>
<li>å¯ä»¥é™ä½ç³»ç»Ÿå¼€é”€ï¼šåœ¨é«˜å‹åŠ›çš„æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨è¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li>
</ul>
<p>è¦†ç›–ç´¢å¼•çš„ç¼ºç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>éœ€è¦æ›´å¤šçš„å†…å­˜ï¼šè¦†ç›–ç´¢å¼•éœ€è¦å­˜å‚¨æŸ¥è¯¢æ‰€éœ€çš„æ‰€æœ‰åˆ—ï¼Œå› æ­¤éœ€è¦æ›´å¤šçš„å†…å­˜æ¥å­˜å‚¨ç´¢å¼•ã€‚åœ¨å¤§å‹æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºä¸€é¡¹æŒ‘æˆ˜ã€‚</li>
<li>ä¼šä½¿ç´¢å¼•å˜å¾—åºå¤§ï¼šå½“ç´¢å¼•ä¸­åŒ…å«äº†è®¸å¤šåˆ—æ—¶ï¼Œå®ƒä»¬å¯èƒ½ä¼šä½¿ç´¢å¼•å˜å¾—éå¸¸åºå¤§ï¼Œä»è€Œå½±å“æŸ¥è¯¢æ€§èƒ½ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚</li>
<li>åªæœ‰åœ¨æŸ¥è¯¢ä¸­åŒ…å«äº†ç´¢å¼•åˆ—æ—¶æ‰èƒ½ä½¿ç”¨ï¼šåªæœ‰å½“æŸ¥è¯¢ä¸­åŒ…å«äº†æ‰€æœ‰çš„ç´¢å¼•åˆ—æ—¶æ‰èƒ½ä½¿ç”¨è¦†ç›–ç´¢å¼•ã€‚å¦‚æœæŸ¥è¯¢ä¸­åŒ…å«äº†å…¶ä»–åˆ—ï¼ŒDBMSä»ç„¶éœ€è¦è®¿é—®å®é™…çš„æ•°æ®è¡Œï¼Œå¹¶ä¸”æ— æ³•ä½¿ç”¨è¦†ç›–ç´¢å¼•æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li>
</ul>
<h2 id="5-5-ç´¢å¼•ä¸‹æ¨"><a href="#5-5-ç´¢å¼•ä¸‹æ¨" class="headerlink" title="5.5 ç´¢å¼•ä¸‹æ¨"></a>5.5 ç´¢å¼•ä¸‹æ¨</h2><p>ç´¢å¼•ä¸‹æ¨ï¼ˆIndex Condition Pushdownï¼‰æ˜¯ä¸€ç§ MySQL ä¸­çš„ä¼˜åŒ–æ–¹æ³•ï¼Œå®ƒå¯ä»¥å°†æŸ¥è¯¢ä¸­çš„è¿‡æ»¤æ¡ä»¶ä¸‹æ¨åˆ°ç´¢å¼•å±‚çº§ä¸­å¤„ç†ï¼Œä»è€Œå‡å°‘å›è¡¨æ¬¡æ•°ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œåœ¨ä½¿ç”¨ç´¢å¼•ä¸‹æ¨æ—¶ï¼ŒMySQL ä¼šåœ¨ç´¢å¼•çš„å¶èŠ‚ç‚¹å±‚çº§æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡æ»¤æ¡ä»¶ï¼Œè¿‡æ»¤æ‰æ— ç”¨çš„ç´¢å¼•è®°å½•ï¼Œä»…è¿”å›ç¬¦åˆæ¡ä»¶çš„è®°å½•çš„ä¸»é”®ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æŸ¥è¯¢æ—¶å›è¡¨è¯»å–è¡¨æ ¼çš„æ•°æ®è¡Œï¼Œä»è€Œç¼©çŸ­äº†æ•´ä¸ªæŸ¥è¯¢è¿‡ç¨‹çš„æ—¶é—´ã€‚</p>
<p>å‡è®¾æœ‰ä»¥ä¸‹è¡¨ç»“æ„ï¼š</p>
<p>è¡¨åï¼šusers</p>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">name</th>
<th align="center">age</th>
<th align="center">city</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">John</td>
<td align="center">25</td>
<td align="center">New York</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">Alice</td>
<td align="center">30</td>
<td align="center">London</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">Bob</td>
<td align="center">40</td>
<td align="center">Paris</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">Olivia</td>
<td align="center">35</td>
<td align="center">Berlin</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">Michael</td>
<td align="center">28</td>
<td align="center">Sydney</td>
</tr>
</tbody></table>
<p>ç°åœ¨æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼šï¼ˆç´¢å¼•ä¸‹æ¨é€šå¸¸æ˜¯åŸºäºå¤šåˆ—ç´¢å¼•çš„ã€‚ï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> users <span class="keyword">ADD</span> INDEX idx_name_city_age (name, city, age);</span><br></pre></td></tr></table></figure>

<p>å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢å¹´é¾„å¤§äº30å²ï¼Œå¹¶ä¸”æ‰€åœ¨åŸå¸‚æ˜¯â€Londonâ€çš„ç”¨æˆ·ï¼Œå‡è®¾åªç»™ageå­—æ®µæ·»åŠ äº†ç´¢å¼•ï¼Œå®ƒå°±ä¸ä¼šä½¿ç”¨ç´¢å¼•ä¸‹æ¨ã€‚ä¼ ç»Ÿçš„æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šå°†æ‰€æœ‰æ»¡è¶³å¹´é¾„å¤§äº30å²çš„è®°å½•è¯»å…¥å†…å­˜ï¼Œç„¶åå†æ ¹æ®åŸå¸‚è¿›è¡Œç­›é€‰ã€‚</p>
<p>ä½¿ç”¨ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–åï¼Œåœ¨ç´¢å¼•èŒƒå›´æ‰«æçš„è¿‡ç¨‹ä¸­ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤æ–­åªæœ‰åœ¨åŸå¸‚åˆ—ä¸ºâ€Londonâ€çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šå°†æ»¡è¶³å¹´é¾„å¤§äº30å²çš„è®°å½•åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™æ ·å°±å¯ä»¥é¿å…ä¸å¿…è¦çš„IOå’Œæ•°æ®ä¼ è¾“ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>å…·ä½“çš„æŸ¥è¯¢è¯­å¥å¯ä»¥æ˜¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">AND</span> city <span class="operator">=</span> <span class="string">&#x27;London&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢æ—¶ï¼Œä¼˜åŒ–å™¨ä¼šä½¿ç”¨ç´¢å¼•ä¸‹æ¨æŠ€æœ¯ï¼Œå…ˆæ ¹æ®ç´¢å¼•èŒƒå›´æ‰«ææ‰¾åˆ°æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œç„¶åå†å›åˆ°åŸæ•°æ®è¡¨ä¸­è·å–å®Œæ•´çš„è¡Œæ•°æ®ï¼Œæœ€ç»ˆè¿”å›ç»“æœã€‚</p>
<h2 id="5-6-å•åˆ—ç´¢å¼•ï¼ˆå•ä¸€ç´¢å¼•ï¼‰"><a href="#5-6-å•åˆ—ç´¢å¼•ï¼ˆå•ä¸€ç´¢å¼•ï¼‰" class="headerlink" title="5.6 å•åˆ—ç´¢å¼•ï¼ˆå•ä¸€ç´¢å¼•ï¼‰"></a>5.6 å•åˆ—ç´¢å¼•ï¼ˆå•ä¸€ç´¢å¼•ï¼‰</h2><p>å•åˆ—ç´¢å¼•æ˜¯æŒ‡å¯¹æ•°æ®åº“è¡¨ä¸­çš„æŸä¸€åˆ—æˆ–å±æ€§è¿›è¡Œç´¢å¼•åˆ›å»ºï¼Œå¯¹è¯¥åˆ—è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾å’Œæ’åºæ“ä½œã€‚å•åˆ—ç´¢å¼•å¯ä»¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œæé«˜æ•°æ®åº“çš„æ€§èƒ½ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå­¦ç”Ÿè¡¨ï¼ˆstudentï¼‰ï¼Œå…¶ä¸­æœ‰ä»¥ä¸‹å‡ ä¸ªåˆ—ï¼šå­¦ç”Ÿç¼–å·ï¼ˆstudent_idï¼‰ã€å§“åï¼ˆnameï¼‰ã€å¹´é¾„ï¼ˆageï¼‰å’Œæ€§åˆ«ï¼ˆgenderï¼‰ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬é’ˆå¯¹å­¦ç”Ÿè¡¨çš„å­¦ç”Ÿç¼–å·ï¼ˆstudent_idï¼‰åˆ—åˆ›å»ºäº†å•åˆ—ç´¢å¼•ï¼Œé‚£ä¹ˆå¯ä»¥å¿«é€Ÿåœ°æ ¹æ®å­¦ç”Ÿç¼–å·è¿›è¡ŒæŸ¥è¯¢æˆ–æ’åºæ“ä½œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹SQLè¯­å¥æŸ¥è¯¢å­¦ç”Ÿç¼–å·ä¸º123456çš„å­¦ç”Ÿä¿¡æ¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student_id <span class="operator">=</span> <span class="number">123456</span>;</span><br></pre></td></tr></table></figure>

<p>ç”±äºæˆ‘ä»¬å¯¹å­¦ç”Ÿç¼–å·åˆ—å»ºç«‹äº†å•åˆ—ç´¢å¼•ï¼Œæ‰€ä»¥æ•°æ®åº“å¯ä»¥ç›´æ¥é€šè¿‡ç´¢å¼•å¿«é€Ÿå®šä½åˆ°å…·æœ‰å­¦ç”Ÿç¼–å·123456çš„é‚£ä¸€è¡Œè®°å½•ï¼Œä»è€ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<h2 id="5-7-å¤åˆç´¢å¼•ï¼ˆç»„åˆç´¢å¼•ï¼‰"><a href="#5-7-å¤åˆç´¢å¼•ï¼ˆç»„åˆç´¢å¼•ï¼‰" class="headerlink" title="5.7 å¤åˆç´¢å¼•ï¼ˆç»„åˆç´¢å¼•ï¼‰"></a>5.7 å¤åˆç´¢å¼•ï¼ˆç»„åˆç´¢å¼•ï¼‰</h2><p>å¤åˆç´¢å¼•ï¼ˆCompound Indexï¼‰ä¹Ÿç§°ä¸ºå¤šåˆ—ç´¢å¼•ï¼ˆMulti-Column Indexï¼‰ï¼Œæ˜¯æŒ‡å¯¹æ•°æ®åº“è¡¨ä¸­å¤šä¸ªåˆ—è¿›è¡Œç´¢å¼•åˆ›å»ºã€‚</p>
<p>ä¸å•åˆ—ç´¢å¼•ä¸åŒï¼Œå¤åˆç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªåˆ—ã€‚è¿™æ ·å¯ä»¥å°†å¤šä¸ªåˆ—çš„å€¼ç»„åˆèµ·æ¥ä½œä¸ºç´¢å¼•çš„é”®ï¼Œä»¥æé«˜å¤šåˆ—æ¡ä»¶æŸ¥è¯¢çš„æ•ˆç‡ã€‚</p>
<blockquote>
<p>ä¸¾ä¸ªä¾‹å­</p>
</blockquote>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®¢å•è¡¨ï¼ˆOrderï¼‰ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å‡ ä¸ªåˆ—ï¼šè®¢å•ç¼–å·ï¼ˆOrderIDï¼‰ã€å®¢æˆ·ç¼–å·ï¼ˆCustomerIDï¼‰ã€è®¢å•æ—¥æœŸï¼ˆOrderDateï¼‰å’Œè®¢å•é‡‘é¢ï¼ˆOrderAmountï¼‰ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä¸ºè®¢å•è¡¨çš„å®¢æˆ·ç¼–å·å’Œè®¢å•æ—¥æœŸè¿™ä¸¤åˆ—åˆ›å»ºå¤åˆç´¢å¼•ï¼ˆCustomerID, OrderDateï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æŸ¥è¯¢æ—¶åŒæ—¶æ ¹æ®å®¢æˆ·ç¼–å·å’Œè®¢å•æ—¥æœŸæ¥å¿«é€Ÿå®šä½åˆ°åŒ¹é…çš„è®°å½•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹SQLè¯­å¥æŸ¥è¯¢å®¢æˆ·ç¼–å·ä¸º123456ä¸”è®¢å•æ—¥æœŸä¸º2021-01-01çš„è®¢å•ä¿¡æ¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">Order</span> <span class="keyword">WHERE</span> CustomerID <span class="operator">=</span> <span class="number">123456</span> <span class="keyword">AND</span> OrderDate <span class="operator">=</span> <span class="string">&#x27;2021-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>ç”±äºæˆ‘ä»¬ä¸ºå®¢æˆ·ç¼–å·å’Œè®¢å•æ—¥æœŸåˆ›å»ºäº†å¤åˆç´¢å¼•ï¼Œæ•°æ®åº“å¯ä»¥ä½¿ç”¨è¿™ä¸ªç´¢å¼•æ¥å¿«é€Ÿå®šä½åˆ°ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œä»è€ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚å¤åˆç´¢å¼•çš„ä½¿ç”¨èƒ½å¤Ÿæé«˜å¤šåˆ—æ¡ä»¶æŸ¥è¯¢çš„æ•ˆç‡ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤åˆç´¢å¼•çš„åˆ›å»ºå’Œç»´æŠ¤å¯èƒ½ä¼šå¢åŠ ç´¢å¼•çš„å­˜å‚¨ç©ºé—´å’Œå¯¹äºå†™æ“ä½œçš„å½±å“ã€‚</p>
<p><strong>ç›¸å¯¹äºå•åˆ—ç´¢å¼•ï¼Œå¤åˆç´¢å¼•æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>å‡å°‘ç´¢å¼•çš„æ•°é‡ï¼šå¤åˆç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªåˆ—ï¼Œå› æ­¤å¯ä»¥å‡å°‘ç´¢å¼•çš„æ•°é‡ï¼Œå‡å°‘ç´¢å¼•çš„å­˜å‚¨ç©ºé—´å’Œç»´æŠ¤æˆæœ¬ã€‚</li>
<li>æé«˜æŸ¥è¯¢æ€§èƒ½ï¼šå½“æŸ¥è¯¢æ¡ä»¶ä¸­æ¶‰åŠåˆ°å¤åˆç´¢å¼•çš„å¤šä¸ªåˆ—æ—¶ï¼Œæ•°æ®åº“å¯ä»¥ä½¿ç”¨å¤åˆç´¢å¼•è¿›è¡Œå¿«é€Ÿå®šä½å’Œè¿‡æ»¤ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>è¦†ç›–æŸ¥è¯¢ï¼šå¦‚æœå¤åˆç´¢å¼•åŒ…å«äº†æ‰€æœ‰æŸ¥è¯¢éœ€è¦çš„åˆ—ï¼Œé‚£ä¹ˆæ•°æ®åº“å¯ä»¥ç›´æ¥ä½¿ç”¨ç´¢å¼•ä¸­çš„æ•°æ®ï¼Œè€Œä¸éœ€è¦å†è¿›è¡Œè¡¨çš„è¯»å–ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>æ’åºå’Œåˆ†ç»„ï¼šç”±äºå¤åˆç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ï¼Œå› æ­¤å¯ä»¥ç”¨äºæ’åºå’Œåˆ†ç»„æ“ä½œï¼Œä»è€Œæé«˜æ’åºå’Œåˆ†ç»„çš„æ€§èƒ½ã€‚</li>
</ul>
<h1 id="6-ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"><a href="#6-ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="6. ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"></a>6. ç´¢å¼•çš„ä¼˜ç¼ºç‚¹</h1><p>ç´¢å¼•æ˜¯æ•°æ®åº“ä¸­ä¸€ç§é‡è¦çš„æ•°æ®ç»“æ„ï¼Œç”¨äºåŠ é€Ÿæ•°æ®çš„æ£€ç´¢å’ŒæŸ¥è¯¢æ“ä½œã€‚å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹å¦‚ä¸‹ï¼š</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æé«˜æŸ¥è¯¢æ€§èƒ½ï¼šé€šè¿‡åˆ›å»ºç´¢å¼•ï¼Œå¯ä»¥å¤§å¤§å‡å°‘æ•°æ®åº“æŸ¥è¯¢çš„æ•°æ®é‡ï¼Œä»è€Œæå‡æŸ¥è¯¢çš„é€Ÿåº¦ã€‚</li>
<li>åŠ é€Ÿæ’åºï¼šå½“æŸ¥è¯¢éœ€è¦æŒ‰ç…§æŸä¸ªå­—æ®µè¿›è¡Œæ’åºæ—¶ï¼Œç´¢å¼•å¯ä»¥åŠ é€Ÿæ’åºçš„è¿‡ç¨‹ï¼Œæé«˜æ’åºçš„æ•ˆç‡ã€‚</li>
<li>å‡å°‘ç£ç›˜IOï¼šç´¢å¼•å¯ä»¥å‡å°‘ç£ç›˜IOçš„æ¬¡æ•°ï¼Œè¿™å¯¹äºç£ç›˜è¯»å†™é€Ÿåº¦è¾ƒä½çš„åœºæ™¯ï¼Œå°¤å…¶é‡è¦ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å æ®é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼šç´¢å¼•éœ€è¦å æ®é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œç´¢å¼•å¯èƒ½å æ®è¾ƒå¤§çš„ç©ºé—´ã€‚</li>
<li>å¢åˆ æ”¹æ“ä½œçš„æ€§èƒ½æŸè€—ï¼šæ¯æ¬¡å¯¹æ•°æ®è¡¨è¿›è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ›´æ–°ç´¢å¼•ï¼Œä¼šå¯¼è‡´æ“ä½œçš„æ€§èƒ½é™ä½ã€‚</li>
<li>èµ„æºæ¶ˆè€—è¾ƒå¤§ï¼šç´¢å¼•éœ€è¦å ç”¨å†…å­˜å’ŒCPUèµ„æºï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§è§„æ¨¡å¹¶å‘è®¿é—®çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¹ç³»ç»Ÿçš„æ€§èƒ½äº§ç”Ÿå½±å“ã€‚</li>
</ul>
<h1 id="7-ä½•æ—¶ç”¨ç´¢å¼•"><a href="#7-ä½•æ—¶ç”¨ç´¢å¼•" class="headerlink" title="7. ä½•æ—¶ç”¨ç´¢å¼•"></a>7. ä½•æ—¶ç”¨ç´¢å¼•</h1><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨ç´¢å¼•ï¼š</p>
<ul>
<li>é¢‘ç¹æ‰§è¡ŒæŸ¥è¯¢æ“ä½œçš„å­—æ®µï¼šå¦‚æœè¿™äº›å­—æ®µç»å¸¸è¢«æŸ¥è¯¢ï¼Œä½¿ç”¨ç´¢å¼•å¯ä»¥æé«˜æŸ¥è¯¢çš„æ€§èƒ½ï¼Œå‡å°‘æŸ¥è¯¢çš„æ—¶é—´ã€‚ </li>
<li>å¤§è¡¨ï¼šå½“è¡¨çš„æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä½¿ç”¨ç´¢å¼•å¯ä»¥å¿«é€Ÿå®šä½åˆ°æ‰€éœ€çš„æ•°æ®ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ </li>
<li>éœ€è¦æ’åºæˆ–è€…åˆ†ç»„çš„å­—æ®µï¼šåœ¨å¯¹å­—æ®µè¿›è¡Œæ’åºæˆ–è€…åˆ†ç»„æ“ä½œæ—¶ï¼Œç´¢å¼•å¯ä»¥å‡å°‘æ’åºæˆ–è€…åˆ†ç»„çš„æ—¶é—´ã€‚ </li>
<li>å¤–é”®å…³è”çš„å­—æ®µï¼šåœ¨è¿›è¡Œè¡¨ä¹‹é—´çš„å…³è”æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨ç´¢å¼•å¯ä»¥åŠ å¿«å…³è”æŸ¥è¯¢çš„é€Ÿåº¦ã€‚</li>
</ul>
<p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¸å»ºè®®ä½¿ç”¨ç´¢å¼•ï¼š</p>
<ul>
<li>é¢‘ç¹æ‰§è¡Œæ›´æ–°æ“ä½œçš„è¡¨ï¼šå¦‚æœè¡¨ç»å¸¸è¢«æ›´æ–°æ•°æ®ï¼Œä½¿ç”¨ç´¢å¼•å¯èƒ½ä¼šé™ä½æ›´æ–°æ“ä½œçš„æ€§èƒ½ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½éœ€è¦ç»´æŠ¤ç´¢å¼•ã€‚ </li>
<li>å°è¡¨ï¼šå¯¹äºæ•°æ®é‡è¾ƒå°çš„è¡¨ï¼Œä½¿ç”¨ç´¢å¼•å¯èƒ½å¹¶ä¸ä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½æå‡ï¼Œåè€Œä¼šå ç”¨é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ </li>
<li>å¯¹äºå”¯ä¸€æ€§å¾ˆå·®çš„å­—æ®µï¼Œä¸€èˆ¬ä¸å»ºè®®æ·»åŠ ç´¢å¼•ã€‚å½“ä¸€ä¸ªå­—æ®µçš„å”¯ä¸€æ€§å¾ˆå·®æ—¶ï¼ŒæŸ¥è¯¢æ“ä½œåŸºæœ¬ä¸Šéœ€è¦æ‰«ææ•´ä¸ªè¡¨çš„å¤§éƒ¨åˆ†æ•°æ®ã€‚å¦‚æœä¸ºè¿™æ ·çš„å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œç´¢å¼•çš„å¤§å°å¯èƒ½ä¼šæ¯”æ•°æ®æœ¬èº«è¿˜å¤§ï¼Œå¯¼è‡´ç´¢å¼•çš„å­˜å‚¨ç©ºé—´å ç”¨è¿‡é«˜ï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¼è‡´æŸ¥è¯¢æ“ä½œçš„æ€§èƒ½ä¸‹é™ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œç´¢å¼•éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œä½¿ç”¨å’Œæƒè¡¡ï¼Œéœ€è¦è€ƒè™‘åˆ°è¡¨çš„å¤§å°ã€æŸ¥è¯¢é¢‘ç‡ã€æ›´æ–°é¢‘ç‡ä»¥åŠä¸šåŠ¡éœ€æ±‚ç­‰å› ç´ ã€‚</p>
]]></content>
      <categories>
        <category>DB</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬1ç« ã€‘ å­˜å‚¨è¿‡ç¨‹</title>
    <url>/posts/MySQL-Advanced-Chapter-One-Stored-Procedure/</url>
    <content><![CDATA[<h1 id="1-å­˜å‚¨è¿‡ç¨‹çš„æ¦‚å¿µ"><a href="#1-å­˜å‚¨è¿‡ç¨‹çš„æ¦‚å¿µ" class="headerlink" title="1. å­˜å‚¨è¿‡ç¨‹çš„æ¦‚å¿µ"></a>1. å­˜å‚¨è¿‡ç¨‹çš„æ¦‚å¿µ</h1><p>å­˜å‚¨è¿‡ç¨‹å¯ç§°ä¸ºè¿‡ç¨‹åŒ–SQLè¯­è¨€ï¼Œæ˜¯åœ¨æ™®é€šSQLè¯­å¥çš„åŸºç¡€ä¸Šå¢åŠ äº†ç¼–ç¨‹è¯­è¨€çš„ç‰¹ç‚¹ï¼ŒæŠŠæ•°æ®æ“ä½œè¯­å¥(DML)å’ŒæŸ¥è¯¢è¯­å¥(DQL)ç»„ç»‡åœ¨è¿‡ç¨‹åŒ–ä»£ç ä¸­ï¼Œé€šè¿‡é€»è¾‘åˆ¤æ–­ã€å¾ªç¯ç­‰æ“ä½œå®ç°å¤æ‚è®¡ç®—çš„ç¨‹åºè¯­è¨€ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œå­˜å‚¨è¿‡ç¨‹å…¶å®å°±æ˜¯æ•°æ®åº“å†…ç½®çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œè¿™ç§ç¼–ç¨‹è¯­è¨€ä¹Ÿæœ‰è‡ªå·±çš„å˜é‡ã€ifè¯­å¥ã€å¾ªç¯è¯­å¥ç­‰ã€‚åœ¨ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ä¸­å¯ä»¥å°†å¤šæ¡SQLè¯­å¥ä»¥é€»è¾‘ä»£ç çš„æ–¹å¼å°†å…¶ä¸²è”èµ·æ¥ï¼Œæ‰§è¡Œè¿™ä¸ªå­˜å‚¨è¿‡ç¨‹å°±æ˜¯å°†è¿™äº›SQLè¯­å¥æŒ‰ç…§ä¸€å®šçš„é€»è¾‘å»æ‰§è¡Œï¼Œæ‰€ä»¥ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ä¹Ÿå¯ä»¥çœ‹åšæ˜¯ä¸€ç»„ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQL è¯­å¥é›†ã€‚</p>
<p>æ¯ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹éƒ½æ˜¯ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ï¼Œå°±åƒtableå’Œviewä¸€æ ·ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“å½“ä¸­ï¼Œä¸€æ¬¡ç¼–è¯‘æ°¸ä¹…æœ‰æ•ˆã€‚å¹¶ä¸”æ¯ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹éƒ½æœ‰è‡ªå·±çš„åå­—ã€‚å®¢æˆ·ç«¯ç¨‹åºé€šè¿‡å­˜å‚¨è¿‡ç¨‹çš„åå­—æ¥è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ã€‚</p>
<p>åœ¨æ•°æ®é‡ç‰¹åˆ«åºå¤§çš„æƒ…å†µä¸‹åˆ©ç”¨å­˜å‚¨è¿‡ç¨‹èƒ½è¾¾åˆ°å€é€Ÿçš„æ•ˆç‡æå‡ã€‚ </p>
<h1 id="2-å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#2-å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="2. å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>2. å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹</h1><p>ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ã€‚</p>
<ul>
<li>é™ä½äº†<strong>åº”ç”¨æœåŠ¡å™¨</strong>å’Œ<strong>æ•°æ®åº“æœåŠ¡å™¨</strong>ä¹‹é—´ç½‘ç»œé€šè®¯çš„å¼€é”€ã€‚å°¤å…¶åœ¨æ•°æ®é‡åºå¤§çš„æƒ…å†µä¸‹æ•ˆæœæ˜¾è‘—ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼šç§»æ¤æ€§å·®ã€‚ç¼–å†™éš¾åº¦å¤§ã€‚ç»´æŠ¤æ€§å·®ã€‚</p>
<ul>
<li>æ¯ä¸€ä¸ªæ•°æ®åº“éƒ½æœ‰è‡ªå·±çš„å­˜å‚¨è¿‡ç¨‹çš„è¯­æ³•è§„åˆ™ï¼Œè¿™ç§è¯­æ³•è§„åˆ™ä¸æ˜¯é€šç”¨çš„ã€‚ä¸€æ—¦ä½¿ç”¨äº†å­˜å‚¨è¿‡ç¨‹ï¼Œåˆ™æ•°æ®åº“äº§å“å¾ˆéš¾æ›´æ¢ï¼Œä¾‹å¦‚ï¼šç¼–å†™äº†mysqlçš„å­˜å‚¨è¿‡ç¨‹ï¼Œè¿™æ®µä»£ç åªèƒ½åœ¨mysqlä¸­è¿è¡Œï¼Œæ— æ³•åœ¨oracleæ•°æ®åº“ä¸­è¿è¡Œã€‚</li>
<li>å¯¹äºæ•°æ®åº“å­˜å‚¨è¿‡ç¨‹è¿™ç§è¯­æ³•æ¥è¯´ï¼Œæ²¡æœ‰ä¸“ä¸šçš„IDEå·¥å…·ï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰ï¼Œæ‰€ä»¥ç¼–ç é€Ÿåº¦è¾ƒä½ã€‚è‡ªç„¶ç»´æŠ¤çš„æˆæœ¬ä¹Ÿä¼šè¾ƒé«˜ã€‚</li>
</ul>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå­˜å‚¨è¿‡ç¨‹è¿˜æ˜¯å¾ˆå°‘ä½¿ç”¨çš„ã€‚åªæœ‰åœ¨ç³»ç»Ÿé‡åˆ°äº†æ€§èƒ½ç“¶é¢ˆï¼Œåœ¨è¿›è¡Œä¼˜åŒ–çš„æ—¶å€™ï¼Œå¯¹äºå¤§æ•°é‡çš„åº”ç”¨æ¥è¯´ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›ã€‚</p>
<h1 id="3-ç¬¬ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹"><a href="#3-ç¬¬ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="3. ç¬¬ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹"></a>3. ç¬¬ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹</h1><h2 id="3-1-å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»º"><a href="#3-1-å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»º" class="headerlink" title="3.1 å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»º"></a>3.1 å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»º</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create procedure p1()</span><br><span class="line">begin</span><br><span class="line">	select empno,ename from emp;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<h2 id="3-2-å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨"><a href="#3-2-å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨" class="headerlink" title="3.2 å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨"></a>3.2 å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">call p1();</span><br></pre></td></tr></table></figure>

<h2 id="3-3-å­˜å‚¨è¿‡ç¨‹çš„æŸ¥çœ‹"><a href="#3-3-å­˜å‚¨è¿‡ç¨‹çš„æŸ¥çœ‹" class="headerlink" title="3.3 å­˜å‚¨è¿‡ç¨‹çš„æŸ¥çœ‹"></a>3.3 å­˜å‚¨è¿‡ç¨‹çš„æŸ¥çœ‹</h2><p>æŸ¥çœ‹åˆ›å»ºå­˜å‚¨è¿‡ç¨‹çš„è¯­å¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show create procedure p1;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E7%9C%8B%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B.png" alt="æŸ¥çœ‹åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"></p>
<p>é€šè¿‡ç³»ç»Ÿè¡¨<code>information_schema.ROUTINES</code>æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<p><code>information_schema.ROUTINES</code> æ˜¯ MySQL æ•°æ®åº“ä¸­ä¸€ä¸ªç³»ç»Ÿè¡¨ï¼Œå­˜å‚¨äº†æ‰€æœ‰å­˜å‚¨è¿‡ç¨‹ã€å‡½æ•°ã€è§¦å‘å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åç§°ã€è¿”å›å€¼ç±»å‹ã€å‚æ•°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.routines <span class="keyword">where</span> routine_name <span class="operator">=</span> <span class="string">&#x27;p1&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B3%BB%E7%BB%9F%E8%A1%A8information_schema.ROUTINES.png" alt="ç³»ç»Ÿè¡¨information_schema.ROUTINES"></p>
<p><code>information_schema.ROUTINES</code> è¡¨ä¸­çš„ä¸€äº›é‡è¦çš„åˆ—åŒ…æ‹¬ï¼š</p>
<ul>
<li>SPECIFIC_NAMEï¼šå­˜å‚¨è¿‡ç¨‹çš„å…·ä½“åç§°ï¼ŒåŒ…æ‹¬è¯¥å­˜å‚¨è¿‡ç¨‹çš„åå­—ï¼Œå‚æ•°åˆ—è¡¨ã€‚</li>
<li>ROUTINE_SCHEMAï¼šå­˜å‚¨è¿‡ç¨‹æ‰€åœ¨çš„æ•°æ®åº“åç§°ã€‚</li>
<li>ROUTINE_NAMEï¼šå­˜å‚¨è¿‡ç¨‹çš„åç§°ã€‚</li>
<li>ROUTINE_TYPEï¼šPROCEDUREè¡¨ç¤ºæ˜¯ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼ŒFUNCTIONè¡¨ç¤ºæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</li>
<li>ROUTINE_DEFINITIONï¼šå­˜å‚¨è¿‡ç¨‹çš„å®šä¹‰è¯­å¥ã€‚</li>
<li>CREATEDï¼šå­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºæ—¶é—´ã€‚</li>
<li>LAST_ALTEREDï¼šå­˜å‚¨è¿‡ç¨‹çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚</li>
<li>DATA_TYPEï¼šå­˜å‚¨è¿‡ç¨‹çš„è¿”å›å€¼ç±»å‹ã€å‚æ•°ç±»å‹ç­‰ã€‚</li>
</ul>
<h2 id="3-4-å­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤"><a href="#3-4-å­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤" class="headerlink" title="3.4 å­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤"></a>3.4 å­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop procedure if exists p1;</span><br></pre></td></tr></table></figure>
<h2 id="3-5-delimiterå‘½ä»¤"><a href="#3-5-delimiterå‘½ä»¤" class="headerlink" title="3.5 delimiterå‘½ä»¤"></a>3.5 delimiterå‘½ä»¤</h2><p>åœ¨ MySQL ä¸­ï¼Œ<code>delimiter</code> å‘½ä»¤ç”¨äºæ”¹å˜ MySQL è§£é‡Šè¯­å¥çš„å®šç•Œç¬¦ã€‚MySQL é»˜è®¤ä½¿ç”¨åˆ†å· <code>;</code> ä½œä¸ºè¯­å¥çš„å®šç•Œç¬¦ã€‚è€Œä½¿ç”¨ <code>delimiter</code> å‘½ä»¤å¯ä»¥å°†åˆ†å· <code>;</code> æ›´æ”¹ä¸ºå…¶ä»–å­—ç¬¦ï¼Œä»è€Œå¯ä»¥åœ¨ SQL è¯­å¥ä¸­ä½¿ç”¨åˆ†å· <code>;</code></p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾éœ€è¦åˆ›å»ºä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ã€‚åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­é€šå¸¸ä¼šåŒ…æ‹¬å¤šæ¡ SQL è¯­å¥ï¼Œè€Œè¿™äº›è¯­å¥éƒ½éœ€è¦ä»¥åˆ†å· <code>;</code> ç»“å°¾ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰§è¡Œåˆ°ç¬¬ä¸€æ¡è¯­å¥çš„åˆ†å· <code>;</code> åï¼ŒMySQL å°±ä¼šåœæ­¢è§£é‡Šï¼Œå¯¼è‡´åç»­çš„è¯­å¥æ— æ³•æ‰§è¡Œã€‚è§£å†³æ–¹å¼å°±æ˜¯ä½¿ç”¨ <code>delimiter</code> å‘½ä»¤å°†åˆ†å·æ”¹ä¸ºå…¶ä»–å­—ç¬¦ï¼Œä½¿åˆ†å· <code>;</code> ä¸å†æ˜¯è¯­å¥å®šç•Œç¬¦ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">delimiter <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> my_proc ()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_table;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table (col1, col2) <span class="keyword">VALUES</span> (<span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>delimiter //</code> å‘½ä»¤å°†å®šç•Œç¬¦æ”¹ä¸ºä¸¤ä¸ªæ–œçº¿ <code>//</code>ã€‚åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ï¼Œä»¥åˆ†å· <code>;</code> ç»“å°¾çš„è¯­å¥ä¸å†è¢«è§£é‡Šä¸ºè¯­å¥çš„ç»“æŸã€‚è€Œä½¿ç”¨ <code>delimiter ;</code> å¯ä»¥å°†åˆ†å·æ¢å¤ä¸ºè¯­å¥å®šç•Œç¬¦ã€‚</p>
<p>æ€»ä¹‹ï¼Œ<code>delimiter</code> å‘½ä»¤å¯ä»¥æ”¹å˜ MySQL æ•°æ®åº“ç³»ç»Ÿä¸­ SQL æŸ¥è¯¢è¯­å¥çš„åˆ†éš”ç¬¦ï¼Œä»è€Œå¯ä½¿ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥åŒ…å«å¤šä¸ª SQL è¯­å¥ã€‚è¿™æ ·çš„è¯ï¼Œå°±æ–¹ä¾¿äº†æˆ‘ä»¬åœ¨ä¸€ä¸ªè¯­å¥é‡Œé¢åŠ å…¥å¤šä¸ªè¯­å¥ï¼Œè€Œä¸”ä¸ä¼šè¢«é”™</p>
<h1 id="4-MySQLçš„å˜é‡"><a href="#4-MySQLçš„å˜é‡" class="headerlink" title="4. MySQLçš„å˜é‡"></a>4. MySQLçš„å˜é‡</h1><p>mysqlä¸­çš„å˜é‡åŒ…æ‹¬ï¼šç³»ç»Ÿå˜é‡ã€ç”¨æˆ·å˜é‡ã€å±€éƒ¨å˜é‡ã€‚</p>
<h2 id="4-1-ç³»ç»Ÿå˜é‡"><a href="#4-1-ç³»ç»Ÿå˜é‡" class="headerlink" title="4.1 ç³»ç»Ÿå˜é‡"></a>4.1 ç³»ç»Ÿå˜é‡</h2><p>MySQL ç³»ç»Ÿå˜é‡æ˜¯æŒ‡åœ¨ MySQL æœåŠ¡å™¨è¿è¡Œæ—¶æ§åˆ¶å…¶è¡Œä¸ºçš„å‚æ•°ã€‚è¿™äº›å˜é‡å¯ä»¥è¢«è®¾ç½®ä¸ºç‰¹å®šçš„å€¼æ¥æ”¹å˜æœåŠ¡å™¨çš„é»˜è®¤è®¾ç½®ï¼Œä»¥æ»¡è¶³ä¸åŒçš„éœ€æ±‚ã€‚</p>
<p>MySQL ç³»ç»Ÿå˜é‡å¯ä»¥å…·æœ‰å…¨å±€ï¼ˆglobalï¼‰æˆ–ä¼šè¯ï¼ˆsessionï¼‰ä½œç”¨åŸŸã€‚</p>
<ul>
<li>å…¨å±€ä½œç”¨åŸŸæ˜¯æŒ‡å¯¹æ‰€æœ‰è¿æ¥å’Œæ‰€æœ‰æ•°æ®åº“éƒ½é€‚ç”¨ï¼›</li>
<li>ä¼šè¯ä½œç”¨åŸŸæ˜¯æŒ‡åªå¯¹å½“å‰è¿æ¥å’Œå½“å‰æ•°æ®åº“é€‚ç”¨ã€‚</li>
</ul>
<p>æŸ¥çœ‹ç³»ç»Ÿå˜é‡ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> [<span class="keyword">global</span><span class="operator">|</span>session] variables;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> [<span class="keyword">global</span><span class="operator">|</span>session] variables <span class="keyword">like</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> @@[<span class="keyword">global</span><span class="operator">|</span>session.]ç³»ç»Ÿå˜é‡å;</span><br></pre></td></tr></table></figure>
<p><font color="red">PSï¼šæ²¡æœ‰æŒ‡å®šsessionæˆ–globalæ—¶ï¼Œé»˜è®¤æ˜¯session</font></p>
<p>è®¾ç½®ç³»ç»Ÿå˜é‡ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> [<span class="keyword">global</span> <span class="operator">|</span> session] ç³»ç»Ÿå˜é‡å <span class="operator">=</span> å€¼;</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> @@[<span class="keyword">global</span> <span class="operator">|</span> session.]ç³»ç»Ÿå˜é‡å <span class="operator">=</span> å€¼;</span><br></pre></td></tr></table></figure>
<p><font color="red">PSï¼šæ— è®ºæ˜¯å…¨å±€è®¾ç½®è¿˜æ˜¯ä¼šè¯è®¾ç½®ï¼Œå½“mysqlæœåŠ¡é‡å¯ä¹‹åï¼Œä¹‹å‰é…ç½®éƒ½ä¼šå¤±æ•ˆã€‚</font>å¯ä»¥é€šè¿‡ä¿®æ”¹MySQLæ ¹ç›®å½•ä¸‹çš„my.inié…ç½®æ–‡ä»¶è¾¾åˆ°æ°¸ä¹…ä¿®æ”¹çš„æ•ˆæœã€‚ï¼ˆmy.iniæ˜¯MySQLæ•°æ®åº“é»˜è®¤çš„ç³»ç»Ÿçº§é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ä¸å­˜åœ¨çš„ï¼Œéœ€è¦æ–°å»ºï¼Œå¹¶å‚è€ƒä¸€äº›èµ„æ–™è¿›è¡Œé…ç½®ã€‚ï¼‰</p>
<p>windowsç³»ç»Ÿæ˜¯<code>my.ini</code>ï¼Œlinuxç³»ç»Ÿæ˜¯<code>my.cnf</code>ï¼Œ<code>my.ini</code>æ–‡ä»¶é€šå¸¸æ”¾åœ¨mysqlå®‰è£…çš„æ ¹ç›®å½•ä¸‹ã€‚</p>
<p>è¿™ä¸ªæ–‡ä»¶é€šå¸¸æ˜¯ä¸å­˜åœ¨çš„ï¼Œå¯ä»¥æ–°å»ºï¼Œæ–°å»ºåä¾‹å¦‚æä¾›ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">autocommit=0</span><br></pre></td></tr></table></figure>
<p>è¿™ç§é…ç½®å°±è¡¨ç¤ºæ°¸ä¹…æ€§å…³é—­è‡ªåŠ¨æäº¤æœºåˆ¶ã€‚ï¼ˆä¸å»ºè®®è¿™æ ·åšã€‚ï¼‰</p>
<h2 id="4-2-ç”¨æˆ·å˜é‡"><a href="#4-2-ç”¨æˆ·å˜é‡" class="headerlink" title="4.2 ç”¨æˆ·å˜é‡"></a>4.2 ç”¨æˆ·å˜é‡</h2><p>ç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ã€‚åªåœ¨å½“å‰ä¼šè¯æœ‰æ•ˆã€‚æ‰€æœ‰çš„ç”¨æˆ·å˜é‡<code>@</code>å¼€å§‹ã€‚</p>
<p>ç»™ç”¨æˆ·å˜é‡èµ‹å€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@name</span> <span class="operator">=</span> <span class="string">&#x27;jackson&#x27;</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@age</span> :<span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@gender</span> :<span class="operator">=</span> <span class="string">&#x27;ç”·&#x27;</span>, <span class="variable">@addr</span> :<span class="operator">=</span> <span class="string">&#x27;åŒ—äº¬å¤§å…´åŒº&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@email</span> :<span class="operator">=</span> <span class="string">&#x27;jackson@123.com&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> sal <span class="keyword">into</span> <span class="variable">@sal</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è¯»å–ç”¨æˆ·å˜é‡çš„å€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="variable">@name</span>, <span class="variable">@age</span>, <span class="variable">@gender</span>, <span class="variable">@addr</span>, <span class="variable">@email</span>, <span class="variable">@sal</span>;</span><br></pre></td></tr></table></figure>
<p><font color="red">PSï¼šmysqlä¸­å˜é‡ä¸éœ€è¦å£°æ˜ã€‚ç›´æ¥èµ‹å€¼å°±è¡Œã€‚å¦‚æœæ²¡æœ‰å£°æ˜å˜é‡ï¼Œç›´æ¥è¯»å–è¯¥å˜é‡ï¼Œè¿”å›null</font></p>
<h2 id="4-3-å±€éƒ¨å˜é‡"><a href="#4-3-å±€éƒ¨å˜é‡" class="headerlink" title="4.3 å±€éƒ¨å˜é‡"></a>4.3 å±€éƒ¨å˜é‡</h2><p>åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚ä½¿ç”¨declareå£°æ˜ã€‚åœ¨beginå’Œendä¹‹é—´æœ‰æ•ˆã€‚</p>
<p>å˜é‡çš„å£°æ˜ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> å˜é‡å æ•°æ®ç±»å‹ [<span class="keyword">default</span> ...];</span><br></pre></td></tr></table></figure>
<p>å˜é‡çš„æ•°æ®ç±»å‹å°±æ˜¯è¡¨å­—æ®µçš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ï¼šintã€bigintã€charã€varcharã€dateã€timeã€datetimeç­‰ã€‚</p>
<p><font color="red"><strong>PSï¼šdeclareé€šå¸¸å‡ºç°åœ¨begin endä¹‹é—´çš„å¼€å§‹éƒ¨åˆ†ã€‚</strong></font></p>
<p>å˜é‡çš„èµ‹å€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> å˜é‡å <span class="operator">=</span> å€¼;</span><br><span class="line"><span class="keyword">set</span> å˜é‡å :<span class="operator">=</span> å€¼;</span><br><span class="line"><span class="keyword">select</span> å­—æ®µå <span class="keyword">into</span> å˜é‡å <span class="keyword">from</span> è¡¨å ...;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼šä»¥ä¸‹ç¨‹åºæ¼”ç¤ºå±€éƒ¨å˜é‡çš„å£°æ˜ã€èµ‹å€¼ã€è¯»å–ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">PROCEDURE</span> p2()</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="comment">/*å£°æ˜å˜é‡*/</span></span><br><span class="line">	<span class="keyword">declare</span> emp_count <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">/*å£°æ˜å˜é‡*/</span></span><br><span class="line">	<span class="keyword">declare</span> sal <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">default</span> <span class="number">0.0</span>;</span><br><span class="line">	<span class="comment">/*ç»™å˜é‡èµ‹å€¼*/</span></span><br><span class="line">	<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">into</span> emp_count <span class="keyword">from</span> emp;</span><br><span class="line">	<span class="comment">/*ç»™å˜é‡èµ‹å€¼*/</span></span><br><span class="line">	<span class="keyword">set</span> sal :<span class="operator">=</span> <span class="number">5000.0</span>;</span><br><span class="line">	<span class="comment">/*è¯»å–å˜é‡çš„å€¼*/</span></span><br><span class="line">	<span class="keyword">select</span> emp_count;</span><br><span class="line">	<span class="comment">/*è¯»å–å˜é‡çš„å€¼*/</span></span><br><span class="line">	<span class="keyword">select</span> sal;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> p2();</span><br></pre></td></tr></table></figure>


<h1 id="5-ifè¯­å¥"><a href="#5-ifè¯­å¥" class="headerlink" title="5. ifè¯­å¥"></a>5. ifè¯­å¥</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">if æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">......</span><br><span class="line">elseif æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">......</span><br><span class="line">elseif æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">......</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">......</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹ï¼šå‘˜å·¥æœˆè–ªsalï¼Œè¶…è¿‡10000çš„å±äºâ€œé«˜æ”¶å…¥â€ï¼Œ6000åˆ°10000çš„å±äºâ€œä¸­æ”¶å…¥â€ï¼Œå°‘äº6000çš„å±äºâ€œä½æ”¶å…¥â€</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p3(               )</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> sal <span class="type">int</span> <span class="keyword">default</span> <span class="number">5000</span>;</span><br><span class="line">	<span class="keyword">declare</span> grade <span class="type">varchar</span>(<span class="number">20</span>);</span><br><span class="line">	if sal <span class="operator">&gt;</span> <span class="number">10000</span> <span class="keyword">then</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;é«˜æ”¶å…¥&#x27;</span>;</span><br><span class="line">	elseif sal <span class="operator">&gt;=</span> <span class="number">6000</span> <span class="keyword">then</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;ä¸­æ”¶å…¥&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;ä½æ”¶å…¥&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> if;</span><br><span class="line">	<span class="keyword">select</span> grade;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> p3();</span><br></pre></td></tr></table></figure>


<h1 id="6-å‚æ•°"><a href="#6-å‚æ•°" class="headerlink" title="6. å‚æ•°"></a>6. å‚æ•°</h1><p>å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°åŒ…æ‹¬ä¸‰ç§å½¢å¼ï¼š</p>
<ul>
<li>inï¼šå…¥å‚ï¼ˆæœªæŒ‡å®šæ—¶ï¼Œé»˜è®¤æ˜¯inï¼‰</li>
<li>outï¼šå‡ºå‚</li>
<li>inoutï¼šæ—¢æ˜¯å…¥å‚ï¼Œåˆæ˜¯å‡ºå‚</li>
</ul>
<blockquote>
<p>æ¡ˆä¾‹ï¼šå‘˜å·¥æœˆè–ªsalï¼Œè¶…è¿‡10000çš„å±äºâ€œé«˜æ”¶å…¥â€ï¼Œ6000åˆ°10000çš„å±äºâ€œä¸­æ”¶å…¥â€ï¼Œå°‘äº6000çš„å±äºâ€œä½æ”¶å…¥â€</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p4(<span class="keyword">in</span> sal <span class="type">int</span>, <span class="keyword">out</span> grade <span class="type">varchar</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	if sal <span class="operator">&gt;</span> <span class="number">10000</span> <span class="keyword">then</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;é«˜æ”¶å…¥&#x27;</span>;</span><br><span class="line">	elseif sal <span class="operator">&gt;=</span> <span class="number">6000</span> <span class="keyword">then</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;ä¸­æ”¶å…¥&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">  	<span class="keyword">set</span> grade :<span class="operator">=</span> <span class="string">&#x27;ä½æ”¶å…¥&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> p4(<span class="number">5000</span>, <span class="variable">@grade</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@grade</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹ï¼šå°†ä¼ å…¥çš„å·¥èµ„salä¸Šè°ƒ10%</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p5(<span class="keyword">inout</span> sal <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">set</span> sal :<span class="operator">=</span> sal <span class="operator">*</span> <span class="number">1.1</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="variable">@sal</span> :<span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">call</span> p5(<span class="variable">@sal</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@sal</span>;</span><br></pre></td></tr></table></figure>


<h1 id="7-caseè¯­å¥"><a href="#7-caseè¯­å¥" class="headerlink" title="7. caseè¯­å¥"></a>7. caseè¯­å¥</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span> å€¼</span><br><span class="line">	<span class="keyword">when</span> å€¼<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">when</span> å€¼<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">when</span> å€¼<span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	......</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">case</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span></span><br><span class="line">	<span class="keyword">when</span> æ¡ä»¶<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">when</span> æ¡ä»¶<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">when</span> æ¡ä»¶<span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">	......</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	......</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">case</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹ï¼šæ ¹æ®ä¸åŒæœˆä»½ï¼Œè¾“å‡ºä¸åŒçš„å­£èŠ‚ã€‚3ã€4ã€5æœˆä»½æ˜¥å­£ã€‚6ã€7ã€8æœˆä»½å¤å­£ã€‚9ã€10ã€11æœˆä»½ç§‹å­£ã€‚12ã€1ã€2 å†¬å­£ã€‚å…¶ä»–éæ³•</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> <span class="keyword">month</span> <span class="type">int</span>, <span class="keyword">out</span> <span class="keyword">result</span> <span class="type">varchar</span>(<span class="number">100</span>))</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">month</span></span><br><span class="line">		<span class="keyword">when</span> <span class="number">3</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;æ˜¥å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">4</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;æ˜¥å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">5</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;æ˜¥å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">6</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å¤å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">7</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å¤å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">8</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å¤å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">9</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;ç§‹å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">10</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;ç§‹å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">11</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;ç§‹å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">12</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å†¬å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å†¬å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å†¬å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;éæ³•æœˆä»½&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> <span class="keyword">month</span> <span class="type">int</span>, <span class="keyword">out</span> <span class="keyword">result</span> <span class="type">varchar</span>(<span class="number">100</span>))</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">case</span> </span><br><span class="line">		<span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">3</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">4</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;æ˜¥å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span>  <span class="keyword">month</span> <span class="operator">=</span> <span class="number">6</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">7</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">8</span>  <span class="keyword">then</span> </span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å¤å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span>  <span class="keyword">month</span> <span class="operator">=</span> <span class="number">9</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">10</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">11</span>  <span class="keyword">then</span> </span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;ç§‹å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">when</span>  <span class="keyword">month</span> <span class="operator">=</span> <span class="number">12</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="number">2</span>  <span class="keyword">then</span> </span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;å†¬å­£&#x27;</span>;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			<span class="keyword">set</span> <span class="keyword">result</span> :<span class="operator">=</span> <span class="string">&#x27;éæ³•æœˆä»½&#x27;</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> mypro(<span class="number">9</span>, <span class="variable">@season</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@season</span>;</span><br></pre></td></tr></table></figure>


<h1 id="8-whileå¾ªç¯"><a href="#8-whileå¾ªç¯" class="headerlink" title="8. whileå¾ªç¯"></a>8. whileå¾ªç¯</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">while æ¡ä»¶ do</span><br><span class="line">	å¾ªç¯ä½“;</span><br><span class="line"><span class="keyword">end</span> while;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹ï¼šä¼ å…¥ä¸€ä¸ªæ•°å­—nï¼Œè®¡ç®—1~nä¸­æ‰€æœ‰å¶æ•°çš„å’Œ</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> n <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">declare</span> sum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">	while n <span class="operator">&gt;</span> <span class="number">0</span> do</span><br><span class="line">  		if n <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    		<span class="keyword">set</span> sum :<span class="operator">=</span> sum <span class="operator">+</span> n;</span><br><span class="line">  		<span class="keyword">end</span> if;</span><br><span class="line">  		<span class="keyword">set</span> n :<span class="operator">=</span> n <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">end</span> while;</span><br><span class="line">	<span class="keyword">select</span> sum;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> mypro(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>


<h1 id="9-repeatå¾ªç¯"><a href="#9-repeatå¾ªç¯" class="headerlink" title="9. repeatå¾ªç¯"></a>9. repeatå¾ªç¯</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">repeat</span><br><span class="line">	å¾ªç¯ä½“;</span><br><span class="line">	until æ¡ä»¶</span><br><span class="line"><span class="keyword">end</span> repeat;</span><br></pre></td></tr></table></figure>
<p><font color="red">PSï¼šæ¡ä»¶æˆç«‹æ—¶ç»“æŸå¾ªç¯</font></p>
<blockquote>
<p>æ¡ˆä¾‹ï¼šä¼ å…¥ä¸€ä¸ªæ•°å­—nï¼Œè®¡ç®—1~nä¸­æ‰€æœ‰å¶æ•°çš„å’Œ</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> n <span class="type">int</span>, <span class="keyword">out</span> sum <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">set</span> sum :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	repeat </span><br><span class="line">		if n <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">		  <span class="keyword">set</span> sum :<span class="operator">=</span> sum <span class="operator">+</span> n;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		<span class="keyword">set</span> n :<span class="operator">=</span> n <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">		until n <span class="operator">&lt;=</span> <span class="number">0</span> <span class="comment">/* æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½æ·»åŠ  ; ç»“å°¾ */</span></span><br><span class="line">	<span class="keyword">end</span> repeat;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">call</span> mypro(<span class="number">10</span>, <span class="variable">@sum</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@sum</span>;</span><br></pre></td></tr></table></figure>


<h1 id="10-loopå¾ªç¯"><a href="#10-loopå¾ªç¯" class="headerlink" title="10. loopå¾ªç¯"></a>10. loopå¾ªç¯</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro()</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">  mylp:loop </span><br><span class="line">		<span class="keyword">set</span> i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		if i <span class="operator">=</span> <span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">			leave mylp;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		<span class="keyword">select</span> i;</span><br><span class="line">	<span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ¡ˆä¾‹</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro()</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">  mylp:loop </span><br><span class="line">		<span class="keyword">set</span> i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		if i <span class="operator">=</span> <span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">			iterate mylp;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		if i <span class="operator">=</span> <span class="number">10</span> <span class="keyword">then</span> </span><br><span class="line">		  leave mylp;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		<span class="keyword">select</span> i;</span><br><span class="line">	<span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>


<h1 id="11-æ¸¸æ ‡cursor"><a href="#11-æ¸¸æ ‡cursor" class="headerlink" title="11. æ¸¸æ ‡cursor"></a>11. æ¸¸æ ‡cursor</h1><p>æ¸¸æ ‡ï¼ˆcursorï¼‰å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæŒ‡å‘ç»“æœé›†ä¸­æŸæ¡è®°å½•çš„æŒ‡é’ˆï¼Œå…è®¸ç¨‹åºé€ä¸€è®¿é—®ç»“æœé›†ä¸­çš„æ¯æ¡è®°å½•ï¼Œå¹¶å¯¹å…¶è¿›è¡Œé€è¡Œæ“ä½œå’Œå¤„ç†ã€‚</p>
<p>ä½¿ç”¨æ¸¸æ ‡æ—¶ï¼Œéœ€è¦åœ¨å­˜å‚¨è¿‡ç¨‹æˆ–å‡½æ•°ä¸­å®šä¹‰ä¸€ä¸ªæ¸¸æ ‡å˜é‡ï¼Œå¹¶é€šè¿‡ <code>DECLARE</code> è¯­å¥è¿›è¡Œå£°æ˜å’Œåˆå§‹åŒ–ã€‚ç„¶åï¼Œä½¿ç”¨ <code>OPEN</code> è¯­å¥æ‰“å¼€æ¸¸æ ‡ï¼Œä½¿ç”¨ <code>FETCH</code> è¯­å¥é€è¡Œè·å–æ¸¸æ ‡æŒ‡å‘çš„è®°å½•ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚æœ€åï¼Œä½¿ç”¨ <code>CLOSE</code> è¯­å¥å…³é—­æ¸¸æ ‡ï¼Œé‡Šæ”¾ç›¸å…³èµ„æºã€‚æ¸¸æ ‡å¯ä»¥å¤§å¤§åœ°æé«˜æ•°æ®åº“æŸ¥è¯¢çš„çµæ´»æ€§å’Œæ•ˆç‡ã€‚</p>
<p>å£°æ˜æ¸¸æ ‡çš„è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> æ¸¸æ ‡åç§° <span class="keyword">cursor</span> <span class="keyword">for</span> æŸ¥è¯¢è¯­å¥;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€æ¸¸æ ‡çš„è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">open</span> æ¸¸æ ‡åç§°;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ¸¸æ ‡å–æ•°æ®çš„è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fetch</span> æ¸¸æ ‡åç§° <span class="keyword">into</span> å˜é‡[,å˜é‡,å˜é‡......]</span><br></pre></td></tr></table></figure>
<p>å…³é—­æ¸¸æ ‡çš„è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">close</span> æ¸¸æ ‡åç§°;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¡ˆä¾‹ï¼šä»deptè¡¨æŸ¥è¯¢éƒ¨é—¨ç¼–å·å’Œéƒ¨é—¨åï¼Œåˆ›å»ºä¸€å¼ æ–°è¡¨dept2ï¼Œå°†æŸ¥è¯¢ç»“æœæ’å…¥åˆ°æ–°è¡¨ä¸­</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop procedure if exists mypro;</span><br><span class="line"></span><br><span class="line">create procedure mypro()</span><br><span class="line">begin </span><br><span class="line">	</span><br><span class="line">	/* å£°æ˜å˜é‡ */</span><br><span class="line">	declare dept_no int;</span><br><span class="line">	declare dept_name varchar(255);</span><br><span class="line"></span><br><span class="line">	/* å£°æ˜æ¸¸æ ‡ï¼Œæ³¨æ„ï¼šå£°æ˜æ¸¸æ ‡çš„è¯­å¥å¿…é¡»æ”¾åœ¨å£°æ˜æ™®é€šå˜é‡çš„åé¢ã€‚ */</span><br><span class="line">	declare dept_cursor cursor for select deptno,dname from dept;</span><br><span class="line">	</span><br><span class="line">	/* åˆ é™¤è¡¨dept2 */</span><br><span class="line">	drop table if exists dept2;</span><br><span class="line">	</span><br><span class="line">	/* åˆ›å»ºè¡¨ dept2 */</span><br><span class="line">	create table dept2(</span><br><span class="line">		deptno int,</span><br><span class="line">		dname varchar(255)</span><br><span class="line">	);</span><br><span class="line">	</span><br><span class="line">	/* æ‰“å¼€æ¸¸æ ‡ */</span><br><span class="line">	open dept_cursor;</span><br><span class="line">	</span><br><span class="line">	/* é€šè¿‡æ¸¸æ ‡å–æ•°æ® */</span><br><span class="line">	/*fetch dept_cursor into dept_no, dept_name;*/</span><br><span class="line">	</span><br><span class="line">	/* æŸ¥çœ‹ä»¥ä¸‹å˜é‡çš„å€¼ */</span><br><span class="line">	/*select dept_no,dept_name;*/</span><br><span class="line">	</span><br><span class="line">	/* ä½¿ç”¨å¾ªç¯ä»æ¸¸æ ‡ä¸­å–æ•°æ® */</span><br><span class="line">	while true do </span><br><span class="line">		fetch dept_cursor into dept_no, dept_name;</span><br><span class="line">		/*select dept_no,dept_name;*/</span><br><span class="line">		insert into dept2(deptno,dname) values(dept_no, dept_name);</span><br><span class="line">	end while;</span><br><span class="line">	</span><br><span class="line">	/* å…³é—­æ¸¸æ ‡ */</span><br><span class="line">	close dept_cursor;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">call mypro();</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%B8%B8%E6%A0%87cursor%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%87%BA%E7%8E%B0%E5%BC%82%E5%B8%B8.png" alt="æ¸¸æ ‡cursoræ‰§è¡Œç»“æœå‡ºç°å¼‚å¸¸"></p>
<p>å‡ºç°äº†å¼‚å¸¸ï¼šå¼‚å¸¸ä¿¡æ¯ä¸­æ˜¾ç¤ºæ²¡æœ‰æ•°æ®äº†ã€‚è¿™æ˜¯å› ä¸ºwhile trueå¾ªç¯å¯¼è‡´çš„ã€‚</p>
<p>ä¸è¿‡è™½ç„¶å‡ºç°äº†å¼‚å¸¸ï¼Œä½†æ˜¯è¡¨åˆ›å»ºæˆåŠŸäº†ï¼Œæ•°æ®ä¹Ÿæ’å…¥æˆåŠŸäº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87cursor%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%88%90%E5%8A%9F.png" alt="ä½¿ç”¨æ¸¸æ ‡cursoråˆ›å»ºè¡¨æˆåŠŸ"></p>
<p><font color="red"><strong>æ³¨æ„ï¼šå£°æ˜å±€éƒ¨å˜é‡å’Œå£°æ˜æ¸¸æ ‡æœ‰é¡ºåºè¦æ±‚ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜éœ€è¦åœ¨æ¸¸æ ‡å£°æ˜ä¹‹å‰å®Œæˆã€‚</strong></font></p>
<h1 id="12-æ•æ‰å¼‚å¸¸å¹¶å¤„ç†"><a href="#12-æ•æ‰å¼‚å¸¸å¹¶å¤„ç†" class="headerlink" title="12. æ•æ‰å¼‚å¸¸å¹¶å¤„ç†"></a>12. æ•æ‰å¼‚å¸¸å¹¶å¤„ç†</h1><p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DECLARE handler_name HANDLER FOR condition_value action_statement</span><br></pre></td></tr></table></figure>

<ul>
<li><code>handler_name</code> è¡¨ç¤ºå¼‚å¸¸å¤„ç†ç¨‹åºçš„åç§°ï¼Œé‡è¦å–å€¼åŒ…æ‹¬ï¼š<ul>
<li><code>CONTINUE</code>ï¼šå‘ç”Ÿå¼‚å¸¸åï¼Œç¨‹åºä¸ä¼šç»ˆæ­¢ï¼Œä¼šæ­£å¸¸æ‰§è¡Œåç»­çš„è¿‡ç¨‹ã€‚(æ•æ‰)</li>
<li><code>EXIT</code>ï¼šå‘ç”Ÿå¼‚å¸¸åï¼Œç»ˆæ­¢å­˜å‚¨è¿‡ç¨‹çš„æ‰§è¡Œã€‚ï¼ˆä¸ŠæŠ›ï¼‰</li>
</ul>
</li>
<li><code>condition_value</code> æ˜¯æŒ‡æ•è·çš„å¼‚å¸¸ï¼Œé‡è¦å–å€¼åŒ…æ‹¬ï¼š<ul>
<li><code>SQLSTATE sqlstate_value</code>ï¼Œä¾‹å¦‚ï¼šSQLSTATE â€˜02000â€™</li>
<li><code>SQLWARNING</code>ï¼Œä»£è¡¨æ‰€æœ‰01å¼€å¤´çš„SQLSTATE</li>
<li><code>NOT FOUND</code>ï¼Œä»£è¡¨æ‰€æœ‰02å¼€å¤´çš„SQLSTATE</li>
<li><code>SQLEXCEPTION</code>ï¼Œä»£è¡¨é™¤äº†01å’Œ02å¼€å¤´çš„æ‰€æœ‰SQLSTATE</li>
</ul>
</li>
<li><code>action_statement</code> æ˜¯æŒ‡å¼‚å¸¸å‘ç”Ÿæ—¶æ‰§è¡Œçš„è¯­å¥ï¼Œä¾‹å¦‚ï¼šCLOSE cursor_name</li>
</ul>
<p>ç»™ä¹‹å‰çš„æ¸¸æ ‡æ·»åŠ å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop procedure if exists mypro;</span><br><span class="line"></span><br><span class="line">create procedure mypro()</span><br><span class="line">begin </span><br><span class="line"></span><br><span class="line">	declare no int;</span><br><span class="line">	declare name varchar(100);</span><br><span class="line">	declare dept_cursor cursor for select deptno,dname from dept;</span><br><span class="line">	</span><br><span class="line">	/* é€šå¸¸åœ¨è¿™ä¸ªä½ç½®è¿›è¡Œå¼‚å¸¸çš„å¤„ç† */</span><br><span class="line">	declare exit handler for not found close dept_cursor;</span><br><span class="line"></span><br><span class="line">	drop table if exists dept2;</span><br><span class="line">	create table dept2(</span><br><span class="line">		no int primary key,</span><br><span class="line">		name varchar(100)</span><br><span class="line">	);</span><br><span class="line">	</span><br><span class="line">	open dept_cursor;</span><br><span class="line">	</span><br><span class="line">	while true do</span><br><span class="line">		fetch dept_cursor into no, name;</span><br><span class="line">		insert into dept2(no,name) values(no,name);</span><br><span class="line">	end while;</span><br><span class="line">	</span><br><span class="line">	close dept_cursor;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">call mypro();</span><br></pre></td></tr></table></figure>


<h1 id="13-å­˜å‚¨å‡½æ•°"><a href="#13-å­˜å‚¨å‡½æ•°" class="headerlink" title="13. å­˜å‚¨å‡½æ•°"></a>13. å­˜å‚¨å‡½æ•°</h1><p>å­˜å‚¨å‡½æ•°ï¼šå¸¦è¿”å›å€¼çš„å­˜å‚¨è¿‡ç¨‹ã€‚å‚æ•°åªå…è®¸æ˜¯inï¼ˆä½†ä¸èƒ½å†™æ˜¾ç¤ºçš„å†™inï¼‰ã€‚æ²¡æœ‰outï¼Œä¹Ÿæ²¡æœ‰inoutã€‚</p>
<p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE FUNCTION å­˜å‚¨å‡½æ•°åç§°(å‚æ•°åˆ—è¡¨) RETURNS æ•°æ®ç±»å‹ [ç‰¹å¾]</span><br><span class="line">BEGIN</span><br><span class="line">	--å‡½æ•°ä½“</span><br><span class="line">	RETURN ...;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>â€œç‰¹å¾â€çš„å¯å–é‡è¦å€¼å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>deterministic</code>ï¼šç”¨è¯¥ç‰¹å¾æ ‡è®°è¯¥å‡½æ•°ä¸ºç¡®å®šæ€§å‡½æ•°ï¼ˆä»€ä¹ˆæ˜¯ç¡®å®šæ€§å‡½æ•°ï¼Ÿæ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ä¼ åŒä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œè¿”å›å€¼éƒ½æ˜¯å›ºå®šçš„ï¼‰ã€‚è¿™æ˜¯ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œè¿™ç§æƒ…å†µä¸‹æ•´ä¸ªå‡½æ•°ä½“çš„æ‰§è¡Œå°±ä¼šçœç•¥äº†ï¼Œç›´æ¥è¿”å›ä¹‹å‰ç¼“å­˜çš„ç»“æœï¼Œæ¥æé«˜å‡½æ•°çš„æ‰§è¡Œæ•ˆç‡ã€‚</li>
<li><code>no sql</code>ï¼šç”¨è¯¥ç‰¹å¾æ ‡è®°è¯¥å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœç¡®å®æ²¡æœ‰æŸ¥è¯¢è¯­å¥å»ºè®®ä½¿ç”¨ã€‚å‘Šè¯‰ MySQL ä¼˜åŒ–å™¨ä¸éœ€è¦è€ƒè™‘ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜å’Œä¼˜åŒ–å™¨ç¼“å­˜æ¥ä¼˜åŒ–è¿™ä¸ªå‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸å¿…è¦çš„æŸ¥è¯¢æ¶ˆè€—äº§ç”Ÿï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</li>
<li><code>reads sql data</code>ï¼šç”¨è¯¥ç‰¹å¾æ ‡è®°è¯¥å‡½æ•°ä¼šè¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå‘Šè¯‰ MySQL ä¼˜åŒ–å™¨è¿™ä¸ªå‡½æ•°éœ€è¦æŸ¥è¯¢æ•°æ®åº“çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜æ¥ç¼“å­˜ç»“æœï¼Œä»è€Œæé«˜æŸ¥è¯¢æ€§èƒ½ï¼›åŒæ—¶ MySQL è¿˜ä¼šé’ˆå¯¹è¯¥å‡½æ•°çš„æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–å™¨ç¼“å­˜å¤„ç†ã€‚</li>
</ul>
<blockquote>
<p>æ¡ˆä¾‹ï¼šè®¡ç®—1~nçš„æ‰€æœ‰å¶æ•°ä¹‹å’Œ</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- åˆ é™¤å‡½æ•°</span><br><span class="line">drop function if exists sum_fun;</span><br><span class="line"></span><br><span class="line">-- åˆ›å»ºå‡½æ•°</span><br><span class="line">create function sum_fun(n int)</span><br><span class="line">returns int deterministic </span><br><span class="line">begin </span><br><span class="line">	declare result int default 0;</span><br><span class="line">	while n &gt; 0 do </span><br><span class="line">		if n % 2 = 0 then </span><br><span class="line">			set result := result + n;</span><br><span class="line">		end if;</span><br><span class="line">		set n := n - 1;</span><br><span class="line">	end while;</span><br><span class="line">	return result;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">-- è°ƒç”¨å‡½æ•°</span><br><span class="line">set @result = sum_fun(100);</span><br><span class="line">select @result;</span><br></pre></td></tr></table></figure>


<h1 id="14-è§¦å‘å™¨"><a href="#14-è§¦å‘å™¨" class="headerlink" title="14. è§¦å‘å™¨"></a>14. è§¦å‘å™¨</h1><p>MySQL è§¦å‘å™¨æ˜¯ä¸€ç§æ•°æ®åº“å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸è¡¨ç›¸å…³è”çš„ç‰¹æ®Šç¨‹åºã€‚å®ƒå¯ä»¥åœ¨ç‰¹å®šçš„æ•°æ®æ“ä½œï¼ˆä¾‹å¦‚æ’å…¥ï¼ˆINSERTï¼‰ã€æ›´æ–°ï¼ˆUPDATEï¼‰æˆ–åˆ é™¤ï¼ˆDELETEï¼‰ï¼‰è§¦å‘æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚MySQL è§¦å‘å™¨ä½¿æ•°æ®åº“å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨æ•°æ®çš„ä¸åŒçŠ¶æ€ä¹‹é—´ç»´æŠ¤ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºç‰¹å®šçš„æ•°æ®åº“è¡¨è‡ªåŠ¨æ‰§è¡Œæ“ä½œã€‚</p>
<p>è§¦å‘å™¨çš„ä½œç”¨ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>å¼ºåˆ¶å®æ–½ä¸šåŠ¡è§„åˆ™ï¼šè§¦å‘å™¨å¯ä»¥å¸®åŠ©ç¡®ä¿æ•°æ®è¡¨ä¸­çš„ä¸šåŠ¡è§„åˆ™å¾—åˆ°å¼ºåˆ¶æ‰§è¡Œï¼Œä¾‹å¦‚æ£€æŸ¥æ’å…¥æˆ–æ›´æ–°çš„æ•°æ®æ˜¯å¦ç¬¦åˆæŸäº›è§„åˆ™ã€‚ </li>
<li>æ•°æ®å®¡è®¡ï¼šè§¦å‘å™¨å¯ä»¥å£°æ˜åœ¨æ‰§è¡Œæ•°æ®ä¿®æ”¹æ—¶è‡ªåŠ¨è®°æ—¥å¿—æˆ–å®¡è®¡æ•°æ®å˜åŒ–çš„æ“ä½œï¼Œä½¿æ•°æ®å¯¹æ•°æ®åº“ç®¡ç†å‘˜å’Œ SQL å®¡è®¡äººå‘˜æ›´æ˜“äºè¿½è¸ªå’Œå®¡è®¡ã€‚ </li>
<li>æ‰§è¡Œç‰¹å®šä¸šåŠ¡æ“ä½œï¼šè§¦å‘å™¨å¯ä»¥è‡ªåŠ¨æ‰§è¡Œç‰¹å®šçš„ä¸šåŠ¡æ“ä½œï¼Œä¾‹å¦‚è®¡ç®—æ•°æ®è¡Œçš„æ€»æ•°ã€è®¡ç®—å¹³å‡å€¼æˆ–æ€»å’Œç­‰ã€‚</li>
</ul>
<p>MySQL è§¦å‘å™¨åˆ†ä¸ºä¸¤ç§ç±»å‹: <code>BEFORE</code> å’Œ <code>AFTER</code>ã€‚BEFORE è§¦å‘å™¨åœ¨æ‰§è¡Œ INSERTã€UPDATEã€DELETE è¯­å¥ä¹‹å‰æ‰§è¡Œï¼Œè€Œ AFTER è§¦å‘å™¨åœ¨æ‰§è¡Œ INSERTã€UPDATEã€DELETE è¯­å¥ä¹‹åæ‰§è¡Œã€‚</p>
<p>åˆ›å»ºè§¦å‘å™¨çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TRIGGER trigger_name</span><br><span class="line">BEFORE/AFTER INSERT/UPDATE/DELETE ON table_name FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">-- è§¦å‘å™¨æ‰§è¡Œçš„ SQL è¯­å¥</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>trigger_name</code>ï¼šè§¦å‘å™¨çš„åç§°</li>
<li><code>BEFORE/AFTER</code>ï¼šè§¦å‘å™¨çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ BEFORE æˆ–è€… AFTER</li>
<li><code>INSERT/UPDATE/DELETE</code>ï¼šè§¦å‘å™¨æ‰€ç›‘æ§çš„ DML è°ƒç”¨ç±»å‹</li>
<li><code>table_name</code>ï¼šè§¦å‘å™¨æ‰€ç»‘å®šçš„è¡¨å</li>
<li><code>FOR EACH ROW</code>ï¼šè¡¨ç¤ºè§¦å‘å™¨åœ¨æ¯è¡Œå—åˆ° DML çš„å½±å“ä¹‹åéƒ½ä¼šæ‰§è¡Œ</li>
<li>è§¦å‘å™¨æ‰§è¡Œçš„ SQL è¯­å¥ï¼šè¯¥è¯­å¥ä¼šåœ¨è§¦å‘å™¨è¢«è§¦å‘æ—¶æ‰§è¡Œ</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè§¦å‘å™¨æ˜¯ä¸€ç§é«˜çº§çš„æ•°æ®åº“åŠŸèƒ½ï¼Œåªæœ‰åœ¨å¿…è¦çš„æƒ…å†µä¸‹æ‰åº”è¯¥ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨éœ€è¦å®æ–½å¼ºåˆ¶æ€§ä¸šåŠ¡è§„åˆ™æ—¶ã€‚è¿‡å¤šçš„è§¦å‘å™¨å’Œå¤æ‚çš„è§¦å‘å™¨é€»è¾‘å¯èƒ½ä¼šå½±å“æŸ¥è¯¢æ€§èƒ½å’Œæ‰©å±•æ€§ã€‚</p>
<p><strong>å…³äºè§¦å‘å™¨çš„NEWå’ŒOLDå…³é”®å­—ï¼š</strong></p>
<p>åœ¨ MySQL è§¦å‘å™¨ä¸­ï¼Œ<code>NEW</code> å’Œ <code>OLD</code> æ˜¯ä¸¤ä¸ªç‰¹æ®Šçš„å…³é”®å­—ï¼Œç”¨äºå¼•ç”¨åœ¨è§¦å‘å™¨ä¸­å—åˆ°ä¿®æ”¹çš„è¡Œçš„æ–°å€¼å’Œæ—§å€¼ã€‚å…·ä½“è€Œè¨€ï¼š</p>
<ul>
<li><code>NEW</code>ï¼šåœ¨è§¦å‘ INSERT æˆ– UPDATE æ“ä½œæœŸé—´ï¼ŒNEW ç”¨äºå¼•ç”¨å°†è¦æ’å…¥æˆ–æ›´æ–°åˆ°è¡¨ä¸­çš„æ–°è¡Œçš„å€¼ã€‚</li>
<li><code>OLD</code>ï¼šåœ¨è§¦å‘ UPDATE æˆ– DELETE æ“ä½œæœŸé—´ï¼ŒOLD ç”¨äºå¼•ç”¨æ›´æ–°æˆ–åˆ é™¤ä¹‹å‰åœ¨è¡¨ä¸­çš„æ—§è¡Œçš„å€¼ã€‚</li>
</ul>
<p>é€šä¿—çš„è®²ï¼ŒNEW æ˜¯æŒ‡è§¦å‘å™¨æ‰§è¡Œçš„æ“ä½œæ‰€è¦æ’å…¥æˆ–æ›´æ–°åˆ°å½“å‰è¡Œä¸­çš„æ–°æ•°æ®ï¼›è€Œ OLD åˆ™æ˜¯æŒ‡å½“å‰è¡Œåœ¨è§¦å‘å™¨æ‰§è¡Œå‰åŸæœ¬çš„æ•°æ®ã€‚</p>
<p>åœ¨MySQL è§¦å‘å™¨ä¸­ï¼ŒNEW å’Œ OLD ä½¿ç”¨æ–¹æ³•æ˜¯ç›¸ä¼¼çš„ã€‚åœ¨è§¦å‘å™¨ä¸­ï¼Œå¯ä»¥åƒå¼•ç”¨è¡¨çš„å…¶ä»–åˆ—ä¸€æ ·å¼•ç”¨ NEW å’Œ OLDã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ OLD.column_name ä»æ—§è¡Œä¸­å¼•ç”¨åˆ—å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ NEW.column_name ä»æ–°è¡Œä¸­å¼•ç”¨åˆ—å€¼ã€‚</p>
<blockquote>
<p>ç¤ºä¾‹</p>
</blockquote>
<p>å‡è®¾æœ‰ä¸€ä¸ªåä¸º my_table çš„è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º quantity çš„åˆ—ã€‚å½“åœ¨è¯¥è¡¨ä¸Šæ‰§è¡Œ UPDATE æ“ä½œæ—¶ï¼Œä»¥ä¸‹è§¦å‘å™¨ä¼šå°†æ—§å€¼ OLD.quantity ç´¯åŠ åˆ°æ–°å€¼ NEW.quantity ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TRIGGER my_trigger</span><br><span class="line">BEFORE UPDATE ON my_table</span><br><span class="line">FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">SET NEW.quantity = NEW.quantity + OLD.quantity;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤è§¦å‘å™¨ä¸­ï¼ŒOLD.quantity å¼•ç”¨åŸå§‹è¡Œçš„ quantity å€¼ï¼ˆæ—§å€¼ï¼‰ï¼Œè€Œ NEW.quantity å¼•ç”¨æ›´æ–°è¡Œçš„ quantity å€¼ï¼ˆæ–°å€¼ï¼‰ã€‚åœ¨è§¦å‘å™¨æ‰§è¡ŒæœŸé—´ï¼Œæ•°æ®è¡Œçš„ quantity å€¼å°†è®¾ç½®ä¸ºæ—§å€¼åŠ ä¸Šæ–°å€¼ã€‚</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ NEW å’Œ OLD æ—¶ï¼Œéœ€è¦æ ¹æ® DML æ“ä½œçš„ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œä»¥ç¡®å®šå“ªä¸ªå…³é”®å­—è¡¨ç¤ºæ–°å€¼ï¼Œå“ªä¸ªå…³é”®å­—åˆ™è¡¨ç¤ºæ—§å€¼ã€‚</strong></p>
<blockquote>
<p>æ¡ˆä¾‹ï¼šå½“æˆ‘ä»¬å¯¹deptè¡¨ä¸­çš„æ•°æ®è¿›è¡Œinsertã€deleteã€updateçš„æ—¶å€™ï¼Œè¯·å°†è¿™äº›æ“ä½œè®°å½•åˆ°æ—¥å¿—è¡¨å½“ä¸­</p>
</blockquote>
<p>æ—¥å¿—è¡¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> oper_log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> oper_log(</span><br><span class="line">  id <span class="type">bigint</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  table_name <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œçš„å“ªå¼ è¡¨&#x27;</span>,</span><br><span class="line">  oper_type <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œç±»å‹åŒ…æ‹¬insert delete update&#x27;</span>,</span><br><span class="line">  oper_time datetime <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œæ—¶é—´&#x27;</span>,</span><br><span class="line">  oper_id <span class="type">bigint</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œçš„é‚£è¡Œè®°å½•çš„id&#x27;</span>,</span><br><span class="line">  oper_desc text comment <span class="string">&#x27;æ“ä½œæè¿°&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è§¦å‘å™¨1ï¼šå‘deptè¡¨ä¸­æ’å…¥æ•°æ®æ—¶ï¼Œè®°å½•æ—¥å¿—</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create trigger dept_trigger_insert</span><br><span class="line">after insert on dept</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	insert into oper_log(id,table_name,oper_type,oper_time,oper_id,oper_desc) values</span><br><span class="line">(null,&#x27;dept&#x27;,&#x27;insert&#x27;,now(),new.deptno,concat(&#x27;æ’å…¥æ•°æ®ï¼šdeptno=&#x27;, new.deptno, &#x27;,dname=&#x27;, new.dname,&#x27;,loc=&#x27;, new.loc));</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹è§¦å‘å™¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show triggers;</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤è§¦å‘å™¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> if <span class="keyword">exists</span> dept_trigger_insert;</span><br></pre></td></tr></table></figure>

<p>å‘deptè¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%90%91dept%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95.png" alt="å‘deptè¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•"></p>
<p>æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡è®°å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%97%A5%E5%BF%97%E8%A1%A8%E4%B8%AD%E5%A4%9A%E4%BA%86%E4%B8%80%E6%9D%A1%E6%96%B0%E5%A2%9E%E8%AE%B0%E5%BD%95.png" alt="æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡æ–°å¢è®°å½•"></p>
<blockquote>
<p>è§¦å‘å™¨2ï¼šä¿®æ”¹deptè¡¨ä¸­æ•°æ®æ—¶ï¼Œè®°å½•æ—¥å¿—</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create trigger dept_trigger_update</span><br><span class="line">after update on dept</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	insert into oper_log(id,table_name,oper_type,oper_time,oper_id,oper_desc) values</span><br><span class="line">(null,&#x27;dept&#x27;,&#x27;update&#x27;,now(),new.deptno,concat(&#x27;æ›´æ–°å‰ï¼šdeptno=&#x27;, old.deptno, &#x27;,dname=&#x27;, old.dname,&#x27;,loc=&#x27;, old.loc, </span><br><span class="line">                                              &#x27;,æ›´æ–°åï¼šdeptno=&#x27;, new.deptno, &#x27;,dname=&#x27;, new.dname,&#x27;,loc=&#x27;, new.loc));</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>æ›´æ–°ä¸€æ¡è®°å½•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> dept <span class="keyword">set</span> loc <span class="operator">=</span> <span class="string">&#x27;åŒ—äº¬&#x27;</span> <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>
<p>æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡è®°å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%97%A5%E5%BF%97%E8%A1%A8%E4%B8%AD%E5%A4%9A%E4%BA%86%E4%B8%80%E6%9D%A1%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95.png" alt="æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡ä¿®æ”¹è®°å½•"></p>
<p><font color="red"><strong>PSï¼šæ›´æ–°ä¸€æ¡è®°å½•åˆ™å¯¹åº”ä¸€æ¡æ—¥å¿—ã€‚å¦‚æœä¸€æ¬¡æ›´æ–°3æ¡è®°å½•ï¼Œé‚£ä¹ˆæ—¥å¿—è¡¨ä¸­æ’å…¥3æ¡è®°å½•ã€‚</strong></font></p>
<blockquote>
<p>è§¦å‘å™¨3ï¼šåˆ é™¤deptè¡¨ä¸­æ•°æ®æ—¶ï¼Œè®°å½•æ—¥å¿—</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create trigger dept_trigger_delete</span><br><span class="line">after delete on dept</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	insert into oper_log(id,table_name,oper_type,oper_time,oper_id,oper_desc) values</span><br><span class="line">(null,&#x27;dept&#x27;,&#x27;delete&#x27;,now(),old.deptno,concat(&#x27;åˆ é™¤äº†æ•°æ®ï¼šdeptno=&#x27;, old.deptno, &#x27;,dname=&#x27;, old.dname,&#x27;,loc=&#x27;, old.loc));</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤ä¸€æ¡è®°å½•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡è®°å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%97%A5%E5%BF%97%E8%A1%A8%E4%B8%AD%E5%A4%9A%E4%BA%86%E4%B8%80%E6%9D%A1%E5%88%A0%E9%99%A4%E8%AE%B0%E5%BD%95.png" alt="æ—¥å¿—è¡¨ä¸­å¤šäº†ä¸€æ¡åˆ é™¤è®°å½•"></p>
]]></content>
      <categories>
        <category>DB</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬2ç« ã€‘ å­˜å‚¨å¼•æ“</title>
    <url>/posts/MySQL-Advanced-Chapter-Two-Storage-Engine/</url>
    <content><![CDATA[<h1 id="1-å­˜å‚¨å¼•æ“æ¦‚è¿°"><a href="#1-å­˜å‚¨å¼•æ“æ¦‚è¿°" class="headerlink" title="1. å­˜å‚¨å¼•æ“æ¦‚è¿°"></a>1. å­˜å‚¨å¼•æ“æ¦‚è¿°</h1><p>MySQLå­˜å‚¨å¼•æ“å†³å®šäº†æ•°æ®åœ¨ç£ç›˜ä¸Šçš„å­˜å‚¨æ–¹å¼å’Œè®¿é—®æ–¹å¼ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“å®ç°äº†ä¸åŒçš„å­˜å‚¨å’Œæ£€ç´¢ç®—æ³•ï¼Œå› æ­¤å®ƒä»¬åœ¨å¤„ç†å’Œç®¡ç†æ•°æ®çš„æ–¹å¼ä¸Šå­˜åœ¨å·®å¼‚ã€‚</p>
<p>MySQLå¸¸è§çš„å­˜å‚¨å¼•æ“åŒ…æ‹¬InnoDBã€MyISAMã€Memoryã€Archiveç­‰ã€‚æ¯ä¸ªå­˜å‚¨å¼•æ“éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>InnoDBå¼•æ“æ”¯æŒäº‹åŠ¡å’Œè¡Œçº§é”å®šï¼Œé€‚ç”¨äºéœ€è¦é«˜å¹¶å‘è¯»å†™çš„åº”ç”¨</li>
<li>MyISAMå¼•æ“ä¸æ”¯æŒäº‹åŠ¡ï¼Œä½†é€‚ç”¨äºè¯»æ“ä½œè¾ƒå¤šçš„åº”ç”¨</li>
<li>Memoryå¼•æ“æ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€‚ç”¨äºå¯¹è¯»å†™é€Ÿåº¦è¦æ±‚å¾ˆé«˜çš„åº”ç”¨ç­‰ç­‰</li>
</ul>
<p>é€‰æ‹©é€‚åˆçš„å­˜å‚¨å¼•æ“å¯ä»¥æé«˜MySQLçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œå¹¶ä¸”æ ¹æ®åº”ç”¨éœ€æ±‚æ¥åˆç†é€‰æ‹©å­˜å‚¨å¼•æ“å¯ä»¥æä¾›æ›´å¥½çš„æ•°æ®ç®¡ç†å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<h1 id="2-MySQLæ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“"><a href="#2-MySQLæ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“" class="headerlink" title="2. MySQLæ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“"></a>2. MySQLæ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“</h1><p>ä½¿ç”¨ <code>show engines \G;</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„å­˜å‚¨å¼•æ“ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">*************************** <span class="number">1.</span> row ***************************</span><br><span class="line">      Engine: MEMORY</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Hash based, stored in memory, useful <span class="keyword">for</span> temporary tables</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">2.</span> row ***************************</span><br><span class="line">      Engine: MRG_MYISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Collection of identical MyISAM tables</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">3.</span> row ***************************</span><br><span class="line">      Engine: CSV</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: CSV storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">4.</span> row ***************************</span><br><span class="line">      Engine: FEDERATED</span><br><span class="line">     Support: NO</span><br><span class="line">     Comment: Federated MySQL storage engine</span><br><span class="line">Transactions: NULL</span><br><span class="line">          XA: NULL</span><br><span class="line">  Savepoints: NULL</span><br><span class="line">*************************** <span class="number">5.</span> row ***************************</span><br><span class="line">      Engine: PERFORMANCE_SCHEMA</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Performance Schema</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">6.</span> row ***************************</span><br><span class="line">      Engine: MyISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: MyISAM storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">7.</span> row ***************************</span><br><span class="line">      Engine: InnoDB</span><br><span class="line">     Support: DEFAULT</span><br><span class="line">     Comment: Supports transactions, row-level locking, and foreign keys</span><br><span class="line">Transactions: YES</span><br><span class="line">          XA: YES</span><br><span class="line">  Savepoints: YES</span><br><span class="line">*************************** <span class="number">8.</span> row ***************************</span><br><span class="line">      Engine: ndbinfo</span><br><span class="line">     Support: NO</span><br><span class="line">     Comment: MySQL Cluster system information storage engine</span><br><span class="line">Transactions: NULL</span><br><span class="line">          XA: NULL</span><br><span class="line">  Savepoints: NULL</span><br><span class="line">*************************** <span class="number">9.</span> row ***************************</span><br><span class="line">      Engine: BLACKHOLE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: /dev/<span class="literal">null</span> storage <span class="title function_">engine</span> <span class="params">(anything you write to it disappears)</span></span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">10.</span> row ***************************</span><br><span class="line">      Engine: ARCHIVE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Archive storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** <span class="number">11.</span> row ***************************</span><br><span class="line">      Engine: ndbcluster</span><br><span class="line">     Support: NO</span><br><span class="line">     Comment: Clustered, fault-tolerant tables</span><br><span class="line">Transactions: NULL</span><br><span class="line">          XA: NULL</span><br><span class="line">  Savepoints: NULL</span><br></pre></td></tr></table></figure>
<p><code>Support</code>æ˜¯<code>Yes</code>çš„è¡¨ç¤ºæ”¯æŒè¯¥å­˜å‚¨å¼•æ“ã€‚MySQLé»˜è®¤çš„å­˜å‚¨å¼•æ“æ˜¯ï¼š<code>InnoDB</code></p>
<h1 id="3-æŒ‡å®šå’Œä¿®æ”¹å­˜å‚¨å¼•æ“"><a href="#3-æŒ‡å®šå’Œä¿®æ”¹å­˜å‚¨å¼•æ“" class="headerlink" title="3. æŒ‡å®šå’Œä¿®æ”¹å­˜å‚¨å¼•æ“"></a>3. æŒ‡å®šå’Œä¿®æ”¹å­˜å‚¨å¼•æ“</h1><h2 id="3-1-æŒ‡å®šå­˜å‚¨å¼•æ“"><a href="#3-1-æŒ‡å®šå­˜å‚¨å¼•æ“" class="headerlink" title="3.1 æŒ‡å®šå­˜å‚¨å¼•æ“"></a>3.1 æŒ‡å®šå­˜å‚¨å¼•æ“</h2><p>åœ¨MySQLä¸­ï¼Œä½ å¯ä»¥åœ¨åˆ›å»ºè¡¨æ—¶æŒ‡å®šä½¿ç”¨çš„å­˜å‚¨å¼•æ“ã€‚é€šè¿‡åœ¨<code>CREATE TABLE</code>è¯­å¥ä¸­ä½¿ç”¨<code>ENGINE</code>å…³é”®å­—ï¼Œä½ å¯ä»¥æŒ‡å®šè¦ä½¿ç”¨çš„å­˜å‚¨å¼•æ“ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æŒ‡å®šå­˜å‚¨å¼•æ“çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table (column1 <span class="type">INT</span>, column2 <span class="type">VARCHAR</span>(<span class="number">50</span>)) ENGINE <span class="operator">=</span> InnoDB;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºmy_tableçš„è¡¨ï¼Œå¹¶æŒ‡å®šäº†ä½¿ç”¨<code>InnoDB</code>å­˜å‚¨å¼•æ“ã€‚</p>
<p>å¦‚æœä½ ä¸æ˜¾å¼æŒ‡å®šå­˜å‚¨å¼•æ“ï¼ŒMySQLå°†ä½¿ç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL 8çš„é»˜è®¤å­˜å‚¨å¼•æ“æ˜¯InnoDBã€‚</p>
<h2 id="3-2-ä¿®æ”¹å­˜å‚¨å¼•æ“"><a href="#3-2-ä¿®æ”¹å­˜å‚¨å¼•æ“" class="headerlink" title="3.2 ä¿®æ”¹å­˜å‚¨å¼•æ“"></a>3.2 ä¿®æ”¹å­˜å‚¨å¼•æ“</h2><p>åœ¨MySQLä¸­ï¼Œä½ å¯ä»¥é€šè¿‡<code>ALTER TABLE</code>è¯­å¥ä¿®æ”¹è¡¨çš„å­˜å‚¨å¼•æ“ã€‚ä¸‹é¢æ˜¯ä¿®æ”¹å­˜å‚¨å¼•æ“çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table ENGINE <span class="operator">=</span> MyISAM;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>ALTER TABLE</code>è¯­å¥å°†my_tableè¡¨çš„å­˜å‚¨å¼•æ“ä¿®æ”¹ä¸º<code>MyISAM</code>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨ä¿®æ”¹å­˜å‚¨å¼•æ“ä¹‹å‰ï¼Œä½ éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>ä¿®æ”¹å­˜å‚¨å¼•æ“å¯èƒ½éœ€è¦æ‰§è¡Œå¤åˆ¶è¡¨çš„æ“ä½œï¼Œå› æ­¤å¯èƒ½ä¼šé€ æˆæ•°æ®çš„ä¸¢å¤±æˆ–ä¸å¯ç”¨ã€‚ç¡®ä¿åœ¨æ‰§è¡Œä¿®æ”¹ä¹‹å‰å¤‡ä»½ä½ çš„æ•°æ®</li>
<li>ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒç›¸åŒçš„åŠŸèƒ½ã€‚è¦ç¡®ä¿ä½ é€‰æ‹©çš„æ–°å­˜å‚¨å¼•æ“æ”¯æŒä½ åº”ç”¨ç¨‹åºæ‰€éœ€çš„åŠŸèƒ½</li>
<li>ä¿®æ”¹è¡¨çš„å­˜å‚¨å¼•æ“å¯èƒ½ä¼šå½±å“åˆ°ç°æœ‰çš„åº”ç”¨ç¨‹åºå’ŒæŸ¥è¯¢ã€‚ç¡®ä¿åœ¨ä¿®æ”¹ä¹‹å‰è¯„ä¼°å’Œæµ‹è¯•æ‰€æœ‰çš„å½±å“</li>
<li>ALTER TABLEè¯­å¥å¯èƒ½éœ€è¦é€‚å½“çš„æƒé™æ‰èƒ½æ‰§è¡Œã€‚ç¡®ä¿ä½ æ‹¥æœ‰è¶³å¤Ÿçš„æƒé™æ¥æ‰§è¡Œä¿®æ”¹å­˜å‚¨å¼•æ“çš„æ“ä½œ</li>
</ul>
<p>æ€»è€Œè¨€ä¹‹ï¼Œä¿®æ”¹å­˜å‚¨å¼•æ“éœ€è¦è°¨æ…è¿›è¡Œï¼Œä¸”éœ€è¦è€ƒè™‘åˆ°å¯èƒ½çš„å½±å“å’Œé£é™©ã€‚å»ºè®®åœ¨è¿›è¡Œä¿®æ”¹ä¹‹å‰è¿›è¡Œé€‚å½“çš„æµ‹è¯•å’Œå¤‡ä»½ã€‚</p>
<h1 id="4-å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åŠé€‚ç”¨åœºæ™¯"><a href="#4-å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åŠé€‚ç”¨åœºæ™¯" class="headerlink" title="4. å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åŠé€‚ç”¨åœºæ™¯"></a>4. å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åŠé€‚ç”¨åœºæ™¯</h1><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œä»¥ä¸‹å­˜å‚¨å¼•æ“æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼š</p>
<p><strong>InnoDBï¼š</strong></p>
<ul>
<li>MySQLé»˜è®¤çš„äº‹åŠ¡å‹å­˜å‚¨å¼•æ“</li>
<li>æ”¯æŒACIDäº‹åŠ¡</li>
<li>å…·æœ‰è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½å’Œæ•°æ®å®Œæ•´æ€§</li>
<li>æ”¯æŒè¡Œçº§é”å®šã€‚</li>
<li>é€‚ç”¨äºå¤§å¤šæ•°åº”ç”¨åœºæ™¯ï¼Œå°¤å…¶æ˜¯éœ€è¦äº‹åŠ¡æ”¯æŒçš„åº”ç”¨ã€‚</li>
</ul>
<p><strong>MyISAMï¼š</strong></p>
<ul>
<li>æ˜¯MySQLæ—©æœŸç‰ˆæœ¬ä¸­å¸¸ç”¨çš„å­˜å‚¨å¼•æ“</li>
<li>æ”¯æŒå…¨æ–‡ç´¢å¼•å’Œè¡¨çº§é”å®š</li>
<li>ä¸æ”¯æŒäº‹åŠ¡</li>
<li>ç”±äºå…¶ç®€å•æ€§å’Œé«˜æ€§èƒ½ï¼Œåœ¨æŸäº›ç‰¹å®šçš„åº”ç”¨åœºæ™¯ä¸­ä¼šå¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œå¦‚<strong>è¯»å¯†é›†</strong>çš„åº”ç”¨ã€‚</li>
</ul>
<p><strong>MEMORYï¼š</strong></p>
<ul>
<li>ç§°ä¸ºHEAPï¼Œæ˜¯å°†è¡¨å­˜å‚¨åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¼•æ“</li>
<li>å…·æœ‰éå¸¸é«˜çš„è¯»å†™æ€§èƒ½ï¼Œä½†æ•°æ®ä¼šåœ¨æœåŠ¡å™¨é‡å¯æ—¶ä¸¢å¤±ã€‚</li>
<li>é€‚ç”¨äºéœ€è¦å¿«é€Ÿè¯»å†™çš„ä¸´æ—¶æ•°æ®é›†ã€ç¼“å­˜å’Œä¸´æ—¶è¡¨ç­‰åœºæ™¯ã€‚</li>
</ul>
<p><strong>CSVï¼š</strong></p>
<ul>
<li>å°†æ•°æ®ä»¥çº¯æ–‡æœ¬æ ¼å¼å­˜å‚¨çš„å­˜å‚¨å¼•æ“</li>
<li>é€‚ç”¨äºéœ€è¦å¤„ç†å’Œå¯¼å…¥&#x2F;å¯¼å‡ºCSVæ ¼å¼æ•°æ®çš„åœºæ™¯ã€‚</li>
</ul>
<p><strong>ARCHIVEï¼š</strong></p>
<ul>
<li>å°†æ•°æ®é«˜æ•ˆåœ°è¿›è¡Œå‹ç¼©å’Œå­˜å‚¨çš„å­˜å‚¨å¼•æ“</li>
<li>é€‚ç”¨äºéœ€è¦é•¿æœŸå­˜å‚¨å¤§é‡å†å²æ•°æ®ä¸”ä¸ç»å¸¸æŸ¥è¯¢çš„åœºæ™¯ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>DB</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬4ç« ã€‘ MySQLä¼˜åŒ–</title>
    <url>/posts/MySQL-Advanced-Chapter-Four-SQL-Optimize/</url>
    <content><![CDATA[<h1 id="1-MySQLä¼˜åŒ–æ‰‹æ®µ"><a href="#1-MySQLä¼˜åŒ–æ‰‹æ®µ" class="headerlink" title="1. MySQLä¼˜åŒ–æ‰‹æ®µ"></a>1. MySQLä¼˜åŒ–æ‰‹æ®µ</h1><p>MySQLæ•°æ®åº“çš„ä¼˜åŒ–æ‰‹æ®µé€šå¸¸åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>SQLæŸ¥è¯¢ä¼˜åŒ–ï¼šè¿™æ˜¯æœ€ä½æˆæœ¬çš„ä¼˜åŒ–æ‰‹æ®µï¼Œé€šè¿‡ä¼˜åŒ–æŸ¥è¯¢è¯­å¥ã€é€‚å½“æ·»åŠ ç´¢å¼•ç­‰æ–¹å¼è¿›è¡Œã€‚å¹¶ä¸”æ•ˆæœæ˜¾è‘—ã€‚</li>
<li>åº“è¡¨ç»“æ„ä¼˜åŒ–ï¼šé€šè¿‡è§„èŒƒåŒ–è®¾è®¡ã€ä¼˜åŒ–ç´¢å¼•å’Œæ•°æ®ç±»å‹ç­‰æ–¹å¼è¿›è¡Œåº“è¡¨ç»“æ„ä¼˜åŒ–ï¼Œéœ€è¦å¯¹æ•°æ®åº“ç»“æ„è¿›è¡Œè°ƒæ•´å’Œæ”¹è¿›</li>
<li>ç³»ç»Ÿé…ç½®ä¼˜åŒ–ï¼šæ ¹æ®ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„ç‰¹ç‚¹ï¼Œè°ƒæ•´æœ€å¤§è¿æ¥æ•°ã€å†…å­˜ç®¡ç†ã€IOè°ƒåº¦ç­‰å‚æ•°</li>
<li>ç¡¬ä»¶ä¼˜åŒ–ï¼šå‡çº§ç¡¬ç›˜ã€å¢åŠ å†…å­˜å®¹é‡ã€å‡çº§å¤„ç†å™¨ç­‰ç¡¬ä»¶æ–¹é¢çš„æŠ•å…¥ï¼Œéœ€è¦è´­ä¹°å’Œæ›¿æ¢ç¡¬ä»¶è®¾å¤‡ï¼Œæˆæœ¬è¾ƒé«˜</li>
</ul>
<p>æˆ‘ä»¬ä¸»è¦æŒæ¡ï¼šSQLæŸ¥è¯¢ä¼˜åŒ–</p>
<h1 id="2-SQLæ€§èƒ½åˆ†æå·¥å…·"><a href="#2-SQLæ€§èƒ½åˆ†æå·¥å…·" class="headerlink" title="2. SQLæ€§èƒ½åˆ†æå·¥å…·"></a>2. SQLæ€§èƒ½åˆ†æå·¥å…·</h1><h2 id="2-1-æŸ¥çœ‹æ•°æ®åº“æ•´ä½“æƒ…å†µ"><a href="#2-1-æŸ¥çœ‹æ•°æ®åº“æ•´ä½“æƒ…å†µ" class="headerlink" title="2.1 æŸ¥çœ‹æ•°æ®åº“æ•´ä½“æƒ…å†µ"></a>2.1 æŸ¥çœ‹æ•°æ®åº“æ•´ä½“æƒ…å†µ</h2><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰æ•°æ®åº“åœ¨SQLè¯­å¥æ‰§è¡Œæ–¹é¢çš„æ•´ä½“æƒ…å†µï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Com_select&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Com_insert&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Com_delete&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Com_update&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Com_______&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>è¿™äº›ç»“æœåæ˜ äº†ä» MySQL æœåŠ¡å™¨å¯åŠ¨åˆ°å½“å‰æ—¶åˆ»ï¼Œæ‰€æœ‰çš„ SELECT æŸ¥è¯¢æ€»æ•°ã€‚å¯¹äº MySQL æ€§èƒ½ä¼˜åŒ–æ¥è¯´ï¼Œé€šè¿‡æŸ¥çœ‹ <code>Com_select</code> çš„å€¼å¯ä»¥äº†è§£ SELECT æŸ¥è¯¢åœ¨æ•´ä¸ª MySQL æœåŠ¡æœŸé—´æ‰€å æ¯”ä¾‹çš„æƒ…å†µï¼š</p>
<ul>
<li>å¦‚æœ <code>Com_select</code> æ¬¡æ•°è¿‡é«˜ï¼Œå¯èƒ½è¯´æ˜æŸ¥è¯¢è¡¨ä¸­çš„æ¯æ¡è®°å½•éƒ½ä¼šè¿”å›è¿‡å¤šçš„å­—æ®µã€‚</li>
<li>å¦‚æœ <code>Com_select</code> æ¬¡æ•°å¾ˆå°‘ï¼ŒåŒæ—¶insertæˆ–deleteæˆ–updateçš„æ¬¡æ•°å¾ˆé«˜ï¼Œå¯èƒ½è¯´æ˜æœåŠ¡å™¨è¿è¡Œçš„åº”ç”¨ç¨‹åºè¿‡äºä¾èµ–å†™å…¥æ“ä½œå’Œå°‘é‡è¯»å–æ“ä½œã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œé€šè¿‡æŸ¥çœ‹ <code>Com_select</code> çš„å€¼ï¼Œå¯ä»¥äº†è§£ MySQL æœåŠ¡å™¨çš„é•¿æœŸæ‰§è¡Œæƒ…å†µï¼Œå¹¶åœ¨ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½æ—¶ï¼Œå¸®åŠ©æˆ‘ä»¬äº†è§£ MySQL çš„æ€§èƒ½ç“¶é¢ˆã€‚</p>
<h2 id="2-2-æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#2-2-æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="2.2 æ…¢æŸ¥è¯¢æ—¥å¿—"></a>2.2 æ…¢æŸ¥è¯¢æ—¥å¿—</h2><p>æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶å¯ä»¥å°†æŸ¥è¯¢è¾ƒæ…¢çš„DQLè¯­å¥è®°å½•ä¸‹æ¥ï¼Œä¾¿äºæˆ‘ä»¬å®šä½éœ€è¦è°ƒä¼˜çš„selectè¯­å¥ã€‚</p>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½æ˜¯å¦å¼€å¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;slow_query_log&#x27;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+----------------+-------+</span><br><span class="line">| Variable_name  | Value |</span><br><span class="line">+----------------+-------+</span><br><span class="line">| slow_query_log | OFF   |</span><br><span class="line">+----------------+-------+</span><br></pre></td></tr></table></figure>

<p>æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½é»˜è®¤æ˜¯å…³é—­çš„ã€‚è¯·ä¿®æ”¹my.iniæ–‡ä»¶æ¥å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ï¼Œåœ¨<code>my.ini</code>çš„[mysqld]åé¢æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">slow-query-log</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">long_query_time</span>=<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šslow_query_log&#x3D;1è¡¨ç¤ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ï¼Œlong_query_time&#x3D;3è¡¨ç¤ºï¼šåªè¦SELECTè¯­å¥çš„æ‰§è¡Œè€—æ—¶è¶…è¿‡3ç§’åˆ™å°†å…¶è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚</strong></p>
<p>é‡å¯mysqlæœåŠ¡ã€‚å†æ¬¡æŸ¥çœ‹æ˜¯å¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœæ­¢ mysql æœåŠ¡</span></span><br><span class="line">net stop mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨ mysql æœåŠ¡</span></span><br><span class="line">net start mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+----------------+-------+</span><br><span class="line">| Variable_name  | Value |</span><br><span class="line">+----------------+-------+</span><br><span class="line">| slow_query_log | ON    |</span><br><span class="line">+----------------+-------+</span><br></pre></td></tr></table></figure>

<p>å°è¯•æ‰§è¡Œä¸€æ¡æ—¶é•¿è¶…è¿‡3ç§’çš„selectè¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sleep(<span class="number">4</span>) <span class="keyword">from</span> emp <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;smith&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶é»˜è®¤å­˜å‚¨åœ¨ï¼šä½ mysqlå®‰è£…ç›®å½•ä¸‹çš„ Data ç›®å½•ä¸­ï¼Œé»˜è®¤çš„åå­—æ˜¯ï¼š<code>è®¡ç®—æœºå-slow.log</code></p>
<p>é€šè¿‡è¯¥æ–‡ä»¶å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°å“ªäº›DQLè¯­å¥å±äºæ…¢æŸ¥è¯¢ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9BDQL%E8%AF%AD%E5%8F%A5%E5%B1%9E%E4%BA%8E%E6%85%A2%E6%9F%A5%E8%AF%A2.png" alt="æŸ¥çœ‹å“ªäº›DQLè¯­å¥å±äºæ…¢æŸ¥è¯¢"></p>
<h2 id="2-3-show-profiles"><a href="#2-3-show-profiles" class="headerlink" title="2.3 show profiles"></a>2.3 show profiles</h2><p>é€šè¿‡<code>show profiles</code>å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªSQLè¯­å¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å…·ä½“çš„è€—æ—¶æƒ…å†µã€‚å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„å®šä½é—®é¢˜æ‰€åœ¨ã€‚</p>
<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“æ˜¯å¦æ”¯æŒ profile æ“ä½œï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@have_profiling</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+------------------+</span><br><span class="line">| @@have_profiling |</span><br><span class="line">+------------------+</span><br><span class="line">| YES              |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ profiling å¼€å…³æ˜¯å¦æ‰“å¼€ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@profiling</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+-------------+</span><br><span class="line">| @@profiling |</span><br><span class="line">+-------------+</span><br><span class="line">|           0 |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>

<p>å°† profiling å¼€å…³æ‰“å¼€ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> profiling <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+-------------+</span><br><span class="line">| @@profiling |</span><br><span class="line">+-------------+</span><br><span class="line">|           1 |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ‰§è¡Œå¤šæ¡DQLè¯­å¥ï¼Œç„¶åä½¿ç”¨ <code>show profiles;</code> æ¥æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­æ‰§è¡Œè¿‡çš„æ¯ä¸ªSELECTè¯­å¥çš„è€—æ—¶æƒ…å†µã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> empno,ename <span class="keyword">from</span> emp <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7369</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">show</span> profiles;</span><br></pre></td></tr></table></figure>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%AF%8F%E4%B8%AASELECT%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%80%97%E6%97%B6%E6%83%85%E5%86%B5.png" alt="æ¯ä¸ªSELECTè¯­å¥çš„è€—æ—¶æƒ…å†µ" style="zoom:67%;">

<p>æŸ¥çœ‹æŸä¸ªSQLè¯­å¥è¯­å¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> profile <span class="keyword">for</span> query <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%90%E4%B8%AASQL%E8%AF%AD%E5%8F%A5%E8%AF%AD%E5%8F%A5%E5%9C%A8%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%AF%8F%E4%B8%AA%E9%98%B6%E6%AE%B5%E7%9A%84%E8%80%97%E6%97%B6%E6%83%85%E5%86%B5.png" alt="æŸä¸ªSQLè¯­å¥è¯­å¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ¯ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µ" style="zoom: 67%;">

<p>æƒ³æŸ¥çœ‹æ‰§è¡Œè¿‡ç¨‹ä¸­cpuçš„æƒ…å†µï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> profile cpu <span class="keyword">for</span> query <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E4%B8%ADcpu%E7%9A%84%E6%83%85%E5%86%B5.png" alt="æ‰§è¡Œè¿‡ç¨‹ä¸­cpuçš„æƒ…å†µ" style="zoom:67%;">

<h2 id="2-4-explain"><a href="#2-4-explain" class="headerlink" title="2.4 explain"></a>2.4 explain</h2><p>explainå‘½ä»¤å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªDQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œæ ¹æ®æ‰§è¡Œè®¡åˆ’å¯ä»¥åšå‡ºç›¸åº”çš„ä¼˜åŒ–æªæ–½ã€‚æé«˜æ‰§è¡Œæ•ˆç‡ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7369</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/DQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92.png" alt="DQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’"></p>
<blockquote>
<p>id</p>
</blockquote>
<p>idåæ˜ å‡ºä¸€æ¡selectè¯­å¥æ‰§è¡Œé¡ºåºï¼Œidè¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ã€‚idç›¸åŒåˆ™æŒ‰ç…§è‡ªä¸Šè€Œä¸‹çš„é¡ºåºæ‰§è¡Œã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> e.ename,d.dname <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno <span class="keyword">join</span> salgrade s <span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/explain-id(1).png" alt="explain-id(1)"></p>
<p>ç”±äºidç›¸åŒï¼Œåæ˜ å‡ºä¸‰å¼ è¡¨åœ¨æ‰§è¡Œé¡ºåºä¸Šå±äºå¹³ç­‰å…³ç³»ï¼Œæ‰§è¡Œæ—¶é‡‡ç”¨ï¼Œå…ˆdï¼Œå†eï¼Œæœ€åsã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> e.ename,d.dname <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno <span class="keyword">where</span> e.sal<span class="operator">=</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;ford&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/explain-id(2).png" alt="explain-id(2)"></p>
<p>åæ˜ å‡ºï¼Œå…ˆæ‰§è¡Œå­æŸ¥è¯¢ï¼Œç„¶åè®©eå’Œdåšè¡¨è¿æ¥ã€‚</p>
<blockquote>
<p>select_type</p>
</blockquote>
<p>åæ˜ äº†mysqlæŸ¥è¯¢è¯­å¥çš„ç±»å‹ã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>SIMPLE</code>ï¼šè¡¨ç¤ºæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–UNIONæ“ä½œã€‚è¿™ç§æŸ¥è¯¢é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªè¡¨æˆ–æ˜¯æœ€å¤šä¸€ä¸ªè”æ¥ï¼ˆJOINï¼‰</li>
<li><code>PRIMARY</code>ï¼šè¡¨ç¤ºå½“å‰æŸ¥è¯¢æ˜¯ä¸€ä¸ªä¸»æŸ¥è¯¢ã€‚ï¼ˆä¸»è¦çš„æŸ¥è¯¢ï¼‰</li>
<li><code>UNION</code>ï¼šè¡¨ç¤ºæŸ¥è¯¢ä¸­åŒ…å«UNIONæ“ä½œ</li>
<li><code>SUBQUERY</code>ï¼šå­æŸ¥è¯¢</li>
<li><code>DERIVED</code>ï¼šæ´¾ç”Ÿè¡¨ï¼ˆè¡¨ç¤ºæŸ¥è¯¢è¯­å¥å‡ºç°åœ¨fromåé¢ï¼‰</li>
</ul>
<blockquote>
<p>table</p>
</blockquote>
<p>åæ˜ äº†è¿™ä¸ªæŸ¥è¯¢æ“ä½œçš„æ˜¯å“ªä¸ªè¡¨ã€‚</p>
<blockquote>
<p>type</p>
</blockquote>
<p>åæ˜ äº†æŸ¥è¯¢è¡¨ä¸­æ•°æ®æ—¶çš„è®¿é—®ç±»å‹ï¼Œå¸¸è§çš„å€¼ï¼š</p>
<ul>
<li><code>NULL</code>ï¼šæ•ˆç‡æœ€é«˜ï¼Œä¸€èˆ¬ä¸å¯èƒ½ä¼˜åŒ–åˆ°è¿™ä¸ªçº§åˆ«ï¼Œåªæœ‰æŸ¥è¯¢æ—¶æ²¡æœ‰æŸ¥è¯¢è¡¨çš„æ—¶å€™ï¼Œè®¿é—®ç±»å‹æ˜¯NULLã€‚ä¾‹å¦‚ï¼šselect 1;</li>
<li><code>system</code>ï¼šé€šå¸¸è®¿é—®ç³»ç»Ÿè¡¨çš„æ—¶å€™ï¼Œè®¿é—®ç±»å‹æ˜¯systemã€‚ä¸€èˆ¬ä¹Ÿå¾ˆéš¾ä¼˜åŒ–åˆ°è¿™ä¸ªç¨‹åºã€‚</li>
<li><code>const</code>ï¼šæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€æ€§ç´¢å¼•æŸ¥è¯¢ï¼Œç´¢å¼•å€¼æ˜¯å¸¸é‡å€¼æ—¶ã€‚explain select * from emp where empno&#x3D;7369;</li>
<li><code>eq_ref</code>ï¼šæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€æ€§ç´¢å¼•æŸ¥è¯¢ã€‚ç´¢å¼•å€¼ä¸æ˜¯å¸¸é‡å€¼ã€‚</li>
<li><code>ref</code>ï¼šä½¿ç”¨äº†éå”¯ä¸€çš„ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ã€‚</li>
<li><code>range</code>ï¼šä½¿ç”¨äº†ç´¢å¼•ï¼Œæ‰«æäº†ç´¢å¼•æ ‘çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><code>index</code>ï¼šè¡¨ç¤ºç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦éå†æ•´ä¸ªç´¢å¼•æ ‘ã€‚</li>
<li><code>all</code>ï¼šå…¨è¡¨æ‰«æ</li>
</ul>
<p>æ•ˆç‡æœ€é«˜çš„æ˜¯<code>NULL</code>ï¼Œæ•ˆç‡æœ€ä½çš„æ˜¯<code>all</code>ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œä»é«˜åˆ°ä½ã€‚</p>
<blockquote>
<p>possible_keys</p>
</blockquote>
<p>è¿™ä¸ªæŸ¥è¯¢å¯èƒ½ä¼šç”¨åˆ°çš„ç´¢å¼•</p>
<blockquote>
<p>key</p>
</blockquote>
<p>å®é™…ç”¨åˆ°çš„ç´¢å¼•</p>
<blockquote>
<p>key_len</p>
</blockquote>
<p>åæ˜ ç´¢å¼•ä¸­åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨çš„åˆ—æ‰€å çš„æ€»å­—èŠ‚æ•°ã€‚</p>
<blockquote>
<p>rows</p>
</blockquote>
<p>æŸ¥è¯¢æ‰«æçš„é¢„ä¼°è®¡è¡Œæ•°ã€‚</p>
<blockquote>
<p>Extra</p>
</blockquote>
<p>ç»™å‡ºäº†ä¸æŸ¥è¯¢ç›¸å…³çš„é¢å¤–ä¿¡æ¯å’Œè¯´æ˜ã€‚è¿™äº›é¢å¤–ä¿¡æ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£æŸ¥è¯¢æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</p>
<h1 id="3-ç´¢å¼•ä¼˜åŒ–"><a href="#3-ç´¢å¼•ä¼˜åŒ–" class="headerlink" title="3. ç´¢å¼•ä¼˜åŒ–"></a>3. ç´¢å¼•ä¼˜åŒ–</h1><h2 id="3-1-åŠ ç´¢å¼•-vs-ä¸åŠ ç´¢å¼•"><a href="#3-1-åŠ ç´¢å¼•-vs-ä¸åŠ ç´¢å¼•" class="headerlink" title="3.1 åŠ ç´¢å¼• vs ä¸åŠ ç´¢å¼•"></a>3.1 åŠ ç´¢å¼• vs ä¸åŠ ç´¢å¼•</h2><p>å°†è¿™ä¸ªsqlè„šæœ¬åˆå§‹åŒ–åˆ°æ•°æ®åº“ä¸­ï¼ˆåˆå§‹åŒ–100Wæ¡è®°å½•ï¼‰ï¼št_vip.sql</p>
<p>æ ¹æ®idæŸ¥è¯¢ï¼ˆidæ˜¯ä¸»é”®ï¼Œæœ‰ç´¢å¼•ï¼‰ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_vip <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">900000</span>;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®nameæŸ¥è¯¢ï¼ˆnameä¸Šæ²¡æœ‰ç´¢å¼•ï¼‰ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_vip <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;4c6494cb&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>ç»™nameå­—æ®µæ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_t_user_name <span class="keyword">on</span> t_vip(name);</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æ ¹æ®nameæŸ¥è¯¢ï¼ˆæ­¤æ—¶nameä¸Šå·²ç»æœ‰ç´¢å¼•äº†ï¼‰ ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_vip <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;4c6494cb&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-æœ€å·¦å‰ç¼€åŸåˆ™"><a href="#3-2-æœ€å·¦å‰ç¼€åŸåˆ™" class="headerlink" title="3.2 æœ€å·¦å‰ç¼€åŸåˆ™"></a>3.2 æœ€å·¦å‰ç¼€åŸåˆ™</h2><p>å‡è®¾æœ‰è¿™æ ·ä¸€å¼ è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_customer(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	age <span class="type">int</span>,</span><br><span class="line">	gender <span class="type">char</span>(<span class="number">1</span>),</span><br><span class="line">	email <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ äº†è¿™äº›æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_customer <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;zhangsan&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;zhangsan@123.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_customer <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;lisi&#x27;</span>, <span class="number">22</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;lisi@123.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_customer <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;wangwu&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;wangwu@123.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_customer <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;zhaoliu&#x27;</span>, <span class="number">22</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;zhaoliu@123.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_customer <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;jack&#x27;</span>, <span class="number">30</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;jack@123.com&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ äº†è¿™æ ·çš„å¤åˆç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name_age_gender <span class="keyword">on</span> t_customer(name,age,gender);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>æœ€å·¦å‰ç¼€åŸåˆ™ï¼šå½“æŸ¥è¯¢è¯­å¥æ¡ä»¶ä¸­åŒ…å«äº†è¿™ä¸ªå¤åˆç´¢å¼•æœ€å·¦è¾¹çš„åˆ— name æ—¶ï¼Œæ­¤æ—¶ç´¢å¼•æ‰ä¼šèµ·ä½œç”¨</strong></p>
</blockquote>
<p>éªŒè¯1ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> age<span class="operator">=</span><span class="number">20</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šå®Œå…¨ä½¿ç”¨äº†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%811.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯1"></p>
<p>éªŒè¯2ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> age<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä½¿ç”¨äº†éƒ¨åˆ†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%812.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯2"></p>
<p>éªŒè¯3ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä½¿ç”¨äº†éƒ¨åˆ†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%813.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯3"></p>
<p>éªŒè¯4ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> age<span class="operator">=</span><span class="number">20</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span> <span class="keyword">and</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šå®Œå…¨ä½¿ç”¨äº†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%814.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯4"></p>
<p>éªŒè¯5ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span> <span class="keyword">and</span> age<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šæ²¡æœ‰ä½¿ç”¨ä»»ä½•ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%815.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯5"></p>
<p>éªŒè¯6ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä½¿ç”¨äº†éƒ¨åˆ†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%816.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯6"></p>
<p>éªŒè¯7ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span> <span class="keyword">and</span> age<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šå®Œå…¨ä½¿ç”¨äº†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99-%E9%AA%8C%E8%AF%817.png" alt="æœ€å·¦å‰ç¼€åŸåˆ™-éªŒè¯7"></p>
<blockquote>
<p><strong>èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œåœ¨â€œèŒƒå›´æ¡ä»¶â€å³ä¾§çš„åˆ—ç´¢å¼•ä¼šå¤±æ•ˆ</strong></p>
</blockquote>
<p>éªŒè¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> age<span class="operator">&gt;</span><span class="number">20</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šnameå’Œageåˆ—ç´¢å¼•ç”Ÿæ•ˆã€‚genderåˆ—ç´¢å¼•æ— æ•ˆã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2%E6%97%B6%E5%9C%A8%E8%8C%83%E5%9B%B4%E6%9D%A1%E4%BB%B6%E5%8F%B3%E4%BE%A7%E7%9A%84%E5%88%97%E7%B4%A2%E5%BC%95%E4%BC%9A%E5%A4%B1%E6%95%88.png" alt="èŒƒå›´æŸ¥è¯¢æ—¶åœ¨èŒƒå›´æ¡ä»¶å³ä¾§çš„åˆ—ç´¢å¼•ä¼šå¤±æ•ˆ"></p>
<p>æ€ä¹ˆè§£å†³ï¼Ÿå»ºè®®èŒƒå›´æŸ¥æ‰¾æ—¶å¸¦ä¸Š<code>=</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span> <span class="keyword">and</span> age<span class="operator">&gt;=</span><span class="number">20</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="string">&#x27;M&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E8%A7%A3%E5%86%B3%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2%E6%97%B6%E5%9C%A8%E8%8C%83%E5%9B%B4%E6%9D%A1%E4%BB%B6%E5%8F%B3%E4%BE%A7%E7%9A%84%E5%88%97%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88.png" alt="è§£å†³èŒƒå›´æŸ¥è¯¢æ—¶åœ¨èŒƒå›´æ¡ä»¶å³ä¾§çš„åˆ—ç´¢å¼•å¤±æ•ˆ"></p>
<h2 id="3-3-ç´¢å¼•å¤±æ•ˆæƒ…å†µ"><a href="#3-3-ç´¢å¼•å¤±æ•ˆæƒ…å†µ" class="headerlink" title="3.3 ç´¢å¼•å¤±æ•ˆæƒ…å†µ"></a>3.3 ç´¢å¼•å¤±æ•ˆæƒ…å†µ</h2><p>æœ‰è¿™æ ·ä¸€å¼ è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_emp(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  sal <span class="type">int</span>,</span><br><span class="line">  age <span class="type">char</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>æœ‰è¿™æ ·ä¸€äº›æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_emp <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="number">5000</span>,<span class="string">&#x27;20&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_emp <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;å¼ é£&#x27;</span>, <span class="number">4000</span>,<span class="string">&#x27;30&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_emp <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;æé£&#x27;</span>, <span class="number">6000</span>,<span class="string">&#x27;40&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>æœ‰è¿™æ ·ä¸€äº›ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_t_emp_name <span class="keyword">on</span> t_emp(name);</span><br><span class="line"><span class="keyword">create</span> index idx_t_emp_sal <span class="keyword">on</span> t_emp(sal);</span><br><span class="line"><span class="keyword">create</span> index idx_t_emp_age <span class="keyword">on</span> t_emp(age);</span><br></pre></td></tr></table></figure>

<h3 id="3-3-1-ç´¢å¼•åˆ—å‚åŠ äº†è¿ç®—ï¼Œç´¢å¼•å¤±æ•ˆ"><a href="#3-3-1-ç´¢å¼•åˆ—å‚åŠ äº†è¿ç®—ï¼Œç´¢å¼•å¤±æ•ˆ" class="headerlink" title="3.3.1 ç´¢å¼•åˆ—å‚åŠ äº†è¿ç®—ï¼Œç´¢å¼•å¤±æ•ˆ"></a>3.3.1 ç´¢å¼•åˆ—å‚åŠ äº†è¿ç®—ï¼Œç´¢å¼•å¤±æ•ˆ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä½¿ç”¨äº†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E6%9C%AA%E5%8F%82%E5%8A%A0%E8%BF%90%E7%AE%97%EF%BC%8C%E7%B4%A2%E5%BC%95%E7%94%9F%E6%95%88.png" alt="ç´¢å¼•åˆ—æœªå‚åŠ è¿ç®—ï¼Œç´¢å¼•ç”Ÿæ•ˆ"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> sal<span class="operator">*</span><span class="number">10</span> <span class="operator">&gt;</span> <span class="number">50000</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•å¤±æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E5%8F%82%E5%8A%A0%E4%BA%86%E8%BF%90%E7%AE%97%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88.png" alt="ç´¢å¼•åˆ—å‚åŠ äº†è¿ç®—ï¼Œç´¢å¼•å¤±æ•ˆ"></p>
<h3 id="3-3-2-ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ä»¥-å¼€å§‹çš„ï¼Œç´¢å¼•å¤±æ•ˆ"><a href="#3-3-2-ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ä»¥-å¼€å§‹çš„ï¼Œç´¢å¼•å¤±æ•ˆ" class="headerlink" title="3.3.2 ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ä»¥ % å¼€å§‹çš„ï¼Œç´¢å¼•å¤±æ•ˆ"></a>3.3.2 ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ä»¥ % å¼€å§‹çš„ï¼Œç´¢å¼•å¤±æ•ˆ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;å¼ %&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•æœ‰æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E8%BF%9B%E8%A1%8C%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E6%97%B6%E6%9C%AA%E4%BB%A5%25%E5%BC%80%E5%A7%8B%EF%BC%8C%E7%B4%A2%E5%BC%95%E7%94%9F%E6%95%88.png" alt="ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶æœªä»¥%å¼€å§‹ï¼Œç´¢å¼•ç”Ÿæ•ˆ"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%é£&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•å¤±æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E8%BF%9B%E8%A1%8C%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E6%97%B6%E4%BB%A5%25%E5%BC%80%E5%A7%8B%E7%9A%84%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88.png" alt="ç´¢å¼•åˆ—è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ä»¥%å¼€å§‹çš„ï¼Œç´¢å¼•å¤±æ•ˆ"></p>
<h3 id="3-3-3-ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†æŸ¥è¯¢æ—¶çœç•¥äº†å•å¼•å·ï¼Œç´¢å¼•å¤±æ•ˆ"><a href="#3-3-3-ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†æŸ¥è¯¢æ—¶çœç•¥äº†å•å¼•å·ï¼Œç´¢å¼•å¤±æ•ˆ" class="headerlink" title="3.3.3 ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†æŸ¥è¯¢æ—¶çœç•¥äº†å•å¼•å·ï¼Œç´¢å¼•å¤±æ•ˆ"></a>3.3.3 ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†æŸ¥è¯¢æ—¶çœç•¥äº†å•å¼•å·ï¼Œç´¢å¼•å¤±æ•ˆ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> age<span class="operator">=</span><span class="string">&#x27;20&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•æœ‰æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B%E6%9F%A5%E8%AF%A2%E6%97%B6%E4%BD%BF%E7%94%A8%E4%BA%86%E5%8D%95%E5%BC%95%E5%8F%B7%EF%BC%8C%E7%B4%A2%E5%BC%95%E7%94%9F%E6%95%88.png" alt="ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹æŸ¥è¯¢æ—¶ä½¿ç”¨äº†å•å¼•å·ï¼Œç´¢å¼•ç”Ÿæ•ˆ"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> age<span class="operator">=</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•å¤±æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B4%A2%E5%BC%95%E5%88%97%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B%E4%BD%86%E6%9F%A5%E8%AF%A2%E6%97%B6%E7%9C%81%E7%95%A5%E4%BA%86%E5%8D%95%E5%BC%95%E5%8F%B7%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88.png" alt="ç´¢å¼•åˆ—æ˜¯å­—ç¬¦ä¸²ç±»å‹ä½†æŸ¥è¯¢æ—¶çœç•¥äº†å•å¼•å·ï¼Œç´¢å¼•å¤±æ•ˆ"></p>
<h3 id="3-3-4-æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œåªè¦æœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆ"><a href="#3-3-4-æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œåªè¦æœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆ" class="headerlink" title="3.3.4 æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œåªè¦æœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆ"></a>3.3.4 æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œåªè¦æœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;å¼ ä¸‰&#x27;</span> <span class="keyword">or</span> sal<span class="operator">=</span><span class="number">5000</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä½¿ç”¨äº†ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6%E4%B8%AD%E6%9C%89or%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%9C%AA%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E7%9A%84%E5%AD%97%E6%AE%B5%EF%BC%8C%E7%B4%A2%E5%BC%95%E7%94%9F%E6%95%88.png" alt="æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œæ²¡æœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•ç”Ÿæ•ˆ"></p>
<p>å°†t_empè¡¨salå­—æ®µä¸Šçš„ç´¢å¼•åˆ é™¤ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_emp <span class="keyword">drop</span> index idx_t_emp_sal;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡éªŒè¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_emp <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;å¼ ä¸‰&#x27;</span> <span class="keyword">or</span> sal<span class="operator">=</span><span class="number">5000</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šç´¢å¼•å¤±æ•ˆ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6%E4%B8%AD%E6%9C%89or%EF%BC%8C%E6%9C%89%E6%9C%AA%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E7%9A%84%E5%AD%97%E6%AE%B5%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88.png" alt="æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰orï¼Œæœ‰æœªæ·»åŠ ç´¢å¼•çš„å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆ"></p>
<h3 id="3-3-5-å½“æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆ"><a href="#3-3-5-å½“æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆ" class="headerlink" title="3.3.5 å½“æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆ"></a>3.3.5 å½“æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆ</h3><p>å¤åˆ¶ä¸€å¼ æ–°è¡¨ï¼šemp2</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp2 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>ç»™salæ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp2 <span class="keyword">add</span> index idx_emp2_sal(sal);</span><br></pre></td></tr></table></figure>

<p>éªŒè¯1ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">800</span>;</span><br></pre></td></tr></table></figure>
<p>ä¸èµ°ç´¢å¼•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E8%AE%B0%E5%BD%95%E5%9C%A8%E8%A1%A8%E4%B8%AD%E5%8D%A0%E6%AF%94%E8%BE%83%E5%A4%A7%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E9%AA%8C%E8%AF%811.png" alt="æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆéªŒè¯1"></p>
<p>éªŒè¯2ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure>
<p>ä¸èµ°ç´¢å¼•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E8%AE%B0%E5%BD%95%E5%9C%A8%E8%A1%A8%E4%B8%AD%E5%8D%A0%E6%AF%94%E8%BE%83%E5%A4%A7%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E9%AA%8C%E8%AF%812.png" alt="æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆéªŒè¯2"></p>
<p>éªŒè¯3ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br></pre></td></tr></table></figure>
<p>èµ°ç´¢å¼•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E8%AE%B0%E5%BD%95%E5%9C%A8%E8%A1%A8%E4%B8%AD%E5%8D%A0%E6%AF%94%E8%BE%83%E5%A4%A7%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E9%AA%8C%E8%AF%813.png" alt="æŸ¥è¯¢çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•åœ¨è¡¨ä¸­å æ¯”è¾ƒå¤§ï¼Œç´¢å¼•å¤±æ•ˆéªŒè¯3"></p>
<h3 id="3-5-6-å…³äºis-nullå’Œis-not-nullçš„ç´¢å¼•å¤±æ•ˆé—®é¢˜"><a href="#3-5-6-å…³äºis-nullå’Œis-not-nullçš„ç´¢å¼•å¤±æ•ˆé—®é¢˜" class="headerlink" title="3.5.6 å…³äºis nullå’Œis not nullçš„ç´¢å¼•å¤±æ•ˆé—®é¢˜"></a>3.5.6 å…³äºis nullå’Œis not nullçš„ç´¢å¼•å¤±æ•ˆé—®é¢˜</h3><p>ç»™emp2çš„commå­—æ®µæ·»åŠ ä¸€ä¸ªç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_emp2_comm <span class="keyword">on</span> emp2(comm);</span><br></pre></td></tr></table></figure>
<p>å°†emp2è¡¨çš„commå­—æ®µå€¼å…¨éƒ¨æ›´æ–°ä¸ºNULLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> emp2 <span class="keyword">set</span> comm<span class="operator">=</span><span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<p>éªŒè¯æ­¤æ—¶æ¡ä»¶ä½¿ç”¨<code>is null</code>æ˜¯å¦èµ°ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä¸èµ°ç´¢å¼•ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8is%20null%E4%B8%8D%E8%B5%B0%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨is nullä¸èµ°ç´¢å¼•"></p>
<p>éªŒè¯æ­¤æ—¶æ¡ä»¶ä½¿ç”¨<code>is not null</code>æ˜¯å¦èµ°ç´¢å¼•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E9%AA%8C%E8%AF%81%E6%AD%A4%E6%97%B6%E6%9D%A1%E4%BB%B6%E4%BD%BF%E7%94%A8is%20not%20null%E6%98%AF%E5%90%A6%E8%B5%B0%E7%B4%A2%E5%BC%951.png" alt="éªŒè¯æ­¤æ—¶æ¡ä»¶ä½¿ç”¨is not nullæ˜¯å¦èµ°ç´¢å¼•1"></p>
<p>å°†emp2è¡¨çš„commå­—æ®µå…¨éƒ¨æ›´æ–°ä¸ºéNULLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> emp2 <span class="keyword">set</span> comm<span class="operator">=</span><span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p>éªŒè¯æ­¤æ—¶æ¡ä»¶ä½¿ç”¨<code>is null</code>æ˜¯å¦èµ°ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šèµ°ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E8%B5%B0%E7%B4%A2%E5%BC%95.png" alt="èµ°ç´¢å¼•"></p>
<p>éªŒè¯æ­¤æ—¶æ¡ä»¶ä½¿ç”¨<code>is not null</code>æ˜¯å¦èµ°ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp2 <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<p>éªŒè¯ç»“æœï¼šä¸èµ°ç´¢å¼•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%B8%8D%E8%B5%B0%E7%B4%A2%E5%BC%95.png" alt="ä¸èµ°ç´¢å¼•"></p>
<p>ç»“è®ºï¼šèµ°ç´¢å¼•è¿˜æ˜¯ä¸èµ°ç´¢å¼•ï¼Œæ ¹æ•°æ®åˆ†å¸ƒæœ‰å¾ˆå¤§å…³ç³»ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶çš„è®°å½•å æ¯”è¾ƒå¤§ï¼Œä¼šè€ƒè™‘ä½¿ç”¨å…¨è¡¨æ‰«æï¼Œè€Œæ”¾å¼ƒèµ°ç´¢å¼•ã€‚</p>
<h2 id="3-4-æŒ‡å®šç´¢å¼•"><a href="#3-4-æŒ‡å®šç´¢å¼•" class="headerlink" title="3.4 æŒ‡å®šç´¢å¼•"></a>3.4 æŒ‡å®šç´¢å¼•</h2><p>å½“ä¸€ä¸ªå­—æ®µä¸Šæ—¢æœ‰å•åˆ—ç´¢å¼•ï¼Œåˆæœ‰å¤åˆç´¢å¼•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„SQLæç¤ºæ¥è¦æ±‚è¯¥SQLè¯­å¥æ‰§è¡Œæ—¶é‡‡ç”¨å“ªä¸ªç´¢å¼•ï¼š</p>
<ul>
<li><code>use index(ç´¢å¼•åç§°)</code>ï¼šå»ºè®®ä½¿ç”¨è¯¥ç´¢å¼•ï¼Œåªæ˜¯å»ºè®®ï¼Œåº•å±‚mysqlä¼šæ ¹æ®å®é™…æ•ˆç‡æ¥è€ƒè™‘æ˜¯å¦ä½¿ç”¨ä½ æ¨èçš„ç´¢å¼•</li>
<li><code>ignore index(ç´¢å¼•åç§°)</code>ï¼šå¿½ç•¥è¯¥ç´¢å¼•</li>
<li><code>force index(ç´¢å¼•åç§°)</code>ï¼šå¼ºè¡Œä½¿ç”¨è¯¥ç´¢å¼•</li>
</ul>
<p>æŸ¥çœ‹ t_customer è¡¨ä¸Šçš„ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> t_customer;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/t_customer%E8%A1%A8%E4%B8%8A%E7%9A%84%E7%B4%A2%E5%BC%95.png" alt="t_customerè¡¨ä¸Šçš„ç´¢å¼•"></p>
<p>å¯ä»¥çœ‹åˆ°nameã€ageã€genderä¸‰åˆ—æ·»åŠ äº†ä¸€ä¸ªå¤åˆç´¢å¼•ã€‚</p>
<p>ç°åœ¨ç»™nameå­—æ®µæ·»åŠ ä¸€ä¸ªå•åˆ—ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> t_customer(name);</span><br></pre></td></tr></table></figure>
<p>çœ‹çœ‹ä»¥ä¸‹çš„è¯­å¥é»˜è®¤ä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E9%BB%98%E8%AE%A4%E4%BD%BF%E7%94%A8%E4%BA%86%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95.png" alt="é»˜è®¤ä½¿ç”¨äº†è”åˆç´¢å¼•"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œé»˜è®¤ä½¿ç”¨äº†è”åˆç´¢å¼•ã€‚</p>
<p>å¦‚ä½•å»ºè®®ä½¿ç”¨å•åˆ—ç´¢å¼• <code>idx_name</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer use index(idx_name) <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95idx_name.png" alt="å»ºè®®ä½¿ç”¨å•åˆ—ç´¢å¼•idx_name"></p>
<p>å¦‚ä½•å¿½ç•¥ä½¿ç”¨ç¬¦åˆç´¢å¼• <code>idx_name_age_gender</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer ignore index(idx_name_age_gender) <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%BF%BD%E7%95%A5%E4%BD%BF%E7%94%A8%E7%AC%A6%E5%90%88%E7%B4%A2%E5%BC%95idx_name_age_gender.png" alt="å¿½ç•¥ä½¿ç”¨ç¬¦åˆç´¢å¼•idx_name_age_gender"></p>
<p>å¦‚ä½•å¼ºè¡Œä½¿ç”¨å•åˆ—ç´¢å¼• <code>idx_name</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_customer force index(idx_name) <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%BC%BA%E8%A1%8C%E4%BD%BF%E7%94%A8%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95idx_name.png" alt="å¼ºè¡Œä½¿ç”¨å•åˆ—ç´¢å¼•idx_name"></p>
<h2 id="3-5-è¦†ç›–ç´¢å¼•"><a href="#3-5-è¦†ç›–ç´¢å¼•" class="headerlink" title="3.5 è¦†ç›–ç´¢å¼•"></a>3.5 è¦†ç›–ç´¢å¼•</h2><p>è¦†ç›–ç´¢å¼•æˆ‘ä»¬åœ¨è®²è§£ç´¢å¼•çš„æ—¶å€™å·²ç»æåˆ°è¿‡äº†ï¼Œè¦†ç›–ç´¢å¼•å¼ºè°ƒçš„æ˜¯ï¼šåœ¨selectåé¢å†™å­—æ®µçš„æ—¶å€™ï¼Œè¿™äº›å­—æ®µå°½å¯èƒ½æ˜¯ç´¢å¼•æ‰€è¦†ç›–çš„å­—æ®µï¼Œè¿™æ ·å¯ä»¥é¿å…å›è¡¨æŸ¥è¯¢ã€‚å°½å¯èƒ½é¿å…ä½¿ç”¨ <code>select *</code>ï¼Œå› ä¸º <code>select *</code> å¾ˆå®¹æ˜“å¯¼è‡´å›è¡¨æŸ¥è¯¢ã€‚ï¼ˆæœ¬è´¨å°±æ˜¯ï¼šèƒ½åœ¨ç´¢å¼•ä¸Šæ£€ç´¢çš„ï¼Œå°±ä¸è¦å†æ¬¡å›è¡¨æŸ¥è¯¢äº†ã€‚ï¼‰</p>
<p>ä¾‹å¦‚ï¼šæœ‰ä¸€å¼ è¡¨ emp3ï¼Œå…¶ä¸­ enameï¼Œjobæ·»åŠ äº†è”åˆç´¢å¼•ï¼šidx_emp3_ename_jobï¼Œä»¥ä¸‹è¿™ä¸ªselectè¯­å¥å°±ä¸ä¼šå›è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> emp3;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp3 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp3 <span class="keyword">add</span> <span class="keyword">constraint</span> emp3_pk <span class="keyword">primary</span> key(empno);</span><br><span class="line"><span class="keyword">create</span> index idx_emp3_ename_job <span class="keyword">on</span> emp3(ename,job);</span><br><span class="line">explain <span class="keyword">select</span> empno,ename,job <span class="keyword">from</span> emp3 <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;KING&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/select%E8%AF%AD%E5%8F%A5%E4%B8%8D%E5%9B%9E%E8%A1%A8.png" alt="selectè¯­å¥ä¸å›è¡¨"></p>
<p>å¦‚æœæŸ¥è¯¢è¯­å¥è¦æŸ¥æ‰¾çš„åˆ—æ²¡æœ‰åœ¨ç´¢å¼•ä¸­ï¼Œåˆ™ä¼šå›è¡¨æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> empno,ename,job,sal <span class="keyword">from</span> emp3 <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;KING&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/select%E8%AF%AD%E5%8F%A5%E5%9B%9E%E8%A1%A8.png" alt="selectè¯­å¥å›è¡¨"></p>
<p>é¢è¯•é¢˜ï¼št_userè¡¨å­—æ®µå¦‚ä¸‹ï¼šid,name,password,realname,birth,emailã€‚è¡¨ä¸­æ•°æ®é‡500ä¸‡æ¡ï¼Œè¯·é’ˆå¯¹ä»¥ä¸‹SQLè¯­å¥ç»™å‡ºä¼˜åŒ–æ–¹æ¡ˆï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> id,name,realname <span class="keyword">from</span> t_user <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;é²æ™ºæ·±&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœåªç»™nameæ·»åŠ ç´¢å¼•ï¼Œåº•å±‚ä¼šè¿›è¡Œå¤§é‡çš„å›è¡¨æŸ¥è¯¢ï¼Œæ•ˆç‡è¾ƒä½ï¼Œå»ºè®®ç»™nameå’Œrealnameä¸¤ä¸ªå­—æ®µæ·»åŠ è”åˆç´¢å¼•ï¼Œè¿™æ ·å¤§å¤§å‡å°‘å›è¡¨æ“ä½œï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<h2 id="3-6-å‰ç¼€ç´¢å¼•"><a href="#3-6-å‰ç¼€ç´¢å¼•" class="headerlink" title="3.6 å‰ç¼€ç´¢å¼•"></a>3.6 å‰ç¼€ç´¢å¼•</h2><p>å¦‚æœä¸€ä¸ªå­—æ®µç±»å‹æ˜¯varcharæˆ–textå­—æ®µï¼Œå­—æ®µä¸­å­˜å‚¨çš„æ˜¯æ–‡æœ¬æˆ–è€…å¤§æ–‡æœ¬ï¼Œç›´æ¥å¯¹è¿™ç§é•¿æ–‡æœ¬åˆ›å»ºç´¢å¼•ï¼Œä¼šè®©ç´¢å¼•ä½“ç§¯å¾ˆå¤§ï¼Œæ€ä¹ˆä¼˜åŒ–å‘¢ï¼Ÿå¯ä»¥å°†å­—ç¬¦ä¸²çš„å‰å‡ ä¸ªå­—ç¬¦æˆªå–ä¸‹æ¥å½“åšç´¢å¼•æ¥åˆ›å»ºã€‚è¿™ç§ç´¢å¼•è¢«ç§°ä¸ºå‰ç¼€ç´¢å¼•ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> emp4;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp4 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">create</span> index idx_emp4_ename_2 <span class="keyword">on</span> emp4(ename(<span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸ŠSQLè¡¨ç¤ºå°†emp4è¡¨ä¸­enameå­—æ®µçš„å‰2ä¸ªå­—ç¬¦åˆ›å»ºåˆ°ç´¢å¼•å½“ä¸­ã€‚</p>
<p>ä½¿ç”¨å‰ç¼€ç´¢å¼•æ—¶ï¼Œéœ€è¦é€šè¿‡ä»¥ä¸‹å…¬å¼æ¥ç¡®å®šä½¿ç”¨å‰å‡ ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="built_in">substring</span>(ename,<span class="number">1</span>,å‰å‡ ä¸ªå­—ç¬¦)) <span class="operator">/</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp4;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸ŠæŸ¥è¯¢ç»“æœè¶Šæ¥è¿‘1ï¼Œè¡¨ç¤ºç´¢å¼•çš„æ•ˆæœè¶Šå¥½ã€‚ï¼ˆåŸç†ï¼šåšç´¢å¼•å€¼çš„è¯ï¼Œç´¢å¼•å€¼è¶Šå…·æœ‰å”¯ä¸€æ€§æ•ˆç‡è¶Šé«˜ï¼‰</p>
<p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨å‰1ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•å€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="built_in">substring</span>(ename,<span class="number">1</span>,<span class="number">1</span>)) <span class="operator">/</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp4;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E5%89%8D1%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%BD%9C%E4%B8%BA%E7%B4%A2%E5%BC%95%E5%80%BC.png" alt="ä½¿ç”¨å‰1ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•å€¼"></p>
<p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨å‰2ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•å€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="built_in">substring</span>(ename,<span class="number">1</span>,<span class="number">2</span>)) <span class="operator">/</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp4;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E5%89%8D2%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%BD%9C%E4%B8%BA%E7%B4%A2%E5%BC%95%E5%80%BC.png" alt="ä½¿ç”¨å‰2ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•å€¼"></p>
<p>å¯è§ä½¿ç”¨å‰2ä¸ªå­—ç¬¦ä½œä¸ºç´¢å¼•å€¼ï¼Œèƒ½å¤Ÿè®©ç´¢å¼•å€¼æ›´å…·æœ‰å”¯ä¸€æ€§ï¼Œæ•ˆç‡è¶Šå¥½ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©å‰2ä¸ªå­—ç¬¦ä½œä¸ºå‰ç¼€ç´¢å¼•ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_emp4_ename_2 <span class="keyword">on</span> emp4(ename(<span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸‹çš„æŸ¥è¯¢è¯­å¥åˆ™ä¼šèµ°è¿™ä¸ªå‰ç¼€ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp4 <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;KING&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E8%B5%B0%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95.png" alt="æŸ¥è¯¢è¯­å¥èµ°å‰ç¼€ç´¢å¼•"></p>
<h2 id="3-7-å•åˆ—ç´¢å¼•å’Œå¤åˆç´¢å¼•æ€ä¹ˆé€‰æ‹©"><a href="#3-7-å•åˆ—ç´¢å¼•å’Œå¤åˆç´¢å¼•æ€ä¹ˆé€‰æ‹©" class="headerlink" title="3.7 å•åˆ—ç´¢å¼•å’Œå¤åˆç´¢å¼•æ€ä¹ˆé€‰æ‹©"></a>3.7 å•åˆ—ç´¢å¼•å’Œå¤åˆç´¢å¼•æ€ä¹ˆé€‰æ‹©</h2><p>å½“æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶ä¸­æœ‰å¤šä¸ªæ¡ä»¶ï¼Œå»ºè®®å°†è¿™å‡ ä¸ªåˆ—åˆ›å»ºä¸ºå¤åˆç´¢å¼•ï¼Œå› ä¸ºåˆ›å»ºå•åˆ—ç´¢å¼•å¾ˆå®¹æ˜“å›è¡¨æŸ¥è¯¢ã€‚</p>
<p>ä¾‹å¦‚åˆ†åˆ«ç»™emp5è¡¨enameï¼Œjobæ·»åŠ ä¸¤ä¸ªå•åˆ—ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp5 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp5 <span class="keyword">add</span> <span class="keyword">constraint</span> emp5_pk <span class="keyword">primary</span> key(empno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> index idx_emp5_ename <span class="keyword">on</span> emp5(ename);</span><br><span class="line"><span class="keyword">create</span> index idx_emp5_job <span class="keyword">on</span> emp5(job);</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> empno,ename,job <span class="keyword">from</span> emp5 <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span> <span class="keyword">and</span> job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E4%BA%86%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨äº†å•åˆ—ç´¢å¼•"></p>
<p>enameå’Œjobéƒ½å‡ºç°åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­ï¼Œå¯ä»¥ç»™emp6è¡¨çš„enameå’Œjobåˆ›å»ºä¸€ä¸ªå¤åˆç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp6 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp6 <span class="keyword">add</span> <span class="keyword">constraint</span> emp6_pk <span class="keyword">primary</span> key(empno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> index idx_emp6_ename_job <span class="keyword">on</span> emp6(ename,job);</span><br><span class="line">explain <span class="keyword">select</span> empno,ename,job <span class="keyword">from</span> emp6 <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span> <span class="keyword">and</span> job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E4%BA%86%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨äº†å¤åˆç´¢å¼•"></p>
<p>å¯¹äºä»¥ä¸ŠæŸ¥è¯¢è¯­å¥ï¼Œä½¿ç”¨å¤åˆç´¢å¼•é¿å…äº†å›è¡¨ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹è¿˜æ˜¯å»ºè®®ä½¿ç”¨å¤åˆç´¢å¼•ã€‚</p>
<p><font color="red">PSï¼šåˆ›å»ºç´¢å¼•æ—¶åº”è€ƒè™‘æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œä¸»å­—æ®µå¹¶ä¸”å…·æœ‰å¾ˆå¼ºå”¯ä¸€æ€§çš„å­—æ®µå»ºè®®æ’åœ¨ç¬¬ä¸€ä½ã€‚</font></p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_emp_ename_job <span class="keyword">on</span> emp(ename,job);</span><br></pre></td></tr></table></figure>
<p>å’Œä»¥ä¸‹æ–¹å¼å¯¹æ¯”ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_emp_job_ename <span class="keyword">on</span> emp(job,ename);</span><br></pre></td></tr></table></figure>
<p>ç”±äºenameæ˜¯ä¸»å­—æ®µï¼Œå¹¶ä¸”enameå…·æœ‰å¾ˆå¥½çš„å”¯ä¸€æ€§ï¼Œå»ºè®®å°†enameåˆ—æ”¾åœ¨æœ€å·¦è¾¹ã€‚å› æ­¤è¿™ä¸¤ç§åˆ›å»ºå¤åˆç´¢å¼•çš„æ–¹å¼ï¼Œå»ºè®®é‡‡ç”¨ç¬¬ä¸€ç§ã€‚</p>
<p>å¤åˆç´¢å¼•åº•å±‚åŸç†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86.png" alt="å¤åˆç´¢å¼•åº•å±‚åŸç†"></p>
<h2 id="3-8-ç´¢å¼•åˆ›å»ºåŸåˆ™"><a href="#3-8-ç´¢å¼•åˆ›å»ºåŸåˆ™" class="headerlink" title="3.8 ç´¢å¼•åˆ›å»ºåŸåˆ™"></a>3.8 ç´¢å¼•åˆ›å»ºåŸåˆ™</h2><ul>
<li>è¡¨æ•°æ®é‡åºå¤§ï¼Œé€šå¸¸è¶…è¿‡ç™¾ä¸‡æ¡æ•°æ®ã€‚</li>
<li>ç»å¸¸å‡ºç°åœ¨<code>where</code>ï¼Œ<code>order by</code>ï¼Œ<code>group by</code>åé¢çš„å­—æ®µå»ºè®®æ·»åŠ ç´¢å¼•ã€‚</li>
<li>åˆ›å»ºç´¢å¼•çš„å­—æ®µå°½é‡å…·æœ‰å¾ˆå¼ºçš„å”¯ä¸€æ€§ã€‚</li>
<li>å¦‚æœå­—æ®µå­˜å‚¨æ–‡æœ¬ï¼Œå†…å®¹è¾ƒå¤§ï¼Œä¸€å®šè¦åˆ›å»ºå‰ç¼€ç´¢å¼•ã€‚</li>
<li>å°½é‡ä½¿ç”¨å¤åˆç´¢å¼•ï¼Œä½¿ç”¨å•åˆ—ç´¢å¼•å®¹æ˜“å›è¡¨æŸ¥è¯¢ã€‚</li>
<li>å¦‚æœä¸€ä¸ªå­—æ®µä¸­çš„æ•°æ®ä¸ä¼šä¸ºNULLï¼Œå»ºè®®å»ºè¡¨æ—¶æ·»åŠ not nullçº¦æŸï¼Œè¿™æ ·ä¼˜åŒ–å™¨å°±çŸ¥é“ä½¿ç”¨å“ªä¸ªç´¢å¼•åˆ—æ›´åŠ æœ‰æ•ˆã€‚</li>
<li>ä¸è¦åˆ›å»ºå¤ªå¤šç´¢å¼•ï¼Œå½“å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹çš„æ—¶å€™ï¼Œç´¢å¼•éœ€è¦é‡æ–°é‡æ–°æ’åºã€‚</li>
<li>å¦‚æœå¾ˆå°‘çš„æŸ¥è¯¢ï¼Œç»å¸¸çš„å¢åˆ æ”¹ä¸å»ºè®®åŠ ç´¢å¼•ã€‚</li>
</ul>
<h1 id="4-SQLä¼˜åŒ–"><a href="#4-SQLä¼˜åŒ–" class="headerlink" title="4. SQLä¼˜åŒ–"></a>4. SQLä¼˜åŒ–</h1><h2 id="4-1-order-byä¼˜åŒ–"><a href="#4-1-order-byä¼˜åŒ–" class="headerlink" title="4.1 order byä¼˜åŒ–"></a>4.1 order byä¼˜åŒ–</h2><p>å‡†å¤‡æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> workers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> workers(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  age <span class="type">int</span>,</span><br><span class="line">  sal <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> workers <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;å­™æ‚Ÿç©º&#x27;</span>, <span class="number">500</span>, <span class="number">50000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> workers <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;çŒªå…«æˆ’&#x27;</span>, <span class="number">300</span>, <span class="number">40000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> workers <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;æ²™å’Œå°š&#x27;</span>, <span class="number">600</span>, <span class="number">40000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> workers <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;ç™½éª¨ç²¾&#x27;</span>, <span class="number">600</span>, <span class="number">10000</span>);</span><br></pre></td></tr></table></figure>

<p>explainæŸ¥çœ‹ä¸€ä¸ªå¸¦æœ‰<code>order by</code>çš„è¯­å¥æ—¶ï¼ŒExtraåˆ—ä¼šæ˜¾ç¤ºï¼šusing index æˆ–è€… using filesortï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>using index:  è¡¨ç¤ºä½¿ç”¨ç´¢å¼•ï¼Œå› ä¸ºç´¢å¼•æ˜¯æå‰æ’å¥½åºçš„ã€‚æ•ˆç‡å¾ˆé«˜ã€‚</li>
<li>using filesortï¼šè¡¨ç¤ºä½¿ç”¨æ–‡ä»¶æ’åºï¼Œè¿™å°±è¡¨ç¤ºæ²¡æœ‰èµ°ç´¢å¼•ï¼Œå¯¹è¡¨ä¸­æ•°æ®è¿›è¡Œæ’åºï¼Œæ’åºæ—¶å°†ç¡¬ç›˜çš„æ•°æ®è¯»å–åˆ°å†…å­˜å½“ä¸­ï¼Œåœ¨å†…å­˜å½“ä¸­æ’å¥½åºã€‚è¿™ä¸ªæ•ˆç‡æ˜¯ä½çš„ï¼Œåº”é¿å…ã€‚</li>
</ul>
<p>æ­¤æ—¶nameæ²¡æœ‰æ·»åŠ ç´¢å¼•ï¼Œå¦‚æœæ ¹æ®nameè¿›è¡Œæ’åºçš„è¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,name <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/name%E6%B2%A1%E6%9C%89%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E6%A0%B9%E6%8D%AEname%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F.png" alt="nameæ²¡æœ‰æ·»åŠ ç´¢å¼•æ ¹æ®nameè¿›è¡Œæ’åº"></p>
<p>æ˜¾ç„¶è¿™ç§æ–¹å¼æ•ˆç‡è¾ƒä½ã€‚</p>
<p>ç»™nameæ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_workers_name <span class="keyword">on</span> workers(name);</span><br></pre></td></tr></table></figure>
<p>å†æ ¹æ®nameæ’åºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,name <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%BB%99name%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E6%A0%B9%E6%8D%AEname%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F%E7%9A%84%E8%AF%9D.png" alt="ç»™nameæ·»åŠ ç´¢å¼•æ ¹æ®nameè¿›è¡Œæ’åºçš„è¯"></p>
<p>è¿™æ ·æ•ˆç‡åˆ™æå‡äº†ã€‚</p>
<p>å¦‚æœè¦é€šè¿‡ageå’Œsalä¸¤ä¸ªå­—æ®µè¿›è¡Œæ’åºï¼Œæœ€å¥½ç»™ageå’Œsalä¸¤ä¸ªå­—æ®µæ·»åŠ å¤åˆç´¢å¼•ï¼Œä¸æ·»åŠ å¤åˆç´¢å¼•æ—¶ï¼š</p>
<p>æŒ‰ç…§ageå‡åºæ’ï¼Œå¦‚æœageç›¸åŒåˆ™æŒ‰ç…§salå‡åº</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age,sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%B8%8D%E6%B7%BB%E5%8A%A0%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95%E6%97%B6%E6%8C%89%E7%85%A7age%E5%8D%87%E5%BA%8Fsal%E5%8D%87%E5%BA%8F.png" alt="ä¸æ·»åŠ å¤åˆç´¢å¼•æ—¶æŒ‰ç…§ageå‡åºsalå‡åº"></p>
<p>è¿™æ ·æ•ˆç‡æ˜¯ä½çš„ã€‚</p>
<p>ç»™ageå’Œsalæ·»åŠ å¤åˆç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_workers_age_sal <span class="keyword">on</span> workers(age, sal);</span><br></pre></td></tr></table></figure>
<p>å†æŒ‰ç…§ageå‡åºæ’ï¼Œå¦‚æœageç›¸åŒåˆ™æŒ‰ç…§salå‡åºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age,sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%B7%BB%E5%8A%A0%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95%E6%97%B6%E6%8C%89%E7%85%A7age%E5%8D%87%E5%BA%8Fsal%E5%8D%87%E5%BA%8F.png" alt="æ·»åŠ å¤åˆç´¢å¼•æ—¶æŒ‰ç…§ageå‡åºsalå‡åº"></p>
<p>è¿™æ ·æ•ˆç‡æå‡äº†ã€‚</p>
<p>åœ¨B+æ ‘ä¸Šå¶å­ç»“ç‚¹ä¸Šçš„æ‰€æœ‰æ•°æ®é»˜è®¤æ˜¯æŒ‰ç…§å‡åºæ’åˆ—çš„ï¼Œå¦‚æœæŒ‰ç…§ageé™åºï¼Œå¦‚æœageç›¸åŒåˆ™æŒ‰ç…§salé™åºï¼Œä¼šèµ°ç´¢å¼•å—ï¼Ÿ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%8F%8D%E5%90%91%E7%B4%A2%E5%BC%95%E6%89%AB%E6%8F%8F%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95.png" alt="åå‘ç´¢å¼•æ‰«æä½¿ç”¨ç´¢å¼•"></p>
<p>å¯ä»¥çœ‹åˆ°å¤‡æ³¨ä¿¡æ¯æ˜¯ï¼šåå‘ç´¢å¼•æ‰«æï¼Œä½¿ç”¨äº†ç´¢å¼•ã€‚</p>
<p>è¿™æ ·æ•ˆç‡ä¹Ÿæ˜¯å¾ˆé«˜çš„ï¼Œå› ä¸ºB+æ ‘å¶å­ç»“ç‚¹ä¹‹é—´é‡‡ç”¨çš„æ˜¯åŒå‘æŒ‡é’ˆã€‚å¯ä»¥ä»å·¦å‘å³ï¼ˆå‡åºï¼‰ï¼Œä¹Ÿå¯ä»¥ä»å³å‘å·¦ï¼ˆé™åºï¼‰ã€‚</p>
<p>å¦‚æœä¸€ä¸ªå‡åºï¼Œä¸€ä¸ªé™åºä¼šæ€æ ·å‘¢ï¼Ÿ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>, sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/age%E5%8D%87%E5%BA%8Fsal%E9%99%8D%E5%BA%8F.png" alt="ageå‡åºsalé™åº"></p>
<p>å¯è§ageä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯salæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥é’ˆå¯¹è¿™ç§æ’åºæƒ…å†µåˆ›å»ºå¯¹åº”çš„ç´¢å¼•æ¥è§£å†³ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_workers_ageasc_saldesc <span class="keyword">on</span> workers(age <span class="keyword">asc</span>, sal <span class="keyword">desc</span>);</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºçš„ç´¢å¼•å¦‚ä¸‹ï¼šAè¡¨ç¤ºå‡åºï¼ŒDè¡¨ç¤ºé™åºã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%88%9B%E5%BB%BAidx_workers_ageasc_saldesc%E7%B4%A2%E5%BC%95.png" alt="åˆ›å»ºidx_workers_ageasc_saldescç´¢å¼•"></p>
<p>å†æ¬¡æ‰§è¡Œï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>, sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E4%BA%86idx_workers_ageasc_saldesc%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨äº†idx_workers_ageasc_saldescç´¢å¼•"></p>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œå¯¹äºæ’åºæ¥è¯´æ˜¯å¦æ”¯æŒæœ€å·¦å‰ç¼€æ³•åˆ™ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> id,age,sal <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%8E%92%E5%BA%8F%E9%81%B5%E5%BE%AA%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E6%B3%95%E5%88%99.png" alt="æ’åºéµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œorder byä¹Ÿéµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹æœªä½¿ç”¨è¦†ç›–ç´¢å¼•ä¼šæ€æ ·ï¼Ÿ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> workers <span class="keyword">order</span> <span class="keyword">by</span> age,sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%8E%92%E5%BA%8F%E6%9C%AA%E4%BD%BF%E7%94%A8%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95.png" alt="æ’åºæœªä½¿ç”¨è¦†ç›–ç´¢å¼•"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œæ’åºä¹Ÿè¦å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•ã€‚</p>
<p>order by ä¼˜åŒ–åŸåˆ™æ€»ç»“ï¼š</p>
<ul>
<li>æ’åºä¹Ÿè¦éµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚</li>
<li>ä½¿ç”¨è¦†ç›–ç´¢å¼•ã€‚</li>
<li>é’ˆå¯¹ä¸åŒçš„æ’åºè§„åˆ™ï¼Œåˆ›å»ºä¸åŒç´¢å¼•ã€‚ï¼ˆå¦‚æœæ‰€æœ‰å­—æ®µéƒ½æ˜¯å‡åºï¼Œæˆ–è€…æ‰€æœ‰å­—æ®µéƒ½æ˜¯é™åºï¼Œåˆ™ä¸éœ€è¦åˆ›å»ºæ–°çš„ç´¢å¼•ï¼‰</li>
<li>å¦‚æœæ— æ³•é¿å…filesortï¼Œè¦æ³¨æ„æ’åºç¼“å­˜çš„å¤§å°ï¼Œé»˜è®¤ç¼“å­˜å¤§å°256KBï¼Œå¯ä»¥ä¿®æ”¹ç³»ç»Ÿå˜é‡ sort_buffer_size ï¼š<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;sort_buffer_size&#x27;</span>;</span><br></pre></td></tr></table></figure>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8Fsort_buffer_size.png" alt="ç³»ç»Ÿå˜é‡sort_buffer_size"></li>
</ul>
<h2 id="4-2-group-byä¼˜åŒ–"><a href="#4-2-group-byä¼˜åŒ–" class="headerlink" title="4.2 group byä¼˜åŒ–"></a>4.2 group byä¼˜åŒ–</h2><p>åˆ›å»ºempxè¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> empx <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>jobå­—æ®µä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œæ ¹æ®jobè¿›è¡Œåˆ†ç»„ï¼ŒæŸ¥çœ‹æ¯ä¸ªå·¥ä½œå²—ä½æœ‰å¤šå°‘äººï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> job,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/job%E5%AD%97%E6%AE%B5%E4%B8%8A%E6%B2%A1%E6%9C%89%E7%B4%A2%E5%BC%95%E6%A0%B9%E6%8D%AEjob%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84.png" alt="jobå­—æ®µä¸Šæ²¡æœ‰ç´¢å¼•æ ¹æ®jobè¿›è¡Œåˆ†ç»„"></p>
<p>çœ‹çœ‹æ˜¯å¦èµ°ç´¢å¼•äº†ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> job,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E4%BA%86%E4%B8%B4%E6%97%B6%E8%A1%A8.png" alt="ä½¿ç”¨äº†ä¸´æ—¶è¡¨"></p>
<p>ä½¿ç”¨äº†ä¸´æ—¶è¡¨ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p>
<p>ç»™jobæ·»åŠ ç´¢å¼•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_empx_job <span class="keyword">on</span> empx(job);</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æ‰§è¡Œï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> job,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8idx_empx_job%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨idx_empx_jobç´¢å¼•"></p>
<p>æ•ˆç‡æå‡äº†ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹<code>group by</code>æ˜¯å¦éœ€è¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ï¼šç»™deptnoå’Œsalæ·»åŠ å¤åˆç´¢å¼•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_empx_deptno_sal <span class="keyword">on</span> empx(deptno, sal);</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®éƒ¨é—¨ç¼–å·åˆ†ç»„ï¼ŒæŸ¥çœ‹æ¯ä¸ªéƒ¨é—¨äººæ•°ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> deptno,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BD%BF%E7%94%A8%E4%BA%86idx_empx_deptno_sal%E7%B4%A2%E5%BC%95.png" alt="ä½¿ç”¨äº†idx_empx_deptno_salç´¢å¼•"></p>
<p>æ•ˆç‡å¾ˆé«˜ï¼Œå› ä¸ºdeptnoæ˜¯å¤åˆç´¢å¼•ä¸­æœ€å·¦è¾¹çš„å­—æ®µã€‚</p>
<p>æ ¹æ®salåˆ†ç»„ï¼ŒæŸ¥çœ‹æ¯ä¸ªå·¥èµ„æœ‰å¤šå°‘äººï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> sal, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">group</span> <span class="keyword">by</span> sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%A0%B9%E6%8D%AEsal%E5%88%86%E7%BB%84.png" alt="æ ¹æ®salåˆ†ç»„"></p>
<p>ä½¿ç”¨äº†ä¸´æ—¶è¡¨ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œ<code>group by</code>ä¹ŸåŒæ ·éµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚</p>
<p>æˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚æœå°†éƒ¨é—¨ç¼–å·deptnoï¼ˆå¤åˆç´¢å¼•çš„æœ€å·¦åˆ—ï¼‰æ·»åŠ åˆ°whereæ¡ä»¶ä¸­ï¼Œæ•ˆç‡ä¼šä¸ä¼šæå‡ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">explain <span class="keyword">select</span> sal, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> empx <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">10</span> <span class="keyword">group</span> <span class="keyword">by</span> sal;</span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%B0%86%E9%83%A8%E9%97%A8%E7%BC%96%E5%8F%B7deptno%EF%BC%88%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95%E7%9A%84%E6%9C%80%E5%B7%A6%E5%88%97%EF%BC%89%E6%B7%BB%E5%8A%A0%E5%88%B0where%E6%9D%A1%E4%BB%B6%E4%B8%AD.png" alt="å°†éƒ¨é—¨ç¼–å·deptnoï¼ˆå¤åˆç´¢å¼•çš„æœ€å·¦åˆ—ï¼‰æ·»åŠ åˆ°whereæ¡ä»¶ä¸­"></p>
<p>æ•ˆç‡æœ‰æå‡çš„ï¼Œè¿™è¯´æ˜äº†ï¼Œ<code>group by</code>ç¡®å®ä¹Ÿéµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚ï¼ˆwhereä¸­ä½¿ç”¨äº†æœ€å·¦åˆ—)</p>
<h2 id="4-3-limitä¼˜åŒ–"><a href="#4-3-limitä¼˜åŒ–" class="headerlink" title="4.3 limitä¼˜åŒ–"></a>4.3 limitä¼˜åŒ–</h2><p>æ•°æ®é‡ç‰¹åˆ«åºå¤§æ—¶ï¼Œå–æ•°æ®æ—¶ï¼Œè¶Šå¾€åæ•ˆç‡è¶Šä½ï¼Œæ€ä¹ˆæå‡ï¼Ÿmysqlå®˜æ–¹ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä½¿ç”¨è¦†ç›–ç´¢å¼•+å­æŸ¥è¯¢çš„å½¢å¼æ¥æå‡æ•ˆç‡ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/limit%E4%BC%98%E5%8C%96-%E6%9F%A5%E8%AF%A2%E6%95%88%E7%8E%87(1).png" alt="limitä¼˜åŒ–-æŸ¥è¯¢æ•ˆç‡(1)" style="zoom:67%;">

<p>æ€ä¹ˆè§£å†³ï¼Ÿä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ŒåŠ å­æŸ¥è¯¢</p>
<p>ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼šé€Ÿåº¦æœ‰æ‰€æå‡</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/limit%E4%BC%98%E5%8C%96-%E6%9F%A5%E8%AF%A2%E6%95%88%E7%8E%87(2).png" alt="limitä¼˜åŒ–-æŸ¥è¯¢æ•ˆç‡(2)"></p>
<p>ä½¿ç”¨å­æŸ¥è¯¢å½¢å¼å–å…¶ä»–åˆ—çš„æ•°æ®ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/limit%E4%BC%98%E5%8C%96-%E6%9F%A5%E8%AF%A2%E6%95%88%E7%8E%87(3).png" alt="limitä¼˜åŒ–-æŸ¥è¯¢æ•ˆç‡(3)" style="zoom:67%;">

<p>é€šè¿‡æµ‹è¯•ï¼Œè¿™ç§æ–¹å¼æ•´ä½“æ•ˆç‡æœ‰æ‰€æå‡ã€‚</p>
<h2 id="4-4-ä¸»é”®ä¼˜åŒ–"><a href="#4-4-ä¸»é”®ä¼˜åŒ–" class="headerlink" title="4.4 ä¸»é”®ä¼˜åŒ–"></a>4.4 ä¸»é”®ä¼˜åŒ–</h2><p>ä¸»é”®è®¾è®¡åŸåˆ™ï¼š</p>
<ul>
<li>ä¸»é”®å€¼ä¸è¦å¤ªé•¿ï¼ŒäºŒçº§ç´¢å¼•å¶å­ç»“ç‚¹ä¸Šå­˜å‚¨çš„æ˜¯ä¸»é”®å€¼ï¼Œä¸»é”®å€¼å¤ªé•¿ï¼Œå®¹æ˜“å¯¼è‡´ç´¢å¼•å ç”¨ç©ºé—´è¾ƒå¤§ã€‚</li>
<li>å°½é‡ä½¿ç”¨auto_incrementç”Ÿæˆä¸»é”®ã€‚å°½é‡ä¸è¦ä½¿ç”¨uuidåšä¸»é”®ï¼Œå› ä¸ºuuidä¸æ˜¯é¡ºåºæ’å…¥ã€‚</li>
<li>æœ€å¥½ä¸è¦ä½¿ç”¨ä¸šåŠ¡ä¸»é”®ï¼Œå› ä¸ºä¸šåŠ¡çš„å˜åŒ–ä¼šå¯¼è‡´ä¸»é”®å€¼çš„é¢‘ç¹ä¿®æ”¹ï¼Œä¸»é”®å€¼ä¸å»ºè®®ä¿®æ”¹ï¼Œå› ä¸ºä¸»é”®å€¼ä¿®æ”¹ï¼Œèšé›†ç´¢å¼•ä¸€å®šä¼šé‡æ–°æ’åºã€‚</li>
<li>åœ¨æ’å…¥æ•°æ®æ—¶ï¼Œä¸»é”®å€¼æœ€å¥½æ˜¯é¡ºåºæ’å…¥ï¼Œä¸è¦ä¹±åºæ’å…¥ï¼Œå› ä¸ºä¹±åºæ’å…¥å¯èƒ½ä¼šå¯¼è‡´B+æ ‘å¶å­ç»“ç‚¹é¢‘ç¹çš„è¿›è¡Œé¡µåˆ†è£‚ä¸é¡µåˆå¹¶æ“ä½œï¼Œæ•ˆç‡è¾ƒä½ã€‚<ol>
<li>ä¸»é”®å€¼å¯¹åº”èšé›†ç´¢å¼•ï¼Œæ’å…¥ä¸»é”®å€¼å¦‚æœæ˜¯ä¹±åºçš„ï¼ŒB+æ ‘å¶å­ç»“ç‚¹éœ€è¦ä¸æ–­çš„é‡æ–°æ’åºï¼Œé‡æ’è¿‡ç¨‹ä¸­è¿˜ä¼šé¢‘ç¹æ¶‰åŠåˆ°<strong>é¡µåˆ†è£‚å’Œé¡µåˆå¹¶</strong>çš„æ“ä½œï¼Œæ•ˆç‡è¾ƒä½ã€‚</li>
<li>B+æ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å­˜å‚¨åœ¨é¡µï¼ˆpageï¼‰ä¸­ã€‚ä¸€ä¸ªé¡µé¢ä¸­å­˜å‚¨ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>MySQLçš„InnoDBå­˜å‚¨å¼•æ“ä¸€ä¸ªé¡µå¯ä»¥å­˜å‚¨16KBçš„æ•°æ®ã€‚</li>
<li>å¦‚æœä¸»é”®å€¼ä¸æ˜¯é¡ºåºæ’å…¥çš„è¯ï¼Œä¼šå¯¼è‡´é¢‘ç¹çš„é¡µåˆ†è£‚å’Œé¡µåˆå¹¶ã€‚åœ¨ä¸€ä¸ªB+æ ‘ä¸­ï¼Œé¡µåˆ†è£‚å’Œé¡µåˆå¹¶æ˜¯æ ‘çš„è‡ªåŠ¨è°ƒæ•´æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚å½“ä¸€ä¸ªé¡µå·²ç»æ»¡äº†ï¼Œå†æ’å…¥ä¸€ä¸ªæ–°çš„å…³é”®å­—æ—¶å°±ä¼šè§¦å‘é¡µåˆ†è£‚æ“ä½œï¼Œå°†é¡µä¸­çš„å…³é”®å­—åˆ†é…åˆ°ä¸¤ä¸ªæ–°çš„é¡µä¸­ï¼ŒåŒæ—¶è°ƒæ•´æ ‘çš„ç»“æ„ã€‚ç›¸åï¼Œå½“ä¸€ä¸ªé¡µä¸­çš„å…³é”®å­—æ•°é‡ä¸‹é™åˆ°ä¸€ä¸ªé˜ˆå€¼ä»¥ä¸‹æ—¶ï¼Œå°±ä¼šè§¦å‘é¡µåˆå¹¶æ“ä½œï¼Œå°†ä¸¤ä¸ªç›¸é‚»çš„é¡µåˆå¹¶æˆä¸€ä¸ªæ–°çš„é¡µã€‚å¦‚æœä¸»é”®å€¼æ˜¯éšæœºçš„ã€ä¸æ˜¯é¡ºåºæ’å…¥çš„ï¼Œé‚£ä¹ˆé¡µçš„åˆ©ç”¨ç‡ä¼šé™ä½ï¼Œé¡µåˆ†è£‚å’Œé¡µåˆå¹¶çš„æ¬¡æ•°å°±ä¼šå¢åŠ ã€‚ç”±äºé¡µçš„åˆ†è£‚å’Œåˆå¹¶æ˜¯æ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œé¢‘ç¹çš„åˆ†è£‚å’Œåˆå¹¶ä¼šé™ä½æ•°æ®åº“ç³»ç»Ÿçš„æ€§èƒ½ã€‚å› æ­¤ï¼Œä¸ºäº†ä¼˜åŒ–B+æ ‘çš„æ€§èƒ½ï¼Œå¯ä»¥å°†ä¸»é”®å€¼è®¾è®¡æˆé¡ºåºæ’å…¥çš„ï¼Œè¿™æ ·å¯ä»¥å‡å°‘é¡µçš„åˆ†è£‚å’Œåˆå¹¶çš„æ¬¡æ•°ï¼Œæé«˜B+æ ‘çš„æ€§èƒ½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœå¯¹ä¸»é”®å€¼çš„é¡ºåºæ€§èƒ½è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¥å‡å°‘é¡µåˆ†è£‚å’Œåˆå¹¶ï¼Œä¾‹å¦‚B+æ ‘åˆ†è£‚æ—¶é‡‡ç”¨â€œå»¶è¿Ÿåˆ†è£‚â€æŠ€æœ¯ï¼Œæˆ–è€…é€šè¿‡è°ƒæ•´é¡µçš„å¤§å°å’ŒèŠ‚ç‚¹çš„å¤§å°ç­‰æ–¹å¼æ¥ä¼˜åŒ–B+æ ‘çš„æ€§èƒ½ã€‚</li>
</ol>
</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E5%BB%B6%E8%BF%9F%E5%88%86%E8%A3%82%E6%8A%80%E6%9C%AF.jpeg" alt="å»¶è¿Ÿåˆ†è£‚æŠ€æœ¯" style="zoom: 25%;">

<h2 id="4-5-insertä¼˜åŒ–"><a href="#4-5-insertä¼˜åŒ–" class="headerlink" title="4.5 insertä¼˜åŒ–"></a>4.5 insertä¼˜åŒ–</h2><p>insertä¼˜åŒ–åŸåˆ™ï¼š</p>
<ul>
<li><p>æ‰¹é‡æ’å…¥ï¼šæ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä¸è¦ä¸€æ¡ä¸€æ¡æ’å…¥ï¼Œå¯ä»¥æ‰¹é‡æ’å…¥ï¼Œå½“ç„¶ï¼Œå»ºè®®ä¸€æ¬¡æ’å…¥æ•°æ®ä¸è¶…è¿‡1000æ¡ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_user(id,name,age) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="number">20</span>),(<span class="number">2</span>,<span class="string">&#x27;lucy&#x27;</span>,<span class="number">30</span>),(<span class="number">3</span>,<span class="string">&#x27;timi&#x27;</span>,<span class="number">22</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>mysqlé»˜è®¤æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œåªè¦æ‰§è¡Œä¸€æ¡DMLè¯­å¥å°±è‡ªåŠ¨æäº¤ä¸€æ¬¡ï¼Œå› æ­¤ï¼Œå½“æ’å…¥å¤§é‡æ•°æ®æ—¶ï¼Œå»ºè®®æ‰‹åŠ¨å¼€å¯äº‹åŠ¡å’Œæ‰‹åŠ¨æäº¤äº‹åŠ¡ã€‚ä¸å»ºè®®ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡è‡ªåŠ¨æäº¤æœºåˆ¶ã€‚</p>
</li>
<li><p>ä¸»é”®å€¼å»ºè®®é‡‡ç”¨é¡ºåºæ’å…¥ï¼Œé¡ºåºæ’å…¥æ¯”ä¹±åºæ’å…¥æ•ˆç‡é«˜ã€‚</p>
</li>
<li><p>è¶…å¤§æ•°æ®é‡æ’å…¥å¯ä»¥è€ƒè™‘ä½¿ç”¨mysqlæä¾›çš„loadæŒ‡ä»¤ï¼ŒloadæŒ‡ä»¤å¯ä»¥å°†csvæ–‡ä»¶ä¸­çš„æ•°æ®æ‰¹é‡å¯¼å…¥åˆ°æ•°æ®åº“è¡¨å½“ä¸­ï¼Œå¹¶ä¸”æ•ˆç‡å¾ˆé«˜ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p> 1ã€ç™»å½•mysqlæ—¶æŒ‡å®šå‚æ•°</p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="comment">--local-infile -uroot -proot</span></span><br></pre></td></tr></table></figure>

<p> 2ã€å¼€å¯local_infileåŠŸèƒ½</p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> local_infile <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p> 3ã€æ‰§è¡ŒloadæŒ‡ä»¤</p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">use muyoukule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_temp(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  password <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  birth <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">  email <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">load data <span class="keyword">local</span> infile <span class="string">&#x27;D:\\muyoukule.csv&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_temp fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span> lines terminated <span class="keyword">by</span> <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p> æ–‡ä»¶ä¸­çš„æ•°æ®å¦‚ä¸‹ï¼š</p>
<p> <img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/muyoukule.csv%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE.png" alt="muyoukule.csvæ–‡ä»¶ä¸­çš„æ•°æ®"></p>
<p> å¯¼å…¥è¡¨ä¸­ä¹‹åï¼Œæ•°æ®å¦‚ä¸‹ï¼š</p>
<p> <img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/muyoukule.csv%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E8%A1%A8%E4%B8%AD.png" alt="muyoukule.csvæ–‡ä»¶ä¸­çš„æ•°æ®å¯¼å…¥è¡¨ä¸­"></p>
</li>
</ul>
<h2 id="4-6-count-ä¼˜åŒ–"><a href="#4-6-count-ä¼˜åŒ–" class="headerlink" title="4.6 count(*)ä¼˜åŒ–"></a>4.6 count(*)ä¼˜åŒ–</h2><p>åˆ†ç»„å‡½æ•°countçš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<ul>
<li>count(ä¸»é”®)<ul>
<li>åŸç†ï¼šå°†æ¯ä¸ªä¸»é”®å€¼å–å‡ºï¼Œç´¯åŠ </li>
</ul>
</li>
<li>count(å¸¸é‡å€¼)<ul>
<li>åŸç†ï¼šè·å–åˆ°æ¯ä¸ªå¸¸é‡å€¼ï¼Œç´¯åŠ </li>
</ul>
</li>
<li>count(å­—æ®µ)<ul>
<li>åŸç†ï¼šå–å‡ºå­—æ®µçš„æ¯ä¸ªå€¼ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºNULLï¼Œä¸ä¸ºNULLåˆ™ç´¯åŠ ã€‚</li>
</ul>
</li>
<li>count(*)<ul>
<li>åŸç†ï¼šä¸ç”¨å–å€¼ï¼Œåº•å±‚mysqlåšäº†ä¼˜åŒ–ï¼Œç›´æ¥ç»Ÿè®¡æ€»è¡Œæ•°ï¼Œæ•ˆç‡æœ€é«˜ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç»“è®ºï¼šå¦‚æœä½ è¦ç»Ÿè®¡ä¸€å¼ è¡¨ä¸­æ•°æ®çš„æ€»è¡Œæ•°ï¼Œå»ºè®®ä½¿ç”¨ count(*)</strong></p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>å¯¹äºInnoDBå­˜å‚¨å¼•æ“æ¥è¯´ï¼Œcountè®¡æ•°çš„å®ç°åŸç†å°±æ˜¯å°†è¡¨ä¸­æ¯ä¸€æ¡è®°å½•å–å‡ºï¼Œç„¶åç´¯åŠ ã€‚å¦‚æœä½ æƒ³çœŸæ­£æé«˜æ•ˆç‡ï¼Œå¯ä»¥è‡ªå·±ä½¿ç”¨é¢å¤–çš„å…¶ä»–ç¨‹åºæ¥å®ç°ï¼Œä¾‹å¦‚æ¯å‘è¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•æ—¶ï¼Œåœ¨redisæ•°æ®åº“ä¸­ç»´æŠ¤ä¸€ä¸ªæ€»è¡Œæ•°ï¼Œè¿™æ ·è·å–æ€»è¡Œæ•°çš„æ—¶å€™ï¼Œç›´æ¥ä»redisä¸­è·å–å³å¯ï¼Œè¿™æ ·æ•ˆç‡æ˜¯æœ€é«˜çš„ã€‚</li>
<li>å¯¹äºMyISAMå­˜å‚¨å¼•æ“æ¥è¯´ï¼Œå½“ä¸€ä¸ªselectè¯­å¥æ²¡æœ‰whereæ¡ä»¶æ—¶ï¼Œè·å–æ€»è¡Œæ•°æ•ˆç‡æ˜¯æé«˜çš„ï¼Œä¸éœ€è¦ç»Ÿè®¡ï¼Œå› ä¸ºMyISAMå­˜å‚¨å¼•æ“ç»´æŠ¤äº†ä¸€ä¸ªå•ç‹¬çš„æ€»è¡Œæ•°ã€‚</li>
</ul>
<h2 id="4-7-updateä¼˜åŒ–"><a href="#4-7-updateä¼˜åŒ–" class="headerlink" title="4.7 updateä¼˜åŒ–"></a>4.7 updateä¼˜åŒ–</h2><p>å½“å­˜å‚¨å¼•æ“æ˜¯InnoDBæ—¶ï¼Œè¡¨çš„è¡Œçº§é”æ˜¯é’ˆå¯¹ç´¢å¼•æ·»åŠ çš„é”ï¼Œå¦‚æœç´¢å¼•å¤±æ•ˆäº†ï¼Œæˆ–è€…ä¸æ˜¯ç´¢å¼•åˆ—æ—¶ï¼Œä¼šæå‡ä¸ºè¡¨çº§é”ã€‚<br>ä»€ä¹ˆæ˜¯è¡Œçº§é”ï¼ŸAäº‹åŠ¡å’ŒBäº‹åŠ¡ï¼Œå¼€å¯Aäº‹åŠ¡åï¼Œé€šè¿‡Aäº‹åŠ¡ä¿®æ”¹è¡¨ä¸­æŸæ¡è®°å½•ï¼Œä¿®æ”¹åï¼Œåœ¨Aäº‹åŠ¡æœªæäº¤çš„å‰æä¸‹ï¼ŒBäº‹åŠ¡å»ä¿®æ”¹åŒä¸€æ¡è®°å½•æ—¶ï¼Œæ— æ³•ç»§ç»­ï¼Œç›´åˆ°Aäº‹åŠ¡æäº¤ï¼ŒBäº‹åŠ¡æ‰å¯ä»¥ç»§ç»­ã€‚</p>
<p>æœ‰ä¸€å¼ è¡¨ï¼št_fruit</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_fruit(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_fruit <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;è‹¹æœ&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_fruit <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;é¦™è•‰&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_fruit <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;æ©˜å­&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>å¼€å¯Aäº‹åŠ¡å’ŒBäº‹åŠ¡ï¼Œæ¼”ç¤ºè¡Œçº§é”ï¼š</p>
<p>äº‹åŠ¡Aæ²¡æœ‰ç»“æŸä¹‹å‰ï¼Œäº‹åŠ¡Bå¡ä½ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BA%8B%E5%8A%A1A%E6%B2%A1%E6%9C%89%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%89%8D%EF%BC%8C%E4%BA%8B%E5%8A%A1B%E5%8D%A1%E4%BD%8F.png" alt="äº‹åŠ¡Aæ²¡æœ‰ç»“æŸä¹‹å‰ï¼Œäº‹åŠ¡Bå¡ä½"></p>
<p>äº‹åŠ¡Aç»“æŸä¹‹åï¼Œäº‹åŠ¡Bç»§ç»­æ‰§è¡Œï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E4%BA%8B%E5%8A%A1A%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E%EF%BC%8C%E4%BA%8B%E5%8A%A1B%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C.png" alt="äº‹åŠ¡Aç»“æŸä¹‹åï¼Œäº‹åŠ¡Bç»§ç»­æ‰§è¡Œ"></p>
<p>å½“ç„¶ï¼Œå¦‚æœæ›´æ–°çš„ä¸æ˜¯åŒä¸€è¡Œæ•°æ®ï¼Œäº‹åŠ¡Aå’Œäº‹åŠ¡Bå¯ä»¥å¹¶å‘ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E6%9B%B4%E6%96%B0%E7%9A%84%E4%B8%8D%E6%98%AF%E5%90%8C%E4%B8%80%E8%A1%8C%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BA%8B%E5%8A%A1A%E5%92%8C%E4%BA%8B%E5%8A%A1B%E5%8F%AF%E4%BB%A5%E5%B9%B6%E5%8F%91.png" alt="æ›´æ–°çš„ä¸æ˜¯åŒä¸€è¡Œæ•°æ®ï¼Œäº‹åŠ¡Aå’Œäº‹åŠ¡Bå¯ä»¥å¹¶å‘"></p>
<p>è¡Œçº§é”æ˜¯å¯¹ç´¢å¼•åˆ—åŠ é”ï¼Œä»¥ä¸Šæ›´æ–°è¯­å¥çš„whereæ¡ä»¶æ˜¯idï¼Œidæ˜¯ä¸»é”®ï¼Œå½“ç„¶æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ä½¿ç”¨äº†è¡Œçº§é”ï¼Œå¦‚æœç´¢å¼•å¤±æ•ˆï¼Œæˆ–è€…å­—æ®µä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œåˆ™ä¼šå‡çº§ä¸ºè¡¨çº§é”ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/DBIMG/MySQL/%E8%A1%A8%E7%BA%A7%E9%94%81.png" alt="è¡¨çº§é”"></p>
<p>å› æ­¤ï¼Œä¸ºäº†æ›´æ–°çš„æ•ˆç‡ï¼Œå»ºè®®updateè¯­å¥ä¸­whereæ¡ä»¶ä¸­çš„å­—æ®µæ˜¯æ·»åŠ ç´¢å¼•çš„ã€‚</p>
]]></content>
      <categories>
        <category>DB</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>å›½äº§&quot;çŒ›ç”·&quot;â€”â€”MyBatis-Plus</title>
    <url>/posts/Mybatis-Plus/</url>
    <content><![CDATA[<p>MyBatis-Pluså®˜ç½‘ 1 ï¼š<a href="https://baomidou.com/">https://baomidou.com/</a></p>
<p>MyBatis-Pluså®˜ç½‘ 2ï¼š<a href="https://mybatis.plus/">https://mybatis.plus/</a></p>
<h1 id="1-MyBatis-Plus-æ¦‚è¿°"><a href="#1-MyBatis-Plus-æ¦‚è¿°" class="headerlink" title="1. MyBatis-Plus æ¦‚è¿°"></a>1. MyBatis-Plus æ¦‚è¿°</h1><h2 id="1-1-ä¸ºä»€ä¹ˆè¦å­¦ï¼Ÿ"><a href="#1-1-ä¸ºä»€ä¹ˆè¦å­¦ï¼Ÿ" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆè¦å­¦ï¼Ÿ"></a>1.1 ä¸ºä»€ä¹ˆè¦å­¦ï¼Ÿ</h2><p><del>MyBatis-Plusåªéœ€ç®€å•é…ç½®å³å¯å¿«é€Ÿè¿›è¡Œå•è¡¨ CRUD æ“ä½œï¼Œç®€å•çš„ CRUD æ“ä½œä¸å†éœ€è¦æˆ‘ä»¬ä¹¦å†™ã€‚ï¼ˆè‚¯å®šä¸æ˜¯å› ä¸ºè¿™ä¸ªï¼‰</del></p>
<p>MyBatis-Plus ç”±å›½äººå¼€å‘ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»†æ˜“ä¸Šæ‰‹ï¼Œç¼–ç ç¬¦åˆå›½äººä¹ æƒ¯ï¼Œå¹¶ä¸”å·²è¿ç»­ 5 å¹´ï¼ˆ2017ã€2018 ã€2019ã€2020ã€2021ï¼‰è·å¾—â€OSC å¹´åº¦æœ€å—æ¬¢è¿ä¸­å›½å¼€æºè½¯ä»¶â€æ®Šè£ã€‚æœ€æœ€æœ€é‡è¦çš„æ˜¯å®˜æ–¹ä¸ºæˆ‘ä»¬æä¾›äº†è‡ªåŠ¨ç”Ÿæˆä»£ç çš„ä»£ç ç”Ÿæˆå™¨â€¦çœŸçš„æ˜¯å¤ªè´´å¿ƒäº†ï¼ï¼ğŸ¤©è¿™ä¸å°±ç›¸å½“äºæ˜¯åˆ«äººéƒ½æŠŠé¥­å–‚ä½ å˜´é‡Œäº†å—ï¼Ÿä½ è¿˜æœ‰ä»€ä¹ˆç†ç”±ä¸åƒå‘¢ï¼ŸğŸ˜‚</p>
<p><strong>PSï¼šæœ¬æ–‡ä¸­ï¼ŒMP æ˜¯ MyBatis-Plus çš„ç®€å†™ã€‚</strong></p>
<h2 id="1-2-ç®€ä»‹"><a href="#1-2-ç®€ä»‹" class="headerlink" title="1.2 ç®€ä»‹"></a>1.2 ç®€ä»‹</h2><p><a href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus</a>ï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª <a href="https://www.mybatis.org/mybatis-3/">MyBatis</a> çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/MyBatis-Plus%E7%AE%80%E4%BB%8B.png" alt="MyBatis-Plusç®€ä»‹"></p>
<p>ä»è¿™å¼ å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡º MP æ—¨åœ¨æˆä¸º MyBatis çš„æœ€å¥½æ­æ¡£ï¼Œè€Œä¸æ˜¯æ›¿æ¢ MyBatis ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸º MP æ˜¯ MyBatis çš„ä¸€å¥—å¢å¼ºå·¥å…·ï¼Œå®ƒæ˜¯åœ¨ MyBatis çš„åŸºç¡€ä¸Šè¿›è¡Œå¼€å‘çš„ï¼Œæˆ‘ä»¬è™½ç„¶ä½¿ç”¨ MP ä½†æ˜¯åº•å±‚ä¾ç„¶æ˜¯ MyBatis çš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ MP ä¸­å†™ MyBatis çš„å†…å®¹ã€‚</p>
<p><strong>PSï¼šä½¿ç”¨ MP å¯ä»¥èŠ‚çœä»£ç çš„ç¼–å†™ï¼Œå°½é‡ <font color="red">ä¸è¦åŒæ—¶</font> å¯¼å…¥ MP å’Œ MyBatisï¼Œé¿å…å­˜åœ¨ä¾èµ–é”™è¯¯ã€‚</strong></p>
<h2 id="1-3-ç‰¹æ€§"><a href="#1-3-ç‰¹æ€§" class="headerlink" title="1.3 ç‰¹æ€§"></a>1.3 ç‰¹æ€§</h2><ul>
<li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li>
<li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li>
<li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚ï¼ˆ  <font color="red">è¨€å¤–ä¹‹æ„ï¼Œç®€å•çš„ CRUD æ“ä½œä¸å†éœ€è¦æˆ‘ä»¬ä¹¦å†™</font>  ï¼‰</li>
<li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li>
<li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥(å†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequence)ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li>
<li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li>
<li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥( Write once, use anywhere )</li>
<li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li>
<li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li>
<li><strong>åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li>
<li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º SQL è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li>
<li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li>
</ul>
<h1 id="2-å¿«é€Ÿå¼€å§‹"><a href="#2-å¿«é€Ÿå¼€å§‹" class="headerlink" title="2. å¿«é€Ÿå¼€å§‹"></a>2. å¿«é€Ÿå¼€å§‹</h1><p>æ¥ä¸‹æ¥å°†é€šè¿‡ä¸€ä¸ªç®€å•çš„ Demo æ¥é˜è¿° MP çš„å¼ºå¤§åŠŸèƒ½ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå‡è®¾ä½ å·²ç»ï¼š</p>
<ul>
<li>æ‹¥æœ‰ Java å¼€å‘ç¯å¢ƒä»¥åŠç›¸åº” IDE</li>
<li>ç†Ÿæ‚‰ Spring Boot</li>
<li>ç†Ÿæ‚‰ Maven</li>
</ul>
<h2 id="2-1-ç¯å¢ƒå‡†å¤‡"><a href="#2-1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="2.1 ç¯å¢ƒå‡†å¤‡"></a>2.1 ç¯å¢ƒå‡†å¤‡</h2><p>ç°æœ‰ä¸€å¼  <code>User</code> è¡¨ï¼Œå…¶è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">name</th>
<th align="center">age</th>
<th align="center">email</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">Jone</td>
<td align="center">18</td>
<td align="center"><a href="mailto:&#x74;&#x65;&#x73;&#116;&#x31;&#64;&#x62;&#x61;&#111;&#109;&#105;&#100;&#111;&#x75;&#46;&#99;&#111;&#109;">&#x74;&#x65;&#x73;&#116;&#x31;&#64;&#x62;&#x61;&#111;&#109;&#105;&#100;&#111;&#x75;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">Jack</td>
<td align="center">20</td>
<td align="center"><a href="mailto:&#116;&#101;&#115;&#x74;&#x32;&#64;&#98;&#97;&#111;&#109;&#105;&#100;&#111;&#117;&#x2e;&#x63;&#x6f;&#109;">&#116;&#101;&#115;&#x74;&#x32;&#64;&#98;&#97;&#111;&#109;&#105;&#100;&#111;&#117;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">Tom</td>
<td align="center">28</td>
<td align="center"><a href="mailto:&#116;&#x65;&#x73;&#x74;&#51;&#64;&#x62;&#x61;&#111;&#x6d;&#x69;&#x64;&#x6f;&#x75;&#x2e;&#x63;&#x6f;&#109;">&#116;&#x65;&#x73;&#x74;&#51;&#64;&#x62;&#x61;&#111;&#x6d;&#x69;&#x64;&#x6f;&#x75;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">Sandy</td>
<td align="center">21</td>
<td align="center"><a href="mailto:&#x74;&#x65;&#x73;&#116;&#x34;&#64;&#x62;&#x61;&#x6f;&#109;&#x69;&#x64;&#111;&#117;&#46;&#99;&#111;&#x6d;">&#x74;&#x65;&#x73;&#116;&#x34;&#64;&#x62;&#x61;&#x6f;&#109;&#x69;&#x64;&#111;&#117;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">Billie</td>
<td align="center">24</td>
<td align="center"><a href="mailto:&#116;&#x65;&#x73;&#x74;&#53;&#x40;&#x62;&#97;&#x6f;&#109;&#105;&#x64;&#111;&#117;&#46;&#x63;&#x6f;&#109;">&#116;&#x65;&#x73;&#x74;&#53;&#x40;&#x62;&#97;&#x6f;&#109;&#105;&#x64;&#111;&#117;&#46;&#x63;&#x6f;&#109;</a></td>
</tr>
</tbody></table>
<blockquote>
<p>æ­¥éª¤</p>
</blockquote>
<p>1ã€åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ <code>mybatis_plus</code></p>
<p>2ã€åˆ›å»º user è¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `<span class="keyword">user</span>`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>`</span><br><span class="line">(</span><br><span class="line">    id <span class="type">BIGINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸»é”®ID&#x27;</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `<span class="keyword">user</span>`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` (id, name, age, email) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;Jone&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;test1@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;test2@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;test3@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;Sandy&#x27;</span>, <span class="number">21</span>, <span class="string">&#x27;test4@baomidou.com&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;Billie&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;test5@baomidou.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%88%9B%E5%BB%BAUser%E8%A1%A8.png" alt="åˆ›å»ºUserè¡¨"></p>
<p>3ã€ä½¿ç”¨ IDEA åˆå§‹åŒ–ä¸€ä¸ª SpringBoot é¡¹ç›® mybatis_plusï¼Œé€‰æ‹© Spring Web å’Œ Lombok ä¾èµ–è¿›è¡Œå¯¼å…¥ã€‚</p>
<p>4ã€å¯¼å…¥å…¶ä»–ä¾èµ–</p>
<p>ç”±äºè¿™ä¸ª <code>mybatis-plus-boot-starter</code> åŒ…å«å¯¹ Mybatis çš„è‡ªåŠ¨è£…é…ï¼Œå› æ­¤å®Œå…¨å¯ä»¥æ›¿æ¢æ‰ Mybatis çš„ starter ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ•°æ®åº“é©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mybatis-plus--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>PSï¼šæ³¨æ„ SpringBoot ç‰ˆæœ¬è¦ä¸ Mybatis-Plus ç‰ˆæœ¬ç›¸å¯¹åº”</strong></font></p>
<p>5ã€ç¼–å†™é…ç½®æ–‡ä»¶ <code>application.yml</code> è¿æ¥æ•°æ®åº“</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis_plus?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>6ã€ç¼–å†™å®ä½“ç±» <code>User.java</code> (æ­¤å¤„ä½¿ç”¨äº† <a href="https://www.projectlombok.org/">Lombok</a> ç®€åŒ–ä»£ç )</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName(&quot;`user`&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>7ã€ç¼–å†™ Mapper åŒ…ä¸‹çš„ <code>UserMapper</code>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>8ã€åœ¨ Spring Boot å¯åŠ¨ç±»ä¸­æ·»åŠ  <code>@MapperScan</code> æ³¨è§£ï¼Œæ‰«æ Mapper æ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="comment">// æ‰«æ mapper æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.muyoukule.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MybatisPlusApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-æ ‡å‡†CRUDä½¿ç”¨"><a href="#2-2-æ ‡å‡†CRUDä½¿ç”¨" class="headerlink" title="2.2 æ ‡å‡†CRUDä½¿ç”¨"></a>2.2 æ ‡å‡†CRUDä½¿ç”¨</h2><p>å¯¹äºæ ‡å‡†çš„ CRUD åŠŸèƒ½ MP éƒ½æä¾›äº†å“ªäº›æ–¹æ³•å¯ä»¥ä½¿ç”¨å‘¢ï¼Ÿ</p>
<blockquote>
<p>æ–°å¢ Insert</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">insert</span><span class="params">(T t)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Tï¼šæ³›å‹ï¼Œæ–°å¢ç”¨æ¥ä¿å­˜æ–°å¢æ•°æ®</p>
</li>
<li><p>intï¼šè¿”å›å€¼ï¼Œæ–°å¢æˆåŠŸåè¿”å›1ï¼Œæ²¡æœ‰æ–°å¢æˆåŠŸè¿”å›çš„æ˜¯0</p>
</li>
</ul>
<p>åœ¨æµ‹è¯•ç±»ä¸­è¿›è¡Œæ–°å¢æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MybatisPlusApplicationTests</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰æ’å…¥id</span></span><br><span class="line">        user.setName(<span class="string">&quot;æœ¨åˆæ¯äº†&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;example@gmail.com&quot;</span>);</span><br><span class="line">        <span class="comment">// å—å½±å“çš„è¡Œæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> userMapper.insert(user);</span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜æ•°æ®æ’å…¥æˆåŠŸï¼Œè¿™æ—¶å€™åˆ°æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œæ•°æ®åº“è¡¨ä¸­å°±ä¼šæ·»åŠ ä¸€æ¡æ•°æ®ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE.png" alt="æ’å…¥ä¸€æ¡æ•°æ®"></p>
<p>ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼šæˆ‘ä»¬æ˜æ˜æ²¡æœ‰è®¾ç½® IDï¼Œæ’å…¥æ—¶å±…ç„¶è‡ªåŠ¨ç”Ÿæˆäº† IDï¼Œè€Œä¸”ç”Ÿæˆçš„ ID ä¼¼ä¹æœ‰ç‚¹ â€œ å¥‡æ€ª â€ã€‚é‚£è¿™ä¸ªä¸»é”® ID æ˜¯å¦‚ä½•æ¥çš„ï¼Ÿæˆ‘ä»¬æ›´æƒ³è¦çš„æ˜¯ä¸»é”®è‡ªå¢ï¼Œåº”è¯¥æ˜¯ 6 æ‰å¯¹ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬åé¢è¦å­¦ä¹ çš„ <strong>ä¸»é”®ç”Ÿæˆç­–ç•¥</strong>ï¼Œè¿™å—çš„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æš‚æ—¶å…ˆæ”¾æ”¾ã€‚</p>
<blockquote>
<p>åˆ é™¤ Delete</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">deleteById</span> <span class="params">(Serializable id)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Serializableï¼šå‚æ•°ç±»å‹</li>
<li>intï¼šè¿”å›å€¼ç±»å‹ï¼Œæ•°æ®åˆ é™¤æˆåŠŸè¿”å› 1ï¼Œæœªåˆ é™¤æ•°æ®è¿”å› 0</li>
</ul>
<p>æ€è€ƒï¼šå‚æ•°ç±»å‹ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªåºåˆ—åŒ–ç±»ï¼Ÿ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/Serializable%E5%85%B3%E7%B3%BB%E5%9B%BE.png" alt="Serializableå…³ç³»å›¾" style="zoom:67%;">

<p>ä»è¿™å¼ å›¾å¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>String å’Œ Number æ˜¯ Serializable çš„å­ç±»</li>
<li>Number åˆæ˜¯ Floatï¼ŒDoubleï¼ŒInteger ç­‰ç±»çš„çˆ¶ç±»</li>
<li>èƒ½ä½œä¸ºä¸»é”®çš„æ•°æ®ç±»å‹éƒ½å·²ç»æ˜¯ Serializable çš„å­ç±»</li>
<li>MP ä½¿ç”¨ Serializable ä½œä¸ºå‚æ•°ç±»å‹ï¼Œå°±å¥½æ¯”æˆ‘ä»¬å¯ä»¥ç”¨ Object æ¥æ”¶ä»»ä½•æ•°æ®ç±»å‹ä¸€æ ·ã€‚</li>
</ul>
<p>åœ¨æµ‹è¯•ç±»ä¸­è¿›è¡Œåˆ é™¤æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> userMapper.deleteById(<span class="number">1775096675078713345L</span>);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜æ•°æ®åˆ é™¤å…¥æˆåŠŸï¼Œè¿™æ—¶å€™åˆ°æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œæ•°æ®åº“è¡¨ä¸­ ID ä¸º <code>1775096675078713345</code> çš„æ•°æ®å°±ä¼šè¢«åˆ é™¤ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%88%A0%E9%99%A4%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE.png" alt="åˆ é™¤ä¸€æ¡æ•°æ®"></p>
<blockquote>
<p>ä¿®æ”¹ Update</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">updateById</span><span class="params">(T t)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Tï¼šæ³›å‹ï¼Œéœ€è¦ä¿®æ”¹çš„æ•°æ®å†…å®¹ï¼Œæ³¨æ„å› ä¸ºæ˜¯æ ¹æ® ID è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ä¼ å…¥çš„å¯¹è±¡ä¸­éœ€è¦æœ‰ ID å±æ€§å€¼</p>
</li>
<li><p>intï¼šè¿”å›å€¼ï¼Œä¿®æ”¹æˆåŠŸåè¿”å› 1ï¼Œæœªä¿®æ”¹æ•°æ®è¿”å› 0</p>
</li>
</ul>
<p>åœ¨æµ‹è¯•ç±»ä¸­è¿›è¡Œä¿®æ”¹æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setId(<span class="number">1L</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;Jone001&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> userMapper.updateById(user);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜æ•°æ®ä¿®æ”¹æˆåŠŸï¼Œè¿™æ—¶å€™åˆ°æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œå‘ç°ä¿®æ”¹æˆåŠŸï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E4%BF%AE%E6%94%B9%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE.png" alt="ä¿®æ”¹ä¸€æ¡æ•°æ®"></p>
<blockquote>
<p>æŸ¥è¯¢ Select</p>
</blockquote>
<p><strong>æ ¹æ® ID æŸ¥è¯¢</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">T <span class="title function_">selectById</span> <span class="params">(Serializable id)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Serializableï¼šå‚æ•°ç±»å‹ï¼Œä¸»é”® ID çš„å€¼</li>
<li>Tï¼šæ ¹æ® ID æŸ¥è¯¢åªä¼šè¿”å›ä¸€æ¡æ•°æ®</li>
</ul>
<p>åœ¨æµ‹è¯•ç±»ä¸­è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSelectById</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(id=1, name=Jone001, age=20, email=test1@baomidou.com)</span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥è¯¢æ‰€æœ‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;T&gt; <span class="title function_">selectList</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Wrapperï¼šç”¨æ¥æ„å»ºæ¡ä»¶æŸ¥è¯¢çš„æ¡ä»¶ï¼Œç›®å‰æˆ‘ä»¬æ²¡æœ‰å¯ç›´æ¥ä¼ ä¸º Null</li>
<li>List<T>ï¼šå› ä¸ºæŸ¥è¯¢çš„æ˜¯æ‰€æœ‰ï¼Œæ‰€ä»¥è¿”å›çš„æ•°æ®æ˜¯ä¸€ä¸ªé›†åˆ</T></li>
</ul>
<p>åœ¨æµ‹è¯•ç±»ä¸­è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSelectAll</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(id=1, name=Jone001, age=20, email=test1@baomidou.com)</span><br><span class="line">User(id=2, name=Jack, age=20, email=test2@baomidou.com)</span><br><span class="line">User(id=3, name=Tom, age=28, email=test3@baomidou.com)</span><br><span class="line">User(id=4, name=Sandy, age=21, email=test4@baomidou.com)</span><br><span class="line">User(id=5, name=Billie, age=24, email=test5@baomidou.com)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä»¥ä¸Šå‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å®ç°äº† User è¡¨çš„ CRUD åŠŸèƒ½ï¼Œç”šè‡³è¿ XML æ–‡ä»¶éƒ½ä¸ç”¨ç¼–å†™ï¼</p>
<p>ä¸Šé¢æˆ‘ä»¬åªæ˜¯ç»§æ‰¿äº† BaseMapper å°±çœå»æ‰€æœ‰çš„å•è¡¨ CRUDï¼Œæ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<p>å½“ç„¶æ˜¯ <code>BaseMapper </code> æ¥å£å…¶ä¸­å·²ç»å®ç°äº†å•è¡¨çš„ CRUDï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/BaseMapper%E6%8E%A5%E5%8F%A3.png" alt="BaseMapperæ¥å£" style="zoom:67%;">

<p>å› æ­¤æˆ‘ä»¬è‡ªå®šä¹‰çš„ Mapper åªè¦å®ç°äº†è¿™ä¸ª <code>BaseMapper</code>ï¼Œå°±æ— éœ€è‡ªå·±å®ç°å•è¡¨ CRUD äº†ã€‚</p>
<h1 id="3-é…ç½®æ—¥å¿—"><a href="#3-é…ç½®æ—¥å¿—" class="headerlink" title="3. é…ç½®æ—¥å¿—"></a>3. é…ç½®æ—¥å¿—</h1><p>ä½¿ç”¨ MP åï¼Œéƒ¨åˆ† SQL æ˜¯ä¸å¯è§çš„ï¼Œæˆ‘ä»¬å¸Œæœ›çŸ¥é“å®ƒæ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æŸ¥çœ‹æ—¥å¿—ï¼</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/MP%E9%85%8D%E7%BD%AE%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF.png" alt="MPé…ç½®æ—¥å¿—ä¿¡æ¯" style="zoom: 67%;">

<p>é…ç½®æ—¥å¿—åï¼Œåœ¨ä»¥åçš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ—¥å¿—ï¼Œè§‚å¯Ÿ MP çš„ SQL æ‰§è¡Œã€‚</p>
<h1 id="4-å¸¸è§æ³¨è§£"><a href="#4-å¸¸è§æ³¨è§£" class="headerlink" title="4. å¸¸è§æ³¨è§£"></a>4. å¸¸è§æ³¨è§£</h1><p>åœ¨åˆšåˆšçš„å…¥é—¨æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»…ä»…å¼•å…¥äº†ä¾èµ–ï¼Œç»§æ‰¿äº† BaseMapper å°±èƒ½ä½¿ç”¨ MP ï¼Œéå¸¸ç®€å•ã€‚</p>
<p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼š MP å¦‚ä½•çŸ¥é“æˆ‘ä»¬è¦æŸ¥è¯¢çš„æ˜¯å“ªå¼ è¡¨ï¼Ÿè¡¨ä¸­æœ‰å“ªäº›å­—æ®µå‘¢ï¼Ÿ</p>
<p>å¤§å®¶å›å¿†ä¸€ä¸‹ï¼ŒUserMapper åœ¨ç»§æ‰¿BaseMapper çš„æ—¶å€™æŒ‡å®šäº†ä¸€ä¸ªæ³›å‹ <code>User</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³›å‹ä¸­çš„ User å°±æ˜¯ä¸æ•°æ®åº“å¯¹åº”çš„ POã€‚</p>
<p>MP å°±æ˜¯æ ¹æ® POå®ä½“çš„ä¿¡æ¯æ¥æ¨æ–­å‡ºè¡¨çš„ä¿¡æ¯ï¼Œä»è€Œç”Ÿæˆ SQL çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li>MP ä¼šæŠŠ PO å®ä½“çš„ç±»åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨å</li>
<li>MP ä¼šæŠŠ PO å®ä½“çš„æ‰€æœ‰å˜é‡åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨çš„å­—æ®µåï¼Œå¹¶æ ¹æ®å˜é‡ç±»å‹æ¨æ–­å­—æ®µç±»å‹</li>
<li>MP ä¼šæŠŠåä¸º ID çš„å­—æ®µä½œä¸ºä¸»é”®</li>
</ul>
<p>ä½†å¾ˆå¤šæƒ…å†µä¸‹ï¼Œé»˜è®¤çš„å®ç°ä¸å®é™…åœºæ™¯ä¸ç¬¦ï¼Œå› æ­¤ MP æä¾›äº†ä¸€äº›æ³¨è§£ä¾¿äºæˆ‘ä»¬å£°æ˜è¡¨ä¿¡æ¯ã€‚</p>
<h2 id="4-1-TableName"><a href="#4-1-TableName" class="headerlink" title="4.1 @TableName"></a>4.1 @TableName</h2><ul>
<li>æè¿°ï¼šè¡¨åæ³¨è§£ï¼Œæ ‡è¯†å®ä½“ç±»å¯¹åº”çš„è¡¨</li>
<li>ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;sys_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TableName æ³¨è§£é™¤äº†æŒ‡å®šè¡¨åä»¥å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šå¾ˆå¤šå…¶å®ƒå±æ€§ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å±æ€§</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»æŒ‡å®š</th>
<th align="center">é»˜è®¤å€¼</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">value</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">â€œâ€</td>
<td align="center">è¡¨å</td>
</tr>
<tr>
<td align="center">schema</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">â€œâ€</td>
<td align="center">schema</td>
</tr>
<tr>
<td align="center">keepGlobalPrefix</td>
<td align="center">boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td align="center">æ˜¯å¦ä¿æŒä½¿ç”¨å…¨å±€çš„ tablePrefix çš„å€¼ï¼ˆå½“å…¨å±€ tablePrefix ç”Ÿæ•ˆæ—¶ï¼‰</td>
</tr>
<tr>
<td align="center">resultMap</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">â€œâ€</td>
<td align="center">xml ä¸­ resultMap çš„ idï¼ˆç”¨äºæ»¡è¶³ç‰¹å®šç±»å‹çš„å®ä½“ç±»å¯¹è±¡ç»‘å®šï¼‰</td>
</tr>
<tr>
<td align="center">autoResultMap</td>
<td align="center">boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td align="center">æ˜¯å¦è‡ªåŠ¨æ„å»º resultMap å¹¶ä½¿ç”¨ï¼ˆå¦‚æœè®¾ç½® resultMap åˆ™ä¸ä¼šè¿›è¡Œ resultMap çš„è‡ªåŠ¨æ„å»ºä¸æ³¨å…¥ï¼‰</td>
</tr>
<tr>
<td align="center">excludeProperty</td>
<td align="center">String[]</td>
<td align="center">å¦</td>
<td align="center">{}</td>
<td align="center">éœ€è¦æ’é™¤çš„å±æ€§å @since 3.3.1</td>
</tr>
</tbody></table>
<h2 id="4-2-TableId"><a href="#4-2-TableId" class="headerlink" title="4.2 @TableId"></a>4.2 @TableId</h2><ul>
<li>æè¿°ï¼šä¸»é”®æ³¨è§£</li>
<li>ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»ä¸»é”®å­—æ®µ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;sys_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@TableId</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>TableId </code>æ³¨è§£æ”¯æŒä¸¤ä¸ªå±æ€§ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å±æ€§</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»æŒ‡å®š</th>
<th align="center">é»˜è®¤å€¼</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">value</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">â€œâ€</td>
<td align="center">è¡¨å</td>
</tr>
<tr>
<td align="center">type</td>
<td align="center">Enum</td>
<td align="center">å¦</td>
<td align="center">IdType.NONE</td>
<td align="center">æŒ‡å®šä¸»é”®ç±»å‹</td>
</tr>
</tbody></table>
<p><code>IdType </code>æ”¯æŒçš„ç±»å‹æœ‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å€¼</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">AUTO</td>
<td align="center">æ•°æ®åº“ ID è‡ªå¢</td>
</tr>
<tr>
<td align="center">NONE</td>
<td align="center">æ— çŠ¶æ€ï¼Œè¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹ï¼ˆæ³¨è§£é‡Œç­‰äºè·Ÿéšå…¨å±€ï¼Œå…¨å±€é‡Œçº¦ç­‰äº INPUTï¼‰</td>
</tr>
<tr>
<td align="center">INPUT</td>
<td align="center">insert å‰è‡ªè¡Œ set ä¸»é”®å€¼</td>
</tr>
<tr>
<td align="center">ASSIGN_ID</td>
<td align="center">åˆ†é… ID(ä¸»é”®ç±»å‹ä¸º Number(Long å’Œ Integer)æˆ– String)(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextId(é»˜è®¤å®ç°ç±»ä¸ºDefaultIdentifierGeneratoré›ªèŠ±ç®—æ³•)</td>
</tr>
<tr>
<td align="center">ASSIGN_UUID</td>
<td align="center">åˆ†é… UUID,ä¸»é”®ç±»å‹ä¸º String(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextUUID(é»˜è®¤ default æ–¹æ³•)</td>
</tr>
<tr>
<td align="center"><del>ID_WORKER</del></td>
<td align="center">åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID é•¿æ•´å‹ç±»å‹(please use ASSIGN_ID)</td>
</tr>
<tr>
<td align="center"><del>UUID</del></td>
<td align="center">32 ä½ UUID å­—ç¬¦ä¸²(please use ASSIGN_UUID)</td>
</tr>
<tr>
<td align="center"><del>ID_WORKER_STR</del></td>
<td align="center">åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID å­—ç¬¦ä¸²ç±»å‹(please use ASSIGN_ID)</td>
</tr>
</tbody></table>
<p>è¿™é‡Œæ¯”è¾ƒå¸¸è§çš„æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li><code>ASSIGN_ID</code>ï¼šé›ªèŠ±ç®—æ³•ç”Ÿæˆ<code>Long</code>ç±»å‹çš„å…¨å±€å”¯ä¸€IDï¼Œè¿™æ˜¯ MP <strong>é»˜è®¤</strong>çš„ ID ç­–ç•¥</li>
<li><code>AUTO</code>ï¼šåˆ©ç”¨æ•°æ®åº“çš„IDè‡ªå¢é•¿</li>
<li><code>INPUT</code>ï¼šæ‰‹åŠ¨ç”ŸæˆID</li>
</ul>
<h3 id="4-2-1-ä¸»é”®ç”Ÿæˆç­–ç•¥"><a href="#4-2-1-ä¸»é”®ç”Ÿæˆç­–ç•¥" class="headerlink" title="4.2.1 ä¸»é”®ç”Ÿæˆç­–ç•¥"></a>4.2.1 ä¸»é”®ç”Ÿæˆç­–ç•¥</h3><blockquote>
<p>é›ªèŠ±ç®—æ³•</p>
</blockquote>
<p>é›ªèŠ±ç®—æ³•(Snowflake)æ˜¯ Twitter å¼€æºçš„ä¸€ç§åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œå…¶ç”Ÿæˆçš„ ID å…·æœ‰å…¨å±€å”¯ä¸€æ€§ã€‚è¿™ç§ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°† 64 ä½çš„ Long å‹ ID åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šæ—¶é—´æˆ³ã€å·¥ä½œæœºå™¨IDã€æ•°æ®ä¸­å¿ƒIDå’Œåºåˆ—å·ã€‚</p>
<p>åœ¨ä¸Šé¢æˆ‘ä»¬è¿›è¡Œæ•°æ®æ’å…¥çš„æ—¶å€™ï¼Œç”±äºæœªå¯¹ä¸»é”®ç”Ÿæˆç­–ç•¥è¿›è¡Œé…ç½®ï¼Œè€Œ MP <strong>é»˜è®¤</strong>é‡‡ç”¨çš„ä½¿ç”¨ Twitter çš„ <code>é›ªèŠ±ç®—æ³•</code>ã€‚æ‰€ä»¥æ‰ä¼šçœ‹åˆ°ç”Ÿæˆäº†ä¸€é•¿ä¸²æ•°å­—ä½œä¸º IDã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE.png" alt="æ’å…¥ä¸€æ¡æ•°æ®"></p>
<blockquote>
<p>åˆ©ç”¨æ•°æ®åº“çš„ ID è‡ªå¢é•¿</p>
</blockquote>
<p>1ã€å®ä½“ç±»ä¸­è¡¨ç¤ºç»„ä»¶çš„å±æ€§ä¸Šæ·»åŠ æ³¨è§£ï¼š<code>@TableId(type = IdType.AUTO)</code></p>
<p>2ã€ <font color="red">æ•°æ®åº“å­—æ®µä¸€å®šè®¾ç½®ä¸ºè‡ªå¢</font>ğŸ˜€</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%97%E6%AE%B5%E4%B8%BA%E8%87%AA%E5%A2%9E.png" alt="è®¾ç½®æ•°æ®åº“å­—æ®µä¸ºè‡ªå¢" style="zoom:67%;">

<p>3ã€å†æ¬¡è¿è¡Œæ’å…¥æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/ID%E8%87%AA%E5%A2%9E%E9%95%BF%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE.png" alt="IDè‡ªå¢é•¿æ’å…¥æ•°æ®"></p>
<blockquote>
<p>æ‰‹åŠ¨ç”Ÿæˆ ID</p>
</blockquote>
<p>1ã€å®ä½“ç±»ä¸­è¡¨ç¤ºç»„ä»¶çš„å±æ€§ä¸Šæ·»åŠ æ³¨è§£ï¼š<code>@TableId(type = IdType.INPUT)</code></p>
<p>2ã€ä¿®æ”¹æµ‹è¯•ç±»ï¼Œæ‰‹åŠ¨è®¾ç½® ID</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setId(<span class="number">6L</span>); <span class="comment">// æ‰‹åŠ¨è®¾ç½® ID</span></span><br><span class="line">    user.setName(<span class="string">&quot;æœ¨åˆæ¯äº†&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    user.setEmail(<span class="string">&quot;example@gmail.com&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> userMapper.insert(user);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red">PSï¼šå¦‚æœæˆ‘ä»¬è®¾ç½®ç»„ä»¶ç”Ÿæˆç­–ç•¥ä¸ºæ‰‹åŠ¨è¾“å…¥ ï¼Œä½†æ˜¯æ²¡æœ‰è¾“å…¥ï¼Œè¿™ä¸ªæ—¶å€™æ—¥å¿—å°±ä¼šæ˜¾ç¤ºæ’å…¥çš„æ˜¯ <code>null</code>ï¼Œä½†æ˜¯æ•°æ®åº“ä¸­ä¹Ÿä¼šæ’å…¥ä¸€æ¡ ID è‡ªå¢çš„è®°å½•</font></p>
<p>3ã€å†æ¬¡è¿è¡Œæ’å…¥æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90ID%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE.png" alt="æ‰‹åŠ¨ç”ŸæˆIDæ’å…¥æ•°æ®"></p>
<h2 id="4-3-TableField"><a href="#4-3-TableField" class="headerlink" title="4.3 @TableField"></a>4.3 @TableField</h2><ul>
<li>æè¿°ï¼šå­—æ®µæ³¨è§£(éä¸»é”®)</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;sys_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@TableId</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="meta">@TableField(&quot;nickname&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸éœ€è¦ç»™å­—æ®µæ·»åŠ  <code>@TableField</code> æ³¨è§£ï¼Œä¸€äº›ç‰¹æ®Šæƒ…å†µé™¤å¤–ï¼š</p>
<ul>
<li>æˆå‘˜å˜é‡åä¸æ•°æ®åº“å­—æ®µåä¸ä¸€è‡´</li>
<li>æˆå‘˜å˜é‡æ˜¯ä»¥ <code>isXXX</code> å‘½åï¼ŒæŒ‰ç…§ <code>JavaBean</code> çš„è§„èŒƒï¼Œ<code>MP </code>è¯†åˆ«å­—æ®µæ—¶ä¼šæŠŠ <code>is</code> å»é™¤ï¼Œè¿™å°±å¯¼è‡´ä¸æ•°æ®åº“ä¸ç¬¦ã€‚</li>
<li>æˆå‘˜å˜é‡åä¸æ•°æ®åº“ä¸€è‡´ï¼Œä½†æ˜¯ä¸æ•°æ®åº“çš„å…³é”®å­—å†²çªã€‚ä½¿ç”¨ <code>@TableField</code> æ³¨è§£ç»™å­—æ®µåæ·»åŠ è½¬ä¹‰å­—ç¬¦ï¼š<code>``</code></li>
</ul>
<p>æ›´å¤šæ”¯æŒçš„å…¶å®ƒå±æ€§å¦‚ä¸‹è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://baomidou.com/pages/223848/#tablefield">@Tablefieldæ³¨è§£</a></p>
<h1 id="5-å¸¸è§é…ç½®"><a href="#5-å¸¸è§é…ç½®" class="headerlink" title="5. å¸¸è§é…ç½®"></a>5. å¸¸è§é…ç½®</h1><p>MP ä¹Ÿæ”¯æŒåŸºäº yml æ–‡ä»¶çš„è‡ªå®šä¹‰é…ç½®ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.baomidou.com/pages/56bac0/">ä½¿ç”¨é…ç½®</a></p>
<p>å¤§å¤šæ•°çš„é…ç½®éƒ½æœ‰é»˜è®¤å€¼ï¼Œå› æ­¤æˆ‘ä»¬éƒ½æ— éœ€é…ç½®ã€‚ä½†è¿˜æœ‰ä¸€äº›æ˜¯æ²¡æœ‰é»˜è®¤å€¼çš„ï¼Œä¾‹å¦‚:</p>
<ul>
<li>å®ä½“ç±»çš„åˆ«åæ‰«æåŒ…</li>
<li>å…¨å±€ ID ç±»å‹</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.muyoukule.entity</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span> <span class="comment"># å…¨å±€idç±»å‹ä¸ºè‡ªå¢é•¿</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMP ä¹Ÿæ”¯æŒæ‰‹å†™ SQL çš„ï¼Œè€Œ mapper æ–‡ä»¶çš„è¯»å–åœ°å€å¯ä»¥è‡ªå·±é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">&quot;classpath*:/mapper/**/*.xml&quot;</span> <span class="comment"># Mapper.xmlæ–‡ä»¶åœ°å€ï¼Œå½“å‰è¿™ä¸ªæ˜¯é»˜è®¤å€¼ã€‚</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°é»˜è®¤å€¼æ˜¯ <code>classpath*:/mapper/**/*.xml</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦æŠŠ mapper.xml æ–‡ä»¶æ”¾ç½®è¿™ä¸ªç›®å½•ä¸‹å°±ä¸€å®šä¼šè¢«åŠ è½½ã€‚</p>
<h1 id="6-æ¡ä»¶æ„é€ å™¨"><a href="#6-æ¡ä»¶æ„é€ å™¨" class="headerlink" title="6. æ¡ä»¶æ„é€ å™¨"></a>6. æ¡ä»¶æ„é€ å™¨</h1><p>é™¤äº†æ–°å¢ä»¥å¤–ï¼Œä¿®æ”¹ã€åˆ é™¤ã€æŸ¥è¯¢çš„SQLè¯­å¥éƒ½éœ€è¦æŒ‡å®š where æ¡ä»¶ã€‚å› æ­¤ BaseMapper ä¸­æä¾›çš„ç›¸å…³æ–¹æ³•é™¤äº†ä»¥ <code>id</code> ä½œä¸º <code>where</code> æ¡ä»¶ä»¥å¤–ï¼Œè¿˜æ”¯æŒæ›´åŠ å¤æ‚çš„ <code>where</code> æ¡ä»¶ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/BaseMapper%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%9E%84%E9%80%A0%E5%99%A8.png" alt="BaseMapperä¸­çš„æ¡ä»¶æ„é€ å™¨"></p>
<p>å‚æ•°ä¸­çš„ <code>Wrapper</code> å°±æ˜¯æ¡ä»¶æ„é€ çš„æŠ½è±¡ç±»ï¼Œå…¶ä¸‹æœ‰å¾ˆå¤šé»˜è®¤å®ç°ï¼Œç»§æ‰¿å…³ç³»å¦‚å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/Wrapper%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E5%9B%BE.png" alt="Wrapperç»§æ‰¿å…³ç³»å›¾" style="zoom: 50%;">

<p><code>Wrapper</code> çš„å­ç±» <code>AbstractWrapper</code> æä¾›äº† where ä¸­åŒ…å«çš„æ‰€æœ‰æ¡ä»¶æ„é€ æ–¹æ³•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/AbstractWrapper%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="AbstractWrapperä¸­çš„æ–¹æ³•" style="zoom:67%;">

<p>è€Œ <code>QueryWrapper</code> åœ¨ <code>AbstractWrapper</code> çš„åŸºç¡€ä¸Šæ‹“å±•äº†ä¸€ä¸ª <code>select</code> æ–¹æ³•ï¼Œå…è®¸æŒ‡å®šæŸ¥è¯¢å­—æ®µï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/QueryWrapper%E7%9A%84select%E6%96%B9%E6%B3%95.png" alt="QueryWrapperçš„selectæ–¹æ³•"></p>
<p>è€Œ <code>UpdateWrapper</code> åœ¨ <code>AbstractWrapper</code> çš„åŸºç¡€ä¸Šæ‹“å±•äº†ä¸€ä¸ª <code>set</code> æ–¹æ³•ï¼Œå…è®¸æŒ‡å®š SQL ä¸­çš„ SET éƒ¨åˆ†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/UpdateWrapper%E7%9A%84set%E6%96%B9%E6%B3%95.png" alt="UpdateWrapperçš„setæ–¹æ³•"></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•åˆ©ç”¨ <code>Wrapper </code>å®ç°å¤æ‚æŸ¥è¯¢ã€‚</p>
<h2 id="6-1-QueryWrapper"><a href="#6-1-QueryWrapper" class="headerlink" title="6.1 QueryWrapper"></a>6.1 QueryWrapper</h2><p>å½“å‰æ•°æ®è¡¨æ•°æ®ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE.png" alt="æ¡ä»¶æŸ¥è¯¢å‰æ•°æ®åº“æ•°æ®"></p>
<p>æ— è®ºæ˜¯ä¿®æ”¹ã€åˆ é™¤ã€æŸ¥è¯¢ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ QueryWrapper æ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶ã€‚æ¥ä¸‹æ¥çœ‹ä¸€äº›ä¾‹å­ï¼š</p>
<p><strong>å¤šæ¡ä»¶æ„å»º</strong></p>
<blockquote>
<p>æŸ¥è¯¢å‡ºåå­—ä¸­å¸¦ o ï¼Œå¹´é¾„å¤§äºç­‰äº 18 çš„äºº</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæŸ¥è¯¢æ¡ä»¶ where name like &quot;%o%&quot; AND age &gt;= 18</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;()</span><br><span class="line">            .select(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;age&quot;</span>, <span class="string">&quot;email&quot;</span>)</span><br><span class="line">            .like(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;o&quot;</span>)</span><br><span class="line">            .ge(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° MP åœ¨ç¼–å†™ SQL è¯­å¥æ—¶ä¼šä½¿ç”¨ ? å ä½ç¬¦ï¼Œç„¶åå°†å‚æ•°ä¼ è¿›å»ï¼Œæœ€ç»ˆæŸ¥è¯¢åˆ°ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%90%8D%E5%AD%97%E4%B8%AD%E5%B8%A6o%E5%B9%B4%E9%BE%84%E5%A4%A7%E4%BA%8E%E7%AD%89%E4%BA%8E18.png" alt="åå­—ä¸­å¸¦oå¹´é¾„å¤§äºç­‰äº18"></p>
<blockquote>
<p>æŸ¥è¯¢å‡ºå¹´é¾„å°äº 20 æˆ–å¹´é¾„å¤§äº 25 çš„äºº</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæŸ¥è¯¢æ¡ä»¶ where (age &lt; 25 OR age &gt; 20)</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">    wrapper.lt(<span class="string">&quot;age&quot;</span>, <span class="number">20</span>).or().gt(<span class="string">&quot;age&quot;</span>, <span class="number">25</span>);</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%B9%B4%E9%BE%84%E5%B0%8F%E4%BA%8E20%E6%88%96%E5%B9%B4%E9%BE%84%E5%A4%A7%E4%BA%8E25.png" alt="å¹´é¾„å°äº20æˆ–å¹´é¾„å¤§äº25"></p>
<p><font color="red"><strong>PSï¼š<code>or()</code> å°±ç›¸å½“äºæˆ‘ä»¬sqlè¯­å¥ä¸­çš„ <code>or</code> å…³é”®å­—ï¼Œä¸åŠ é»˜è®¤æ˜¯ <code>and</code></strong></font></p>
<p><strong>æŸ¥è¯¢æŠ•å½±</strong></p>
<blockquote>
<p>æŸ¥è¯¢æŒ‡å®šå­—æ®µ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">    wrapper.select(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>);</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%9F%A5%E8%AF%A2name,age%E5%AD%97%E6%AE%B5.png" alt="æŸ¥è¯¢name,ageå­—æ®µ"></p>
<p><strong>èšåˆæŸ¥è¯¢</strong></p>
<blockquote>
<p>countã€maxã€minã€avgã€sum</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">    <span class="comment">// SELECT count(*) as count FROM user</span></span><br><span class="line">    <span class="comment">//wrapper.select(&quot;count(*) as count&quot;);</span></span><br><span class="line">    <span class="comment">// SELECT max(age) as maxAge FROM user</span></span><br><span class="line">    <span class="comment">//wrapper.select(&quot;max(age) as maxAge&quot;);</span></span><br><span class="line">    <span class="comment">// SELECT min(age) as minAge FROM user</span></span><br><span class="line">    <span class="comment">//wrapper.select(&quot;min(age) as minAge&quot;);</span></span><br><span class="line">    <span class="comment">// SELECT sum(age) as sumAge FROM user</span></span><br><span class="line">    <span class="comment">//wrapper.select(&quot;sum(age) as sumAge&quot;);</span></span><br><span class="line">    <span class="comment">//SELECT avg(age) as avgAge FROM user</span></span><br><span class="line">    wrapper.select(<span class="string">&quot;avg(age) as avgAge&quot;</span>);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; userList = userMapper.selectMaps(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†ç»„æŸ¥è¯¢</strong></p>
<blockquote>
<p>åˆ†ç»„æŸ¥è¯¢ï¼Œå®Œæˆ group by çš„æŸ¥è¯¢ä½¿ç”¨</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// SELECT count(*) as count,age FROM `user` GROUP BY age</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">    wrapper.select(<span class="string">&quot;count(*) as count,age&quot;</span>);</span><br><span class="line">    wrapper.groupBy(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; list = userMapper.selectMaps(wrapper);</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2age.png" alt="åˆ†ç»„æŸ¥è¯¢age"></p>
<blockquote>
<p>æ ¹æ® ID é™åºæ’åˆ—</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * condition ï¼šæ¡ä»¶ï¼Œè¿”å›booleanï¼Œ</span></span><br><span class="line"><span class="comment">     å½“conditionä¸ºtrueï¼Œè¿›è¡Œæ’åºï¼Œå¦‚æœä¸ºfalseï¼Œåˆ™ä¸æ’åº</span></span><br><span class="line"><span class="comment">     * isAsc:æ˜¯å¦ä¸ºå‡åºï¼Œtrueä¸ºå‡åºï¼Œfalseä¸ºé™åº</span></span><br><span class="line"><span class="comment">     * columnsï¼šéœ€è¦æ“ä½œçš„åˆ—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    wrapper.orderBy(<span class="literal">true</span>, <span class="literal">false</span>, <span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%A0%B9%E6%8D%AEID%E9%99%8D%E5%BA%8F%E6%8E%92%E5%88%97.png" alt="æ ¹æ®IDé™åºæ’åˆ—"></p>
<blockquote>
<p>æ›´æ–°ç”¨æˆ·åä¸º Jack çš„ç”¨æˆ·çš„å¹´é¾„ä¸º 18</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateByQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæŸ¥è¯¢æ¡ä»¶ where name = &quot;Jack&quot;</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Jack&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.æ›´æ–°æ•°æ®ï¼Œuserä¸­énullå­—æ®µéƒ½ä¼šä½œä¸ºsetè¯­å¥</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    userMapper.update(user, wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E5%90%8D%E4%B8%BAJack%E7%9A%84%E7%94%A8%E6%88%B7%E7%9A%84%E5%B9%B4%E9%BE%84%E4%B8%BA18.png" alt="æ›´æ–°ç”¨æˆ·åä¸ºJackçš„ç”¨æˆ·çš„å¹´é¾„ä¸º18"></p>
<p>é™¤äº†ä¸Šé¢ä»‹ç»çš„è¿™å‡ ç§æŸ¥è¯¢æ¡ä»¶æ„å»ºæ–¹æ³•ä»¥å¤–è¿˜ä¼šæœ‰å¾ˆå¤šå…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚ isNullï¼ŒisNotNullï¼Œinï¼ŒnotIn ç­‰ç­‰æ–¹æ³•å¯ä¾›é€‰æ‹©ï¼Œå…·ä½“å‚è€ƒ<a href="https://baomidou.com/pages/10c804/">å®˜æ–¹æ–‡æ¡£</a>çš„æ¡ä»¶æ„é€ å™¨æ¥å­¦ä¹ ä½¿ç”¨ã€‚</p>
<h2 id="6-2-UpdateWrapper"><a href="#6-2-UpdateWrapper" class="headerlink" title="6.2 UpdateWrapper"></a>6.2 UpdateWrapper</h2><p>åŸºäº BaseMapper ä¸­çš„ update æ–¹æ³•æ›´æ–°æ—¶åªèƒ½ç›´æ¥èµ‹å€¼ï¼Œå¯¹äºä¸€äº›å¤æ‚çš„éœ€æ±‚å°±éš¾ä»¥å®ç°ã€‚ </p>
<p>ä¾‹å¦‚ï¼šæ›´æ–° ID ä¸º <code>1ã€2ã€4</code> çš„ç”¨æˆ·çš„å¹´é¾„ï¼Œå‡ä¸¤å²ï¼Œå¯¹åº”çš„ SQL åº”è¯¥æ˜¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> age <span class="operator">=</span> age <span class="operator">-</span> <span class="number">2</span> <span class="keyword">WHERE</span> id <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p>SET çš„èµ‹å€¼ç»“æœæ˜¯åŸºäºå­—æ®µç°æœ‰å€¼çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦åˆ©ç”¨ UpdateWrapper ä¸­çš„ setSql åŠŸèƒ½äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">4L</span>);</span><br><span class="line">    <span class="comment">// 1.ç”ŸæˆSQL</span></span><br><span class="line">    UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;User&gt;()</span><br><span class="line">            .setSql(<span class="string">&quot;age = age - 2&quot;</span>) <span class="comment">// SET age = age - 2</span></span><br><span class="line">            .in(<span class="string">&quot;id&quot;</span>, ids); <span class="comment">// WHERE id in (1, 2, 4)</span></span><br><span class="line">    <span class="comment">// 2.æ›´æ–°ï¼Œæ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ç»™ nullï¼Œä¹Ÿå°±æ˜¯ä¸å¡«æ›´æ–°å­—æ®µå’Œæ•°æ®ï¼Œè€Œæ˜¯åŸºäº UpdateWrapper ä¸­çš„ setSQL æ¥æ›´æ–°</span></span><br><span class="line">    userMapper.update(<span class="literal">null</span>, wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%9B%B4%E6%96%B0ID%E4%B8%BA1,2,4%E7%9A%84%E7%94%A8%E6%88%B7%E7%9A%84%E5%B9%B4%E9%BE%84%E5%87%8F%E4%B8%A4%E5%B2%81.png" alt="æ›´æ–°IDä¸º1,2,4çš„ç”¨æˆ·çš„å¹´é¾„å‡ä¸¤å²"></p>
<h2 id="6-3-LambdaQueryWrapper"><a href="#6-3-LambdaQueryWrapper" class="headerlink" title="6.3 LambdaQueryWrapper"></a>6.3 LambdaQueryWrapper</h2><p>æ— è®ºæ˜¯ QueryWrapper è¿˜æ˜¯ UpdateWrapper åœ¨æ„é€ æ¡ä»¶çš„æ—¶å€™éƒ½éœ€è¦å†™æ­»å­—æ®µåç§°ï¼Œä¼šå‡ºç°å­—ç¬¦ä¸²<code>é­”æ³•å€¼</code>ã€‚è¿™åœ¨ç¼–ç¨‹è§„èŒƒä¸­æ˜¾ç„¶æ˜¯ä¸æ¨èçš„ã€‚ é‚£æ€ä¹ˆæ ·æ‰èƒ½ä¸å†™å­—æ®µåï¼Œåˆèƒ½çŸ¥é“å­—æ®µåå‘¢ï¼Ÿ</p>
<p>å…¶ä¸­ä¸€ç§åŠæ³•æ˜¯åŸºäºå˜é‡çš„ <code>gettter</code> æ–¹æ³•ç»“åˆåå°„æŠ€æœ¯ã€‚å› æ­¤æˆ‘ä»¬åªè¦å°†æ¡ä»¶å¯¹åº”çš„å­—æ®µçš„ <code>getter</code> æ–¹æ³•ä¼ é€’ç»™ MPï¼Œå®ƒå°±èƒ½è®¡ç®—å‡ºå¯¹åº”çš„å˜é‡åäº†ã€‚è€Œä¼ é€’æ–¹æ³•å¯ä»¥ä½¿ç”¨JDK8ä¸­çš„ <code>æ–¹æ³•å¼•ç”¨</code> å’Œ <code>Lambda </code>è¡¨è¾¾å¼ã€‚ å› æ­¤ MP åˆæä¾›äº†ä¸€å¥—åŸºäº Lambda çš„Wrapperï¼ŒåŒ…å«ä¸¤ä¸ªï¼š</p>
<ul>
<li>LambdaQueryWrapper</li>
<li>LambdaUpdateWrapper</li>
</ul>
<p>åˆ†åˆ«å¯¹åº” QueryWrapper å’Œ UpdateWrapper</p>
<p>å…¶ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testLambdaQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æ„å»ºæ¡ä»¶ where name like &quot;%o%&quot; AND age &gt;= 18</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    wrapper.lambda()</span><br><span class="line">            .select(User::getId, User::getName, User::getAge, User::getEmail)</span><br><span class="line">            .like(User::getName, <span class="string">&quot;o&quot;</span>)</span><br><span class="line">            .ge(User::getAge, <span class="number">18</span>);</span><br><span class="line">    <span class="comment">// 2.æŸ¥è¯¢</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-4-è‡ªå®šä¹‰SQL"><a href="#6-4-è‡ªå®šä¹‰SQL" class="headerlink" title="6.4 è‡ªå®šä¹‰SQL"></a>6.4 è‡ªå®šä¹‰SQL</h2><p>åœ¨æ¼”ç¤º UpdateWrapper çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­ç¼–å†™äº†æ›´æ–°çš„ SQL è¯­å¥ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%89%8B%E5%86%99%E7%9A%84SQL%E8%AF%AD%E5%8F%A5.png" alt="æ‰‹å†™çš„SQLè¯­å¥"></p>
<p>è¿™ç§å†™æ³•åœ¨æŸäº›ä¼ä¸šä¹Ÿæ˜¯ä¸å…è®¸çš„ï¼Œå› ä¸º SQL è¯­å¥æœ€å¥½éƒ½ç»´æŠ¤åœ¨æŒä¹…å±‚ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡å±‚ã€‚å°±å½“å‰æ¡ˆä¾‹æ¥è¯´ï¼Œç”±äºæ¡ä»¶æ˜¯ in è¯­å¥ï¼Œåªèƒ½å°†SQLå†™åœ¨Mapper.xmlæ–‡ä»¶ï¼Œåˆ©ç”¨foreachæ¥ç”ŸæˆåŠ¨æ€SQLã€‚ è¿™å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚å‡å¦‚æŸ¥è¯¢æ¡ä»¶æ›´å¤æ‚ï¼ŒåŠ¨æ€SQLçš„ç¼–å†™ä¹Ÿä¼šæ›´åŠ å¤æ‚ã€‚</p>
<p>æ‰€ä»¥ï¼ŒMPæä¾›äº†è‡ªå®šä¹‰SQLåŠŸèƒ½ï¼Œå¯ä»¥è®©æˆ‘ä»¬åˆ©ç”¨Wrapperç”ŸæˆæŸ¥è¯¢æ¡ä»¶ï¼Œå†ç»“åˆMapper.xmlç¼–å†™SQLã€‚</p>
<h3 id="6-4-1-åŸºæœ¬ç”¨æ³•"><a href="#6-4-1-åŸºæœ¬ç”¨æ³•" class="headerlink" title="6.4.1 åŸºæœ¬ç”¨æ³•"></a>6.4.1 åŸºæœ¬ç”¨æ³•</h3><p>ä»¥å½“å‰æ¡ˆä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testCustomWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.å‡†å¤‡è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">4L</span>);</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;().in(<span class="string">&quot;id&quot;</span>, ids);</span><br><span class="line">    <span class="comment">// 2.è°ƒç”¨mapperçš„è‡ªå®šä¹‰æ–¹æ³•ï¼Œç›´æ¥ä¼ é€’Wrapper</span></span><br><span class="line">    userMapper.deductAgeByIds(<span class="number">2</span>, wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨UserMapperä¸­è‡ªå®šä¹‰SQLï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="meta">@Select(&quot;UPDATE user SET age = age - #&#123;age&#125; $&#123;ew.customSqlSegment&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deductAgeByIds</span><span class="params">(<span class="meta">@Param(&quot;age&quot;)</span> <span class="type">int</span> age, <span class="meta">@Param(&quot;ew&quot;)</span> QueryWrapper&lt;User&gt; wrapper)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±çœå»äº†ç¼–å†™å¤æ‚æŸ¥è¯¢æ¡ä»¶çš„çƒ¦æ¼äº†ã€‚</p>
<h3 id="6-4-2-å¤šè¡¨å…³è”"><a href="#6-4-2-å¤šè¡¨å…³è”" class="headerlink" title="6.4.2 å¤šè¡¨å…³è”"></a>6.4.2 å¤šè¡¨å…³è”</h3><p>ç†è®ºä¸Šæ¥è®²MyBatisPlusæ˜¯ä¸æ”¯æŒå¤šè¡¨æŸ¥è¯¢çš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Wrapperä¸­è‡ªå®šä¹‰æ¡ä»¶ç»“åˆè‡ªå®šä¹‰SQLæ¥å®ç°å¤šè¡¨æŸ¥è¯¢çš„æ•ˆæœã€‚</p>
<p>æ‰§è¡ŒSQLè„šæœ¬ï¼Œåˆ›å»ºaddressè¡¨ï¼Œä¸ user è¡¨ç›¸å…³è”ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `address` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·ID&#x27;</span>,</span><br><span class="line">  `province` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çœ&#x27;</span>,</span><br><span class="line">  `city` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¸‚&#x27;</span>,</span><br><span class="line">  `town` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¿/åŒº&#x27;</span>,</span><br><span class="line">  `mobile` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœº&#x27;</span>,</span><br><span class="line">  `street` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è¯¦ç»†åœ°å€&#x27;</span>,</span><br><span class="line">  `contact` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è”ç³»äºº&#x27;</span>,</span><br><span class="line">  `is_default` bit(<span class="number">1</span>) <span class="keyword">DEFAULT</span> b<span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦æ˜¯é»˜è®¤ 1é»˜è®¤ 0å¦&#x27;</span>,</span><br><span class="line">  `notes` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¤‡æ³¨&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  KEY `user_id` (`user_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">71</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 ROW_FORMAT<span class="operator">=</span>COMPACT;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `address` (`id`, `user_id`, `province`, `city`, `town`, `mobile`, `street`, `contact`, `is_default`, `notes`) <span class="keyword">VALUES</span></span><br><span class="line">    (<span class="number">59</span>, <span class="number">2</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;æœé˜³åŒº&#x27;</span>, <span class="string">&#x27;13900112222&#x27;</span>, <span class="string">&#x27;é‡‘ç‡•é¾™åŠå…¬æ¥¼&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">60</span>, <span class="number">1</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;æœé˜³åŒº&#x27;</span>, <span class="string">&#x27;13700221122&#x27;</span>, <span class="string">&#x27;ä¿®æ­£å¤§å¦&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">61</span>, <span class="number">1</span>, <span class="string">&#x27;ä¸Šæµ·&#x27;</span>, <span class="string">&#x27;ä¸Šæµ·&#x27;</span>, <span class="string">&#x27;æµ¦ä¸œæ–°åŒº&#x27;</span>, <span class="string">&#x27;13301212233&#x27;</span>, <span class="string">&#x27;èˆªå¤´é•‡èˆªå¤´è·¯&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">63</span>, <span class="number">2</span>, <span class="string">&#x27;å¹¿ä¸œ&#x27;</span>, <span class="string">&#x27;ä½›å±±&#x27;</span>, <span class="string">&#x27;æ°¸æ˜¥&#x27;</span>, <span class="string">&#x27;13301212233&#x27;</span>, <span class="string">&#x27;æ°¸æ˜¥æ­¦é¦†&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">64</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13567809102&#x27;</span>, <span class="string">&#x27;æµ™æ±Ÿå¤§å­¦&#x27;</span>, <span class="string">&#x27;Hope&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">65</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hope&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">66</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">67</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hopey&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">68</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">69</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hopey&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">    (<span class="number">70</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¦æŸ¥è¯¢å‡ºæ‰€æœ‰æ”¶è´§åœ°å€åœ¨åŒ—äº¬çš„å¹¶ä¸”ç”¨æˆ· ID åœ¨ <code>1ã€2ã€4</code> ä¹‹ä¸­çš„ç”¨æˆ· è¦æ˜¯è‡ªå·±åŸºäº Mybatis å®ç° SQLï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUserByIdAndAddr&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.muyoukule.entity.User&quot;</span>&gt;</span></span><br><span class="line">      SELECT *</span><br><span class="line">      FROM user u</span><br><span class="line">      INNER JOIN address a ON u.id = a.user_id</span><br><span class="line">      WHERE u.id</span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">open</span>=<span class="string">&quot;IN (&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">          #&#123;id&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">      AND a.city = #&#123;city&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºå…¶ä¸­æœ€å¤æ‚çš„å°±æ˜¯ WHERE æ¡ä»¶çš„ç¼–å†™ï¼Œå¦‚æœä¸šåŠ¡å¤æ‚ä¸€äº›ï¼Œè¿™é‡Œçš„ SQL ä¼šæ›´å˜æ€ã€‚</p>
<p>ä½†æ˜¯åŸºäºè‡ªå®šä¹‰ SQL ç»“åˆ Wrapper çš„ç©æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ Wrapper æ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åæ‰‹å†™ SELECT åŠ FROM éƒ¨åˆ†ï¼Œå®ç°å¤šè¡¨æŸ¥è¯¢ã€‚</p>
<p>æŸ¥è¯¢æ¡ä»¶è¿™æ ·æ¥æ„å»ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testCustomJoinWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.å‡†å¤‡è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;()</span><br><span class="line">            .in(<span class="string">&quot;u.id&quot;</span>, List.of(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">4L</span>))</span><br><span class="line">            .eq(<span class="string">&quot;a.city&quot;</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.è°ƒç”¨mapperçš„è‡ªå®šä¹‰æ–¹æ³•</span></span><br><span class="line">    List&lt;User&gt; userList = userMapper.queryUserByWrapper(wrapper);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨UserMapperä¸­è‡ªå®šä¹‰æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;SELECT u.* FROM user u INNER JOIN address a ON u.id = a.user_id $&#123;ew.customSqlSegment&#125;&quot;)</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">queryUserByWrapper</span><span class="params">(<span class="meta">@Param(&quot;ew&quot;)</span> QueryWrapper&lt;User&gt; wrapper)</span>;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨<code>UserMapper.xml</code>ä¸­å†™SQLï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUserByIdAndAddr&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.itheima.mp.domain.po.User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user u INNER JOIN address a ON u.id = a.user_id $&#123;ew.customSqlSegment&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="7-ä»£ç ç”Ÿæˆ"><a href="#7-ä»£ç ç”Ÿæˆ" class="headerlink" title="7. ä»£ç ç”Ÿæˆ"></a>7. ä»£ç ç”Ÿæˆ</h1><p>åœ¨ä½¿ç”¨MP ä»¥åï¼ŒåŸºç¡€çš„<code>Mapper</code>ã€<code>Service</code>ã€<code>PO</code>ä»£ç ç›¸å¯¹å›ºå®šï¼Œé‡å¤ç¼–å†™ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚å› æ­¤MP å®˜æ–¹æä¾›äº†ä»£ç ç”Ÿæˆå™¨ã€‚</p>
<p>é€‚ç”¨ç‰ˆæœ¬ï¼šmybatis-plus-generator 3.5.1 åŠå…¶ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯¹å†å²ç‰ˆæœ¬ä¸å…¼å®¹ï¼</p>
<p>3.5.1 ä»¥ä¸‹çš„è¯·å‚è€ƒï¼š<a href="https://baomidou.com/pages/d357af/">ä»£ç ç”Ÿæˆå™¨ï¼ˆæ—§ï¼‰</a></p>
<p>é¦–å…ˆéœ€è¦æ·»åŠ ä¾èµ–ï¼ŒMP ä» <code>3.0.3</code> ä¹‹åç§»é™¤äº†ä»£ç ç”Ÿæˆå™¨ä¸æ¨¡æ¿å¼•æ“çš„é»˜è®¤ä¾èµ–ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ ç›¸å…³ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ä»£ç ç”Ÿæˆå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ¨¡æ¿å¼•æ“  Velocity(é»˜è®¤)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä»£ç ç”Ÿæˆç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.FieldFill;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.FastAutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.OutputFile;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.DateType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.DbColumnType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.fill.Column;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.fill.Property;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Types;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> æœ¨åˆæ¯äº†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024/4/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGenerator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»£ç ç”Ÿæˆå™¨å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// æ•°æ®åº“ä¿¡æ¯</span></span><br><span class="line">        FastAutoGenerator.create(<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mybatis_plus&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>)</span><br><span class="line">                <span class="comment">// 1.å…¨å±€é…ç½®</span></span><br><span class="line">                .globalConfig(builder -&gt; &#123;</span><br><span class="line">                    builder.disableOpenDir()</span><br><span class="line">                            .author(<span class="string">&quot;æœ¨åˆæ¯äº†&quot;</span>)    <span class="comment">// è®¾ç½®ä½œè€…</span></span><br><span class="line">                            .outputDir(System.getProperty(<span class="string">&quot;user.dir&quot;</span>) + <span class="string">&quot;/src/main/java&quot;</span>)   <span class="comment">// ä»£ç è¾“å‡ºç›®å½•</span></span><br><span class="line">                            <span class="comment">//.enableSwagger()  // å¼€å¯ swagger æ¨¡å¼</span></span><br><span class="line">                            .dateType(DateType.TIME_PACK)   <span class="comment">// æ—¶é—´ç­–ç•¥</span></span><br><span class="line">                            .commentDate(<span class="string">&quot;yyyy-MM-dd&quot;</span>)  <span class="comment">// æ³¨é‡Šæ—¥æœŸ</span></span><br><span class="line">                            .build();</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="comment">// 2.æ•°æ®åº“é…ç½®</span></span><br><span class="line">                .dataSourceConfig(builder -&gt;</span><br><span class="line">                        builder.typeConvertHandler((globalConfig, typeRegistry, metaInfo) -&gt; &#123;</span><br><span class="line">                            <span class="type">int</span> <span class="variable">typeCode</span> <span class="operator">=</span> metaInfo.getJdbcType().TYPE_CODE;</span><br><span class="line">                            <span class="keyword">if</span> (typeCode == Types.SMALLINT) &#123;</span><br><span class="line">                                <span class="comment">// è‡ªå®šä¹‰ç±»å‹è½¬æ¢</span></span><br><span class="line">                                <span class="keyword">return</span> DbColumnType.INTEGER;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span> typeRegistry.getColumnType(metaInfo);</span><br><span class="line">                        &#125;)</span><br><span class="line">                )</span><br><span class="line">                <span class="comment">// 3.åŒ…é…ç½®</span></span><br><span class="line">                .packageConfig(builder -&gt; &#123;</span><br><span class="line">                    builder.parent(<span class="string">&quot;com.muyoukule&quot;</span>) <span class="comment">// è®¾ç½®çˆ¶åŒ…å</span></span><br><span class="line">                            .entity(<span class="string">&quot;entity&quot;</span>)   <span class="comment">// Entity åŒ…å</span></span><br><span class="line">                            .service(<span class="string">&quot;service&quot;</span>) <span class="comment">// Service åŒ…å</span></span><br><span class="line">                            .serviceImpl(<span class="string">&quot;service.impl&quot;</span>)    <span class="comment">//Service Impl åŒ…å</span></span><br><span class="line">                            .mapper(<span class="string">&quot;mapper&quot;</span>)   <span class="comment">//Mapper åŒ…å</span></span><br><span class="line">                            .xml(<span class="string">&quot;AddressMapper.xml&quot;</span>)   <span class="comment">//Mapper XML åŒ…å</span></span><br><span class="line">                            .controller(<span class="string">&quot;controller&quot;</span>)   <span class="comment">//	Controller åŒ…å</span></span><br><span class="line">                            .pathInfo(Collections.singletonMap(OutputFile.xml, System.getProperty(<span class="string">&quot;user.dir&quot;</span>) + <span class="string">&quot;/src/main/resources/mapper&quot;</span>))<span class="comment">// è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„</span></span><br><span class="line">                            .build();</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="comment">// 4.ç­–ç•¥é…ç½®</span></span><br><span class="line">                .strategyConfig(builder -&gt; &#123;</span><br><span class="line">                    builder</span><br><span class="line">                            <span class="comment">// å®ä½“ç­–ç•¥é…ç½®</span></span><br><span class="line">                            .entityBuilder()</span><br><span class="line">                            .enableLombok() <span class="comment">// å¼€å¯ lombok æ¨¡å‹</span></span><br><span class="line">                            .versionColumnName(<span class="string">&quot;version&quot;</span>)   <span class="comment">// ä¹è§‚é”å­—æ®µå(æ•°æ®åº“å­—æ®µ)</span></span><br><span class="line">                            .logicDeleteColumnName(<span class="string">&quot;deleted&quot;</span>)   <span class="comment">// é€»è¾‘åˆ é™¤å­—æ®µå(æ•°æ®åº“å­—æ®µ)</span></span><br><span class="line">                            .addTableFills(<span class="keyword">new</span> <span class="title class_">Column</span>(<span class="string">&quot;create_time&quot;</span>, FieldFill.INSERT)) <span class="comment">// æ·»åŠ è¡¨å­—æ®µå¡«å……</span></span><br><span class="line">                            .addTableFills(<span class="keyword">new</span> <span class="title class_">Property</span>(<span class="string">&quot;updateTime&quot;</span>, FieldFill.INSERT_UPDATE)) <span class="comment">// æ·»åŠ è¡¨å­—æ®µå¡«å……</span></span><br><span class="line">                            .idType(IdType.AUTO)    <span class="comment">// å…¨å±€ä¸»é”®ç±»å‹</span></span><br><span class="line">                            .formatFileName(<span class="string">&quot;%s&quot;</span>)   <span class="comment">// æ ¼å¼åŒ–æ–‡ä»¶åç§°ï¼Œ %sä¸ºå ä½ç¬¦ï¼ŒæŒ‡ä»£æ¨¡å—åç§°</span></span><br><span class="line">                            <span class="comment">// Controller ç­–ç•¥é…ç½®</span></span><br><span class="line">                            .controllerBuilder()</span><br><span class="line">                            .enableRestStyle() <span class="comment">// å¼€å¯ç”Ÿæˆ @RestController æ§åˆ¶å™¨</span></span><br><span class="line">                            .formatFileName(<span class="string">&quot;%sController&quot;</span>) <span class="comment">// æ ¼å¼åŒ–æ–‡ä»¶åç§°ï¼Œ %sä¸ºå ä½ç¬¦ï¼ŒæŒ‡ä»£æ¨¡å—åç§°</span></span><br><span class="line">                            .build();</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="comment">// 5.æ‰§è¡Œç”Ÿæˆæ“ä½œ</span></span><br><span class="line">                .execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç æŒ‰è¦æ±‚ä¿®æ”¹å³å¯ä½¿ç”¨ã€‚å¯¹äºä»£ç ç”Ÿæˆå™¨ä¸­çš„æ›´å¤šä»£ç å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»<a href="https://baomidou.com/pages/981406/#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE-datasourceconfig">å®˜æ–¹æ–‡æ¡£</a>ä¸­è·å–ä»£ç è¿›è¡Œä¿®æ”¹ã€‚</p>
<h1 id="8-é€»è¾‘åˆ é™¤"><a href="#8-é€»è¾‘åˆ é™¤" class="headerlink" title="8. é€»è¾‘åˆ é™¤"></a>8. é€»è¾‘åˆ é™¤</h1><p>å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šé‡‡ç”¨é€»è¾‘åˆ é™¤çš„æ–¹æ¡ˆï¼Œå³ï¼š</p>
<ul>
<li>åœ¨è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µæ ‡è®°æ•°æ®æ˜¯å¦è¢«åˆ é™¤</li>
<li>å½“åˆ é™¤æ•°æ®æ—¶æŠŠæ ‡è®°ç½®ä¸ºtrue</li>
<li>æŸ¥è¯¢æ—¶è¿‡æ»¤æ‰æ ‡è®°ä¸ºtrueçš„æ•°æ®</li>
</ul>
<p>ä¸€æ—¦é‡‡ç”¨äº†é€»è¾‘åˆ é™¤ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢å’Œåˆ é™¤é€»è¾‘éƒ½è¦è·Ÿç€å˜åŒ–ï¼Œéå¸¸éº»çƒ¦ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMP å°±æ·»åŠ äº†å¯¹é€»è¾‘åˆ é™¤çš„æ”¯æŒã€‚</p>
<p><font color="red">PSï¼šåªæœ‰ MP ç”Ÿæˆçš„SQLè¯­å¥æ‰æ”¯æŒè‡ªåŠ¨çš„é€»è¾‘åˆ é™¤ï¼Œè‡ªå®šä¹‰ SQL éœ€è¦è‡ªå·±æ‰‹åŠ¨å¤„ç†é€»è¾‘åˆ é™¤ã€‚</font></p>
<p>1ã€æˆ‘ä»¬ç»™ <code>user</code> è¡¨æ·»åŠ ä¸€ä¸ªé€»è¾‘åˆ é™¤å­—æ®µï¼Œè®¾ç½®é»˜è®¤å€¼ä¸º 0 ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> deleted bit <span class="keyword">default</span> b<span class="string">&#x27;0&#x27;</span> <span class="keyword">null</span> comment <span class="string">&#x27;é€»è¾‘åˆ é™¤&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%B7%BB%E5%8A%A0%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5deleted.png" alt="æ·»åŠ é€»è¾‘åˆ é™¤å­—æ®µdeleted"></p>
<p>2ã€ç»™ <code>user</code> å®ä½“æ·»åŠ  <code>deleted</code> å­—æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€»è¾‘åˆ é™¤</span></span><br><span class="line"><span class="keyword">private</span> Boolean deleted;</span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨<code>application.yml</code>ä¸­é…ç½®é€»è¾‘åˆ é™¤å­—æ®µï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">deleted</span> <span class="comment"># å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå(since 3.3.0,é…ç½®åå¯ä»¥å¿½ç•¥ä¸é…ç½®æ­¥éª¤2)</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span> <span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span> <span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)</span></span><br></pre></td></tr></table></figure>

<p>4ã€æµ‹è¯•</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªåˆ é™¤æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•ä¸æ™®é€šåˆ é™¤ä¸€æ¨¡ä¸€æ ·ï¼Œä½†æ˜¯åº•å±‚çš„SQLé€»è¾‘å˜äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%BA%95%E5%B1%82%E7%9A%84SQL%E9%80%BB%E8%BE%91%E6%94%B9%E5%8F%98.png" alt="åº•å±‚çš„SQLé€»è¾‘æ”¹å˜"></p>
<p>æŸ¥çœ‹æ•°æ®åº“ï¼Œå‘ç° ID ä¸º1 çš„è®°å½•è¿˜åœ¨æ•°æ®åº“ï¼Œåªæ˜¯ deleted å­—æ®µå˜ä¸º 1 ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/deleted%E5%AD%97%E6%AE%B5%E5%8F%98%E4%B8%BA1.png"></p>
<p>æŸ¥è¯¢ä¸€ä¸‹è¯•è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSelectAll</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">    userList.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šå‘ç° IDä¸º 1 çš„è®°å½•ç¡®å®æ²¡æœ‰æŸ¥è¯¢å‡ºæ¥ï¼Œè€Œä¸” SQL ä¸­ä¹Ÿå¯¹é€»è¾‘åˆ é™¤å­—æ®µåšäº†åˆ¤æ–­ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/SQL%E5%AF%B9%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5%E5%81%9A%E5%87%BA%E5%88%A4%E6%96%AD.png" alt="SQLå¯¹é€»è¾‘åˆ é™¤å­—æ®µåšå‡ºåˆ¤æ–­"></p>
<p>ç»¼ä¸Šï¼Œ å¼€å¯äº†é€»è¾‘åˆ é™¤åŠŸèƒ½ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒæ™®é€šåˆ é™¤ä¸€æ ·åšCRUDï¼ŒåŸºæœ¬ä¸ç”¨è€ƒè™‘ä»£ç é€»è¾‘é—®é¢˜ã€‚è¿˜æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼š é€»è¾‘åˆ é™¤æœ¬èº«ä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ä¼šå¯¼è‡´æ•°æ®åº“è¡¨åƒåœ¾æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œä»è€Œå½±å“æŸ¥è¯¢æ•ˆç‡</li>
<li>SQL ä¸­å…¨éƒ½éœ€è¦å¯¹é€»è¾‘åˆ é™¤å­—æ®µåšåˆ¤æ–­ï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡</li>
</ul>
<p>å› æ­¤ï¼Œä¸å¤ªæ¨èé‡‡ç”¨é€»è¾‘åˆ é™¤åŠŸèƒ½ï¼Œå¦‚æœæ•°æ®ä¸èƒ½åˆ é™¤ï¼Œå¯ä»¥é‡‡ç”¨æŠŠæ•°æ®è¿ç§»åˆ°å…¶å®ƒè¡¨çš„åŠæ³•ã€‚</p>
<h1 id="9-é€šç”¨æšä¸¾"><a href="#9-é€šç”¨æšä¸¾" class="headerlink" title="9. é€šç”¨æšä¸¾"></a>9. é€šç”¨æšä¸¾</h1><h2 id="9-1-å£°æ˜é€šç”¨æšä¸¾å±æ€§"><a href="#9-1-å£°æ˜é€šç”¨æšä¸¾å±æ€§" class="headerlink" title="9.1 å£°æ˜é€šç”¨æšä¸¾å±æ€§"></a>9.1 å£°æ˜é€šç”¨æšä¸¾å±æ€§</h2><p>1ã€æˆ‘ä»¬ç»™  <code>user</code>  è¡¨æ·»åŠ ä¸€ä¸ª <code>status</code> å­—æ®µï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> `status` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸ 2å†»ç»“ï¼‰&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2ã€å®šä¹‰ä¸€ä¸ªç”¨æˆ·çŠ¶æ€çš„æšä¸¾ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UserStatus</span> &#123;</span><br><span class="line">    NORMAL(<span class="number">1</span>, <span class="string">&quot;æ­£å¸¸&quot;</span>),</span><br><span class="line">    FREEZE(<span class="number">2</span>, <span class="string">&quot;å†»ç»“&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line"></span><br><span class="line">    UserStatus(<span class="type">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€ç»™ <code>user</code> å®ä½“æ·»åŠ  <code>status</code> å­—æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸ 2å†»ç»“ï¼‰</span></span><br><span class="line"><span class="keyword">private</span> UserStatus status;</span><br></pre></td></tr></table></figure>

<p>è¦è®© MP å¤„ç†æšä¸¾ä¸æ•°æ®åº“ç±»å‹è‡ªåŠ¨è½¬æ¢ï¼Œæˆ‘ä»¬å¿…é¡»å‘Šè¯‰ MPï¼Œæšä¸¾ä¸­çš„å“ªä¸ªå­—æ®µçš„å€¼ä½œä¸ºæ•°æ®åº“å€¼ã€‚ </p>
<p>MP æä¾›äº† <code>@EnumValue</code> æ³¨è§£æ¥æ ‡è®°æšä¸¾å±æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UserStatus</span> &#123;</span><br><span class="line">    NORMAL(<span class="number">1</span>, <span class="string">&quot;æ­£å¸¸&quot;</span>),</span><br><span class="line">    FREEZE(<span class="number">2</span>, <span class="string">&quot;å†»ç»“&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EnumValue</span> <span class="comment">// æ ‡è®°æ•°æ®åº“å­˜çš„å€¼æ˜¯ value</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line"></span><br><span class="line">    UserStatus(<span class="type">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-é…ç½®æ‰«æé€šç”¨æšä¸¾"><a href="#9-2-é…ç½®æ‰«æé€šç”¨æšä¸¾" class="headerlink" title="9.2 é…ç½®æ‰«æé€šç”¨æšä¸¾"></a><del>9.2 é…ç½®æ‰«æé€šç”¨æšä¸¾</del></h2><p><font color="red"><strong>PSï¼šä» 3.5.2 å¼€å§‹æ— éœ€é…ç½®ï¼</strong></font>ğŸ˜</p>
<p><strong>æ–¹å¼ä¸€ï¼šä»…é…ç½®æŒ‡å®šåŒ…å†…çš„æšä¸¾ç±»ä½¿ç”¨ MybatisEnumTypeHandler</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"> 	<span class="comment"># è®¾ç½®æšä¸¾åŒ…æ‰«æã€‚3.5.2 ç‰ˆæœ¬å¼€å§‹ï¼Œçœç•¥æ­¤é…ç½®ã€‚</span></span><br><span class="line">    <span class="comment"># æ”¯æŒç»Ÿé…ç¬¦ * æˆ–è€… ; åˆ†å‰² </span></span><br><span class="line">    <span class="attr">typeEnumsPackage:</span> <span class="string">com.muyoukule.enums</span></span><br></pre></td></tr></table></figure>

<p>å½“æ·»åŠ è¿™ä¸ªé…ç½®åï¼Œmybatis-plus æä¾›çš„ <code>MybatisSqlSessionFactoryBean</code> ä¼šè‡ªåŠ¨æ‰«æåŒ…å†…åˆæ³•çš„æšä¸¾ç±»ï¼ˆä½¿ç”¨äº† <code>@EnumValue</code> æ³¨è§£ï¼Œæˆ–è€…å®ç°äº† <code>IEnum</code> æ¥å£ï¼‰ï¼Œåˆ†åˆ«ä¸ºè¿™äº›ç±»æ³¨å†Œä½¿ç”¨ <code>MybatisEnumTypeHandler</code>ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œåªæœ‰æŒ‡å®šåŒ…ä¸‹çš„æšä¸¾ç±»ä¼šä½¿ç”¨æ–°çš„ TypeHandlerã€‚å…¶ä»–åŒ…ä¸‹ï¼Œæˆ–è€…åŒ…å†…æ²¡æœ‰åšç›¸å…³æ”¹é€ çš„æšä¸¾ç±»ï¼Œä»ç„¶ä¼šä½¿ç”¨ Mybatis çš„ DefaultEnumTypeHandlerã€‚</p>
<p><strong>æ–¹å¼äºŒï¼šç›´æ¥æŒ‡å®š DefaultEnumTypeHandler</strong></p>
<p>æ­¤æ–¹å¼ç”¨æ¥ <code>å…¨å±€</code> ä¿®æ”¹ Mybatis ä½¿ç”¨çš„ EnumTypeHandlerã€‚</p>
<p>åœ¨application.yamlæ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">default-enum-type-handler:</span> <span class="string">com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler</span></span><br></pre></td></tr></table></figure>

<p>è‡ªå®šä¹‰é…ç½®ç±» MybatisPlusAutoConfigurationï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusAutoConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusPropertiesCustomizer <span class="title function_">mybatisPlusPropertiesCustomizer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> properties -&gt; &#123;</span><br><span class="line">            <span class="type">GlobalConfig</span> <span class="variable">globalConfig</span> <span class="operator">=</span> properties.getGlobalConfig();</span><br><span class="line">            globalConfig.setBanner(<span class="literal">false</span>);</span><br><span class="line">            <span class="type">MybatisConfiguration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisConfiguration</span>();</span><br><span class="line">            configuration.setDefaultEnumTypeHandler(MybatisEnumTypeHandler.class);</span><br><span class="line">            properties.setConfiguration(configuration);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ä¸€æ¡æ•°æ®æŸ¥çœ‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test2@baomidou.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;NORMAL&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚ä½•åºåˆ—åŒ–æšä¸¾å€¼ä¸ºå‰ç«¯è¿”å›å€¼ï¼Ÿ</p>
</blockquote>
<p>åœ¨UserStatusæšä¸¾ä¸­é€šè¿‡ <code>@JsonValue</code> æ³¨è§£æ ‡è®° JSON åºåˆ—åŒ–æ—¶å±•ç¤ºçš„å­—æ®µ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UserStatus</span> &#123;</span><br><span class="line">    NORMAL(<span class="number">1</span>, <span class="string">&quot;æ­£å¸¸&quot;</span>),</span><br><span class="line">    FREEZE(<span class="number">2</span>, <span class="string">&quot;å†»ç»“&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EnumValue</span> <span class="comment">// æ ‡è®°æ•°æ®åº“å­˜çš„å€¼æ˜¯ value</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="meta">@JsonValue</span>    <span class="comment">//æ ‡è®°å“åº”jsonå€¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line"></span><br><span class="line">    UserStatus(<span class="type">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æŸ¥çœ‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test2@baomidou.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ­£å¸¸&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åœ¨ desc ä¸ŠåŠ äº† <code>@JsonValue</code> æ³¨è§£æ³¨è§£å status ç”± <code>NORMAL</code> å˜ä¸ºäº† <code>æ­£å¸¸</code> ã€‚</p>
<h1 id="10-JSONç±»å‹å¤„ç†å™¨"><a href="#10-JSONç±»å‹å¤„ç†å™¨" class="headerlink" title="10. JSONç±»å‹å¤„ç†å™¨"></a>10. JSONç±»å‹å¤„ç†å™¨</h1><p>1ã€æˆ‘ä»¬ç»™  <code>user</code>  è¡¨æ·»åŠ ä¸€ä¸ª <code>info</code> å­—æ®µï¼Œæ˜¯ JSON ç±»å‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> `info` JSON <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è¯¦ç»†ä¿¡æ¯&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2ã€å‘ <code>info</code> å­—æ®µæ“¦æ’å…¥æ•°æ®æ ¼å¼åƒè¿™æ ·ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä½›ç³»é’å¹´&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;gender&quot;</span><span class="punctuation">:</span> <span class="string">&quot;male&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç»™ <code>user</code> å®ä½“æ·»åŠ  <code>info</code> å­—æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">private</span> String info;</span><br></pre></td></tr></table></figure>

<p>ä¸€èˆ¬ User å®ä½“ç±»ä¸­éƒ½æ˜¯ <code>String </code> ç±»å‹çš„ infoï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬è¦è¯»å– info ä¸­çš„å±æ€§æ—¶å°±éå¸¸ä¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test2@baomidou.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ­£å¸¸&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;\&quot;intro\&quot;: \&quot;ä½›ç³»é’å¹´\&quot;, \&quot;gender\&quot;: \&quot;male\&quot;&#125;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æ–¹ä¾¿è·å–ï¼Œinfo çš„ç±»å‹æœ€å¥½æ˜¯ä¸€ä¸ª <code>Map</code> æˆ–è€…å®ä½“ç±»ã€‚è€Œä¸€æ—¦æˆ‘ä»¬æŠŠ <code>info </code> æ”¹ä¸º <code>å¯¹è±¡</code> ç±»å‹ï¼Œå°±éœ€è¦åœ¨å†™å…¥æ•°æ®åº“æ—¶æ‰‹åŠ¨è½¬ä¸º <code>String</code>ï¼Œå†è¯»å–æ•°æ®åº“æ—¶ï¼Œæ‰‹åŠ¨è½¬æ¢ä¸º <code>å¯¹è±¡</code>ï¼Œè¿™ä¼šéå¸¸éº»çƒ¦ã€‚</p>
<p>å› æ­¤ MP æä¾›äº†å¾ˆå¤šç‰¹æ®Šç±»å‹å­—æ®µçš„ç±»å‹å¤„ç†å™¨ï¼Œè§£å†³ç‰¹æ®Šå­—æ®µç±»å‹ä¸æ•°æ®åº“ç±»å‹è½¬æ¢çš„é—®é¢˜ã€‚ä¾‹å¦‚å¤„ç† JSON å°±å¯ä»¥ä½¿ç”¨ <code>JacksonTypeHandler </code> å¤„ç†å™¨ã€‚</p>
<blockquote>
<p>æ€ä¹ˆä½¿ç”¨ JacksonTypeHandler å¤„ç†å™¨å‘¢ï¼Ÿ</p>
</blockquote>
<p>1ã€æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå•ç‹¬å®ä½“ç±»æ¥ä¸ info å­—æ®µçš„å±æ€§åŒ¹é…ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserInfo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String intro;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€æ¥ä¸‹æ¥ï¼Œå°† User ç±»çš„ info å­—æ®µè®¾ç½®ä¸º UserInfo ç±»å‹ï¼Œå¹¶å£°æ˜ç±»å‹å¤„ç†å™¨ï¼š</p>
<p><font color="red"><strong>PSï¼šå¿…é¡»å¼€å¯æ˜ å°„æ³¨è§£Â <code>@TableName(autoResultMap = true)</code> ï¼ï¼ï¼</strong></font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;`user`&quot;, autoResultMap = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@TableId(type = IdType.INPUT)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// -- skip --</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">    <span class="meta">@TableField(typeHandler = JacksonTypeHandler.class)</span></span><br><span class="line">    <span class="keyword">private</span> UserInfo info;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€æµ‹è¯•å¯ä»¥å‘ç°ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ­£ç¡®å°è£…åˆ° UserInfo å½“ä¸­äº†ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test2@baomidou.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ­£å¸¸&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;intro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¼åœ°é­”&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gender&quot;</span><span class="punctuation">:</span> <span class="string">&quot;male&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="11-è‡ªåŠ¨å¡«å……åŠŸèƒ½"><a href="#11-è‡ªåŠ¨å¡«å……åŠŸèƒ½" class="headerlink" title="11. è‡ªåŠ¨å¡«å……åŠŸèƒ½"></a>11. è‡ªåŠ¨å¡«å……åŠŸèƒ½</h1><p>åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ï¼Œå¯¹äºè¿™ä¸¤ä¸ªå­—æ®µçš„æ“ä½œæˆ‘ä»¬å¸Œæœ›æ˜¯è‡ªåŠ¨å®Œæˆè€Œä¸æ˜¯éœ€è¦æ‰‹åŠ¨ç¼–å†™ã€‚</p>
<p>1ã€æˆ‘ä»¬ç»™  <code>user</code>  è¡¨æ·»åŠ  <code>create_time</code> å­—æ®µå’Œ  <code>update_time</code> å­—æ®µå¹¶å°†è¿™ä¸¤ä¸ªå­—æ®µç±»å‹è®¾ç½®ä¸º <code>timestamp</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> `create_time` <span class="type">timestamp</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> `update_time` <span class="type">timestamp</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2ã€åŒæ­¥å®ä½“ç±»ï¼Œå®ä½“ç±»çš„å±æ€§ä¸Šå¢åŠ æ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­—æ®µå¡«å……å†…å®¹</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime updateTime;</span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™å¤„ç†å™¨æ¥å¤„ç†è¿™äº›æ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line">    <span class="comment">// æ’å…¥çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;start insert fill ....&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">        <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ–°çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;start update fill ....&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€æµ‹è¯•æ’å…¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setName(<span class="string">&quot;æœ¨åˆæ¯äº†&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    user.setEmail(<span class="string">&quot;example@gmail.com&quot;</span>);</span><br><span class="line">    <span class="comment">// è¿™é‡Œä½¿ç”¨ MP é»˜è®¤ä¸»é”® ID ç”Ÿæˆç­–ç•¥</span></span><br><span class="line">    userMapper.insert(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€æŸ¥çœ‹æ•°æ®åº“ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%95%B0%E6%8D%AE%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85.png" alt="æ•°æ®è‡ªåŠ¨å¡«å……"></p>
<h1 id="12-ä¹è§‚é”æ’ä»¶"><a href="#12-ä¹è§‚é”æ’ä»¶" class="headerlink" title="12. ä¹è§‚é”æ’ä»¶"></a>12. ä¹è§‚é”æ’ä»¶</h1><p>ä¸ä¹è§‚é”ç›¸å¯¹çš„æœ‰ï¼š<strong>æ‚²è§‚é”</strong></p>
<ul>
<li>æ‚²è§‚é”åœ¨æ•°æ®ä¿®æ”¹å‰åŠ é”ï¼Œé¿å…å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ä½†å¯èƒ½é™ä½å¹¶å‘æ€§èƒ½ã€‚</li>
<li>ä¹è§‚é”åˆ™å‡è®¾å†²çªå°‘ï¼Œåªåœ¨æ•°æ®æäº¤æ—¶éªŒè¯å†²çªï¼Œæé«˜å¹¶å‘æ€§èƒ½ä½†å¯èƒ½éœ€å¤„ç†æ›´å¤šå†²çªã€‚</li>
</ul>
<p>å®˜æ–¹è§£é‡Šï¼š<a href="https://baomidou.com/pages/0d93c0/#optimisticlockerinnerinterceptor">ä¹è§‚é”æ’ä»¶</a></p>
<p>ç›®çš„ï¼šå½“è¦æ›´æ–°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¸Œæœ›è¿™æ¡è®°å½•æ²¡æœ‰è¢«åˆ«äººæ›´æ–°ã€‚</p>
<p>ä¹è§‚é”å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰ version</li>
<li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ª version</li>
<li>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ set version &#x3D; newVersion where version &#x3D; oldVersion</li>
<li>å¦‚æœ version ä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹ Aã€B åŒæ—¶ä¿®æ”¹ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> name <span class="operator">=</span> &quot;æœ¨åˆæ¯äº†&quot;, version <span class="operator">=</span> version <span class="operator">+</span> <span class="number">1</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">6</span> <span class="keyword">and</span> version <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="comment">-- ä½†æ˜¯ B æŠ¢å…ˆå®Œæˆäº†ä¿®æ”¹ï¼Œversion ä¿®æ”¹æˆ 2</span></span><br><span class="line"><span class="comment">-- è¿™ä¸ªæ—¶å€™ A å°±ä¸èƒ½ä¿®æ”¹æ•°æ®äº†ï¼Œå®ç°çº¿ç¨‹é€šä¿¡çš„å®‰å…¨</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¹è§‚é”æ’ä»¶å®ç°æ­¥éª¤</p>
</blockquote>
<p>1ã€æˆ‘ä»¬ç»™ <code>user</code> è¡¨æ·»åŠ ä¸€ä¸ª <code>version</code> å­—æ®µï¼Œè®¾ç½®é»˜è®¤å€¼ä¸º 1 ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> version <span class="type">int</span> <span class="keyword">default</span> b<span class="string">&#x27;1&#x27;</span> <span class="keyword">null</span> comment <span class="string">&#x27;ä¹è§‚é”&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E6%B7%BB%E5%8A%A0version%E5%AD%97%E6%AE%B5.png" alt="æ·»åŠ versionå­—æ®µ"></p>
<p>2ã€ç»™å®ä½“ç±»å¢åŠ ç›¸åº”çš„å­—æ®µï¼Œå¹¶æ·»åŠ æ³¨è§£ <code>@Version</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure>

<p>3ã€æ³¨å†Œç»„ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.muyoukule.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">mybatisPlusInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        mybatisPlusInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€ç¼–å†™æµ‹è¯•æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼š</p>
<p><strong>PSï¼šè¦æƒ³å®ç°ä¹è§‚é”ï¼Œé¦–å…ˆç¬¬ä¸€æ­¥åº”è¯¥æ˜¯æ‹¿åˆ°è¡¨ä¸­çš„ versionï¼Œç„¶åæ‹¿ version å½“æ¡ä»¶å†å°† version åŠ  1 æ›´æ–°å›åˆ°æ•°æ®åº“è¡¨ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦<font color="red">å…ˆå¯¹å…¶è¿›è¡ŒæŸ¥è¯¢</font></strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•ä¹è§‚é”</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOptimisticLocker</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(<span class="number">2L</span>);</span><br><span class="line">    <span class="comment">// ä¿®æ”¹ä¿¡æ¯</span></span><br><span class="line">    user.setName(<span class="string">&quot;muyoukule&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    user.setEmail(<span class="string">&quot;example@gmail.com&quot;</span>);</span><br><span class="line">    <span class="comment">// æ›´æ–°ä¿¡æ¯</span></span><br><span class="line">    userMapper.updateById(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€æŸ¥çœ‹æ•°æ®åº“ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E4%B9%90%E8%A7%82%E9%94%81%E4%BF%AE%E6%94%B9%E6%88%90%E5%8A%9F.png" alt="ä¹è§‚é”ä¿®æ”¹æˆåŠŸ"></p>
<p>æˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ä¿®æ”¹å¤±è´¥çš„æƒ…å†µï¼Œæ¨¡æ‹Ÿä¸€ç§åŠ é”çš„æƒ…å†µï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å®ç°å¤šä¸ªäººä¿®æ”¹åŒä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œåªèƒ½æœ‰ä¸€ä¸ªäººä¿®æ”¹æˆåŠŸã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOptimisticLocker2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.å…ˆé€šè¿‡è¦ä¿®æ”¹çš„æ•°æ® id å°†å½“å‰æ•°æ®æŸ¥è¯¢å‡ºæ¥</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(<span class="number">2L</span>);     <span class="comment">//version=2</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> userMapper.selectById(<span class="number">2L</span>);    <span class="comment">//version=2</span></span><br><span class="line">    user2.setName(<span class="string">&quot;muyoukule222&quot;</span>);</span><br><span class="line">    userMapper.updateById(user2);              <span class="comment">//version=&gt;3</span></span><br><span class="line"></span><br><span class="line">    user.setName(<span class="string">&quot;muyoukule111&quot;</span>);</span><br><span class="line">    userMapper.updateById(user);               <span class="comment">//verion=2?æ¡ä»¶è¿˜æˆç«‹å—ï¼Ÿ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ²¡æœ‰ä¹è§‚é”ï¼Œæœ€åä¸€æ¬¡çš„ä¿®æ”¹ä¼šè¦†ç›–å‰ä¸€æ¬¡çš„ä¿®æ”¹ï¼Œä½†æ˜¯æœ‰äº†ä¹è§‚é”å°±ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µäº†ã€‚æŸ¥çœ‹æ•°æ®åº“ä¿®æ”¹ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E4%B9%90%E8%A7%82%E9%94%81%E4%BF%AE%E6%94%B9%E5%A4%B1%E8%B4%A5.png" alt="ä¹è§‚é”ä¿®æ”¹å¤±è´¥"></p>
<p>æŸ¥çœ‹æ•°æ®åº“åå‘ç° <code>muyoukule111</code> å¹¶æœªè¦†ç›– <code>muyoukule222</code> ã€‚</p>
<h1 id="12-åˆ†é¡µæ’ä»¶"><a href="#12-åˆ†é¡µæ’ä»¶" class="headerlink" title="12. åˆ†é¡µæ’ä»¶"></a>12. åˆ†é¡µæ’ä»¶</h1><p>åœ¨æœªå¼•å…¥åˆ†é¡µæ’ä»¶çš„æƒ…å†µä¸‹ï¼Œ<code>MP </code>æ˜¯ä¸æ”¯æŒåˆ†é¡µåŠŸèƒ½çš„ï¼Œ<code>IService</code> å’Œ <code>BaseMapper</code> ä¸­çš„åˆ†é¡µæ–¹æ³•éƒ½æ— æ³•æ­£å¸¸èµ·æ•ˆã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»é…ç½®åˆ†é¡µæ’ä»¶ã€‚</p>
<p>1ã€é…ç½®åˆ†é¡µæ’ä»¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.muyoukule.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ åˆ†é¡µæ’ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));<span class="comment">//å¦‚æœé…ç½®å¤šä¸ªæ’ä»¶,åˆ‡è®°åˆ†é¡µæœ€åæ·»åŠ </span></span><br><span class="line">        <span class="comment">//interceptor.addInnerInterceptor(new PaginationInnerInterceptor()); å¦‚æœæœ‰å¤šæ•°æ®æºå¯ä»¥ä¸é…å…·ä½“ç±»å‹ å¦åˆ™éƒ½å»ºè®®é…ä¸Šå…·ä½“çš„DbType</span></span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€ç¼–å†™ä¸€ä¸ªåˆ†é¡µæŸ¥è¯¢çš„æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testPageQuery</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.åˆ†é¡µæŸ¥è¯¢ï¼Œnew Page()çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ï¼šé¡µç ã€æ¯é¡µå¤§å°</span></span><br><span class="line">    Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">    userMapper.selectPage(page, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">// 2.æ€»æ¡æ•°</span></span><br><span class="line">    System.out.println(<span class="string">&quot;total = &quot;</span> + page.getTotal());</span><br><span class="line">    <span class="comment">// 3.æ€»é¡µæ•°</span></span><br><span class="line">    System.out.println(<span class="string">&quot;pages = &quot;</span> + page.getPages());</span><br><span class="line">    <span class="comment">// 4.æ•°æ®</span></span><br><span class="line">    List&lt;User&gt; records = page.getRecords();</span><br><span class="line">    records.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€æ§åˆ¶å°è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">total = 8</span><br><span class="line">pages = 4</span><br><span class="line">User(id=4, name=Sandy, age=19, email=test4@baomidou.com, deleted=false, status=NORMAL, info=null, createTime=null, updateTime=null, version=1)</span><br><span class="line">User(id=5, name=Billie, age=24, email=test5@baomidou.com, deleted=false, status=NORMAL, info=null, createTime=null, updateTime=null, version=1)</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šç”±äºå‰é¢æˆ‘ä»¬ä½¿ç”¨äº†é€»è¾‘åˆ é™¤ï¼Œ<code>deleted</code> å€¼ä¸º 1 çš„å­—æ®µä¸ä¼šè¢«æŸ¥è¯¢åˆ°ï¼Œæ‰€ä»¥æ•°æ®è¡¨ä¸€å…±æ˜¯ 8 æ¡è®°å½•ã€‚</strong></p>
<p>4ã€å¯¹æ¯”æ•°æ®åº“æ•°æ®ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/MyBatisPlus/%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE%E5%AF%B9%E6%AF%94.png" alt="åˆ†é¡µæŸ¥è¯¢æ•°æ®åº“æ•°æ®å¯¹æ¯”"></p>
]]></content>
      <categories>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>MyBatisPlus</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQé«˜çº§</title>
    <url>/posts/RabbitMQ-Advanced/</url>
    <content><![CDATA[<p>RabbitMQå®˜ç½‘ï¼š<a href="https://www.rabbitmq.com/">https://www.rabbitmq.com</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1mN4y1Z7t9/">é»‘é©¬ç¨‹åºå‘˜RabbitMQå…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ï¼ŒMQæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¾®æœåŠ¡rabbitmqæ¶ˆæ¯é˜Ÿåˆ—å®æˆ˜ï¼ŒRabbitMQé¢è¯•é¢˜ä¸€å¥—å…¨è¦†ç›–</a></p>
<h1 id="0-å†™åœ¨å‰é¢"><a href="#0-å†™åœ¨å‰é¢" class="headerlink" title="0. å†™åœ¨å‰é¢"></a>0. å†™åœ¨å‰é¢</h1><p>åœ¨ä½¿ç”¨ MQ æ—¶æˆ‘ä»¬å¿…é¡»å°½å¯èƒ½ç¡®ä¿ MQ æ¶ˆæ¯çš„å¯é æ€§ï¼Œå³ï¼šæ¶ˆæ¯åº”è¯¥è‡³å°‘è¢«æ¶ˆè´¹è€…å¤„ç†1æ¬¡</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š</p>
<ul>
<li><strong>æˆ‘ä»¬è¯¥å¦‚ä½•ç¡®ä¿MQæ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ</strong></li>
<li><strong>å¦‚æœçœŸçš„å‘é€å¤±è´¥ï¼Œæœ‰æ²¡æœ‰å…¶å®ƒçš„å…œåº•æ–¹æ¡ˆï¼Ÿ</strong></li>
</ul>
<p>è¿™äº›é—®é¢˜ï¼Œåœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­éƒ½ä¼šæ‰¾åˆ°ç­”æ¡ˆã€‚</p>
<h1 id="1-å‘é€è€…çš„å¯é æ€§"><a href="#1-å‘é€è€…çš„å¯é æ€§" class="headerlink" title="1. å‘é€è€…çš„å¯é æ€§"></a>1. å‘é€è€…çš„å¯é æ€§</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸€èµ·åˆ†æä¸€ä¸‹æ¶ˆæ¯ä¸¢å¤±çš„å¯èƒ½æ€§æœ‰å“ªäº›ã€‚</p>
<p>æ¶ˆæ¯ä»å‘é€è€…å‘é€æ¶ˆæ¯ï¼Œåˆ°æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯ï¼Œéœ€è¦ç»è¿‡çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E7%BB%8F%E8%BF%87%E7%9A%84%E6%B5%81%E7%A8%8B.png" alt="æ¶ˆæ¯ç»è¿‡çš„æµç¨‹"></p>
<p>æ¶ˆæ¯ä»ç”Ÿäº§è€…åˆ°æ¶ˆè´¹è€…çš„æ¯ä¸€æ­¥éƒ½å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼š</p>
<ul>
<li>å‘é€æ¶ˆæ¯æ—¶ä¸¢å¤±ï¼š<ul>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶è¿æ¥ MQ å¤±è´¥</li>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°è¾¾ MQåæœªæ‰¾åˆ° <code>Exchange</code></li>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°è¾¾ MQ çš„ <code>Exchange</code> åï¼Œæœªæ‰¾åˆ°åˆé€‚çš„ <code>Queue</code></li>
<li>æ¶ˆæ¯åˆ°è¾¾ MQ åï¼Œå¤„ç†æ¶ˆæ¯çš„è¿›ç¨‹å‘ç”Ÿå¼‚å¸¸</li>
</ul>
</li>
<li>MQ å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼š<ul>
<li>æ¶ˆæ¯åˆ°è¾¾ MQ ï¼Œä¿å­˜åˆ°é˜Ÿåˆ—åï¼Œå°šæœªæ¶ˆè´¹å°±çªç„¶å®•æœº</li>
</ul>
</li>
<li>æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯æ—¶ï¼š<ul>
<li>æ¶ˆæ¯æ¥æ”¶åå°šæœªå¤„ç†çªç„¶å®•æœº</li>
<li>æ¶ˆæ¯æ¥æ”¶åå¤„ç†è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸</li>
</ul>
</li>
</ul>
<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬è¦è§£å†³æ¶ˆæ¯ä¸¢å¤±é—®é¢˜ï¼Œä¿è¯ MQ çš„å¯é æ€§ï¼Œå°±å¿…é¡»ä» 3 ä¸ªæ–¹é¢å…¥æ‰‹ï¼š</p>
<ul>
<li>ç¡®ä¿ç”Ÿäº§è€…ä¸€å®šæŠŠæ¶ˆæ¯å‘é€åˆ° MQ</li>
<li>ç¡®ä¿ MQ ä¸ä¼šå°†æ¶ˆæ¯å¼„ä¸¢</li>
<li>ç¡®ä¿æ¶ˆè´¹è€…ä¸€å®šè¦å¤„ç†æ¶ˆæ¯</li>
</ul>
<p>è¿™ä¸€ç« æˆ‘ä»¬å…ˆæ¥çœ‹å¦‚ä½•ç¡®ä¿ç”Ÿäº§è€…ä¸€å®šèƒ½æŠŠæ¶ˆæ¯å‘é€åˆ° MQã€‚</p>
<h2 id="1-1-ç”Ÿäº§è€…é‡è¯•æœºåˆ¶"><a href="#1-1-ç”Ÿäº§è€…é‡è¯•æœºåˆ¶" class="headerlink" title="1.1 ç”Ÿäº§è€…é‡è¯•æœºåˆ¶"></a>1.1 ç”Ÿäº§è€…é‡è¯•æœºåˆ¶</h2><p>é¦–å…ˆç¬¬ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œå‡ºç°äº†ç½‘ç»œæ•…éšœï¼Œå¯¼è‡´ä¸MQçš„è¿æ¥ä¸­æ–­ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSpringAMQP æä¾›çš„æ¶ˆæ¯å‘é€æ—¶çš„é‡è¯•æœºåˆ¶ã€‚å³ï¼šå½“<code>RabbitTemplate </code>ä¸ MQ è¿æ¥è¶…æ—¶åï¼Œå¤šæ¬¡é‡è¯•ã€‚</p>
<p>1ã€ä¿®æ”¹ <code>publisher</code> æ¨¡å—çš„ <code>application.yaml</code> æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">connection-timeout:</span> <span class="string">1s</span> <span class="comment"># è®¾ç½®MQçš„è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">template:</span></span><br><span class="line">      <span class="attr">retry:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment"># å¼€å¯è¶…æ—¶é‡è¯•æœºåˆ¶</span></span><br><span class="line">        <span class="attr">initial-interval:</span> <span class="string">1000ms</span> <span class="comment"># å¤±è´¥åçš„åˆå§‹ç­‰å¾…æ—¶é—´</span></span><br><span class="line">        <span class="attr">multiplier:</span> <span class="number">1</span> <span class="comment"># å¤±è´¥åä¸‹æ¬¡çš„ç­‰å¾…æ—¶é•¿å€æ•°ï¼Œä¸‹æ¬¡ç­‰å¾…æ—¶é•¿ = initial-interval * multiplier</span></span><br><span class="line">        <span class="attr">max-attempts:</span> <span class="number">3</span> <span class="comment"># æœ€å¤§é‡è¯•æ¬¡æ•°</span></span><br></pre></td></tr></table></figure>

<p>2ã€åˆ©ç”¨å‘½ä»¤åœæ‰ RabbitMQ æœåŠ¡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker stop mq</span><br></pre></td></tr></table></figure>
<p>3ã€ç„¶åæµ‹è¯•å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œä¼šå‘ç°ä¼šæ¯éš”1ç§’é‡è¯•1æ¬¡ï¼Œæ€»å…±é‡è¯•äº†3æ¬¡ã€‚æ¶ˆæ¯å‘é€çš„è¶…æ—¶é‡è¯•æœºåˆ¶é…ç½®æˆåŠŸäº†ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">03-31 08:54:13:838  INFO 13056 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.88.132:5672]</span><br><span class="line">03-31 08:54:15:858  INFO 13056 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.88.132:5672]</span><br><span class="line">03-31 08:54:17:885  INFO 13056 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.88.132:5672]</span><br></pre></td></tr></table></figure>

<p>PSï¼šè¿™ä¸ªå¤±è´¥ä»…ä»…æ˜¯è¿æ¥å¤±è´¥çš„é‡è¯•ï¼Œå¦‚æœæ¶ˆæ¯å‘é€æŠ›å‡ºå¼‚å¸¸æ—¶ä¸ä¼šé‡è¯•ğŸ˜‚</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>å½“ç½‘ç»œä¸ç¨³å®šçš„æ—¶å€™ï¼Œåˆ©ç”¨é‡è¯•æœºåˆ¶å¯ä»¥æœ‰æ•ˆæé«˜æ¶ˆæ¯å‘é€çš„æˆåŠŸç‡ã€‚ä¸è¿‡SpringAMQPæä¾›çš„é‡è¯•æœºåˆ¶æ˜¯<strong>é˜»å¡å¼</strong>çš„é‡è¯•ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šæ¬¡é‡è¯•ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œå½“å‰çº¿ç¨‹æ˜¯è¢«é˜»å¡çš„ã€‚</p>
<p>å¦‚æœå¯¹äºä¸šåŠ¡æ€§èƒ½æœ‰è¦æ±‚ï¼Œå»ºè®®ç¦ç”¨é‡è¯•æœºåˆ¶ã€‚å¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œè¯·åˆç†é…ç½®ç­‰å¾…æ—¶é•¿å’Œé‡è¯•æ¬¡æ•°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥çº¿ç¨‹æ¥æ‰§è¡Œå‘é€æ¶ˆæ¯çš„ä»£ç ã€‚</p>
<h2 id="1-2-ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶"><a href="#1-2-ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶" class="headerlink" title="1.2 ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶"></a>1.2 ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªè¦ç”Ÿäº§è€…ä¸ MQ ä¹‹é—´çš„ç½‘è·¯è¿æ¥é¡ºç•…ï¼ŒåŸºæœ¬ä¸ä¼šå‡ºç°å‘é€æ¶ˆæ¯ä¸¢å¤±çš„æƒ…å†µï¼Œå› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬æ— éœ€è€ƒè™‘è¿™ç§é—®é¢˜ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨å°‘æ•°æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šå‡ºç°æ¶ˆæ¯å‘é€åˆ°MQä¹‹åä¸¢å¤±çš„ç°è±¡ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>MQ å†…éƒ¨å¤„ç†æ¶ˆæ¯çš„è¿›ç¨‹å‘ç”Ÿäº†å¼‚å¸¸</li>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°è¾¾ MQ åæœªæ‰¾åˆ° <code>Exchange</code></li>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°è¾¾ MQ çš„ <code>Exchange</code> åï¼Œæœªæ‰¾åˆ°åˆé€‚çš„ <code>Queue</code>ï¼Œå› æ­¤æ— æ³•è·¯ç”±</li>
</ul>
<p>é’ˆå¯¹ä¸Šè¿°æƒ…å†µï¼ŒRabbitMQ æä¾›äº†ç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ŒåŒ…æ‹¬ <code>Publisher Confirm</code> å’Œ <code>Publisher Return</code> ä¸¤ç§ã€‚åœ¨å¼€å¯ç¡®è®¤æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œå½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ç»™ MQ åï¼ŒMQä¼šæ ¹æ®æ¶ˆæ¯å¤„ç†çš„æƒ…å†µè¿”å›ä¸åŒçš„<strong>å›æ‰§</strong>ã€‚</p>
<p>å…·ä½“å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E6%81%AF%E7%A1%AE%E8%AE%A4%E6%9C%BA%E5%88%B6.png" alt="RabbitMQç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤æœºåˆ¶"></p>
<p><strong>æ€»ç»“å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>å½“æ¶ˆæ¯æŠ•é€’åˆ°MQï¼Œä½†æ˜¯è·¯ç”±å¤±è´¥æ—¶ï¼Œé€šè¿‡ <strong>Publisher Return</strong> è¿”å›å¼‚å¸¸ä¿¡æ¯ï¼ŒåŒæ—¶è¿”å› ACK çš„ç¡®è®¤ä¿¡æ¯ï¼Œä»£è¡¨æŠ•é€’æˆåŠŸ</li>
<li>ä¸´æ—¶æ¶ˆæ¯æŠ•é€’åˆ°äº† MQï¼Œå¹¶ä¸”å…¥é˜ŸæˆåŠŸï¼Œè¿”å› ACKï¼Œå‘ŠçŸ¥æŠ•é€’æˆåŠŸ</li>
<li>æŒä¹…æ¶ˆæ¯æŠ•é€’åˆ°äº† MQï¼Œå¹¶ä¸”å…¥é˜Ÿå®ŒæˆæŒä¹…åŒ–ï¼Œè¿”å› ACK ï¼Œå‘ŠçŸ¥æŠ•é€’æˆåŠŸ</li>
<li>å…¶å®ƒæƒ…å†µéƒ½ä¼šè¿”å› NACKï¼Œå‘ŠçŸ¥æŠ•é€’å¤±è´¥</li>
</ul>
<p>å…¶ä¸­ <code>ACK</code> å’Œ <code>NACK</code> å±äº<strong>Publisher Confirm</strong>æœºåˆ¶ï¼Œ<code>ACK</code>æ˜¯æŠ•é€’æˆåŠŸï¼›<code>NACK</code>æ˜¯æŠ•é€’å¤±è´¥ã€‚è€Œ<code>return</code>åˆ™å±äº <strong>Publisher Return</strong> æœºåˆ¶ã€‚</p>
<p>é»˜è®¤ä¸¤ç§æœºåˆ¶éƒ½æ˜¯å…³é—­çŠ¶æ€ï¼Œéœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶æ¥å¼€å¯ã€‚</p>
<h2 id="1-3-å®ç°ç”Ÿäº§è€…ç¡®è®¤"><a href="#1-3-å®ç°ç”Ÿäº§è€…ç¡®è®¤" class="headerlink" title="1.3 å®ç°ç”Ÿäº§è€…ç¡®è®¤"></a>1.3 å®ç°ç”Ÿäº§è€…ç¡®è®¤</h2><h3 id="1-3-1-å¼€å¯ç”Ÿäº§è€…ç¡®è®¤"><a href="#1-3-1-å¼€å¯ç”Ÿäº§è€…ç¡®è®¤" class="headerlink" title="1.3.1 å¼€å¯ç”Ÿäº§è€…ç¡®è®¤"></a>1.3.1 å¼€å¯ç”Ÿäº§è€…ç¡®è®¤</h3><p>åœ¨ publisher æ¨¡å—çš„ <code>application.yaml</code> ä¸­æ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">publisher-confirm-type:</span> <span class="string">correlated</span> <span class="comment"># å¼€å¯publisher confirmæœºåˆ¶ï¼Œå¹¶è®¾ç½®confirmç±»å‹</span></span><br><span class="line">    <span class="attr">publisher-returns:</span> <span class="literal">true</span> <span class="comment"># å¼€å¯publisher returnæœºåˆ¶</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œ <code>publisher-confirm-type</code> æœ‰ä¸‰ç§æ¨¡å¼å¯é€‰ï¼š</p>
<ul>
<li><code>none</code>ï¼šå…³é—­ confirm æœºåˆ¶</li>
<li><code>simple</code>ï¼šåŒæ­¥é˜»å¡ç­‰å¾… MQ çš„å›æ‰§</li>
<li><code>correlated</code>ï¼šMQ å¼‚æ­¥å›è°ƒè¿”å›å›æ‰§</li>
</ul>
<p>ä¸€èˆ¬æˆ‘ä»¬æ¨èä½¿ç”¨ <code>correlated </code>å›è°ƒæœºåˆ¶ã€‚</p>
<h3 id="1-3-2-å®šä¹‰ReturnCallback"><a href="#1-3-2-å®šä¹‰ReturnCallback" class="headerlink" title="1.3.2 å®šä¹‰ReturnCallback"></a>1.3.2 å®šä¹‰ReturnCallback</h3><p>æ¯ä¸ª <code>RabbitTemplate</code> åªèƒ½é…ç½®ä¸€ä¸ª <code>ReturnCallback</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨é…ç½®ç±»ä¸­ç»Ÿä¸€è®¾ç½®ã€‚æˆ‘ä»¬åœ¨ publisher æ¨¡å—å®šä¹‰ä¸€ä¸ªé…ç½®ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MqConfig</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.setReturnsCallback(<span class="keyword">new</span> <span class="title class_">RabbitTemplate</span>.ReturnsCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(ReturnedMessage returned)</span> &#123;</span><br><span class="line">                log.error(<span class="string">&quot;è§¦å‘return callback,&quot;</span>);</span><br><span class="line">                log.debug(<span class="string">&quot;exchange: &#123;&#125;&quot;</span>, returned.getExchange());</span><br><span class="line">                log.debug(<span class="string">&quot;routingKey: &#123;&#125;&quot;</span>, returned.getRoutingKey());</span><br><span class="line">                log.debug(<span class="string">&quot;message: &#123;&#125;&quot;</span>, returned.getMessage());</span><br><span class="line">                log.debug(<span class="string">&quot;replyCode: &#123;&#125;&quot;</span>, returned.getReplyCode());</span><br><span class="line">                log.debug(<span class="string">&quot;replyText: &#123;&#125;&quot;</span>, returned.getReplyText());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-3-å®šä¹‰ConfirmCallback"><a href="#1-3-3-å®šä¹‰ConfirmCallback" class="headerlink" title="1.3.3 å®šä¹‰ConfirmCallback"></a>1.3.3 å®šä¹‰ConfirmCallback</h3><p>ç”±äºæ¯ä¸ªæ¶ˆæ¯å‘é€æ—¶çš„å¤„ç†é€»è¾‘ä¸ä¸€å®šç›¸åŒï¼Œå› æ­¤ConfirmCallbackéœ€è¦åœ¨æ¯æ¬¡å‘æ¶ˆæ¯æ—¶å®šä¹‰ã€‚å…·ä½“æ¥è¯´ï¼Œæ˜¯åœ¨è°ƒç”¨RabbitTemplateä¸­çš„convertAndSendæ–¹æ³•æ—¶ï¼Œå¤šä¼ é€’ä¸€ä¸ªå‚æ•°ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/convertAndSend%E6%96%B9%E6%B3%95.png" alt="convertAndSendæ–¹æ³•"></p>
<p>è¿™é‡Œçš„CorrelationDataä¸­åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒçš„ä¸œè¥¿ï¼š</p>
<ul>
<li><code>id</code>ï¼šæ¶ˆæ¯çš„å”¯ä¸€æ ‡ç¤ºï¼ŒMQ å¯¹ä¸åŒçš„æ¶ˆæ¯çš„å›æ‰§ä»¥æ­¤åšåˆ¤æ–­ï¼Œé¿å…æ··æ·†</li>
<li><code>SettableListenableFuture</code>ï¼šå›æ‰§ç»“æœçš„ Future å¯¹è±¡</li>
</ul>
<p>å°†æ¥ MQ çš„å›æ‰§å°±ä¼šé€šè¿‡è¿™ä¸ª <code>Future</code> æ¥è¿”å›ï¼Œæˆ‘ä»¬å¯ä»¥æå‰ç»™ <code>CorrelationData</code> ä¸­çš„ <code>Future</code> æ·»åŠ å›è°ƒå‡½æ•°æ¥å¤„ç†æ¶ˆæ¯å›æ‰§ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/addCallback%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0.png" alt="addCallbackå›è°ƒå‡½æ•°"></p>
<p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæµ‹è¯•ï¼Œå‘ç³»ç»Ÿè‡ªå¸¦çš„äº¤æ¢æœºå‘é€æ¶ˆæ¯ï¼Œå¹¶ä¸”æ·»åŠ  <code>ConfirmCallback</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testPublisherConfirm</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºCorrelationData</span></span><br><span class="line">    <span class="comment">// id æ˜¯å½“å‰æ¶ˆæ¯çš„æ ‡è¯†ï¼Œè®© RabbitMQ åŒºåˆ†æ¶ˆæ¯ï¼Œé˜²æ­¢äº§ç”Ÿæ··ä¹±ï¼Œä¸çŸ¥é“è¯¥å›è°ƒç»™è°</span></span><br><span class="line">    <span class="type">CorrelationData</span> <span class="variable">cd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorrelationData</span>(UUID.randomUUID().toString());</span><br><span class="line">    <span class="comment">// 2.ç»™Futureæ·»åŠ ConfirmCallback</span></span><br><span class="line">    cd.getFuture().addCallback(<span class="keyword">new</span> <span class="title class_">ListenableFutureCallback</span>&lt;CorrelationData.Confirm&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFailure</span><span class="params">(Throwable ex)</span> &#123;</span><br><span class="line">            <span class="comment">// 2.1.Futureå‘ç”Ÿå¼‚å¸¸æ—¶çš„å¤„ç†é€»è¾‘ï¼ŒåŸºæœ¬ä¸ä¼šè§¦å‘</span></span><br><span class="line">            log.error(<span class="string">&quot;æ¶ˆæ¯å›è°ƒå¤±è´¥&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(CorrelationData.Confirm result)</span> &#123;</span><br><span class="line">            log.debug(<span class="string">&quot;æ”¶åˆ°confirm callbackå›æ‰§&quot;</span>);</span><br><span class="line">            <span class="comment">// 2.2.Futureæ¥æ”¶åˆ°å›æ‰§çš„å¤„ç†é€»è¾‘ï¼Œå‚æ•°ä¸­çš„resultå°±æ˜¯å›æ‰§å†…å®¹</span></span><br><span class="line">            <span class="keyword">if</span> (result.isAck()) &#123; <span class="comment">// result.isAck()ï¼Œbooleanç±»å‹ï¼Œtrueä»£è¡¨ackå›æ‰§ï¼Œfalse ä»£è¡¨ nackå›æ‰§</span></span><br><span class="line">                log.debug(<span class="string">&quot;å‘é€æ¶ˆæ¯æˆåŠŸï¼Œæ”¶åˆ° ack!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// result.getReason()ï¼ŒStringç±»å‹ï¼Œè¿”å›nackæ—¶çš„å¼‚å¸¸æè¿°</span></span><br><span class="line">                log.error(<span class="string">&quot;å‘é€æ¶ˆæ¯å¤±è´¥ï¼Œæ”¶åˆ° nack, åŸå›  : &#123;&#125;&quot;</span>, result.getReason());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 3.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(<span class="string">&quot;hmall.direct&quot;</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;hello&quot;</span>, cd);</span><br><span class="line"></span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">03-31 09:25:25:604 DEBUG 11344 --- [168.88.132:5672] c.m.publisher.amqp.SpringAmqpTest        : æ”¶åˆ°confirm callbackå›æ‰§</span><br><span class="line">03-31 09:25:25:604 DEBUG 11344 --- [168.88.132:5672] c.m.publisher.amqp.SpringAmqpTest        : å‘é€æ¶ˆæ¯æˆåŠŸï¼Œæ”¶åˆ° ack!</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ <code>routingKey</code> ä¸ºä¸å­˜åœ¨çš„ red2ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">rabbitTemplate.convertAndSend(<span class="string">&quot;hmall.direct&quot;</span>, <span class="string">&quot;red2&quot;</span>, <span class="string">&quot;hello&quot;</span>, cd);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">03-31 09:50:32:950  WARN 9664 --- [nectionFactory1] o.s.amqp.rabbit.core.RabbitTemplate      : Returned message but no callback available</span><br><span class="line">03-31 09:50:32:951 DEBUG 9664 --- [168.88.132:5672] c.m.publisher.amqp.SpringAmqpTest        : æ”¶åˆ°confirm callbackå›æ‰§</span><br><span class="line">03-31 09:50:32:951 DEBUG 9664 --- [168.88.132:5672] c.m.publisher.amqp.SpringAmqpTest        : å‘é€æ¶ˆæ¯æˆåŠŸï¼Œæ”¶åˆ° ack!</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ <code>exchange</code> ä¸ºä¸å­˜åœ¨çš„ hmall.direct2ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">rabbitTemplate.convertAndSend(<span class="string">&quot;hmall.direct2&quot;</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;hello&quot;</span>, cd);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">03-31 09:52:12:691 ERROR 1792 --- [168.88.132:5672] o.s.a.r.c.CachingConnectionFactory       : Shutdown Signal: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=404, reply-text=NOT_FOUND - no exchange &#x27;hmall.2&#x27; in vhost &#x27;/hmall&#x27;, class-id=60, method-id=40)</span><br><span class="line">03-31 09:52:12:691 DEBUG 1792 --- [nectionFactory1] c.m.publisher.amqp.SpringAmqpTest        : æ”¶åˆ°confirm callbackå›æ‰§</span><br><span class="line">03-31 09:52:12:691 ERROR 1792 --- [nectionFactory1] c.m.publisher.amqp.SpringAmqpTest        : å‘é€æ¶ˆæ¯å¤±è´¥ï¼Œæ”¶åˆ° nack, åŸå›  : channel error; protocol method: #method&lt;channel.close&gt;(reply-code=404, reply-text=NOT_FOUND - no exchange &#x27;hmall.2&#x27; in vhost &#x27;/hmall&#x27;, class-id=60, method-id=40)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºä¼ é€’çš„ <code>RoutingKey </code>æ˜¯é”™è¯¯çš„ï¼Œè·¯ç”±å¤±è´¥åï¼Œè§¦å‘äº† <code>return callback</code>ï¼ŒåŒæ—¶ä¹Ÿæ”¶åˆ°äº† ackã€‚</p>
<p>å½“æˆ‘ä»¬ä¿®æ”¹ä¸ºæ­£ç¡®çš„ <code>RoutingKey</code> ä»¥åï¼Œå°±ä¸ä¼šè§¦å‘ <code>return callback</code> äº†ï¼Œåªæ”¶åˆ°ackã€‚</p>
<p>è€Œå¦‚æœè¿äº¤æ¢æœºéƒ½æ˜¯é”™è¯¯çš„ï¼Œåˆ™åªä¼šæ”¶åˆ° nackã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>å¼€å¯ç”Ÿäº§è€…ç¡®è®¤æ¯”è¾ƒæ¶ˆè€—MQæ€§èƒ½ï¼Œä¸€èˆ¬ä¸å»ºè®®å¼€å¯ã€‚è€Œä¸”å¤§å®¶æ€è€ƒä¸€ä¸‹è§¦å‘ç¡®è®¤çš„å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>è·¯ç”±å¤±è´¥ï¼šä¸€èˆ¬æ˜¯å› ä¸º RoutingKey é”™è¯¯å¯¼è‡´ï¼Œå¾€å¾€æ˜¯ç¼–ç¨‹å¯¼è‡´</li>
<li>äº¤æ¢æœºåç§°é”™è¯¯ï¼šåŒæ ·æ˜¯ç¼–ç¨‹é”™è¯¯å¯¼è‡´</li>
<li>MQ å†…éƒ¨æ•…éšœï¼šè¿™ç§éœ€è¦å¤„ç†ï¼Œä½†æ¦‚ç‡å¾€å¾€è¾ƒä½ã€‚å› æ­¤åªæœ‰å¯¹æ¶ˆæ¯å¯é æ€§è¦æ±‚éå¸¸é«˜çš„ä¸šåŠ¡æ‰éœ€è¦å¼€å¯ï¼Œè€Œä¸”ä»…ä»…éœ€è¦å¼€å¯ConfirmCallback å¤„ç† nack å°±å¯ä»¥äº†ã€‚</li>
</ul>
<h1 id="2-MQçš„å¯é æ€§"><a href="#2-MQçš„å¯é æ€§" class="headerlink" title="2. MQçš„å¯é æ€§"></a>2. MQçš„å¯é æ€§</h1><p>æ¶ˆæ¯åˆ°è¾¾ MQ ä»¥åï¼Œå¦‚æœ MQ ä¸èƒ½åŠæ—¶ä¿å­˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œæ‰€ä»¥ MQ çš„å¯é æ€§ä¹Ÿéå¸¸é‡è¦ã€‚</p>
<h2 id="2-1-æ•°æ®æŒä¹…åŒ–"><a href="#2-1-æ•°æ®æŒä¹…åŒ–" class="headerlink" title="2.1 æ•°æ®æŒä¹…åŒ–"></a>2.1 æ•°æ®æŒä¹…åŒ–</h2><p>ä¸ºäº†æå‡æ€§èƒ½ï¼Œé»˜è®¤æƒ…å†µä¸‹ MQ çš„æ•°æ®éƒ½æ˜¯åœ¨å†…å­˜å­˜å‚¨çš„ä¸´æ—¶æ•°æ®ï¼Œé‡å¯åå°±ä¼šæ¶ˆå¤±ã€‚ä¸ºäº†ä¿è¯æ•°æ®çš„å¯é æ€§ï¼Œå¿…é¡»é…ç½®æ•°æ®æŒä¹…åŒ–ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>äº¤æ¢æœºæŒä¹…åŒ–</li>
<li>é˜Ÿåˆ—æŒä¹…åŒ–</li>
<li>æ¶ˆæ¯æŒä¹…åŒ–</li>
</ul>
<p>æˆ‘ä»¬ä»¥æ§åˆ¶å°ç•Œé¢ä¸ºä¾‹æ¥è¯´æ˜ã€‚</p>
<h3 id="2-1-1-äº¤æ¢æœºæŒä¹…åŒ–"><a href="#2-1-1-äº¤æ¢æœºæŒä¹…åŒ–" class="headerlink" title="2.1.1 äº¤æ¢æœºæŒä¹…åŒ–"></a>2.1.1 äº¤æ¢æœºæŒä¹…åŒ–</h3><p>åœ¨æ§åˆ¶å°çš„ <code>Exchanges</code> é¡µé¢ï¼Œæ·»åŠ äº¤æ¢æœºæ—¶å¯ä»¥é…ç½®äº¤æ¢æœºçš„ <code>Durability </code> å‚æ•°ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84Durability%E5%8F%82%E6%95%B0.png" alt="äº¤æ¢æœºçš„Durabilityå‚æ•°" style="zoom: 80%;">

<p>è®¾ç½®ä¸º <code>Durable</code> å°±æ˜¯æŒä¹…åŒ–æ¨¡å¼ï¼Œ<code>Transient </code> å°±æ˜¯ä¸´æ—¶æ¨¡å¼ã€‚</p>
<h3 id="2-1-2-é˜Ÿåˆ—æŒä¹…åŒ–"><a href="#2-1-2-é˜Ÿåˆ—æŒä¹…åŒ–" class="headerlink" title="2.1.2 é˜Ÿåˆ—æŒä¹…åŒ–"></a>2.1.2 é˜Ÿåˆ—æŒä¹…åŒ–</h3><p>åœ¨æ§åˆ¶å°çš„ Queues é¡µé¢ï¼Œæ·»åŠ é˜Ÿåˆ—æ—¶ï¼ŒåŒæ ·å¯ä»¥é…ç½®é˜Ÿåˆ—çš„ <code>Durability</code> å‚æ•°ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E9%98%9F%E5%88%97%E7%9A%84Durability%E5%8F%82%E6%95%B0.png" alt="é˜Ÿåˆ—çš„Durabilityå‚æ•°" style="zoom:67%;">

<p>è®¾ç½®ä¸º <code>Durable</code> å°±æ˜¯æŒä¹…åŒ–æ¨¡å¼ï¼Œ<code>Transient </code> å°±æ˜¯ä¸´æ—¶æ¨¡å¼ã€‚</p>
<p>é™¤äº†æŒä¹…åŒ–ä»¥å¤–ï¼Œä½ å¯ä»¥çœ‹åˆ°é˜Ÿåˆ—è¿˜æœ‰å¾ˆå¤šå…¶å®ƒå‚æ•°ï¼Œæœ‰ä¸€äº›æˆ‘ä»¬ä¼šåœ¨åæœŸå­¦ä¹ ã€‚</p>
<p><font color="red">PSï¼šSpring åœ¨åˆ›å»ºäº¤æ¢æœºå’Œé˜Ÿåˆ—æ—¶å€™é»˜è®¤å°†ä»–ä»¬å¤„ç†ä¸ºæŒä¹…åŒ–ã€‚</font>ğŸ˜„</p>
<h3 id="2-1-3-æ¶ˆæ¯æŒä¹…åŒ–"><a href="#2-1-3-æ¶ˆæ¯æŒä¹…åŒ–" class="headerlink" title="2.1.3 æ¶ˆæ¯æŒä¹…åŒ–"></a>2.1.3 æ¶ˆæ¯æŒä¹…åŒ–</h3><p>åœ¨æ§åˆ¶å°å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å¾ˆå¤šå‚æ•°ï¼Œè€Œæ¶ˆæ¯çš„æŒä¹…åŒ–æ˜¯è¦é…ç½®ä¸€ä¸ª <code>properties</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E7%9A%84Delivered%20mode%E5%8F%82%E6%95%B0.png" alt="æ¶ˆæ¯çš„Delivered modeå‚æ•°" style="zoom: 80%;">

<p>è®¾ç½®ä¸º <code>2</code> å°±æ˜¯æŒä¹…åŒ–æ¨¡å¼ï¼Œ<code>1 </code> å°±æ˜¯ä¸´æ—¶æ¨¡å¼ã€‚</p>
<p><strong>è¯´æ˜ï¼š</strong></p>
<p>åœ¨å¼€å¯æŒä¹…åŒ–æœºåˆ¶ä»¥åï¼Œå¦‚æœåŒæ—¶è¿˜å¼€å¯äº†ç”Ÿäº§è€…ç¡®è®¤ï¼Œé‚£ä¹ˆ MQ ä¼šåœ¨æ¶ˆæ¯æŒä¹…åŒ–ä»¥åæ‰å‘é€ ACK å›æ‰§ï¼Œè¿›ä¸€æ­¥ç¡®ä¿æ¶ˆæ¯çš„å¯é æ€§ã€‚</p>
<p>ä¸è¿‡å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œä¸ºäº†å‡å°‘ IO æ¬¡æ•°ï¼Œå‘é€åˆ° MQ çš„æ¶ˆæ¯å¹¶ä¸æ˜¯é€æ¡æŒä¹…åŒ–åˆ°æ•°æ®åº“çš„ï¼Œè€Œæ˜¯æ¯éš”ä¸€æ®µæ—¶é—´æ‰¹é‡æŒä¹…åŒ–ã€‚ä¸€èˆ¬é—´éš”åœ¨ 100 æ¯«ç§’å·¦å³ï¼Œè¿™å°±ä¼šå¯¼è‡´ ACK æœ‰ä¸€å®šçš„å»¶è¿Ÿï¼Œå› æ­¤å»ºè®®ç”Ÿäº§è€…ç¡®è®¤å…¨éƒ¨é‡‡ç”¨å¼‚æ­¥æ–¹å¼ã€‚</p>
<h2 id="2-2-LazyQueue"><a href="#2-2-LazyQueue" class="headerlink" title="2.2 LazyQueue"></a>2.2 LazyQueue</h2><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRabbitMQ ä¼šå°†æ¥æ”¶åˆ°çš„ä¿¡æ¯ä¿å­˜åœ¨å†…å­˜ä¸­ä»¥é™ä½æ¶ˆæ¯æ”¶å‘çš„å»¶è¿Ÿã€‚ä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¿™ä¼šå¯¼è‡´æ¶ˆæ¯ç§¯å‹ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æ¶ˆè´¹è€…å®•æœºæˆ–å‡ºç°ç½‘ç»œæ•…éšœ</li>
<li>æ¶ˆæ¯å‘é€é‡æ¿€å¢ï¼Œè¶…è¿‡äº†æ¶ˆè´¹è€…å¤„ç†é€Ÿåº¦</li>
<li>æ¶ˆè´¹è€…å¤„ç†ä¸šåŠ¡å‘ç”Ÿé˜»å¡</li>
</ul>
<p>ä¸€æ—¦å‡ºç°æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼ŒRabbitMQ çš„å†…å­˜å ç”¨å°±ä¼šè¶Šæ¥è¶Šé«˜ï¼Œç›´åˆ°è§¦å‘å†…å­˜é¢„è­¦ä¸Šé™ã€‚æ­¤æ—¶ RabbitMQ ä¼šå°†å†…å­˜æ¶ˆæ¯åˆ·åˆ°ç£ç›˜ä¸Šï¼Œè¿™ä¸ªè¡Œä¸ºæˆä¸º <code>PageOut</code>ï¼Œ <code>PageOut </code> ä¼šè€—è´¹ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸”ä¼šé˜»å¡é˜Ÿåˆ—è¿›ç¨‹ã€‚å› æ­¤åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ RabbitMQ ä¸ä¼šå†å¤„ç†æ–°çš„æ¶ˆæ¯ï¼Œç”Ÿäº§è€…çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«é˜»å¡ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä» RabbitMQ çš„ 3.6.0 ç‰ˆæœ¬å¼€å§‹ï¼Œå°±å¢åŠ äº† Lazy Queues çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æƒ°æ€§é˜Ÿåˆ—ã€‚æƒ°æ€§é˜Ÿåˆ—çš„ç‰¹å¾å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ¥æ”¶åˆ°æ¶ˆæ¯å<strong>ç›´æ¥å­˜å…¥ç£ç›˜è€Œéå†…å­˜</strong></li>
<li>æ¶ˆè´¹è€…è¦æ¶ˆè´¹æ¶ˆæ¯æ—¶æ‰ä¼šä»ç£ç›˜ä¸­è¯»å–å¹¶åŠ è½½åˆ°å†…å­˜(ä¹Ÿå°±æ˜¯æ‡’åŠ è½½)</li>
<li>æ”¯æŒæ•°ç™¾ä¸‡æ¡çš„æ¶ˆæ¯å­˜å‚¨</li>
</ul>
<p>è€Œåœ¨ 3.12 ç‰ˆæœ¬ä¹‹åï¼ŒLazyQueue å·²ç»æˆä¸ºæ‰€æœ‰é˜Ÿåˆ—çš„é»˜è®¤æ ¼å¼ã€‚å› æ­¤å®˜æ–¹æ¨èå‡çº§ MQ ä¸º 3.12 ç‰ˆæœ¬æˆ–è€…æ‰€æœ‰é˜Ÿåˆ—éƒ½è®¾ç½®ä¸º LazyQueue æ¨¡å¼ã€‚</p>
<h3 id="2-2-1-æ§åˆ¶å°é…ç½®Lazyæ¨¡å¼"><a href="#2-2-1-æ§åˆ¶å°é…ç½®Lazyæ¨¡å¼" class="headerlink" title="2.2.1 æ§åˆ¶å°é…ç½®Lazyæ¨¡å¼"></a>2.2.1 æ§åˆ¶å°é…ç½®Lazyæ¨¡å¼</h3><p>åœ¨æ·»åŠ é˜Ÿåˆ—çš„æ—¶å€™ï¼Œæ·»åŠ  <code>x-queue-mod=lazy</code> å‚æ•°å³å¯è®¾ç½®é˜Ÿåˆ—ä¸º Lazy æ¨¡å¼ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E8%AE%BE%E7%BD%AE%E9%98%9F%E5%88%97%E4%B8%BALazy%E6%A8%A1%E5%BC%8F.png" alt="è®¾ç½®é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼"></p>
<h3 id="2-2-2-ä»£ç é…ç½®Lazyæ¨¡å¼"><a href="#2-2-2-ä»£ç é…ç½®Lazyæ¨¡å¼" class="headerlink" title="2.2.2 ä»£ç é…ç½®Lazyæ¨¡å¼"></a>2.2.2 ä»£ç é…ç½®Lazyæ¨¡å¼</h3><p>åœ¨åˆ©ç”¨ SpringAMQP å£°æ˜é˜Ÿåˆ—çš„æ—¶å€™ï¼Œæ·»åŠ  <code>x-queue-mod=lazy</code>å‚æ•°ä¹Ÿå¯è®¾ç½®é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Queue <span class="title function_">lazyQueue</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> QueueBuilder</span><br><span class="line">            .durable(<span class="string">&quot;lazy.queue&quot;</span>)</span><br><span class="line">            .lazy() <span class="comment">// å¼€å¯Lazyæ¨¡å¼</span></span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯é€šè¿‡ <code>QueueBuilder</code> çš„ <code>lazy()</code> å‡½æ•°é…ç½®Lazyæ¨¡å¼ï¼Œåº•å±‚æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> QueueBuilder <span class="title function_">lazy</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> withArgument(<span class="string">&quot;x-queue-mode&quot;</span>, <span class="string">&quot;lazy&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åŸºäºæ³¨è§£æ¥å£°æ˜é˜Ÿåˆ—å¹¶è®¾ç½®ä¸º Lazy æ¨¡å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queuesToDeclare = @Queue(</span></span><br><span class="line"><span class="meta">        name = &quot;lazy.queue&quot;,</span></span><br><span class="line"><span class="meta">        durable = &quot;true&quot;,</span></span><br><span class="line"><span class="meta">        arguments = @Argument(name = &quot;x-queue-mode&quot;, value = &quot;lazy&quot;)</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenLazyQueue</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;æ¥æ”¶åˆ° lazy.queueçš„æ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-3-æ›´æ–°å·²æœ‰é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼"><a href="#2-2-3-æ›´æ–°å·²æœ‰é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼" class="headerlink" title="2.2.3 æ›´æ–°å·²æœ‰é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼"></a>2.2.3 æ›´æ–°å·²æœ‰é˜Ÿåˆ—ä¸ºLazyæ¨¡å¼</h3><p>å¯¹äºå·²ç»å­˜åœ¨çš„é˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥é…ç½®ä¸º Lazy æ¨¡å¼ï¼Œä½†æ˜¯è¦é€šè¿‡è®¾ç½® policy å®ç°ã€‚</p>
<p>å¯ä»¥åŸºäºå‘½ä»¤è¡Œè®¾ç½® policyï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rabbitmqctl set_policy Lazy &quot;^lazy-queue$&quot; &#x27;&#123;&quot;queue-mode&quot;:&quot;lazy&quot;&#125;&#x27; --apply-to queues  </span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤è§£è¯»ï¼š</p>
<ul>
<li><code>rabbitmqctl</code> ï¼šRabbitMQ çš„å‘½ä»¤è¡Œå·¥å…·</li>
<li><code>set_policy</code> ï¼šæ·»åŠ ä¸€ä¸ªç­–ç•¥</li>
<li><code>Lazy</code> ï¼šç­–ç•¥åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰</li>
<li><code>&quot;^lazy-queue$&quot;</code> ï¼šç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…é˜Ÿåˆ—çš„åå­—</li>
<li><code>&#39;&#123;&quot;queue-mode&quot;:&quot;lazy&quot;&#125;&#39;</code> ï¼šè®¾ç½®é˜Ÿåˆ—æ¨¡å¼ä¸ºlazyæ¨¡å¼</li>
<li><code>--apply-to queues</code>ï¼šç­–ç•¥çš„ä½œç”¨å¯¹è±¡ï¼Œæ˜¯æ‰€æœ‰çš„é˜Ÿåˆ—</li>
</ul>
<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨æ§åˆ¶å°é…ç½® policyï¼Œè¿›å…¥åœ¨æ§åˆ¶å°çš„ <code>Admin</code> é¡µé¢ï¼Œç‚¹å‡» <code>Policies</code>ï¼Œå³å¯æ·»åŠ é…ç½®ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%9B%B4%E6%96%B0%E5%B7%B2%E6%9C%89%E9%98%9F%E5%88%97%E4%B8%BAlazy%E6%A8%A1%E5%BC%8F.png" alt="æ›´æ–°å·²æœ‰é˜Ÿåˆ—ä¸ºlazyæ¨¡å¼">

<h1 id="3-æ¶ˆè´¹è€…çš„å¯é æ€§"><a href="#3-æ¶ˆè´¹è€…çš„å¯é æ€§" class="headerlink" title="3. æ¶ˆè´¹è€…çš„å¯é æ€§"></a>3. æ¶ˆè´¹è€…çš„å¯é æ€§</h1><p>å½“ RabbitMQ å‘æ¶ˆè´¹è€…æŠ•é€’æ¶ˆæ¯ä»¥åï¼Œéœ€è¦çŸ¥é“æ¶ˆè´¹è€…çš„å¤„ç†çŠ¶æ€å¦‚ä½•ã€‚å› ä¸ºæ¶ˆæ¯æŠ•é€’ç»™æ¶ˆè´¹è€…å¹¶ä¸ä»£è¡¨å°±ä¸€å®šè¢«æ­£ç¡®æ¶ˆè´¹äº†ï¼Œå¯èƒ½å‡ºç°çš„æ•…éšœæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æ¶ˆæ¯æŠ•é€’çš„è¿‡ç¨‹ä¸­å‡ºç°äº†ç½‘ç»œæ•…éšœ</li>
<li>æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åçªç„¶å®•æœº</li>
<li>æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå› å¤„ç†ä¸å½“å¯¼è‡´å¼‚å¸¸</li>
</ul>
<p>ä¸€æ—¦å‘ç”Ÿä¸Šè¿°æƒ…å†µï¼Œæ¶ˆæ¯ä¹Ÿä¼šä¸¢å¤±ã€‚å› æ­¤ï¼ŒRabbitMQ å¿…é¡»çŸ¥é“æ¶ˆè´¹è€…çš„å¤„ç†çŠ¶æ€ï¼Œä¸€æ—¦æ¶ˆæ¯å¤„ç†å¤±è´¥æ‰èƒ½é‡æ–°æŠ•é€’æ¶ˆæ¯ã€‚</p>
<p>ä½†é—®é¢˜æ¥äº†ï¼šRabbitMQ å¦‚ä½•å¾—çŸ¥æ¶ˆè´¹è€…çš„å¤„ç†çŠ¶æ€å‘¢ï¼Ÿ</p>
<p>æœ¬ç« æˆ‘ä»¬å°±ä¸€èµ·ç ”ç©¶ä¸€ä¸‹æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯æ—¶çš„å¯é æ€§è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 id="2-1-æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶"><a href="#2-1-æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶" class="headerlink" title="2.1 æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶"></a>2.1 æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶</h2><p>ä¸ºäº†ç¡®è®¤æ¶ˆè´¹è€…æ˜¯å¦æˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQ æä¾›äº†æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶(<strong>Consumer Acknowledgement</strong>)ã€‚å³ï¼šå½“æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯ç»“æŸåï¼Œåº”è¯¥å‘ RabbitMQ å‘é€ä¸€ä¸ªå›æ‰§ï¼Œå‘ŠçŸ¥ RabbitMQ è‡ªå·±æ¶ˆæ¯å¤„ç†çŠ¶æ€ã€‚å›æ‰§æœ‰ä¸‰ç§å¯é€‰å€¼ï¼š</p>
<ul>
<li>ackï¼šæˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯</li>
<li>nackï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼ŒRabbitMQéœ€è¦å†æ¬¡æŠ•é€’æ¶ˆæ¯</li>
<li>rejectï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥å¹¶æ‹’ç»è¯¥æ¶ˆæ¯ï¼ŒRabbitMQä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯</li>
</ul>
<p>ä¸€èˆ¬ reject æ–¹å¼ç”¨çš„è¾ƒå°‘ï¼Œé™¤éæ˜¯æ¶ˆæ¯æ ¼å¼æœ‰é—®é¢˜ï¼Œé‚£å°±æ˜¯å¼€å‘é—®é¢˜äº†ã€‚å› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å°†æ¶ˆæ¯å¤„ç†çš„ä»£ç é€šè¿‡ <code>try catch</code> æœºåˆ¶æ•è·ï¼Œæ¶ˆæ¯å¤„ç†æˆåŠŸæ—¶è¿”å› ackï¼Œå¤„ç†å¤±è´¥æ—¶è¿”å› nack.</p>
<p>ç”±äºæ¶ˆæ¯å›æ‰§çš„å¤„ç†ä»£ç æ¯”è¾ƒç»Ÿä¸€ï¼Œå› æ­¤ SpringAMQP å¸®æˆ‘ä»¬å®ç°äº†æ¶ˆæ¯ç¡®è®¤ã€‚å¹¶å…è®¸æˆ‘ä»¬é€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½® ACK å¤„ç†æ–¹å¼ï¼Œæœ‰ä¸‰ç§æ¨¡å¼ï¼š</p>
<ul>
<li><code>none</code>ï¼šä¸å¤„ç†ã€‚å³æ¶ˆæ¯æŠ•é€’ç»™æ¶ˆè´¹è€…åç«‹åˆ»ackï¼Œæ¶ˆæ¯ä¼šç«‹åˆ»ä» MQ åˆ é™¤ã€‚éå¸¸ä¸å®‰å…¨ï¼Œä¸å»ºè®®ä½¿ç”¨</li>
<li><code>manual</code>ï¼šæ‰‹åŠ¨æ¨¡å¼ã€‚éœ€è¦è‡ªå·±åœ¨ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨apiï¼Œå‘é€ <code>ack</code> æˆ– <code>reject</code>ï¼Œå­˜åœ¨ä¸šåŠ¡å…¥ä¾µï¼Œä½†æ›´çµæ´»</li>
<li><code>auto</code>ï¼šè‡ªåŠ¨æ¨¡å¼ã€‚SpringAMQP åˆ©ç”¨ AOP å¯¹æˆ‘ä»¬çš„æ¶ˆæ¯å¤„ç†é€»è¾‘åšäº†ç¯ç»•å¢å¼ºï¼Œå½“ä¸šåŠ¡æ­£å¸¸æ‰§è¡Œæ—¶åˆ™è‡ªåŠ¨è¿”å› <code>ack</code>ã€‚ å½“ä¸šåŠ¡å‡ºç°å¼‚å¸¸æ—¶ï¼Œæ ¹æ®å¼‚å¸¸åˆ¤æ–­è¿”å›ä¸åŒç»“æœï¼š<ul>
<li>å¦‚æœæ˜¯<strong>ä¸šåŠ¡å¼‚å¸¸</strong>ï¼Œä¼šè‡ªåŠ¨è¿”å› <code>nack</code>ï¼›</li>
<li>å¦‚æœæ˜¯<strong>æ¶ˆæ¯å¤„ç†æˆ–æ ¡éªŒå¼‚å¸¸</strong>ï¼Œè‡ªåŠ¨è¿”å› <code>reject</code>;</li>
</ul>
</li>
</ul>
<p>è¿”å› Reject çš„å¸¸è§å¼‚å¸¸æœ‰ï¼š</p>
<p>Starting with version 1.3.2, the default ErrorHandler is now a ConditionalRejectingErrorHandler that rejects (and does not requeue) messages that fail with an irrecoverable error. Specifically, it rejects messages that fail with the following errors:</p>
<ul>
<li>o.s.amqpâ€¦MessageConversionException: Can be thrown when converting the incoming message payload using a MessageConverter.</li>
<li>o.s.messagingâ€¦MessageConversionException: Can be thrown by the conversion service if additional conversion is required when mapping to a @RabbitListener method.</li>
<li>o.s.messagingâ€¦MethodArgumentNotValidException: Can be thrown if validation (for example, @Valid) is used in the listener and the validation fails.</li>
<li>o.s.messagingâ€¦MethodArgumentTypeMismatchException: Can be thrown if the inbound message was converted to a type that is not correct for the target method. For example, the parameter is declared as Message<Foo> but Message<Bar> is received.</Bar></Foo></li>
<li>java.lang.NoSuchMethodException: Added in version 1.6.3.</li>
<li>java.lang.ClassCastException: Added in version 1.6.3.</li>
</ul>
<p>é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ä»¥ä¿®æ”¹ SpringAMQP çš„ ACK å¤„ç†æ–¹å¼ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">acknowledge-mode:</span> <span class="string">none</span> <span class="comment"># ä¸åšå¤„ç†</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ consumer æœåŠ¡çš„ MqRabbitListener ç±»ä¸­çš„æ–¹æ³•ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªæ¶ˆæ¯å¤„ç†çš„å¼‚å¸¸ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;simple.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenSimpleQueue</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…æ”¶åˆ°äº†simple.queueçš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">MessageConversionException</span>(<span class="string">&quot;æ•…æ„çš„&quot;</span>);	<span class="comment">// æ­¤å¤„æ–­ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•å¯ä»¥å‘ç°ï¼šå½“æ¶ˆæ¯å¤„ç†å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œæ¶ˆæ¯ä¾ç„¶è¢« RabbitMQ åˆ é™¤äº†ã€‚</p>
<p>æˆ‘ä»¬å†æ¬¡æŠŠç¡®è®¤æœºåˆ¶ä¿®æ”¹ä¸º autoï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">acknowledge-mode:</span> <span class="string">auto</span> <span class="comment"># è‡ªåŠ¨ack</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å¼‚å¸¸ä½ç½®æ‰“æ–­ç‚¹ï¼Œå†æ¬¡å‘é€æ¶ˆæ¯ï¼Œç¨‹åºå¡åœ¨æ–­ç‚¹æ—¶ï¼Œå¯ä»¥å‘ç°æ­¤æ—¶æ¶ˆæ¯çŠ¶æ€ä¸º <code>unacked </code>(æœªç¡®å®šçŠ¶æ€)ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E7%8A%B6%E6%80%81unacked.png" alt="æ¶ˆæ¯çŠ¶æ€unacked"></p>
<p>æ”¾è¡Œä»¥åï¼Œç”±äºæŠ›å‡ºçš„æ˜¯<strong>æ¶ˆæ¯è½¬æ¢å¼‚å¸¸</strong>ï¼Œå› æ­¤ Spring ä¼šè‡ªåŠ¨è¿”å› <code>reject</code>ï¼Œæ‰€ä»¥æ¶ˆæ¯ä¾ç„¶ä¼šè¢«åˆ é™¤ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E8%A2%AB%E5%88%A0%E9%99%A4.png" alt="æ¶ˆæ¯è¢«åˆ é™¤"></p>
<p>æˆ‘ä»¬å°†å¼‚å¸¸æ”¹ä¸º RuntimeException ç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;simple.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenSimpleQueue</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…æ”¶åˆ°äº†simple.queueçš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ•…æ„çš„&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å¼‚å¸¸ä½ç½®æ‰“æ–­ç‚¹ï¼Œç„¶åå†æ¬¡å‘é€æ¶ˆæ¯æµ‹è¯•ï¼Œç¨‹åºå¡åœ¨æ–­ç‚¹æ—¶ï¼Œå¯ä»¥å‘ç°æ­¤æ—¶æ¶ˆæ¯çŠ¶æ€ä¸º <code>unacked</code> (æœªç¡®å®šçŠ¶æ€)ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E7%8A%B6%E6%80%81unacked.png" alt="æ¶ˆæ¯çŠ¶æ€unacked"></p>
<p>æ”¾è¡Œä»¥åï¼Œç”±äºæŠ›å‡ºçš„æ˜¯ä¸šåŠ¡å¼‚å¸¸ï¼Œæ‰€ä»¥ Spring è¿”å› <code>ack</code>ï¼Œæœ€ç»ˆæ¶ˆæ¯æ¢å¤è‡³ <code>Ready</code> çŠ¶æ€ï¼Œå¹¶ä¸”æ²¡æœ‰è¢« RabbitMQ åˆ é™¤ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E6%81%A2%E5%A4%8D%E8%87%B3Ready%E7%8A%B6%E6%80%81.png" alt="æ¶ˆæ¯æ¢å¤è‡³ReadyçŠ¶æ€"></p>
<p>å½“æˆ‘ä»¬æŠŠé…ç½®æ”¹ä¸º <code>auto</code> æ—¶ï¼Œæ¶ˆæ¯å¤„ç†å¤±è´¥åï¼Œä¼šå›åˆ° RabbitMQï¼Œå¹¶é‡æ–°æŠ•é€’åˆ°æ¶ˆè´¹è€…ã€‚</p>
<h2 id="2-2-å¤±è´¥é‡è¯•æœºåˆ¶"><a href="#2-2-å¤±è´¥é‡è¯•æœºåˆ¶" class="headerlink" title="2.2 å¤±è´¥é‡è¯•æœºåˆ¶"></a>2.2 å¤±è´¥é‡è¯•æœºåˆ¶</h2><p>å½“æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸åï¼Œæ¶ˆæ¯ä¼šä¸æ–­ requeue (é‡å…¥é˜Ÿ)åˆ°é˜Ÿåˆ—ï¼Œå†é‡æ–°å‘é€ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ¶ˆè´¹è€…å†æ¬¡æ‰§è¡Œä¾ç„¶å‡ºé”™ï¼Œæ¶ˆæ¯ä¼šå†æ¬¡ requeue åˆ°é˜Ÿåˆ—ï¼Œå†æ¬¡æŠ•é€’ï¼Œç›´åˆ°æ¶ˆæ¯å¤„ç†æˆåŠŸä¸ºæ­¢ã€‚</p>
<p>æç«¯æƒ…å†µå°±æ˜¯æ¶ˆè´¹è€…ä¸€ç›´æ— æ³•æ‰§è¡ŒæˆåŠŸï¼Œé‚£ä¹ˆæ¶ˆæ¯ requeue å°±ä¼šæ— é™å¾ªç¯ï¼Œå¯¼è‡´ MQ çš„æ¶ˆæ¯å¤„ç†é£™å‡ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å‹åŠ›ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/MQ%E7%9A%84%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E9%A3%99%E5%8D%87.png" alt="MQçš„æ¶ˆæ¯å¤„ç†é£™å‡"></p>
<p>å½“ç„¶ï¼Œä¸Šè¿°æç«¯æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡è¿˜æ˜¯éå¸¸ä½çš„ï¼Œä¸è¿‡ä¸æ€•ä¸€ä¸‡å°±æ€•ä¸‡ä¸€ã€‚ä¸ºäº†åº”å¯¹ä¸Šè¿°æƒ…å†µ Spring åˆæä¾›äº†æ¶ˆè´¹è€…å¤±è´¥é‡è¯•æœºåˆ¶ï¼šåœ¨æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸æ—¶åˆ©ç”¨æœ¬åœ°é‡è¯•ï¼Œè€Œä¸æ˜¯æ— é™åˆ¶çš„ requeue åˆ° mq é˜Ÿåˆ—ã€‚</p>
<p>ä¿®æ”¹ <code>consumer</code> æœåŠ¡çš„ <code>application.yml</code> æ–‡ä»¶ï¼Œæ·»åŠ å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">retry:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment"># å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯•</span></span><br><span class="line">          <span class="attr">initial-interval:</span> <span class="string">1000ms</span> <span class="comment"># åˆè¯†çš„å¤±è´¥ç­‰å¾…æ—¶é•¿ä¸º1ç§’</span></span><br><span class="line">          <span class="attr">multiplier:</span> <span class="number">1</span> <span class="comment"># å¤±è´¥çš„ç­‰å¾…æ—¶é•¿å€æ•°ï¼Œä¸‹æ¬¡ç­‰å¾…æ—¶é•¿ = multiplier * last-interval</span></span><br><span class="line">          <span class="attr">max-attempts:</span> <span class="number">3</span> <span class="comment"># æœ€å¤§é‡è¯•æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">stateless:</span> <span class="literal">true</span> <span class="comment"># trueæ— çŠ¶æ€ï¼›falseæœ‰çŠ¶æ€ã€‚å¦‚æœä¸šåŠ¡ä¸­åŒ…å«äº‹åŠ¡ï¼Œè¿™é‡Œæ”¹ä¸ºfalse</span></span><br></pre></td></tr></table></figure>

<p>é‡å¯ <code>consumer</code> æœåŠ¡ï¼Œé‡å¤ä¹‹å‰çš„æµ‹è¯•ã€‚å¯ä»¥å‘ç°ï¼š</p>
<ul>
<li>æ¶ˆè´¹è€…åœ¨å¤±è´¥åæ¶ˆæ¯æ²¡æœ‰é‡æ–°å›åˆ°MQæ— é™é‡æ–°æŠ•é€’ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°é‡è¯•äº† 3 æ¬¡</li>
<li>æœ¬åœ°é‡è¯• 3 æ¬¡ä»¥åï¼ŒæŠ›å‡ºäº† <code>AmqpRejectAndDontRequeueException</code> å¼‚å¸¸ã€‚æŸ¥çœ‹ RabbitMQ æ§åˆ¶å°ï¼Œå‘ç°æ¶ˆæ¯è¢«åˆ é™¤äº†ï¼Œè¯´æ˜æœ€å SpringAMQP è¿”å›çš„æ˜¯ <code>reject</code></li>
</ul>
<p>ç»“è®ºï¼š</p>
<ul>
<li>å¼€å¯æœ¬åœ°é‡è¯•æ—¶ï¼Œæ¶ˆæ¯å¤„ç†è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œä¸ä¼š requeue åˆ°é˜Ÿåˆ—ï¼Œè€Œæ˜¯åœ¨æ¶ˆè´¹è€…æœ¬åœ°é‡è¯•</li>
<li>é‡è¯•è¾¾åˆ°æœ€å¤§æ¬¡æ•°åï¼ŒSpring ä¼šè¿”å› rejectï¼Œæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒ</li>
</ul>
<h2 id="2-3-å¤±è´¥å¤„ç†ç­–ç•¥"><a href="#2-3-å¤±è´¥å¤„ç†ç­–ç•¥" class="headerlink" title="2.3 å¤±è´¥å¤„ç†ç­–ç•¥"></a>2.3 å¤±è´¥å¤„ç†ç­–ç•¥</h2><p>åœ¨ä¹‹å‰çš„æµ‹è¯•ä¸­ï¼Œæœ¬åœ°æµ‹è¯•è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°åï¼Œæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒã€‚è¿™åœ¨æŸäº›å¯¹äºæ¶ˆæ¯å¯é æ€§è¦æ±‚è¾ƒé«˜çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæ˜¾ç„¶ä¸å¤ªåˆé€‚äº†ã€‚<br>å› æ­¤ Spring å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰é‡è¯•æ¬¡æ•°è€—å°½åçš„æ¶ˆæ¯å¤„ç†ç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥æ˜¯ç”± <code>MessageRecovery</code> æ¥å£æ¥å®šä¹‰çš„ï¼Œå®ƒæœ‰ 3 ä¸ªä¸åŒå®ç°ï¼š</p>
<ul>
<li><code>RejectAndDontRequeueRecoverer</code>ï¼šé‡è¯•è€—å°½åï¼Œç›´æ¥ <code>reject</code>ï¼Œä¸¢å¼ƒæ¶ˆæ¯ã€‚é»˜è®¤å°±æ˜¯è¿™ç§æ–¹å¼ </li>
<li><code>ImmediateRequeueMessageRecoverer</code>ï¼šé‡è¯•è€—å°½åï¼Œè¿”å› <code>nack</code>ï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ </li>
<li><code>RepublishMessageRecoverer</code>ï¼šé‡è¯•è€—å°½åï¼Œå°†å¤±è´¥æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœº</li>
</ul>
<p>æ¯”è¾ƒä¼˜é›…çš„ä¸€ç§å¤„ç†æ–¹æ¡ˆæ˜¯ <code>RepublishMessageRecoverer</code>ï¼Œå¤±è´¥åå°†æ¶ˆæ¯æŠ•é€’åˆ°ä¸€ä¸ªæŒ‡å®šçš„ï¼Œä¸“é—¨å­˜æ”¾å¼‚å¸¸æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼Œåç»­ç”±äººå·¥é›†ä¸­å¤„ç†ã€‚</p>
<p>1ã€åœ¨ <code>consumer</code> æœåŠ¡ä¸­å®šä¹‰å¤„ç†å¤±è´¥æ¶ˆæ¯çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> DirectExchange <span class="title function_">errorMessageExchange</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(<span class="string">&quot;error.direct&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Queue <span class="title function_">errorQueue</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;error.queue&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Binding <span class="title function_">errorBinding</span><span class="params">(Queue errorQueue, DirectExchange errorMessageExchange)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> BindingBuilder.bind(errorQueue).to(errorMessageExchange).with(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€å®šä¹‰ä¸€ä¸ª RepublishMessageRecovererï¼Œå…³è”é˜Ÿåˆ—å’Œäº¤æ¢æœº</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MessageRecoverer <span class="title function_">republishMessageRecoverer</span><span class="params">(RabbitTemplate rabbitTemplate)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RepublishMessageRecoverer</span>(rabbitTemplate, <span class="string">&quot;error.direct&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(name = &quot;spring.rabbitmq.listener.simple.retry.enabled&quot;, havingValue = &quot;true&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ErrorMessageConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">errorMessageExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(<span class="string">&quot;error.direct&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">errorQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;error.queue&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">errorBinding</span><span class="params">(Queue errorQueue, DirectExchange errorMessageExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(errorQueue).to(errorMessageExchange).with(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MessageRecoverer <span class="title function_">republishMessageRecoverer</span><span class="params">(RabbitTemplate rabbitTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RepublishMessageRecoverer</span>(rabbitTemplate, <span class="string">&quot;error.direct&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è¿è¡Œåï¼Œå» <code>error.queue</code> ç‚¹å‡» <code>Get Message</code> æŸ¥çœ‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/error.queue%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF.png" alt="error.queueä¸­çš„é”™è¯¯ä¿¡æ¯"></p>
<h2 id="2-4-ä¸šåŠ¡å¹‚ç­‰æ€§"><a href="#2-4-ä¸šåŠ¡å¹‚ç­‰æ€§" class="headerlink" title="2.4 ä¸šåŠ¡å¹‚ç­‰æ€§"></a>2.4 ä¸šåŠ¡å¹‚ç­‰æ€§</h2><p>ä½•ä¸ºå¹‚ç­‰æ€§ï¼Ÿ</p>
<p><strong>å¹‚ç­‰</strong>æ˜¯ä¸€ä¸ªæ•°å­¦æ¦‚å¿µï¼Œç”¨å‡½æ•°è¡¨è¾¾å¼æ¥æè¿°æ˜¯è¿™æ ·çš„ï¼š<code>f(x) = f(f(x))</code>ï¼Œä¾‹å¦‚æ±‚ç»å¯¹å€¼å‡½æ•°ã€‚</p>
<p>åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œåˆ™æ˜¯æŒ‡åŒä¸€ä¸ªä¸šåŠ¡ï¼Œæ‰§è¡Œä¸€æ¬¡æˆ–å¤šæ¬¡å¯¹ä¸šåŠ¡çŠ¶æ€çš„å½±å“æ˜¯ä¸€è‡´çš„ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>æ ¹æ®idåˆ é™¤æ•°æ®</li>
<li>æŸ¥è¯¢æ•°æ®</li>
<li>æ–°å¢æ•°æ®</li>
</ul>
<p>ä½†æ•°æ®çš„æ›´æ–°å¾€å¾€ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå¦‚æœé‡å¤æ‰§è¡Œå¯èƒ½é€ æˆä¸ä¸€æ ·çš„åæœã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>å–æ¶ˆè®¢å•ï¼Œæ¢å¤åº“å­˜çš„ä¸šåŠ¡ã€‚å¦‚æœå¤šæ¬¡æ¢å¤å°±ä¼šå‡ºç°åº“å­˜é‡å¤å¢åŠ çš„æƒ…å†µ</li>
<li>é€€æ¬¾ä¸šåŠ¡ã€‚é‡å¤é€€æ¬¾å¯¹å•†å®¶è€Œè¨€ä¼šæœ‰ç»æµæŸå¤±ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½é¿å…ä¸šåŠ¡è¢«é‡å¤æ‰§è¡Œã€‚</p>
<p>ç„¶è€Œåœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œç”±äºæ„å¤–ç»å¸¸ä¼šå‡ºç°ä¸šåŠ¡è¢«é‡å¤æ‰§è¡Œçš„æƒ…å†µï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>é¡µé¢å¡é¡¿æ—¶é¢‘ç¹åˆ·æ–°å¯¼è‡´è¡¨å•é‡å¤æäº¤</li>
<li>æœåŠ¡é—´è°ƒç”¨çš„é‡è¯•</li>
<li>MQæ¶ˆæ¯çš„é‡å¤æŠ•é€’</li>
</ul>
<p>æˆ‘ä»¬åœ¨ç”¨æˆ·æ”¯ä»˜æˆåŠŸåä¼šå‘é€MQæ¶ˆæ¯åˆ°äº¤æ˜“æœåŠ¡ï¼Œä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºå·²æ”¯ä»˜ï¼Œå°±å¯èƒ½å‡ºç°æ¶ˆæ¯é‡å¤æŠ•é€’çš„æƒ…å†µã€‚å¦‚æœæ¶ˆè´¹è€…ä¸åšåˆ¤æ–­ï¼Œå¾ˆæœ‰å¯èƒ½å¯¼è‡´æ¶ˆæ¯è¢«æ¶ˆè´¹å¤šæ¬¡ï¼Œå‡ºç°ä¸šåŠ¡æ•…éšœã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<ul>
<li>å‡å¦‚ç”¨æˆ·åˆšåˆšæ”¯ä»˜å®Œæˆï¼Œå¹¶ä¸”æŠ•é€’æ¶ˆæ¯åˆ°äº¤æ˜“æœåŠ¡ï¼Œäº¤æ˜“æœåŠ¡æ›´æ”¹è®¢å•ä¸º<strong>å·²æ”¯ä»˜</strong>çŠ¶æ€ã€‚</li>
<li>ç”±äºæŸç§åŸå› ï¼Œä¾‹å¦‚ç½‘ç»œæ•…éšœå¯¼è‡´ç”Ÿäº§è€…æ²¡æœ‰å¾—åˆ°ç¡®è®¤ï¼Œéš”äº†ä¸€æ®µæ—¶é—´å<strong>é‡æ–°æŠ•é€’</strong>ç»™äº¤æ˜“æœåŠ¡ã€‚</li>
<li>ä½†æ˜¯ï¼Œåœ¨æ–°æŠ•é€’çš„æ¶ˆæ¯è¢«æ¶ˆè´¹ä¹‹å‰ï¼Œç”¨æˆ·é€‰æ‹©äº†é€€æ¬¾ï¼Œå°†è®¢å•çŠ¶æ€æ”¹ä¸ºäº†<strong>å·²é€€æ¬¾</strong>çŠ¶æ€ã€‚</li>
<li>é€€æ¬¾å®Œæˆåï¼Œæ–°æŠ•é€’çš„æ¶ˆæ¯æ‰è¢«æ¶ˆè´¹ï¼Œé‚£ä¹ˆè®¢å•çŠ¶æ€ä¼šè¢«å†æ¬¡æ”¹ä¸º<strong>å·²æ”¯ä»˜</strong>ã€‚ä¸šåŠ¡å¼‚å¸¸ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æƒ³åŠæ³•ä¿è¯æ¶ˆæ¯å¤„ç†çš„å¹‚ç­‰æ€§ã€‚è¿™é‡Œç»™å‡ºä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>å”¯ä¸€æ¶ˆæ¯ID</li>
<li>ä¸šåŠ¡çŠ¶æ€åˆ¤æ–­</li>
</ul>
<h3 id="2-4-1-å”¯ä¸€æ¶ˆæ¯ID"><a href="#2-4-1-å”¯ä¸€æ¶ˆæ¯ID" class="headerlink" title="2.4.1 å”¯ä¸€æ¶ˆæ¯ID"></a>2.4.1 å”¯ä¸€æ¶ˆæ¯ID</h3><p>è¿™ä¸ªæ€è·¯éå¸¸ç®€å•ï¼š</p>
<ol>
<li>æ¯ä¸€æ¡æ¶ˆæ¯éƒ½ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„idï¼Œä¸æ¶ˆæ¯ä¸€èµ·æŠ•é€’ç»™æ¶ˆè´¹è€…</li>
<li>æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åå¤„ç†è‡ªå·±çš„ä¸šåŠ¡ï¼Œä¸šåŠ¡å¤„ç†æˆåŠŸåå°†æ¶ˆæ¯IDä¿å­˜åˆ°æ•°æ®åº“</li>
<li>å¦‚æœä¸‹æ¬¡åˆæ”¶åˆ°ç›¸åŒæ¶ˆæ¯ï¼Œå»æ•°æ®åº“æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™ä¸ºé‡å¤æ¶ˆæ¯æ”¾å¼ƒå¤„ç†</li>
</ol>
<p>æˆ‘ä»¬è¯¥å¦‚ä½•ç»™æ¶ˆæ¯æ·»åŠ å”¯ä¸€IDå‘¢ï¼Ÿ</p>
<p>å…¶å®å¾ˆç®€å•ï¼ŒSpringAMQPçš„ MessageConverter è‡ªå¸¦äº† MessageID çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åªè¦å¼€å¯è¿™ä¸ªåŠŸèƒ½å³å¯ã€‚</p>
<p>ä»¥ Jackson çš„æ¶ˆæ¯è½¬æ¢å™¨ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MessageConverter <span class="title function_">messageConverter</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 1.å®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line">    <span class="type">Jackson2JsonMessageConverter</span> <span class="variable">jjmc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonMessageConverter</span>();</span><br><span class="line">    <span class="comment">// 2.é…ç½®è‡ªåŠ¨åˆ›å»ºæ¶ˆæ¯idï¼Œç”¨äºè¯†åˆ«ä¸åŒæ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸šåŠ¡ä¸­åŸºäºIDåˆ¤æ–­æ˜¯å¦æ˜¯é‡å¤æ¶ˆæ¯</span></span><br><span class="line">    jjmc.setCreateMessageIds(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> jjmc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-2-ä¸šåŠ¡åˆ¤æ–­"><a href="#2-4-2-ä¸šåŠ¡åˆ¤æ–­" class="headerlink" title="2.4.2 ä¸šåŠ¡åˆ¤æ–­"></a>2.4.2 ä¸šåŠ¡åˆ¤æ–­</h3><p>ä¸šåŠ¡åˆ¤æ–­å°±æ˜¯åŸºäºä¸šåŠ¡æœ¬èº«çš„é€»è¾‘æˆ–çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦æ˜¯é‡å¤çš„è¯·æ±‚æˆ–æ¶ˆæ¯ï¼Œä¸åŒçš„ä¸šåŠ¡åœºæ™¯åˆ¤æ–­çš„æ€è·¯ä¹Ÿä¸ä¸€æ ·ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬å½“å‰æ¡ˆä¾‹ä¸­ï¼Œå¤„ç†æ¶ˆæ¯çš„ä¸šåŠ¡é€»è¾‘æ˜¯æŠŠè®¢å•çŠ¶æ€ä»æœªæ”¯ä»˜ä¿®æ”¹ä¸ºå·²æ”¯ä»˜ã€‚å› æ­¤æˆ‘ä»¬å°±å¯ä»¥åœ¨æ‰§è¡Œä¸šåŠ¡æ—¶åˆ¤æ–­è®¢å•çŠ¶æ€æ˜¯å¦æ˜¯æœªæ”¯ä»˜ï¼Œå¦‚æœä¸æ˜¯åˆ™è¯æ˜è®¢å•å·²ç»è¢«å¤„ç†è¿‡ï¼Œæ— éœ€é‡å¤å¤„ç†ã€‚</p>
<p>ç›¸æ¯”è¾ƒè€Œè¨€ï¼Œæ¶ˆæ¯IDçš„æ–¹æ¡ˆéœ€è¦æ”¹é€ åŸæœ‰çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘æ›´æ¨èä½¿ç”¨ä¸šåŠ¡åˆ¤æ–­çš„æ–¹æ¡ˆã€‚</p>
<p>ä»¥æ”¯ä»˜ä¿®æ”¹è®¢å•çš„ä¸šåŠ¡ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>OrderServiceImpl</code> ä¸­çš„ <code>markOrderPaySuccess</code> æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">markOrderPaySuccess</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="comment">// 1.æŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Order</span> <span class="variable">old</span> <span class="operator">=</span> getById(orderId);</span><br><span class="line">    <span class="comment">// 2.åˆ¤æ–­è®¢å•çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">if</span> (old == <span class="literal">null</span> || old.getStatus() != <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// è®¢å•ä¸å­˜åœ¨æˆ–è€…è®¢å•çŠ¶æ€ä¸æ˜¯1ï¼Œæ”¾å¼ƒå¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 3.å°è¯•æ›´æ–°è®¢å•</span></span><br><span class="line">    <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Order</span>();</span><br><span class="line">    order.setId(orderId);</span><br><span class="line">    order.setStatus(<span class="number">2</span>);</span><br><span class="line">    order.setPayTime(LocalDateTime.now());</span><br><span class="line">    updateById(order);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç é€»è¾‘ä¸Šç¬¦åˆäº†å¹‚ç­‰åˆ¤æ–­çš„éœ€æ±‚ï¼Œä½†æ˜¯ç”±äºåˆ¤æ–­å’Œæ›´æ–°æ˜¯ä¸¤æ­¥åŠ¨ä½œï¼Œå› æ­¤åœ¨æå°æ¦‚ç‡ä¸‹å¯èƒ½å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åˆå¹¶ä¸Šè¿°æ“ä½œä¸ºè¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">markOrderPaySuccess</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="comment">// UPDATE `order` SET status = ? , pay_time = ? WHERE id = ? AND status = 1</span></span><br><span class="line">    lambdaUpdate()</span><br><span class="line">            .set(Order::getStatus, <span class="number">2</span>)</span><br><span class="line">            .set(Order::getPayTime, LocalDateTime.now())</span><br><span class="line">            .eq(Order::getId, orderId)</span><br><span class="line">            .eq(Order::getStatus, <span class="number">1</span>)</span><br><span class="line">            .update();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„çœ‹ï¼Œä¸Šè¿°ä»£ç ç­‰åŒäºè¿™æ ·çš„ SQL è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `<span class="keyword">order</span>` <span class="keyword">SET</span> status <span class="operator">=</span> ? , pay_time <span class="operator">=</span> ? <span class="keyword">WHERE</span> id <span class="operator">=</span> ? <span class="keyword">AND</span> status <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åœ¨ where æ¡ä»¶ä¸­é™¤äº†åˆ¤æ–­ id ä»¥å¤–ï¼Œè¿˜åŠ ä¸Šäº† status å¿…é¡»ä¸º1çš„æ¡ä»¶ã€‚å¦‚æœæ¡ä»¶ä¸ç¬¦(è¯´æ˜è®¢å•å·²æ”¯ä»˜)ï¼Œåˆ™ SQL åŒ¹é…ä¸åˆ°æ•°æ®ï¼Œæ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚</p>
<h2 id="2-5-å…œåº•æ–¹æ¡ˆ"><a href="#2-5-å…œåº•æ–¹æ¡ˆ" class="headerlink" title="2.5 å…œåº•æ–¹æ¡ˆ"></a>2.5 å…œåº•æ–¹æ¡ˆ</h2><p>è™½ç„¶æˆ‘ä»¬åˆ©ç”¨å„ç§æœºåˆ¶å°½å¯èƒ½å¢åŠ äº†æ¶ˆæ¯çš„å¯é æ€§ï¼Œä½†ä¹Ÿä¸å¥½è¯´èƒ½ä¿è¯æ¶ˆæ¯ 100% çš„å¯é ã€‚ä¸‡ä¸€çœŸçš„ MQ é€šçŸ¥å¤±è´¥è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æœ‰æ²¡æœ‰å…¶å®ƒå…œåº•æ–¹æ¡ˆï¼Œèƒ½å¤Ÿç¡®ä¿è®¢å•çš„æ”¯ä»˜çŠ¶æ€ä¸€è‡´å‘¢ï¼Ÿ</p>
<p>å…¶å®æ€æƒ³å¾ˆç®€å•ï¼šæ—¢ç„¶ MQ é€šçŸ¥ä¸ä¸€å®šå‘é€åˆ°äº¤æ˜“æœåŠ¡ï¼Œé‚£ä¹ˆäº¤æ˜“æœåŠ¡å°±å¿…é¡»è‡ªå·±<strong>ä¸»åŠ¨å»æŸ¥è¯¢</strong>æ”¯ä»˜çŠ¶æ€ã€‚è¿™æ ·å³ä¾¿æ”¯ä»˜æœåŠ¡çš„ MQ é€šçŸ¥å¤±è´¥ï¼Œæˆ‘ä»¬ä¾ç„¶èƒ½é€šè¿‡ä¸»åŠ¨æŸ¥è¯¢æ¥ä¿è¯è®¢å•çŠ¶æ€çš„ä¸€è‡´ã€‚</p>
<p>æµç¨‹å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%9C%8D%E5%8A%A1%E6%B5%81%E7%A8%8B.png" alt="æœåŠ¡æµç¨‹" style="zoom: 50%;">

<p>å›¾ä¸­é»„è‰²çº¿åœˆèµ·æ¥çš„éƒ¨åˆ†å°±æ˜¯ MQ é€šçŸ¥å¤±è´¥åçš„å…œåº•å¤„ç†æ–¹æ¡ˆï¼Œç”±äº¤æ˜“æœåŠ¡è‡ªå·±ä¸»åŠ¨å»æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ã€‚</p>
<p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œäº¤æ˜“æœåŠ¡å¹¶ä¸çŸ¥é“ç”¨æˆ·ä¼šåœ¨ä»€ä¹ˆæ—¶å€™æ”¯ä»˜ï¼Œå¦‚æœæŸ¥è¯¢çš„æ—¶æœºä¸æ­£ç¡®(æ¯”å¦‚æŸ¥è¯¢çš„æ—¶å€™ç”¨æˆ·æ­£åœ¨æ”¯ä»˜ä¸­)ï¼Œå¯èƒ½æŸ¥è¯¢åˆ°çš„æ”¯ä»˜çŠ¶æ€ä¹Ÿä¸æ­£ç¡®ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬åˆ°åº•è¯¥åœ¨ä»€ä¹ˆæ—¶é—´ä¸»åŠ¨æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªæ—¶é—´æ˜¯æ— æ³•ç¡®å®šçš„ï¼Œå› æ­¤ï¼Œé€šå¸¸æˆ‘ä»¬é‡‡å–çš„æªæ–½å°±æ˜¯åˆ©ç”¨<strong>å®šæ—¶ä»»åŠ¡</strong>å®šæœŸæŸ¥è¯¢ï¼Œä¾‹å¦‚æ¯éš”20ç§’å°±æŸ¥è¯¢ä¸€æ¬¡ï¼Œå¹¶åˆ¤æ–­æ”¯ä»˜çŠ¶æ€ã€‚å¦‚æœå‘ç°è®¢å•å·²ç»æ”¯ä»˜ï¼Œåˆ™ç«‹åˆ»æ›´æ–°è®¢å•çŠ¶æ€ä¸ºå·²æ”¯ä»˜å³å¯ã€‚å®šæ—¶ä»»åŠ¡å…·ä½“çš„å®ç°è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ğŸ˜</p>
<p>è‡³æ­¤ï¼Œæ¶ˆæ¯å¯é æ€§çš„é—®é¢˜å·²ç»è§£å†³äº†ã€‚</p>
<p>ç»¼ä¸Šï¼Œæ”¯ä»˜æœåŠ¡ä¸äº¤æ˜“æœåŠ¡ä¹‹é—´çš„è®¢å•çŠ¶æ€ä¸€è‡´æ€§æ˜¯å¦‚ä½•ä¿è¯çš„ï¼Ÿ</p>
<ul>
<li>é¦–å…ˆï¼Œæ”¯ä»˜æœåŠ¡ä¼šæ­£åœ¨ç”¨æˆ·æ”¯ä»˜æˆåŠŸä»¥ååˆ©ç”¨ MQ æ¶ˆæ¯é€šçŸ¥äº¤æ˜“æœåŠ¡ï¼Œå®Œæˆè®¢å•çŠ¶æ€åŒæ­¥ã€‚</li>
<li>å…¶æ¬¡ï¼Œä¸ºäº†ä¿è¯MQæ¶ˆæ¯çš„å¯é æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ã€æ¶ˆè´¹è€…ç¡®è®¤ã€æ¶ˆè´¹è€…å¤±è´¥é‡è¯•ç­‰ç­–ç•¥ï¼Œç¡®ä¿æ¶ˆæ¯æŠ•é€’çš„å¯é æ€§</li>
<li>æœ€åï¼Œæˆ‘ä»¬è¿˜åœ¨äº¤æ˜“æœåŠ¡è®¾ç½®äº†å®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸæŸ¥è¯¢è®¢å•æ”¯ä»˜çŠ¶æ€ã€‚è¿™æ ·å³ä¾¿ MQ é€šçŸ¥å¤±è´¥ï¼Œè¿˜å¯ä»¥åˆ©ç”¨å®šæ—¶ä»»åŠ¡ä½œä¸ºå…œåº•æ–¹æ¡ˆï¼Œç¡®ä¿è®¢å•æ”¯ä»˜çŠ¶æ€çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
</ul>
<h1 id="4-å»¶è¿Ÿæ¶ˆæ¯"><a href="#4-å»¶è¿Ÿæ¶ˆæ¯" class="headerlink" title="4. å»¶è¿Ÿæ¶ˆæ¯"></a>4. å»¶è¿Ÿæ¶ˆæ¯</h1><p>åœ¨ç”µå•†çš„æ”¯ä»˜ä¸šåŠ¡ä¸­ï¼Œå¯¹äºä¸€äº›åº“å­˜æœ‰é™çš„å•†å“ï¼Œä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé€šå¸¸éƒ½ä¼šåœ¨ç”¨æˆ·ä¸‹å•æ—¶ç«‹åˆ»æ‰£å‡å•†å“åº“å­˜ã€‚ä¾‹å¦‚ç”µå½±é™¢è´­ç¥¨ã€é«˜é“è´­ç¥¨ï¼Œä¸‹å•åå°±ä¼šé”å®šåº§ä½èµ„æºï¼Œå…¶ä»–äººæ— æ³•é‡å¤è´­ä¹°ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå‡å¦‚ç”¨æˆ·ä¸‹å•åä¸€ç›´ä¸ä»˜æ¬¾ï¼Œå°±ä¼šä¸€ç›´å æœ‰åº“å­˜èµ„æºï¼Œå¯¼è‡´å…¶ä»–å®¢æˆ·æ— æ³•æ­£å¸¸äº¤æ˜“ï¼Œæœ€ç»ˆå¯¼è‡´å•†æˆ·åˆ©ç›Šå—æŸï¼</p>
<p>å› æ­¤ï¼Œç”µå•†ä¸­é€šå¸¸çš„åšæ³•å°±æ˜¯ï¼š<strong>å¯¹äºè¶…è¿‡ä¸€å®šæ—¶é—´æœªæ”¯ä»˜çš„è®¢å•ï¼Œåº”è¯¥ç«‹åˆ»å–æ¶ˆè®¢å•å¹¶é‡Šæ”¾å ç”¨çš„åº“å­˜</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè®¢å•æ”¯ä»˜è¶…æ—¶æ—¶é—´ä¸º30åˆ†é’Ÿï¼Œåˆ™æˆ‘ä»¬åº”è¯¥åœ¨ç”¨æˆ·ä¸‹å•åçš„ç¬¬30åˆ†é’Ÿæ£€æŸ¥è®¢å•æ”¯ä»˜çŠ¶æ€ï¼Œå¦‚æœå‘ç°æœªæ”¯ä»˜ï¼Œåº”è¯¥ç«‹åˆ»å–æ¶ˆè®¢å•ï¼Œé‡Šæ”¾åº“å­˜ã€‚</p>
<p>ä½†é—®é¢˜æ¥äº†ï¼šå¦‚ä½•æ‰èƒ½å‡†ç¡®çš„å®ç°åœ¨ä¸‹å•åç¬¬30åˆ†é’Ÿå»æ£€æŸ¥æ”¯ä»˜çŠ¶æ€å‘¢ï¼Ÿ</p>
<p>åƒè¿™ç§åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ‰æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>å»¶è¿Ÿä»»åŠ¡</strong>ï¼Œè€Œè¦å®ç°å»¶è¿Ÿä»»åŠ¡ï¼Œæœ€ç®€å•çš„æ–¹æ¡ˆå°±æ˜¯åˆ©ç”¨ MQ çš„å»¶è¿Ÿæ¶ˆæ¯äº†ã€‚</p>
<p>åœ¨ RabbitMQ ä¸­å®ç°å»¶è¿Ÿæ¶ˆæ¯ä¹Ÿæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ­»ä¿¡äº¤æ¢æœº+TTL</li>
<li>å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶</li>
</ul>
<p>è¿™ä¸€ç« æˆ‘ä»¬å°±ä¸€èµ·ç ”ç©¶ä¸‹è¿™ä¸¤ç§æ–¹æ¡ˆçš„å®ç°æ–¹å¼ï¼Œä»¥åŠä¼˜ç¼ºç‚¹ã€‚</p>
<h2 id="4-1-æ­»ä¿¡äº¤æ¢æœºå’Œå»¶è¿Ÿæ¶ˆæ¯"><a href="#4-1-æ­»ä¿¡äº¤æ¢æœºå’Œå»¶è¿Ÿæ¶ˆæ¯" class="headerlink" title="4.1 æ­»ä¿¡äº¤æ¢æœºå’Œå»¶è¿Ÿæ¶ˆæ¯"></a>4.1 æ­»ä¿¡äº¤æ¢æœºå’Œå»¶è¿Ÿæ¶ˆæ¯</h2><p>é¦–å…ˆæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹åŸºäºæ­»ä¿¡äº¤æ¢æœºçš„å»¶è¿Ÿæ¶ˆæ¯æ–¹æ¡ˆã€‚</p>
<h3 id="4-1-1-æ­»ä¿¡äº¤æ¢æœº"><a href="#4-1-1-æ­»ä¿¡äº¤æ¢æœº" class="headerlink" title="4.1.1 æ­»ä¿¡äº¤æ¢æœº"></a>4.1.1 æ­»ä¿¡äº¤æ¢æœº</h3><p>ä»€ä¹ˆæ˜¯æ­»ä¿¡ï¼Ÿ</p>
<p>å½“ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ»¡è¶³ä¸‹åˆ—æƒ…å†µä¹‹ä¸€æ—¶ï¼Œå¯ä»¥æˆä¸ºæ­»ä¿¡(dead letter)ï¼š</p>
<ul>
<li>æ¶ˆè´¹è€…ä½¿ç”¨ <code>basic.reject</code> æˆ–  <code>basic.nack </code>å£°æ˜æ¶ˆè´¹å¤±è´¥ï¼Œå¹¶ä¸”æ¶ˆæ¯çš„ <code>requeue</code> å‚æ•°è®¾ç½®ä¸º false</li>
<li>æ¶ˆæ¯æ˜¯ä¸€ä¸ªè¿‡æœŸæ¶ˆæ¯ï¼Œè¶…æ—¶æ— äººæ¶ˆè´¹</li>
<li>è¦æŠ•é€’çš„é˜Ÿåˆ—æ¶ˆæ¯æ»¡äº†ï¼Œæ— æ³•æŠ•é€’</li>
</ul>
<p>å¦‚æœä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å·²ç»æˆä¸ºæ­»ä¿¡ï¼Œå¹¶ä¸”è¿™ä¸ªé˜Ÿåˆ—é€šè¿‡ <code>dead-letter-exchange</code> å±æ€§æŒ‡å®šäº†ä¸€ä¸ªäº¤æ¢æœºï¼Œé‚£ä¹ˆé˜Ÿåˆ—ä¸­çš„æ­»ä¿¡å°±ä¼šæŠ•é€’åˆ°è¿™ä¸ªäº¤æ¢æœºä¸­ï¼Œè€Œè¿™ä¸ªäº¤æ¢æœºå°±ç§°ä¸º <strong>æ­»ä¿¡äº¤æ¢æœº</strong>(Dead Letter Exchange)ã€‚è€Œæ­¤æ—¶åŠ å…¥æœ‰é˜Ÿåˆ—ä¸æ­»ä¿¡äº¤æ¢æœºç»‘å®šï¼Œåˆ™æœ€ç»ˆæ­»ä¿¡å°±ä¼šè¢«æŠ•é€’åˆ°è¿™ä¸ªé˜Ÿåˆ—ä¸­ã€‚</p>
<p>æ­»ä¿¡äº¤æ¢æœºæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>
<ul>
<li>æ”¶é›†é‚£äº›å› å¤„ç†å¤±è´¥è€Œè¢«æ‹’ç»çš„æ¶ˆæ¯</li>
<li>æ”¶é›†é‚£äº›å› é˜Ÿåˆ—æ»¡äº†è€Œè¢«æ‹’ç»çš„æ¶ˆæ¯</li>
<li>æ”¶é›†å› TTL(æœ‰æ•ˆæœŸ)åˆ°æœŸçš„æ¶ˆæ¯</li>
</ul>
<h3 id="4-1-2-å»¶è¿Ÿæ¶ˆæ¯"><a href="#4-1-2-å»¶è¿Ÿæ¶ˆæ¯" class="headerlink" title="4.1.2 å»¶è¿Ÿæ¶ˆæ¯"></a>4.1.2 å»¶è¿Ÿæ¶ˆæ¯</h3><p>å‰é¢ä¸¤ç§ä½œç”¨åœºæ™¯å¯ä»¥çœ‹åšæ˜¯æŠŠæ­»ä¿¡äº¤æ¢æœºå½“åšä¸€ç§æ¶ˆæ¯å¤„ç†çš„æœ€ç»ˆå…œåº•æ–¹æ¡ˆï¼Œä¸æ¶ˆè´¹è€…é‡è¯•æ—¶è®²çš„ <code>RepublishMessageRecoverer</code> ä½œç”¨ç±»ä¼¼ã€‚</p>
<p>è€Œæœ€åä¸€ç§åœºæ™¯ï¼Œå¤§å®¶è®¾æƒ³ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼š</p>
<p>å¦‚å›¾ï¼Œæœ‰ä¸€ç»„ç»‘å®šçš„äº¤æ¢æœº <code>ttl.fanout</code> å’Œé˜Ÿåˆ— <code>ttl.queue</code>ã€‚ä½†æ˜¯ <code>ttl.queue</code> æ²¡æœ‰æ¶ˆè´¹è€…ç›‘å¬ï¼Œè€Œæ˜¯è®¾å®šäº†æ­»ä¿¡äº¤æ¢æœº<code>hmall.direct</code>ï¼Œè€Œé˜Ÿåˆ— <code>direct.queue1 </code> åˆ™ä¸æ­»ä¿¡äº¤æ¢æœºç»‘å®šï¼Œ<code>RoutingKey</code> æ˜¯ <code>blue</code>ï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%9C%BA%E6%99%AF.png" alt="åœºæ™¯"></p>
<p>å‡å¦‚æˆ‘ä»¬ç°åœ¨å‘é€ä¸€æ¡æ¶ˆæ¯åˆ° <code>ttl.fanout</code>ï¼Œ<code>RoutingKey</code> ä¸º <code>blue</code>ï¼Œå¹¶è®¾ç½®æ¶ˆæ¯çš„<strong>æœ‰æ•ˆæœŸ</strong>ä¸º 5000 æ¯«ç§’ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%8F%91%E9%80%81%E4%B8%80%E6%9D%A1%E6%B6%88%E6%81%AF%E5%88%B0ttl.fanout.png" alt="å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°ttl.fanout"></p>
<p><strong>æ³¨æ„</strong>ï¼šå°½ç®¡è¿™é‡Œçš„ <code>ttl.fanout</code> ä¸éœ€è¦ <code>RoutingKey</code>ï¼Œä½†æ˜¯å½“æ¶ˆæ¯å˜ä¸ºæ­»ä¿¡å¹¶æŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºæ—¶ï¼Œä¼šæ²¿ç”¨ä¹‹å‰çš„ <code>RoutingKey</code>ï¼Œè¿™æ · <code>hmall.direct </code>æ‰èƒ½æ­£ç¡®è·¯ç”±æ¶ˆæ¯ã€‚</p>
<p>æ¶ˆæ¯è‚¯å®šä¼šè¢«æŠ•é€’åˆ° <code>ttl.queue</code> ä¹‹åï¼Œç”±äºæ²¡æœ‰æ¶ˆè´¹è€…ï¼Œå› æ­¤æ¶ˆæ¯æ— äººæ¶ˆè´¹ã€‚5ç§’ä¹‹åï¼Œæ¶ˆæ¯çš„æœ‰æ•ˆæœŸåˆ°æœŸï¼Œæˆä¸ºæ­»ä¿¡ï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/5%E7%A7%92%E5%90%8E%E6%B6%88%E6%81%AF%E6%88%90%E4%B8%BA%E6%AD%BB%E4%BF%A1.png" alt="5ç§’åæ¶ˆæ¯æˆä¸ºæ­»ä¿¡"><br>æ­»ä¿¡è¢«å†æ¬¡æŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœº <code>hmall.direct</code>ï¼Œå¹¶æ²¿ç”¨ä¹‹å‰çš„ <code>RoutingKey</code>ï¼Œä¹Ÿå°±æ˜¯ <code>blue</code>ï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%AD%BB%E4%BF%A1%E8%A2%AB%E5%86%8D%E6%AC%A1%E6%8A%95%E9%80%92%E5%88%B0%E6%AD%BB%E4%BF%A1%E4%BA%A4%E6%8D%A2%E6%9C%BAhmall.direct.png" alt="æ­»ä¿¡è¢«å†æ¬¡æŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºhmall.direct"></p>
<p>ç”±äº <code>direct.queue1</code> ä¸ <code>hmall.direct</code> ç»‘å®šçš„ <code>key</code> æ˜¯ <code>blue</code>ï¼Œå› æ­¤æœ€ç»ˆæ¶ˆæ¯è¢«æˆåŠŸè·¯ç”±åˆ° <code>direct.queue1</code>ï¼Œå¦‚æœæ­¤æ—¶æœ‰æ¶ˆè´¹è€…ä¸<code>direct.queue1</code> ç»‘å®šï¼Œ ä¹Ÿå°±èƒ½æˆåŠŸæ¶ˆè´¹æ¶ˆæ¯äº†ã€‚ä½†æ­¤æ—¶å·²ç»æ˜¯5ç§’é’Ÿä»¥åäº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/5%E7%A7%92%E9%92%9F%E4%BB%A5%E5%90%8E%E6%B6%88%E8%B4%B9%E6%B6%88%E6%81%AF.png" alt="5ç§’é’Ÿä»¥åæ¶ˆè´¹æ¶ˆæ¯"><br>ä¹Ÿå°±æ˜¯è¯´ï¼Œpublisher å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä½†æœ€ç»ˆ consumer åœ¨5ç§’åæ‰æ”¶åˆ°æ¶ˆæ¯ã€‚æˆ‘ä»¬æˆåŠŸå®ç°äº†<strong>å»¶è¿Ÿæ¶ˆæ¯</strong>ã€‚</p>
<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>RabbitMQ çš„æ¶ˆæ¯è¿‡æœŸæ˜¯åŸºäºè¿½æº¯æ–¹å¼æ¥å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ä¸€ä¸ªæ¶ˆæ¯çš„ TTL åˆ°æœŸä»¥åä¸ä¸€å®šä¼šè¢«ç§»é™¤æˆ–æŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºï¼Œè€Œæ˜¯åœ¨æ¶ˆæ¯æ°å¥½å¤„äºé˜Ÿé¦–æ—¶æ‰ä¼šè¢«å¤„ç†ã€‚</p>
<p>å½“é˜Ÿåˆ—ä¸­æ¶ˆæ¯å †ç§¯å¾ˆå¤šçš„æ—¶å€™ï¼Œè¿‡æœŸæ¶ˆæ¯å¯èƒ½ä¸ä¼šè¢«æŒ‰æ—¶å¤„ç†ï¼Œå› æ­¤ä½ è®¾ç½®çš„ TTL æ—¶é—´ä¸ä¸€å®šå‡†ç¡®ã€‚</p>
<h2 id="4-2-DelayExchangeæ’ä»¶"><a href="#4-2-DelayExchangeæ’ä»¶" class="headerlink" title="4.2.DelayExchangeæ’ä»¶"></a>4.2.DelayExchangeæ’ä»¶</h2><p>åŸºäºæ­»ä¿¡é˜Ÿåˆ—è™½ç„¶å¯ä»¥å®ç°å»¶è¿Ÿæ¶ˆæ¯ï¼Œä½†æ˜¯å¤ªéº»çƒ¦äº†ã€‚å› æ­¤ RabbitMQ ç¤¾åŒºæä¾›äº†ä¸€ä¸ªå»¶è¿Ÿæ¶ˆæ¯æ’ä»¶æ¥å®ç°ç›¸åŒçš„æ•ˆæœã€‚</p>
<p>å®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼š<a href="https://blog.rabbitmq.com/posts/2015/04/scheduling-messages-with-rabbitmq">https://blog.rabbitmq.com/posts/2015/04/scheduling-messages-with-rabbitmq</a></p>
<h3 id="4-2-1-ä¸‹è½½"><a href="#4-2-1-ä¸‹è½½" class="headerlink" title="4.2.1.ä¸‹è½½"></a>4.2.1.ä¸‹è½½</h3><p>æ’ä»¶ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/rabbitmq/rabbitmq-delayed-message-exchange">https://github.com/rabbitmq/rabbitmq-delayed-message-exchange</a></p>
<p>ç”±äºæˆ‘ä»¬å®‰è£…çš„MQæ˜¯ <code>3.8</code> ç‰ˆæœ¬ï¼Œå› æ­¤è¿™é‡Œä¸‹è½½ <code>3.8.17</code> ç‰ˆæœ¬ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/DelayExchange%E6%8F%92%E4%BB%B6v3.8.17.png" alt="DelayExchangeæ’ä»¶v3.8.17"></p>
<h3 id="4-2-2-å®‰è£…"><a href="#4-2-2-å®‰è£…" class="headerlink" title="4.2.2.å®‰è£…"></a>4.2.2.å®‰è£…</h3><p>å› ä¸ºæˆ‘ä»¬æ˜¯åŸºäº Docker å®‰è£…ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŸ¥çœ‹ RabbitMQ çš„æ’ä»¶ç›®å½•å¯¹åº”çš„æ•°æ®å·ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker volume inspect mq-plugins</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2024-06-19T09:22:59+08:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/mq-plugins/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;mq-plugins&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ’ä»¶ç›®å½•è¢«æŒ‚è½½åˆ°äº† <code>/var/lib/docker/volumes/mq-plugins/_data</code> è¿™ä¸ªç›®å½•ï¼Œæˆ‘ä»¬ä¸Šä¼ æ’ä»¶åˆ°è¯¥ç›®å½•ä¸‹ã€‚</p>
<p>æ¥ä¸‹æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -it mq rabbitmq-plugins enable rabbitmq_delayed_message_exchange</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/DelayExchange%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png" alt="DelayExchangeæ’ä»¶å®‰è£…ç»“æœ"></p>
<h3 id="4-2-3-å£°æ˜å»¶è¿Ÿäº¤æ¢æœº"><a href="#4-2-3-å£°æ˜å»¶è¿Ÿäº¤æ¢æœº" class="headerlink" title="4.2.3.å£°æ˜å»¶è¿Ÿäº¤æ¢æœº"></a>4.2.3.å£°æ˜å»¶è¿Ÿäº¤æ¢æœº</h3><p>åŸºäºæ³¨è§£æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">        value = @Queue(name = &quot;delay.queue&quot;, durable = &quot;true&quot;),</span></span><br><span class="line"><span class="meta">        exchange = @Exchange(name = &quot;delay.direct&quot;, delayed = &quot;true&quot;),</span></span><br><span class="line"><span class="meta">        key = &quot;delay&quot;</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenDelayMessage</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;æ¥æ”¶åˆ°delay.queueçš„å»¶è¿Ÿæ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŸºäº <code>@Bean  </code> çš„æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayExchangeConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">delayExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder</span><br><span class="line">                .directExchange(<span class="string">&quot;delay.direct&quot;</span>) <span class="comment">// æŒ‡å®šäº¤æ¢æœºç±»å‹å’Œåç§°</span></span><br><span class="line">                .delayed() <span class="comment">// è®¾ç½®delayçš„å±æ€§ä¸ºtrue</span></span><br><span class="line">                .durable(<span class="literal">true</span>) <span class="comment">// æŒä¹…åŒ–</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">delayedQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;delay.queue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">delayQueueBinding</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(delayedQueue()).to(delayExchange()).with(<span class="string">&quot;delay&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-4-å‘é€å»¶è¿Ÿæ¶ˆæ¯"><a href="#4-2-4-å‘é€å»¶è¿Ÿæ¶ˆæ¯" class="headerlink" title="4.2.4.å‘é€å»¶è¿Ÿæ¶ˆæ¯"></a>4.2.4.å‘é€å»¶è¿Ÿæ¶ˆæ¯</h3><p>å‘é€æ¶ˆæ¯æ—¶ï¼Œå¿…é¡»é€šè¿‡ <code>x-delay</code> å±æ€§è®¾å®šå»¶è¿Ÿæ—¶é—´ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testPublisherDelayMessage</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;hello, delayed message&quot;</span>;</span><br><span class="line">    <span class="comment">// 2.å‘é€æ¶ˆæ¯ï¼Œåˆ©ç”¨æ¶ˆæ¯åç½®å¤„ç†å™¨æ·»åŠ æ¶ˆæ¯å¤´</span></span><br><span class="line">    rabbitTemplate.convertAndSend(<span class="string">&quot;delay.direct&quot;</span>, <span class="string">&quot;delay&quot;</span>, message, <span class="keyword">new</span> <span class="title class_">MessagePostProcessor</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Message <span class="title function_">postProcessMessage</span><span class="params">(Message message)</span> <span class="keyword">throws</span> AmqpException &#123;</span><br><span class="line">            <span class="comment">// æ·»åŠ å»¶è¿Ÿæ¶ˆæ¯å±æ€§</span></span><br><span class="line">            message.getMessageProperties().setDelay(<span class="number">5000</span>);</span><br><span class="line">            <span class="keyword">return</span> message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼š</strong></p>
<p>å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶å†…éƒ¨ä¼šç»´æŠ¤ä¸€ä¸ªæœ¬åœ°æ•°æ®åº“è¡¨ï¼ŒåŒæ—¶ä½¿ç”¨ Elang Timers åŠŸèƒ½å®ç°è®¡æ—¶ã€‚å¦‚æœæ¶ˆæ¯çš„å»¶è¿Ÿæ—¶é—´è®¾ç½®è¾ƒé•¿ï¼Œå¯èƒ½ä¼šå¯¼è‡´å †ç§¯çš„å»¶è¿Ÿæ¶ˆæ¯éå¸¸å¤šï¼Œä¼šå¸¦æ¥è¾ƒå¤§çš„ CPU å¼€é”€ï¼ŒåŒæ—¶å»¶è¿Ÿæ¶ˆæ¯çš„æ—¶é—´ä¼šå­˜åœ¨è¯¯å·®ã€‚</p>
<p>å› æ­¤ï¼Œ<strong>ä¸å»ºè®®è®¾ç½®å»¶è¿Ÿæ—¶é—´è¿‡é•¿çš„å»¶è¿Ÿæ¶ˆæ¯</strong>ã€‚</p>
]]></content>
      <categories>
        <category>MQ</category>
      </categories>
      <tags>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title>é“ä¹‹ä¼Šå§‹ â€”â€” Javaå‡½æ•°å¼ç¼–ç¨‹</title>
    <url>/posts/Java-Functional-Programming/</url>
    <content><![CDATA[<h1 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h1><p>ä»Šå¹´å¹´åˆ Java æ¨å‡ºäº†22ç‰ˆæœ¬ï¼Œä½†æ˜¯å…³æˆ‘å•¥äº‹å•Šï¼Ÿæˆ‘å½“ç„¶è¿˜æ˜¯çˆ±ç”¨ Java 8 å’¯ã€‚é‚£ä¸ºä»€ä¹ˆæˆ‘ä¼šå¦‚æ­¤å–œçˆ± Java 8è¿™ä¸ªç‰ˆæœ¬å‘¢ï¼Ÿé‚£è¿˜å¾—ä» Java å†ä»£çš„é‡è¦ç‰ˆæœ¬è¯´èµ·ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/Java%E5%8E%86%E4%BB%A3%E9%87%8D%E8%A6%81%E7%89%88%E6%9C%AC.png" alt="Javaå†ä»£é‡è¦ç‰ˆæœ¬"></p>
<p>å¯ä»¥çœ‹å‡ºå„ä¸ªç‰ˆæœ¬çš„æ‹›ç‰ŒåŠŸèƒ½ï¼š</p>
<ul>
<li><p>Java 5ï¼šæ³›å‹ã€æšä¸¾ã€æ³¨è§£ã€è‡ªåŠ¨æ‹†è£…ç®±</p>
</li>
<li><p>Java 8ï¼š<font color="red"><strong>å‡½æ•°å¼ç¼–ç¨‹ã€Stream APIã€‚</strong></font>ğŸ’ªJava 8 YYDSğŸ’ª</p>
</li>
<li><p>Java 11ã€Java 17ã€Java 21ï¼šä»…ä»…æ˜¯LTSï¼ˆé•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼‰ï¼Œå¥½åƒè¯´ä¸å‡ºå•¥ç‰¹è‰²åŠŸèƒ½ğŸ˜‚</p>
</li>
</ul>
<p>é‚£å‡½æ•°å¼ç¼–ç¨‹æœ‰ä»€ä¹ˆä¼˜ç‚¹å‘¢ï¼Ÿ</p>
<p>å½“ç„¶æ˜¯ä»£ç ç®€æ´ã€åŠŸèƒ½å¼ºå¤§ã€å¹¶è¡Œå¤„ç†ã€é“¾å¼è°ƒç”¨ã€å»¶æ—¶æ‰§è¡Œå’¯ã€‚æ€»ä¹‹å°±ä¿©å­— â€”â€” â€œä¼˜é›…â€ã€‚</p>
<h1 id="1-é“ä¹‹ä¼Šå§‹"><a href="#1-é“ä¹‹ä¼Šå§‹" class="headerlink" title="1. é“ä¹‹ä¼Šå§‹"></a>1. é“ä¹‹ä¼Šå§‹</h1><center>å®‡å®™åˆå¼€ä¹‹é™…ï¼Œæ··æ²Œä¹‹æ°”ç¬¼ç½©ç€æ•´ä¸ªå®‡å®™ï¼Œä¸€åˆ‡æ¨¡ç³Šä¸æ¸…ã€‚</center>

<center>ç„¶åï¼Œç›˜å¤å¼€å¤©ï¼Œå¥³å¨²é€ äººã€‚</center>

<center>æ—¥æœˆä¹ƒå‡ºã€æ˜Ÿè¾°ä¹ƒç°ã€‚</center>

<center>å±±å·èœ¿èœ’ã€æ±Ÿæ²³å¥”æµã€‚</center>

<center>ç”Ÿçµä¸‡ç‰©ï¼Œæ¬£æ¬£å‘è£ã€‚</center>

<center>æ­¤æ—¥æœˆã€æ˜Ÿè¾°ã€å±±å·ã€æ±Ÿæ²³ã€ç”Ÿçµä¸‡ç‰©ï¼Œ</center>

<center>è°“ä¹‹ã€å¯¹è±¡ã€‘ï¼Œçš†éšæ—¶é—´è€ŒåŒ–ã€‚</center>

<center>ç„¶è€Œï¼šæ—¥æœˆä¹‹è¡Œã€æ˜Ÿæ±‰ç¿çƒ‚ï¼Œ</center>

<center>å±±å·èµ·ä¼ã€æ¹–æµ·æ±‡èšï¼Œ</center>

<center>å†¥å†¥ä¸­æœ‰è‡³ç†è—å…¶ä¸­ã€‚</center>

<center>åæ›°ã€é“ã€‘ï¼Œä¹ƒä¸‡ç‰©éµå¾ªä¹‹è§„å¾‹ï¼Œäº¦è°“ä¹‹ã€å‡½æ•°ã€‘ã€‚</center>

<center>å®ƒæ— é—®ä¸œè¥¿ï¼Œäº˜å¤ä¸å˜ã€‚</center>

<p>ä½œä¸º<strong>è®¾è®¡å®‡å®™æ´ªè’</strong>çš„ç¨‹åºå‘˜</p>
<ul>
<li>é€ æ—¥æœˆã€ç­‘å±±å·ã€åˆ’æ±Ÿæ²³ã€å¼€æ¹–æµ·ã€æ¼”åŒ–ç”Ÿçµä¸‡ç‰©ã€ä»¤å…¶ç”Ÿç”Ÿä¸æ¯ï¼Œåˆ™å¿…ç”¨é¢å‘ã€å¯¹è±¡ã€‘ä¹‹æ‰‹æ®µ</li>
<li>è‹¥å®šè§„åˆ™ã€æ±‚æœ¬æºã€è¿½çº¯ç²¹ï¼Œè®ºä¸å˜ï¼Œåˆ™å½“é€‰ã€å‡½æ•°ã€‘ç¼–ç¨‹ä¹‹æ€æƒ³</li>
</ul>
<p>ä¸‹é¢å°±è®©æˆ‘ä»¬ä»ã€å‡½æ•°ã€‘å¼€å§‹ã€‚</p>
<h2 id="1-1-ä»€ä¹ˆæ˜¯å‡½æ•°"><a href="#1-1-ä»€ä¹ˆæ˜¯å‡½æ•°" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯å‡½æ•°"></a>1.1 ä»€ä¹ˆæ˜¯å‡½æ•°</h2><p>ä»€ä¹ˆæ˜¯å‡½æ•°å‘¢ï¼Ÿå‡½æ•°å³è§„åˆ™ï¼Œå‡½æ•° &#x3D;&#x3D; é“</p>
<p>æ•°å­¦ä¸Šï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/%E6%95%B0%E5%AD%A6%E4%B8%8A%E7%9A%84%E5%87%BD%E6%95%B0.png" alt="æ•°å­¦ä¸Šçš„å‡½æ•°" style="zoom: 67%;">



<p>ä¾‹å¦‚ï¼š</p>
<table>
<thead>
<tr>
<th align="center">INPUT</th>
<th align="center">f(x)</th>
<th align="center">OUTPUT</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">?</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">?</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">?</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">?</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">?</td>
<td align="center">25</td>
</tr>
<tr>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
</tr>
</tbody></table>
<ul>
<li>$f(x) &#x3D; x^2$ æ˜¯ä¸€ç§è§„å¾‹ï¼Œ input æŒ‰ç…§æ­¤è§„å¾‹å˜åŒ–ä¸º output</li>
<li>å¾ˆå¤šè§„å¾‹å·²ç»ç”±äººæ­ç¤ºï¼Œä¾‹å¦‚ $e &#x3D; m \cdot c^2$â€‹</li>
<li>ç¨‹åºè®¾è®¡ä¸­<strong>æ›´</strong>å¯ä»¥è‡ªå·±å»åˆ¶å®šè§„å¾‹ï¼Œä¸€æ—¦æˆä¸ºè§„åˆ™çš„åˆ¶å®šè€…ï¼Œä½ å°±æ˜¯ç¥</li>
</ul>
<h2 id="1-2-å¤§é“æ— æƒ…"><a href="#1-2-å¤§é“æ— æƒ…" class="headerlink" title="1.2 å¤§é“æ— æƒ…"></a>1.2 å¤§é“æ— æƒ…</h2><p>æ€æ ·æ‰èƒ½æˆä¸ºä¸€ä¸ªåˆæ ¼çš„å‡½æ•°ï¼Ÿä¸Šé¢æè¿‡å‡½æ•°å³è§„åˆ™ï¼Œå‡½æ•° &#x3D;&#x3D; é“ã€‚é‚£å°±è¦å…ˆæ€è€ƒé‚£æ€æ ·æ‰èƒ½æˆé“å‘¢ï¼Ÿ</p>
<p>æˆé“éœ€è¦ä¸€ä¸ªå…ˆå†³æ¡ä»¶ï¼š<strong>æˆåˆ°è¦æ— æƒ…</strong></p>
<h3 id="1-2-1-æ— æƒ…"><a href="#1-2-1-æ— æƒ…" class="headerlink" title="1.2.1 æ— æƒ…"></a>1.2.1 æ— æƒ…</h3><p>ä½•ä¸ºæ— æƒ…ï¼Ÿåªè¦è¾“å…¥ç›¸åŒï¼Œæ— è®ºå¤šå°‘æ¬¡è°ƒç”¨ï¼Œæ— è®ºä»€ä¹ˆæ—¶é—´è°ƒç”¨ï¼Œè¾“å‡ºç›¸åŒã€‚</p>
<h3 id="1-2-2-ä½›ç¥–æˆé“"><a href="#1-2-2-ä½›ç¥–æˆé“" class="headerlink" title="1.2.2 ä½›ç¥–æˆé“"></a>1.2.2 ä½›ç¥–æˆé“</h3><p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMutable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(pray(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">        System.out.println(pray(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">        System.out.println(pray(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Buddha</span> &#123;</span><br><span class="line">        String name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Buddha</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">Buddha</span> <span class="variable">buddha</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Buddha</span>(<span class="string">&quot;ä½›ç¥–&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String <span class="title function_">pray</span><span class="params">(String person)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (person + <span class="string">&quot;å‘[&quot;</span> + buddha.name + <span class="string">&quot;]è™”è¯šç¥ˆç¥·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Š pray çš„æ‰§è¡Œç»“æœï¼Œé™¤äº†å‚æ•°å˜åŒ–å¤–ï¼Œå¸Œæœ›å‡½æ•°çš„æ‰§è¡Œè§„åˆ™æ°¸è¿œä¸å˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼ ä¸‰å‘[ä½›ç¥–]è™”è¯šç¥ˆç¥·</span><br><span class="line">å¼ ä¸‰å‘[ä½›ç¥–]è™”è¯šç¥ˆç¥·</span><br><span class="line">å¼ ä¸‰å‘[ä½›ç¥–]è™”è¯šç¥ˆç¥·</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œï¼Œç”±äºè®¾è®¡ä¸Šçš„ç¼ºé™·ï¼Œå‡½æ•°å¼•ç”¨äº†å¤–ç•Œå¯å˜çš„æ•°æ®ï¼Œå¦‚æœè¿™ä¹ˆä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">buddha.name = <span class="string">&quot;é­”ç‹&quot;</span>;</span><br><span class="line">System.out.println(pray(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>ç»“æœå°±ä¼šæ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">å¼ ä¸‰å‘[é­”ç‹]è™”è¯šç¥ˆç¥·</span><br></pre></td></tr></table></figure>

<p>é—®é¢˜å‡ºåœ¨å“ªå„¿å‘¢ï¼Ÿå‡½æ•°çš„ç›®çš„æ˜¯é™¤äº†å‚æ•°èƒ½å˜åŒ–ï¼Œå…¶å®ƒéƒ¨åˆ†éƒ½è¦ä¸å˜ï¼Œè¿™æ ·æ‰èƒ½æˆä¸ºè§„åˆ™çš„ä¸€éƒ¨åˆ†ã€‚ä½›ç¥–è¦æˆä¸ºè§„åˆ™çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿè¦ä¿æŒä¸å˜ã€‚</p>
<p>æ”¹æ­£æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Buddha</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Buddha</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–ï¼ˆJDK 16ä»¥ä¸Šç‰ˆæœ¬ï¼‰</span></span><br><span class="line"><span class="keyword">record</span> <span class="title class_">Buddha</span><span class="params">(String name)</span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸æ˜¯è¯´å‡½æ•°ä¸èƒ½å¼•ç”¨å¤–ç•Œçš„æ•°æ®ï¼Œè€Œæ˜¯å®ƒå¼•ç”¨çš„æ•°æ®å¿…é¡»ä¹Ÿèƒ½ä½œä¸ºè§„åˆ™çš„ä¸€éƒ¨åˆ†</li>
<li>è®©ä½›ç¥–ä¸å˜ï¼Œä½›ç¥–æ‰èƒ½æˆä¸ºè§„åˆ™</li>
</ul>
<h3 id="1-2-3-å‡½æ•°ä¸æ–¹æ³•"><a href="#1-2-3-å‡½æ•°ä¸æ–¹æ³•" class="headerlink" title="1.2.3 å‡½æ•°ä¸æ–¹æ³•"></a>1.2.3 å‡½æ•°ä¸æ–¹æ³•</h3><p>æ–¹æ³•æœ¬è´¨ä¸Šä¹Ÿæ˜¯å‡½æ•°ã€‚ä¸è¿‡æ–¹æ³•ç»‘å®šåœ¨å¯¹è±¡ä¹‹ä¸Šï¼Œå®ƒæ˜¯å¯¹è±¡ä¸ªäººæ³•åˆ™ã€‚</p>
<ul>
<li><p>å‡½æ•°æ˜¯ï¼šå‡½æ•°ï¼ˆå¯¹è±¡æ•°æ®ï¼Œå…¶å®ƒå‚æ•°ï¼‰</p>
</li>
<li><p>æ–¹æ³•æ˜¯ï¼šå¯¹è±¡æ•°æ®.æ–¹æ³•ï¼ˆå…¶å®ƒå‚æ•°ï¼‰</p>
</li>
</ul>
<h3 id="1-2-4-ä¸å˜çš„å¥½å¤„"><a href="#1-2-4-ä¸å˜çš„å¥½å¤„" class="headerlink" title="1.2.4 ä¸å˜çš„å¥½å¤„"></a>1.2.4 ä¸å˜çš„å¥½å¤„</h3><p>åªæœ‰ä¸å˜ï¼Œæ‰èƒ½åœ¨æ»šæ»šæ—¶é—´æ´ªæµä¸­å±¹ç«‹ä¸å€’ï¼Œæˆä¸ºè§„åˆ™çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œä¸å˜æ„å‘³ç€çº¿ç¨‹å®‰å…¨ã€‚</p>
<h3 id="1-2-5-åˆæ ¼çš„å‡½æ•°æ— çŠ¶æ€"><a href="#1-2-5-åˆæ ¼çš„å‡½æ•°æ— çŠ¶æ€" class="headerlink" title="1.2.5 åˆæ ¼çš„å‡½æ•°æ— çŠ¶æ€"></a>1.2.5 åˆæ ¼çš„å‡½æ•°æ— çŠ¶æ€</h3><h2 id="1-3-å¤§é“æ— å½¢"><a href="#1-3-å¤§é“æ— å½¢" class="headerlink" title="1.3 å¤§é“æ— å½¢"></a>1.3 å¤§é“æ— å½¢</h2><h3 id="1-3-1-å‡½æ•°åŒ–å¯¹è±¡"><a href="#1-3-1-å‡½æ•°åŒ–å¯¹è±¡" class="headerlink" title="1.3.1 å‡½æ•°åŒ–å¯¹è±¡"></a>1.3.1 å‡½æ•°åŒ–å¯¹è±¡</h3><p>å‡½æ•°æœ¬æ— å½¢ï¼Œä¹Ÿå°±æ˜¯å®ƒä»£è¡¨çš„è§„åˆ™ï¼šä½ç½®å›ºå®šã€ä¸èƒ½ä¼ æ’­ã€‚</p>
<p>è‹¥è¦æœ‰å½¢ï¼Œè®©å‡½æ•°çš„è§„åˆ™èƒ½å¤Ÿä¼ æ’­ï¼Œéœ€è¦å°†å‡½æ•°åŒ–ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ä¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Lambda</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Lambda</span> <span class="variable">add</span> <span class="operator">=</span> (a, b) -&gt; a + b; <span class="comment">// å®ƒå·²ç»å˜æˆäº†ä¸€ä¸ª Lambda å¯¹è±¡</span></span><br></pre></td></tr></table></figure>

<p>åŒºåˆ«åœ¨å“ªï¼Ÿ</p>
<ul>
<li>å‰è€…æ˜¯çº¯ç²¹çš„ä¸€æ¡ä¸¤æ•°åŠ æ³•è§„åˆ™ï¼Œå®ƒçš„ä½ç½®æ˜¯å›ºå®šçš„ï¼Œè¦ä½¿ç”¨å®ƒï¼Œéœ€è¦é€šè¿‡ MyClass.add æ‰¾åˆ°å®ƒï¼Œç„¶åæ‰§è¡Œ</li>
<li>è€Œåè€…ï¼ˆadd å¯¹è±¡ï¼‰å°±åƒé•¿äº†è…¿ï¼Œå®ƒçš„ä½ç½®æ˜¯å¯ä»¥å˜åŒ–çš„ï¼Œæƒ³å»å“ªé‡Œå°±å»å“ªé‡Œï¼Œå“ªé‡Œè¦ç”¨åˆ°è¿™æ¡åŠ æ³•è§„åˆ™ï¼ŒæŠŠå®ƒä¼ é€’è¿‡å»<font color="red"><strong>ï¼ˆå¯¹è±¡å¯ä»¥ä¼ åˆ°ä»»æ„åœ°æ–¹å»ï¼Œå‡½æ•°ä¸è¡Œï¼‰</strong></font></li>
<li>æ¥å£çš„ç›®çš„æ˜¯ä¸ºäº†å°†æ¥ç”¨å®ƒæ¥æ‰§è¡Œå‡½æ•°å¯¹è±¡ï¼Œæ­¤æ¥å£ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ–¹æ³•å®šä¹‰</li>
</ul>
<p>å‡½æ•°åŒ–ä¸ºå¯¹è±¡åšä¸ªæ¯”å–»ï¼š</p>
<ul>
<li>ä¹‹å‰æ˜¯å¤§å®¶è¦ç»Ÿä¸€å»è¥¿å¤©å–ç»</li>
<li>ç°åœ¨æ˜¯æ¯ä¸ªè©è¨ã€ç½—æ±‰æ‹¿ç€ç»ä¹¦ï¼Œå…¥ä¸–ä¼ ç»</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Lambda</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="type">ServerSocket</span> <span class="variable">ss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">8080</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;server start...&quot;</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> ss.accept();</span><br><span class="line">                Thread.ofVirtual().start(() -&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">ObjectInputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(s.getInputStream());</span><br><span class="line">                        <span class="type">Lambda</span> <span class="variable">lambda</span> <span class="operator">=</span> (Lambda) is.readObject();</span><br><span class="line">                        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);</span><br><span class="line">                        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);</span><br><span class="line">                        System.out.printf(<span class="string">&quot;%s %d op %d = %d%n&quot;</span>,</span><br><span class="line">                   s.getRemoteSocketAddress().toString(), a, b, lambda.calculate(a, b));</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Client1</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">try</span>(<span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>))&#123;</span><br><span class="line">                <span class="type">Lambda</span> <span class="variable">lambda</span> <span class="operator">=</span> (Lambda &amp; Serializable) (a, b) -&gt; a + b;</span><br><span class="line">                <span class="type">ObjectOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(s.getOutputStream());</span><br><span class="line">                os.writeObject(lambda);</span><br><span class="line">                os.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Client2</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">try</span>(<span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>))&#123;</span><br><span class="line">                <span class="type">Lambda</span> <span class="variable">lambda</span> <span class="operator">=</span> (Lambda &amp; Serializable) (a, b) -&gt; a - b;</span><br><span class="line">                <span class="type">ObjectOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(s.getOutputStream());</span><br><span class="line">                os.writeObject(lambda);</span><br><span class="line">                os.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Client3</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">try</span>(<span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>))&#123;</span><br><span class="line">                <span class="type">Lambda</span> <span class="variable">lambda</span> <span class="operator">=</span> (Lambda &amp; Serializable) (a, b) -&gt; a * b;</span><br><span class="line">                <span class="type">ObjectOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(s.getOutputStream());</span><br><span class="line">                os.writeObject(lambda);</span><br><span class="line">                os.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­åšäº†ä¸€äº›ç®€å•çš„æ‰©å±•ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒçš„å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ è‡ªå·±çš„è®¡ç®—è§„åˆ™ã€‚</p>
<p><strong>PSï¼š</strong></p>
<ul>
<li>å¤§éƒ¨åˆ†æ–‡çŒ®éƒ½è¯´ Lambda æ˜¯åŒ¿åå‡½æ•°ï¼Œä½†<strong>æ»¡è€å¸ˆ</strong>è§‰å¾—éœ€è¦åœ¨è¿™ä¸ªè¯´æ³•ä¸Šè¿›è¡Œè¡¥å……</li>
<li>è‡³å°‘åœ¨ java é‡Œï¼Œè™½ç„¶ Lambda è¡¨è¾¾å¼æœ¬èº«ä¸éœ€è¦èµ·åå­—ï¼Œä½†ä¸å¾—æä¾›ä¸€ä¸ªå¯¹åº”æ¥å£å˜›</li>
</ul>
<h3 id="1-3-2-è¡Œä¸ºå‚æ•°åŒ–"><a href="#1-3-2-è¡Œä¸ºå‚æ•°åŒ–" class="headerlink" title="1.3.2 è¡Œä¸ºå‚æ•°åŒ–"></a>1.3.2 è¡Œä¸ºå‚æ•°åŒ–</h3><p>å·²çŸ¥å­¦ç”Ÿç±»å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age, String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é’ˆå¯¹ä¸€ç»„å­¦ç”Ÿé›†åˆï¼Œç­›é€‰å‡ºç”·å­¦ç”Ÿï¼Œä¸‹é¢çš„ä»£ç å®ç°å¦‚ä½•ï¼Œè¯„ä»·ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    List&lt;Student&gt; students = List.of(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="number">18</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;æ¨ä¸æ‚”&quot;</span>, <span class="number">16</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="number">19</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="number">20</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    System.out.println(filter(students)); <span class="comment">// èƒ½å¾—åˆ° å¼ æ— å¿Œï¼Œå®‹é’ä¹¦</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> List&lt;Student&gt; <span class="title function_">filter</span><span class="params">(List&lt;Student&gt; students)</span> &#123;</span><br><span class="line">    List&lt;Student&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">        <span class="keyword">if</span> (student.sex.equals(<span class="string">&quot;ç”·&quot;</span>)) &#123;</span><br><span class="line">            result.add(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœéœ€æ±‚å†å˜åŠ¨ä¸€ä¸‹ï¼Œè¦æ±‚æ‰¾åˆ° 18 å²ä»¥ä¸‹çš„å­¦ç”Ÿï¼Œä¸Šé¢ä»£ç æ˜¾ç„¶ä¸èƒ½ç”¨äº†ï¼Œæ”¹åŠ¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> List&lt;Student&gt; <span class="title function_">filter</span><span class="params">(List&lt;Student&gt; students)</span> &#123;</span><br><span class="line">    List&lt;Student&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">        <span class="keyword">if</span> (student.age &lt;= <span class="number">18</span>) &#123;</span><br><span class="line">            result.add(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(filter(students)); <span class="comment">// èƒ½å¾—åˆ° å¼ æ— å¿Œï¼Œæ¨ä¸æ‚”</span></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆéœ€æ±‚å¦‚æœå†è¦å˜åŠ¨ï¼Œæ‰¾18å²ä»¥ä¸‹ç”·å­¦ç”Ÿï¼Œæ€ä¹ˆæ”¹ï¼Ÿæ˜¾ç„¶ä¸Šè¿°åšæ³•å¹¶ä¸å¤ªå¥½â€¦ æ›´å¸Œæœ›ä¸€ä¸ªæ–¹æ³•èƒ½å¤„ç†å„ç§æƒ…å†µï¼Œä»”ç»†è§‚å¯Ÿä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•ï¼Œæ‰¾ä¸åŒã€‚</p>
<p>ä¸åŒåœ¨äºç­›é€‰æ¡ä»¶éƒ¨åˆ†ï¼š<code>student.sex.equals(&quot;ç”·&quot;)</code> å’Œ <code>student.age &lt;= 18</code></p>
<p>æ—¢ç„¶å®ƒä»¬å°±æ˜¯ä¸åŒï¼Œé‚£ä¹ˆèƒ½å¦æŠŠå®ƒä½œä¸ºå‚æ•°ä¼ é€’è¿›æ¥ï¼Œè¿™æ ·å¤„ç†èµ·æ¥ä¸å°±ä¸€è‡´äº†å—ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> List&lt;Student&gt; <span class="title function_">filter</span><span class="params">(List&lt;Student&gt; students, ???)</span> &#123;</span><br><span class="line">    List&lt;Student&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">        <span class="keyword">if</span> (???) &#123;</span><br><span class="line">            result.add(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ƒä¿©è¦åˆ¤æ–­çš„é€»è¾‘ä¸åŒï¼Œé‚£è¿™ä¸¤å¤„ä¸åŒçš„é€»è¾‘å¿…ç„¶è¦ç”¨å‡½æ•°æ¥è¡¨ç¤ºï¼Œå°†æ¥è¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦ç”¨åˆ° student å¯¹è±¡æ¥åˆ¤æ–­ï¼Œéƒ½åº”è¯¥è¿”å›ä¸€ä¸ª boolean ç»“æœï¼Œæ€ä¹ˆæè¿°å‡½æ•°çš„é•¿ç›¸å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Lambda</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(Student student)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•å¯ä»¥ç»Ÿä¸€æˆä¸‹è¿°ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> List&lt;Student&gt; <span class="title function_">filter</span><span class="params">(List&lt;Student&gt; students, Lambda lambda)</span> &#123;</span><br><span class="line">    List&lt;Student&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">        <span class="keyword">if</span> (lambda.test(student)) &#123;</span><br><span class="line">            result.add(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥½ï¼Œæœ€åæ€ä¹ˆç»™å®ƒä¼ é€’ä¸åŒå®ç°å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filter(students, student -&gt; student.sex.equals(<span class="string">&quot;ç”·&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>ä»¥åŠ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filter(students, student -&gt; student.age &lt;= <span class="number">18</span>);</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰æ–°éœ€æ±‚ä¹Ÿèƒ½æ»¡è¶³</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filter(students, student -&gt; student.sex.equals(<span class="string">&quot;ç”·&quot;</span>) &amp;&amp; student.age &lt;= <span class="number">18</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±å®ç°äº†ä»¥ä¸å˜åº”ä¸‡å˜ï¼Œè€Œå˜æ¢å³æ˜¯ä¸€ä¸ªä¸ªå‡½æ•°å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºè¡Œä¸ºå‚æ•°åŒ–</p>
<h3 id="1-3-3-å»¶è¿Ÿæ‰§è¡Œ"><a href="#1-3-3-å»¶è¿Ÿæ‰§è¡Œ" class="headerlink" title="1.3.3 å»¶è¿Ÿæ‰§è¡Œ"></a>1.3.3 å»¶è¿Ÿæ‰§è¡Œ</h3><p>åœ¨è®°å½•æ—¥å¿—æ—¶ï¼Œå‡è®¾æ—¥å¿—çº§åˆ«æ˜¯ INFOï¼Œdebug æ–¹æ³•ä¼šé‡åˆ°ä¸‹é¢çš„é—®é¢˜ï¼š</p>
<p>æœ¬ä¸éœ€è¦è®°å½•æ—¥å¿—ï¼Œä½† expensive æ–¹æ³•ä»è¢«æ‰§è¡Œäº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LogManager.getLogger();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    System.out.println(logger.getLevel());</span><br><span class="line">    logger.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, expensive());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> String <span class="title function_">expensive</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰§è¡Œè€—æ—¶æ“ä½œ&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ç»“æœ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹è¿›æ–¹æ³•1ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">    logger.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, expensive());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶è¿™ä¹ˆåšï¼Œå¾ˆå¤šç±»ä¼¼ä»£ç éƒ½è¦åŠ ä¸Šè¿™æ · if åˆ¤æ–­ï¼Œå¾ˆä¸ä¼˜é›…ã€‚</p>
<p>æ”¹è¿›æ–¹æ³•2ï¼š</p>
<p>åœ¨ debug æ–¹æ³•å¤–å†å¥—ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå†…éƒ¨é€»è¾‘å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">debug</span><span class="params">(<span class="keyword">final</span> String msg, <span class="keyword">final</span> Supplier&lt;?&gt; lambda)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.isDebugEnabled()) &#123;</span><br><span class="line">        <span class="built_in">this</span>.debug(msg, lambda.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨æ—¶è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">logger.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, () -&gt; expensive());</span><br></pre></td></tr></table></figure>

<p>expensive() å˜æˆäº†ä¸æ˜¯ç«‹åˆ»æ‰§è¡Œï¼Œåœ¨æœªæ¥ if æ¡ä»¶æˆç«‹æ—¶æ‰æ‰§è¡Œã€‚</p>
<h3 id="1-3-4-å‡½æ•°å¯¹è±¡çš„ä¸åŒç±»å‹"><a href="#1-3-4-å‡½æ•°å¯¹è±¡çš„ä¸åŒç±»å‹" class="headerlink" title="1.3.4 å‡½æ•°å¯¹è±¡çš„ä¸åŒç±»å‹"></a>1.3.4 å‡½æ•°å¯¹è±¡çš„ä¸åŒç±»å‹</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Comparator&lt;Student&gt; c = </span><br><span class="line">    			(Student s1, Student s2) -&gt; Integer.compare(s1.age, s2.age);</span><br><span class="line"></span><br><span class="line">BiFunction&lt;Student, Student, Integer&gt; f = </span><br><span class="line">                (Student s1, Student s2) -&gt; Integer.compare(s1.age, s2.age);</span><br></pre></td></tr></table></figure>

<h1 id="2-å‡½æ•°ç¼–ç¨‹è¯­æ³•"><a href="#2-å‡½æ•°ç¼–ç¨‹è¯­æ³•" class="headerlink" title="2. å‡½æ•°ç¼–ç¨‹è¯­æ³•"></a>2. å‡½æ•°ç¼–ç¨‹è¯­æ³•</h1><h2 id="2-1-è¡¨ç°å½¢å¼"><a href="#2-1-è¡¨ç°å½¢å¼" class="headerlink" title="2.1 è¡¨ç°å½¢å¼"></a>2.1 è¡¨ç°å½¢å¼</h2><p>åœ¨ Java è¯­è¨€ä¸­ï¼ŒLambda å¯¹è±¡æœ‰ä¸¤ç§å½¢å¼ï¼š<code>Lambdaè¡¨è¾¾å¼</code> ä¸ <code>æ–¹æ³•å¼•ç”¨</code></p>
<ul>
<li><code>Lambdaè¡¨è¾¾å¼</code>ï¼šåŠŸèƒ½æ›´å…¨é¢</li>
<li><code>æ–¹æ³•å¼•ç”¨</code>ï¼šå†™æ³•æ›´ç®€ä»‹</li>
</ul>
<p>Lambda å¯¹è±¡çš„ç±»å‹æ˜¯ç”±å®ƒçš„è¡Œä¸ºå†³å®šçš„ï¼Œå¦‚æœæœ‰ä¸€äº› Lambda å¯¹è±¡ï¼Œå®ƒä»¬çš„å…¥å‚ç±»å‹ã€è¿”å›å€¼ç±»å‹éƒ½ä¸€è‡´ï¼Œé‚£ä¹ˆå®ƒä»¬å¯ä»¥çœ‹ä½œæ˜¯åŒä¸€ç±»çš„ Lambda å¯¹è±¡ï¼Œå®ƒä»¬çš„ç±»å‹ï¼Œç”¨ <code>å‡½æ•°å¼æ¥å£</code> æ¥è¡¨ç¤ºã€‚</p>
<h3 id="2-1-1-åŒ¿åå†…éƒ¨ç±»"><a href="#2-1-1-åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="2.1.1 åŒ¿åå†…éƒ¨ç±»"></a>2.1.1 åŒ¿åå†…éƒ¨ç±»</h3><p>åŒ¿åå†…éƒ¨ç±» ï¼šæ˜¯å†…éƒ¨ç±»çš„ç®€åŒ–å†™æ³•ã€‚ä»–æ˜¯ä¸€ä¸ªéšå«äº†åå­—çš„å†…éƒ¨ç±»ã€‚å¼€å‘ä¸­ï¼Œæœ€å¸¸ç”¨åˆ°çš„å†…éƒ¨ç±»å°±æ˜¯åŒ¿åå†…éƒ¨ç±»äº†ã€‚</p>
<p>åŒ¿åå†…éƒ¨ç±»å¿…é¡»<strong>ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»</strong>æˆ–è€…<strong>å®ç°ä¸€ä¸ªçˆ¶æ¥å£</strong>ã€‚æ ¼å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> çˆ¶ç±»åæˆ–è€…æ¥å£å() &#123;</span><br><span class="line">     é‡å†™æ–¹æ³•;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åŒ…å«äº†ï¼š</p>
<ul>
<li><p>ç»§æ‰¿æˆ–è€…å®ç°å…³ç³»</p>
</li>
<li><p>æ–¹æ³•é‡å†™</p>
</li>
<li><p>åˆ›å»ºå¯¹è±¡</p>
</li>
</ul>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/%E5%8C%BF%E5%90%8D%E5%86%85%E9%83%A8%E7%B1%BB.png" alt="åŒ¿åå†…éƒ¨ç±»">

<p>æ‰€ä»¥ä»è¯­æ³•ä¸Šæ¥è®²ï¼Œè¿™ä¸ªæ•´ä½“å…¶å®æ˜¯<strong>åŒ¿åå†…éƒ¨ç±»çš„å¯¹è±¡</strong>ã€‚</p>
<p>ä»€ä¹ˆæ—¶å€™ç”¨åˆ°åŒ¿åå†…éƒ¨ç±» ï¼Ÿ</p>
<ul>
<li><p>å¦‚æœå¸Œæœ›å®šä¹‰ä¸€ä¸ªåªè¦ä½¿ç”¨ä¸€æ¬¡çš„ç±»ï¼Œå°±å¯è€ƒè™‘ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ã€‚åŒ¿åå†…éƒ¨ç±»çš„æœ¬è´¨ä½œç”¨æ˜¯ä¸ºäº†ç®€åŒ–ä»£ç </p>
</li>
<li><p>é€šå¸¸åœ¨æ–¹æ³•çš„å½¢å¼å‚æ•°æ˜¯æ¥å£æˆ–è€…æŠ½è±¡ç±»æ—¶ï¼Œä¹Ÿå¯ä»¥å°†åŒ¿åå†…éƒ¨ç±»ä½œä¸ºå‚æ•°ä¼ é€’</p>
</li>
</ul>
<p>åŒ¿åå†…éƒ¨ç±»çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å®šä¹‰ä¸€ä¸ªæ²¡æœ‰åå­—çš„å†…éƒ¨ç±»</li>
<li>è¿™ä¸ªç±»å®ç°äº†çˆ¶ç±»ï¼Œæˆ–è€…çˆ¶ç±»æ¥å£</li>
<li>åŒ¿åå†…éƒ¨ç±»ä¼šåˆ›å»ºè¿™ä¸ªæ²¡æœ‰åå­—çš„ç±»çš„å¯¹è±¡</li>
</ul>
<h3 id="2-1-2-Lambdaè¡¨è¾¾å¼"><a href="#2-1-2-Lambdaè¡¨è¾¾å¼" class="headerlink" title="2.1.2 Lambdaè¡¨è¾¾å¼"></a>2.1.2 Lambdaè¡¨è¾¾å¼</h3><p>è¯­æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">å‚æ•°éƒ¨åˆ†(æ–¹æ³•çš„å½¢å‚) -&gt; æ‰§è¡Œé€»è¾‘(æ–¹æ³•çš„æ–¹æ³•ä½“)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-&gt;</code>ï¼šå›ºå®šæ ¼å¼</li>
</ul>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>Lambdaè¡¨è¾¾å¼å¯ä»¥ç”¨æ¥ç®€åŒ–<strong>åŒ¿åå†…éƒ¨ç±»</strong>çš„ä¹¦å†™</li>
<li>Lambdaè¡¨è¾¾å¼<strong>åªèƒ½ç®€åŒ–å‡½æ•°å¼æ¥å£çš„åŒ¿åå†…éƒ¨ç±»æ–¹æ³•</strong></li>
<li>å‡½æ•°å¼æ¥å£ï¼šæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£å«å‡½æ•°å¼æ¥å£ï¼Œæ¥å£æ–¹æ³•ä¸Šå¯ä»¥åŠ ä¸Š <code>@FunctionalInterface</code> æ³¨è§£<ul>
<li><code>@FunctionalInterface</code> ä½œç”¨ï¼šåœ¨ç¼–è¯‘æœŸé—´æ£€æŸ¥å‡½æ•°å¼æ¥å£æ˜¯å¦<strong>æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª</strong>æŠ½è±¡æ–¹æ³•ï¼Œå¦‚æœä¸æ»¡è¶³ä¼šæç¤ºé”™è¯¯</li>
</ul>
</li>
</ul>
<p>Lambdaçš„çœç•¥è§„åˆ™ï¼š</p>
<ul>
<li>å‚æ•°ç±»å‹å¯ä»¥çœç•¥ä¸å†™</li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹å¯ä»¥çœç•¥ï¼ŒåŒæ—¶()ä¹Ÿå¯ä»¥çœç•¥</li>
<li>å¦‚æœLambdaè¡¨è¾¾å¼çš„æ–¹æ³•ä½“åªæœ‰ä¸€è¡Œï¼Œå¤§æ‹¬å·ã€åˆ†å·ã€returnå¯ä»¥çœç•¥ä¸å†™<font color="red">ï¼ˆéœ€è¦åŒæ—¶çœç•¥ï¼‰</font></li>
</ul>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LambdaDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Integer[] arr = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">        Arrays.sort(arr, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> o1 - o2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Lambdaå®Œæ•´æ ¼å¼</span></span><br><span class="line">        Arrays.sort(arr, (Integer o1, Integer o2) -&gt; &#123;</span><br><span class="line">                    <span class="keyword">return</span> o1 - o2;</span><br><span class="line">                &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Lambdaçœç•¥å†™æ³•</span></span><br><span class="line">        Arrays.sort(arr, (o1, o2) -&gt; o1 - o2);</span><br><span class="line"></span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-æ–¹æ³•å¼•ç”¨"><a href="#2-1-3-æ–¹æ³•å¼•ç”¨" class="headerlink" title="2.1.3 æ–¹æ³•å¼•ç”¨"></a>2.1.3 æ–¹æ³•å¼•ç”¨</h3><p>æ–¹æ³•å¼•ç”¨çš„æ¡ä»¶ï¼š</p>
<ul>
<li>å¼•ç”¨å¤„éœ€è¦æ˜¯å‡½æ•°å¼æ¥å£</li>
<li>è¢«å¼•ç”¨çš„æ–¹æ³•éœ€è¦å·²ç»å­˜åœ¨</li>
<li>è¢«å¼•ç”¨æ–¹æ³•çš„å½¢å‚å’Œè¿”å›å€¼éœ€è¦è·ŸæŠ½è±¡æ–¹æ³•çš„å½¢å‚å’Œè¿”å›å€¼ä¿æŒä¸€è‡´</li>
<li>è¢«å¼•ç”¨æ–¹æ³•çš„åŠŸèƒ½éœ€è¦æ»¡è¶³å½“å‰çš„è¦æ±‚</li>
</ul>
<p>æ–¹æ³•å¼•ç”¨çš„åˆ†ç±»ï¼š</p>
<ul>
<li>å¼•ç”¨é™æ€æ–¹æ³•</li>
<li>å¼•ç”¨æˆå‘˜æ–¹æ³•<ul>
<li>å¼•ç”¨å…¶ä»–ç±»çš„æˆå‘˜æ–¹æ³•</li>
<li>å¼•ç”¨æœ¬ç±»çš„æˆå‘˜æ–¹æ³•</li>
<li>å¼•ç”¨çˆ¶ç±»çš„æˆå‘˜æ–¹æ³•</li>
</ul>
</li>
<li>å¼•ç”¨æ„é€ æ–¹æ³•</li>
<li>å…¶ä»–è°ƒç”¨æ–¹å¼<ul>
<li>ä½¿ç”¨ç±»åå¼•ç”¨æˆå‘˜æ–¹æ³•</li>
<li>å¼•ç”¨æ•°ç»„çš„æ„é€ æ–¹æ³•</li>
</ul>
</li>
</ul>
<h2 id="2-2-å‡½æ•°ç±»å‹"><a href="#2-2-å‡½æ•°ç±»å‹" class="headerlink" title="2.2 å‡½æ•°ç±»å‹"></a>2.2 å‡½æ•°ç±»å‹</h2><p>å…¥å‚ç±»å‹ã€è¿”å›å€¼ç±»å‹éƒ½ä¸€è‡´çš„è¯ï¼Œå¯ä»¥çœ‹ä½œåŒä¸€ç±»çš„å¯¹è±¡ã€‚</p>
<p>å¸¸è§å‡½æ•°æ¥å£ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0%E6%8E%A5%E5%8F%A3.png" alt="å¸¸è§å‡½æ•°æ¥å£" style="zoom: 50%;">

<p>å‡½æ•°æ¥å£çš„å‘½åè§„å¾‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center">åç§°</th>
<th align="center">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Consumer</td>
<td align="center">æœ‰å‚ã€æ— è¿”å›å€¼</td>
</tr>
<tr>
<td align="center">Function</td>
<td align="center">æœ‰å‚ã€æœ‰è¿”å›å€¼</td>
</tr>
<tr>
<td align="center">Predicate</td>
<td align="center">æœ‰å‚ã€è¿”å›boolean</td>
</tr>
<tr>
<td align="center">Supplier</td>
<td align="center">æ— å‚ã€æœ‰è¿”å›å€¼</td>
</tr>
<tr>
<td align="center">Operator</td>
<td align="center">æœ‰å‚ã€æœ‰è¿”å›å€¼ï¼Œå¹¶ä¸”ç±»å‹ä¸€æ ·</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å‰ç¼€</th>
<th align="center">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Unary</td>
<td align="center">ä¸€å…ƒçš„æ„æ€ï¼Œè¡¨ç¤ºä¸€ä¸ªå‚æ•°</td>
</tr>
<tr>
<td align="center">Bi æˆ– Binary</td>
<td align="center">äºŒå…ƒçš„æ„æ€ï¼Œè¡¨ç¤ºä¸¤ä¸ªå‚æ•°</td>
</tr>
<tr>
<td align="center">Ternary</td>
<td align="center">ä¸‰å…ƒ</td>
</tr>
<tr>
<td align="center">Quatenary</td>
<td align="center">å››å…ƒ</td>
</tr>
<tr>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
</tr>
</tbody></table>
<p>æ–¹æ³•å¼•ç”¨ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå…¥å‚ç±»å‹ã€è¿”å›å€¼ç±»å‹éƒ½ä¸€è‡´çš„è¯ï¼Œå¯ä»¥çœ‹ä½œåŒä¸€ç±»çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ç”¨å‡½æ•°å¼æ¥å£è¡¨ç¤ºã€‚</p>
<h2 id="2-3-å‡ ç§æ–¹æ³•å¼•ç”¨"><a href="#2-3-å‡ ç§æ–¹æ³•å¼•ç”¨" class="headerlink" title="2.3 å‡ ç§æ–¹æ³•å¼•ç”¨"></a>2.3 å‡ ç§æ–¹æ³•å¼•ç”¨</h2><h3 id="2-3-1-ç±»å-é™æ€æ–¹æ³•å"><a href="#2-3-1-ç±»å-é™æ€æ–¹æ³•å" class="headerlink" title="2.3.1 ç±»å::é™æ€æ–¹æ³•å"></a>2.3.1 <code>ç±»å::é™æ€æ–¹æ³•å</code></h3><p>å¦‚ä½•ç†è§£ï¼š</p>
<ul>
<li>å‡½æ•°å¯¹è±¡çš„é€»è¾‘éƒ¨åˆ†æ˜¯ï¼šè°ƒç”¨æ­¤é™æ€æ–¹æ³•</li>
<li>å› æ­¤è¿™ä¸ªé™æ€æ–¹æ³•éœ€è¦ä»€ä¹ˆå‚æ•°ï¼Œå‡½æ•°å¯¹è±¡ä¹Ÿæä¾›ç›¸åº”çš„å‚æ•°å³å¯</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type2Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            éœ€æ±‚ï¼šæŒ‘é€‰å‡ºæ‰€æœ‰ç”·æ€§å­¦ç”Ÿ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Stream.of(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                .filter(Type2Test::isMale)</span><br><span class="line">                .forEach(student -&gt; System.out.println(student));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> student.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(String name, String sex)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>filter</code> è¿™ä¸ªé«˜é˜¶å‡½æ•°æ¥æ”¶çš„å‡½æ•°ç±»å‹ï¼ˆPredicateï¼‰æ˜¯ï¼šä¸€ä¸ª <code>T</code> ç±»å‹çš„å…¥å‚ï¼Œä¸€ä¸ª <code>boolean</code> çš„è¿”å›å€¼ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ç»™å®ƒæä¾›ä¸€ä¸ªç›¸ç¬¦åˆçš„ Lambda å¯¹è±¡å³å¯</li>
<li>isMale è¿™ä¸ªé™æ€æ–¹æ³•æœ‰å…¥å‚ Student å¯¹åº” <code>T</code>ï¼Œæœ‰è¿”å›å€¼ <code>boolean</code> ä¹Ÿèƒ½å¯¹åº”ä¸Šï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Student[name=å¼ æ— å¿Œ, sex=ç”·]</span><br><span class="line">Student[name=å®‹é’ä¹¦, sex=ç”·]</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-ç±»å-éé™æ€æ–¹æ³•å"><a href="#2-3-2-ç±»å-éé™æ€æ–¹æ³•å" class="headerlink" title="2.3.2 ç±»å::éé™æ€æ–¹æ³•å"></a>2.3.2 <code>ç±»å::éé™æ€æ–¹æ³•å</code></h3><p>å¦‚ä½•ç†è§£ï¼š</p>
<ul>
<li>å‡½æ•°å¯¹è±¡çš„é€»è¾‘éƒ¨åˆ†æ˜¯ï¼šè°ƒç”¨æ­¤éé™æ€æ–¹æ³•</li>
<li>å› æ­¤è¿™ä¸ªå‡½æ•°å¯¹è±¡éœ€è¦æä¾›ä¸€ä¸ªé¢å¤–çš„å¯¹è±¡å‚æ•°ï¼Œä»¥ä¾¿èƒ½å¤Ÿè°ƒç”¨æ­¤éé™æ€æ–¹æ³•</li>
<li>éé™æ€æ–¹æ³•çš„å‰©ä½™å‚æ•°ï¼Œä¸å‡½æ•°å¯¹è±¡çš„å‰©ä½™å‚æ•°ä¸€ä¸€å¯¹åº”</li>
</ul>
<p>ä¾‹1ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type3Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        highOrder(Student::hello);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">highOrder</span><span class="params">(Type3 lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.transfer(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>), <span class="string">&quot;ä½ å¥½&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Type3</span> &#123;</span><br><span class="line">        String <span class="title function_">transfer</span><span class="params">(Student stu, String message)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        String name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.name + <span class="string">&quot; say: &quot;</span> + message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¾‹ä¸­å‡½æ•°ç±»å‹çš„</p>
<ul>
<li>å‚æ•°1 å¯¹åº”ç€ hello æ–¹æ³•æ‰€å±ç±»å‹ Student</li>
<li>å‚æ•°2 å¯¹åº”ç€ hello æ–¹æ³•è‡ªå·±çš„å‚æ•° String</li>
<li>è¿”å›å€¼å¯¹åº”ç€ hello æ–¹æ³•è‡ªå·±çš„è¿”å›å€¼ String</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼ ä¸‰ say: ä½ å¥½</span><br></pre></td></tr></table></figure>

<p>ä¾‹2ï¼šæ”¹å†™ä¹‹å‰æ ¹æ®æ€§åˆ«è¿‡æ»¤çš„éœ€æ±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type2Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            éœ€æ±‚ï¼šæŒ‘é€‰å‡ºæ‰€æœ‰ç”·æ€§å­¦ç”Ÿ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Stream.of(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                .filter(Student::isMale)</span><br><span class="line">                .forEach(student -&gt; System.out.println(student));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(String name, String sex)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>filter</code> è¿™ä¸ªé«˜é˜¶å‡½æ•°æ¥æ”¶çš„å‡½æ•°ç±»å‹ï¼ˆPredicateï¼‰æ˜¯ï¼šä¸€ä¸ª <code>T</code> ç±»å‹çš„å…¥å‚ï¼Œä¸€ä¸ª <code>boolean</code> çš„è¿”å›å€¼ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ç»™å®ƒæä¾›ä¸€ä¸ªç›¸ç¬¦åˆçš„ Lambda å¯¹è±¡å³å¯</li>
<li>å®ƒçš„å…¥å‚1 <code>T</code> å¯¹åº”ç€ isMale éé™æ€æ–¹æ³•çš„æ‰€å±ç±»å‹ Student</li>
<li>å®ƒæ²¡æœ‰å…¶å®ƒå‚æ•°ï¼ŒisMale æ–¹æ³•ä¹Ÿæ²¡æœ‰å‚æ•°</li>
<li>è¿”å›å€¼éƒ½æ˜¯ boolean</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Student[name=å¼ æ— å¿Œ, sex=ç”·]</span><br><span class="line">Student[name=å®‹é’ä¹¦, sex=ç”·]</span><br></pre></td></tr></table></figure>

<p>ä¾‹3ï¼šå°†å­¦ç”Ÿå¯¹è±¡ä»…ä¿ç•™å­¦ç”Ÿçš„å§“å</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type2Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Stream.of(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                .map(Student::name)</span><br><span class="line">                .forEach(student -&gt; System.out.println(student));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(String name, String sex)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>map è¿™ä¸ªé«˜é˜¶å‡½æ•°æ¥æ”¶çš„å‡½æ•°ç±»å‹æ˜¯ï¼ˆFunctionï¼‰æ˜¯ï¼šä¸€ä¸ª <code>T</code> ç±»å‹çš„å‚æ•°ï¼Œä¸€ä¸ª <code>R</code> ç±»å‹çš„è¿”å›å€¼</li>
<li>å®ƒçš„å…¥å‚1 <code>T</code> å¯¹åº”ç€ name éé™æ€æ–¹æ³•çš„æ‰€å±ç±»å‹ Student</li>
<li>å®ƒæ²¡æœ‰å‰©ä½™å‚æ•°ï¼Œname æ–¹æ³•ä¹Ÿæ²¡æœ‰å‚æ•°</li>
<li>å®ƒçš„è¿”å›å€¼ R å¯¹åº”ç€ name æ–¹æ³•çš„è¿”å›å€¼ String</li>
</ul>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼ æ— å¿Œ</span><br><span class="line">å‘¨èŠ·è‹¥</span><br><span class="line">å®‹é’ä¹¦</span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-å¯¹è±¡-éé™æ€æ–¹æ³•å"><a href="#2-3-3-å¯¹è±¡-éé™æ€æ–¹æ³•å" class="headerlink" title="2.3.3 å¯¹è±¡::éé™æ€æ–¹æ³•å"></a>2.3.3 <code>å¯¹è±¡::éé™æ€æ–¹æ³•å</code></h3><p>å¦‚ä½•ç†è§£ï¼š</p>
<ul>
<li>å‡½æ•°å¯¹è±¡çš„é€»è¾‘éƒ¨åˆ†æ˜¯ï¼šè°ƒç”¨æ­¤éé™æ€æ–¹æ³•</li>
<li>å› ä¸ºå¯¹è±¡å·²æä¾›ï¼Œæ‰€ä»¥ä¸å¿…ä½œä¸ºå‡½æ•°å¯¹è±¡å‚æ•°çš„ä¸€éƒ¨åˆ†</li>
<li>éé™æ€æ–¹æ³•çš„å‰©ä½™å‚æ•°ï¼Œä¸å‡½æ•°å¯¹è±¡çš„å‰©ä½™å‚æ•°ä¸€ä¸€å¯¹åº”</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type4Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Util</span> <span class="variable">util</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Util</span>(); <span class="comment">// å¯¹è±¡</span></span><br><span class="line">        Stream.of(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                .filter(util::isMale)</span><br><span class="line">                .map(util::getName)</span><br><span class="line">                .forEach(student -&gt; System.out.println(student));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(String name, String sex)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Util</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> student.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        String <span class="title function_">getName</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> student.name();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¾ƒä¸ºå…¸å‹çš„ä¸€ä¸ªåº”ç”¨å°±æ˜¯ <code>System.out</code> å¯¹è±¡ä¸­çš„éé™æ€æ–¹æ³•ï¼Œæœ€åçš„è¾“å‡ºå¯ä»¥ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>forEach  è¿™ä¸ªé«˜é˜¶å‡½æ•°æ¥æ”¶çš„å‡½æ•°ç±»å‹ï¼ˆConsumerï¼‰æ˜¯ä¸€ä¸ª <code>T</code> ç±»å‹å‚æ•°ï¼Œ<code>void</code> æ— è¿”å›å€¼</li>
<li>è€Œ System.out å¯¹è±¡ä¸­æœ‰éé™æ€æ–¹æ³• void println(Object x) ä¸ä¹‹ä¸€è‡´ï¼Œå› æ­¤å¯ä»¥å°†æ­¤æ–¹æ³•åŒ–ä¸º Lambda å¯¹è±¡ç»™ forEach ä½¿ç”¨</li>
</ul>
<h3 id="2-3-4-ç±»å-new"><a href="#2-3-4-ç±»å-new" class="headerlink" title="2.3.4 ç±»å::new"></a>2.3.4 <code>ç±»å::new</code></h3><p>å¯¹äºæ„é€ æ–¹æ³•ï¼Œä¹Ÿæœ‰ä¸“é—¨çš„è¯­æ³•æŠŠå®ƒä»¬è½¬æ¢ä¸º Lambda å¯¹è±¡ã€‚</p>
<p>å‡½æ•°ç±»å‹åº”æ»¡è¶³ï¼š</p>
<ul>
<li>å‚æ•°éƒ¨åˆ†ä¸æ„é€ æ–¹æ³•å‚æ•°ä¸€è‡´</li>
<li>è¿”å›å€¼ç±»å‹ä¸æ„é€ æ–¹æ³•æ‰€åœ¨ç±»ä¸€è‡´</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type5Test</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = <span class="string">&quot;æŸäºº&quot;</span>;</span><br><span class="line">            <span class="built_in">this</span>.age = <span class="number">18</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = <span class="number">18</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Type51</span> &#123;</span><br><span class="line">        Student <span class="title function_">create</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Type52</span> &#123;</span><br><span class="line">        Student <span class="title function_">create</span><span class="params">(String name)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Type53</span> &#123;</span><br><span class="line">        Student <span class="title function_">create</span><span class="params">(String name, <span class="type">int</span> age)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        hiOrder((Type51) Student::<span class="keyword">new</span>);</span><br><span class="line">        hiOrder((Type52) Student::<span class="keyword">new</span>);</span><br><span class="line">        hiOrder((Type53) Student::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hiOrder</span><span class="params">(Type51 creator)</span> &#123;</span><br><span class="line">        System.out.println(creator.create());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hiOrder</span><span class="params">(Type52 creator)</span> &#123;</span><br><span class="line">        System.out.println(creator.create(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hiOrder</span><span class="params">(Type53 creator)</span> &#123;</span><br><span class="line">        System.out.println(creator.create(<span class="string">&quot;æå››&quot;</span>, <span class="number">20</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-5-this-éé™æ€æ–¹æ³•å"><a href="#2-3-5-this-éé™æ€æ–¹æ³•å" class="headerlink" title="2.3.5 this::éé™æ€æ–¹æ³•å"></a>2.3.5 <code>this::éé™æ€æ–¹æ³•å</code></h3><p>ç®—æ˜¯ <code>ç±»å::éé™æ€æ–¹æ³•å</code> å½¢å¼çš„ç‰¹ä¾‹ï¼Œåªèƒ½ç”¨åœ¨ç±»å†…éƒ¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type6Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Util</span> <span class="variable">util</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UtilExt</span>();</span><br><span class="line">        util.hiOrder(Stream.of(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ æ— å¿Œ&quot;</span>, <span class="string">&quot;ç”·&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å‘¨èŠ·è‹¥&quot;</span>, <span class="string">&quot;å¥³&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å®‹é’ä¹¦&quot;</span>, <span class="string">&quot;ç”·&quot;</span>)</span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(String name, String sex)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Util</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isMale</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> student.sex.equals(<span class="string">&quot;ç”·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">isFemale</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> student.sex.equals(<span class="string">&quot;å¥³&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">hiOrder</span><span class="params">(Stream&lt;Student&gt; stream)</span> &#123;</span><br><span class="line">            stream</span><br><span class="line">                    .filter(<span class="built_in">this</span>::isMale)</span><br><span class="line">                    .forEach(System.out::println);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-6-super-éé™æ€æ–¹æ³•å"><a href="#2-3-6-super-éé™æ€æ–¹æ³•å" class="headerlink" title="2.3.6 super::éé™æ€æ–¹æ³•å"></a>2.3.6 super::éé™æ€æ–¹æ³•å</h3><p>ç®—æ˜¯ <code>ç±»å::éé™æ€æ–¹æ³•å</code> å½¢å¼çš„ç‰¹ä¾‹ï¼Œåªèƒ½ç”¨åœ¨ç±»å†…éƒ¨ï¼ˆç”¨åœ¨è¦ç”¨ super åŒºåˆ†é‡è½½æ–¹æ³•æ—¶ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Type6Test</span> &#123;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">UtilExt</span> <span class="keyword">extends</span> <span class="title class_">Util</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">hiOrder</span><span class="params">(Stream&lt;Student&gt; stream)</span> &#123;</span><br><span class="line">            stream</span><br><span class="line">                    .filter(<span class="built_in">super</span>::isFemale)</span><br><span class="line">                    .forEach(System.out::println);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-7-ç‰¹ä¾‹"><a href="#2-3-7-ç‰¹ä¾‹" class="headerlink" title="2.3.7 ç‰¹ä¾‹"></a>2.3.7 ç‰¹ä¾‹</h3><p>å¯¹äºæ— è¿”å›å€¼çš„å‡½æ•°æ¥å£ï¼Œä¾‹å¦‚ <code>Consumer</code> å’Œ <code>Runnable</code>ï¼Œå®ƒä»¬å¯ä»¥é…åˆæœ‰è¿”å›å€¼çš„å‡½æ•°å¯¹è±¡ä½¿ç”¨ï¼ˆå‡½æ•°æ¥å£å’Œæ–¹æ³•å¼•ç”¨ä¹‹é—´ï¼Œå¯ä»¥å·®ä¸€ä¸ªè¿”å›å€¼ï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">task1</span> <span class="operator">=</span> ExceptionTest::print1;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">task2</span> <span class="operator">=</span> ExceptionTest::print2;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">print1</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;task1 running...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">print2</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;task2 running...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <code>Runnable</code> æ¥å£ä¸éœ€è¦è¿”å›å€¼ï¼Œè€Œå®é™…çš„å‡½æ•°å¯¹è±¡å¤šå‡ºçš„è¿”å›å€¼ä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚</p>
<h2 id="2-4-é—­åŒ…ï¼ˆClosureï¼‰"><a href="#2-4-é—­åŒ…ï¼ˆClosureï¼‰" class="headerlink" title="2.4 é—­åŒ…ï¼ˆClosureï¼‰"></a>2.4 é—­åŒ…ï¼ˆClosureï¼‰</h2><p>ä½•ä¸ºé—­åŒ…ï¼Ÿé—­åŒ…å°±æ˜¯<strong>å‡½æ•°å¯¹è±¡</strong>ä¸<strong>å¤–ç•Œå˜é‡</strong>ç»‘å®šåœ¨ä¸€èµ·ï¼Œå½¢æˆçš„æ•´ä½“ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureTest1</span> &#123;</span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Lambda</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> y)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        highOrder(y -&gt; x + y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">highOrder</span><span class="params">(Lambda lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.add(<span class="number">20</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä»£ç ä¸­çš„ $y \rightarrow x + y$ å’Œ $x &#x3D; 10$ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªé—­åŒ…</li>
<li>å¯ä»¥æƒ³è±¡æˆï¼Œå‡½æ•°å¯¹è±¡æœ‰ä¸ªèƒŒåŒ…ï¼ŒèƒŒåŒ…é‡Œå¯ä»¥è£…å˜é‡éšèº«æºå¸¦ï¼Œå°†æ¥å‡½æ•°å¯¹è±¡ç”­ç®¡ä¼ é€’åˆ°å¤šè¿œçš„åœ°æ–¹ï¼ŒåŒ…é‡Œæ€»è£…ç€ä¸ª $x &#x3D; 10$</li>
<li>æœ‰ä¸ªé™åˆ¶ï¼Œå±€éƒ¨å˜é‡ x å¿…é¡»æ˜¯ <code>final</code> æˆ– <code>effective final</code> çš„ï¼Œeffective final æ„æ€å°±æ˜¯ï¼Œè™½ç„¶æ²¡æœ‰ç”¨ final ä¿®é¥°ï¼Œä½†å°±åƒæ˜¯ç”¨ final ä¿®é¥°äº†ä¸€æ ·ï¼Œä¸èƒ½é‡æ–°èµ‹å€¼ï¼Œå¦åˆ™å°±è¯­æ³•é”™è¯¯ã€‚<ul>
<li>æ„å‘³ç€é—­åŒ…å˜é‡ï¼Œåœ¨è£…è¿›åŒ…é‡Œçš„é‚£ä¸€åˆ»ï¼Œå°±ä¸èƒ½å˜åŒ–äº†</li>
<li>é“ç†ä¹Ÿç®€å•ï¼Œä¸ºäº†ä¿è¯å‡½æ•°çš„ä¸å˜æ€§ï¼Œé˜²æ­¢ç ´åæˆé“</li>
</ul>
</li>
<li>é—­åŒ…æ˜¯ä¸€ç§ç»™å‡½æ•°æ‰§è¡Œæä¾›æ•°æ®çš„æ‰‹æ®µï¼Œå‡½æ•°æ‰§è¡Œæ—¢å¯ä»¥ä½¿ç”¨å‡½æ•°å…¥å‚ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é—­åŒ…å˜é‡</li>
</ul>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosureTest2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é—­åŒ…ä½œç”¨ï¼šç»™å‡½æ•°å¯¹è±¡æä¾›å‚æ•°ä»¥å¤–çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º 10 ä¸ªä»»åŠ¡å¯¹è±¡ï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡å¯¹è±¡ç»™ä¸€ä¸ªä»»åŠ¡ç¼–å·</span></span><br><span class="line">        List&lt;Runnable&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> i + <span class="number">1</span>;</span><br><span class="line">            <span class="type">Runnable</span> <span class="variable">task</span> </span><br><span class="line">                <span class="operator">=</span> () -&gt; System.out.println(Thread.currentThread()+<span class="string">&quot;:æ‰§è¡Œä»»åŠ¡&quot;</span> + k);</span><br><span class="line">            list.add(task);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">service</span> <span class="operator">=</span> Executors.newVirtualThreadPerTaskExecutor();</span><br><span class="line">        <span class="keyword">for</span> (Runnable task : list) &#123;</span><br><span class="line">            service.submit(task);</span><br><span class="line">        &#125;</span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-5-æŸ¯é‡ŒåŒ–ï¼ˆCarryingï¼‰"><a href="#2-5-æŸ¯é‡ŒåŒ–ï¼ˆCarryingï¼‰" class="headerlink" title="2.5 æŸ¯é‡ŒåŒ–ï¼ˆCarryingï¼‰"></a>2.5 æŸ¯é‡ŒåŒ–ï¼ˆCarryingï¼‰</h2><p>æŸ¯é‡ŒåŒ–çš„ä½œç”¨æ˜¯è®©å‡½æ•°å¯¹è±¡åˆ†æ­¥æ‰§è¡Œï¼ˆæœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨å¤šä¸ªå‡½æ•°å¯¹è±¡å’Œé—­åŒ…ï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Carrying1Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        highOrder(a -&gt; b -&gt; a + b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">highOrder</span><span class="params">(Step1 step1)</span> &#123;</span><br><span class="line">        <span class="type">Step2</span> <span class="variable">step2</span> <span class="operator">=</span> step1.exec(<span class="number">10</span>);</span><br><span class="line">        System.out.println(step2.exec(<span class="number">20</span>));</span><br><span class="line">        System.out.println(step2.exec(<span class="number">50</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Step1</span> &#123;</span><br><span class="line">        Step2 <span class="title function_">exec</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Step2</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">exec</span><span class="params">(<span class="type">int</span> b)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç ä¸­ï¼š</p>
<ul>
<li><code>a -&gt; ...</code> æ˜¯ç¬¬ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå®ƒçš„è¿”å›ç»“æœ  <code>b -&gt; ...</code> æ˜¯ç¬¬äºŒä¸ªå‡½æ•°å¯¹è±¡ï¼Œç”±ç¬¬äºŒä¸ªå‡½æ•°å¯¹è±¡è¿”å›æœ€ç»ˆç»“æœ</li>
<li>åè€…ä¸å‰é¢çš„å‚æ•° a æ„æˆäº†é—­åŒ…</li>
<li>step1.exec(10) ç¡®å®šäº† a çš„å€¼æ˜¯ 10ï¼Œè¿”å›ç¬¬äºŒä¸ªå‡½æ•°å¯¹è±¡ step2ï¼Œa è¢«æ”¾å…¥äº† step2 å¯¹è±¡çš„èƒŒåŒ…è®°ä¸‹æ¥äº†</li>
<li>step2.exec(20) ç¡®å®šäº† b çš„å€¼æ˜¯ 20ï¼Œæ­¤æ—¶å¯ä»¥æ‰§è¡Œ a + b çš„æ“ä½œï¼Œå¾—åˆ°ç»“æœ 30</li>
<li>step2.exec(50) åˆ†æè¿‡ç¨‹ç±»ä¼¼</li>
</ul>
<h2 id="2-6-é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order-Functionsï¼‰"><a href="#2-6-é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order-Functionsï¼‰" class="headerlink" title="2.6 é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order Functionsï¼‰"></a>2.6 é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order Functionsï¼‰</h2><p>æ‰€è°“é«˜é˜¶ï¼Œå°±æ˜¯æŒ‡å®ƒæ˜¯å…¶ä»–å‡½æ•°å¯¹è±¡çš„ä½¿ç”¨è€…ã€‚</p>
<p>ä½œç”¨ï¼š</p>
<ul>
<li>å°†<strong>é€šç”¨ã€å¤æ‚</strong>çš„é€»è¾‘éšå«åœ¨<strong>é«˜é˜¶å‡½æ•°</strong>ä¸­</li>
<li>å°†<strong>æ˜“å˜ã€æœªå®š</strong>çš„é€»è¾‘æ”¾åœ¨å¤–éƒ¨çš„<strong>å‡½æ•°å¯¹è±¡</strong>ä¸­</li>
</ul>
<p>1ã€å†…å¾ªç¯</p>
<p>2ã€éå†äºŒå‰æ ‘</p>
<p>3ã€ç®€å•æµ</p>
<p>4ã€ç®€å•æµ-åŒ–ç®€</p>
<p>5ã€ç®€å•æµ-æ”¶é›†</p>
<h2 id="2-7-ç­‰ä»·çš„-lambda-è¡¨è¾¾å¼"><a href="#2-7-ç­‰ä»·çš„-lambda-è¡¨è¾¾å¼" class="headerlink" title="2.7 ç­‰ä»·çš„ lambda è¡¨è¾¾å¼"></a>2.7 ç­‰ä»·çš„ lambda è¡¨è¾¾å¼</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) o;</span><br><span class="line">        <span class="keyword">return</span> Objects.equals(name, student.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p><code>Math::random</code> </p>
<p><code>()-&gt;Math.random()</code></p>
</li>
<li><p><code>Math::sqrt</code></p>
<p><code>(double number)-&gt;Math.sqrt(number)</code></p>
</li>
<li><p><code>Student::getName</code></p>
<p><code>(Student stu)-&gt;stu.getName()</code></p>
</li>
<li><p><code>Student::setName</code></p>
<p><code>(Student stu, String newName) -&gt; stu.setName(newName)</code></p>
</li>
<li><p><code>Student::hashCode</code></p>
<p><code>(Student stu) -&gt; stu.hashCode()</code></p>
</li>
<li><p><code>Student::equals</code></p>
<p><code>(Student stu, Object o) -&gt; stu.equals(o)</code></p>
</li>
</ol>
<p>å‡è®¾å·²æœ‰å¯¹è±¡ <code>Student stu = new Student(&quot;å¼ ä¸‰&quot;);</code></p>
<ol>
<li><p><code>stu::getName</code></p>
<p><code>()-&gt;stu.getName()</code></p>
</li>
<li><p><code>stu::setName</code></p>
<p><code>(String newName)-&gt;stu.setName(newName)</code></p>
</li>
<li><p><code>Student::new</code></p>
<p><code>(String name)-&gt;new Student(name)</code></p>
</li>
</ol>
<h1 id="3-Stream-API"><a href="#3-Stream-API" class="headerlink" title="3. Stream API"></a>3. Stream API</h1><h2 id="3-1-Streamæµçš„æ€æƒ³"><a href="#3-1-Streamæµçš„æ€æƒ³" class="headerlink" title="3.1 Streamæµçš„æ€æƒ³"></a>3.1 Streamæµçš„æ€æƒ³</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/Stream%E6%B5%81%E6%80%9D%E6%83%B3.png" alt="Streamæµæ€æƒ³" style="zoom: 67%;">

<h2 id="3-2-Streamæµä½œç”¨"><a href="#3-2-Streamæµä½œç”¨" class="headerlink" title="3.2 Streamæµä½œç”¨"></a>3.2 Streamæµä½œç”¨</h2><p>ç»“åˆLambdaè¡¨è¾¾å¼ï¼Œç®€åŒ–é›†åˆã€æ•°ç»„æ“ä½œã€‚</p>
<h2 id="3-3-æµçš„ä¸‰ç±»æ–¹æ³•"><a href="#3-3-æµçš„ä¸‰ç±»æ–¹æ³•" class="headerlink" title="3.3 æµçš„ä¸‰ç±»æ–¹æ³•"></a>3.3 æµçš„ä¸‰ç±»æ–¹æ³•</h2><ul>
<li>è·å–Streamæµ<ul>
<li>åˆ›å»ºä¸€æ¡æµæ°´çº¿ï¼Œå¹¶æŠŠæ•°æ®æ”¾åˆ°æµæ°´çº¿ä¸Šå‡†å¤‡è¿›è¡Œæ“ä½œ</li>
</ul>
</li>
<li>ä¸­é—´æ–¹æ³•<ul>
<li>æµæ°´çº¿ä¸Šçš„æ“ä½œ</li>
<li>ä¸€æ¬¡æ“ä½œå®Œæ¯•ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–æ“ä½œ</li>
</ul>
</li>
<li>ç»ˆç»“æ–¹æ³•<ul>
<li>ä¸€ä¸ªStreamæµåªèƒ½æœ‰ä¸€ä¸ªç»ˆç»“æ–¹æ³•</li>
<li>æ˜¯æµæ°´çº¿ä¸Šçš„æœ€åä¸€ä¸ªæ“ä½œ</li>
</ul>
</li>
</ul>
<h2 id="3-4-Streamä½¿ç”¨æ­¥éª¤"><a href="#3-4-Streamä½¿ç”¨æ­¥éª¤" class="headerlink" title="3.4 Streamä½¿ç”¨æ­¥éª¤"></a>3.4 Streamä½¿ç”¨æ­¥éª¤</h2><ol>
<li>å…ˆå¾—åˆ°ä¸€æ¡Streamæµï¼ˆæµæ°´çº¿ï¼‰ï¼Œå†æŠŠæ•°æ®æ”¾ä¸Šå»ã€‚</li>
<li>ä½¿ç”¨<strong>ä¸­é—´æ–¹æ³•</strong>å¯¹æµæ°´çº¿ä¸Šçš„æ•°æ®è¿›è¡Œæ“ä½œã€‚</li>
<li>ä½¿ç”¨<strong>ç»ˆç»“æ–¹æ³•</strong>å¯¹æµæ°´çº¿ä¸Šçš„æ•°æ®è¿›è¡Œæ“ä½œã€‚</li>
</ol>
<blockquote>
<p>ç”ŸæˆStreamæµçš„æ–¹å¼</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">è·å–æ–¹å¼</th>
<th align="center">æ–¹æ³•å</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å•åˆ—é›†åˆ</td>
<td align="center">default Stream<E> stream()</E></td>
<td align="center">Collectionä¸­çš„é»˜è®¤æ–¹æ³•</td>
</tr>
<tr>
<td align="center">åŒåˆ—é›†åˆ</td>
<td align="center">æ— </td>
<td align="center">æ— æ³•ç›´æ¥ä½¿ç”¨streamæµ</td>
</tr>
<tr>
<td align="center">æ•°ç»„</td>
<td align="center">public static <T> Stream<T> stream(T[] array)</T></T></td>
<td align="center">Arrayså·¥å…·ç±»ä¸­çš„é™æ€æ–¹æ³•</td>
</tr>
<tr>
<td align="center">ä¸€å †é›¶æ•£æ•°æ®</td>
<td align="center">public static<T> Stream<T> of(Tâ€¦ values)</T></T></td>
<td align="center">Streamæ¥å£ä¸­çš„é™æ€æ–¹æ³•</td>
</tr>
</tbody></table>
<p><font color="red"><strong>PSï¼šStreamæ¥å£ä¸­é™æ€æ–¹æ³• <code>of</code> çš„ç»†èŠ‚</strong></font></p>
<p>æ–¹æ³•çš„å½¢å‚æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œå¯ä»¥ä¼ é€’ä¸€å †é›¶æ•£çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä¼ é€’æ•°ç»„ï¼Œä½†æ˜¯æ•°ç»„<strong>å¿…é¡»</strong>æ˜¯<font color="red"><strong>å¼•ç”¨æ•°æ®ç±»å‹</strong></font>çš„ï¼Œå¦‚æœä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯ä¼šæŠŠæ•´ä¸ªæ•°ç»„å½“åšä¸€ä¸ªå…ƒç´ ï¼Œæ”¾åˆ°Streamå½“ä¸­ã€‚</p>
<blockquote>
<p>Streamæµä¸­é—´æ“ä½œæ–¹æ³•</p>
</blockquote>
<p>æ¦‚å¿µï¼šä¸­é—´æ“ä½œçš„æ„æ€æ˜¯,æ‰§è¡Œå®Œæ­¤æ–¹æ³•ä¹‹åï¼ŒStreamæµä¾ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œ</p>
<p>å¸¸è§æ–¹æ³•ï¼š</p>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Stream<T> filter(Predicate predicate)</T></td>
<td align="center">ç”¨äºå¯¹æµä¸­çš„æ•°æ®è¿›è¡Œè¿‡æ»¤</td>
</tr>
<tr>
<td align="center">Stream<T> limit(long maxSize)</T></td>
<td align="center">è¿”å›æ­¤æµä¸­çš„å…ƒç´ ç»„æˆçš„æµï¼Œæˆªå–å‰æŒ‡å®šå‚æ•°ä¸ªæ•°çš„æ•°æ®</td>
</tr>
<tr>
<td align="center">Stream<T> skip(long n)</T></td>
<td align="center">è·³è¿‡æŒ‡å®šå‚æ•°ä¸ªæ•°çš„æ•°æ®ï¼Œè¿”å›ç”±è¯¥æµçš„å‰©ä½™å…ƒç´ ç»„æˆçš„æµ</td>
</tr>
<tr>
<td align="center">static <T> Stream<T> concat(Stream a, Stream b)</T></T></td>
<td align="center">åˆå¹¶aå’Œbä¸¤ä¸ªæµä¸ºä¸€ä¸ªæµ</td>
</tr>
<tr>
<td align="center">Stream<T> distinct()</T></td>
<td align="center">è¿”å›ç”±è¯¥æµçš„ä¸åŒå…ƒç´ ï¼ˆæ ¹æ®Object.equals(Object) ï¼‰ç»„æˆçš„æµ</td>
</tr>
</tbody></table>
<p><strong>PSï¼š</strong></p>
<ul>
<li>ä¸­é—´æ–¹æ³•ï¼Œè¿”å›æ–°çš„Streamæµï¼Œ<font color="red"><strong>åŸæ¥çš„Streamæµåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œ</strong></font>å»ºè®®ä½¿ç”¨é“¾å¼ç¼–ç¨‹ã€‚</li>
<li>ä¿®æ”¹Streamæµä¸­çš„æ•°æ®ï¼Œ<font color="red"><strong>ä¸ä¼šå½±å“åŸæ¥é›†åˆæˆ–æ•°ç»„çš„æ•°æ®ã€‚</strong></font></li>
</ul>
<blockquote>
<p>Streamæµç»ˆç»“æ“ä½œæ–¹æ³•</p>
</blockquote>
<p>æ¦‚å¿µï¼šç»ˆç»“æ“ä½œçš„æ„æ€æ˜¯ï¼Œæ‰§è¡Œå®Œæ­¤æ–¹æ³•ä¹‹åï¼ŒStreamæµå°†ä¸èƒ½å†æ‰§è¡Œå…¶ä»–æ“ä½œ</p>
<p>å¸¸ç”¨æ–¹æ³•ï¼š</p>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">void forEach(Consumer action)</td>
<td align="center">éå†ã€æ‰“å°</td>
</tr>
<tr>
<td align="center">long count()</td>
<td align="center">ç»Ÿè®¡</td>
</tr>
<tr>
<td align="center">toArray()</td>
<td align="center">æŠŠç»“æœæ”¶é›†åˆ°æ•°ç»„ä¸­</td>
</tr>
<tr>
<td align="center">collect(Collector collector)</td>
<td align="center">æŠŠç»“æœæ”¶é›†åˆ°é›†åˆä¸­</td>
</tr>
</tbody></table>
<p>å·¥å…·ç±»<code>Collectors</code>æä¾›äº†å…·ä½“çš„é›†åˆæ”¶é›†æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">public static <T> Collector toList()</T></td>
<td align="center">æŠŠå…ƒç´ æ”¶é›†åˆ°Listé›†åˆä¸­</td>
</tr>
<tr>
<td align="center">public static <T> Collector toSet()</T></td>
<td align="center">æŠŠå…ƒç´ æ”¶é›†åˆ°Seté›†åˆä¸­</td>
</tr>
<tr>
<td align="center">public static  Collector toMap(Function keyMapper,Function valueMapper)</td>
<td align="center">æŠŠå…ƒç´ æ”¶é›†åˆ°Mapé›†åˆä¸­</td>
</tr>
</tbody></table>
<p><strong>PSï¼šç»ˆç»“æ“ä½œåªèƒ½æ‰§è¡Œä¸€æ¬¡</strong></p>
<h2 id="3-5-è¿‡æ»¤"><a href="#3-5-è¿‡æ»¤" class="headerlink" title="3.5 è¿‡æ»¤"></a>3.5 è¿‡æ»¤</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">record</span> <span class="title class_">Fruit</span><span class="params">(String cname, String name, String category, String color)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">Stream.of(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è‰è“&quot;</span>, <span class="string">&quot;Strawberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;çº¢è‰²&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ¡‘è‘š&quot;</span>, <span class="string">&quot;Mulberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;ç´«è‰²&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ¨æ¢…&quot;</span>, <span class="string">&quot;Waxberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;çº¢è‰²&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ ¸æ¡ƒ&quot;</span>, <span class="string">&quot;Walnut&quot;</span>, <span class="string">&quot;åšæœ&quot;</span>, <span class="string">&quot;æ£•è‰²&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è‰è“&quot;</span>, <span class="string">&quot;Peanut&quot;</span>, <span class="string">&quot;åšæœ&quot;</span>, <span class="string">&quot;æ£•è‰²&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è“è“&quot;</span>, <span class="string">&quot;Blueberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;è“è‰²&quot;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/Stream%E6%B5%81%E8%BF%87%E6%BB%A4.png" alt="Streamæµè¿‡æ»¤"></p>
<p>æ‰¾åˆ°æ‰€æœ‰æµ†æœï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.filter(f -&gt; f.category.equals(<span class="string">&quot;æµ†æœ&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°è“è‰²çš„æµ†æœï¼š</p>
<p>æ–¹æ³•1ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.filter(f -&gt; f.category().equals(<span class="string">&quot;æµ†æœ&quot;</span>) &amp;&amp; f.color().equals(<span class="string">&quot;è“è‰²&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•2ï¼šè®©æ¯ä¸ª lambda åªåšä¸€ä»¶äº‹ï¼Œä¸¤æ¬¡ filter ç›¸å¯¹äºå¹¶ä¸”å…³ç³»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.filter(f -&gt; f.category.equals(<span class="string">&quot;æµ†æœ&quot;</span>))</span><br><span class="line">.filter(f -&gt; f.color().equals(<span class="string">&quot;è“è‰²&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•3ï¼šè®©æ¯ä¸ª lambda åªåšä¸€ä»¶äº‹ï¼Œä¸è¿‡æ¯”æ–¹æ³•2å¼ºçš„åœ°æ–¹å¯ä»¥ orï¼Œandï¼Œnagate è¿ç®—</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.filter(((Predicate&lt;Fruit&gt;) f -&gt; f.category.equals(<span class="string">&quot;æµ†æœ&quot;</span>)).and(f -&gt; f.color().equals(<span class="string">&quot;è“è‰²&quot;</span>)))</span><br></pre></td></tr></table></figure>

<h2 id="3-6-æ˜ å°„"><a href="#3-6-æ˜ å°„" class="headerlink" title="3.6 æ˜ å°„"></a>3.6 æ˜ å°„</h2><p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/Stream%E6%B5%81%E6%98%A0%E5%B0%84.png" alt="Streamæµæ˜ å°„"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.map(f -&gt; f.cname() + <span class="string">&quot;é…±&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="3-7-é™ç»´"><a href="#3-7-é™ç»´" class="headerlink" title="3.7 é™ç»´"></a>3.7 é™ç»´</h2><p>ä¾‹1ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/JavaIMG/Stream%E6%B5%81%E9%99%8D%E7%BB%B4.png" alt="Streamæµé™ç»´" style="zoom: 67%;">

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">record</span> <span class="title class_">Fruit</span><span class="params">(String cname, String name, String category, String color)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">Stream.of(</span><br><span class="line">        List.of(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è‰è“&quot;</span>, <span class="string">&quot;Strawberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;çº¢è‰²&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ¡‘è‘š&quot;</span>, <span class="string">&quot;Mulberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;ç´«è‰²&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ¨æ¢…&quot;</span>, <span class="string">&quot;Waxberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;çº¢è‰²&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è“è“&quot;</span>, <span class="string">&quot;Blueberry&quot;</span>, <span class="string">&quot;æµ†æœ&quot;</span>, <span class="string">&quot;è“è‰²&quot;</span>)</span><br><span class="line">        ),</span><br><span class="line">        List.of(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;æ ¸æ¡ƒ&quot;</span>, <span class="string">&quot;Walnut&quot;</span>, <span class="string">&quot;åšæœ&quot;</span>, <span class="string">&quot;æ£•è‰²&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="string">&quot;è‰è“&quot;</span>, <span class="string">&quot;Peanut&quot;</span>, <span class="string">&quot;åšæœ&quot;</span>, <span class="string">&quot;æ£•è‰²&quot;</span>)</span><br><span class="line">        )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">.flatMap(Collection::stream)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æŠŠåšæœå’Œæµ†æœä¸¤ä¸ªé›†åˆå˜æˆäº†å«å…­ä¸ªå…ƒç´ çš„æ°´æœæµã€‚</p>
<p>ä¾‹2ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.of(</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Order</span>(<span class="number">1</span>, List.of(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">6499</span>, <span class="number">1</span>, <span class="string">&quot;HUAWEI MateBook 14s&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">6999</span>, <span class="number">1</span>, <span class="string">&quot;HUAWEI Mate 60 Pro&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">1488</span>, <span class="number">1</span>, <span class="string">&quot;HUAWEI WATCH GT 4&quot;</span>)</span><br><span class="line">        )),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Order</span>(<span class="number">1</span>, List.of(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">8999</span>, <span class="number">1</span>, <span class="string">&quot;Apple MacBook Air 13&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">7999</span>, <span class="number">1</span>, <span class="string">&quot;Apple iPhone 15 Pro&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Item</span>(<span class="number">2999</span>, <span class="number">1</span>, <span class="string">&quot;Apple Watch Series 9&quot;</span>)</span><br><span class="line">        ))</span><br><span class="line">)</span><br><span class="line">    </span><br><span class="line"><span class="comment">// é€ä¸€å¤„ç†æ¯ä¸ªè®¢å•ä¸­çš„å•†å“</span></span><br><span class="line">.flatMap(order -&gt; order.items().stream())</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æŠŠä¸€ä¸ªæœ‰ä¸¤ä¸ªå…ƒç´ çš„è®¢å•æµï¼Œå˜æˆäº†ä¸€ä¸ªæœ‰å…­ä¸ªå…ƒç´ çš„å•†å“æµã€‚</p>
<h2 id="3-8-æ„å»º"><a href="#3-8-æ„å»º" class="headerlink" title="3.8 æ„å»º"></a>3.8 æ„å»º</h2><p>æ ¹æ®å·²æœ‰çš„æ•°ç»„æ„å»ºæµ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Arrays.stream(array)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å·²æœ‰çš„ Collection æ„å»ºæµï¼ˆåŒ…æ‹¬ Listï¼ŒSet ç­‰ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List.of(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆæµ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.of(<span class="string">&quot;d&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æŠŠå¤šä¸ªå¯¹è±¡å˜æˆæµ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.of(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯å¤šä¸ªæ•°ç»„å¯¹è±¡å˜æˆæµï¼š</p>
<p>æ•°ç»„<strong>å¿…é¡»</strong>æ˜¯<font color="red"><strong>å¼•ç”¨æ•°æ®ç±»å‹</strong></font>çš„ï¼Œå¦‚æœä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯ä¼šæŠŠæ•´ä¸ªæ•°ç»„å½“åšä¸€ä¸ªå…ƒç´ ï¼Œæ”¾åˆ°Streamå½“ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>[] arr1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line">String[] arr2 = &#123;<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">Stream.of(arr1).forEach(System.out::println);</span><br><span class="line">System.out.println(<span class="string">&quot;-----------&quot;</span>);</span><br><span class="line">Stream.of(arr2).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯ä¼šæŠŠæ•´ä¸ªæ•°ç»„å½“åšä¸€ä¸ªå…ƒç´ ï¼Œæ”¾åˆ°Streamå½“ä¸­ï¼Œæ‰“å°å‡ºæ¥çš„æ˜¯ä¸€ä¸ªåœ°å€å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[I@446cdf90</span><br><span class="line">-----------</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br></pre></td></tr></table></figure>

<h2 id="3-9-æ‹¼æ¥"><a href="#3-9-æ‹¼æ¥" class="headerlink" title="3.9 æ‹¼æ¥"></a>3.9 æ‹¼æ¥</h2><p>ä¸¤ä¸ªæµæ‹¼æ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.concat(Stream.of(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>), Stream.of(<span class="string">&quot;d&quot;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="3-10-æˆªå–"><a href="#3-10-æˆªå–" class="headerlink" title="3.10 æˆªå–"></a>3.10 æˆªå–</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.concat(Stream.of(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>), Stream.of(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">    .skip(<span class="number">1</span>)</span><br><span class="line">    .limit(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b</span><br><span class="line">c</span><br></pre></td></tr></table></figure>

<ul>
<li>skip æ˜¯è·³è¿‡å‡ ä¸ªå…ƒç´ </li>
<li>limit æ˜¯é™åˆ¶å¤„ç†çš„å…ƒç´ ä¸ªæ•°</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.concat(Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), Stream.of(<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">    .takeWhile(x -&gt; x &lt; <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.concat(Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), Stream.of(<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">	.dropWhile(x -&gt; x &lt; <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<ul>
<li><p>dropWhile æ˜¯ drop æµä¸­å…ƒç´ ï¼Œç›´åˆ°æ¡ä»¶ä¸æˆç«‹ï¼Œç•™ä¸‹å‰©ä½™å…ƒç´ </p>
</li>
<li><p>takeWhile æ˜¯ take æµä¸­å…ƒç´ ï¼Œç›´åˆ°æ¡ä»¶ä¸æˆç«‹ï¼Œèˆå¼ƒå‰©ä½™å…ƒç´ </p>
</li>
</ul>
<h2 id="3-11-ç”Ÿæˆ"><a href="#3-11-ç”Ÿæˆ" class="headerlink" title="3.11 ç”Ÿæˆ"></a>3.11 ç”Ÿæˆ</h2><p>ç”Ÿæˆä» 0 ~ 9 çš„æ•°å­—</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IntStream.range(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line">IntStream.rangeClosed(<span class="number">0</span>, <span class="number">9</span>)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è®¢åˆ¶ï¼Œå¯ä»¥ç”¨ <code>iterate</code> æ–¹æ³•ï¼Œä¾‹å¦‚ä¸‹é¢ç”Ÿæˆå¥‡æ•°åºåˆ—ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IntStream.iterate(<span class="number">1</span>, x -&gt; x + <span class="number">2</span>)</span><br><span class="line">IntStream.iterate(<span class="number">1</span>, x -&gt; x + <span class="number">2</span>).limit(<span class="number">10</span>)	<span class="comment">//é™åˆ¶å…ƒç´ ä¸ªæ•°</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å‚æ•°1 æ˜¯åˆå§‹å€¼</li>
<li>å‚æ•°2 æ˜¯ä¸€ä¸ªç‰¹æ®Š Functionï¼Œå³å‚æ•°ç±»å‹ä¸è¿”å›å€¼ç›¸åŒï¼Œå®ƒä¼šæ ¹æ®ä¸Šä¸€ä¸ªå…ƒç´  x çš„å€¼è®¡ç®—å‡ºå½“å‰å…ƒç´ </li>
<li>éœ€è¦ç”¨ limit é™åˆ¶å…ƒç´ ä¸ªæ•°</li>
</ul>
<p>ä¹Ÿå¯ä»¥ç”¨ <code>iterate</code> çš„é‡è½½æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IntStream.iterate(<span class="number">1</span>, x -&gt; x &lt; <span class="number">10</span>, x -&gt; x + <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>å‚æ•°1 æ˜¯åˆå§‹å€¼</li>
<li>å‚æ•°2 ç”¨æ¥é™åˆ¶å…ƒç´ ä¸ªæ•°ï¼Œä¸€æ—¦ä¸æ»¡è¶³æ­¤æ¡ä»¶ï¼Œæµå°±ç»“æŸ</li>
<li>å‚æ•°3 ç›¸å½“äºä¸Šä¸ªæ–¹æ³•çš„å‚æ•°2</li>
</ul>
<p><code>iterate</code> çš„ç‰¹ç‚¹æ˜¯æ ¹æ®ä¸Šä¸€ä¸ªå…ƒç´ è®¡ç®—å½“å‰å…ƒç´ ï¼Œå¦‚æœä¸éœ€è¦ä¾èµ–ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥æ”¹ç”¨ <code>generate</code> æ–¹æ³•ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢æ˜¯ç”Ÿæˆ 5 ä¸ªéšæœº intï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.generate(()-&gt; ThreadLocalRandom.current().nextInt()).limit(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡å¦‚æœåªæ˜¯ç”Ÿæˆéšæœºæ•°çš„è¯ï¼Œæœ‰æ›´ç®€å•çš„åŠæ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ThreadLocalRandom.current().ints(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æŒ‡å®šä¸Šä¸‹é™ï¼Œä¾‹å¦‚ä¸‹é¢æ˜¯ç”Ÿæˆä» 0~9 çš„100ä¸ªéšæœºæ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ThreadLocalRandom.current().ints(<span class="number">100</span>, <span class="number">0</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<h2 id="3-12-æŸ¥æ‰¾ä¸åˆ¤æ–­"><a href="#3-12-æŸ¥æ‰¾ä¸åˆ¤æ–­" class="headerlink" title="3.12 æŸ¥æ‰¾ä¸åˆ¤æ–­"></a>3.12 æŸ¥æ‰¾ä¸åˆ¤æ–­</h2><blockquote>
<p>æŸ¥æ‰¾</p>
</blockquote>
<p>ä¸‹é¢çš„ä»£ç æ‰¾åˆ°æµä¸­ä»»æ„ï¼ˆAnyï¼‰ä¸€ä¸ªå¶æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>[] array = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">Arrays.stream(array)</span><br><span class="line">    .filter(x -&gt; (x &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">    .findAny()</span><br><span class="line">    .ifPresent(System.out::println);</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„ findAny è¿”å›çš„æ˜¯ <code>OptionalInt</code> å¯¹è±¡ï¼Œå› ä¸ºå¯èƒ½æµä¸­ä¸å­˜åœ¨å¶æ•°</li>
<li>å¯¹äº <code>OptionalInt</code> å¯¹è±¡ï¼Œä¸€èˆ¬éœ€è¦ç”¨ <code>ifPresent</code> æˆ– <code>orElse</code>ï¼ˆæä¾›é»˜è®¤å€¼ï¼‰æ¥å¤„ç†</li>
</ul>
<p>ä¸ <code>findAny</code> æ¯”è¾ƒç±»ä¼¼çš„æ˜¯ <code>firstFirst</code>ï¼Œå®ƒä¿©çš„åŒºåˆ«ï¼Ÿ</p>
<ul>
<li>findAny æ˜¯æ‰¾åœ¨æµä¸­ä»»æ„ä½ç½®çš„å…ƒç´ ï¼Œä¸éœ€è¦è€ƒè™‘é¡ºåºï¼Œå¯¹äºä¸Šä¾‹è¿”å› 6 ä¹Ÿæ˜¯å¯ä»¥çš„</li>
<li>findFirst æ˜¯æ‰¾ç¬¬ä¸€ä¸ªå‡ºç°åœ¨å…ƒç´ ï¼Œéœ€è¦è€ƒè™‘é¡ºåºï¼Œå¯¹äºä¸Šä¾‹åªèƒ½è¿”å› 4</li>
<li>findAny åœ¨é¡ºåºæµä¸­ä¸ findFirst è¡¨ç°ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå¹¶è¡Œæµä¸‹ä¼šæ›´å¿«</li>
</ul>
<blockquote>
<p>åˆ¤æ–­</p>
</blockquote>
<p>åˆ¤æ–­æµä¸­æ˜¯å¦å­˜åœ¨ä»»æ„ä¸€ä¸ªå¶æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Arrays.stream(array).anyMatch(x -&gt; (x &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>å®ƒè¿”å›çš„æ˜¯ boolean å€¼ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥åˆ¤æ–­</li>
</ul>
<p>åˆ¤æ–­æµæ˜¯å¦å…¨éƒ¨æ˜¯å¶æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Arrays.stream(array).allMatch(x -&gt; (x &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>åŒæ ·ï¼Œå®ƒè¿”å›çš„æ˜¯ boolean å€¼ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥åˆ¤æ–­</li>
</ul>
<p>åˆ¤æ–­æµæ˜¯å¦å…¨éƒ¨ä¸æ˜¯å¶æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Arrays.stream(array).noneMatch(x -&gt; (x &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>noneMatch ä¸ allMatch å«ä¹‰æ°å¥½ç›¸å</li>
</ul>
<h2 id="3-13-æ’åºä¸å»é‡"><a href="#3-13-æ’åºä¸å»é‡" class="headerlink" title="3.13 æ’åºä¸å»é‡"></a>3.13 æ’åºä¸å»é‡</h2><blockquote>
<p>å»é‡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IntStream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">	.distinct()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ’åº</p>
</blockquote>
<p>å·²çŸ¥æœ‰æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">record</span> <span class="title class_">Hero</span><span class="params">(String name, <span class="type">int</span> strength)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">Stream.of(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;ç‹¬å­¤æ±‚è´¥&quot;</span>, <span class="number">100</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;ä»¤ç‹å†²&quot;</span>, <span class="number">90</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;é£æ¸…æ‰¬&quot;</span>, <span class="number">98</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;ä¸œæ–¹ä¸è´¥&quot;</span>, <span class="number">98</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;æ–¹è¯&quot;</span>, <span class="number">92</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;ä»»æˆ‘è¡Œ&quot;</span>, <span class="number">92</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;å†²è™š&quot;</span>, <span class="number">90</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;å‘é—®å¤©&quot;</span>, <span class="number">88</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="string">&quot;ä¸æˆ’&quot;</span>, <span class="number">88</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚ï¼Œé¦–å…ˆæŒ‰ strength æ­¦åŠ›æ’åºï¼ˆé€†åºï¼‰ï¼Œæ­¦åŠ›ç›¸åŒçš„ï¼ŒæŒ‰å§“åé•¿åº¦æ’åºï¼ˆæ­£åºï¼‰</p>
<p>ä»…ç”¨ lambda æ¥è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.sorted((a,b)-&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> Integer.compare(b.strength(), a.strength());</span><br><span class="line">    <span class="keyword">return</span> (res == <span class="number">0</span>) ? Integer.compare(a.nameLength(), b.nameLength()) : res; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•å¼•ç”¨æ”¹å†™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.sorted(</span><br><span class="line">    Comparator.comparingInt(Hero::strength)</span><br><span class="line">      .reversed()</span><br><span class="line">      .thenComparingInt(Hero::nameLength)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>comparingInt</code> æ¥æ”¶ä¸€ä¸ª key æå–å™¨ï¼ˆè¯´æ˜æŒ‰å¯¹è±¡ä¸­å“ªéƒ¨åˆ†æ¥æ¯”è¾ƒï¼‰ï¼Œè¿”å›ä¸€ä¸ªæ¯”è¾ƒå™¨</li>
<li><code>reversed</code> è¿”å›ä¸€ä¸ªé¡ºåºç›¸åçš„æ¯”è¾ƒå™¨</li>
<li><code>thenComparingInt</code> æ¥æ”¶ä¸€ä¸ª key æå–å™¨ï¼Œè¿”å›ä¸€ä¸ªæ–°æ¯”è¾ƒå™¨ï¼Œæ–°æ¯”è¾ƒå™¨åœ¨åŸæœ‰æ¯”è¾ƒå™¨ç»“æœç›¸ç­‰æ—¶æ‰§è¡Œæ–°çš„æ¯”è¾ƒé€»è¾‘</li>
</ul>
<p>å¢åŠ ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">record</span> <span class="title class_">Hero</span><span class="params">(String name, <span class="type">int</span> strength)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">nameLength</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name.length();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸç†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.sorted((e, f) -&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span></span><br><span class="line">        ((Comparator&lt;Hero&gt;) (c, d) -&gt;</span><br><span class="line">            ((Comparator&lt;Hero&gt;) (a, b) -&gt; Integer.compare(a.strength(), b.strength()))</span><br><span class="line">                .compare(d, c))</span><br><span class="line">            .compare(e, f);</span><br><span class="line">    <span class="keyword">return</span> (res == <span class="number">0</span>) ? Integer.compare(e.nameLength(), f.nameLength()) : res;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸å¥½çœ‹ï¼Œæ”¹æˆä¸‹é¢çš„ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.sorted(step3(step2(step1())))</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Comparator&lt;Hero&gt; <span class="title function_">step1</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (a, b) -&gt; Integer.compare(a.strength(), b.strength());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Comparator&lt;Hero&gt; <span class="title function_">step2</span><span class="params">(Comparator&lt;Hero&gt; step1)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (c, d) -&gt; step1.compare(d, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Comparator&lt;Hero&gt; <span class="title function_">step3</span><span class="params">(Comparator&lt;Hero&gt; step2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (e, f) -&gt; &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> step2.compare(e, f);</span><br><span class="line">        <span class="keyword">return</span> (res == <span class="number">0</span>) ? Integer.compare(e.nameLength(), f.nameLength()) : res;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-14-åŒ–ç®€"><a href="#3-14-åŒ–ç®€" class="headerlink" title="3.14 åŒ–ç®€"></a>3.14 åŒ–ç®€</h2><p>åŒ–ç®€ï¼šä¸¤ä¸¤åˆå¹¶ï¼Œåªå‰©ä¸€ä¸ª</p>
<p>é€‚åˆï¼šæœ€å¤§å€¼ã€æœ€å°å€¼ã€æ±‚å’Œã€æ±‚ä¸ªæ•°â€¦</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.reduce(init, (p,x) -&gt; r);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>init</code> ä»£è¡¨åˆå§‹å€¼ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª<code>Optional</code>å¯¹è±¡ï¼Œå½“ä¸ç»™åˆå§‹å€¼æ—¶ï¼Œæµä¸­æ²¡æœ‰å…ƒç´ å¯¹è±¡çš„æ—¶å€™è¿”å›ä¸€ä¸ª<code>Optional.empty</code></li>
<li><code>(p,x) -&gt; r</code> æ˜¯ä¸€ä¸ª BinaryOperatorï¼Œä½œç”¨æ˜¯æ ¹æ®ä¸Šæ¬¡åŒ–ç®€ç»“æœ p å’Œå½“å‰å…ƒç´  xï¼Œå¾—åˆ°æœ¬æ¬¡åŒ–ç®€ç»“æœ r</li>
</ul>
<p>è¿™æ ·ä¸¤ä¸¤åŒ–ç®€ï¼Œå¯ä»¥å°†æµä¸­çš„æ‰€æœ‰å…ƒç´ åˆå¹¶æˆä¸€ä¸ªç»“æœã€‚</p>
<h2 id="3-15-æ”¶é›†"><a href="#3-15-æ”¶é›†" class="headerlink" title="3.15 æ”¶é›†"></a>3.15 æ”¶é›†</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.collect( supplier, accumulator, combiner);</span><br></pre></td></tr></table></figure>

<ul>
<li>supplier æ˜¯æè¿°å¦‚ä½•åˆ›å»ºæ”¶é›†å®¹å™¨ c ï¼š<code>()-&gt; c</code></li>
<li>accumulator æ˜¯æè¿°å¦‚ä½•å‘å®¹å™¨ c æ·»åŠ å…ƒç´  xï¼š<code>(c, x) -&gt; void</code></li>
<li>combiner æ˜¯æè¿°å¦‚ä½•åˆå¹¶ä¸¤ä¸ªå®¹å™¨ï¼š<code>(c1, c2) -&gt; void</code><ul>
<li>ä¸²è¡Œæµä¸‹ä¸éœ€è¦åˆå¹¶å®¹å™¨</li>
<li>å¹¶è¡Œæµå¦‚æœç”¨çš„æ˜¯å¹¶å‘å®¹å™¨ï¼Œä¹Ÿä¸éœ€è¦åˆå¹¶</li>
</ul>
</li>
</ul>
<h2 id="3-16-æ”¶é›†å™¨"><a href="#3-16-æ”¶é›†å™¨" class="headerlink" title="3.16 æ”¶é›†å™¨"></a>3.16 æ”¶é›†å™¨</h2><p>é€šè¿‡ä¸Šé¢çš„æ”¶é›†å¯ä»¥çœ‹å‡ºï¼Œä¸ç®¡æ”¶é›†å®¹å™¨çš„ç§ç±»æœ‰å¤šå°‘ç§ï¼Œåœ¨æ”¶é›†æ—¶éƒ½éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œå¯ä»¥å°†è¿™ä¸‰ä¸ªå‚æ•°ç”¨ä¸€ä¸ªæ•´ä½“æ¥è¡¨ç¤ºï¼Œè¿™ä¸ªæ•´ä½“å°±å«<code>Collectoræ”¶é›†å™¨</code>ã€‚JDKç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ”¶é›†å™¨å·¥å…·ç±»<code>Collectors</code>ï¼Œå·¥å…·ç±»ä¸­çš„é™æ€æ–¹æ³•å°±æ˜¯ç”¨æ¥åˆ›å»ºå„ç§ä¸åŒç±»å‹çš„æ”¶é›†å™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">.collect(Collectors.toList());	<span class="comment">//æ”¶é›†åˆ° List é›†åˆä¸­</span></span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼ï¼ŒCollectors ç±»ä¸­è¿˜æä¾›äº†å¾ˆå¤šç°æˆçš„æ”¶é›†å™¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Collectors.toSet()	<span class="comment">//æ”¶é›†åˆ° Set</span></span><br><span class="line">Collectors.joining()	<span class="comment">//æ”¶é›†åˆ° StringBuilder</span></span><br><span class="line">Collectors.joining(<span class="string">&quot;,&quot;</span>)	<span class="comment">//æ”¶é›†åˆ° StringJoiner</span></span><br><span class="line">Collectors.toMap(x -&gt; x, x -&gt; <span class="number">1</span>)	<span class="comment">//æ”¶é›†åˆ° Map</span></span><br></pre></td></tr></table></figure>

<h2 id="3-17-ä¸‹æ¸¸æ”¶é›†å™¨"><a href="#3-17-ä¸‹æ¸¸æ”¶é›†å™¨" class="headerlink" title="3.17 ä¸‹æ¸¸æ”¶é›†å™¨"></a>3.17 ä¸‹æ¸¸æ”¶é›†å™¨</h2><p>åš <code>groupingBy</code> åˆ†ç»„æ”¶é›†æ—¶ï¼Œç»„å†…å¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„æ•°æ®æ”¶é›†ï¼Œç§°ä¸ºä¸‹æ¸¸æ”¶é›†å™¨ã€‚</p>
<p>ä¸€äº›ä¸“é—¨å’Œ groupingBy  é…åˆä½¿ç”¨çš„ä¸‹æ¸¸å¤„ç†å™¨ï¼š</p>
<table>
<thead>
<tr>
<th align="center">ä¸‹æ¸¸æ”¶é›†å™¨</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">mapping(x-&gt;y, dc)</td>
<td align="center">å°† x è½¬æ¢ä¸º y ï¼Œç”¨ä¸‹æ¸¸æ”¶é›†å™¨ dc æ”¶é›†</td>
</tr>
<tr>
<td align="center">flatMapping(x-&gt;substream, dc)</td>
<td align="center">å°† x è½¬æ¢ä¸º substream ï¼Œç”¨ä¸‹æ¸¸æ”¶é›†å™¨ dc æ”¶é›†</td>
</tr>
<tr>
<td align="center">filtering(x-&gt;boolean, dc)</td>
<td align="center">è¿‡æ»¤åï¼Œç”¨ä¸‹æ¸¸æ”¶é›†å™¨ dc æ”¶é›†</td>
</tr>
<tr>
<td align="center">counting()</td>
<td align="center">æ±‚ä¸ªæ•°</td>
</tr>
<tr>
<td align="center">minBy((a,b)-&gt;int)</td>
<td align="center">æ±‚æœ€å°</td>
</tr>
<tr>
<td align="center">maxBy((a,b)-&gt;int)</td>
<td align="center">æ±‚æœ€å¤§</td>
</tr>
<tr>
<td align="center">summingInt(x-&gt;int)</td>
<td align="center">è½¬ int åæ±‚å’Œ</td>
</tr>
<tr>
<td align="center">averagingDouble(x-&gt;double)</td>
<td align="center">è½¬ double åæ±‚å¹³å‡</td>
</tr>
<tr>
<td align="center">reducing(init,(p,x)-&gt;r)</td>
<td align="center">init åˆå§‹å€¼ï¼Œç”¨ä¸Šæ¬¡ç»“æœ p å’Œå½“å‰å…ƒç´  x ç”Ÿæˆæœ¬æ¬¡ç»“æœ r</td>
</tr>
</tbody></table>
<p><font color="red"><strong>PSï¼šè°ƒç”¨é™æ€æ–¹æ³•å¯ä»¥ä½¿ç”¨ <code>import static</code> è¯­æ³•çœç•¥ç±»å</strong></font></p>
<p>æœªçœç•¥ <code>Collectors</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">stream.collect(Collectors.groupingBy(h -&gt; h.name().length(), Collectors.mapping(h -&gt; h.strength(), Collectors.toList())));</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>import static</code> è¯­æ³•çœç•¥ <code>Collectors</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.groupingBy;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.mapping;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.toList;</span><br><span class="line"><span class="comment">//æˆ–è€…ä½¿ç”¨é€šé…ç¬¦ä¸€æ¬¡æ€§å¯¼å…¥</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.*;</span><br><span class="line"></span><br><span class="line">stream.collect(groupingBy(h -&gt; h.name().length(), mapping(h -&gt; h.strength(), toList())));</span><br></pre></td></tr></table></figure>

<h2 id="3-18-åŸºæœ¬æµ"><a href="#3-18-åŸºæœ¬æµ" class="headerlink" title="3.18 åŸºæœ¬æµ"></a>3.18 åŸºæœ¬æµ</h2><p>åŸºæœ¬ç±»å‹æµæŒ‡ IntStreamã€LongStream å’Œ DoubleStreamï¼Œå®ƒä»¬åœ¨åšæ•°å€¼è®¡ç®—æ—¶æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<p>è½¬æ¢æˆåŸºæœ¬æµï¼š</p>
<ul>
<li>mapToInt</li>
<li>mapToLong</li>
<li>mapToDouble</li>
<li>flatMapToInt</li>
<li>flatMapToLong</li>
<li>flatMapToDouble</li>
<li>mapMultiToInt</li>
<li>mapMultiToLong</li>
<li>mapMultiToDouble</li>
</ul>
<p>åŸºæœ¬æµè½¬å¯¹è±¡æµï¼š</p>
<ul>
<li>mapToObj</li>
<li>boxed</li>
</ul>
<h2 id="3-19-å¹¶è¡Œ"><a href="#3-19-å¹¶è¡Œ" class="headerlink" title="3.19 å¹¶è¡Œ"></a>3.19 å¹¶è¡Œ</h2><p>åœ¨ Java ä¸­ï¼Œ<strong>ä¸²è¡Œæµ</strong>å’Œ<strong>å¹¶è¡Œæµ</strong>æ˜¯é’ˆå¯¹æµæ“ä½œçš„ä¸¤ç§ä¸åŒå¤„ç†æ–¹å¼ï¼š</p>
<p>ä¸²è¡Œæµï¼ˆSequential Streamï¼‰ï¼š</p>
<ul>
<li>ä¸²è¡Œæµæ˜¯æµå…ƒç´ æŒ‰é¡ºåºä¾æ¬¡å¤„ç†çš„æµã€‚</li>
<li>åœ¨ä¸²è¡Œæµä¸­ï¼Œæ“ä½œæ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œæ¯ä¸ªå…ƒç´ ä¾æ¬¡ç»è¿‡æµæ°´çº¿ä¸Šçš„å„ä¸ªé˜¶æ®µå¤„ç†ã€‚</li>
<li>é€‚ç”¨äºç®€å•çš„æ•°æ®å¤„ç†åœºæ™¯ï¼Œæ•°æ®é‡ä¸å¤§ä¸”å¤„ç†æ—¶é—´çŸ­çš„æƒ…å†µä¸‹ã€‚</li>
</ul>
<p>å¹¶è¡Œæµï¼ˆParallel Streamï¼‰ï¼š</p>
<ul>
<li>å¹¶è¡Œæµæ˜¯æµå…ƒç´ å¹¶è¡Œå¤„ç†çš„æµã€‚</li>
<li>åœ¨å¹¶è¡Œæµä¸­ï¼Œæ“ä½œä¼šå¹¶å‘æ‰§è¡Œï¼Œæµä¼šè¢«æ‹†åˆ†ä¸ºå¤šä¸ªå­ä»»åŠ¡ï¼Œè¿™äº›å­ä»»åŠ¡å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸ŠåŒæ—¶å¤„ç†ã€‚</li>
<li>é€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®å¤„ç†ã€å¤æ‚è®¡ç®—æˆ–éœ€è¦å¹¶è¡Œå¤„ç†çš„åœºæ™¯ã€‚</li>
</ul>
<p>å¹¶è¡Œæµä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">    .parallel()</span><br><span class="line">    .collect(Collector.of(</span><br><span class="line">            () -&gt; &#123;</span><br><span class="line">                System.out.printf(<span class="string">&quot;%-12s %s%n&quot;</span>,simple(),<span class="string">&quot;create&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line">            &#125;,</span><br><span class="line">            (list, x) -&gt; &#123;</span><br><span class="line">                List&lt;Integer&gt; old = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(list);</span><br><span class="line">                list.add(x);</span><br><span class="line">                System.out.printf(<span class="string">&quot;%-12s %s.add(%d)=&gt;%s%n&quot;</span>,simple(), old, x, list);</span><br><span class="line">            &#125;,</span><br><span class="line">            (list1, list2) -&gt; &#123;</span><br><span class="line">                List&lt;Integer&gt; old = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(list1);</span><br><span class="line">                list1.addAll(list2);</span><br><span class="line">                System.out.printf(<span class="string">&quot;%-12s %s.add(%s)=&gt;%s%n&quot;</span>, simple(),old, list2, list1);</span><br><span class="line">                <span class="keyword">return</span> list1;</span><br><span class="line">            &#125;,</span><br><span class="line">            list -&gt; list,</span><br><span class="line">            Collector.Characteristics.IDENTITY_FINISH</span><br><span class="line">    ));</span><br></pre></td></tr></table></figure>

<h2 id="3-20-æ•ˆç‡"><a href="#3-20-æ•ˆç‡" class="headerlink" title="3.20 æ•ˆç‡"></a>3.20 æ•ˆç‡</h2><blockquote>
<p>æ•°ç»„æ±‚å’Œ</p>
</blockquote>
<p>å…¶ä¸­</p>
<ul>
<li>primitive ç”¨ loop å¾ªç¯å¯¹ int æ±‚å’Œ</li>
<li>intStream ç”¨ IntStream å¯¹ int æ±‚å’Œ</li>
<li>boxed ç”¨ loop å¾ªç¯å¯¹ Integer æ±‚å’Œ</li>
<li>stream ç”¨ Stream å¯¹ Integer æ±‚å’Œ</li>
</ul>
<p>å…ƒç´ ä¸ªæ•° 100</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T01Sum.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">25.424</td>
<td align="center">Â± 0.782</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.intStream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">47.482</td>
<td align="center">Â± 1.145</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.boxed</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">72.457</td>
<td align="center">Â± 4.136</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.stream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">465.141</td>
<td align="center">Â± 4.891</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 1000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T01Sum.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">270.556</td>
<td align="center">Â± 1.277</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.intStream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">292.467</td>
<td align="center">Â± 10.987</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.boxed</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">583.929</td>
<td align="center">Â± 57.338</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.stream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">5948.294</td>
<td align="center">Â± 2209.211</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 10000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T01Sum.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">2681.651</td>
<td align="center">Â± 12.614</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.intStream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">2718.408</td>
<td align="center">Â± 52.418</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.boxed</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">6391.285</td>
<td align="center">Â± 358.154</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T01Sum.stream</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">44414.884</td>
<td align="center">Â± 3213.055</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>ç»“è®ºï¼š</p>
<ul>
<li>åšæ•°å€¼è®¡ç®—ï¼Œä¼˜å…ˆæŒ‘é€‰åŸºæœ¬æµï¼ˆIntStream ç­‰ï¼‰åœ¨æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œå®ƒçš„æ€§èƒ½å·²ç»éå¸¸æ¥è¿‘æ™®é€š for å¾ªç¯</li>
<li>åšæ•°å€¼è®¡ç®—ï¼Œåº”å½“é¿å…æ™®é€šæµï¼ˆStreamï¼‰æ€§èƒ½ä¸å…¶å®ƒå‡ ç§ç›¸æ¯”ï¼Œæ…¢ä¸€ä¸ªæ•°é‡çº§</li>
</ul>
<blockquote>
<p>æ±‚æœ€å¤§å€¼</p>
</blockquote>
<p>å…¶ä¸­ï¼ˆåŸå§‹æ•°æ®éƒ½æ˜¯ intï¼Œæ²¡æœ‰åŒ…è£…ç±»ï¼‰</p>
<ul>
<li>custom è‡ªå®šä¹‰å¤šçº¿ç¨‹å¹¶è¡Œæ±‚æœ€å¤§å€¼</li>
<li>parallel å¹¶è¡Œæµæ±‚æœ€å¤§å€¼</li>
<li>sequence ä¸²è¡Œæµæ±‚æœ€å¤§å€¼</li>
<li>primitive loop å¾ªç¯æ±‚æœ€å¤§å€¼</li>
</ul>
<p>å…ƒç´ ä¸ªæ•° 100</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T02Parallel.custom</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">39619.796</td>
<td align="center">Â± 1263.036</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.parallel</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">6754.239</td>
<td align="center">Â± 79.894</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">29.538</td>
<td align="center">Â± 3.056</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">80.170</td>
<td align="center">Â± 1.940</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 10000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T02Parallel.custom</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">41656.093</td>
<td align="center">Â± 1537.237</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.parallel</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">11218.573</td>
<td align="center">Â± 1994.863</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">2217.562</td>
<td align="center">Â± 80.981</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">5682.482</td>
<td align="center">Â± 264.645</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 1000000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">T02Parallel.custom</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">194984.564</td>
<td align="center">Â± 25794.484</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.parallel</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">298940.794</td>
<td align="center">Â± 31944.959</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.primitive</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">325178.873</td>
<td align="center">Â± 81314.981</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">T02Parallel.sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">618274.062</td>
<td align="center">Â± 5867.812</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>ç»“è®ºï¼š</p>
<ul>
<li>å¹¶è¡Œæµç›¸å¯¹è‡ªå·±ç”¨å¤šçº¿ç¨‹å®ç°åˆ†è€Œæ²»ä¹‹æ›´ç®€æ´</li>
<li>å¹¶è¡Œæµåªæœ‰åœ¨æ•°æ®é‡éå¸¸å¤§æ—¶ï¼Œæ‰èƒ½å……åˆ†å‘åŠ›ï¼Œæ•°æ®é‡å°‘ï¼Œè¿˜ä¸å¦‚ç”¨ä¸²è¡Œæµ</li>
</ul>
<blockquote>
<p>å¹¶è¡Œ(å‘)æ”¶é›†</p>
</blockquote>
<p>å…ƒç´ ä¸ªæ•° 100</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">loop1</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">1312.389</td>
<td align="center">Â±  90.683</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">loop2</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">1776.391</td>
<td align="center">Â± 255.271</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">1727.739</td>
<td align="center">Â±  28.821</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelNoConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">27654.004</td>
<td align="center">Â± 496.970</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">16320.113</td>
<td align="center">Â± 344.766</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 10000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ns&#x2F;op)</th>
<th align="center">Error (ns&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">loop1</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">211526.546</td>
<td align="center">Â± 13549.703</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">loop2</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">203794.146</td>
<td align="center">Â± 3525.972</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">237688.651</td>
<td align="center">Â±  7593.483</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelNoConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">527203.976</td>
<td align="center">Â±  3496.107</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">369630.728</td>
<td align="center">Â± 20549.731</td>
<td align="center">ns&#x2F;op</td>
</tr>
</tbody></table>
<p>å…ƒç´ ä¸ªæ•° 1000000</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score (ms&#x2F;op)</th>
<th align="center">Error (ms&#x2F;op)</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">loop1</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">69.154</td>
<td align="center">Â± 3.456</td>
<td align="center">ms&#x2F;op</td>
</tr>
<tr>
<td align="center">loop2</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">83.815</td>
<td align="center">Â± 2.307</td>
<td align="center">ms&#x2F;op</td>
</tr>
<tr>
<td align="center">sequence</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">103.585</td>
<td align="center">Â± 0.834</td>
<td align="center">ns&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelNoConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">167.032</td>
<td align="center">Â± 15.406</td>
<td align="center">ms&#x2F;op</td>
</tr>
<tr>
<td align="center">parallelConcurrent</td>
<td align="center">avgt</td>
<td align="center">5</td>
<td align="center">52.326</td>
<td align="center">Â± 1.501</td>
<td align="center">ms&#x2F;op</td>
</tr>
</tbody></table>
<p>ç»“è®ºï¼š</p>
<ul>
<li>sequence æ˜¯ä¸€ä¸ªå®¹å™¨å•çº¿ç¨‹æ”¶é›†ï¼Œæ•°æ®é‡å°‘æ—¶æ€§èƒ½å ä¼˜</li>
<li>parallelNoConcurrent æ˜¯å¤šä¸ªå®¹å™¨å¤šçº¿ç¨‹å¹¶è¡Œæ”¶é›†ï¼Œæ—¶é—´åº”è¯¥èŠ±è´¹åœ¨åˆå¹¶å®¹å™¨ä¸Šï¼Œæ€§èƒ½æœ€å·®</li>
<li>parallelConcurrent æ˜¯ä¸€ä¸ªå®¹å™¨å¤šçº¿ç¨‹å¹¶å‘æ”¶é›†ï¼Œåœ¨æ•°æ®é‡å¤§æ—¶æ€§èƒ½è¾ƒä¼˜</li>
</ul>
<blockquote>
<p>MethodHandle æ€§èƒ½</p>
</blockquote>
<p>æ­£å¸¸æ–¹æ³•è°ƒç”¨ã€åå°„ã€MethodHandleã€Lambda çš„æ€§èƒ½å¯¹æ¯”</p>
<table>
<thead>
<tr>
<th align="center">Benchmark</th>
<th align="center">Mode</th>
<th align="center">Cnt</th>
<th align="center">Score</th>
<th align="center">Error</th>
<th align="center">Units</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Sample2.lambda</td>
<td align="center">thrpt</td>
<td align="center">5</td>
<td align="center">389307532.881</td>
<td align="center">Â± 332213073.039</td>
<td align="center">ops&#x2F;s</td>
</tr>
<tr>
<td align="center">Sample2.method</td>
<td align="center">thrpt</td>
<td align="center">5</td>
<td align="center">157556577.611</td>
<td align="center">Â± 4048306.620</td>
<td align="center">ops&#x2F;s</td>
</tr>
<tr>
<td align="center">Sample2.origin</td>
<td align="center">thrpt</td>
<td align="center">5</td>
<td align="center">413287866.949</td>
<td align="center">Â± 65182730.966</td>
<td align="center">ops&#x2F;s</td>
</tr>
<tr>
<td align="center">Sample2.reflection</td>
<td align="center">thrpt</td>
<td align="center">5</td>
<td align="center">91640751.456</td>
<td align="center">Â± 37969233.369</td>
<td align="center">ops&#x2F;s</td>
</tr>
</tbody></table>
<h1 id="4-å®é™…åº”ç”¨"><a href="#4-å®é™…åº”ç”¨" class="headerlink" title="4. å®é™…åº”ç”¨"></a>4. å®é™…åº”ç”¨</h1><h2 id="4-1-æ•°æ®ç»Ÿè®¡åˆ†æ"><a href="#4-1-æ•°æ®ç»Ÿè®¡åˆ†æ" class="headerlink" title="4.1 æ•°æ®ç»Ÿè®¡åˆ†æ"></a>4.1 æ•°æ®ç»Ÿè®¡åˆ†æ</h2><blockquote>
<p>æ¯æœˆçš„é”€å”®é‡</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1970-01 è®¢å•æ•°1307</span><br><span class="line">2020-01 è®¢å•æ•°14270</span><br><span class="line">2020-02 è®¢å•æ•°17995</span><br><span class="line">2020-03 è®¢å•æ•°18688</span><br><span class="line">2020-04 è®¢å•æ•°11868</span><br><span class="line">2020-05 è®¢å•æ•°40334</span><br><span class="line">2020-06 è®¢å•æ•°41364</span><br><span class="line">2020-07 è®¢å•æ•°76418</span><br><span class="line">2020-08 è®¢å•æ•°100007</span><br><span class="line">2020-09 è®¢å•æ•°70484</span><br><span class="line">2020-10 è®¢å•æ•°104063</span><br><span class="line">2020-11 è®¢å•æ•°66060</span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶ä¸­ 1970-01 åº”è¯¥æ˜¯æ•°æ®çš„é—®é¢˜</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; YearMonth.from(formatter.parse(a[TIME])), </span><br><span class="line">                        TreeMap::<span class="keyword">new</span>, counting()))</span><br><span class="line">    .forEach((k, v) -&gt; &#123;</span><br><span class="line">        System.out.println(k + <span class="string">&quot; è®¢å•æ•° &quot;</span> + v);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é”€é‡æœ€é«˜çš„æœˆä»½</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1970-01 è®¢å•æ•°1307</span><br><span class="line">2020-01 è®¢å•æ•°14270</span><br><span class="line">2020-02 è®¢å•æ•°17995</span><br><span class="line">2020-03 è®¢å•æ•°18688</span><br><span class="line">2020-04 è®¢å•æ•°11868</span><br><span class="line">2020-05 è®¢å•æ•°40334</span><br><span class="line">2020-06 è®¢å•æ•°41364</span><br><span class="line">2020-07 è®¢å•æ•°76418</span><br><span class="line">2020-08 è®¢å•æ•°100007</span><br><span class="line">2020-09 è®¢å•æ•°70484</span><br><span class="line">2020-10 è®¢å•æ•°104063  *</span><br><span class="line">2020-11 è®¢å•æ•°66060</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; YearMonth.from(formatter.parse(a[TIME])), counting()))</span><br><span class="line">    .entrySet()</span><br><span class="line">    .stream()</span><br><span class="line">    .max(Comparator.comparingLong(Map.Entry::getValue))</span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ç”¨ Map.Entry.comparingByValue()</span></span><br><span class="line">    .orElse(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ±‚é”€é‡æœ€é«˜çš„å•†å“</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1515966223517846928=2746</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; a[PRODUCT_ID], counting()))</span><br><span class="line">    .entrySet()</span><br><span class="line">    .stream()</span><br><span class="line">    .max(Comparator.comparingLong(Map.Entry::getValue))</span><br><span class="line">    .orElse(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸‹å•æœ€å¤šçš„å‰10ç”¨æˆ·</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.515915625512423e+18 è®¢å•æ•°1092</span><br><span class="line">1.5159156255121183e+18 è®¢å•æ•°1073</span><br><span class="line">1.515915625512378e+18 è®¢å•æ•°1040</span><br><span class="line">1.515915625512377e+18 è®¢å•æ•°1028</span><br><span class="line">1.5159156255136955e+18 è®¢å•æ•°1002</span><br><span class="line">1.515915625512422e+18 è®¢å•æ•°957</span><br><span class="line">1.515915625513446e+18 è®¢å•æ•°957</span><br><span class="line">1.515915625513447e+18 è®¢å•æ•°928</span><br><span class="line">1.515915625514598e+18 è®¢å•æ•°885</span><br><span class="line">1.5159156255147195e+18 è®¢å•æ•°869</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; a[USER_ID], counting()))</span><br><span class="line">    .entrySet()</span><br><span class="line">    .stream()</span><br><span class="line">    .sorted(Map.Entry.&lt;String, Long&gt;comparingByValue().reversed())</span><br><span class="line">    .limit(<span class="number">10</span>).forEach(e -&gt; &#123;</span><br><span class="line">        System.out.println(e.getKey() + <span class="string">&quot; è®¢å•æ•° &quot;</span> + e.getValue());</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyQueue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">PriorityQueue</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> max;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyQueue</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> E&gt; comparator, <span class="type">int</span> max)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(comparator);</span><br><span class="line">        <span class="built_in">this</span>.max = max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">offer</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r</span> <span class="operator">=</span> <span class="built_in">super</span>.offer(e);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.size() &gt; max) &#123;</span><br><span class="line">            <span class="built_in">this</span>.poll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; a[USER_ID], counting()))</span><br><span class="line">    .entrySet()</span><br><span class="line">    .stream()</span><br><span class="line">    .parallel()</span><br><span class="line">    .collect(</span><br><span class="line">            () -&gt; <span class="keyword">new</span> <span class="title class_">MyQueue</span>&lt;&gt;(Map.Entry.comparingByValue(), <span class="number">10</span>),</span><br><span class="line">            MyQueue::offer,</span><br><span class="line">            AbstractQueue::addAll</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¯ä¸ªåœ°åŒºä¸‹å•æœ€å¤šçš„ç”¨æˆ·</p>
</blockquote>
<p>ç»“æœåº”ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸Šæµ·=Optional[1.5159156255127636e+18=634]</span><br><span class="line">å¹¿ä¸œ=Optional[1.515915625512377e+18=1028]</span><br><span class="line">å¤©æ´¥=Optional[1.5159156255120858e+18=530]</span><br><span class="line">å››å·=Optional[1.5159156255121551e+18=572]</span><br><span class="line">æµ™æ±Ÿ=Optional[1.5159156255121183e+18=564]</span><br><span class="line">é‡åº†=Optional[1.515915625512764e+18=632]</span><br><span class="line">æ¹–åŒ—=Optional[1.5159156255121183e+18=509]</span><br><span class="line">æ¹–å—=Optional[1.5159156255120548e+18=545]</span><br><span class="line">æ±Ÿè‹=Optional[1.5159156255122386e+18=551]</span><br><span class="line">æµ·å—=Optional[1.5159156255121178e+18=556]</span><br><span class="line">åŒ—äº¬=Optional[1.5159156255128172e+18=584]</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(line -&gt; line.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(array -&gt; array[USER_REGION], </span><br><span class="line">                        groupingBy(array -&gt; array[USER_ID], counting())))</span><br><span class="line">    .entrySet().stream()</span><br><span class="line">    .map(e -&gt; Map.entry(</span><br><span class="line">            e.getKey(),</span><br><span class="line">            e.getValue().entrySet().stream().max(Map.Entry.comparingByValue())</span><br><span class="line">    ))</span><br><span class="line">    .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¯ä¸ªåœ°åŒºä¸‹å•æœ€å¤šçš„å‰3ç”¨æˆ·</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸Šæµ·</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255127636e+18=634</span><br><span class="line">1.515915625512118e+18=583</span><br><span class="line">1.515915625512422e+18=561</span><br><span class="line">å¹¿ä¸œ</span><br><span class="line">--------------------------</span><br><span class="line">1.515915625512377e+18=1028</span><br><span class="line">1.5159156255121544e+18=572</span><br><span class="line">1.5159156255120845e+18=571</span><br><span class="line">å¤©æ´¥</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255120858e+18=530</span><br><span class="line">1.5159156255122383e+18=504</span><br><span class="line">1.5159156255123333e+18=481</span><br><span class="line">å››å·</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255121551e+18=572</span><br><span class="line">1.5159156255123768e+18=568</span><br><span class="line">1.515915625512055e+18=552</span><br><span class="line">æµ™æ±Ÿ</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255121183e+18=564</span><br><span class="line">1.515915625513058e+18=520</span><br><span class="line">1.515915625512423e+18=513</span><br><span class="line">é‡åº†</span><br><span class="line">--------------------------</span><br><span class="line">1.515915625512764e+18=632</span><br><span class="line">1.5159156255121188e+18=572</span><br><span class="line">1.515915625512085e+18=562</span><br><span class="line">æ¹–åŒ—</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255121183e+18=509</span><br><span class="line">1.515915625512818e+18=508</span><br><span class="line">1.5159156255148017e+18=386</span><br><span class="line">æ¹–å—</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255120548e+18=545</span><br><span class="line">1.5159156255120855e+18=543</span><br><span class="line">1.5159156255134449e+18=511</span><br><span class="line">æ±Ÿè‹</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255122386e+18=551</span><br><span class="line">1.5159156255122842e+18=541</span><br><span class="line">1.5159156255120842e+18=499</span><br><span class="line">æµ·å—</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255121178e+18=556</span><br><span class="line">1.5159156255128174e+18=547</span><br><span class="line">1.5159156255122022e+18=545</span><br><span class="line">åŒ—äº¬</span><br><span class="line">--------------------------</span><br><span class="line">1.5159156255128172e+18=584</span><br><span class="line">1.515915625512423e+18=579</span><br><span class="line">1.5159156255123786e+18=558</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .collect(groupingBy(a -&gt; a[USER_REGION], groupingBy(a -&gt; a[USER_ID], counting())))</span><br><span class="line">    <span class="comment">/*.forEach((k,v)-&gt;&#123;</span></span><br><span class="line"><span class="comment">        System.out.println(k);</span></span><br><span class="line"><span class="comment">        System.out.println(&quot;---------------&quot;);</span></span><br><span class="line"><span class="comment">        v.forEach((x,y)-&gt;&#123;</span></span><br><span class="line"><span class="comment">            System.out.println(x + &quot;:&quot; + y);</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">    &#125;);*/</span></span><br><span class="line">    .entrySet()</span><br><span class="line">    .stream()</span><br><span class="line">    .map(e -&gt;</span><br><span class="line">        Map.entry(</span><br><span class="line">            e.getKey(),</span><br><span class="line">            e.getValue().entrySet().stream()</span><br><span class="line">                .sorted(Map.Entry.&lt;String, Long&gt;comparingByValue().reversed())</span><br><span class="line">            	.limit(<span class="number">3</span>)</span><br><span class="line">            	.toList()</span><br><span class="line">        )</span><br><span class="line">    ).forEach(e -&gt; &#123;</span><br><span class="line">        System.out.println(e.getKey());</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------------&quot;</span>);</span><br><span class="line">        e.getValue().forEach(System.out::println);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŒ‰ç±»åˆ«ç»Ÿè®¡é”€é‡</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">accessories.bag è®¢å•æ•° 3063</span><br><span class="line">accessories.umbrella è®¢å•æ•° 33</span><br><span class="line">apparel.costume è®¢å•æ•° 2</span><br><span class="line">apparel.glove è®¢å•æ•° 1942</span><br><span class="line">apparel.shirt è®¢å•æ•° 235</span><br><span class="line">apparel.shoes è®¢å•æ•° 2</span><br><span class="line">apparel.sock è®¢å•æ•° 21</span><br><span class="line">apparel.trousers è®¢å•æ•° 99</span><br><span class="line">apparel.tshirt è®¢å•æ•° 372</span><br><span class="line">appliances.environment.air_conditioner è®¢å•æ•° 7379</span><br><span class="line">appliances.environment.air_heater è®¢å•æ•° 2599</span><br><span class="line">appliances.environment.climate è®¢å•æ•° 101</span><br><span class="line">appliances.environment.fan è®¢å•æ•° 3855</span><br><span class="line">appliances.environment.vacuum è®¢å•æ•° 15971</span><br><span class="line">appliances.environment.water_heater è®¢å•æ•° 3644</span><br><span class="line">appliances.iron è®¢å•æ•° 8249</span><br><span class="line">appliances.ironing_board è®¢å•æ•° 2128</span><br><span class="line">appliances.kitchen.blender è®¢å•æ•° 8672</span><br><span class="line">appliances.kitchen.coffee_grinder è®¢å•æ•° 811</span><br><span class="line">appliances.kitchen.coffee_machine è®¢å•æ•° 1250</span><br><span class="line">appliances.kitchen.dishwasher è®¢å•æ•° 2663</span><br><span class="line">appliances.kitchen.fryer è®¢å•æ•° 97</span><br><span class="line">appliances.kitchen.grill è®¢å•æ•° 1579</span><br><span class="line">appliances.kitchen.hood è®¢å•æ•° 9045</span><br><span class="line">appliances.kitchen.juicer è®¢å•æ•° 1187</span><br><span class="line">appliances.kitchen.kettle è®¢å•æ•° 12740</span><br><span class="line">appliances.kitchen.meat_grinder è®¢å•æ•° 4520</span><br><span class="line">appliances.kitchen.microwave è®¢å•æ•° 7615</span><br><span class="line">appliances.kitchen.mixer è®¢å•æ•° 2610</span><br><span class="line">appliances.kitchen.oven è®¢å•æ•° 4000</span><br><span class="line">appliances.kitchen.refrigerators è®¢å•æ•° 20259</span><br><span class="line">appliances.kitchen.steam_cooker è®¢å•æ•° 464</span><br><span class="line">appliances.kitchen.toster è®¢å•æ•° 1381</span><br><span class="line">appliances.kitchen.washer è®¢å•æ•° 14563</span><br><span class="line">appliances.personal.hair_cutter è®¢å•æ•° 2716</span><br><span class="line">appliances.personal.massager è®¢å•æ•° 1724</span><br><span class="line">appliances.personal.scales è®¢å•æ•° 6727</span><br><span class="line">appliances.sewing_machine è®¢å•æ•° 1576</span><br><span class="line">appliances.steam_cleaner è®¢å•æ•° 119</span><br><span class="line">auto.accessories.alarm è®¢å•æ•° 252</span><br><span class="line">auto.accessories.anti_freeze è®¢å•æ•° 109</span><br><span class="line">auto.accessories.compressor è®¢å•æ•° 276</span><br><span class="line">auto.accessories.player è®¢å•æ•° 117</span><br><span class="line">auto.accessories.radar è®¢å•æ•° 80</span><br><span class="line">auto.accessories.videoregister è®¢å•æ•° 533</span><br><span class="line">computers.components.cdrw è®¢å•æ•° 158</span><br><span class="line">computers.components.cooler è®¢å•æ•° 3377</span><br><span class="line">computers.components.cpu è®¢å•æ•° 4147</span><br><span class="line">computers.components.hdd è®¢å•æ•° 5054</span><br><span class="line">computers.components.memory è®¢å•æ•° 1597</span><br><span class="line">computers.components.motherboard è®¢å•æ•° 860</span><br><span class="line">computers.components.power_supply è®¢å•æ•° 986</span><br><span class="line">computers.components.sound_card è®¢å•æ•° 26</span><br><span class="line">computers.components.videocards è®¢å•æ•° 1190</span><br><span class="line">computers.desktop è®¢å•æ•° 1041</span><br><span class="line">computers.ebooks è®¢å•æ•° 397</span><br><span class="line">computers.gaming è®¢å•æ•° 164</span><br><span class="line">computers.network.router è®¢å•æ•° 6473</span><br><span class="line">computers.notebook è®¢å•æ•° 25866</span><br><span class="line">computers.peripherals.camera è®¢å•æ•° 1041</span><br><span class="line">computers.peripherals.joystick è®¢å•æ•° 1192</span><br><span class="line">computers.peripherals.keyboard è®¢å•æ•° 3803</span><br><span class="line">computers.peripherals.monitor è®¢å•æ•° 3272</span><br><span class="line">computers.peripherals.mouse è®¢å•æ•° 12664</span><br><span class="line">computers.peripherals.printer è®¢å•æ•° 3458</span><br><span class="line">computers.peripherals.scanner è®¢å•æ•° 74</span><br><span class="line">construction.components.faucet è®¢å•æ•° 133</span><br><span class="line">construction.tools.drill è®¢å•æ•° 622</span><br><span class="line">construction.tools.generator è®¢å•æ•° 46</span><br><span class="line">construction.tools.heater è®¢å•æ•° 348</span><br><span class="line">construction.tools.light è®¢å•æ•° 10</span><br><span class="line">construction.tools.pump è®¢å•æ•° 65</span><br><span class="line">construction.tools.saw è®¢å•æ•° 169</span><br><span class="line">construction.tools.screw è®¢å•æ•° 2408</span><br><span class="line">construction.tools.welding è®¢å•æ•° 183</span><br><span class="line">country_yard.cultivator è®¢å•æ•° 33</span><br><span class="line">country_yard.lawn_mower è®¢å•æ•° 111</span><br><span class="line">country_yard.watering è®¢å•æ•° 5</span><br><span class="line">country_yard.weather_station è®¢å•æ•° 53</span><br><span class="line">electronics.audio.acoustic è®¢å•æ•° 438</span><br><span class="line">electronics.audio.dictaphone è®¢å•æ•° 12</span><br><span class="line">electronics.audio.headphone è®¢å•æ•° 20084</span><br><span class="line">electronics.audio.microphone è®¢å•æ•° 1062</span><br><span class="line">electronics.audio.subwoofer è®¢å•æ•° 70</span><br><span class="line">electronics.calculator è®¢å•æ•° 35</span><br><span class="line">electronics.camera.photo è®¢å•æ•° 348</span><br><span class="line">electronics.camera.video è®¢å•æ•° 133</span><br><span class="line">electronics.clocks è®¢å•æ•° 6474</span><br><span class="line">electronics.smartphone è®¢å•æ•° 102365</span><br><span class="line">electronics.tablet è®¢å•æ•° 6395</span><br><span class="line">electronics.telephone è®¢å•æ•° 2437</span><br><span class="line">electronics.video.projector è®¢å•æ•° 114</span><br><span class="line">electronics.video.tv è®¢å•æ•° 17618</span><br><span class="line">furniture.bathroom.bath è®¢å•æ•° 232</span><br><span class="line">furniture.bathroom.toilet è®¢å•æ•° 44</span><br><span class="line">furniture.bedroom.bed è®¢å•æ•° 451</span><br><span class="line">furniture.bedroom.blanket è®¢å•æ•° 68</span><br><span class="line">furniture.bedroom.pillow è®¢å•æ•° 1882</span><br><span class="line">furniture.kitchen.chair è®¢å•æ•° 3084</span><br><span class="line">furniture.kitchen.table è®¢å•æ•° 11260</span><br><span class="line">furniture.living_room.cabinet è®¢å•æ•° 3117</span><br><span class="line">furniture.living_room.chair è®¢å•æ•° 1439</span><br><span class="line">furniture.living_room.shelving è®¢å•æ•° 2572</span><br><span class="line">furniture.living_room.sofa è®¢å•æ•° 401</span><br><span class="line">furniture.universal.light è®¢å•æ•° 22</span><br><span class="line">kids.bottles è®¢å•æ•° 63</span><br><span class="line">kids.carriage è®¢å•æ•° 41</span><br><span class="line">kids.dolls è®¢å•æ•° 379</span><br><span class="line">kids.fmcg.diapers è®¢å•æ•° 11</span><br><span class="line">kids.skates è®¢å•æ•° 1159</span><br><span class="line">kids.swing è®¢å•æ•° 8</span><br><span class="line">kids.toys è®¢å•æ•° 643</span><br><span class="line">medicine.tools.tonometer è®¢å•æ•° 1106</span><br><span class="line">sport.bicycle è®¢å•æ•° 569</span><br><span class="line">sport.diving è®¢å•æ•° 10</span><br><span class="line">sport.ski è®¢å•æ•° 17</span><br><span class="line">sport.snowboard è®¢å•æ•° 3</span><br><span class="line">sport.tennis è®¢å•æ•° 87</span><br><span class="line">sport.trainer è®¢å•æ•° 210</span><br><span class="line">stationery.battery è®¢å•æ•° 5210</span><br><span class="line">stationery.cartrige è®¢å•æ•° 2473</span><br><span class="line">stationery.paper è®¢å•æ•° 1085</span><br><span class="line">stationery.stapler è®¢å•æ•° 97</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">       .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">       .filter(a -&gt; !a[CATEGORY_CODE].isEmpty())</span><br><span class="line">       .collect(groupingBy(a -&gt; a[CATEGORY_CODE], TreeMap::<span class="keyword">new</span>, counting()))</span><br><span class="line">       .forEach((k, v) -&gt; &#123;</span><br><span class="line">           System.out.println(k + <span class="string">&quot; è®¢å•æ•° &quot;</span> + v);</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŒ‰ä¸€çº§ç±»åˆ«ç»Ÿè®¡é”€é‡</p>
</blockquote>
<p>ç»“æœåº”ä¸º</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">accessories è®¢å•æ•° 3096</span><br><span class="line">apparel è®¢å•æ•° 2673</span><br><span class="line">appliances è®¢å•æ•° 150244</span><br><span class="line">auto è®¢å•æ•° 1367</span><br><span class="line">computers è®¢å•æ•° 76840</span><br><span class="line">construction è®¢å•æ•° 3984</span><br><span class="line">country_yard è®¢å•æ•° 202</span><br><span class="line">electronics è®¢å•æ•° 157585</span><br><span class="line">furniture è®¢å•æ•° 24572</span><br><span class="line">kids è®¢å•æ•° 2304</span><br><span class="line">medicine è®¢å•æ•° 1106</span><br><span class="line">sport è®¢å•æ•° 896</span><br><span class="line">stationery è®¢å•æ•° 8865</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(l -&gt; l.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .filter(a -&gt; !a[CATEGORY_CODE].isEmpty())</span><br><span class="line">    .collect(groupingBy(TestData::firstCategory, TreeMap::<span class="keyword">new</span>, counting()))</span><br><span class="line">    .forEach((k, v) -&gt; &#123;</span><br><span class="line">        System.out.println(k + <span class="string">&quot; è®¢å•æ•° &quot;</span> + v);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> String <span class="title function_">firstCategory</span><span class="params">(String[] a)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">category</span> <span class="operator">=</span> a[CATEGORY_CODE];</span><br><span class="line">    <span class="type">int</span> <span class="variable">dot</span> <span class="operator">=</span> category.indexOf(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> category.substring(<span class="number">0</span>, dot);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŒ‰ä»·æ ¼åŒºé—´ç»Ÿè®¡é”€é‡</p>
</blockquote>
<ul>
<li>p &lt;100</li>
<li>100&lt;&#x3D; p &lt;500</li>
<li>500&lt;&#x3D;p&lt;1000</li>
<li>1000&lt;&#x3D;p</li>
</ul>
<p>ç»“æœåº”ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[0,100)=291624</span><br><span class="line">[1000,âˆ)=14514</span><br><span class="line">[500,1000)=52857</span><br><span class="line">[100,500)=203863</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> String <span class="title function_">priceRange</span><span class="params">(Double price)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (price &lt; <span class="number">100</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[0,100)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (price &gt;= <span class="number">100</span> &amp;&amp; price &lt; <span class="number">500</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[100,500)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (price &gt;= <span class="number">500</span> &amp;&amp; price &lt; <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[500,1000)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[1000,âˆ)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(line -&gt; line.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .map(array -&gt; Double.parseDouble(array[PRICE]))</span><br><span class="line">    .collect(groupingBy(TestData::priceRange, counting()))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸åŒå¹´é¾„æ®µå¥³æ€§æ‰€ä¸‹ä¸åŒç±»åˆ«è®¢å•</p>
</blockquote>
<ul>
<li>a &lt; 18</li>
<li>18 &lt;&#x3D; a &lt; 30</li>
<li>30 &lt;&#x3D; a &lt; 50</li>
<li>50 &lt;&#x3D; a</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[0,18)       accessories      81</span><br><span class="line">[0,18)       apparel          60</span><br><span class="line">[0,18)       appliances       4326</span><br><span class="line">[0,18)       computers        1984</span><br><span class="line">...</span><br><span class="line">[18,30)      accessories      491</span><br><span class="line">[18,30)      apparel          488</span><br><span class="line">[18,30)      appliances       25240</span><br><span class="line">[18,30)      computers        13076</span><br><span class="line">...</span><br><span class="line">[30,50)      accessories      890</span><br><span class="line">[30,50)      apparel          893</span><br><span class="line">[30,50)      appliances       42755</span><br><span class="line">[30,50)      computers        21490</span><br><span class="line">...</span><br><span class="line">[50,âˆ)       accessories      41</span><br><span class="line">[50,âˆ)       apparel          41</span><br><span class="line">[50,âˆ)       appliances       2255</span><br><span class="line">[50,âˆ)       computers        1109</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> String <span class="title function_">ageRange</span><span class="params">(String[] array)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> Double.valueOf(array[USER_AGE]).intValue();</span><br><span class="line">    <span class="keyword">if</span> (age &lt; <span class="number">18</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[0,18)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (age &lt; <span class="number">30</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[18,30)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (age &lt; <span class="number">50</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[30,50)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[50,âˆ)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">lines.skip(<span class="number">1</span>)</span><br><span class="line">    .map(line -&gt; line.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    .filter(array -&gt; !array[CATEGORY_CODE].isEmpty())</span><br><span class="line">    .filter(array -&gt; array[USER_SEX].equals(<span class="string">&quot;å¥³&quot;</span>))</span><br><span class="line">    .collect(groupingBy(TestData::ageRange, </span><br><span class="line">                        groupingBy(TestData::firstCategory, TreeMap::<span class="keyword">new</span>, counting())))</span><br></pre></td></tr></table></figure>

<h2 id="4-2-å¼‚æ­¥å¤„ç†"><a href="#4-2-å¼‚æ­¥å¤„ç†" class="headerlink" title="4.2 å¼‚æ­¥å¤„ç†"></a>4.2 å¼‚æ­¥å¤„ç†</h2><p>è¦è®©ä¸€æ®µé€»è¾‘å¼‚æ­¥ï¼š</p>
<ul>
<li>éœ€è¦æœ‰ç‹¬ç«‹çº¿ç¨‹</li>
<li>é€»è¾‘éœ€è¦å°è£…è‡³å‡½æ•°å¯¹è±¡ï¼Œæ‰èƒ½è®©æ­¤é€»è¾‘ä¸æ˜¯ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨æ–°çº¿ç¨‹ä¸­çš„æœªæ¥æŸåˆ»æ‰§è¡Œ</li>
</ul>
<p>ä¾‹ 1: ä½¿ç”¨<code>ExecutorService</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> (<span class="type">ExecutorService</span> <span class="variable">service</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">2</span>)) &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;å¼€å§‹ç»Ÿè®¡&quot;</span>);</span><br><span class="line">        service.submit(() -&gt; monthlySalesReport(map-&gt;map.entrySet().forEach(e-&gt;logger.info(e.toString()))));</span><br><span class="line">        logger.info(<span class="string">&quot;æ‰§è¡Œå…¶å®ƒæ“ä½œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">monthlySalesReport</span><span class="params">(Consumer&lt;Map&lt;YearMonth, Long&gt;&gt; consumer)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> (Stream&lt;String&gt; lines = Files.lines(Path.of(<span class="string">&quot;./data.txt&quot;</span>))) &#123;</span><br><span class="line">        Map&lt;YearMonth, Long&gt; collect = lines.skip(<span class="number">1</span>)</span><br><span class="line">                .map(line -&gt; line.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">                .collect(groupingBy(array -&gt; YearMonth.from(formatter.parse(array[TIME])), TreeMap::<span class="keyword">new</span>, counting()));</span><br><span class="line">        consumer.accept(collect);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>æ˜¾å¼ä½¿ç”¨äº†çº¿ç¨‹æ± </li>
<li>å‡½æ•°å¯¹è±¡åµŒå¥—ä½¿ç”¨ï¼Œå¯è¯»æ€§å·®</li>
</ul>
<p>ä¾‹ 2: ä½¿ç”¨<code>CompletableFuture</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;å¼€å§‹ç»Ÿè®¡&quot;</span>);</span><br><span class="line">    CompletableFuture</span><br><span class="line">        	.supplyAsync(() -&gt; monthlySalesReport())</span><br><span class="line">            .thenAccept(map -&gt; map.entrySet().forEach(e -&gt; logger.info(e.toString())));</span><br><span class="line">    logger.info(<span class="string">&quot;æ‰§è¡Œå…¶å®ƒæ“ä½œ&quot;</span>);</span><br><span class="line">    Thread.sleep(<span class="number">10000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;YearMonth, Long&gt; <span class="title function_">monthlySalesReport</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> (Stream&lt;String&gt; lines = Files.lines(Path.of(<span class="string">&quot;./data.txt&quot;</span>))) &#123;</span><br><span class="line">        Map&lt;YearMonth, Long&gt; collect = lines.skip(<span class="number">1</span>)</span><br><span class="line">                .map(line -&gt; line.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">                .collect(groupingBy(array -&gt; YearMonth.from(formatter.parse(array[TIME])), TreeMap::<span class="keyword">new</span>, counting()));</span><br><span class="line">        <span class="keyword">return</span> collect;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-æ¡†æ¶è®¾è®¡"><a href="#4-3-æ¡†æ¶è®¾è®¡" class="headerlink" title="4.3 æ¡†æ¶è®¾è®¡"></a>4.3 æ¡†æ¶è®¾è®¡</h2><ul>
<li>ä»€ä¹ˆæ˜¯æ¡†æ¶ï¼Ÿ<ul>
<li>åŠæˆå“è½¯ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ„å»ºåº”ç”¨ç¨‹åº</li>
<li>æ¡†æ¶æä¾›çš„éƒ½æ˜¯å›ºå®š<strong>ä¸å˜çš„</strong>ã€<strong>å·²çŸ¥çš„</strong>ã€å¯ä»¥é‡ç”¨çš„ä»£ç </li>
<li>è€Œé‚£äº›æ¯ä¸ªåº”ç”¨ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼Œ<strong>å˜åŒ–çš„</strong>ã€<strong>æœªçŸ¥çš„</strong>éƒ¨åˆ†ï¼Œåˆ™åœ¨æ¡†æ¶å¤–ç”±å¼€å‘è€…è‡ªå·±å®ç°</li>
</ul>
</li>
</ul>
<h3 id="4-3-1-å°†æœªçŸ¥äº¤ç»™å­ç±»"><a href="#4-3-1-å°†æœªçŸ¥äº¤ç»™å­ç±»" class="headerlink" title="4.3.1 å°†æœªçŸ¥äº¤ç»™å­ç±»"></a>4.3.1 å°†æœªçŸ¥äº¤ç»™å­ç±»</h3><p>Spring å»¶è¿Ÿåˆ›å»º bean</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">classDiagram</span><br><span class="line"></span><br><span class="line">class DefaultSingletonBeanRegistry &#123;</span><br><span class="line">   - singletonObjects: Map</span><br><span class="line">   + getSingleton(name, factory)</span><br><span class="line">&#125;</span><br><span class="line">class AbstractAutowireCapableBeanFactory &#123;</span><br><span class="line">   # createBean(name, definition, args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DefaultSingletonBeanRegistry &lt;|-- AbstractAutowireCapableBeanFactory</span><br></pre></td></tr></table></figure>

<p>Spring ä¸­çš„å¾ˆå¤šç±»æœ‰éå¸¸å¤æ‚çš„ç»§æ‰¿å…³ç³»ï¼Œå¹¶ä¸”å®ƒä»¬åˆ†å·¥æ˜ç¡®ï¼ŒèŒè´£æ˜¯åˆ’åˆ†å¥½çš„ã€‚ä¾‹å¦‚ï¼š</p>
<p><code>DefaultSingletonBeanRegistry</code> æ˜¯çˆ¶ç±»ï¼Œå®ƒæœ‰ä¸ªèŒè´£æ˜¯ç¼“å­˜å•ä¾‹ beanï¼Œç”¨ä¸‹é¢æ–¹æ³•å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">getSingleton</span><span class="params">(String beanName, ObjectFactory&lt;?&gt; factory)</span></span><br></pre></td></tr></table></figure>

<p>ä½†å¦‚ä½•åˆ›å»º <code>bean</code>ï¼Œè¿™ä¸ªçˆ¶ç±»æ˜¯ä¸çŸ¥é“çš„ï¼Œåˆ›å»º <code>bean</code> æ˜¯å­ç±» <code>AbstractAutowireCapableBeanFactory</code> çš„èŒè´£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Object <span class="title function_">createBean</span><span class="params">(String beanName, RootBeanDefinition mbd, <span class="meta">@Nullable</span> Object[] args)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çˆ¶ç±»ä¸­ <code>getSingleton</code> çš„å†…éƒ¨å°±è¦ä½¿ç”¨ <code>singletonFactory</code> å‡½æ•°å¯¹è±¡æ¥è·å¾—åˆ›å»ºå¥½çš„å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">getSingleton</span><span class="params">(String beanName, ObjectFactory&lt;?&gt; singletonFactory)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="type">Object</span> <span class="variable">singletonObject</span> <span class="operator">=</span> <span class="built_in">this</span>.singletonObjects.get(beanName);</span><br><span class="line">    <span class="keyword">if</span>(singletonObject == <span class="literal">null</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">        singletonObject = singletonFactory.getObject();</span><br><span class="line">        addSingleton(beanName, singletonObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åå­ç±»åˆ›å»ºå•ä¾‹ <code>bean</code> æ—¶ï¼Œä¼šæŠŠ <code>ObjectFactory</code> è¿™ä¸ªå‡½æ•°å¯¹è±¡ä¼ è¿›å»ï¼Œåˆ›å»ºå…¶å®ƒ <code>scope bean</code>ï¼Œä¸éœ€è¦ç”¨ <code>getSingleton</code> ç¼“å­˜</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> &lt;T&gt; T <span class="title function_">doGetBean</span><span class="params">(...)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (mbd.isSingleton()) &#123;</span><br><span class="line">        sharedInstance = getSingleton(beanName, () -&gt; &#123;</span><br><span class="line">            ...</span><br><span class="line">            <span class="keyword">return</span> createBean(beanName, mbd, args);</span><br><span class="line">        &#125;); </span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-å°†æœªçŸ¥äº¤ç»™ç”¨æˆ·"><a href="#4-3-2-å°†æœªçŸ¥äº¤ç»™ç”¨æˆ·" class="headerlink" title="4.3.2 å°†æœªçŸ¥äº¤ç»™ç”¨æˆ·"></a>4.3.2 å°†æœªçŸ¥äº¤ç»™ç”¨æˆ·</h3><blockquote>
<p>JdbcTemplate</p>
</blockquote>
<p>æ•°æ®è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line">   id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">   name <span class="type">varchar</span>(<span class="number">16</span>),</span><br><span class="line">   sex <span class="type">char</span>(<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span></span><br><span class="line">	(<span class="number">1</span>, <span class="string">&#x27;èµµä¸€ä¼¤&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">2</span>, <span class="string">&#x27;é’±äºŒè´¥&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">3</span>, <span class="string">&#x27;å­™ä¸‰æ¯&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">4</span>, <span class="string">&#x27;æå››æ‘§&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">5</span>, <span class="string">&#x27;å‘¨äº”è¾“&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">6</span>, <span class="string">&#x27;å´å…­ç ´&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">7</span>, <span class="string">&#x27;éƒ‘ä¸ƒç­&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>),</span><br><span class="line">	(<span class="number">8</span>, <span class="string">&#x27;ç‹å…«è¡°&#x27;</span>, <span class="string">&#x27;ç”·&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>spring ä¸­ JdbcTemplate ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJdbc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HikariDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariDataSource</span>();</span><br><span class="line">        dataSource.setJdbcUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">JdbcTemplate</span> <span class="variable">template</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>(dataSource);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,sex from student&quot;</span>;</span><br><span class="line">        template.query(sql, (rs, index) -&gt; &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sex</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Student</span>(id, name, sex);</span><br><span class="line">        &#125;).forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">record</span> <span class="title class_">Student</span><span class="params">(<span class="type">int</span> id, String name, String sex)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹ query æ¥è®²ï¼Œå»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œåˆ›å»º Statement å¯¹è±¡ï¼Œæ‰§è¡ŒæŸ¥è¯¢è¿™äº›æ­¥éª¤éƒ½æ˜¯å›ºå®šçš„</li>
<li>è€Œç»“æœè¦å¦‚ä½•ç”¨ java å¯¹è±¡å°è£…ï¼Œè¿™å¯¹æ¡†æ¶ä»£ç æ˜¯æœªçŸ¥çš„ï¼Œç”¨ <code>RowMapper</code> æ¥å£ä»£è¡¨ï¼Œå°†æ¥å®ƒçš„ lambda å®ç°å°†ç»“æœè½¬æ¢æˆéœ€è¦çš„ java å¯¹è±¡</li>
</ul>
<blockquote>
<p>ApplicationListener</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyEvent</span><span class="params">(Object source)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestExtend</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> </span><br><span class="line">            <span class="operator">=</span> SpringApplication.run(TestExtend.class, args);</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyEvent</span>(<span class="string">&quot;context&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ApplicationListener&lt;MyEvent&gt; <span class="title function_">myListener</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (event -&gt; System.out.println(<span class="string">&quot;æ”¶åˆ°äº‹ä»¶:&quot;</span> + event));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RestController</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        <span class="keyword">private</span> ApplicationContext context;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">            context.publishEvent(<span class="keyword">new</span> <span class="title class_">MyEvent</span>(<span class="string">&quot;controller&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹ spring æ¥è®²ï¼Œå®ƒå¹¶ä¸çŸ¥é“å¦‚ä½•å¤„ç†äº‹ä»¶</li>
<li>å› æ­¤å¯ä»¥æä¾›ä¸€ä¸ªç±»å‹ä¸º ApplicationListener çš„ lambda å¯¹è±¡</li>
</ul>
<h3 id="4-3-3-å»¶è¿Ÿæ‹¼æ¥æ¡ä»¶"><a href="#4-3-3-å»¶è¿Ÿæ‹¼æ¥æ¡ä»¶" class="headerlink" title="4.3.3 å»¶è¿Ÿæ‹¼æ¥æ¡ä»¶"></a>4.3.3 å»¶è¿Ÿæ‹¼æ¥æ¡ä»¶</h3><blockquote>
<p>MybatisPlus</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMyBatisPlus</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> </span><br><span class="line">            <span class="operator">=</span> SpringApplication.run(TestMyBatisPlus.class, args);</span><br><span class="line">        <span class="type">StudentMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> context.getBean(StudentMapper.class);</span><br><span class="line"></span><br><span class="line">        test(mapper, List.of(<span class="string">&quot;èµµä¸€ä¼¤&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(StudentMapper mapper, List&lt;String&gt; names)</span> &#123;</span><br><span class="line">        LambdaQueryWrapper&lt;Student&gt; query = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        query.in(!names.isEmpty(), Student::getName, names);</span><br><span class="line">        System.out.println(mapper.selectList(query));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¯”è¾ƒå…¸å‹çš„ç”¨æ³•æœ‰ä¸¤å¤„ï¼š</p>
<p>ç¬¬ä¸€ï¼Œåœ¨è°ƒç”¨ in ç­‰æ–¹æ³•æ·»åŠ æ¡ä»¶æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ boolean ä¸º true æ‰ä¼šæ‹¼æ¥ SQL æ¡ä»¶ï¼Œå¦åˆ™ä¸æ‹¼æ¥ã€‚</p>
<p>å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿç”¨ <code>DoSomething</code> ç±»å‹çš„ lambda å¯¹è±¡æ¥å»¶è¿Ÿæ‹¼æ¥æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DoSomething</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doIt</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> Children <span class="title function_">maybeDo</span><span class="params">(<span class="type">boolean</span> condition, DoSomething something)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (condition) &#123;</span><br><span class="line">        something.doIt();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> typedThis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œï¼Œå®ƒåœ¨å®ç° <code>()-&gt;appendSqlSegments(...)</code> æ‹¼æ¥æ—¶ï¼Œæ˜¯ä¸æ–­ä¿®æ”¹ä¸€ä¸ª expression çŠ¶æ€å˜é‡ï¼Œä¸ºå‡½æ•°ç¼–ç¨‹æ‰€ä¸é½¿ã€‚</p>
<h3 id="4-3-4-åé—¨ç”¨æ³•"><a href="#4-3-4-åé—¨ç”¨æ³•" class="headerlink" title="4.3.4 åé—¨ç”¨æ³•"></a>4.3.4 åé—¨ç”¨æ³•</h3><p>ç¬¬äºŒï¼Œå¦‚æœç”¨ <code>LambdaQueryWrapper</code> æ‹¼æ¥ sql æ¡ä»¶æ—¶ï¼Œ<strong>ä¸ºäº†å–å¾—åˆ—å</strong>ï¼Œé‡‡ç”¨äº†è¿™ä¸ªåŠæ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Student::getName</span><br></pre></td></tr></table></figure>

<p>å®ƒè¦åšçš„äº‹å¾ˆç®€å•ï¼Œä½†å†…éƒ¨å®ç°å´æ¯”è¾ƒå¤æ‚ï¼š</p>
<ol>
<li><font color="red"><strong>å¿…é¡»ç”¨ <code>Student::getName</code> æ–¹æ³•å¼•ç”¨ï¼Œè€Œä¸èƒ½ç”¨å…¶å®ƒ Lambda å¯¹è±¡</strong></font></li>
<li><code>Student::getName</code> ä¼šå®ç° Serializable æ¥å£ï¼Œåºåˆ—åŒ–æ—¶ä¼šæŠŠå®ƒå˜æˆ SerializedLambda</li>
<li>æƒ³åŠæ³•æ‹¿åˆ° SerializedLambda å¯¹è±¡ï¼ˆåå°„è°ƒç”¨ writeReplaceï¼‰</li>
<li>é€šè¿‡ SerializedLambda èƒ½å¤Ÿè·å¾—å®ƒå¯¹åº”çš„å®é™…æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ String getName() å’Œæ‰€åœ¨ç±» Student</li>
<li>å†é€šè¿‡æ–¹æ³•åæ¨å¯¼å¾—åˆ°å±æ€§åï¼ˆå»æ‰ isï¼Œgetï¼‰å³ name</li>
<li>æ‰€åœ¨ç±» Student çŸ¥é“äº†ï¼Œå±æ€§å name ä¹Ÿæœ‰äº†ï¼Œå°±å¯ä»¥è¿›ä¸€æ­¥ç¡®å®šåˆ—å</li>
</ol>
<ul>
<li>å±æ€§ä¸Šçš„ <code>@TableField</code> æŒ‡å®šçš„åˆ—åä¼˜å…ˆ</li>
<li>æ²¡æœ‰ <code>@TableField</code>ï¼ŒæŠŠå±æ€§åå½“ä½œåˆ—å</li>
</ul>
<p><strong>PSï¼š</strong></p>
<ul>
<li>ä¸æ˜¯å¾ˆå–œæ¬¢è¿™ç§åšæ³•ï¼Œæ¯”è¾ƒæ¶å¿ƒ</li>
<li>ä½†å®ƒç¡®å®æ˜¯æƒ³åšè¿™ä¹ˆä¸€ä»¶äº‹ï¼šåœ¨ä»£ç ä¸­å…¨é¢ä½¿ç”¨ java çš„å­—æ®µåï¼Œé¿å…å‡ºç°æ•°æ®åº“çš„åˆ—å</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	<span class="comment">//(Type1 &amp; Serializable) å®ç° Type1 æ¥å£çš„åŒæ—¶å®ç° Serializable æ¥å£</span></span><br><span class="line">    <span class="comment">//Type1 lambda = (Type1 &amp; Serializable) (a, b) -&gt; a + b;</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">Type2</span> <span class="variable">lambda</span> <span class="operator">=</span> (Type2 &amp; Serializable) Student::getName;</span><br><span class="line">    <span class="comment">// å°† lambda å¯¹è±¡åºåˆ—åŒ–</span></span><br><span class="line">    <span class="type">Method</span> <span class="variable">writeReplace</span> <span class="operator">=</span> lambda.getClass().getDeclaredMethod(<span class="string">&quot;writeReplace&quot;</span>);</span><br><span class="line">    <span class="type">SerializedLambda</span> <span class="variable">serializedLambda</span> <span class="operator">=</span> (SerializedLambda) writeReplace.invoke(lambda);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾—åˆ° lambda å¯¹è±¡ä½¿ç”¨ç±»ã€æ‰€å±ç±»å’Œå®ç°æ–¹æ³•å</span></span><br><span class="line">    System.out.println(serializedLambda.getCapturingClass());</span><br><span class="line">    System.out.println(serializedLambda.getImplClass());</span><br><span class="line">    System.out.println(serializedLambda.getImplMethodName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Type2</span> &#123;</span><br><span class="line">    String <span class="title function_">get</span><span class="params">(Student student)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Type1</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-å¹¶è¡Œè®¡ç®—"><a href="#4-4-å¹¶è¡Œè®¡ç®—" class="headerlink" title="4.4 å¹¶è¡Œè®¡ç®—"></a>4.4 å¹¶è¡Œè®¡ç®—</h2><p>ç»Ÿè®¡é¡µé¢çš„è®¿é—®æ¬¡æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ParallelTest</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Pattern</span> <span class="variable">reg</span> <span class="operator">=</span> Pattern.compile(<span class="string">&quot;(\\S+) - \\[(.+)] (.+) (.+)&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">FILES</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            sequence();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sequence</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        Map&lt;String, Long&gt; m0 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; FILES; i++) &#123;</span><br><span class="line">            Map&lt;String, Long&gt; mi = one(i);</span><br><span class="line">            m0 = Stream.of(m0, mi)</span><br><span class="line">                    .flatMap(m -&gt; m.entrySet().stream())</span><br><span class="line">                    .collect(toMap(Map.Entry::getKey, Map.Entry::getValue, Long::sum));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Long&gt; e : m0.entrySet()) &#123;</span><br><span class="line"><span class="comment">//            System.out.println(e);</span></span><br><span class="line">            sum += e.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;cost: &quot;</span> + (System.currentTimeMillis() - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Long&gt; <span class="title function_">one</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (Stream&lt;String&gt; lines = Files.lines(Path.of(String.format(<span class="string">&quot;web_server_access_%d.log&quot;</span>, i)))) &#123;</span><br><span class="line">            <span class="keyword">return</span> lines</span><br><span class="line"><span class="comment">//                            .limit(10)</span></span><br><span class="line">                    .map(reg::matcher)</span><br><span class="line">                    .filter(Matcher::find)</span><br><span class="line">                    .map(matcher -&gt; matcher.group(<span class="number">3</span>))</span><br><span class="line">                    .collect(groupingBy(identity(), counting()));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">parallel</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        List&lt;CompletableFuture&lt;Map&lt;String, Long&gt;&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; FILES; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> i;</span><br><span class="line">            CompletableFuture&lt;Map&lt;String, Long&gt;&gt; future = CompletableFuture.supplyAsync(() -&gt; one(k));</span><br><span class="line">            futures.add(future);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        CompletableFuture&lt;Map&lt;String, Long&gt;&gt; f0 = futures.getFirst();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; futures.size(); i++) &#123;</span><br><span class="line">            f0 = f0.thenCombine(futures.get(i), (m1, m2) -&gt;</span><br><span class="line">                    Stream.of(m1, m2)</span><br><span class="line">                            .flatMap(m -&gt; m.entrySet().stream())</span><br><span class="line">                            .collect(toMap(Map.Entry::getKey, Map.Entry::getValue, Long::sum))</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;String, Long&gt; map = f0.get();</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Long&gt; e : map.entrySet()) &#123;</span><br><span class="line"><span class="comment">//            System.out.println(e);</span></span><br><span class="line">            sum += e.getValue();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;cost: &quot;</span> + (System.currentTimeMillis() - start));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-5-UI-äº‹ä»¶"><a href="#4-5-UI-äº‹ä»¶" class="headerlink" title="4.5 UI äº‹ä»¶"></a>4.5 UI äº‹ä»¶</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUIEvent</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">JFrame</span> <span class="variable">frame</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;Lambda Example&quot;</span>);</span><br><span class="line">        <span class="type">JButton</span> <span class="variable">button</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Click me&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨Lambdaè¡¨è¾¾å¼å®šä¹‰æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å¤„ç†ç¨‹åº</span></span><br><span class="line">        button.addActionListener(e -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Button clicked!&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        frame.add(button);</span><br><span class="line">        frame.setSize(<span class="number">300</span>, <span class="number">200</span>);</span><br><span class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        frame.setVisible(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-å®ç°åŸç†"><a href="#5-å®ç°åŸç†" class="headerlink" title="5. å®ç°åŸç†"></a>5. å®ç°åŸç†</h1><h2 id="5-1-lambda-åŸç†"><a href="#5-1-lambda-åŸç†" class="headerlink" title="5.1 lambda åŸç†"></a>5.1 lambda åŸç†</h2><p>ä»¥ä¸‹é¢ä»£ç ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        test((a, b) -&gt; a + b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(BinaryOperator&lt;Integer&gt; lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.apply(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>

<h3 id="5-1-1-ç¬¬ä¸€æ­¥ï¼Œç”Ÿæˆé™æ€æ–¹æ³•"><a href="#5-1-1-ç¬¬ä¸€æ­¥ï¼Œç”Ÿæˆé™æ€æ–¹æ³•" class="headerlink" title="5.1.1 ç¬¬ä¸€æ­¥ï¼Œç”Ÿæˆé™æ€æ–¹æ³•"></a>5.1.1 ç¬¬ä¸€æ­¥ï¼Œç”Ÿæˆé™æ€æ–¹æ³•</h3><p>å¦‚ä½•è¯æ˜ï¼Ÿç”¨åå°„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (Method method : TestLambda.class.getDeclaredMethods()) &#123;</span><br><span class="line">    System.out.println(method);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸ºï¼ˆå»æ‰äº†åŒ…åï¼Œå®¹æ˜“é˜…è¯»ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> TestLambda.main(java.lang.String[])</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> TestLambda.test(BinaryOperator)</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> java.lang.Integer TestLambda.lambda$main$<span class="number">0</span>(Integer,Integer)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¯ä»¥çœ‹åˆ°é™¤äº†æˆ‘ä»¬è‡ªå·±å†™çš„ main å’Œ test ä»¥å¤–ï¼Œå¤šå‡ºä¸€ä¸ªåä¸º <code>lambda$main$0</code> çš„æ–¹æ³•</p>
</li>
<li><p>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç¼–è¯‘æœŸé—´ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„æ–¹æ³•ï¼Œæ˜¯ syntheticï¼ˆåˆæˆï¼‰æ–¹æ³•</p>
</li>
<li><p>å®ƒçš„å‚æ•°ã€å†…å®¹å°±æ˜¯ lambda è¡¨è¾¾å¼æä¾›çš„å‚æ•°å’Œå†…å®¹ï¼Œå¦‚ä¸‹é¢ä»£ç ç‰‡æ®µæ‰€ç¤º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Integer lambda$main$<span class="number">0</span>(Integer a, Integer b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-1-2-ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆå®ç°ç±»å­—èŠ‚ç "><a href="#5-1-2-ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆå®ç°ç±»å­—èŠ‚ç " class="headerlink" title="5.1.2 ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆå®ç°ç±»å­—èŠ‚ç "></a>5.1.2 ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆå®ç°ç±»å­—èŠ‚ç </h3><p>å¦‚æœæ˜¯æˆ‘è‡ªå·±é€ ä¸€ä¸ªå¯¹è±¡åŒ…å«æ­¤æ–¹æ³•ï¼Œå¯ä»¥è¿™ä¹ˆåšã€‚</p>
<p>å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">LambdaObject</span> <span class="keyword">implements</span> <span class="title class_">BinaryOperator</span>&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">apply</span><span class="params">(Integer a, Integer b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> TestLambda.lambda$main$<span class="number">0</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†æ¥ä½¿ç”¨æ—¶ï¼Œåˆ›å»ºå¯¹è±¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">test(<span class="keyword">new</span> <span class="title class_">LambdaObject</span>());</span><br></pre></td></tr></table></figure>

<p>åªä¸è¿‡ï¼Œjvm æ˜¯åœ¨è¿è¡ŒæœŸé—´é€ å‡ºçš„è¿™ä¸ªç±»ä»¥åŠå¯¹è±¡è€Œå·²ï¼Œè¦æƒ³æŸ¥çœ‹è¿™ä¸ªç±»</p>
<p>åœ¨ jdk 21 ä¸­è¿è¡Œæ—¶æ·»åŠ è™šæ‹Ÿæœºå‚æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-Djdk.invoke.LambdaMetafactory.dumpProxyClassFiles</span><br></pre></td></tr></table></figure>

<p>æ—©æœŸ jdk æ·»åŠ çš„å‚æ•°æ˜¯ï¼ˆæ²¡æœ‰å»è¿›è¡Œç‰ˆæœ¬æ¯”å¯¹äº†ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">-Djdk.internal.lambda.dumpProxyClasses</span><br></pre></td></tr></table></figure>

<p>è‹¥æƒ³å®ç°åœ¨è¿è¡ŒæœŸé—´ç”Ÿæˆä¸Šè¿° class å­—èŠ‚ç ï¼Œæœ‰ä¸¤ç§æ‰‹æ®µï¼š</p>
<ul>
<li>ä¸€æ˜¯åŠ¨æ€ä»£ç†ï¼Œjdk å¹¶æ²¡æœ‰é‡‡ç”¨è¿™ç§åŠæ³•æ¥ç”Ÿæˆ Lambda ç±»</li>
<li>äºŒæ˜¯ç”¨ <code>LambdaMetaFactory</code>ï¼Œå®ƒé…åˆ MethodHandle API åœ¨æ‰§è¡Œæ—¶æ›´å…·æ€§èƒ½ä¼˜åŠ¿</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        test((a, b) -&gt; a + b);</span><br><span class="line"></span><br><span class="line">        MethodHandles.<span class="type">Lookup</span> <span class="variable">lookup</span> <span class="operator">=</span> MethodHandles.lookup();</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">factoryType</span> <span class="operator">=</span> MethodType.methodType(BinaryOperator.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">interfaceMethodType</span> <span class="operator">=</span> MethodType.methodType(Object.class, Object.class, Object.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">implementsMethodType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, Integer.class, Integer.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodHandle</span> <span class="variable">implementsMethod</span> <span class="operator">=</span> lookup.findStatic(TestLambda1.class, <span class="string">&quot;lambda$main$1&quot;</span>, implementsMethodType);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">lambdaType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, Integer.class, Integer.class);</span><br><span class="line">        <span class="type">CallSite</span> <span class="variable">callSite</span> <span class="operator">=</span> LambdaMetafactory.metafactory(lookup,</span><br><span class="line">                <span class="string">&quot;apply&quot;</span>, factoryType, interfaceMethodType,</span><br><span class="line">                implementsMethod,</span><br><span class="line">                lambdaType);</span><br><span class="line"></span><br><span class="line">        BinaryOperator&lt;Integer&gt; lambda = (BinaryOperator) callSite.getTarget().invoke();</span><br><span class="line">        test(lambda);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Integer lambda$main$<span class="number">1</span>(Integer a, Integer b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(BinaryOperator&lt;Integer&gt; lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.apply(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li><p>â€œapplyâ€ æ˜¯æ¥å£æ–¹æ³•å</p>
</li>
<li><p>factoryType æ˜¯å·¥å‚æ–¹æ³•é•¿ç›¸</p>
</li>
<li><p>interfaceMethodType æ˜¯æ¥å£æ–¹æ³•é•¿ç›¸</p>
</li>
<li><p>implementsMethod æ˜¯å®ç°æ–¹æ³•</p>
<ul>
<li>implementsMethodType æ˜¯å®ç°æ–¹æ³•é•¿ç›¸</li>
</ul>
</li>
<li><p>lambdaType æ˜¯å®é™…å‡½æ•°å¯¹è±¡é•¿ç›¸</p>
</li>
<li><p>callSite.getTarget() å®é™…æ˜¯è°ƒç”¨å®ç°ç±»çš„æ„é€ æ–¹æ³•å¯¹åº”çš„ mhï¼Œæœ€å invoke è¿”å›å‡½æ•°å¯¹è±¡</p>
</li>
</ul>
<h2 id="5-2-æ–¹æ³•å¼•ç”¨åŸç†"><a href="#5-2-æ–¹æ³•å¼•ç”¨åŸç†" class="headerlink" title="5.2 æ–¹æ³•å¼•ç”¨åŸç†"></a>5.2 æ–¹æ³•å¼•ç”¨åŸç†</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		test(String::toLowerCase);</span><br><span class="line">        </span><br><span class="line">        MethodHandles.<span class="type">Lookup</span> <span class="variable">lookup</span> <span class="operator">=</span> MethodHandles.lookup();</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">factoryType</span> <span class="operator">=</span> MethodType.methodType(Function.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">interfaceMethodType</span> <span class="operator">=</span> MethodType.methodType(Object.class, Object.class);</span><br><span class="line">        <span class="type">MethodHandle</span> <span class="variable">implementsMethod</span> <span class="operator">=</span> lookup.findVirtual(String.class, <span class="string">&quot;toLowerCase&quot;</span>, MethodType.methodType(String.class));</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">lambdaType</span> <span class="operator">=</span> MethodType.methodType(String.class, String.class);</span><br><span class="line">        <span class="type">CallSite</span> <span class="variable">callSite</span> <span class="operator">=</span> LambdaMetafactory.metafactory(lookup,</span><br><span class="line">                <span class="string">&quot;apply&quot;</span>, factoryType, interfaceMethodType,</span><br><span class="line">                implementsMethod,</span><br><span class="line">                lambdaType);</span><br><span class="line"></span><br><span class="line">        Function&lt;String, String&gt; lambda = (Function&lt;String, String&gt;) callSite.getTarget().invoke();</span><br><span class="line">        System.out.println(lambda.apply(<span class="string">&quot;Tom&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(Function&lt;String,String&gt; lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.apply(<span class="string">&quot;Tom&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-3-é—­åŒ…åŸç†"><a href="#5-3-é—­åŒ…åŸç†" class="headerlink" title="5.3 é—­åŒ…åŸç†"></a>5.3 é—­åŒ…åŸç†</h2><p>æ•è·åŸºæœ¬ç±»å‹å˜é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">test((a, b) -&gt; a + b + c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(BinaryOperator&lt;Integer&gt; lambda)</span> &#123;</span><br><span class="line">    System.out.println(lambda.apply(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆä¸€ä¸ªå¸¦ 3 ä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œä½†å®ƒå’Œ BinaryOperator è¿˜å·®ä¸€ä¸ª int å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> Integer lambda$main$<span class="number">1</span>(<span class="type">int</span> c, Integer a, Integer b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="comment">//        int c = 10;</span></span><br><span class="line"><span class="comment">//        test((a, b) -&gt; a + b + c);</span></span><br><span class="line"></span><br><span class="line">        MethodHandles.<span class="type">Lookup</span> <span class="variable">lookup</span> <span class="operator">=</span> MethodHandles.lookup();</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">factoryType</span> <span class="operator">=</span> MethodType.methodType(BinaryOperator.class, <span class="type">int</span>.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">interfaceMethodType</span> <span class="operator">=</span> MethodType.methodType(Object.class, Object.class, Object.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">implementsMethodType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, <span class="type">int</span>.class, Integer.class, Integer.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodHandle</span> <span class="variable">implementsMethod</span> <span class="operator">=</span> lookup.findStatic(TestLambda2.class, <span class="string">&quot;lambda$main$1&quot;</span>, implementsMethodType);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">lambdaType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, Integer.class, Integer.class);</span><br><span class="line">        <span class="type">CallSite</span> <span class="variable">callSite</span> <span class="operator">=</span> LambdaMetafactory.metafactory(lookup,</span><br><span class="line">                <span class="string">&quot;apply&quot;</span>, factoryType, interfaceMethodType,</span><br><span class="line">                implementsMethod,</span><br><span class="line">                lambdaType);</span><br><span class="line"></span><br><span class="line">        BinaryOperator&lt;Integer&gt; lambda = (BinaryOperator) callSite.getTarget().invoke(<span class="number">10</span>);</span><br><span class="line">        test(lambda);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Integer lambda$main$<span class="number">1</span>(<span class="type">int</span> c, Integer a, Integer b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b + c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(BinaryOperator&lt;Integer&gt; lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.apply(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸åŒä¹‹å¤„ï¼š</p>
<ul>
<li>factoryTypeï¼Œé™¤äº†åŸæœ¬çš„æ¥å£ç±»å‹ä¹‹å¤–ï¼Œå¤šäº†å®ç°æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹</li>
<li>äº§ç”Ÿ lambda å¯¹è±¡çš„æ—¶å€™ï¼Œé€šè¿‡ invoke æŠŠè¿™ä¸ªå‚æ•°çš„å®é™…å€¼ä¼ è¿›å»</li>
</ul>
<p>è¿™æ ·äº§ç”Ÿçš„ LambdaType å°±æ˜¯è¿™æ ·ï¼Œå¹¶ä¸”ç”Ÿæˆ Lambda å¯¹è±¡æ—¶ï¼Œc çš„å€¼è¢«å›ºå®šä¸º 10</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">LambdaType</span> <span class="keyword">implements</span> <span class="title class_">BinaryOperator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> c;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TestLambda2$$Lambda(<span class="type">int</span> c) &#123;</span><br><span class="line">        <span class="built_in">this</span>.c = c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">apply</span><span class="params">(Object a, Object b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> TestLambda2.lambda$main$<span class="number">1</span>(<span class="built_in">this</span>.c, (Integer)a, (Integer)b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•è·å¼•ç”¨ç±»å‹å˜é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLambda4</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyRef</span> &#123;</span><br><span class="line">        <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MyRef</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">/*MyRef ref = new MyRef(10);</span></span><br><span class="line"><span class="comment">        test((a, b) -&gt; a + b + ref.age);*/</span></span><br><span class="line"></span><br><span class="line">        MethodHandles.<span class="type">Lookup</span> <span class="variable">lookup</span> <span class="operator">=</span> MethodHandles.lookup();</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">factoryType</span> <span class="operator">=</span> MethodType.methodType(BinaryOperator.class, MyRef.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">interfaceMethodType</span> <span class="operator">=</span> MethodType.methodType(Object.class, Object.class, Object.class);</span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">implementsMethodType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, MyRef.class, Integer.class, Integer.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodHandle</span> <span class="variable">implementsMethod</span> <span class="operator">=</span> lookup.findStatic(TestLambda4.class, <span class="string">&quot;lambda$main$1&quot;</span>, implementsMethodType);</span><br><span class="line"></span><br><span class="line">        <span class="type">MethodType</span> <span class="variable">lambdaType</span> <span class="operator">=</span> MethodType.methodType(Integer.class, Integer.class, Integer.class);</span><br><span class="line">        <span class="type">CallSite</span> <span class="variable">callSite</span> <span class="operator">=</span> LambdaMetafactory.metafactory(lookup,</span><br><span class="line">                <span class="string">&quot;apply&quot;</span>, factoryType, interfaceMethodType,</span><br><span class="line">                implementsMethod,</span><br><span class="line">                lambdaType);</span><br><span class="line"></span><br><span class="line">        BinaryOperator&lt;Integer&gt; lambda = (BinaryOperator) callSite.getTarget().bindTo(<span class="keyword">new</span> <span class="title class_">MyRef</span>(<span class="number">20</span>)).invoke();</span><br><span class="line">        test(lambda);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Integer lambda$main$<span class="number">1</span>(MyRef c, Integer a, Integer b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b + c.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(BinaryOperator&lt;Integer&gt; lambda)</span> &#123;</span><br><span class="line">        System.out.println(lambda.apply(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸æ•è·åŸºæœ¬ç±»å‹å˜é‡ç±»ä¼¼ï¼Œä¸è¿‡ï¼š</p>
<p>é™¤äº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">callSite.getTarget().invoke(<span class="keyword">new</span> <span class="title class_">MyRef</span>(<span class="number">20</span>));</span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">callSite.getTarget().bindTo(<span class="keyword">new</span> <span class="title class_">MyRef</span>(<span class="number">20</span>)).invoke();</span><br></pre></td></tr></table></figure>

<h2 id="5-4-Stream-æ„å»º"><a href="#5-4-Stream-æ„å»º" class="headerlink" title="5.4 Stream æ„å»º"></a>5.4 Stream æ„å»º</h2><p>è‡ªå®šä¹‰å¯åˆ‡åˆ†è¿­ä»£å™¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSpliterator</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MySpliterator</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Spliterator</span>&lt;T&gt; &#123;</span><br><span class="line">        T[] array;</span><br><span class="line">        <span class="type">int</span> begin;</span><br><span class="line">        <span class="type">int</span> end;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MySpliterator</span><span class="params">(T[] array, <span class="type">int</span> begin, <span class="type">int</span> end)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.array = array;</span><br><span class="line">            <span class="built_in">this</span>.begin = begin;</span><br><span class="line">            <span class="built_in">this</span>.end = end;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">tryAdvance</span><span class="params">(Consumer&lt;? <span class="built_in">super</span> T&gt; action)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (begin &gt; end) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            action.accept(array[begin++]);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Spliterator&lt;T&gt; <span class="title function_">trySplit</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (estimateSize() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (begin + end) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">                MySpliterator&lt;T&gt; res = <span class="keyword">new</span> <span class="title class_">MySpliterator</span>&lt;&gt;(array, begin, mid);</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;=&gt;&quot;</span> + res);</span><br><span class="line">                begin = mid + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Arrays.toString(Arrays.copyOfRange(array, begin, end + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">estimateSize</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> end - begin + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">characteristics</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Spliterator.SUBSIZED | Spliterator.ORDERED;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Integer[] all = <span class="keyword">new</span> <span class="title class_">Integer</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br><span class="line">        MySpliterator&lt;Integer&gt; spliterator = <span class="keyword">new</span> <span class="title class_">MySpliterator</span>&lt;&gt;(all, <span class="number">0</span>, <span class="number">9</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        StreamSupport.stream(spliterator, <span class="literal">false</span>)</span><br><span class="line">                .parallel()</span><br><span class="line">                .forEach(x -&gt; System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span> + x));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»ƒä¹ ï¼šæŒ‰æ¯æ¬¡åˆ‡åˆ†å›ºå®šå¤§å°æ¥å®ç°</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQåŸºç¡€</title>
    <url>/posts/RabbitMQ-Basics/</url>
    <content><![CDATA[<p>RabbitMQå®˜ç½‘ï¼š<a href="https://www.rabbitmq.com/">https://www.rabbitmq.com</a></p>
<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1mN4y1Z7t9/">é»‘é©¬ç¨‹åºå‘˜RabbitMQå…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ï¼ŒMQæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¾®æœåŠ¡rabbitmqæ¶ˆæ¯é˜Ÿåˆ—å®æˆ˜ï¼ŒRabbitMQé¢è¯•é¢˜ä¸€å¥—å…¨è¦†ç›–</a></p>
<h1 id="0-å†™åœ¨å‰é¢"><a href="#0-å†™åœ¨å‰é¢" class="headerlink" title="0. å†™åœ¨å‰é¢"></a>0. å†™åœ¨å‰é¢</h1><p>å¾®æœåŠ¡ä¸€æ—¦æ‹†åˆ†ï¼Œå¿…ç„¶æ¶‰åŠåˆ°æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œç›®å‰æˆ‘ä»¬æœåŠ¡ä¹‹é—´è°ƒç”¨é‡‡ç”¨çš„éƒ½æ˜¯åŸºäº OpenFeign çš„è°ƒç”¨ã€‚è¿™ç§è°ƒç”¨ä¸­ï¼Œè°ƒç”¨è€…å‘èµ·è¯·æ±‚åéœ€è¦<strong>ç­‰å¾…</strong>æœåŠ¡æä¾›è€…æ‰§è¡Œä¸šåŠ¡è¿”å›ç»“æœåï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œåé¢çš„ä¸šåŠ¡ã€‚ä¹Ÿå°±æ˜¯è¯´è°ƒç”¨è€…åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¤„äºé˜»å¡çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬æˆè¿™ç§è°ƒç”¨æ–¹å¼ä¸º<strong>åŒæ­¥è°ƒç”¨</strong>ï¼Œä¹Ÿå¯ä»¥å«<strong>åŒæ­¥é€šè®¯</strong>ã€‚ä½†åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦é‡‡ç”¨<strong>å¼‚æ­¥é€šè®¯</strong>çš„æ–¹å¼ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯ã€‚å¦‚å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%90%8C%E6%AD%A5%E9%80%9A%E8%AE%AF%E5%92%8C%E5%BC%82%E6%AD%A5%E9%80%9A%E8%AE%AF.png" alt="åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯" style="zoom:50%;">

<p>è§£è¯»ï¼š</p>
<ul>
<li>åŒæ­¥é€šè®¯ï¼šå°±å¦‚åŒæ‰“è§†é¢‘ç”µè¯ï¼ŒåŒæ–¹çš„äº¤äº’éƒ½æ˜¯å®æ—¶çš„ã€‚å› æ­¤åŒä¸€æ—¶åˆ»ä½ åªèƒ½è·Ÿä¸€ä¸ªäººæ‰“è§†é¢‘ç”µè¯ã€‚</li>
<li>å¼‚æ­¥é€šè®¯ï¼šå°±å¦‚åŒå‘å¾®ä¿¡èŠå¤©ï¼ŒåŒæ–¹çš„äº¤äº’ä¸æ˜¯å®æ—¶çš„ï¼Œä½ ä¸éœ€è¦ç«‹åˆ»ç»™å¯¹æ–¹å›åº”ã€‚å› æ­¤ä½ å¯ä»¥å¤šçº¿æ“ä½œï¼ŒåŒæ—¶è·Ÿå¤šäººèŠå¤©ã€‚</li>
</ul>
<p>ä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæ‰“ç”µè¯å¯ä»¥ç«‹å³å¾—åˆ°å“åº”ï¼Œä½†æ˜¯ä½ å´ä¸èƒ½è·Ÿå¤šä¸ªäººåŒæ—¶é€šè¯ã€‚å‘å¾®ä¿¡å¯ä»¥åŒæ—¶ä¸å¤šä¸ªäººæ”¶å‘å¾®ä¿¡ï¼Œä½†æ˜¯å¾€å¾€å“åº”ä¼šæœ‰å»¶è¿Ÿã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬çš„ä¸šåŠ¡éœ€è¦å®æ—¶å¾—åˆ°æœåŠ¡æä¾›æ–¹çš„å“åº”ï¼Œåˆ™åº”è¯¥é€‰æ‹©åŒæ­¥é€šè®¯(åŒæ­¥è°ƒç”¨)ã€‚è€Œå¦‚æœæˆ‘ä»¬è¿½æ±‚æ›´é«˜çš„æ•ˆç‡ï¼Œå¹¶ä¸”ä¸éœ€è¦å®æ—¶å“åº”ï¼Œåˆ™åº”è¯¥é€‰æ‹©å¼‚æ­¥é€šè®¯(å¼‚æ­¥è°ƒç”¨)ã€‚</p>
<p> OpenFeign è°ƒç”¨å°±æ˜¯åŒæ­¥è°ƒç”¨çš„æ–¹å¼ã€‚ä½†æ˜¯ï¼š</p>
<ul>
<li>å¼‚æ­¥è°ƒç”¨åˆè¯¥å¦‚ä½•å®ç°ï¼Ÿ</li>
<li>å“ªäº›ä¸šåŠ¡é€‚åˆç”¨å¼‚æ­¥è°ƒç”¨æ¥å®ç°å‘¢ï¼Ÿ</li>
</ul>
<p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ä½ å°±èƒ½æ˜ç™½è¿™äº›é—®é¢˜äº†ã€‚</p>
<h1 id="1-åˆè¯†MQ"><a href="#1-åˆè¯†MQ" class="headerlink" title="1. åˆè¯†MQ"></a>1. åˆè¯†MQ</h1><h2 id="1-1-åŒæ­¥è°ƒç”¨"><a href="#1-1-åŒæ­¥è°ƒç”¨" class="headerlink" title="1.1 åŒæ­¥è°ƒç”¨"></a>1.1 åŒæ­¥è°ƒç”¨</h2><p>æˆ‘ä»¬åŸºäº OpenFeign çš„è°ƒç”¨éƒ½å±äºæ˜¯åŒæ­¥è°ƒç”¨ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä»¥<strong>ä½™é¢æ”¯ä»˜åŠŸèƒ½</strong>ä¸ºä¾‹æ¥åˆ†æï¼Œé¦–å…ˆçœ‹ä¸‹æ•´ä¸ªæµç¨‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BD%99%E9%A2%9D%E6%94%AF%E4%BB%98%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png" alt="ä½™é¢æ”¯ä»˜åŠŸèƒ½æµç¨‹"></p>
<p>ç›®å‰æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯åŸºäº OpenFeign çš„åŒæ­¥è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸šåŠ¡æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>æ”¯ä»˜æœåŠ¡éœ€è¦å…ˆè°ƒç”¨ç”¨æˆ·æœåŠ¡å®Œæˆä½™é¢æ‰£å‡</li>
<li>ç„¶åæ”¯ä»˜æœåŠ¡è‡ªå·±è¦æ›´æ–°æ”¯ä»˜æµæ°´å•çš„çŠ¶æ€</li>
<li>ç„¶åæ”¯ä»˜æœåŠ¡è°ƒç”¨äº¤æ˜“æœåŠ¡ï¼Œæ›´æ–°ä¸šåŠ¡è®¢å•çŠ¶æ€ä¸ºå·²æ”¯ä»˜</li>
</ol>
<p>è¿™å…¶ä¸­å°±å­˜åœ¨3ä¸ªé—®é¢˜ï¼š</p>
<p><strong>æ‹“å±•æ€§å·®</strong></p>
<p>æˆ‘ä»¬ç›®å‰çš„ä¸šåŠ¡ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯éšç€ä¸šåŠ¡è§„æ¨¡æ‰©å¤§ï¼Œäº§å“çš„åŠŸèƒ½ä¹Ÿåœ¨ä¸æ–­å®Œå–„ã€‚</p>
<p>åœ¨å¤§å¤šæ•°ç”µå•†ä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·æ”¯ä»˜æˆåŠŸåéƒ½ä¼šä»¥çŸ­ä¿¡æˆ–è€…å…¶å®ƒæ–¹å¼é€šçŸ¥ç”¨æˆ·ï¼Œå‘ŠçŸ¥æ”¯ä»˜æˆåŠŸã€‚å‡å¦‚åæœŸäº§å“ç»ç†æå‡ºè¿™æ ·æ–°çš„éœ€æ±‚ï¼Œä½ æ€ä¹ˆåŠï¼Ÿæ˜¯ä¸æ˜¯è¦åœ¨ä¸Šè¿°ä¸šåŠ¡ä¸­å†åŠ å…¥é€šçŸ¥ç”¨æˆ·çš„ä¸šåŠ¡ï¼Ÿ</p>
<p>æŸäº›ç”µå•†é¡¹ç›®ä¸­ï¼Œè¿˜ä¼šæœ‰ç§¯åˆ†æˆ–é‡‘å¸çš„æ¦‚å¿µã€‚å‡å¦‚äº§å“ç»ç†æå‡ºéœ€æ±‚ï¼Œç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼Œç»™ç”¨æˆ·ä»¥ç§¯åˆ†å¥–åŠ±æˆ–è€…è¿”è¿˜é‡‘å¸ï¼Œä½ æ€ä¹ˆåŠï¼Ÿæ˜¯ä¸æ˜¯è¦åœ¨ä¸Šè¿°ä¸šåŠ¡ä¸­å†åŠ å…¥ç§¯åˆ†ä¸šåŠ¡ã€è¿”è¿˜é‡‘å¸ä¸šåŠ¡ï¼Ÿ</p>
<p>æœ€ç»ˆä½ çš„æ”¯ä»˜ä¸šåŠ¡ä¼šè¶Šæ¥è¶Šè‡ƒè‚¿ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%94%AF%E4%BB%98%E4%B8%9A%E5%8A%A1.png" alt="æ”¯ä»˜ä¸šåŠ¡" style="zoom: 50%;">

<p>ä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡æœ‰æ–°çš„éœ€æ±‚ï¼Œç°æœ‰æ”¯ä»˜é€»è¾‘éƒ½è¦è·Ÿç€å˜åŒ–ï¼Œä»£ç ç»å¸¸å˜åŠ¨ï¼Œä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œæ‹“å±•æ€§ä¸å¥½ã€‚</p>
<p><strong>æ€§èƒ½ä¸‹é™</strong></p>
<p>ç”±äºæˆ‘ä»¬é‡‡ç”¨äº†åŒæ­¥è°ƒç”¨ï¼Œè°ƒç”¨è€…éœ€è¦ç­‰å¾…æœåŠ¡æä¾›è€…æ‰§è¡Œå®Œè¿”å›ç»“æœåï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡è¿œç¨‹è°ƒç”¨ï¼Œè°ƒç”¨è€…éƒ½æ˜¯é˜»å¡ç­‰å¾…çŠ¶æ€ã€‚æœ€ç»ˆæ•´ä¸ªä¸šåŠ¡çš„å“åº”æ—¶é•¿å°±æ˜¯æ¯æ¬¡è¿œç¨‹è°ƒç”¨çš„æ‰§è¡Œæ—¶é•¿ä¹‹å’Œï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%89%A7%E8%A1%8C%E6%97%B6%E9%95%BF.png" alt="æ‰§è¡Œæ—¶é•¿" style="zoom: 50%;">

<p>å‡å¦‚æ¯ä¸ªå¾®æœåŠ¡çš„æ‰§è¡Œæ—¶é•¿éƒ½æ˜¯ 50msï¼Œåˆ™æœ€ç»ˆæ•´ä¸ªä¸šåŠ¡çš„è€—æ—¶å¯èƒ½é«˜è¾¾ 300msï¼Œæ€§èƒ½å¤ªå·®äº†ã€‚</p>
<p><strong>çº§è”å¤±è´¥</strong></p>
<p>ç”±äºæˆ‘ä»¬æ˜¯åŸºäº OpenFeign è°ƒç”¨äº¤æ˜“æœåŠ¡ã€é€šçŸ¥æœåŠ¡ã€‚å½“äº¤æ˜“æœåŠ¡ã€é€šçŸ¥æœåŠ¡å‡ºç°æ•…éšœæ—¶ï¼Œæ•´ä¸ªäº‹åŠ¡éƒ½ä¼šå›æ»šï¼Œäº¤æ˜“å¤±è´¥ã€‚</p>
<p>è¿™å…¶å®å°±æ˜¯åŒæ­¥è°ƒç”¨çš„<strong>çº§è”å¤±è´¥</strong>é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¤§å®¶æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬å‡è®¾ç”¨æˆ·ä½™é¢å……è¶³ï¼Œæ‰£æ¬¾å·²ç»æˆåŠŸï¼Œæ­¤æ—¶æˆ‘ä»¬åº”è¯¥ç¡®ä¿æ”¯ä»˜æµæ°´å•æ›´æ–°ä¸ºå·²æ”¯ä»˜ï¼Œç¡®ä¿äº¤æ˜“æˆåŠŸã€‚æ¯•ç«Ÿæ”¶åˆ°æ‰‹é‡Œçš„é’±æ²¡é“ç†å†é€€å›å»å§ã€‚ğŸ˜¬</p>
<p>å› æ­¤ï¼Œè¿™é‡Œä¸èƒ½å› ä¸ºçŸ­ä¿¡é€šçŸ¥ã€æ›´æ–°è®¢å•çŠ¶æ€å¤±è´¥è€Œå›æ»šæ•´ä¸ªäº‹åŠ¡ã€‚</p>
<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>ç»¼ä¸Šï¼ŒåŒæ­¥è°ƒç”¨çš„æ–¹å¼å­˜åœ¨ä¸‹åˆ—é—®é¢˜ï¼š</p>
<ul>
<li>æ‹“å±•æ€§å·®</li>
<li>æ€§èƒ½ä¸‹é™</li>
<li>çº§è”å¤±è´¥</li>
</ul>
<p>è€Œè¦è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç”¨<strong>å¼‚æ­¥è°ƒç”¨</strong>çš„æ–¹å¼æ¥ä»£æ›¿<strong>åŒæ­¥è°ƒç”¨</strong>ã€‚</p>
<h2 id="1-2-å¼‚æ­¥è°ƒç”¨"><a href="#1-2-å¼‚æ­¥è°ƒç”¨" class="headerlink" title="1.2 å¼‚æ­¥è°ƒç”¨"></a>1.2 å¼‚æ­¥è°ƒç”¨</h2><p>å¼‚æ­¥è°ƒç”¨æ–¹å¼å…¶å®å°±æ˜¯åŸºäºæ¶ˆæ¯é€šçŸ¥çš„æ–¹å¼ï¼Œä¸€èˆ¬åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼š</p>
<ul>
<li>æ¶ˆæ¯å‘é€è€…ï¼šæŠ•é€’æ¶ˆæ¯çš„äººï¼Œå°±æ˜¯åŸæ¥çš„è°ƒç”¨æ–¹</li>
<li>æ¶ˆæ¯ Brokerï¼šç®¡ç†ã€æš‚å­˜ã€è½¬å‘æ¶ˆæ¯ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£æˆå¾®ä¿¡æœåŠ¡å™¨</li>
<li>æ¶ˆæ¯æ¥æ”¶è€…ï¼šæ¥æ”¶å’Œå¤„ç†æ¶ˆæ¯çš„äººï¼Œå°±æ˜¯åŸæ¥çš„æœåŠ¡æä¾›æ–¹</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%BC%82%E6%AD%A5%E8%B0%83%E7%94%A8%E4%B8%89%E8%A7%92%E8%89%B2.png" alt="å¼‚æ­¥è°ƒç”¨ä¸‰è§’è‰²"></p>
<p>åœ¨å¼‚æ­¥è°ƒç”¨ä¸­ï¼Œå‘é€è€…ä¸å†ç›´æ¥åŒæ­¥è°ƒç”¨æ¥æ”¶è€…çš„ä¸šåŠ¡æ¥å£ï¼Œè€Œæ˜¯å‘é€ä¸€æ¡æ¶ˆæ¯æŠ•é€’ç»™æ¶ˆæ¯Brokerã€‚ç„¶åæ¥æ”¶è€…æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä»æ¶ˆæ¯ Broker é‚£é‡Œè®¢é˜…æ¶ˆæ¯ã€‚æ¯å½“å‘é€æ–¹å‘é€æ¶ˆæ¯åï¼Œæ¥å—è€…éƒ½èƒ½è·å–æ¶ˆæ¯å¹¶å¤„ç†ã€‚</p>
<p>è¿™æ ·ï¼Œå‘é€æ¶ˆæ¯çš„äººå’Œæ¥æ”¶æ¶ˆæ¯çš„äººå°±å®Œå…¨è§£è€¦äº†ã€‚</p>
<p>è¿˜æ˜¯ä»¥ä½™é¢æ”¯ä»˜ä¸šåŠ¡ä¸ºä¾‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BD%99%E9%A2%9D%E6%94%AF%E4%BB%98%E4%B8%9A%E5%8A%A1.png" alt="ä½™é¢æ”¯ä»˜ä¸šåŠ¡" style="zoom: 50%;">

<p>é™¤äº†æ‰£å‡ä½™é¢ã€æ›´æ–°æ”¯ä»˜æµæ°´å•çŠ¶æ€ä»¥å¤–ï¼Œå…¶å®ƒè°ƒç”¨é€»è¾‘å…¨éƒ¨å–æ¶ˆã€‚è€Œæ˜¯æ”¹ä¸ºå‘é€ä¸€æ¡æ¶ˆæ¯åˆ° Brokerã€‚è€Œç›¸å…³çš„å¾®æœåŠ¡éƒ½å¯ä»¥è®¢é˜…æ¶ˆæ¯é€šçŸ¥ï¼Œä¸€æ—¦æ¶ˆæ¯åˆ°è¾¾ Brokerï¼Œåˆ™ä¼šåˆ†å‘ç»™æ¯ä¸€ä¸ªè®¢é˜…äº†çš„å¾®æœåŠ¡ï¼Œå¤„ç†å„è‡ªçš„ä¸šåŠ¡ã€‚</p>
<p>å‡å¦‚äº§å“ç»ç†æå‡ºäº†æ–°çš„éœ€æ±‚ï¼Œæ¯”å¦‚è¦åœ¨æ”¯ä»˜æˆåŠŸåæ›´æ–°ç”¨æˆ·ç§¯åˆ†ã€‚æ”¯ä»˜ä»£ç å®Œå…¨ä¸ç”¨å˜æ›´ï¼Œè€Œä»…ä»…æ˜¯è®©ç§¯åˆ†æœåŠ¡ä¹Ÿè®¢é˜…æ¶ˆæ¯å³å¯ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%A2%9E%E5%8A%A0%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E7%A7%AF%E5%88%86.png" alt="å¢åŠ æ›´æ–°ç”¨æˆ·ç§¯åˆ†" style="zoom:50%;">

<p>ä¸ç®¡åæœŸå¢åŠ äº†å¤šå°‘æ¶ˆæ¯è®¢é˜…è€…ï¼Œä½œä¸ºæ”¯ä»˜æœåŠ¡æ¥è®²ï¼Œæ‰§è¡Œé—®æ‰£å‡ä½™é¢ã€æ›´æ–°æ”¯ä»˜æµæ°´çŠ¶æ€åï¼Œå‘é€æ¶ˆæ¯å³å¯ã€‚ä¸šåŠ¡è€—æ—¶ä»…ä»…æ˜¯è¿™ä¸‰éƒ¨åˆ†ä¸šåŠ¡è€—æ—¶ï¼Œä»…ä»… 100msï¼Œå¤§å¤§æé«˜äº†ä¸šåŠ¡æ€§èƒ½ã€‚</p>
<p>å¦å¤–ï¼Œä¸ç®¡æ˜¯äº¤æ˜“æœåŠ¡ã€é€šçŸ¥æœåŠ¡ï¼Œè¿˜æ˜¯ç§¯åˆ†æœåŠ¡ï¼Œä»–ä»¬çš„ä¸šåŠ¡ä¸æ”¯ä»˜å…³è”åº¦ä½ã€‚ç°åœ¨é‡‡ç”¨äº†å¼‚æ­¥è°ƒç”¨ï¼Œè§£é™¤äº†è€¦åˆï¼Œä»–ä»¬å³ä¾¿æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†æ•…éšœï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°æ”¯ä»˜æœåŠ¡ã€‚</p>
<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>ç»¼ä¸Šï¼Œå¼‚æ­¥è°ƒç”¨çš„ä¼˜åŠ¿åŒ…æ‹¬</p>
<ul>
<li>è€¦åˆåº¦æ›´ä½</li>
<li>æ€§èƒ½æ›´å¥½</li>
<li>ä¸šåŠ¡æ‹“å±•æ€§å¼º</li>
<li>æ•…éšœéš”ç¦»ï¼Œé¿å…çº§è”å¤±è´¥</li>
</ul>
<p>å½“ç„¶ï¼Œå¼‚æ­¥é€šä¿¡ä¹Ÿå¹¶éå®Œç¾æ— ç¼ºï¼Œå®ƒå­˜åœ¨ä¸‹åˆ—ç¼ºç‚¹ï¼š</p>
<ul>
<li>å®Œå…¨ä¾èµ–äº Broker çš„å¯é æ€§ã€å®‰å…¨æ€§å’Œæ€§èƒ½</li>
<li>æ¶æ„å¤æ‚ï¼ŒåæœŸç»´æŠ¤å’Œè°ƒè¯•éº»çƒ¦</li>
</ul>
<h2 id="1-3-æŠ€æœ¯é€‰å‹"><a href="#1-3-æŠ€æœ¯é€‰å‹" class="headerlink" title="1.3 æŠ€æœ¯é€‰å‹"></a>1.3 æŠ€æœ¯é€‰å‹</h2><p>æ¶ˆæ¯ Brokerï¼Œç›®å‰å¸¸è§çš„å®ç°æ–¹æ¡ˆå°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—(MessageQueue)ï¼Œç®€ç§°ä¸º MQã€‚</p>
<p>ç›®æ¯”è¾ƒå¸¸è§çš„ MQ å®ç°å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center"><strong>RabbitMQ</strong></th>
<th align="center"><strong>ActiveMQ</strong></th>
<th align="center"><strong>RocketMQ</strong></th>
<th align="center"><strong>Kafka</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">å…¬å¸&#x2F;ç¤¾åŒº</td>
<td align="center">Rabbit</td>
<td align="center">Apache</td>
<td align="center">é˜¿é‡Œ</td>
<td align="center">Apache</td>
</tr>
<tr>
<td align="center">å¼€å‘è¯­è¨€</td>
<td align="center">Erlang</td>
<td align="center">Java</td>
<td align="center">Java</td>
<td align="center">Scala&amp;Java</td>
</tr>
<tr>
<td align="center">åè®®æ”¯æŒ</td>
<td align="center">AMQPï¼ŒXMPPï¼ŒSMTPï¼ŒSTOMP</td>
<td align="center">OpenWire,STOMPï¼ŒREST,XMPP,AMQP</td>
<td align="center">è‡ªå®šä¹‰åè®®</td>
<td align="center">è‡ªå®šä¹‰åè®®</td>
</tr>
<tr>
<td align="center">å¯ç”¨æ€§</td>
<td align="center">é«˜</td>
<td align="center">ä¸€èˆ¬</td>
<td align="center">é«˜</td>
<td align="center">é«˜</td>
</tr>
<tr>
<td align="center">å•æœºååé‡</td>
<td align="center">ä¸€èˆ¬</td>
<td align="center">å·®</td>
<td align="center">é«˜</td>
<td align="center">éå¸¸é«˜</td>
</tr>
<tr>
<td align="center">æ¶ˆæ¯å»¶è¿Ÿ</td>
<td align="center">å¾®ç§’çº§</td>
<td align="center">æ¯«ç§’çº§</td>
<td align="center">æ¯«ç§’çº§</td>
<td align="center">æ¯«ç§’ä»¥å†…</td>
</tr>
<tr>
<td align="center">æ¶ˆæ¯å¯é æ€§</td>
<td align="center">é«˜</td>
<td align="center">ä¸€èˆ¬</td>
<td align="center">é«˜</td>
<td align="center">ä¸€èˆ¬</td>
</tr>
</tbody></table>
<p>è¿½æ±‚å¯ç”¨æ€§ï¼šKafkaã€ RocketMQ ã€RabbitMQ</p>
<p>è¿½æ±‚å¯é æ€§ï¼šRabbitMQã€RocketMQ</p>
<p>è¿½æ±‚ååèƒ½åŠ›ï¼šRocketMQã€Kafka</p>
<p>è¿½æ±‚æ¶ˆæ¯ä½å»¶è¿Ÿï¼šRabbitMQã€Kafka</p>
<p>æ®ç»Ÿè®¡ï¼Œç›®å‰å›½å†…æ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯ RabbitMQï¼Œå…¶å„æ–¹é¢éƒ½æ¯”è¾ƒå‡è¡¡ï¼Œç¨³å®šæ€§ä¹Ÿå¥½ã€‚</p>
<h1 id="2-RabbitMQ"><a href="#2-RabbitMQ" class="headerlink" title="2. RabbitMQ"></a>2. RabbitMQ</h1><p>RabbitMQ æ˜¯åŸºäº Erlang è¯­è¨€å¼€å‘çš„å¼€æºæ¶ˆæ¯é€šä¿¡ä¸­é—´ä»¶ï¼Œå®˜ç½‘åœ°å€ï¼š<a href="https://www.rabbitmq.com/">https://www.rabbitmq.com</a></p>
<h2 id="2-1-å®‰è£…"><a href="#2-1-å®‰è£…" class="headerlink" title="2.1 å®‰è£…"></a>2.1 å®‰è£…</h2><p>æˆ‘ä»¬åŸºäº Docker æ¥å®‰è£… RabbitMQï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å³å¯ï¼š</p>
<p>1ã€æ‹‰å–é•œåƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull rabbitmq:3.8-management</span><br></pre></td></tr></table></figure>

<p>2ã€åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run \</span><br><span class="line"> -e RABBITMQ_DEFAULT_USER=muyoukule \</span><br><span class="line"> -e RABBITMQ_DEFAULT_PASS=123456 \</span><br><span class="line"> -v mq-plugins:/plugins \</span><br><span class="line"> --name mq \</span><br><span class="line"> --hostname mq \</span><br><span class="line"> -p 15672:15672 \</span><br><span class="line"> -p 5672:5672 \</span><br><span class="line"> --network hmall \</span><br><span class="line"> -d \</span><br><span class="line"> rabbitmq:3.8-management</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åœ¨å®‰è£…å‘½ä»¤ä¸­æœ‰ä¸¤ä¸ªæ˜ å°„çš„ç«¯å£ï¼š</p>
<ul>
<li>15672ï¼šRabbitMQ æä¾›çš„ç®¡ç†æ§åˆ¶å°çš„ç«¯å£</li>
<li>5672ï¼šRabbitMQ çš„æ¶ˆæ¯å‘é€å¤„ç†æ¥å£</li>
</ul>
<p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬è®¿é—® <code>http://YourIp:15672/</code> å³å¯çœ‹åˆ°ç®¡ç†æ§åˆ¶å°ã€‚é¦–æ¬¡è®¿é—®éœ€è¦ç™»å½•ï¼Œé»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç åœ¨é…ç½®æ–‡ä»¶ä¸­å·²ç»æŒ‡å®šäº†ã€‚</p>
<p>ç™»å½•åå³å¯çœ‹åˆ°ç®¡ç†æ§åˆ¶å°æ€»è§ˆé¡µé¢ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%80%BB%E8%A7%88%E9%A1%B5%E9%9D%A2.png" alt="RabbitMQç®¡ç†æ§åˆ¶å°æ€»è§ˆé¡µé¢"></p>
<p>RabbitMQ å¯¹åº”çš„æ¶æ„å¦‚å›¾ï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E6%9E%B6%E6%9E%84%E5%A6%82%E5%9B%BE.png" alt="RabbitMQæ¶æ„å¦‚å›¾"></p>
<p>å…¶ä¸­åŒ…å«å‡ ä¸ªæ¦‚å¿µï¼š</p>
<ul>
<li><code>publisher</code>ï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯å‘é€æ¶ˆæ¯çš„ä¸€æ–¹</li>
<li><code>consumer</code>ï¼šæ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹æ¶ˆæ¯çš„ä¸€æ–¹</li>
<li><code>queue</code>ï¼šé˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯ã€‚ç”Ÿäº§è€…æŠ•é€’çš„æ¶ˆæ¯ä¼šæš‚å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ¶ˆè´¹è€…å¤„ç†</li>
<li><code>exchange</code>ï¼šäº¤æ¢æœºï¼Œè´Ÿè´£æ¶ˆæ¯è·¯ç”±ã€‚ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ç”±äº¤æ¢æœºå†³å®šæŠ•é€’åˆ°å“ªä¸ªé˜Ÿåˆ—ã€‚</li>
<li><code>virtual host</code>ï¼šè™šæ‹Ÿä¸»æœºï¼Œèµ·åˆ°æ•°æ®éš”ç¦»çš„ä½œç”¨ã€‚æ¯ä¸ªè™šæ‹Ÿä¸»æœºç›¸äº’ç‹¬ç«‹ï¼Œæœ‰å„è‡ªçš„exchangeã€queue</li>
</ul>
<p>ä¸Šè¿°è¿™äº›ä¸œè¥¿éƒ½å¯ä»¥åœ¨ RabbitMQ çš„ç®¡ç†æ§åˆ¶å°æ¥ç®¡ç†ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬å°±ä¸€èµ·æ¥å­¦ä¹ æ§åˆ¶å°çš„ä½¿ç”¨ã€‚</p>
<h2 id="2-2-æ”¶å‘æ¶ˆæ¯"><a href="#2-2-æ”¶å‘æ¶ˆæ¯" class="headerlink" title="2.2 æ”¶å‘æ¶ˆæ¯"></a>2.2 æ”¶å‘æ¶ˆæ¯</h2><h3 id="2-2-1-äº¤æ¢æœº"><a href="#2-2-1-äº¤æ¢æœº" class="headerlink" title="2.2.1 äº¤æ¢æœº"></a>2.2.1 äº¤æ¢æœº</h3><p>æˆ‘ä»¬æ‰“å¼€ <code>Exchanges</code> é€‰é¡¹å¡ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»å­˜åœ¨å¾ˆå¤šäº¤æ¢æœºï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E9%BB%98%E8%AE%A4%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="RabbitMQé»˜è®¤äº¤æ¢æœº" style="zoom:50%;">

<p>æˆ‘ä»¬ç‚¹å‡»ä»»æ„äº¤æ¢æœºï¼Œå³å¯è¿›å…¥äº¤æ¢æœºè¯¦æƒ…é¡µé¢ã€‚ä»ç„¶ä¼šåˆ©ç”¨æ§åˆ¶å°ä¸­çš„ <code>publish message</code> å‘é€ä¸€æ¡æ¶ˆæ¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E4%BA%A4%E6%8D%A2%E6%9C%BA%E8%AF%A6%E6%83%85%E9%A1%B5%E9%9D%A2.png" alt="RabbitMQäº¤æ¢æœºè¯¦æƒ…é¡µé¢"><br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF.png" alt="RabbitMQæ§åˆ¶å°å‘é€æ¶ˆæ¯" style="zoom:50%;"></p>
<p>ç‚¹å‡»åä¼šæç¤º<code>Message published, but not routed.</code>è¿™é‡Œæ˜¯ç”±æ§åˆ¶å°æ¨¡æ‹Ÿäº†ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ã€‚ç”±äºæ²¡æœ‰æ¶ˆè´¹è€…å­˜åœ¨ï¼Œæœ€ç»ˆæ¶ˆæ¯ä¸¢å¤±äº†ï¼Œè¿™æ ·è¯´æ˜äº¤æ¢æœºæ²¡æœ‰å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›ã€‚</p>
<h3 id="2-2-2-é˜Ÿåˆ—"><a href="#2-2-2-é˜Ÿåˆ—" class="headerlink" title="2.2.2 é˜Ÿåˆ—"></a>2.2.2 é˜Ÿåˆ—</h3><p>æˆ‘ä»¬æ‰“å¼€ <code>Queues</code> é€‰é¡¹å¡ï¼Œæ–°å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E6%96%B0%E5%BB%BA%E9%98%9F%E5%88%97.png" alt="RabbitMQæ–°å»ºé˜Ÿåˆ—" style="zoom: 67%;"></p>
<p>å‘½åä¸º <code>hello.queue1</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%91%BD%E5%90%8D%E9%98%9F%E5%88%97%E4%B8%BAhello.queue1.png" alt="å‘½åé˜Ÿåˆ—ä¸ºhello.queue1" style="zoom: 67%;">

<p>å†ä»¥ç›¸åŒçš„æ–¹å¼ï¼Œåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œå‘½åä¸º <code>hello.queue2</code>ï¼Œæœ€ç»ˆé˜Ÿåˆ—åˆ—è¡¨å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%91%BD%E5%90%8D%E9%98%9F%E5%88%97%E4%B8%BAhello.queue2.png" alt="å‘½åé˜Ÿåˆ—ä¸ºhello.queue2" style="zoom:67%;">

<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å†æ¬¡å‘ <code>amq.fanout</code> äº¤æ¢æœºå‘é€ä¸€æ¡æ¶ˆæ¯ã€‚ä¼šå‘ç°æ¶ˆæ¯ä¾ç„¶æ²¡æœ‰åˆ°è¾¾é˜Ÿåˆ—ï¼ï¼</p>
<p>æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p>
<p>å‘é€åˆ°äº¤æ¢æœºçš„æ¶ˆæ¯ï¼Œåªä¼šè·¯ç”±åˆ°ä¸å…¶ç»‘å®šçš„é˜Ÿåˆ—ï¼Œå› æ­¤ä»…ä»…åˆ›å»ºé˜Ÿåˆ—æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å…¶ä¸äº¤æ¢æœºç»‘å®šã€‚</p>
<h3 id="2-2-3-ç»‘å®šå…³ç³»"><a href="#2-2-3-ç»‘å®šå…³ç³»" class="headerlink" title="2.2.3 ç»‘å®šå…³ç³»"></a>2.2.3 ç»‘å®šå…³ç³»</h3><p>ç‚¹å‡» <code>Exchanges</code> é€‰é¡¹å¡ï¼Œç‚¹å‡» <code>amq.fanout</code> äº¤æ¢æœºï¼Œè¿›å…¥äº¤æ¢æœºè¯¦æƒ…é¡µï¼Œç„¶åç‚¹å‡»<code>Bindings</code>èœå•ï¼Œåœ¨è¡¨å•ä¸­å¡«å†™è¦ç»‘å®šçš„é˜Ÿåˆ—åç§°ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%A1%AB%E5%86%99%E8%A6%81%E7%BB%91%E5%AE%9A%E7%9A%84%E9%98%9F%E5%88%97%E5%90%8D%E7%A7%B0.png" alt="å¡«å†™è¦ç»‘å®šçš„é˜Ÿåˆ—åç§°" style="zoom: 50%;">

<p>ç›¸åŒçš„æ–¹å¼ï¼Œå°† <code>hello.queue2</code> ä¹Ÿç»‘å®šåˆ°æ”¹äº¤æ¢æœºã€‚</p>
<p>æœ€ç»ˆï¼Œç»‘å®šç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%BB%91%E5%AE%9A%E7%BB%93%E6%9E%9C.png" alt="äº¤æ¢æœºç»‘å®šç»“æœ" style="zoom:67%;">

<h3 id="2-2-4-å‘é€æ¶ˆæ¯"><a href="#2-2-4-å‘é€æ¶ˆæ¯" class="headerlink" title="2.2.4 å‘é€æ¶ˆæ¯"></a>2.2.4 å‘é€æ¶ˆæ¯</h3><p>å†æ¬¡å›åˆ° <code>Exchange</code> é¡µé¢ï¼Œæ‰¾åˆ°åˆšåˆšç»‘å®šçš„ <code>amq.fanout</code>ï¼Œç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µï¼Œå†æ¬¡å‘é€ä¸€æ¡æ¶ˆæ¯ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%A1%AB%E5%86%99%E8%A6%81%E7%BB%91%E5%AE%9A%E7%9A%84%E9%98%9F%E5%88%97%E5%90%8D%E7%A7%B0.png" alt="å¡«å†™è¦ç»‘å®šçš„é˜Ÿåˆ—åç§°" style="zoom: 50%;">

<p>å›åˆ° <code>Queues</code> é¡µé¢ï¼Œå¯ä»¥å‘ç° <code>hello.queue</code> ä¸­å·²ç»æœ‰ä¸€æ¡æ¶ˆæ¯äº†ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/hello.queue%E4%B8%AD%E5%B7%B2%E6%9C%89%E4%B8%80%E6%9D%A1%E6%B6%88%E6%81%AF.png" alt="hello.queueä¸­å·²æœ‰ä¸€æ¡æ¶ˆæ¯" style="zoom:67%;">

<p>ç‚¹å‡»é˜Ÿåˆ—åç§°ï¼Œè¿›å…¥è¯¦æƒ…é¡µï¼ŒæŸ¥çœ‹é˜Ÿåˆ—è¯¦æƒ…ï¼Œè¿™æ¬¡æˆ‘ä»¬ç‚¹å‡» <code>Get message</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E7%82%B9%E5%87%BBgetmessage.png" alt="ç‚¹å‡»getmessage" style="zoom: 80%;">

<p>å¯ä»¥çœ‹åˆ°æ¶ˆæ¯åˆ°è¾¾é˜Ÿåˆ—äº†ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E5%88%B0%E8%BE%BE%E9%98%9F%E5%88%97.png" alt="æ¶ˆæ¯åˆ°è¾¾é˜Ÿåˆ—" style="zoom: 80%;">



<p>è¿™ä¸ªæ—¶å€™å¦‚æœæœ‰æ¶ˆè´¹è€…ç›‘å¬äº† MQ çš„ <code>hello.queue1</code> æˆ– <code>hello.queue2</code> é˜Ÿåˆ—ï¼Œè‡ªç„¶å°±èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯äº†ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li><p>äº¤æ¢æœºè´Ÿè´£è·¯ç”±å’Œè½¬å‘æ¶ˆæ¯ï¼Œæ²¡æœ‰å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›</p>
</li>
<li><p>ä¸€æ—¦é˜Ÿåˆ—ä¸äº¤æ¢æœºç»‘å®šï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½å¯ä»¥æ”¶åˆ°ä¿¡æ¯</p>
</li>
</ul>
<h2 id="2-3-æ•°æ®éš”ç¦»"><a href="#2-3-æ•°æ®éš”ç¦»" class="headerlink" title="2.3 æ•°æ®éš”ç¦»"></a>2.3 æ•°æ®éš”ç¦»</h2><h3 id="2-3-1-ç”¨æˆ·ç®¡ç†"><a href="#2-3-1-ç”¨æˆ·ç®¡ç†" class="headerlink" title="2.3.1 ç”¨æˆ·ç®¡ç†"></a>2.3.1 ç”¨æˆ·ç®¡ç†</h3><p>ç‚¹å‡» <code>Admin</code> é€‰é¡¹å¡ï¼Œé¦–å…ˆä¼šçœ‹åˆ° RabbitMQ æ§åˆ¶å°çš„ç”¨æˆ·ç®¡ç†ç•Œé¢ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2.png" alt="RabbitMQæ§åˆ¶å°ç”¨æˆ·ç®¡ç†ç•Œé¢"></p>
<p>è¿™é‡Œçš„ç”¨æˆ·éƒ½æ˜¯ RabbitMQ çš„ç®¡ç†æˆ–è¿ç»´äººå‘˜ã€‚ç›®å‰åªæœ‰å®‰è£… RabbitMQ æ—¶æ·»åŠ çš„ <code>muyoukule</code> è¿™ä¸ªç”¨æˆ·ã€‚ä»”ç»†è§‚å¯Ÿç”¨æˆ·è¡¨æ ¼ä¸­çš„å­—æ®µï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>Name</code>ï¼š<code>muyoukule</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·å</li>
<li><code>Tags</code>ï¼š<code>administrator</code>ï¼Œè¯´æ˜ <code>muyoukule</code> ç”¨æˆ·æ˜¯è¶…çº§ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™</li>
<li><code>Can access virtual host</code>ï¼š <code>/</code>ï¼Œå¯ä»¥è®¿é—®çš„<code>virtual host</code>ï¼Œè¿™é‡Œçš„ <code>/ </code>æ˜¯é»˜è®¤çš„ <code>virtual host</code></li>
</ul>
<p>å¯¹äºå°å‹ä¼ä¸šè€Œè¨€ï¼Œå‡ºäºæˆæœ¬è€ƒè™‘ï¼Œæˆ‘ä»¬é€šå¸¸åªä¼šæ­å»ºä¸€å¥— MQ é›†ç¾¤ï¼Œå…¬å¸å†…çš„å¤šä¸ªä¸åŒé¡¹ç›®åŒæ—¶ä½¿ç”¨ã€‚è¿™ä¸ªæ—¶å€™ä¸ºäº†é¿å…äº’ç›¸å¹²æ‰°ï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨ <code>virtual host</code> çš„éš”ç¦»ç‰¹æ€§ï¼Œå°†ä¸åŒé¡¹ç›®éš”ç¦»ã€‚ä¸€èˆ¬ä¼šåšä¸¤ä»¶äº‹æƒ…ï¼š</p>
<ul>
<li>ç»™æ¯ä¸ªé¡¹ç›®åˆ›å»ºç‹¬ç«‹çš„è¿ç»´è´¦å·ï¼Œå°†ç®¡ç†æƒé™åˆ†ç¦»ã€‚</li>
<li>ç»™æ¯ä¸ªé¡¹ç›®åˆ›å»ºä¸åŒçš„ <code>virtual host</code> ï¼Œå°†æ¯ä¸ªé¡¹ç›®çš„æ•°æ®éš”ç¦»ã€‚</li>
</ul>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»™é»‘é©¬å•†åŸåˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·ï¼Œå‘½åä¸º <code>hmall</code> ,å¯†ç ä¸º  <code>123</code> ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%88%9B%E5%BB%BA%E6%96%B0%E7%94%A8%E6%88%B7hmall-1711859231732-4.png" alt="åˆ›å»ºæ–°ç”¨æˆ·hmall"></p>
<p>ä½ ä¼šå‘ç°æ­¤æ—¶ hmall ç”¨æˆ·æ²¡æœ‰ä»»ä½• <code>virtual host</code> çš„è®¿é—®æƒé™ï¼š<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/hmall%E6%97%A0%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90.png" alt="hmallæ— è®¿é—®æƒé™"></p>
<p>åˆ«æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥æˆæƒã€‚</p>
<h3 id="2-3-2-virtual-host"><a href="#2-3-2-virtual-host" class="headerlink" title="2.3.2 virtual host"></a>2.3.2 virtual host</h3><p>æˆ‘ä»¬å…ˆé€€å‡ºç™»å½•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95.png" alt="é€€å‡ºç™»å½•"></p>
<p>åˆ‡æ¢åˆ°åˆšåˆšåˆ›å»ºçš„ hmall ç”¨æˆ·ç™»å½•ï¼Œç„¶åç‚¹å‡» <code>Virtual Hosts</code> èœå•ï¼Œè¿›å…¥ <code>virtual host</code> ç®¡ç†é¡µï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E8%BF%9B%E5%85%A5virtual%20host%E7%AE%A1%E7%90%86%E9%A1%B5.png" alt="è¿›å…¥virtual hostç®¡ç†é¡µ"></p>
<p>å¯ä»¥çœ‹åˆ°ç›®å‰åªæœ‰ä¸€ä¸ªé»˜è®¤çš„ <code>virtual host</code>ï¼Œåå­—ä¸º <code>/</code>ã€‚</p>
<p> æˆ‘ä»¬å¯ä»¥ç»™é»‘é©¬å•†åŸé¡¹ç›®åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ <code>virtual host</code>ï¼Œè€Œä¸æ˜¯ä½¿ç”¨é»˜è®¤çš„<code>/</code>ã€‚<font color="red">PSï¼šæ³¨æ„ hmall å‰é¢æœ‰ä¸ª <code>/</code> </font></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%88%9B%E5%BB%BA%E5%8D%95%E7%8B%AC%E7%9A%84virtual%20host.png" alt="åˆ›å»ºå•ç‹¬çš„virtual host"></p>
<p>åˆ›å»ºå®Œæˆåå¦‚å›¾ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%88%9B%E5%BB%BA%E5%8D%95%E7%8B%AC%E7%9A%84virtual%20host%E5%AE%8C%E6%88%90.png" alt="åˆ›å»ºå•ç‹¬çš„virtual hostå®Œæˆ"></p>
<p>ç”±äºæˆ‘ä»¬æ˜¯ç™»å½• <code>hmall</code> è´¦æˆ·ååˆ›å»ºçš„ <code>virtual host</code>ï¼Œå› æ­¤å›åˆ° <code>users</code> èœå•ï¼Œä½ ä¼šå‘ç°å½“å‰ç”¨æˆ·å·²ç»å…·å¤‡äº†å¯¹ <code>/hmall</code> è¿™ä¸ª<code>virtual host</code> çš„è®¿é—®æƒé™äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%85%B7%E5%A4%87%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90.png" alt="å…·å¤‡è®¿é—®æƒé™"></p>
<p>æ­¤æ—¶ï¼Œç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ <code>virtual host</code> ä¸‹æ‹‰èœå•ï¼Œåˆ‡æ¢ <code>virtual host</code> ä¸º  <code>/hmall</code>ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%88%87%E6%8D%A2virtual%20host.png" alt="åˆ‡æ¢virtual host"></p>
<p>ç„¶åå†æ¬¡æŸ¥çœ‹ <code>Queues</code> é€‰é¡¹å¡ï¼Œä¼šå‘ç°ä¹‹å‰çš„é˜Ÿåˆ—å·²ç»çœ‹ä¸åˆ°äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E9%98%9F%E5%88%97%E5%88%97%E8%A1%A8.png" alt="é˜Ÿåˆ—åˆ—è¡¨"></p>
<p>è¿™å°±æ˜¯åŸºäº<code>virtual host </code>çš„éš”ç¦»æ•ˆæœã€‚</p>
<h1 id="3-SpringAMQP"><a href="#3-SpringAMQP" class="headerlink" title="3. SpringAMQP"></a>3. SpringAMQP</h1><p>å°†æ¥æˆ‘ä»¬å¼€å‘ä¸šåŠ¡åŠŸèƒ½çš„æ—¶å€™ï¼Œè‚¯å®šä¸ä¼šåœ¨æ§åˆ¶å°æ”¶å‘æ¶ˆæ¯ï¼Œè€Œæ˜¯åº”è¯¥åŸºäºç¼–ç¨‹çš„æ–¹å¼ã€‚ç”±äº<code>RabbitMQ</code>é‡‡ç”¨äº†AMQPåè®®ï¼Œå› æ­¤å®ƒå…·å¤‡è·¨è¯­è¨€çš„ç‰¹æ€§ã€‚ä»»ä½•è¯­è¨€åªè¦éµå¾ª AMQP åè®®æ”¶å‘æ¶ˆæ¯ï¼Œéƒ½å¯ä»¥ä¸ RabbitMQ äº¤äº’ã€‚å¹¶ä¸” RabbitMQ å®˜æ–¹ä¹Ÿæä¾›äº†å„ç§ä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯ã€‚</p>
<p>ä½†æ˜¯ï¼ŒRabbitMQ å®˜æ–¹æä¾›çš„ Java å®¢æˆ·ç«¯ç¼–ç ç›¸å¯¹å¤æ‚ï¼Œä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä¸‹æˆ‘ä»¬æ›´å¤šä¼šç»“åˆ Spring æ¥ä½¿ç”¨ã€‚è€Œ Spring çš„å®˜æ–¹åˆšå¥½åŸºäºRabbitMQ æä¾›äº†è¿™æ ·ä¸€å¥—æ¶ˆæ¯æ”¶å‘çš„æ¨¡æ¿å·¥å…·ï¼šSpringAMQPã€‚å¹¶ä¸”è¿˜åŸºäº SpringBoot å¯¹å…¶å®ç°äº†è‡ªåŠ¨è£…é…ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚</p>
<p>SpringAMQP çš„å®˜æ–¹åœ°å€ï¼š<a href="https://spring.io/projects/spring-amqp/">https://spring.io/projects/spring-amqp/</a></p>
<p>SpringAMQP æä¾›äº†ä¸‰ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>è‡ªåŠ¨å£°æ˜é˜Ÿåˆ—ã€äº¤æ¢æœºåŠå…¶ç»‘å®šå…³ç³»</li>
<li>åŸºäºæ³¨è§£çš„ç›‘å¬å™¨æ¨¡å¼ï¼Œå¼‚æ­¥æ¥æ”¶æ¶ˆæ¯</li>
<li>å°è£…äº†RabbitTemplateå·¥å…·ï¼Œç”¨äºå‘é€æ¶ˆæ¯</li>
</ul>
<p>è¿™ä¸€ç« æˆ‘ä»¬å°±ä¸€èµ·å­¦ä¹ ä¸€ä¸‹ï¼Œå¦‚ä½•åˆ©ç”¨ SpringAMQP å®ç°å¯¹ RabbitMQ çš„æ¶ˆæ¯æ”¶å‘ã€‚</p>
<h2 id="3-1-å¯¼å…¥Demoå·¥ç¨‹"><a href="#3-1-å¯¼å…¥Demoå·¥ç¨‹" class="headerlink" title="3.1 å¯¼å…¥Demoå·¥ç¨‹"></a>3.1 å¯¼å…¥Demoå·¥ç¨‹</h2><p>é¡¹ç›®ç»“æ„å¦‚å›¾ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Demo%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" alt="Demoé¡¹ç›®ç»“æ„"></p>
<p>åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li>mq-demoï¼šçˆ¶å·¥ç¨‹ï¼Œç®¡ç†é¡¹ç›®ä¾èµ–</li>
<li>publisherï¼šæ¶ˆæ¯çš„å‘é€è€…</li>
<li>consumerï¼šæ¶ˆæ¯çš„æ¶ˆè´¹è€…</li>
</ul>
<p>åœ¨ <code>mq-demo</code> è¿™ä¸ªçˆ¶å·¥ç¨‹ä¸­ï¼Œå·²ç»é…ç½®å¥½äº† SpringAMQP ç›¸å…³çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.itcast.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mq-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>publisher<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>consumer<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--AMQPä¾èµ–ï¼ŒåŒ…å«RabbitMQ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å•å…ƒæµ‹è¯•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å› æ­¤ï¼Œå­å·¥ç¨‹ä¸­å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ SpringAMQP äº†ã€‚</p>
<h2 id="3-2-å¿«é€Ÿå…¥é—¨"><a href="#3-2-å¿«é€Ÿå…¥é—¨" class="headerlink" title="3.2 å¿«é€Ÿå…¥é—¨"></a>3.2 å¿«é€Ÿå…¥é—¨</h2><p>åœ¨ä¹‹å‰çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç»è¿‡äº¤æ¢æœºå‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œä¸è¿‡æœ‰æ—¶å€™ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼Œè·³è¿‡äº¤æ¢æœºã€‚</p>
<p>åœ¨å…¥é—¨æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°±æ¼”ç¤ºè¿™æ ·çš„ç®€å•æ¨¡å‹ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/MQ%E7%AE%80%E5%8D%95%E6%A8%A1%E5%9E%8B.jpeg" alt="MQç®€å•æ¨¡å‹"></p>
<p>ä¹Ÿå°±æ˜¯ï¼š</p>
<ul>
<li>publisherç›´æ¥å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—</li>
<li>æ¶ˆè´¹è€…ç›‘å¬å¹¶å¤„ç†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</li>
</ul>
<p>æ³¨æ„ï¼šè¿™ç§æ¨¡å¼ä¸€èˆ¬æµ‹è¯•ä½¿ç”¨ï¼Œå¾ˆå°‘åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘ä»¬ç°åœ¨æ§åˆ¶å°æ–°å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼š<code>simple.queue</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%96%B0%E5%BB%BA%E9%98%9F%E5%88%97simple.queue.png" alt="æ–°å»ºé˜Ÿåˆ—simple.queue" style="zoom:67%;">

<p>æ·»åŠ æˆåŠŸï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E9%98%9F%E5%88%97simple.queue.png" alt="é˜Ÿåˆ—simple.queue"></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ Java ä»£ç æ”¶å‘æ¶ˆæ¯äº†ã€‚</p>
<h3 id="3-1-1-æ¶ˆæ¯å‘é€"><a href="#3-1-1-æ¶ˆæ¯å‘é€" class="headerlink" title="3.1.1 æ¶ˆæ¯å‘é€"></a>3.1.1 æ¶ˆæ¯å‘é€</h3><p>é¦–å…ˆé…ç½® MQ åœ°å€ï¼Œåœ¨ <code>publisher</code> æœåŠ¡çš„ <code>application.yml</code> ä¸­æ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.88</span><span class="number">.132</span> <span class="comment"># ä½ çš„è™šæ‹ŸæœºIP</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span> <span class="comment"># ç«¯å£</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/hmall</span> <span class="comment"># è™šæ‹Ÿä¸»æœº</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">hmall</span> <span class="comment"># ç”¨æˆ·å</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123</span> <span class="comment"># å¯†ç </span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨ <code>publisher</code> æœåŠ¡ä¸­ç¼–å†™æµ‹è¯•ç±» <code>SpringAmqpTest</code>ï¼Œå¹¶åˆ©ç”¨ <code>RabbitTemplate</code> å®ç°æ¶ˆæ¯å‘é€ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.publisher.amqp;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringAmqpTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSimpleQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;simple.queue&quot;</span>;</span><br><span class="line">        <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;hello, spring amqp!&quot;</span>;</span><br><span class="line">        <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">        rabbitTemplate.convertAndSend(queueName, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æ¶ˆæ¯å·²ç»å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E5%B7%B2%E7%BB%8F%E5%8F%91%E9%80%81%E5%88%B0%E9%98%9F%E5%88%97.png" alt="æ¶ˆæ¯å·²ç»å‘é€åˆ°é˜Ÿåˆ—"></p>
<h3 id="3-1-2-æ¶ˆæ¯æ¥æ”¶"><a href="#3-1-2-æ¶ˆæ¯æ¥æ”¶" class="headerlink" title="3.1.2 æ¶ˆæ¯æ¥æ”¶"></a>3.1.2 æ¶ˆæ¯æ¥æ”¶</h3><p>é¦–å…ˆé…ç½® MQ åœ°å€ï¼Œåœ¨ <code>consumer</code> æœåŠ¡çš„ <code>application.yml</code> ä¸­æ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.88</span><span class="number">.132</span> <span class="comment"># ä½ çš„è™šæ‹ŸæœºIP</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span> <span class="comment"># ç«¯å£</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/hmall</span> <span class="comment"># è™šæ‹Ÿä¸»æœº</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">hmall</span> <span class="comment"># ç”¨æˆ·å</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123</span> <span class="comment"># å¯†ç </span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨ <code>consumer</code> æœåŠ¡çš„ <code>com.muyoukule.consumer.listener</code> åŒ…ä¸­æ–°å»ºä¸€ä¸ªç±» <code>SpringRabbitListener</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.listener;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitListener</span> &#123;</span><br><span class="line">	<span class="comment">// åˆ©ç”¨RabbitListeneræ¥å£°æ˜è¦ç›‘å¬çš„é˜Ÿåˆ—ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// å°†æ¥ä¸€æ—¦ç›‘å¬çš„é˜Ÿåˆ—ä¸­æœ‰äº†æ¶ˆæ¯ï¼Œå°±ä¼šæ¨é€ç»™å½“å‰æœåŠ¡ï¼Œè°ƒç”¨å½“å‰æ–¹æ³•ï¼Œå¤„ç†æ¶ˆæ¯ã€‚</span></span><br><span class="line">    <span class="comment">// å¯ä»¥çœ‹åˆ°æ–¹æ³•ä½“ä¸­æ¥æ”¶çš„å°±æ˜¯æ¶ˆæ¯ä½“çš„å†…å®¹</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;simple.queue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenSimpleQueueMessage</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;spring æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>å¯åŠ¨ <code>consumer</code> æœåŠ¡ï¼Œç„¶ååœ¨ <code>publisher</code> æœåŠ¡ä¸­è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå‘é€ MQ æ¶ˆæ¯ã€‚æœ€ç»ˆ <code>consumer</code> æ”¶åˆ°æ¶ˆæ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, spring amqp!ã€‘</span><br></pre></td></tr></table></figure>

<h2 id="3-3-WorkQueuesæ¨¡å‹"><a href="#3-3-WorkQueuesæ¨¡å‹" class="headerlink" title="3.3 WorkQueuesæ¨¡å‹"></a>3.3 WorkQueuesæ¨¡å‹</h2><p>Work queuesï¼Œä»»åŠ¡æ¨¡å‹ã€‚ç®€å•æ¥è¯´å°±æ˜¯<strong>è®©å¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…±åŒæ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</strong>ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/WorkQueues%E6%A8%A1%E5%9E%8B.png" alt="WorkQueuesæ¨¡å‹"></p>
<p>å½“æ¶ˆæ¯å¤„ç†æ¯”è¾ƒè€—æ—¶çš„æ—¶å€™ï¼Œå¯èƒ½ç”Ÿäº§æ¶ˆæ¯çš„é€Ÿåº¦ä¼šè¿œè¿œå¤§äºæ¶ˆæ¯çš„æ¶ˆè´¹é€Ÿåº¦ã€‚é•¿æ­¤ä»¥å¾€ï¼Œæ¶ˆæ¯å°±ä¼šå †ç§¯è¶Šæ¥è¶Šå¤šï¼Œæ— æ³•åŠæ—¶å¤„ç†ã€‚</p>
<p>æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ work æ¨¡å‹ï¼Œ<strong>å¤šä¸ªæ¶ˆè´¹è€…å…±åŒå¤„ç†æ¶ˆæ¯å¤„ç†ï¼Œæ¶ˆæ¯å¤„ç†çš„é€Ÿåº¦å°±èƒ½å¤§å¤§æé«˜</strong>äº†ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥æ¨¡æ‹Ÿè¿™æ ·çš„åœºæ™¯ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°åˆ›å»ºä¸€ä¸ªæ–°çš„é˜Ÿåˆ—ï¼Œå‘½åä¸º <code>work.queue</code>ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%96%B0%E5%BB%BAwork.queue.png" alt="æ–°å»ºwork.queue"></p>
<h3 id="3-3-1-æ¶ˆæ¯å‘é€"><a href="#3-3-1-æ¶ˆæ¯å‘é€" class="headerlink" title="3.3.1 æ¶ˆæ¯å‘é€"></a>3.3.1 æ¶ˆæ¯å‘é€</h3><p>è¿™æ¬¡æˆ‘ä»¬å¾ªç¯å‘é€ï¼Œæ¨¡æ‹Ÿå¤§é‡æ¶ˆæ¯å †ç§¯ç°è±¡ã€‚</p>
<p>åœ¨ <code>publisher</code> æœåŠ¡ä¸­çš„ <code>SpringAmqpTest</code> ç±»ä¸­æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * workQueue</span></span><br><span class="line"><span class="comment"> * å‘é˜Ÿåˆ—ä¸­ä¸åœå‘é€æ¶ˆæ¯ï¼Œæ¨¡æ‹Ÿæ¶ˆæ¯å †ç§¯ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWorkQueue</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;work.queue&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;hello, message_&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// å‘é€æ¶ˆæ¯ï¼Œæ¯20æ¯«ç§’å‘é€ä¸€æ¬¡ï¼Œç›¸å½“äºæ¯ç§’å‘é€50æ¡æ¶ˆæ¯</span></span><br><span class="line">        rabbitTemplate.convertAndSend(queueName, message + i);</span><br><span class="line">        Thread.sleep(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2-æ¶ˆæ¯æ¥æ”¶"><a href="#3-3-2-æ¶ˆæ¯æ¥æ”¶" class="headerlink" title="3.3.2 æ¶ˆæ¯æ¥æ”¶"></a>3.3.2 æ¶ˆæ¯æ¥æ”¶</h3><p>è¦æ¨¡æ‹Ÿå¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬åœ¨ <code>consumer</code> æœåŠ¡çš„ <code>SpringRabbitListener</code> ä¸­æ·»åŠ 2ä¸ªæ–°çš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;work.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenWorkQueue1</span><span class="params">(String msg)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span> + Localtime.now());</span><br><span class="line">    Thread.sleep(<span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;work.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenWorkQueue2</span><span class="params">(String msg)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    System.err.println(<span class="string">&quot;æ¶ˆè´¹è€…2........æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span> + Localtime.now());</span><br><span class="line">    Thread.sleep(<span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°è¿™ä¸¤æ¶ˆè´¹è€…ï¼Œéƒ½è®¾ç½®äº† <code>Thead.sleep</code>ï¼Œæ¨¡æ‹Ÿä»»åŠ¡è€—æ—¶ï¼š</p>
<ul>
<li>æ¶ˆè´¹è€…1 sleepäº†20æ¯«ç§’ï¼Œç›¸å½“äºæ¯ç§’é’Ÿå¤„ç† 50 ä¸ªæ¶ˆæ¯</li>
<li>æ¶ˆè´¹è€…2 sleepäº†200æ¯«ç§’ï¼Œç›¸å½“äºæ¯ç§’å¤„ç† 5 ä¸ªæ¶ˆæ¯</li>
</ul>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>å¯åŠ¨ <code>ConsumerApplication</code> åï¼Œåœ¨æ‰§è¡Œ publisher æœåŠ¡ä¸­åˆšåˆšç¼–å†™çš„å‘é€æµ‹è¯•æ–¹æ³• <code>testWorkQueue</code>ã€‚</p>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_0ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.536087700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_1ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.551980600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_3ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.613422600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_5ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.675505600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_7ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.736149700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_2ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.750059700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_9ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.798666</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_11ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.858968900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_13ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.921156200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_4ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.964499700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_15ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">09.981896500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_17ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.042619700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_19ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.104275100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_21ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.165434600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_6ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.178848100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_23ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.225494800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_25ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.287941400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_27ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.349246100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_8ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.393275300</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_29ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.409556700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_31ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.471235500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_33ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.532975600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_35ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.594234</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_10ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.608551200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_37ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.655375500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_39ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.716239400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_41ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.777315</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_12ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.822535300</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_43ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.838913400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_45ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.900169200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_47ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">10.961616800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_49ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.022953200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_14ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.037243800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_16ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.251656100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_18ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.465585400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_20ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.665810700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_22ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">11.880131200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_24ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">12.094026700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_26ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">12.309042400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_28ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">12.523591600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_30ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">12.724700700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_32ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">12.939740200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_34ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">13.141516900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_36ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">13.354740500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_38ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">13.555752900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_40ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">13.771193800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_42ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">13.984944100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_44ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">14.198056</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_46ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">14.412763700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_48ã€‘<span class="number">13</span>:<span class="number">32</span>:<span class="number">14.627655600</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ¶ˆè´¹è€… 1 å’Œæ¶ˆè´¹è€… 2 ç«Ÿç„¶æ¯äººæ¶ˆè´¹äº† 25 æ¡æ¶ˆæ¯ï¼š</p>
<ul>
<li>æ¶ˆè´¹è€…1å¾ˆå¿«å®Œæˆäº†è‡ªå·±çš„ 25 æ¡æ¶ˆæ¯</li>
<li>æ¶ˆè´¹è€… 2 å´åœ¨ç¼“æ…¢çš„å¤„ç†è‡ªå·±çš„ 25 æ¡æ¶ˆæ¯ã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´æ¶ˆæ¯æ˜¯å¹³å‡åˆ†é…ç»™æ¯ä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘åˆ°æ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ã€‚å¯¼è‡´ 1 ä¸ªæ¶ˆè´¹è€…ç©ºé—²ï¼Œå¦ä¸€ä¸ªæ¶ˆè´¹è€…å¿™çš„ä¸å¯å¼€äº¤ã€‚æ²¡æœ‰å……åˆ†åˆ©ç”¨æ¯ä¸€ä¸ªæ¶ˆè´¹è€…çš„èƒ½åŠ›ï¼Œæœ€ç»ˆæ¶ˆæ¯å¤„ç†çš„è€—æ—¶è¿œè¿œè¶…è¿‡äº†1ç§’ã€‚è¿™æ ·æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚</p>
<h3 id="3-3-3-èƒ½è€…å¤šåŠ³"><a href="#3-3-3-èƒ½è€…å¤šåŠ³" class="headerlink" title="3.3.3 èƒ½è€…å¤šåŠ³"></a>3.3.3 èƒ½è€…å¤šåŠ³</h3><p>åœ¨ spring ä¸­æœ‰ä¸€ä¸ªç®€å•çš„é…ç½®ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¿®æ”¹ <code>consumer</code> æœåŠ¡çš„ <code>application.yml</code> æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">prefetch:</span> <span class="number">1</span> <span class="comment"># æ¯æ¬¡åªèƒ½è·å–ä¸€æ¡æ¶ˆæ¯ï¼Œå¤„ç†å®Œæˆæ‰èƒ½è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯</span></span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æµ‹è¯•ï¼Œå‘ç°ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_0ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.160102800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_1ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.181459500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_2ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.212252400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_3ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.243198500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_4ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.273495200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_5ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.304288600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_6ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.334585200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_7ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.366371400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_8ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.396668300</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_9ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.427462</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_10ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.458255100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_11ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.489047900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_12ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.519842500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_13ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.550635400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_14ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.581428100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_15ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.612221700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_16ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.643014600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_17ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.674304900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_18ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.704601200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_19ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.735394900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_20ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.766188100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_21ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.796458</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_22ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.830668700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_23ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.858482500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_24ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.888778200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_25ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.920069300</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_26ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.950364900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_27ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">42.981163300</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_28ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.011454900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_29ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.042248</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_30ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.073042600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_31ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.103835100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_32ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.134628400</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_33ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.165923</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_34ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.196219900</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_35ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.227505100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_36ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.259292700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_37ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.289091200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_38ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.319387700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_39ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.350181800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_40ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.380978800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_41ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.411920700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_42ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.443211600</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_43ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.474500800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_44ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.504301700</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_45ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.535094800</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_46ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.565888200</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_47ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.596681100</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">1</span>æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_48ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.627474500</span></span><br><span class="line">æ¶ˆè´¹è€…<span class="number">2.</span>.......æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€hello, message_49ã€‘<span class="number">13</span>:<span class="number">35</span>:<span class="number">43.658764100</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œç”±äºæ¶ˆè´¹è€… 1 å¤„ç†é€Ÿåº¦è¾ƒå¿«ï¼Œæ‰€ä»¥å¤„ç†äº†æ›´å¤šçš„æ¶ˆæ¯ï¼›æ¶ˆè´¹è€… 2 å¤„ç†é€Ÿåº¦è¾ƒæ…¢ï¼Œåªå¤„ç†äº† 6 æ¡æ¶ˆæ¯ã€‚è€Œæœ€ç»ˆæ€»çš„æ‰§è¡Œè€—æ—¶ä¹Ÿåœ¨ 1 ç§’å·¦å³ï¼Œå¤§å¤§æå‡ã€‚</p>
<p>æ­£æ‰€è°“èƒ½è€…å¤šåŠ³ï¼Œè¿™æ ·å……åˆ†åˆ©ç”¨äº†æ¯ä¸€ä¸ªæ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…æ¶ˆæ¯ç§¯å‹é—®é¢˜ã€‚</p>
<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>Work æ¨¡å‹çš„ä½¿ç”¨ï¼š</p>
<ul>
<li>å¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒåŒä¸€æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†</li>
<li>é€šè¿‡è®¾ç½®prefetchæ¥æ§åˆ¶æ¶ˆè´¹è€…é¢„å–çš„æ¶ˆæ¯æ•°é‡</li>
</ul>
<h2 id="3-4-äº¤æ¢æœºç±»å‹"><a href="#3-4-äº¤æ¢æœºç±»å‹" class="headerlink" title="3.4 äº¤æ¢æœºç±»å‹"></a>3.4 äº¤æ¢æœºç±»å‹</h2><p>åœ¨ä¹‹å‰çš„ä¸¤ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œéƒ½æ²¡æœ‰äº¤æ¢æœºï¼Œç”Ÿäº§è€…ç›´æ¥å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ã€‚è€Œä¸€æ—¦å¼•å…¥äº¤æ¢æœºï¼Œæ¶ˆæ¯å‘é€çš„æ¨¡å¼ä¼šæœ‰å¾ˆå¤§å˜åŒ–ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81%E6%A8%A1%E5%BC%8F%E5%BC%95%E5%85%A5%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="æ¶ˆæ¯å‘é€æ¨¡å¼å¼•å…¥äº¤æ¢æœº"><br>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®¢é˜…æ¨¡å‹ä¸­ï¼Œå¤šäº†ä¸€ä¸ª Exchange è§’è‰²ï¼Œè€Œä¸”è¿‡ç¨‹ç•¥æœ‰å˜åŒ–ï¼š</p>
<ul>
<li><strong>Publisher</strong>ï¼šç”Ÿäº§è€…ï¼Œä¸å†å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å‘ç»™äº¤æ¢æœº</li>
<li><strong>Exchange</strong>ï¼šäº¤æ¢æœºï¼Œä¸€æ–¹é¢ï¼Œæ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒçŸ¥é“å¦‚ä½•å¤„ç†æ¶ˆæ¯ï¼Œä¾‹å¦‚é€’äº¤ç»™æŸä¸ªç‰¹åˆ«é˜Ÿåˆ—ã€é€’äº¤ç»™æ‰€æœ‰é˜Ÿåˆ—ã€æˆ–æ˜¯å°†æ¶ˆæ¯ä¸¢å¼ƒã€‚åˆ°åº•å¦‚ä½•æ“ä½œï¼Œå–å†³äº Exchange çš„ç±»å‹ã€‚</li>
<li><strong>Queue</strong>ï¼šæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿä¸ä»¥å‰ä¸€æ ·ï¼Œæ¥æ”¶æ¶ˆæ¯ã€ç¼“å­˜æ¶ˆæ¯ã€‚ä¸è¿‡é˜Ÿåˆ—ä¸€å®šè¦ä¸äº¤æ¢æœºç»‘å®šã€‚</li>
<li><strong>Consumer</strong>ï¼šæ¶ˆè´¹è€…ï¼Œä¸ä»¥å‰ä¸€æ ·ï¼Œè®¢é˜…é˜Ÿåˆ—ï¼Œæ²¡æœ‰å˜åŒ–</li>
</ul>
<p><strong>Exchange (äº¤æ¢æœº)åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸å…·å¤‡å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›</strong>ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰ä»»ä½•é˜Ÿåˆ—ä¸ Exchange ç»‘å®šï¼Œæˆ–è€…æ²¡æœ‰ç¬¦åˆè·¯ç”±è§„åˆ™çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šä¸¢å¤±ï¼</p>
<p>äº¤æ¢æœºçš„ç±»å‹æœ‰å››ç§ï¼š</p>
<ul>
<li><strong>Fanout</strong>ï¼šå¹¿æ’­ï¼Œå°†æ¶ˆæ¯äº¤ç»™æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—ã€‚æˆ‘ä»¬æœ€æ—©åœ¨æ§åˆ¶å°ä½¿ç”¨çš„æ­£æ˜¯Fanoutäº¤æ¢æœº</li>
<li><strong>Direct</strong>ï¼šè®¢é˜…ï¼ŒåŸºäº RoutingKey (è·¯ç”± key )å‘é€ç»™è®¢é˜…äº†æ¶ˆæ¯çš„é˜Ÿåˆ—</li>
<li><strong>Topic</strong>ï¼šé€šé…ç¬¦è®¢é˜…ï¼Œä¸ Direct ç±»ä¼¼ï¼Œåªä¸è¿‡ RoutingKey å¯ä»¥ä½¿ç”¨é€šé…ç¬¦</li>
<li><strong>Headers</strong>ï¼šå¤´åŒ¹é…ï¼ŒåŸºäº MQ çš„æ¶ˆæ¯å¤´åŒ¹é…ï¼Œç”¨çš„è¾ƒå°‘ã€‚</li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬è®²è§£å‰é¢çš„ä¸‰ç§äº¤æ¢æœºæ¨¡å¼ã€‚</p>
<h2 id="3-5-Fanoutäº¤æ¢æœº"><a href="#3-5-Fanoutäº¤æ¢æœº" class="headerlink" title="3.5 Fanoutäº¤æ¢æœº"></a>3.5 Fanoutäº¤æ¢æœº</h2><p>Fanoutï¼Œè‹±æ–‡ç¿»è¯‘æ˜¯æ‰‡å‡ºï¼Œæˆ‘è§‰å¾—åœ¨ MQ ä¸­å«å¹¿æ’­æ›´åˆé€‚ã€‚</p>
<p>åœ¨å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯å‘é€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%B9%BF%E6%92%AD%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81%E6%B5%81%E7%A8%8B.png" alt="å¹¿æ’­æ¨¡å¼ä¸‹æ¶ˆæ¯å‘é€æµç¨‹"></p>
<ul>
<li>Â å¯ä»¥æœ‰å¤šä¸ªé˜Ÿåˆ—</li>
<li>æ¯ä¸ªé˜Ÿåˆ—éƒ½è¦ç»‘å®šåˆ° Exchange (äº¤æ¢æœº)</li>
<li>ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œåªèƒ½å‘é€åˆ°äº¤æ¢æœº</li>
<li>æœºæŠŠæ¶ˆæ¯å‘é€ç»™ç»‘å®šè¿‡çš„æ‰€æœ‰é˜Ÿåˆ—</li>
<li>è®¢é˜…é˜Ÿåˆ—çš„æ¶ˆè´¹è€…éƒ½èƒ½æ‹¿åˆ°æ¶ˆæ¯</li>
</ul>
<p><strong>æ¡ˆä¾‹éœ€æ±‚å¦‚å›¾ï¼š</strong><br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Fanout%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%9C%80%E6%B1%82%E6%A1%88%E4%BE%8B.png" alt="Fanoutäº¤æ¢æœºéœ€æ±‚æ¡ˆä¾‹"></p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªåä¸º <code>hmall.fanout</code> çš„äº¤æ¢æœºï¼Œç±»å‹æ˜¯ <code>Fanout</code></li>
<li>åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ— <code>fanout.queue1 </code> å’Œ <code>fanout.queue2</code>ï¼Œç»‘å®šåˆ°äº¤æ¢æœº <code>hmall.fanout</code></li>
</ul>
<h3 id="3-5-1-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"><a href="#3-5-1-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº" class="headerlink" title="3.5.1 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"></a>3.5.1 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº</h3><p>åœ¨æ§åˆ¶å°åˆ›å»ºé˜Ÿåˆ— <code>fanout.queue1</code>ï¼Œåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—  <code>fanout.queue2</code>ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº <code>hmall.fanout</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%A3%B0%E6%98%8EFanout%E9%98%9F%E5%88%97%E5%92%8C%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="å£°æ˜Fanouté˜Ÿåˆ—å’Œäº¤æ¢æœº" style="zoom:67%;">

<p>ç„¶åç»‘å®šä¸¤ä¸ªé˜Ÿåˆ—åˆ°äº¤æ¢æœºï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E7%BB%91%E5%AE%9Afanout.queue1%E9%98%9F%E5%88%97%E5%88%B0%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="ç»‘å®šfanout.queue1é˜Ÿåˆ—åˆ°äº¤æ¢æœº" style="zoom:67%;">
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E7%BB%91%E5%AE%9Afanout.queue2%E9%98%9F%E5%88%97%E5%88%B0%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="ç»‘å®šfanout.queue2é˜Ÿåˆ—åˆ°äº¤æ¢æœº" style="zoom:67%;">


<h3 id="3-5-2-æ¶ˆæ¯å‘é€"><a href="#3-5-2-æ¶ˆæ¯å‘é€" class="headerlink" title="3.5.2 æ¶ˆæ¯å‘é€"></a>3.5.2 æ¶ˆæ¯å‘é€</h3><p>åœ¨ <code>publisher</code> æœåŠ¡çš„ <code>SpringAmqpTest</code> ç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFanoutExchange</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;hmall.fanout&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;hello, everyone!&quot;</span>;</span><br><span class="line">    rabbitTemplate.convertAndSend(exchangeName, <span class="string">&quot;&quot;</span>, message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-5-3-æ¶ˆæ¯æ¥æ”¶"><a href="#3-5-3-æ¶ˆæ¯æ¥æ”¶" class="headerlink" title="3.5.3 æ¶ˆæ¯æ¥æ”¶"></a>3.5.3 æ¶ˆæ¯æ¥æ”¶</h3><p>åœ¨ <code>consumer</code> æœåŠ¡çš„ <code>SpringRabbitListener</code> ä¸­æ·»åŠ ä¸¤ä¸ªæ–¹æ³•ï¼Œä½œä¸ºæ¶ˆè´¹è€…ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;fanout.queue1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenFanoutQueue1</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;fanout.queue2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenFanoutQueue2</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…2æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€hello, everyone!ã€‘</span><br><span class="line">æ¶ˆè´¹è€…1æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€hello, everyone!ã€‘</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>äº¤æ¢æœºçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>æ¥æ”¶ publisher å‘é€çš„æ¶ˆæ¯</li>
<li>å°†æ¶ˆæ¯æŒ‰ç…§è§„åˆ™è·¯ç”±åˆ°ä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—</li>
<li>ä¸èƒ½ç¼“å­˜æ¶ˆæ¯ï¼Œè·¯ç”±å¤±è´¥ï¼Œæ¶ˆæ¯ä¸¢å¤±</li>
<li>FanoutExchange çš„ä¼šå°†æ¶ˆæ¯è·¯ç”±åˆ°æ¯ä¸ªç»‘å®šçš„é˜Ÿåˆ—</li>
</ul>
<h2 id="3-6-Directäº¤æ¢æœº"><a href="#3-6-Directäº¤æ¢æœº" class="headerlink" title="3.6 Directäº¤æ¢æœº"></a>3.6 Directäº¤æ¢æœº</h2><p>åœ¨ Fanout æ¨¡å¼ä¸­ï¼Œä¸€æ¡æ¶ˆæ¯ï¼Œä¼šè¢«æ‰€æœ‰è®¢é˜…çš„é˜Ÿåˆ—éƒ½æ¶ˆè´¹ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸åŒçš„æ¶ˆæ¯è¢«ä¸åŒçš„é˜Ÿåˆ—æ¶ˆè´¹ã€‚è¿™æ—¶å°±è¦ç”¨åˆ° Direct ç±»å‹çš„ Exchangeã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Direct%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="Directäº¤æ¢æœº"></p>
<p>åœ¨ Direct æ¨¡å‹ä¸‹ï¼š</p>
<ul>
<li>é˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šï¼Œä¸èƒ½æ˜¯ä»»æ„ç»‘å®šäº†ï¼Œè€Œæ˜¯è¦æŒ‡å®šä¸€ä¸ª <code>RoutingKey</code> (è·¯ç”± key )</li>
<li>æ¶ˆæ¯çš„å‘é€æ–¹åœ¨ å‘ Exchange å‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¿…é¡»æŒ‡å®šæ¶ˆæ¯çš„ <code>RoutingKey</code></li>
<li>Exchangeä¸å†æŠŠæ¶ˆæ¯äº¤ç»™æ¯ä¸€ä¸ªç»‘å®šçš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„ <code>Routing Key</code> è¿›è¡Œåˆ¤æ–­ï¼Œåªæœ‰é˜Ÿåˆ—çš„ <code>Routingkey</code> ä¸æ¶ˆæ¯çš„ <code>Routing key</code> å®Œå…¨ä¸€è‡´ï¼Œæ‰ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯</li>
</ul>
<p><strong>æ¡ˆä¾‹éœ€æ±‚å¦‚å›¾ï¼š</strong></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Direct%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%9C%80%E6%B1%82%E6%A1%88%E4%BE%8B.png" alt="Directäº¤æ¢æœºéœ€æ±‚æ¡ˆä¾‹"></p>
<ul>
<li>å£°æ˜ä¸€ä¸ªåä¸º <code>hmall.direct</code> çš„äº¤æ¢æœº</li>
<li>å£°æ˜é˜Ÿåˆ— <code>direct.queue1</code>ï¼Œç»‘å®š <code>hmall.direct</code>ï¼Œ<code>bindingKey </code>ä¸º <code>blud </code>å’Œ <code>red</code></li>
<li>å£°æ˜é˜Ÿåˆ— <code>direct.queue2</code>ï¼Œç»‘å®š <code>hmall.direct</code>ï¼Œ<code>bindingKey</code> ä¸º <code>yellow</code>å’Œ <code>red</code></li>
<li>åœ¨<code>consumer</code>æœåŠ¡ä¸­ï¼Œç¼–å†™ä¸¤ä¸ªæ¶ˆè´¹è€…æ–¹æ³•ï¼Œåˆ†åˆ«ç›‘å¬ <code>direct.queue1</code> å’Œ <code>direct.queue2</code> </li>
<li>åœ¨ publisher ä¸­ç¼–å†™æµ‹è¯•æ–¹æ³•ï¼Œå‘ <code>hmall.direct</code> å‘é€æ¶ˆæ¯</li>
</ul>
<h3 id="3-6-1-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"><a href="#3-6-1-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº" class="headerlink" title="3.6.1 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"></a>3.6.1 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº</h3><p>é¦–å…ˆåœ¨æ§åˆ¶å°å£°æ˜ä¸¤ä¸ªé˜Ÿåˆ— <code>direct.queue1</code> å’Œ <code>direct.queue2 </code>ï¼Œè¿™é‡Œä¸å†å±•ç¤ºè¿‡ç¨‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%A3%B0%E6%98%8EDirect%E9%98%9F%E5%88%97%E5%92%8C%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="å£°æ˜Directé˜Ÿåˆ—å’Œäº¤æ¢æœº"></p>
<p>ç„¶åå£°æ˜ä¸€ä¸ª Direct ç±»å‹çš„äº¤æ¢æœºï¼Œå‘½åä¸º <code>hmall.direct</code>ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Direct%E4%BA%A4%E6%8D%A2%E6%9C%BAhmall.direct.png" alt="Directäº¤æ¢æœºhmall.direct"></p>
<p>ç„¶åä½¿ç”¨ <code>red  </code> å’Œ <code>blue  </code> ä½œä¸º keyï¼Œç»‘å®š <code>direct.queue1 </code>åˆ°  <code>hmall.direct</code>ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BD%BF%E7%94%A8red%E4%BD%9C%E4%B8%BAkey%E7%BB%91%E5%AE%9Adirect.queue1.png" alt="ä½¿ç”¨redä½œä¸ºkeyç»‘å®šdirect.queue1"><br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E4%BD%BF%E7%94%A8blue%E4%BD%9C%E4%B8%BAkey%E7%BB%91%E5%AE%9Adirect.queue1.png" alt="ä½¿ç”¨blueä½œä¸ºkeyç»‘å®šdirect.queue1"></p>
<p>åŒç†ï¼Œä½¿ç”¨ <code>red </code> å’Œ <code>yellow   </code>ä½œä¸º keyï¼Œç»‘å®š <code>direct.queue2</code> åˆ° <code>hmall.direct</code>ï¼Œæ­¥éª¤ç•¥ï¼Œæœ€ç»ˆç»“æœï¼š<br><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/hmall.direct%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%BB%91%E5%AE%9A%E7%BB%93%E6%9E%9C.png" alt="hmall.directäº¤æ¢æœºç»‘å®šç»“æœ"></p>
<h3 id="3-6-2-æ¶ˆæ¯æ¥æ”¶"><a href="#3-6-2-æ¶ˆæ¯æ¥æ”¶" class="headerlink" title="3.6.2 æ¶ˆæ¯æ¥æ”¶"></a>3.6.2 æ¶ˆæ¯æ¥æ”¶</h3><p>åœ¨ <code>consumer</code> æœåŠ¡çš„ <code>SpringRabbitListener</code> ä¸­æ·»åŠ æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;direct.queue1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenDirectQueue1</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;direct.queue2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenDirectQueue2</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°direct.queue2çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="3-6-3-æ¶ˆæ¯å‘é€"><a href="#3-6-3-æ¶ˆæ¯å‘é€" class="headerlink" title="3.6.3 æ¶ˆæ¯å‘é€"></a>3.6.3 æ¶ˆæ¯å‘é€</h3><p>åœ¨ <code>publisher</code> æœåŠ¡çš„ <code>SpringAmqpTest</code> ç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendDirectExchange</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;hmall.direct&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;çº¢è‰²è­¦æŠ¥ï¼æ—¥æœ¬ä¹±æ’æ ¸åºŸæ°´ï¼Œå¯¼è‡´æµ·æ´‹ç”Ÿç‰©å˜å¼‚ï¼ŒæƒŠç°å“¥æ–¯æ‹‰ï¼&quot;</span>;</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(exchangeName, <span class="string">&quot;red&quot;</span>, message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±äºä½¿ç”¨çš„ <code>red</code> è¿™ä¸ª keyï¼Œæ‰€ä»¥ä¸¤ä¸ªæ¶ˆè´¹è€…éƒ½æ”¶åˆ°äº†æ¶ˆæ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…2æ¥æ”¶åˆ°direct.queue2çš„æ¶ˆæ¯ï¼šã€çº¢è‰²è­¦æŠ¥ï¼æ—¥æœ¬ä¹±æ’æ ¸åºŸæ°´ï¼Œå¯¼è‡´æµ·æ´‹ç”Ÿç‰©å˜å¼‚ï¼ŒæƒŠç°å“¥æ–¯æ‹‰ï¼ã€‘</span><br><span class="line">æ¶ˆè´¹è€…1æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€çº¢è‰²è­¦æŠ¥ï¼æ—¥æœ¬ä¹±æ’æ ¸åºŸæ°´ï¼Œå¯¼è‡´æµ·æ´‹ç”Ÿç‰©å˜å¼‚ï¼ŒæƒŠç°å“¥æ–¯æ‹‰ï¼ã€‘</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å†åˆ‡æ¢ä¸º <code>blue</code> è¿™ä¸ª keyï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendDirectExchange</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;hmall.direct&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;æœ€æ–°æŠ¥é“ï¼Œå“¥æ–¯æ‹‰æ˜¯å±…æ°‘è‡ªæ²»å·¨å‹æ°”çƒï¼Œè™šæƒŠä¸€åœºï¼&quot;</span>;</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(exchangeName, <span class="string">&quot;blue&quot;</span>, message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼šå‘ç°ï¼Œåªæœ‰æ¶ˆè´¹è€… 1 æ”¶åˆ°äº†æ¶ˆæ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…1æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€æœ€æ–°æŠ¥é“ï¼Œå“¥æ–¯æ‹‰æ˜¯å±…æ°‘è‡ªæ²»å·¨å‹æ°”çƒï¼Œè™šæƒŠä¸€åœºï¼ã€‘</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>æè¿°ä¸‹ Direct äº¤æ¢æœºä¸ Fanout äº¤æ¢æœºçš„å·®å¼‚ï¼Ÿ</p>
<ul>
<li>Fanout äº¤æ¢æœºå°†æ¶ˆæ¯è·¯ç”±ç»™æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—</li>
<li>Directäº¤æ¢æœºæ ¹æ® RoutingKey åˆ¤æ–­è·¯ç”±ç»™å“ªä¸ªé˜Ÿåˆ—</li>
<li>å¦‚æœå¤šä¸ªé˜Ÿåˆ—å…·æœ‰ç›¸åŒçš„ RoutingKeyï¼Œåˆ™ä¸ Fanout åŠŸèƒ½ç±»ä¼¼</li>
</ul>
<h2 id="3-7-Topicäº¤æ¢æœº"><a href="#3-7-Topicäº¤æ¢æœº" class="headerlink" title="3.7 Topicäº¤æ¢æœº"></a>3.7 Topicäº¤æ¢æœº</h2><h3 id="3-7-1-è¯´æ˜"><a href="#3-7-1-è¯´æ˜" class="headerlink" title="3.7.1 è¯´æ˜"></a>3.7.1 è¯´æ˜</h3><p><code>Topic</code> ç±»å‹çš„ <code>Exchange</code> ä¸ <code>Direct</code> ç›¸æ¯”ï¼Œéƒ½æ˜¯å¯ä»¥æ ¹æ® <code>RoutingKey</code> æŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ã€‚</p>
<p>åªä¸è¿‡ <code>Topic</code> ç±»å‹ <code>Exchange</code> å¯ä»¥è®©é˜Ÿåˆ—åœ¨ç»‘å®š <code>BindingKey</code> çš„æ—¶å€™ä½¿ç”¨é€šé…ç¬¦ï¼</p>
<p><code>BindingKey</code> ä¸€èˆ¬éƒ½æ˜¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯ç»„æˆï¼Œå¤šä¸ªå•è¯ä¹‹é—´ä»¥  <code>. </code> åˆ†å‰²ï¼Œä¾‹å¦‚ï¼š <code>item.insert</code></p>
<p>é€šé…ç¬¦è§„åˆ™ï¼š</p>
<ul>
<li><code>#</code>ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯</li>
<li><code>*</code>ï¼šåŒ¹é…ä¸å¤šä¸å°‘æ°å¥½1ä¸ªè¯</li>
</ul>
<p>ä¸¾ä¾‹ï¼š</p>
<ul>
<li><code>item.#</code>ï¼šèƒ½å¤ŸåŒ¹é… <code>item.spu.insert</code> æˆ–è€… <code>item.spu</code></li>
<li><code>item.*</code>ï¼šåªèƒ½åŒ¹é… <code>item.spu</code></li>
</ul>
<p>å›¾ç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Topic%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="Topicäº¤æ¢æœº"></p>
<p>å‡å¦‚æ­¤æ—¶ publisher å‘é€çš„æ¶ˆæ¯ä½¿ç”¨çš„ <code>RoutingKey</code> å…±æœ‰å››ç§ï¼š</p>
<ul>
<li><code>china.news </code> ä»£è¡¨æœ‰ä¸­å›½çš„æ–°é—»æ¶ˆæ¯ï¼›</li>
<li><code>china.weather</code> ä»£è¡¨ä¸­å›½çš„å¤©æ°”æ¶ˆæ¯ï¼›</li>
<li><code>japan.news</code> åˆ™ä»£è¡¨æ—¥æœ¬æ–°é—»</li>
<li><code>japan.weather</code> ä»£è¡¨æ—¥æœ¬çš„å¤©æ°”æ¶ˆæ¯ï¼›</li>
</ul>
<p>è§£é‡Šï¼š</p>
<ul>
<li><code>topic.queue1</code>ï¼šç»‘å®šçš„æ˜¯ <code>china.#</code> ï¼Œå‡¡æ˜¯ä»¥ <code>china.</code>å¼€å¤´çš„ <code>routing key</code> éƒ½ä¼šè¢«åŒ¹é…åˆ°ï¼ŒåŒ…æ‹¬ï¼š<ul>
<li><code>china.news</code></li>
<li><code>china.weather</code></li>
</ul>
</li>
<li><code>topic.queue2</code>ï¼šç»‘å®šçš„æ˜¯ <code>#.news</code> ï¼Œå‡¡æ˜¯ä»¥ <code>.news </code>ç»“å°¾çš„ <code>routing key</code> éƒ½ä¼šè¢«åŒ¹é…ã€‚åŒ…æ‹¬:<ul>
<li><code>china.news</code></li>
<li><code>japan.news</code></li>
</ul>
</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æŒ‰ç…§ä¸Šå›¾æ‰€ç¤ºï¼Œæ¥æ¼”ç¤ºä¸€ä¸‹ Topic äº¤æ¢æœºçš„ç”¨æ³•ã€‚</p>
<p>é¦–å…ˆï¼Œåœ¨æ§åˆ¶å°æŒ‰ç…§å›¾ç¤ºä¾‹å­åˆ›å»ºé˜Ÿåˆ—ã€äº¤æ¢æœºï¼Œå¹¶åˆ©ç”¨é€šé…ç¬¦ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœºã€‚æ­¤å¤„æ­¥éª¤ç•¥ã€‚æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E5%88%A9%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%92%8C%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="åˆ©ç”¨é€šé…ç¬¦ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº"></p>
<h3 id="3-7-2-æ¶ˆæ¯å‘é€"><a href="#3-7-2-æ¶ˆæ¯å‘é€" class="headerlink" title="3.7.2 æ¶ˆæ¯å‘é€"></a>3.7.2 æ¶ˆæ¯å‘é€</h3><p>åœ¨ publisher æœåŠ¡çš„ <code>SpringAmqpTest</code> ç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * topicExchange</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendTopicExchange</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;hmall.topic&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!&quot;</span>;</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(exchangeName, <span class="string">&quot;china.news&quot;</span>, message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-7-3-æ¶ˆæ¯æ¥æ”¶"><a href="#3-7-3-æ¶ˆæ¯æ¥æ”¶" class="headerlink" title="3.7.3 æ¶ˆæ¯æ¥æ”¶"></a>3.7.3 æ¶ˆæ¯æ¥æ”¶</h3><p>åœ¨ <code>consumer</code> æœåŠ¡çš„ <code>SpringRabbitListener</code> ä¸­æ·»åŠ æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;topic.queue1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenTopicQueue1</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;topic.queue2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenTopicQueue2</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…2æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!ã€‘</span><br><span class="line">æ¶ˆè´¹è€…1æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!ã€‘</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å†åˆ‡æ¢ä¸º <code>china.message</code> è¿™ä¸ª key æµ‹è¯•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…1æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!ã€‘</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å†åˆ‡æ¢ä¸º <code>chengdu.news</code> è¿™ä¸ª key æµ‹è¯•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¶ˆè´¹è€…2æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!ã€‘</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<p>æè¿°ä¸‹ Direct äº¤æ¢æœºä¸ Topic äº¤æ¢æœºçš„å·®å¼‚ï¼Ÿ</p>
<ul>
<li>Topic äº¤æ¢æœºæ¥æ”¶çš„æ¶ˆæ¯ RoutingKey å¯ä»¥æ˜¯å¤šä¸ªå•è¯ï¼Œä»¥ <code>**.**</code> åˆ†å‰²</li>
<li>Topicäº¤æ¢æœºä¸é˜Ÿåˆ—ç»‘å®šæ—¶çš„ bindingKey å¯ä»¥æŒ‡å®šé€šé…ç¬¦</li>
<li><code>#</code>ï¼šä»£è¡¨0ä¸ªæˆ–å¤šä¸ªè¯</li>
<li><code>*</code>ï¼šä»£è¡¨1ä¸ªè¯</li>
</ul>
<h2 id="3-8-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"><a href="#3-8-å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº" class="headerlink" title="3.8 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº"></a>3.8 å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº</h2><p>åœ¨ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯åŸºäº RabbitMQ æ§åˆ¶å°æ¥åˆ›å»ºé˜Ÿåˆ—ã€äº¤æ¢æœºã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘æ—¶ï¼Œé˜Ÿåˆ—å’Œäº¤æ¢æœºæ˜¯ç¨‹åºå‘˜å®šä¹‰çš„ï¼Œå°†æ¥é¡¹ç›®ä¸Šçº¿ï¼Œåˆè¦äº¤ç»™è¿ç»´å»åˆ›å»ºã€‚é‚£ä¹ˆç¨‹åºå‘˜å°±éœ€è¦æŠŠç¨‹åºä¸­è¿è¡Œçš„æ‰€æœ‰é˜Ÿåˆ—å’Œäº¤æ¢æœºéƒ½å†™ä¸‹æ¥ï¼Œäº¤ç»™è¿ç»´ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¾ˆå®¹æ˜“å‡ºç°é”™è¯¯çš„ã€‚</p>
<p>å› æ­¤æ¨èçš„åšæ³•æ˜¯ç”±ç¨‹åºå¯åŠ¨æ—¶æ£€æŸ¥é˜Ÿåˆ—å’Œäº¤æ¢æœºæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»ºã€‚</p>
<h3 id="3-8-1-åŸºæœ¬API"><a href="#3-8-1-åŸºæœ¬API" class="headerlink" title="3.8.1 åŸºæœ¬API"></a>3.8.1 åŸºæœ¬API</h3><p>SpringAMQP æä¾›äº†ä¸€ä¸ª Queue ç±»ï¼Œç”¨æ¥åˆ›å»ºé˜Ÿåˆ—ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Queue</span> <span class="keyword">extends</span> <span class="title class_">AbstractDeclarable</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SpringAMQP è¿˜æä¾›äº†ä¸€ä¸ª <code>Exchange</code> æ¥å£ï¼Œæ¥è¡¨ç¤ºæ‰€æœ‰ä¸åŒç±»å‹çš„äº¤æ¢æœºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/Exchange%E6%8E%A5%E5%8F%A3.png" alt="Exchangeæ¥å£"></p>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºé˜Ÿåˆ—å’Œäº¤æ¢æœºï¼Œä¸è¿‡ SpringAMQP è¿˜æä¾›äº† <code>ExchangeBuilder</code> æ¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/ExchangeBuilder.png" alt="ExchangeBuilder"></p>
<p>è€Œåœ¨ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœºæ—¶ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>BindingBuilder</code> æ¥åˆ›å»º Binding å¯¹è±¡ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/BindingBuilder%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="BindingBuilderä¸­çš„æ–¹æ³•"></p>
<h3 id="3-8-2-Fanoutç¤ºä¾‹"><a href="#3-8-2-Fanoutç¤ºä¾‹" class="headerlink" title="3.8.2 Fanoutç¤ºä¾‹"></a>3.8.2 Fanoutç¤ºä¾‹</h3><p>åœ¨ <code>consumer</code> ä¸­åˆ›å»ºä¸€ä¸ªç±»ï¼Œå£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutConfig</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Fanoutç±»å‹äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FanoutExchange <span class="title function_">fanoutExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FanoutExchange</span>(<span class="string">&quot;hmall.fanout&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¬¬1ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">fanoutQueue1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;fanout.queue1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue1</span><span class="params">(Queue fanoutQueue1, FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(fanoutQueue1).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¬¬2ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">fanoutQueue2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;fanout.queue2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue2</span><span class="params">(Queue fanoutQueue2, FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(fanoutQueue2).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-8-3-Directç¤ºä¾‹"><a href="#3-8-3-Directç¤ºä¾‹" class="headerlink" title="3.8.3 Directç¤ºä¾‹"></a>3.8.3 Directç¤ºä¾‹</h3><p>Direct æ¨¡å¼ç”±äºè¦ç»‘å®šå¤šä¸ª Keyï¼Œä¼šéå¸¸éº»çƒ¦ï¼Œæ¯ä¸€ä¸ª Key éƒ½è¦ç¼–å†™ä¸€ä¸ª bindingï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.consumer.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Directç±»å‹äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">directExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.directExchange(<span class="string">&quot;hmall.direct&quot;</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¬¬1ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">directQueue1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;direct.queue1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue1WithRed</span><span class="params">(Queue directQueue1, DirectExchange directExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue1).to(directExchange).with(<span class="string">&quot;red&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue1WithBlue</span><span class="params">(Queue directQueue1, DirectExchange directExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue1).to(directExchange).with(<span class="string">&quot;blue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¬¬2ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">directQueue2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;direct.queue2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue2WithRed</span><span class="params">(Queue directQueue2, DirectExchange directExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue2).to(directExchange).with(<span class="string">&quot;red&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueue2WithYellow</span><span class="params">(Queue directQueue2, DirectExchange directExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue2).to(directExchange).with(<span class="string">&quot;yellow&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-8-4-åŸºäºæ³¨è§£å£°æ˜"><a href="#3-8-4-åŸºäºæ³¨è§£å£°æ˜" class="headerlink" title="3.8.4 åŸºäºæ³¨è§£å£°æ˜"></a>3.8.4 åŸºäºæ³¨è§£å£°æ˜</h3><p>åŸºäº <code>@Bean</code> çš„æ–¹å¼å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºæ¯”è¾ƒéº»çƒ¦ï¼ŒSpring è¿˜æä¾›äº†åŸºäºæ³¨è§£æ–¹å¼æ¥å£°æ˜ã€‚<font color="red">PSï¼šä¸è¦å¯¼é”™åŒ…äº†å“¦ï¼Œæ˜¯æ³¨è§£ç±»å‹çš„åŒ…</font>ğŸ˜€</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬åŒæ ·å£°æ˜ Direct æ¨¡å¼çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">        value = @Queue(name = &quot;direct.queue1&quot;),</span></span><br><span class="line"><span class="meta">        exchange = @Exchange(name = &quot;hmall.direct&quot;, type = ExchangeTypes.DIRECT),</span></span><br><span class="line"><span class="meta">        key = &#123;&quot;red&quot;, &quot;blue&quot;&#125;</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenDirectQueue1</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">        value = @Queue(name = &quot;direct.queue2&quot;),</span></span><br><span class="line"><span class="meta">        exchange = @Exchange(name = &quot;hmall.direct&quot;, type = ExchangeTypes.DIRECT),</span></span><br><span class="line"><span class="meta">        key = &#123;&quot;red&quot;, &quot;yellow&quot;&#125;</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenDirectQueue2</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°direct.queue2çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸æ˜¯ç®€å•å¤šäº†ã€‚</p>
<p>å†è¯•è¯• Topic æ¨¡å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">        value = @Queue(name = &quot;topic.queue1&quot;),</span></span><br><span class="line"><span class="meta">        exchange = @Exchange(name = &quot;hmall.topic&quot;, type = ExchangeTypes.TOPIC),</span></span><br><span class="line"><span class="meta">        key = &quot;china.#&quot;</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenTopicQueue1</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">        value = @Queue(name = &quot;topic.queue2&quot;),</span></span><br><span class="line"><span class="meta">        exchange = @Exchange(name = &quot;hmall.topic&quot;, type = ExchangeTypes.TOPIC),</span></span><br><span class="line"><span class="meta">        key = &quot;#.news&quot;</span></span><br><span class="line"><span class="meta">))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenTopicQueue2</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="3-9-æ¶ˆæ¯è½¬æ¢å™¨"><a href="#3-9-æ¶ˆæ¯è½¬æ¢å™¨" class="headerlink" title="3.9 æ¶ˆæ¯è½¬æ¢å™¨"></a>3.9 æ¶ˆæ¯è½¬æ¢å™¨</h2><p>Spring çš„æ¶ˆæ¯å‘é€ä»£ç æ¥æ”¶çš„æ¶ˆæ¯ä½“æ˜¯ä¸€ä¸ª Objectï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/%E6%8E%A5%E6%94%B6%E7%9A%84Object.png" alt="æ¥æ”¶çš„Object"></p>
<p>è€Œåœ¨æ•°æ®ä¼ è¾“æ—¶ï¼Œå®ƒä¼šæŠŠä½ å‘é€çš„æ¶ˆæ¯åºåˆ—åŒ–ä¸ºå­—èŠ‚å‘é€ç»™ MQï¼Œæ¥æ”¶æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿˜ä¼šæŠŠå­—èŠ‚ååºåˆ—åŒ–ä¸º Java å¯¹è±¡ã€‚</p>
<p>åªä¸è¿‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ Spring é‡‡ç”¨çš„åºåˆ—åŒ–æ–¹å¼æ˜¯ JDK åºåˆ—åŒ–ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒJDK åºåˆ—åŒ–å­˜åœ¨ä¸‹åˆ—é—®é¢˜ï¼š</p>
<ul>
<li>æ•°æ®ä½“ç§¯è¿‡å¤§</li>
<li>æœ‰å®‰å…¨æ¼æ´</li>
<li>å¯è¯»æ€§å·®</li>
</ul>
<p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<h3 id="3-9-1-æµ‹è¯•é»˜è®¤è½¬æ¢å™¨"><a href="#3-9-1-æµ‹è¯•é»˜è®¤è½¬æ¢å™¨" class="headerlink" title="3.9.1 æµ‹è¯•é»˜è®¤è½¬æ¢å™¨"></a>3.9.1 æµ‹è¯•é»˜è®¤è½¬æ¢å™¨</h3><p>1ã€åˆ›å»ºæµ‹è¯•é˜Ÿåˆ—</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ <code>consumer</code> æœåŠ¡ä¸­å£°æ˜ä¸€ä¸ªæ–°çš„é…ç½®ç±» <code>MessageConfig</code>ï¼Œåˆ©ç”¨ <code>@Bean</code> çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…·ä½“ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">objectQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;object.queue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆä¸è¦ç»™è¿™ä¸ªé˜Ÿåˆ—æ·»åŠ æ¶ˆè´¹è€…ï¼Œæˆ‘ä»¬è¦æŸ¥çœ‹æ¶ˆæ¯ä½“çš„æ ¼å¼ã€‚</p>
<p>é‡å¯ <code>consumer</code> æœåŠ¡ä»¥åï¼Œè¯¥é˜Ÿåˆ—å°±ä¼šè¢«è‡ªåŠ¨åˆ›å»ºå‡ºæ¥äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/object.queue%E9%98%9F%E5%88%97.png" alt="object.queueé˜Ÿåˆ—"></p>
<p>2ã€å‘é€æ¶ˆæ¯</p>
<p>æˆ‘ä»¬åœ¨ publisher æ¨¡å—çš„ <code>SpringAmqpTest</code> ä¸­æ–°å¢ä¸€ä¸ªæ¶ˆæ¯å‘é€çš„ä»£ç ï¼Œå‘é€ä¸€ä¸ª Map å¯¹è±¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSendMap</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// å‡†å¤‡æ¶ˆæ¯</span></span><br><span class="line">    Map&lt;String, Object&gt; msg = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    msg.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;æŸ³å²©&quot;</span>);</span><br><span class="line">    msg.put(<span class="string">&quot;age&quot;</span>, <span class="number">21</span>);</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(<span class="string">&quot;object.queue&quot;</span>, msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€å‘é€æ¶ˆæ¯åæŸ¥çœ‹æ§åˆ¶å°ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/JDK%E5%BA%8F%E5%88%97%E5%8C%96%E6%B6%88%E6%81%AF.png" alt=" JDKåºåˆ—åŒ–æ¶ˆæ¯"></p>
<p>å¯ä»¥çœ‹åˆ°æ¶ˆæ¯æ ¼å¼éå¸¸ä¸å‹å¥½ã€‚</p>
<h3 id="3-9-2-é…ç½®JSONè½¬æ¢å™¨"><a href="#3-9-2-é…ç½®JSONè½¬æ¢å™¨" class="headerlink" title="3.9.2 é…ç½®JSONè½¬æ¢å™¨"></a>3.9.2 é…ç½®JSONè½¬æ¢å™¨</h3><p>æ˜¾ç„¶ï¼ŒJDK åºåˆ—åŒ–æ–¹å¼å¹¶ä¸åˆé€‚ã€‚æˆ‘ä»¬å¸Œæœ›æ¶ˆæ¯ä½“çš„ä½“ç§¯æ›´å°ã€å¯è¯»æ€§æ›´é«˜ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ JSON æ–¹å¼æ¥åšåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p>
<p>1ã€åœ¨çˆ¶å·¥ç¨‹å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--jackson--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>PSï¼šå¦‚æœé¡¹ç›®ä¸­å¼•å…¥äº† <code>spring-boot-starter-web</code> ä¾èµ–ï¼Œåˆ™æ— éœ€å†æ¬¡å¼•å…¥ <code>Jackson</code> ä¾èµ–ã€‚</p>
<p>2ã€é…ç½®æ¶ˆæ¯è½¬æ¢å™¨ï¼Œåœ¨ <code>publisher </code>å’Œ <code>consumer</code> ä¸¤ä¸ªæœåŠ¡çš„å¯åŠ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ª Bean å³å¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MessageConverter <span class="title function_">messageConverter</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1.å®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line">    <span class="type">Jackson2JsonMessageConverter</span> <span class="variable">jackson2JsonMessageConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonMessageConverter</span>();</span><br><span class="line">    <span class="comment">// 2.é…ç½®è‡ªåŠ¨åˆ›å»ºæ¶ˆæ¯idï¼Œç”¨äºè¯†åˆ«ä¸åŒæ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸šåŠ¡ä¸­åŸºäºIDåˆ¤æ–­æ˜¯å¦æ˜¯é‡å¤æ¶ˆæ¯</span></span><br><span class="line">    jackson2JsonMessageConverter.setCreateMessageIds(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> jackson2JsonMessageConverter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¶ˆæ¯è½¬æ¢å™¨ä¸­æ·»åŠ çš„ messageId å¯ä»¥ä¾¿äºæˆ‘ä»¬å°†æ¥åšå¹‚ç­‰æ€§åˆ¤æ–­ã€‚</p>
<p>3ã€æ­¤æ—¶ï¼Œå†æ¬¡æ‰§è¡Œåˆšæ‰çš„æ¶ˆæ¯å‘é€çš„ä»£ç ï¼Œåˆ° RabbitMQ çš„æ§åˆ¶å°æŸ¥çœ‹æ¶ˆæ¯ç»“æ„(Get messages å¡« <code>2</code> ) ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/MQIMG/RabbitMQ/RabbitMQ%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E6%B6%88%E6%81%AF%E7%BB%93%E6%9E%84.png" alt="RabbitMQæ§åˆ¶å°æŸ¥çœ‹æ¶ˆæ¯ç»“æ„" style="zoom: 80%;">

<p>å¯¹æ¯”å‘ç°æ•°æ®ä½“ç§¯å°äº†å¾ˆå¤šã€‚</p>
<h3 id="3-9-3-æ¶ˆè´¹è€…æ¥æ”¶Object"><a href="#3-9-3-æ¶ˆè´¹è€…æ¥æ”¶Object" class="headerlink" title="3.9.3 æ¶ˆè´¹è€…æ¥æ”¶Object"></a>3.9.3 æ¶ˆè´¹è€…æ¥æ”¶Object</h3><p>æˆ‘ä»¬åœ¨consumeræœåŠ¡ä¸­å®šä¹‰ä¸€ä¸ªæ–°çš„æ¶ˆè´¹è€…ï¼Œpublisheræ˜¯ç”¨ Map å‘é€ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…ä¹Ÿä¸€å®šè¦ç”¨ Map æ¥æ”¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RabbitListener(queues = &quot;object.queue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenSimpleQueueMessage</span><span class="params">(Map&lt;String, Object&gt; msg)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°object.queueæ¶ˆæ¯ï¼šã€&quot;</span> + msg + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ä¼šå‘ç°æ¥æ”¶ç¬¬ä¸€æ¡æ¶ˆæ¯æŠ¥é”™ï¼Œç¬¬äºŒæ¡æ¶ˆæ¯æ­£å¸¸ã€‚ä½†æ˜¯å›åˆ° RabbitMQ æ§åˆ¶å°å‘ç°ç¬¬ä¸€æ¡æ¶ˆæ¯æ¶ˆå¤±äº†ï¼Œè¯´æ˜ç¬¬ä¸€æ¡æ¶ˆæ¯ä¸¢å¤±äº†ã€‚</p>
<p>æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p>
<p>è¯·å‚è€ƒæ–‡ç«  <code>RabbitMQé«˜çº§</code> ğŸ˜</p>
]]></content>
      <categories>
        <category>MQ</category>
      </categories>
      <tags>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬8ã€9ã€10ç« ã€‘ æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½ã€å¼‚å¸¸å¤„ç†å™¨ã€æ‹¦æˆªå™¨</title>
    <url>/posts/SpringMVC-Chapter-EightAndNineAndTen-File-Upload-And-Download-Exception-Handler-Interceptor/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="ç¬¬8ç« -æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½"><a href="#ç¬¬8ç« -æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½" class="headerlink" title="ç¬¬8ç«  æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½"></a>ç¬¬8ç«  æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½</h1><h2 id="1-æ–‡ä»¶ä¸Šä¼ "><a href="#1-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="1. æ–‡ä»¶ä¸Šä¼ "></a>1. æ–‡ä»¶ä¸Šä¼ </h2><p>ä½¿ç”¨SpringMVC6ç‰ˆæœ¬ï¼Œ<strong>ä¸éœ€è¦</strong>æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1ã€å‰ç«¯é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸Šä¼ è¡¨å•--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/file/up&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    æ–‡ä»¶ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fileName&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><font color="red">PSï¼šformè¡¨å•é‡‡ç”¨postè¯·æ±‚ï¼Œenctypeæ˜¯<code>multipart/form-data</code>ï¼Œå¹¶ä¸”ä¸Šä¼ ç»„ä»¶æ˜¯ï¼š<code>type=&quot;file&quot;</code></font></p>
<p>2ã€web.xmlæ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">multipart-config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è®¾ç½®å•ä¸ªæ”¯æŒæœ€å¤§æ–‡ä»¶çš„å¤§å°--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">max-file-size</span>&gt;</span>102400<span class="tag">&lt;/<span class="name">max-file-size</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è®¾ç½®æ•´ä¸ªè¡¨å•æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ çš„æœ€å¤§å€¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">max-request-size</span>&gt;</span>102400<span class="tag">&lt;/<span class="name">max-request-size</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è®¾ç½®æœ€å°ä¸Šä¼ æ–‡ä»¶å¤§å°--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file-size-threshold</span>&gt;</span>0<span class="tag">&lt;/<span class="name">file-size-threshold</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">multipart-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><font color="red"><strong>PSï¼šåœ¨DispatcherServleté…ç½®æ—¶ï¼Œæ·»åŠ  multipart-config é…ç½®ä¿¡æ¯ã€‚ï¼ˆè¿™æ˜¯Spring6ï¼Œå¦‚æœæ˜¯Spring5ï¼Œåˆ™ä¸æ˜¯è¿™æ ·é…ç½®ï¼Œè€Œæ˜¯åœ¨springmvc.xmlæ–‡ä»¶ä¸­é…ç½®ï¼šCommonsMultipartResolverï¼‰SpringMVC6ä¸­æŠŠè¿™ä¸ªç±»å·²ç»åˆ é™¤äº†ã€‚åºŸå¼ƒäº†ã€‚</strong></font></p>
<p>3ã€Controllerä¸­çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/file/up&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">fileUp</span><span class="params">(<span class="meta">@RequestParam(&quot;fileName&quot;)</span> MultipartFile multipartFile, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> multipartFile.getName();</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="comment">// è·å–æ–‡ä»¶å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> multipartFile.getOriginalFilename();</span><br><span class="line">        System.out.println(originalFilename);</span><br><span class="line">        <span class="comment">// å°†æ–‡ä»¶å­˜å‚¨åˆ°æœåŠ¡å™¨ä¸­</span></span><br><span class="line">        <span class="comment">// è·å–è¾“å…¥æµ</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> multipartFile.getInputStream();</span><br><span class="line">        <span class="comment">// è·å–ä¸Šä¼ ä¹‹åçš„å­˜æ”¾ç›®å½•</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>));</span><br><span class="line">        <span class="comment">// å¦‚æœæœåŠ¡å™¨ç›®å½•ä¸å­˜åœ¨åˆ™æ–°å»º</span></span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¼€å§‹å†™</span></span><br><span class="line">        <span class="comment">//BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(file.getAbsolutePath() + &quot;/&quot; + originalFilename));</span></span><br><span class="line">        <span class="comment">// å¯ä»¥é‡‡ç”¨UUIDæ¥ç”Ÿæˆæ–‡ä»¶åï¼Œé˜²æ­¢æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶æ—¶äº§ç”Ÿè¦†ç›–</span></span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file.getAbsolutePath() + <span class="string">&quot;/&quot;</span> + UUID.randomUUID().toString() + originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>))));</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span> * <span class="number">100</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">readCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((readCount = in.read(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            out.write(bytes, <span class="number">0</span>, readCount);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ·æ–°ç¼“å†²æµ</span></span><br><span class="line">        out.flush();</span><br><span class="line">        <span class="comment">// å…³é—­æµ</span></span><br><span class="line">        in.close();</span><br><span class="line">        out.close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€æœ€ç»ˆæµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.png" alt="æµ‹è¯•æ–‡ä»¶ä¸Šä¼ "></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F.png" alt="æ–‡ä»¶ä¸Šä¼ æˆåŠŸ"></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9F%A5%E7%9C%8B%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%96%87%E4%BB%B6.png" alt="æŸ¥çœ‹ä¸Šä¼ çš„æ–‡ä»¶" style="zoom: 50%;">

<p><strong>å»ºè®®ï¼šä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶èµ·åé‡‡ç”¨UUIDã€‚ä»¥é˜²æ–‡ä»¶è¦†ç›–ã€‚</strong></p>
<h2 id="2-æ–‡ä»¶ä¸‹è½½"><a href="#2-æ–‡ä»¶ä¸‹è½½" class="headerlink" title="2. æ–‡ä»¶ä¸‹è½½"></a>2. æ–‡ä»¶ä¸‹è½½</h2><p>1ã€index.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸‹è½½--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/download&#125;&quot;</span>&gt;</span>æ–‡ä»¶ä¸‹è½½<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æ–‡ä»¶ä¸‹è½½æ ¸å¿ƒç¨‹åºï¼Œä½¿ç”¨<code>ResponseEntity</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;<span class="type">byte</span>[]&gt; downloadFile(HttpServletResponse response, HttpServletRequest request) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(request.getServletContext().getRealPath(<span class="string">&quot;/upload&quot;</span>) + <span class="string">&quot;/muyoukule.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºå“åº”å¤´å¯¹è±¡</span></span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å“åº”å†…å®¹ç±»å‹</span></span><br><span class="line">    headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸‹è½½æ–‡ä»¶çš„åç§°</span></span><br><span class="line">    headers.setContentDispositionFormData(<span class="string">&quot;attachment&quot;</span>, file.getName());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line">    ResponseEntity&lt;<span class="type">byte</span>[]&gt; entity = <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;<span class="type">byte</span>[]&gt;(Files.readAllBytes(file.toPath()), headers, HttpStatus.OK);</span><br><span class="line">    <span class="keyword">return</span> entity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD.png" alt="æµ‹è¯•æ–‡ä»¶ä¸‹è½½"></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9F%A5%E7%9C%8B%E4%B8%8B%E8%BD%BD%E7%9A%84%E6%96%87%E4%BB%B6.png" alt="æŸ¥çœ‹ä¸‹è½½çš„æ–‡ä»¶" style="zoom: 50%;">

<h1 id="ç¬¬9ç« -å¼‚å¸¸å¤„ç†å™¨"><a href="#ç¬¬9ç« -å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="ç¬¬9ç«  å¼‚å¸¸å¤„ç†å™¨"></a>ç¬¬9ç«  å¼‚å¸¸å¤„ç†å™¨</h1><h2 id="1-ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†å™¨"><a href="#1-ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†å™¨"></a>1. ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†å™¨</h2><p>Spring MVCåœ¨<code>å¤„ç†å™¨æ–¹æ³•</code>æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå¯ä»¥é‡‡ç”¨<code>å¼‚å¸¸å¤„ç†å™¨</code>è¿›è¡Œåº”å¯¹ã€‚<br>ä¸€å¥è¯æ¦‚æ‹¬å¼‚å¸¸å¤„ç†å™¨ä½œç”¨ï¼šå¤„ç†å™¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œè·³è½¬åˆ°å¯¹åº”çš„è§†å›¾ï¼Œåœ¨è§†å›¾ä¸Šå±•ç¤ºå‹å¥½ä¿¡æ¯ã€‚</p>
<p>SpringMVCä¸ºå¼‚å¸¸å¤„ç†æä¾›äº†ä¸€ä¸ªæ¥å£ï¼š<code>HandlerExceptionResolver</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.lang.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HandlerExceptionResolver</span> &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    ModelAndView <span class="title function_">resolveException</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> Object handler, Exception ex)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¸å¿ƒæ–¹æ³•æ˜¯ï¼š<code>resolveException</code>ã€‚</p>
<p>è¯¥æ–¹æ³•ç”¨æ¥ç¼–å†™å…·ä½“çš„å¼‚å¸¸å¤„ç†æ–¹æ¡ˆã€‚è¿”å›å€¼<code>ModelAndView</code>ï¼Œè¡¨ç¤ºå¼‚å¸¸å¤„ç†å®Œä¹‹åè·³è½¬åˆ°å“ªä¸ªè§†å›¾ã€‚</p>
<p>HandlerExceptionResolver æ¥å£æœ‰ä¸¤ä¸ªå¸¸ç”¨çš„é»˜è®¤å®ç°ï¼š</p>
<ul>
<li><code>DefaultHandlerExceptionResolver</code></li>
<li><code>SimpleMappingExceptionResolver</code></li>
</ul>
<h2 id="2-é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨"><a href="#2-é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="2. é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨"></a>2. é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨</h2><p><code>DefaultHandlerExceptionResolver</code> æ˜¯é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p>
<p>æ ¸å¿ƒæ–¹æ³•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/DefaultHandlerExceptionResolver%E7%9A%84%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95.png" alt="DefaultHandlerExceptionResolverçš„æ ¸å¿ƒæ–¹æ³•"></p>
<p>å½“è¯·æ±‚æ–¹å¼å’Œå¤„ç†æ–¹å¼ä¸åŒæ—¶ï¼Œ<code>DefaultHandlerExceptionResolver</code>çš„é»˜è®¤å¤„ç†æ€åº¦æ˜¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/DefaultHandlerExceptionResolver%E9%9D%A2%E5%AF%B9%E8%AF%B7%E6%B1%82%E5%92%8C%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E4%B8%8D%E5%90%8C%E7%9A%84%E9%BB%98%E8%AE%A4%E5%A4%84%E7%90%86%E6%80%81%E5%BA%A6.png" alt="DefaultHandlerExceptionResolveré¢å¯¹è¯·æ±‚å’Œå¤„ç†æ–¹å¼ä¸åŒçš„é»˜è®¤å¤„ç†æ€åº¦"></p>
<h2 id="3-è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨"><a href="#3-è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="3. è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨"></a>3. è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨</h2><p>è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨éœ€è¦ä½¿ç”¨ï¼š<code>SimpleMappingExceptionResolver</code></p>
<p>è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†æœºåˆ¶æœ‰ä¸¤ç§è¯­æ³•ï¼š</p>
<ul>
<li>é€šè¿‡XMLé…ç½®æ–‡ä»¶</li>
<li>é€šè¿‡æ³¨è§£</li>
</ul>
<h3 id="3-1-é…ç½®æ–‡ä»¶æ–¹å¼"><a href="#3-1-é…ç½®æ–‡ä»¶æ–¹å¼" class="headerlink" title="3.1 é…ç½®æ–‡ä»¶æ–¹å¼"></a>3.1 é…ç½®æ–‡ä»¶æ–¹å¼</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--ç”¨æ¥æŒ‡å®šå‡ºç°å¼‚å¸¸åï¼Œè·³è½¬çš„è§†å›¾--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;java.lang.Exception&quot;</span>&gt;</span>tip<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å°†å¼‚å¸¸ä¿¡æ¯å­˜å‚¨åˆ°requeståŸŸï¼Œvalueå±æ€§ç”¨æ¥æŒ‡å®šå­˜å‚¨æ—¶çš„keyã€‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionAttribute&quot;</span> <span class="attr">value</span>=<span class="string">&quot;e&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è§†å›¾é¡µé¢ä¸Šå±•ç¤ºå¼‚å¸¸ä¿¡æ¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å‡ºé”™äº†<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>å‡ºé”™äº†ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;e&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8.png" alt="è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨"></p>
<h3 id="3-2-æ³¨è§£æ–¹å¼"><a href="#3-2-æ³¨è§£æ–¹å¼" class="headerlink" title="3.2 æ³¨è§£æ–¹å¼"></a>3.2 æ³¨è§£æ–¹å¼</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">tip</span><span class="params">(Exception e, Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;e&quot;</span>, e);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;tip&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç¬¬10ç« -æ‹¦æˆªå™¨"><a href="#ç¬¬10ç« -æ‹¦æˆªå™¨" class="headerlink" title="ç¬¬10ç«  æ‹¦æˆªå™¨"></a>ç¬¬10ç«  æ‹¦æˆªå™¨</h1><h2 id="1-æ‹¦æˆªå™¨æ¦‚è¿°"><a href="#1-æ‹¦æˆªå™¨æ¦‚è¿°" class="headerlink" title="1. æ‹¦æˆªå™¨æ¦‚è¿°"></a>1. æ‹¦æˆªå™¨æ¦‚è¿°</h2><p><strong>æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ç±»ä¼¼äºè¿‡æ»¤å™¨ï¼ˆFilterï¼‰</strong></p>
<p>Spring MVCçš„æ‹¦æˆªå™¨ä½œç”¨æ˜¯åœ¨è¯·æ±‚åˆ°è¾¾æ§åˆ¶å™¨ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œæ‹¦æˆªï¼Œå¯ä»¥å¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œä¸€äº›ç‰¹å®šçš„å¤„ç†ã€‚</p>
<p>æ‹¦æˆªå™¨å¯ä»¥ç”¨äºå¾ˆå¤šåœºæ™¯ä¸‹ï¼š</p>
<ul>
<li>ç™»å½•éªŒè¯ï¼šå¯¹äºéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„ç½‘å€ï¼Œä½¿ç”¨æ‹¦æˆªå™¨å¯ä»¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼Œå¦‚æœæœªç™»å½•åˆ™è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚ </li>
<li>æƒé™æ ¡éªŒï¼šæ ¹æ®ç”¨æˆ·æƒé™å¯¹éƒ¨åˆ†ç½‘å€è¿›è¡Œè®¿é—®æ§åˆ¶ï¼Œæ‹’ç»æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®ã€‚ </li>
<li>è¯·æ±‚æ—¥å¿—ï¼šè®°å½•è¯·æ±‚ä¿¡æ¯ï¼Œä¾‹å¦‚è¯·æ±‚åœ°å€ã€è¯·æ±‚å‚æ•°ã€è¯·æ±‚æ—¶é—´ç­‰ï¼Œç”¨äºæ’æŸ¥é—®é¢˜å’Œæ€§èƒ½ä¼˜åŒ–ã€‚ </li>
<li>æ›´æ”¹å“åº”ï¼šå¯ä»¥å¯¹å“åº”çš„å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œä¾‹å¦‚æ·»åŠ å¤´ä¿¡æ¯ã€è°ƒæ•´å“åº”å†…å®¹æ ¼å¼ç­‰ã€‚</li>
</ul>
<p>æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„ä½œç”¨å±‚é¢ä¸åŒã€‚</p>
<ul>
<li>è¿‡æ»¤å™¨æ›´æ³¨é‡åœ¨è¯·æ±‚å’Œå“åº”çš„æµç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä¿®æ”¹è¯·æ±‚å’Œå“åº”çš„å†…å®¹ï¼Œä¾‹å¦‚è®¾ç½®ç¼–ç å’Œå­—ç¬¦é›†ã€è¯·æ±‚å¤´ã€çŠ¶æ€ç ç­‰ã€‚</li>
<li>æ‹¦æˆªå™¨åˆ™æ›´åŠ ä¾§é‡äºå¯¹æ§åˆ¶å™¨è¿›è¡Œå‰ç½®æˆ–åç½®å¤„ç†ï¼Œåœ¨è¯·æ±‚åˆ°è¾¾æ§åˆ¶å™¨ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œç‰¹å®šçš„æ“ä½œï¼Œä¾‹å¦‚æ‰“å°æ—¥å¿—ã€æƒé™éªŒè¯ç­‰ã€‚</li>
</ul>
<p><strong>Filterã€Servletã€Interceptorã€Controllerçš„æ‰§è¡Œé¡ºåºï¼š</strong></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Filter%E3%80%81Servlet%E3%80%81Interceptor%E3%80%81Controller%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" alt="Filterã€Servletã€Interceptorã€Controllerçš„æ‰§è¡Œé¡ºåº"></p>
<h2 id="2-æ‹¦æˆªå™¨çš„åˆ›å»ºä¸åŸºæœ¬é…ç½®"><a href="#2-æ‹¦æˆªå™¨çš„åˆ›å»ºä¸åŸºæœ¬é…ç½®" class="headerlink" title="2. æ‹¦æˆªå™¨çš„åˆ›å»ºä¸åŸºæœ¬é…ç½®"></a>2. æ‹¦æˆªå™¨çš„åˆ›å»ºä¸åŸºæœ¬é…ç½®</h2><h3 id="2-1-å®šä¹‰æ‹¦æˆªå™¨"><a href="#2-1-å®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="2.1 å®šä¹‰æ‹¦æˆªå™¨"></a>2.1 å®šä¹‰æ‹¦æˆªå™¨</h3><p>å®ç° <code>org.springframework.web.servlet.HandlerInterceptor</code> æ¥å£ï¼Œå…±æœ‰ä¸‰ä¸ªæ–¹æ³•å¯ä»¥è¿›è¡Œé€‰æ‹©æ€§çš„å®ç°ï¼š</p>
<ul>
<li>preHandleï¼šå¤„ç†å™¨æ–¹æ³•è°ƒç”¨ä¹‹å‰æ‰§è¡Œ<font color="red"><strong>ï¼ˆåªæœ‰è¯¥æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹ï¼Œtrueæ”¾è¡Œï¼Œfalseæ‹¦æˆªã€‚ï¼‰</strong></font></li>
<li>postHandleï¼šå¤„ç†å™¨æ–¹æ³•è°ƒç”¨ä¹‹åæ‰§è¡Œ</li>
<li>afterCompletionï¼šæ¸²æŸ“å®Œæˆåæ‰§è¡Œ</li>
</ul>
<h3 id="2-2-æ‹¦æˆªå™¨åŸºæœ¬é…ç½®"><a href="#2-2-æ‹¦æˆªå™¨åŸºæœ¬é…ç½®" class="headerlink" title="2.2 æ‹¦æˆªå™¨åŸºæœ¬é…ç½®"></a>2.2 æ‹¦æˆªå™¨åŸºæœ¬é…ç½®</h3><p>åœ¨springmvc.xmlæ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p>
<p>ç¬¬ä¸€ç§æ–¹å¼ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.muyoukule.interceptors.Interceptor1&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§æ–¹å¼ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor1&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§æ–¹å¼çš„å‰æï¼š</p>
<ul>
<li>å‰æ1ï¼šåŒ…æ‰«æ</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%8B%A6%E6%88%AA%E5%99%A8%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%89%8D%E6%8F%901.png" alt="æ‹¦æˆªå™¨åŸºæœ¬é…ç½®å‰æ1"></p>
<ul>
<li>å‰æ2ï¼šä½¿ç”¨ <code>@Component</code> æ³¨è§£è¿›è¡Œæ ‡æ³¨</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%8B%A6%E6%88%AA%E5%99%A8%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%89%8D%E6%8F%902.png" alt="æ‹¦æˆªå™¨åŸºæœ¬é…ç½®å‰æ1"></p>
<p><font color="red"><strong>PSï¼šå¯¹äºè¿™ç§åŸºæœ¬é…ç½®æ¥è¯´ï¼Œæ‹¦æˆªå™¨æ˜¯æ‹¦æˆªæ‰€æœ‰è¯·æ±‚çš„ã€‚</strong></font></p>
<h3 id="2-3-æ‹¦æˆªå™¨éƒ¨åˆ†æºç åˆ†æ"><a href="#2-3-æ‹¦æˆªå™¨éƒ¨åˆ†æºç åˆ†æ" class="headerlink" title="2.3 æ‹¦æˆªå™¨éƒ¨åˆ†æºç åˆ†æ"></a>2.3 æ‹¦æˆªå™¨éƒ¨åˆ†æºç åˆ†æ</h3><h4 id="2-3-1-æ–¹æ³•æ‰§è¡Œé¡ºåºçš„æºç åˆ†æ"><a href="#2-3-1-æ–¹æ³•æ‰§è¡Œé¡ºåºçš„æºç åˆ†æ" class="headerlink" title="2.3.1 æ–¹æ³•æ‰§è¡Œé¡ºåºçš„æºç åˆ†æ"></a>2.3.1 æ–¹æ³•æ‰§è¡Œé¡ºåºçš„æºç åˆ†æ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ‰€æœ‰æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨å¤„ç†å™¨æ–¹æ³•</span></span><br><span class="line">        mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ‰€æœ‰æ‹¦æˆªå™¨çš„ postHandle æ–¹æ³•</span></span><br><span class="line">        mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        <span class="comment">// å¤„ç†è§†å›¾</span></span><br><span class="line">        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// æ¸²æŸ“é¡µé¢</span></span><br><span class="line">        render(mv, request, response);</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ‰€æœ‰æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•</span></span><br><span class="line">        mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2-æ‹¦æˆªä¸æ”¾è¡Œçš„æºç åˆ†æ"><a href="#2-3-2-æ‹¦æˆªä¸æ”¾è¡Œçš„æºç åˆ†æ" class="headerlink" title="2.3.2 æ‹¦æˆªä¸æ”¾è¡Œçš„æºç åˆ†æ"></a>2.3.2 æ‹¦æˆªä¸æ”¾è¡Œçš„æºç åˆ†æ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ‰€æœ‰æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ mappedHandler.applyPreHandle(processedRequest, response) è¿”å›falseï¼Œä»¥ä¸‹çš„returnè¯­å¥å°±ä¼šæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerExecutionChain</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">applyPreHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.interceptorList.size(); i++) &#123;</span><br><span class="line">			<span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">			<span class="keyword">if</span> (!interceptor.preHandle(request, response, <span class="built_in">this</span>.handler)) &#123;</span><br><span class="line">				triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">                <span class="comment">// å¦‚æœ interceptor.preHandle(request, response, this.handler) è¿”å› falseï¼Œä»¥ä¸‹çš„ return false;å°±ä¼šæ‰§è¡Œã€‚</span></span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">this</span>.interceptorIndex = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-æ‹¦æˆªå™¨çš„é«˜çº§é…ç½®"><a href="#3-æ‹¦æˆªå™¨çš„é«˜çº§é…ç½®" class="headerlink" title="3. æ‹¦æˆªå™¨çš„é«˜çº§é…ç½®"></a>3. æ‹¦æˆªå™¨çš„é«˜çº§é…ç½®</h2><p>é‡‡ç”¨ä»¥ä¸ŠåŸºæœ¬é…ç½®æ–¹å¼ï¼Œæ‹¦æˆªå™¨æ˜¯æ‹¦æˆªæ‰€æœ‰è¯·æ±‚è·¯å¾„çš„ã€‚å¦‚æœè¦é’ˆå¯¹æŸäº›è·¯å¾„è¿›è¡Œæ‹¦æˆªï¼ŒæŸäº›è·¯å¾„ä¸æ‹¦æˆªï¼Œå¯ä»¥é‡‡ç”¨é«˜çº§é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ‹¦æˆªæ‰€æœ‰è·¯å¾„--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é™¤ /test è·¯å¾„ä¹‹å¤–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/test&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šçš„é…ç½®è¡¨ç¤ºï¼Œé™¤ <code>/test</code> è¯·æ±‚è·¯å¾„ä¹‹å¤–ï¼Œå‰©ä¸‹çš„è·¯å¾„å…¨éƒ¨æ‹¦æˆªã€‚</p>
<h2 id="4-æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº"><a href="#4-æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="4. æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº"></a>4. æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº</h2><h3 id="4-1-æ‰§è¡Œé¡ºåº"><a href="#4-1-æ‰§è¡Œé¡ºåº" class="headerlink" title="4.1 æ‰§è¡Œé¡ºåº"></a>4.1 æ‰§è¡Œé¡ºåº</h3><h4 id="4-1-1-å¦‚æœæ‰€æœ‰æ‹¦æˆªå™¨preHandleéƒ½è¿”å›true"><a href="#4-1-1-å¦‚æœæ‰€æœ‰æ‹¦æˆªå™¨preHandleéƒ½è¿”å›true" class="headerlink" title="4.1.1 å¦‚æœæ‰€æœ‰æ‹¦æˆªå™¨preHandleéƒ½è¿”å›true"></a>4.1.1 å¦‚æœæ‰€æœ‰æ‹¦æˆªå™¨preHandleéƒ½è¿”å›true</h4><p>æŒ‰ç…§springmvc.xmlæ–‡ä»¶ä¸­é…ç½®çš„é¡ºåºï¼Œè‡ªä¸Šè€Œä¸‹è°ƒç”¨ preHandleï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor2&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œé¡ºåºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%89%80%E6%9C%89%E6%8B%A6%E6%88%AA%E5%99%A8preHandle%E9%83%BD%E8%BF%94%E5%9B%9Etrue%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" alt="æ‰€æœ‰æ‹¦æˆªå™¨preHandleéƒ½è¿”å›trueæ‰§è¡Œé¡ºåº"></p>
<h4 id="4-1-2-å¦‚æœå…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›false"><a href="#4-1-2-å¦‚æœå…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›false" class="headerlink" title="4.1.2 å¦‚æœå…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›false"></a>4.1.2 å¦‚æœå…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›false</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;interceptor2&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>interceptor2</code>çš„<code>preHandle</code>è¿”å›<code>false</code>ï¼Œæ‰§è¡Œé¡ºåºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8preHandle%E8%BF%94%E5%9B%9Efalse%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" alt="å…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›falseæ‰§è¡Œé¡ºåº"></p>
<p>è§„åˆ™ï¼šåªè¦æœ‰ä¸€ä¸ªæ‹¦æˆªå™¨<code>preHandle</code>è¿”å›<code>false</code>ï¼Œä»»ä½•<code>postHandle</code>éƒ½ä¸æ‰§è¡Œã€‚ä½†è¿”å›<code>false</code>çš„æ‹¦æˆªå™¨çš„<strong>å‰é¢</strong>çš„æ‹¦æˆªå™¨æŒ‰ç…§<strong>é€†åº</strong>æ‰§è¡Œ<code>afterCompletion</code>ã€‚</p>
<h3 id="4-2-æºç åˆ†æ"><a href="#4-2-æºç åˆ†æ" class="headerlink" title="4.2 æºç åˆ†æ"></a>4.2 æºç åˆ†æ</h3><p><code>DispatcherServlet</code> å’Œ <code>HandlerExecutionChain</code> çš„éƒ¨åˆ†æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// æŒ‰ç…§é¡ºåºæ‰§è¡Œæ‰€æœ‰æ‹¦æˆªå™¨çš„preHandleæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œå¤„ç†å™¨æ–¹æ³•</span></span><br><span class="line">        mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line">        <span class="comment">// æŒ‰ç…§é€†åºæ‰§è¡Œæ‰€æœ‰æ‹¦æˆªå™¨çš„ postHanle æ–¹æ³•</span></span><br><span class="line">        mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        <span class="comment">// å¤„ç†è§†å›¾</span></span><br><span class="line">        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// æ¸²æŸ“è§†å›¾</span></span><br><span class="line">        render(mv, request, response);</span><br><span class="line">        <span class="comment">// æŒ‰ç…§é€†åºæ‰§è¡Œæ‰€æœ‰æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•</span></span><br><span class="line">        mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerExecutionChain</span> &#123;</span><br><span class="line">    <span class="comment">// é¡ºåºæ‰§è¡Œ preHandle</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">applyPreHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.interceptorList.size(); i++) &#123;</span><br><span class="line">            <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">            <span class="keyword">if</span> (!interceptor.preHandle(request, response, <span class="built_in">this</span>.handler)) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœå…¶ä¸­ä¸€ä¸ªæ‹¦æˆªå™¨preHandleè¿”å›false</span></span><br><span class="line">                <span class="comment">// å°†è¯¥æ‹¦æˆªå™¨å‰é¢çš„æ‹¦æˆªå™¨æŒ‰ç…§é€†åºæ‰§è¡Œæ‰€æœ‰çš„afterCompletion</span></span><br><span class="line">                triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.interceptorIndex = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// é€†åºæ‰§è¡Œ postHanle</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">applyPostHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> ModelAndView mv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">            interceptor.postHandle(request, response, <span class="built_in">this</span>.handler, mv);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// é€†åºæ‰§è¡Œ afterCompletion</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">triggerAfterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> Exception ex)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorIndex; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				interceptor.afterCompletion(request, response, <span class="built_in">this</span>.handler, ex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">catch</span> (Throwable ex2) &#123;</span><br><span class="line">				logger.error(<span class="string">&quot;HandlerInterceptor.afterCompletion threw exception&quot;</span>, ex2);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬11ç« ã€‘ Spring MVCæ‰§è¡Œæµç¨‹</title>
    <url>/posts/SpringMVC-Chapter-Eleven-SpringMVC-Execution-Flow/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-ä»æºç è§’åº¦çœ‹æ‰§è¡Œæµç¨‹"><a href="#1-ä»æºç è§’åº¦çœ‹æ‰§è¡Œæµç¨‹" class="headerlink" title="1. ä»æºç è§’åº¦çœ‹æ‰§è¡Œæµç¨‹"></a>1. ä»æºç è§’åº¦çœ‹æ‰§è¡Œæµç¨‹</h1><h2 id="1-1-ä»æºç è§’åº¦åˆ†æSpringMVCæ‰§è¡Œæµç¨‹"><a href="#1-1-ä»æºç è§’åº¦åˆ†æSpringMVCæ‰§è¡Œæµç¨‹" class="headerlink" title="1.1 ä»æºç è§’åº¦åˆ†æSpringMVCæ‰§è¡Œæµç¨‹"></a>1.1 ä»æºç è§’åº¦åˆ†æSpringMVCæ‰§è¡Œæµç¨‹</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‰ç«¯æ§åˆ¶å™¨ï¼ŒSpringMVCæœ€æ ¸å¿ƒçš„ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line">	<span class="comment">// å‰ç«¯æ§åˆ¶å™¨æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è´Ÿè´£å¤„ç†è¯·æ±‚çš„ï¼Œä¸€æ¬¡è¯·æ±‚ï¼Œè°ƒç”¨ä¸€æ¬¡ doDispatch æ–¹æ³•ã€‚</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡è¯·æ±‚è·å–å¤„ç†å™¨</span></span><br><span class="line">		<span class="comment">// è¯·æ±‚ï¼šhttp://localhost:8080/springmvc/hello ï¼ˆæœ‰URIï¼‰</span></span><br><span class="line">		<span class="comment">// æ ¹æ®è¯·æ±‚è·¯å¾„æ¥è·å–å¯¹åº”çš„è¦æ‰§è¡Œçš„å¤„ç†å™¨</span></span><br><span class="line">		<span class="comment">// å®é™…ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ªå¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡</span></span><br><span class="line">		<span class="comment">// è¿™ä¸ªæ‰§è¡Œé“¾(é“¾æ¡)æŠŠè°ä¸²èµ·æ¥äº†å‘¢ï¼ŸæŠŠè¿™ä¸€æ¬¡è¯·æ±‚è¦æ‰§è¡Œçš„æ‰€æœ‰æ‹¦æˆªå™¨å’Œå¤„ç†å™¨ä¸²èµ·æ¥äº†ã€‚</span></span><br><span class="line">		<span class="comment">// HandlerExecutionChainæ˜¯ä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">		<span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> getHandler(request);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// æ ¹æ®å¤„ç†å™¨è·å–å¤„ç†å™¨é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">		<span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> getHandlerAdapter(mappedHandler.getHandler()); <span class="comment">// Handlerå°±æ˜¯æˆ‘ä»¬å†™çš„Controller</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ‰§è¡Œè¯¥è¯·æ±‚å¯¹åº”çš„æ‰€æœ‰æ‹¦æˆªå™¨ä¸­çš„ preHandle æ–¹æ³•</span></span><br><span class="line">		<span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è°ƒç”¨å¤„ç†å™¨æ–¹æ³•ï¼Œè¿”å›ModelAndViewå¯¹è±¡</span></span><br><span class="line">		<span class="comment">// åœ¨è¿™é‡Œè¿›è¡Œçš„æ•°æ®ç»‘å®šï¼Œå®é™…ä¸Šè°ƒç”¨å¤„ç†å™¨æ–¹æ³•ä¹‹å‰è¦ç»™å¤„ç†å™¨æ–¹æ³•ä¼ å‚</span></span><br><span class="line">		<span class="comment">// éœ€è¦ä¼ å‚çš„è¯ï¼Œè¿™ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯è¦ç»è¿‡ä¸€ä¸ªå¤æ‚çš„æ•°æ®ç»‘å®šè¿‡ç¨‹ï¼ˆå°†å‰ç«¯æäº¤çš„è¡¨å•æ•°æ®è½¬æ¢æˆPOJOå¯¹è±¡ï¼‰</span></span><br><span class="line">		mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ‰§è¡Œè¯¥è¯·æ±‚å¯¹åº”çš„æ‰€æœ‰æ‹¦æˆªå™¨ä¸­çš„ postHandle æ–¹æ³•</span></span><br><span class="line">		mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å¤„ç†åˆ†å‘ç»“æœï¼ˆæœ¬è´¨ä¸Šå°±æ˜¯å“åº”ç»“æœåˆ°æµè§ˆå™¨ï¼‰</span></span><br><span class="line">		processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// æ¸²æŸ“</span></span><br><span class="line">		render(mv, request, response);</span><br><span class="line">		<span class="comment">// æ‰§è¡Œè¯¥è¯·æ±‚æ‰€å¯¹åº”çš„æ‰€æœ‰æ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•</span></span><br><span class="line">		mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">render</span><span class="params">(ModelAndView mv, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼Œè¿”å›è§†å›¾Viewå¯¹è±¡</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> resolveViewName(viewName, mv.getModelInternal(), locale, request);</span><br><span class="line">		<span class="comment">// è°ƒç”¨è§†å›¾å¯¹è±¡çš„æ¸²æŸ“æ–¹æ³•ï¼ˆå®Œæˆå“åº”ï¼‰</span></span><br><span class="line">		view.render(mv.getModelInternal(), request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> View <span class="title function_">resolveViewName</span><span class="params">(String viewName, <span class="meta">@Nullable</span> Map&lt;String, Object&gt; model,</span></span><br><span class="line"><span class="params">			Locale locale, HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// è§†å›¾è§£æå™¨</span></span><br><span class="line">		ViewResolver viewResolver;</span><br><span class="line">		<span class="comment">// é€šè¿‡è§†å›¾è§£æå™¨è§£æè¿”å›è§†å›¾å¯¹è±¡View</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> viewResolver.resolveViewName(viewName, locale);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾è§£æå™¨æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ViewResolver</span> &#123;</span><br><span class="line">	View <span class="title function_">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾è§£æå™¨æ¥å£å®ç°ç±»ä¹Ÿå¾ˆå¤šï¼šThymeleafViewResolverã€InternalResourceViewResolver</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">View</span>&#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">render</span><span class="params">(<span class="meta">@Nullable</span> Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">			<span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ä¸€ä¸ªæ¥å£è‚¯å®šæ˜¯æœ‰æ¥å£ä¸‹çš„å®ç°ç±»ï¼Œä¾‹å¦‚Viewæ¥å£çš„å®ç°ç±»ï¼šThymeleafViewã€InternalResourceView....</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-å…³äºæ ¹æ®è¯·æ±‚è·å–å¤„ç†å™¨æ‰§è¡Œé“¾"><a href="#1-2-å…³äºæ ¹æ®è¯·æ±‚è·å–å¤„ç†å™¨æ‰§è¡Œé“¾" class="headerlink" title="1.2 å…³äºæ ¹æ®è¯·æ±‚è·å–å¤„ç†å™¨æ‰§è¡Œé“¾"></a>1.2 å…³äºæ ¹æ®è¯·æ±‚è·å–å¤„ç†å™¨æ‰§è¡Œé“¾</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">åˆ†æè¿™ä¸€è¡Œä»£ç ï¼š</span><br><span class="line"><span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> getHandler(request);</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> HandlerExecutionChainï¼šå¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> HandlerExecutionChainä¸­çš„å±æ€§ï¼š</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerExecutionChain</span>&#123;</span><br><span class="line">		<span class="comment">// åº•å±‚å¯¹åº”çš„æ˜¯ä¸€ä¸ªHandlerMethodå¯¹è±¡</span></span><br><span class="line">		<span class="comment">// å¤„ç†å™¨æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">		<span class="type">Object</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HandlerMethod</span>(.....);</span><br><span class="line">		<span class="comment">// è¯¥è¯·æ±‚å¯¹åº”çš„æ‰€æœ‰çš„æ‹¦æˆªå™¨æŒ‰ç…§é¡ºåºæ”¾åˆ°äº†ArrayListé›†åˆä¸­</span></span><br><span class="line">		<span class="comment">// æ‰€æœ‰çš„æ‹¦æˆªå™¨å¯¹è±¡ä¹Ÿéƒ½æ˜¯åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™éƒ½åˆ›å»ºå¥½ã€‚</span></span><br><span class="line">		List&lt;HandlerInterceptor&gt; interceptorList;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> HandlerMethod æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line">	</span><br><span class="line">	HandlerMethodæ˜¯æœ€æ ¸å¿ƒçš„è¦æ‰§è¡Œçš„ç›®æ ‡ï¼Œç¿»è¯‘ä¸ºï¼šå¤„ç†å™¨æ–¹æ³•ã€‚</span><br><span class="line">	æ³¨æ„ï¼šHandlerMethod æ˜¯åœ¨webæœåŠ¡å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–springå®¹å™¨çš„æ—¶å€™ï¼Œå°±åˆ›å»ºå¥½äº†ã€‚</span><br><span class="line">	è¿™ä¸ªç±»å½“ä¸­æ¯”è¾ƒé‡è¦çš„å±æ€§åŒ…æ‹¬ï¼šbeanNameå’ŒMethod</span><br><span class="line">	ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ï¼š</span><br><span class="line">		<span class="meta">@Controller(&quot;userController&quot;)</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span>&#123;</span><br><span class="line">			<span class="meta">@RequestMapping(&quot;/login&quot;)</span></span><br><span class="line">			<span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(User user)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> ....</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	é‚£ä¹ˆä»¥ä¸Šä»£ç å¯¹åº”äº†ä¸€ä¸ªHandlerMethodå¯¹è±¡ï¼š</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerMethod</span>&#123;</span><br><span class="line">			<span class="keyword">private</span> <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> <span class="string">&quot;userController&quot;</span>;</span><br><span class="line">			<span class="keyword">private</span> Method loginMethod;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> getHandler(request);</span><br><span class="line">	è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯åœ¨DispatcherServletç±»ä¸­ã€‚</span><br><span class="line">	<span class="keyword">protected</span> HandlerExecutionChain <span class="title function_">getHandler</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.handlerMappings != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (HandlerMapping mapping : <span class="built_in">this</span>.handlerMappings) &#123;</span><br><span class="line">				<span class="comment">// é€šè¿‡åˆé€‚çš„ HandlerMappingæ‰èƒ½è·å–åˆ° HandlerExecutionChainå¯¹è±¡ã€‚</span></span><br><span class="line">				<span class="comment">// å¦‚æœä½ å¤„ç†å™¨æ–¹æ³•ä½¿ç”¨äº† @RequestMappingæ³¨è§£ï¼Œé‚£ä¹ˆä»¥ä¸‹ä»£ç ä¸­çš„mappingæ˜¯ï¼šRequestMappingHandlerMappingå¯¹è±¡ã€‚</span></span><br><span class="line">				<span class="type">HandlerExecutionChain</span> <span class="variable">handler</span> <span class="operator">=</span> mapping.getHandler(request);</span><br><span class="line">				<span class="keyword">if</span> (handler != <span class="literal">null</span>) &#123;</span><br><span class="line">					<span class="keyword">return</span> handler;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	é‡ç‚¹ï¼š</span><br><span class="line">		æˆ‘ä»¬å¤„ç†è¯·æ±‚çš„ç¬¬ä¸€æ­¥ä»£ç æ˜¯ï¼š<span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> getHandler(request);</span><br><span class="line">		å…¶æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨äº†ï¼š<span class="type">HandlerExecutionChain</span> <span class="variable">handler</span> <span class="operator">=</span> mapping.getHandler(request);</span><br><span class="line"></span><br><span class="line">	mappingå˜é‡å°±æ˜¯ HandlerMappingã€‚</span><br><span class="line">	HandlerMappingæ˜¯ä¸€ä¸ªæ¥å£ï¼š</span><br><span class="line">		ç¿»è¯‘ä¸ºå¤„ç†å™¨æ˜ å°„å™¨ï¼Œä¸“é—¨è´Ÿè´£æ˜ å°„çš„ã€‚å°±æ˜¯æœ¬è´¨ä¸Šæ ¹æ®è¯·æ±‚è·¯å¾„å»æ˜ å°„å¤„ç†å™¨æ–¹æ³•çš„ã€‚</span><br><span class="line">		HandlerMappingæ¥å£ä¸‹æœ‰å¾ˆå¤šå®ç°ç±»ï¼š</span><br><span class="line">			ä¾‹å¦‚å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒæœ‰åçš„ï¼Œå¸¸ç”¨çš„ï¼šRequestMappingHandlerMapping</span><br><span class="line">			è¿™ä¸ª RequestMappingHandlerMapping å«åšï¼š<span class="meta">@RequestMapping</span>æ³¨è§£ä¸“ç”¨çš„å¤„ç†å™¨æ˜ å°„å™¨å¯¹è±¡ã€‚</span><br><span class="line"></span><br><span class="line">			å½“ç„¶ï¼Œå¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ <span class="meta">@RequestMapping</span>æ³¨è§£ï¼Œä¹Ÿå¯ä»¥å†™xmlé…ç½®æ–‡ä»¶æ¥è¿›è¡Œæ˜ å°„ï¼Œé‚£ä¸ªæ—¶å€™å¯¹åº”çš„å°±æ˜¯å…¶ä»–çš„HandlerMappingæ¥å£çš„å®ç°ç±»äº†ã€‚</span><br><span class="line">	</span><br><span class="line">	HandlerMapping å¯¹è±¡ä¹Ÿæ˜¯åœ¨æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µåˆ›å»ºçš„ï¼Œæ‰€æœ‰çš„HandlerMappingå¯¹è±¡éƒ½æ˜¯åœ¨æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µåˆ›å»ºï¼Œå¹¶ä¸”å­˜æ”¾åˆ°é›†åˆä¸­ã€‚</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span>&#123;</span><br><span class="line">		List&lt;HandlerMapping&gt; handlerMappings;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> RequestMappingHandlerMappingä¸­çš„ getHandler(request);</span><br><span class="line">	<span class="type">HandlerExecutionChain</span> <span class="variable">handler</span> <span class="operator">=</span> mapping.getHandler(request);</span><br><span class="line">	</span><br><span class="line">	mapping.getHandler(request);è¿™ä¸ªæ–¹æ³•åº•å±‚ä¸€å®šæ˜¯è·å–äº† HandlerMethod å¯¹è±¡ï¼Œå°†å…¶èµ‹å€¼ç»™ HandlerExecutionChainçš„handlerå±æ€§</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestMappingHandlerMapping</span> <span class="keyword">extends</span> <span class="title class_">AbstractHandlerMethodMapping</span>&#123;</span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">registerHandlerMethod</span><span class="params">(Object handler, Method method, RequestMappingInfo mapping)</span> &#123;</span><br><span class="line">			<span class="built_in">super</span>.registerHandlerMethod(handler, method, mapping);</span><br><span class="line">			updateConsumesCondition(mapping, method);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AbstractHandlerMethodMapping</span>&#123;</span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">registerHandlerMethod</span><span class="params">(Object handler, Method method, T mapping)</span> &#123;</span><br><span class="line">			<span class="built_in">this</span>.mappingRegistry.register(mapping, handler, method);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(T mapping, Object handler, Method method)</span> &#123;</span><br><span class="line">			<span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> createHandlerMethod(handler, method);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">protected</span> HandlerMethod <span class="title function_">createHandlerMethod</span><span class="params">(Object handler, Method method)</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (handler <span class="keyword">instanceof</span> String beanName) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HandlerMethod</span>(beanName,</span><br><span class="line">						obtainApplicationContext().getAutowireCapableBeanFactory(),</span><br><span class="line">						obtainApplicationContext(),</span><br><span class="line">						method);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HandlerMethod</span>(handler, method);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">è¿™ä¸€æ­¥ç‰µè¿åˆ°çš„ç±»æœ‰å“ªäº›ï¼š</span><br><span class="line">	HandlerExecutionChain</span><br><span class="line">	HandlerMethod</span><br><span class="line">	HandlerInterceptor</span><br><span class="line">	HandlerMapping</span><br><span class="line">		RequestMappingHandlerMappingï¼ˆæ˜¯HandlerMapingæ¥å£çš„å®ç°ï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="1-3-å…³äºæ ¹æ®å¤„ç†å™¨æ¥è·å–å¤„ç†å™¨é€‚é…å™¨"><a href="#1-3-å…³äºæ ¹æ®å¤„ç†å™¨æ¥è·å–å¤„ç†å™¨é€‚é…å™¨" class="headerlink" title="1.3 å…³äºæ ¹æ®å¤„ç†å™¨æ¥è·å–å¤„ç†å™¨é€‚é…å™¨"></a>1.3 å…³äºæ ¹æ®å¤„ç†å™¨æ¥è·å–å¤„ç†å™¨é€‚é…å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">åˆ†æï¼š</span><br><span class="line"><span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> åº•å±‚ä½¿ç”¨äº†é€‚é…å™¨æ¨¡å¼ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> æ¯ä¸€ä¸ªå¤„ç†å™¨(æˆ‘ä»¬è‡ªå·±å†™çš„Controller)ï¼Œéƒ½æœ‰è‡ªå·±é€‚åˆçš„å¤„ç†å™¨é€‚é…å™¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> åœ¨SpringMVCå½“ä¸­å¤„ç†å™¨é€‚é…å™¨ä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒæœ‰åçš„ï¼Œå¸¸ç”¨çš„å¤„ç†å™¨é€‚é…å™¨æ˜¯ï¼šRequestMappingHandlerAdapter</span><br><span class="line">è¿™ä¸ªå¤„ç†å™¨é€‚é…å™¨æ˜¯ä¸“é—¨å¤„ç† â€œå¤„ç†å™¨æ–¹æ³•â€ä¸Šæœ‰ <span class="meta">@RequestMapping</span> æ³¨è§£çš„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> mappedHandler.getHandler() è·å–çš„æ˜¯ HandlerMethod å¯¹è±¡</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> HandlerAdapterä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼š</span><br><span class="line">	å…¶ä¸­æœ‰ä¸€ä¸ªå¸¸ç”¨çš„å®ç°ç±»ï¼šRequestMappingHandlerAdapter</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> åœ¨æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µï¼Œæ‰€æœ‰çš„ HandlerAdapteræ¥å£çš„å®ç°ç±»éƒ½ä¼šåˆ›å»ºå‡ºæ¥ã€‚åœ¨æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line">	List&lt;HandlerAdapter&gt; handlerAdapters;</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> HandlerAdapteræ¥å£éå¸¸é‡è¦ï¼Œé€šè¿‡è¿™ä¸ªæ¥å£æ¥è°ƒç”¨æœ€ç»ˆçš„ HandlerMethodã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> HandlerAdapteræ˜¯é€‚é…å™¨ï¼Œæ˜¯å¯¹ HandlerMethod è¿›è¡Œçš„é€‚é…ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">9.</span> åœ¨DispatcherServletç±»ä¸­ï¼Œå¦‚ä¸‹ä»£ç ï¼š</span><br><span class="line">	<span class="keyword">protected</span> HandlerAdapter <span class="title function_">getHandlerAdapter</span><span class="params">(Object handler)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.handlerAdapters != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (HandlerAdapter adapter : <span class="built_in">this</span>.handlerAdapters) &#123;</span><br><span class="line">				<span class="keyword">if</span> (adapter.supports(handler)) &#123;</span><br><span class="line">					<span class="keyword">return</span> adapter;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-4-å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨preHandle"><a href="#1-4-å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨preHandle" class="headerlink" title="1.4 å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨preHandle"></a>1.4 å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨preHandle</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨çš„preHandleæ–¹æ³•</span><br><span class="line"></span><br><span class="line">DispatcherServlet:</span><br><span class="line"><span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HandlerExecutionChainï¼š</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">applyPreHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.interceptorList.size(); i++) &#123;</span><br><span class="line">		<span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">		<span class="keyword">if</span> (!interceptor.preHandle(request, response, <span class="built_in">this</span>.handler)) &#123;</span><br><span class="line">			triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">this</span>.interceptorIndex = i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">éå†Listé›†åˆï¼Œä»Listé›†åˆä¸­å–å‡ºæ¯ä¸€ä¸ª HandlerInterceptorå¯¹è±¡ï¼Œè°ƒç”¨ preHandleï¼Œi++ï¼Œå¯è§æ˜¯é¡ºåºè°ƒç”¨ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="1-5-å…³äºè°ƒç”¨å¤„ç†å™¨æ–¹æ³•"><a href="#1-5-å…³äºè°ƒç”¨å¤„ç†å™¨æ–¹æ³•" class="headerlink" title="1.5 å…³äºè°ƒç”¨å¤„ç†å™¨æ–¹æ³•"></a>1.5 å…³äºè°ƒç”¨å¤„ç†å™¨æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">å…³äºè°ƒç”¨å¤„ç†å™¨æ–¹æ³•ï¼š</span><br><span class="line">	mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">	ha æ˜¯å¤„ç†å™¨é€‚é…å™¨</span><br><span class="line"></span><br><span class="line">	mv æ˜¯ModelAndViewå¯¹è±¡</span><br><span class="line"></span><br><span class="line">	è¿™ä¸ªæ–¹æ³•æ˜¯æœ€æ ¸å¿ƒçš„ï¼Œè°ƒç”¨è¯·æ±‚è·¯å¾„å¯¹åº”çš„HandlerMethodã€‚ï¼ˆè°ƒç”¨å¤„ç†å™¨æ–¹æ³•ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">haæ˜¯HandlerAdapterï¼Œå¦‚æœæ˜¯ <span class="meta">@RequestMapping</span> æ³¨è§£å¯¹åº”çš„ï¼Œé‚£ä¹ˆå°±æ˜¯ RequestMappingHandlerAdapterï¼š</span><br><span class="line"></span><br><span class="line">RequestMappingHandlerAdapterï¼š</span><br><span class="line">	<span class="keyword">protected</span> ModelAndView <span class="title function_">handleInternal</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">				HttpServletResponse response, HandlerMethod handlerMethod)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		mav = invokeHandlerMethod(request, response, handlerMethod);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">protected</span> ModelAndView <span class="title function_">invokeHandlerMethod</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">			HttpServletResponse response, HandlerMethod handlerMethod)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// è·å–ä¸€ä¸ªæ•°æ®ç»‘å®šå·¥å‚</span></span><br><span class="line">		<span class="type">WebDataBinderFactory</span> <span class="variable">binderFactory</span> <span class="operator">=</span> getDataBinderFactory(handlerMethod);</span><br><span class="line">		<span class="comment">// è·å–ä¸€ä¸ªå¯è°ƒç”¨çš„å¤„ç†å™¨æ–¹æ³•</span></span><br><span class="line">		<span class="type">ServletInvocableHandlerMethod</span> <span class="variable">invocableMethod</span> <span class="operator">=</span> createInvocableHandlerMethod(handlerMethod);</span><br><span class="line">		<span class="comment">// ç»™å¯è°ƒç”¨çš„æ–¹æ³•ç»‘å®šæ•°æ®</span></span><br><span class="line">		invocableMethod.setDataBinderFactory(binderFactory);</span><br><span class="line">		<span class="comment">// ç»™å¯è°ƒç”¨çš„æ–¹æ³•è®¾ç½®å‚æ•°</span></span><br><span class="line">		invocableMethod.setParameterNameDiscoverer(<span class="built_in">this</span>.parameterNameDiscoverer);</span><br><span class="line">		<span class="comment">// å¯è°ƒç”¨çš„æ–¹æ³•æ‰§è¡Œäº†ã€‚</span></span><br><span class="line">		invocableMethod.invokeAndHandle(webRequest, mavContainer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">åœ¨HandlerAdapterä¸­åšçš„æ ¸å¿ƒäº‹æƒ…ï¼š</span><br><span class="line">	å°†å‰ç«¯æäº¤çš„formæ•°æ®é€šè¿‡ HttpMessageConverter å°†å…¶è½¬æ¢æˆ POJOå¯¹è±¡ã€‚ï¼ˆæ•°æ®è½¬æ¢ï¼‰</span><br><span class="line">	å¹¶å°†æ•°æ®ç»‘å®šåˆ° HandlerMethod å¯¹è±¡ä¸Šã€‚</span><br><span class="line">	è°ƒç”¨HandlerMethodã€‚</span><br><span class="line">	è¿”å› ModelAndView</span><br></pre></td></tr></table></figure>

<h2 id="1-6-å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨çš„postHandle"><a href="#1-6-å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨çš„postHandle" class="headerlink" title="1.6 å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨çš„postHandle"></a>1.6 å…³äºæ‰§è¡Œè¯·æ±‚å¯¹åº”çš„æ‹¦æˆªå™¨çš„postHandle</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">DispatcherServlet:</span><br><span class="line"></span><br><span class="line">	mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line"></span><br><span class="line">HandlerExecutionChain:</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">applyPostHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> ModelAndView mv)</span></span><br><span class="line">			<span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">			interceptor.postHandle(request, response, <span class="built_in">this</span>.handler, mv);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">é€šè¿‡æºç è§£å†³ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„çœ‹åˆ°ï¼Œä»Listé›†åˆä¸­é€†åº(i--)é€ä¸€å–å‡ºæ‹¦æˆªå™¨å¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨æ‹¦æˆªå™¨çš„ postHandleæ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="1-7-å…³äºå¤„ç†åˆ†å‘ç»“æœ"><a href="#1-7-å…³äºå¤„ç†åˆ†å‘ç»“æœ" class="headerlink" title="1.7 å…³äºå¤„ç†åˆ†å‘ç»“æœ"></a>1.7 å…³äºå¤„ç†åˆ†å‘ç»“æœ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å¤„ç†åˆ†å‘ç»“æœ</span></span><br><span class="line">	processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// æ¸²æŸ“</span></span><br><span class="line">		render(mv, request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">render</span><span class="params">(ModelAndView mv, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡è§†å›¾è§£æå™¨è¿›è¡Œè§£æï¼Œè¿”å›è§†å›¾Viewå¯¹è±¡</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> resolveViewName(viewName, mv.getModelInternal(), locale, request);</span><br><span class="line">		<span class="comment">// è°ƒç”¨è§†å›¾å¯¹è±¡çš„æ¸²æŸ“æ–¹æ³•ï¼ˆå®Œæˆå“åº”ï¼‰</span></span><br><span class="line">		view.render(mv.getModelInternal(), request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> View <span class="title function_">resolveViewName</span><span class="params">(String viewName, <span class="meta">@Nullable</span> Map&lt;String, Object&gt; model,</span></span><br><span class="line"><span class="params">			Locale locale, HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// è§†å›¾è§£æå™¨</span></span><br><span class="line">		ViewResolver viewResolver;</span><br><span class="line">		<span class="comment">// é€šè¿‡è§†å›¾è§£æå™¨è§£æè¿”å›è§†å›¾å¯¹è±¡View</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> viewResolver.resolveViewName(viewName, locale);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾è§£æå™¨æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ViewResolver</span> &#123;</span><br><span class="line">	View <span class="title function_">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾è§£æå™¨æ¥å£å®ç°ç±»ä¹Ÿå¾ˆå¤šï¼šThymeleafViewResolverã€InternalResourceViewResolver</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§†å›¾æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">View</span>&#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">render</span><span class="params">(<span class="meta">@Nullable</span> Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">			<span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ä¸€ä¸ªæ¥å£è‚¯å®šæ˜¯æœ‰æ¥å£ä¸‹çš„å®ç°ç±»ï¼Œä¾‹å¦‚Viewæ¥å£çš„å®ç°ç±»ï¼šThymeleafViewã€InternalResourceView....</span></span><br></pre></td></tr></table></figure>

<h2 id="1-8-å…³äºæ‰§è¡Œæ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•"><a href="#1-8-å…³äºæ‰§è¡Œæ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•" class="headerlink" title="1.8 å…³äºæ‰§è¡Œæ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•"></a>1.8 å…³äºæ‰§è¡Œæ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">DispatcherServlet:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// æ¸²æŸ“</span></span><br><span class="line">		render(mv, request, response);</span><br><span class="line">		<span class="comment">// æ‰§è¡Œè¯¥è¯·æ±‚æ‰€å¯¹åº”çš„æ‰€æœ‰æ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•</span></span><br><span class="line">		mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">HandlerExecutionChain:</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">triggerAfterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> Exception ex)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorIndex; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				interceptor.afterCompletion(request, response, <span class="built_in">this</span>.handler, ex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">catch</span> (Throwable ex2) &#123;</span><br><span class="line">				logger.error(<span class="string">&quot;HandlerInterceptor.afterCompletion threw exception&quot;</span>, ex2);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	é€šè¿‡æºç å¯ä»¥çœ‹å‡ºï¼Œä¹Ÿæ˜¯é€šè¿‡é€†åº(i--)çš„æ–¹å¼è¿›è¡Œæ‹¦æˆªå™¨çš„è°ƒç”¨ï¼Œè°ƒç”¨æ‹¦æˆªå™¨çš„afterCompletionæ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure>

<h1 id="2-ä»å›¾ç‰‡è§’åº¦çœ‹æ‰§è¡Œæµç¨‹"><a href="#2-ä»å›¾ç‰‡è§’åº¦çœ‹æ‰§è¡Œæµç¨‹" class="headerlink" title="2. ä»å›¾ç‰‡è§’åº¦çœ‹æ‰§è¡Œæµç¨‹"></a>2. ä»å›¾ç‰‡è§’åº¦çœ‹æ‰§è¡Œæµç¨‹</h1><p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SpringMVC%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png" alt="SpringMVCæ‰§è¡Œæµç¨‹"></p>
<h1 id="3-WEBæœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½åšäº†ä»€ä¹ˆ"><a href="#3-WEBæœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½åšäº†ä»€ä¹ˆ" class="headerlink" title="3. WEBæœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½åšäº†ä»€ä¹ˆ"></a>3. WEBæœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½åšäº†ä»€ä¹ˆ</h1><p>å…ˆææ˜ç™½æ ¸å¿ƒç±»çš„ç»§æ‰¿å…³ç³»ï¼š</p>
<p><code>DispatcherServlet extends FrameworkServlet extends HttpServletBean extends HttpServlet extends GenericServlet implements Servlet</code></p>
<p>æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µå®Œæˆäº†ï¼š</p>
<ol>
<li>åˆå§‹åŒ–Springä¸Šä¸‹æ–‡ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºæ‰€æœ‰çš„<code>bean</code>ï¼Œè®©IoCå®¹å™¨å°†å…¶ç®¡ç†èµ·æ¥ã€‚</li>
<li>åˆå§‹åŒ–SpringMVCç›¸å…³çš„å¯¹è±¡ï¼šå¤„ç†å™¨æ˜ å°„å™¨ï¼Œå¤„ç†å™¨é€‚é…å™¨ç­‰ã€‚ã€‚ã€‚</li>
</ol>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(1).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(1)" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(2).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(2)" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(3).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(3)" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(4).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(4)" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(5).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(5)" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(6).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(6)" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(7).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(7)" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8(8).png" alt="WEBæœåŠ¡å™¨å¯åŠ¨(8)" style="zoom:67%;">
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬5ç« ã€‘ è§†å›¾View</title>
    <url>/posts/SpringMVC-Chapter-Five-View/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-SpringMVCä¸­è§†å›¾çš„å®ç°åŸç†"><a href="#1-SpringMVCä¸­è§†å›¾çš„å®ç°åŸç†" class="headerlink" title="1. SpringMVCä¸­è§†å›¾çš„å®ç°åŸç†"></a>1. SpringMVCä¸­è§†å›¾çš„å®ç°åŸç†</h1><h2 id="1-1-Spring-MVCè§†å›¾æ”¯æŒå¯é…ç½®"><a href="#1-1-Spring-MVCè§†å›¾æ”¯æŒå¯é…ç½®" class="headerlink" title="1.1 Spring MVCè§†å›¾æ”¯æŒå¯é…ç½®"></a>1.1 Spring MVCè§†å›¾æ”¯æŒå¯é…ç½®</h2><p>åœ¨Spring MVCä¸­ï¼Œè§†å›¾Viewæ˜¯æ”¯æŒå®šåˆ¶çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨ springmvc.xml æ–‡ä»¶ä¸­è¿›è¡Œäº†å¦‚ä¸‹çš„é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä½œç”¨äºè§†å›¾æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è®¾ç½®è§†å›¾æ¸²æŸ“åè¾“å‡ºæ—¶é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¦‚æœé…ç½®å¤šä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒæ¥å†³å®šä¼˜å…ˆä½¿ç”¨å“ªä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒçš„å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å½“ ThymeleafViewResolver æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œä¼šä½¿ç”¨è¯¥æ¨¡æ¿å¼•æ“æ¥è§£æã€ç¼–è¯‘å’Œæ¸²æŸ“æ¨¡æ¿--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--ç”¨äºæŒ‡å®š Thymeleaf æ¨¡æ¿å¼•æ“ä½¿ç”¨çš„æ¨¡æ¿è§£æå™¨ã€‚æ¨¡æ¿è§£æå™¨è´Ÿè´£æ ¹æ®æ¨¡æ¿ä½ç½®ã€æ¨¡æ¿èµ„æºåç§°ã€æ–‡ä»¶ç¼–ç ç­‰ä¿¡æ¯ï¼ŒåŠ è½½æ¨¡æ¿å¹¶å¯¹å…¶è¿›è¡Œè§£æ--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶çš„ä½ç½®ï¼ˆå‰ç¼€ï¼‰--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶åç¼€ï¼ˆåç¼€ï¼‰ï¼ŒThymeleafæ–‡ä»¶æ‰©å±•åä¸ä¸€å®šæ˜¯htmlï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ï¼Œä¾‹å¦‚txtï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯html--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿ç±»å‹ï¼Œä¾‹å¦‚ï¼šHTML,TEXT,JAVASCRIPT,CSSç­‰--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--ç”¨äºæ¨¡æ¿æ–‡ä»¶åœ¨è¯»å–å’Œè§£æè¿‡ç¨‹ä¸­é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šçš„é…ç½®è¡¨æ˜å½“å‰SpringMVCæ¡†æ¶ä½¿ç”¨çš„è§†å›¾Viewæ˜¯Thymeleafçš„ã€‚</p>
<p>å¦‚æœä½ éœ€è¦æ¢æˆå…¶ä»–çš„è§†å›¾Viewï¼Œä¿®æ”¹ä»¥ä¸Šçš„é…ç½®å³å¯ã€‚è¿™æ ·å°±å¯ä»¥éå¸¸è½»æ¾çš„å®Œæˆè§†å›¾Viewçš„æ‰©å±•ã€‚</p>
<p>è¿™ç§è®¾è®¡æ˜¯å®Œå…¨ç¬¦åˆOCPå¼€é—­åŸåˆ™çš„ã€‚è§†å›¾Viewå’Œæ¡†æ¶æ˜¯è§£è€¦åˆçš„ï¼Œè€¦åˆåº¦ä½æ‰©å±•èƒ½åŠ›å¼ºã€‚è§†å›¾Viewå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œçµæ´»åˆ‡æ¢ã€‚</p>
<h2 id="1-2-Spring-MVCæ”¯æŒçš„å¸¸è§è§†å›¾"><a href="#1-2-Spring-MVCæ”¯æŒçš„å¸¸è§è§†å›¾" class="headerlink" title="1.2 Spring MVCæ”¯æŒçš„å¸¸è§è§†å›¾"></a>1.2 Spring MVCæ”¯æŒçš„å¸¸è§è§†å›¾</h2><p>Spring MVCæ”¯æŒçš„å¸¸è§è§†å›¾åŒ…æ‹¬ï¼š</p>
<ul>
<li>InternalResourceViewï¼šå†…éƒ¨èµ„æºè§†å›¾ï¼ˆæ˜¯SpringMVCå†…ç½®çš„ï¼Œä¸“é—¨è´Ÿè´£è§£æ <code>JSPæ¨¡æ¿è¯­æ³•</code> çš„ï¼Œå¦å¤–ä¹Ÿè´Ÿè´£ <code>è½¬å‘forward</code> åŠŸèƒ½çš„å®ç°ï¼‰</li>
<li>RedirectViewï¼šé‡å®šå‘è§†å›¾ï¼ˆæ˜¯SpringMVCå†…ç½®çš„ï¼Œä¸“é—¨è´Ÿè´£ <code>é‡å®šå‘redirect</code> åŠŸèƒ½çš„å®ç°ï¼‰</li>
<li>ThymeleafViewï¼šThymeleafè§†å›¾ï¼ˆç¬¬ä¸‰æ–¹çš„ï¼Œä¸º<code>Thymeleafæ¨¡æ¿è¯­æ³•</code>å‡†å¤‡çš„ï¼‰</li>
<li>FreeMarkerViewï¼šFreeMarkerè§†å›¾ï¼ˆç¬¬ä¸‰æ–¹çš„ï¼Œä¸º<code>FreeMarkeræ¨¡æ¿è¯­æ³•</code>å‡†å¤‡çš„ï¼‰</li>
<li>VelocityViewï¼šVelocityè§†å›¾ï¼ˆç¬¬ä¸‰æ–¹çš„ï¼Œä¸º<code>Velocityæ¨¡æ¿è¯­æ³•</code>å‡†å¤‡çš„ï¼‰</li>
<li>PDFViewï¼šPDFè§†å›¾ï¼ˆç¬¬ä¸‰æ–¹çš„ï¼Œä¸“é—¨ç”¨æ¥ç”Ÿæˆpdfæ–‡ä»¶è§†å›¾ï¼‰</li>
<li>ExcelViewï¼šExcelè§†å›¾ï¼ˆç¬¬ä¸‰æ–¹çš„ï¼Œä¸“é—¨ç”¨æ¥ç”Ÿæˆexcelæ–‡ä»¶è§†å›¾ï¼‰</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="1-3-å®ç°è§†å›¾æœºåˆ¶çš„æ ¸å¿ƒæ¥å£"><a href="#1-3-å®ç°è§†å›¾æœºåˆ¶çš„æ ¸å¿ƒæ¥å£" class="headerlink" title="1.3 å®ç°è§†å›¾æœºåˆ¶çš„æ ¸å¿ƒæ¥å£"></a>1.3 å®ç°è§†å›¾æœºåˆ¶çš„æ ¸å¿ƒæ¥å£</h2><p>å®ç°è§†å›¾çš„æ ¸å¿ƒç±»ä¸æ¥å£åŒ…æ‹¬ï¼š</p>
<p><strong><code>DispatcherServlet</code>ç±»ï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰</strong></p>
<ul>
<li>èŒè´£ï¼šåœ¨æ•´ä¸ªSpring MVCæ‰§è¡Œæµç¨‹ä¸­ï¼Œè´Ÿè´£ä¸­å¤®è°ƒåº¦</li>
<li>æ ¸å¿ƒæ–¹æ³•ï¼šdoDispatch</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95doDispatch.png" alt="æ ¸å¿ƒæ–¹æ³•doDispatch"></p>
<p><strong><code>ViewResolver</code>æ¥å£ï¼ˆè§†å›¾è§£æå™¨ï¼‰</strong></p>
<ul>
<li>èŒè´£ï¼šè´Ÿè´£å°†<code>é€»è¾‘è§†å›¾å</code>è½¬æ¢ä¸º<code>ç‰©ç†è§†å›¾å</code>ï¼Œæœ€ç»ˆåˆ›å»ºViewæ¥å£çš„å®ç°ç±»ï¼Œå³è§†å›¾å®ç°ç±»å¯¹è±¡</li>
<li>æ ¸å¿ƒæ–¹æ³•ï¼šresolveViewName</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95resolveViewName.png" alt="æ ¸å¿ƒæ–¹æ³•resolveViewName"></p>
<p><strong><code>View</code>æ¥å£ï¼ˆè§†å›¾ï¼‰</strong></p>
<ul>
<li>èŒè´£ï¼šè´Ÿè´£å°†æ¨¡å‹æ•°æ®Modelæ¸²æŸ“ä¸ºè§†å›¾æ ¼å¼ï¼ˆHTMLä»£ç ï¼‰ï¼Œå¹¶æœ€ç»ˆå°†ç”Ÿæˆçš„è§†å›¾ï¼ˆHTMLä»£ç ï¼‰è¾“å‡ºåˆ°å®¢æˆ·ç«¯ã€‚ï¼ˆå®ƒè´Ÿè´£å°†æ¨¡æ¿è¯­è¨€è½¬æ¢æˆHTMLä»£ç ï¼‰</li>
<li>æ ¸å¿ƒæ–¹æ³•ï¼šrender</li>
</ul>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95render.png" alt="æ ¸å¿ƒæ–¹æ³•render"></p>
<p><strong><code>ViewResolverRegistry</code>ï¼ˆè§†å›¾è§£æå™¨æ³¨å†Œå™¨ï¼‰</strong></p>
<ul>
<li>è´Ÿè´£åœ¨webå®¹å™¨ï¼ˆTomcatï¼‰å¯åŠ¨çš„æ—¶å€™ï¼Œå®Œæˆè§†å›¾è§£æå™¨çš„æ³¨å†Œã€‚å¦‚æœæœ‰å¤šä¸ªè§†å›¾è§£æå™¨ï¼Œä¼šå°†è§†å›¾è§£æå™¨å¯¹è±¡æŒ‰ç…§orderçš„é…ç½®æ”¾å…¥Listé›†åˆã€‚</li>
</ul>
<blockquote>
<p>æ€»ç»“</p>
</blockquote>
<ul>
<li>å®ç°è§†å›¾çš„æ ¸å¿ƒç±»å’Œæ¥å£åŒ…æ‹¬ï¼šViewResolverRegistryã€DispatcherServletã€ViewResolverã€View</li>
<li>å¦‚æœä½ æƒ³å®šåˆ¶è‡ªå·±çš„è§†å›¾ç»„ä»¶ï¼š<ul>
<li>ç¼–å†™ç±»å®ç°ViewResolveræ¥å£ï¼Œå®ç°resolveViewNameæ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å®Œæˆ<code>é€»è¾‘è§†å›¾å</code>è½¬æ¢ä¸º<code>ç‰©ç†è§†å›¾å</code>ï¼Œå¹¶è¿”å›Viewå¯¹è±¡ã€‚</li>
<li>ç¼–å†™ç±»å®ç°Viewæ¥å£ï¼Œå®ç°renderæ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å°†æ¨¡æ¿è¯­è¨€è½¬æ¢æˆHTMLä»£ç ï¼Œå¹¶å°†HTMLä»£ç å“åº”åˆ°æµè§ˆå™¨ã€‚</li>
</ul>
</li>
<li>å¦‚æœSpring MVCæ¡†æ¶ä¸­ä½¿ç”¨Thymeleafä½œä¸ºè§†å›¾æŠ€æœ¯ã€‚é‚£ä¹ˆç›¸å…³çš„ç±»åŒ…æ‹¬ï¼š<ul>
<li>ThymeleafView</li>
<li>ThymeleafViewResolver</li>
</ul>
</li>
</ul>
<h2 id="1-4-å®ç°è§†å›¾æœºåˆ¶çš„åŸç†æè¿°"><a href="#1-4-å®ç°è§†å›¾æœºåˆ¶çš„åŸç†æè¿°" class="headerlink" title="1.4 å®ç°è§†å›¾æœºåˆ¶çš„åŸç†æè¿°"></a>1.4 å®ç°è§†å›¾æœºåˆ¶çš„åŸç†æè¿°</h2><blockquote>
<p>å‡è®¾æˆ‘ä»¬SpringMVCä¸­ä½¿ç”¨äº†Thymeleafä½œä¸ºè§†å›¾ã€‚</p>
</blockquote>
<ol>
<li><p>æµè§ˆå™¨å‘é€è¯·æ±‚ç»™webæœåŠ¡å™¨</p>
</li>
<li><p>Spring MVCä¸­çš„DispatcherServletæ¥æ”¶åˆ°è¯·æ±‚</p>
</li>
<li><p>DispatcherServletæ ¹æ®è¯·æ±‚è·¯å¾„åˆ†å‘åˆ°å¯¹åº”çš„Controller</p>
</li>
<li><p>DispatcherServletè°ƒç”¨Controllerçš„æ–¹æ³•</p>
</li>
<li><p>Controllerçš„æ–¹æ³•å¤„ç†ä¸šåŠ¡å¹¶è¿”å›ä¸€ä¸ª<code>é€»è¾‘è§†å›¾å</code>ç»™DispatcherServlet</p>
</li>
<li><p>DispatcherServletè°ƒç”¨ThymeleafViewResolverçš„resolveViewNameæ–¹æ³•ï¼Œå°†<code>é€»è¾‘è§†å›¾å</code>è½¬æ¢ä¸º<code>ç‰©ç†è§†å›¾å</code>ï¼Œå¹¶åˆ›å»ºThymeleafViewå¯¹è±¡è¿”å›ç»™DispatcherServlet</p>
</li>
<li><p>DispatcherServletå†è°ƒç”¨ThymeleafViewçš„renderæ–¹æ³•ï¼Œrenderæ–¹æ³•å°†æ¨¡æ¿è¯­è¨€è½¬æ¢ä¸ºHTMLä»£ç ï¼Œå“åº”ç»™æµè§ˆå™¨ï¼Œå®Œæˆæœ€ç»ˆçš„æ¸²æŸ“ã€‚</p>
</li>
</ol>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬SpringMVCä¸­ä½¿ç”¨äº†JSPä½œä¸ºè§†å›¾ã€‚</p>
</blockquote>
<ol>
<li><p>æµè§ˆå™¨å‘é€è¯·æ±‚ç»™webæœåŠ¡å™¨</p>
</li>
<li><p>Spring MVCä¸­çš„DispatcherServletæ¥æ”¶åˆ°è¯·æ±‚</p>
</li>
<li><p>DispatcherServletæ ¹æ®è¯·æ±‚è·¯å¾„åˆ†å‘åˆ°å¯¹åº”çš„Controller</p>
</li>
<li><p>DispatcherServletè°ƒç”¨Controllerçš„æ–¹æ³•</p>
</li>
<li><p>Controllerçš„æ–¹æ³•å¤„ç†ä¸šåŠ¡å¹¶è¿”å›ä¸€ä¸ª<code>é€»è¾‘è§†å›¾å</code>ç»™DispatcherServlet</p>
</li>
<li><p>DispatcherServletè°ƒç”¨<code>InternalResourceViewResolver</code>çš„<code>resolveViewName</code>æ–¹æ³•ï¼Œå°†<code>é€»è¾‘è§†å›¾å</code>è½¬æ¢ä¸º<code>ç‰©ç†è§†å›¾å</code>ï¼Œå¹¶åˆ›å»º<code>InternalResourceView</code>å¯¹è±¡è¿”å›ç»™DispatcherServlet</p>
</li>
<li><p>DispatcherServletå†è°ƒç”¨<code>InternalResourceView</code>çš„<code>render</code>æ–¹æ³•ï¼Œrenderæ–¹æ³•å°†æ¨¡æ¿è¯­è¨€è½¬æ¢ä¸ºHTMLä»£ç ï¼Œå“åº”ç»™æµè§ˆå™¨ï¼Œå®Œæˆæœ€ç»ˆçš„æ¸²æŸ“ã€‚</p>
</li>
</ol>
<h2 id="1-5-é€»è¾‘è§†å›¾ååˆ°ç‰©ç†è§†å›¾åçš„è½¬æ¢"><a href="#1-5-é€»è¾‘è§†å›¾ååˆ°ç‰©ç†è§†å›¾åçš„è½¬æ¢" class="headerlink" title="1.5 é€»è¾‘è§†å›¾ååˆ°ç‰©ç†è§†å›¾åçš„è½¬æ¢"></a>1.5 é€»è¾‘è§†å›¾ååˆ°ç‰©ç†è§†å›¾åçš„è½¬æ¢</h2><p>é€»è¾‘è§†å›¾åæœ€ç»ˆè½¬æ¢çš„ç‰©ç†è§†å›¾åæ˜¯ä»€ä¹ˆï¼Œå–å†³å†springmvc.xmlæ–‡ä»¶ä¸­è§†å›¾è§£æå™¨çš„é…ç½®ï¼š</p>
<p>å‡å¦‚è§†å›¾è§£æå™¨é…ç½®çš„æ˜¯<code>ThymeleafViewResolver</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ç¨‹åºè¿”å›é€»è¾‘è§†å›¾åï¼šindex</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆé€»è¾‘è§†å›¾å<code>index</code>è½¬æ¢ä¸ºç‰©ç†è§†å›¾åï¼š<code>/WEB-INF/templates/index.html</code></p>
<p>å‡å¦‚è§†å›¾è§£æå™¨é…ç½®çš„æ˜¯<code>InternalResourceViewResolver</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ç¨‹åºè¿”å›é€»è¾‘è§†å›¾åï¼šindex</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆé€»è¾‘è§†å›¾å<code>index</code>è½¬æ¢ä¸ºç‰©ç†è§†å›¾åï¼š<code>/WEB-INF/templates/index.jsp</code></p>
<h1 id="2-Thymeleafè§†å›¾"><a href="#2-Thymeleafè§†å›¾" class="headerlink" title="2. Thymeleafè§†å›¾"></a>2. Thymeleafè§†å›¾</h1><p>æˆ‘ä»¬åœ¨å­¦ä¹ å‰é¢å†…å®¹çš„æ—¶å€™ï¼Œé‡‡ç”¨çš„éƒ½æ˜¯Thymeleafè§†å›¾ã€‚æˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹åº•å±‚åˆ›å»ºçš„è§†å›¾å¯¹è±¡æ˜¯ä¸æ˜¯<code>ThymeleafView</code>ã€‚</p>
<p>1ã€springmvc.xmlé…ç½®å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€Controllerä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>SpringMVCè§†å›¾å®ç°åŸç†<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€æ·»åŠ æ–­ç‚¹ï¼šåœ¨<code>DispatcherServlet</code>çš„<code>doDispatch</code>æ–¹æ³•çš„ä¸‹å›¾ä½ç½®æ·»åŠ æ–­ç‚¹</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%9C%A8doDispatch%E6%96%B9%E6%B3%95%E6%B7%BB%E5%8A%A0%E6%96%AD%E7%82%B9.png" alt="åœ¨doDispatchæ–¹æ³•æ·»åŠ æ–­ç‚¹"></p>
<p>5ã€å¯åŠ¨Tomcatï¼Œåœ¨æµè§ˆå™¨åœ°å€æ ä¸Šå‘é€è¯·æ±‚ï¼š<a href="http://localhost:8080/springmvc/index">http://localhost:8080/springmvc/index</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E7%A8%8B%E5%BA%8F%E5%88%B0%E8%BE%BE%E4%BD%8D%E7%BD%AE.png" alt="å‘é€è¯·æ±‚ç¨‹åºåˆ°è¾¾ä½ç½®"></p>
<p>ç¨‹åºèµ°åˆ°ä»¥ä¸Šä½ç½®ï¼Œè¿™è¡Œä»£ç æ˜¯è°ƒç”¨å¯¹åº”çš„Controllerï¼Œå¹¶ä¸”Controlleræœ€ç»ˆä¼šè¿”å›<code>ModelAndView</code>å¯¹è±¡ï¼š<code>mv</code></p>
<p>6ã€æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰æ‰€è®²ï¼Œè¿”å›<code>mv</code>ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯è§†å›¾å¤„ç†ä¸æ¸²æŸ“ï¼Œæ¥ç€å¾€ä¸‹èµ°ï¼Œèµ°åˆ°ä¸‹å›¾è¿™ä¸€è¡Œï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%A4%84%E7%90%86%E5%88%86%E5%8F%91%E7%BB%93%E6%9E%9C%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="å¤„ç†åˆ†å‘ç»“æœçš„æ–¹æ³•"></p>
<p>7ã€è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å¤„ç†åˆ†å‘ç»“æœï¼Œå°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•å½“ä¸­è¿›è¡Œäº†è§†å›¾çš„å¤„ç†ä¸æ¸²æŸ“ï¼Œè¿›å…¥è¯¥æ–¹æ³•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BF%9B%E5%85%A5%E5%A4%84%E7%90%86%E5%88%86%E5%8F%91%E7%BB%93%E6%9E%9C%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="è¿›å…¥å¤„ç†åˆ†å‘ç»“æœçš„æ–¹æ³•"></p>
<p>8ã€è¿›å»ä¹‹åèµ°åˆ°ä¸Šå›¾ä½ç½®ï¼šè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥æ¸²æŸ“é¡µé¢çš„æ–¹æ³•ï¼Œå†è¿›å…¥è¯¥æ–¹æ³•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BF%9B%E5%85%A5%E7%94%A8%E6%9D%A5%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="è¿›å…¥ç”¨æ¥æ¸²æŸ“é¡µé¢çš„æ–¹æ³•"></p>
<p>èµ°åˆ°ä¸Šå›¾ä½ç½®å°±å¯ä»¥çœ‹åˆ°åº•å±‚åˆ›å»ºçš„æ˜¯<code>ThymeleafView</code>å¯¹è±¡ã€‚</p>
<h1 id="3-JSPè§†å›¾ï¼ˆäº†è§£ï¼‰"><a href="#3-JSPè§†å›¾ï¼ˆäº†è§£ï¼‰" class="headerlink" title="3. JSPè§†å›¾ï¼ˆäº†è§£ï¼‰"></a>3. JSPè§†å›¾ï¼ˆäº†è§£ï¼‰</h1><p>æˆ‘ä»¬å†æ¥è·Ÿä¸€ä¸‹æºç ï¼Œçœ‹çœ‹JSPè§†å›¾åº•å±‚åˆ›å»ºçš„æ˜¯ä¸æ˜¯<code>InternalResourceView</code>å¯¹è±¡ã€‚</p>
<p>æˆ‘ä»¬å‰é¢è¯´è¿‡ <code>InternalResourceView</code> æ˜¯SpringMVCæ¡†æ¶å†…ç½®çš„ï¼Œç¿»è¯‘ä¸ºå†…éƒ¨èµ„æºè§†å›¾ï¼ŒSpringMVCæŠŠJSPçœ‹åšæ˜¯å†…éƒ¨èµ„æºã€‚å¯è§JSPåœ¨ä¹‹å‰çš„æŠ€æœ¯æ ˆä¸­æœ‰å¾ˆé«˜çš„åœ°ä½ã€‚</p>
<p>ä¸è¿‡ï¼Œå½“ä¸‹æµè¡Œçš„å¼€å‘ä¸­JSPä½¿ç”¨è¾ƒå°‘ï¼Œè¿™é‡Œä¸å†è¯¦ç»†è®²è§£ã€‚åªæ˜¯æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p>1ã€springmvc.xmlé…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--JSPçš„è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jspViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€Controllerä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: muyoukule</span><br><span class="line">  Date: 2024/4/7</span><br><span class="line">  Time: 12:29</span><br><span class="line">  To change this template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Jspé¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æˆ‘çš„ç¬¬Nä¸ªJspé¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨webå®¹å™¨ï¼Œæ·»åŠ æ–­ç‚¹è·Ÿè¸ªï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0%E6%96%AD%E7%82%B9%E6%B5%8B%E8%AF%95JSP%E8%A7%86%E5%9B%BE%E5%BA%95%E5%B1%82%E5%88%9B%E5%BB%BA%E7%9A%84%E5%AF%B9%E8%B1%A1.png" alt="æ·»åŠ æ–­ç‚¹æµ‹è¯•JSPè§†å›¾åº•å±‚åˆ›å»ºçš„å¯¹è±¡"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šå¯¹äºJSPè§†å›¾æ¥è¯´ï¼Œåº•å±‚åˆ›å»ºçš„è§†å›¾å¯¹è±¡æ˜¯<code>InternalResourceView</code>ã€‚</p>
<h1 id="4-è½¬å‘ä¸é‡å®šå‘"><a href="#4-è½¬å‘ä¸é‡å®šå‘" class="headerlink" title="4. è½¬å‘ä¸é‡å®šå‘"></a>4. è½¬å‘ä¸é‡å®šå‘</h1><h2 id="4-1-å›é¡¾è½¬å‘å’Œé‡å®šå‘åŒºåˆ«"><a href="#4-1-å›é¡¾è½¬å‘å’Œé‡å®šå‘åŒºåˆ«" class="headerlink" title="4.1 å›é¡¾è½¬å‘å’Œé‡å®šå‘åŒºåˆ«"></a>4.1 å›é¡¾è½¬å‘å’Œé‡å®šå‘åŒºåˆ«</h2><ul>
<li><p>è½¬å‘æ˜¯ä¸€æ¬¡è¯·æ±‚ã€‚å› æ­¤æµè§ˆå™¨åœ°å€æ ä¸Šçš„åœ°å€ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼›é‡å®šå‘æ˜¯ä¸¤æ¬¡è¯·æ±‚ã€‚å› æ­¤æµè§ˆå™¨åœ°å€æ ä¸Šçš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–</p>
</li>
<li><p>è½¬å‘çš„ä»£ç å®ç°ï¼š<code>request.getRequestDispatcher(&quot;/index&quot;).forward(request, response)</code>ï¼›é‡å®šå‘çš„ä»£ç å®ç°ï¼š<code>response.sendRedirect(&quot;/webapproot/index&quot;)</code></p>
</li>
<li><p>è½¬å‘æ˜¯æœåŠ¡å™¨å†…éƒ¨èµ„æºè·³è½¬ï¼Œç”±æœåŠ¡å™¨æ¥æ§åˆ¶ã€‚ä¸å¯å®ç°è·¨åŸŸè®¿é—®ï¼›é‡å®šå‘å¯ä»¥å®Œæˆå†…éƒ¨èµ„æºçš„è·³è½¬ï¼Œä¹Ÿå¯ä»¥å®Œæˆè·¨åŸŸè·³è½¬</p>
</li>
<li><p>è½¬å‘çš„æ–¹å¼<code>å¯ä»¥è®¿é—®WEB-INF</code>ç›®å½•ä¸‹å—ä¿æŠ¤çš„èµ„æºï¼›é‡å®šå‘ç›¸å½“äºæµè§ˆå™¨é‡æ–°å‘é€äº†ä¸€æ¬¡è¯·æ±‚ï¼Œåœ¨æµè§ˆå™¨ç›´æ¥å‘é€çš„è¯·æ±‚æ˜¯<code>æ— æ³•è®¿é—®WEB-INFç›®å½•</code>ä¸‹å—ä¿æŠ¤çš„èµ„æºçš„</p>
<p>è½¬å‘åŸç†ï¼š</p>
<ul>
<li>å‡è®¾å‘é€äº† <code>/a</code> è¯·æ±‚ï¼Œæ‰§è¡Œäº† AServlet</li>
<li>åœ¨AServlet ä¸­é€šè¿‡<code>request.getRequestDispatcher(&quot;/b&quot;).forward(request,response)</code>ï¼›è½¬å‘åˆ°BServlet</li>
<li>ä»AServletè·³è½¬åˆ°BServletæ˜¯æœåŠ¡å™¨å†…éƒ¨æ¥æ§åˆ¶çš„ã€‚å¯¹äºæµè§ˆå™¨è€Œè¨€ï¼Œæµè§ˆå™¨åªå‘é€äº†ä¸€ä¸ª <code>/a</code> è¯·æ±‚</li>
</ul>
<p>é‡å®šå‘åŸç†ï¼š</p>
<ul>
<li>å‡è®¾å‘é€äº† <code>/a</code> è¯·æ±‚ï¼Œæ‰§è¡Œäº† AServlet</li>
<li>åœ¨AServlet ä¸­é€šè¿‡<code>response.sendRedirect(&quot;/webapproot/b&quot;)</code>é‡å®šå‘åˆ°BServlet</li>
<li>æ­¤æ—¶æœåŠ¡å™¨ä¼šå°†è¯·æ±‚è·¯å¾„<code>/webapproot/b</code>å“åº”ç»™æµè§ˆå™¨</li>
<li>æµè§ˆå™¨ä¼šè‡ªå‘çš„å†æ¬¡å‘é€<code>/webapproot/b</code>è¯·æ±‚æ¥è®¿é—®BServlet</li>
<li>å› æ­¤å¯¹äºé‡å®šå‘æ¥è¯´ï¼Œå‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸€æ¬¡æ˜¯ <code>/webapproot/a</code>ï¼Œå¦ä¸€æ¬¡æ˜¯<code>/webapproot/b</code>ã€‚</li>
</ul>
</li>
</ul>
<p>ä»¥ä¸Šæ‰€æè¿°çš„æ˜¯ä½¿ç”¨åŸç”ŸServlet APIæ¥å®Œæˆè½¬å‘å’Œé‡å®šå‘ã€‚åœ¨Spring MVCä¸­æ˜¯å¦‚ä½•è½¬å‘å’Œé‡å®šå‘çš„å‘¢ï¼Ÿ</p>
<h2 id="4-2-forward"><a href="#4-2-forward" class="headerlink" title="4.2 forward"></a>4.2 forward</h2><p>åœ¨Spring MVCä¸­é»˜è®¤å°±æ˜¯è½¬å‘çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¹‹å‰æ‰€å†™çš„ç¨‹åºï¼Œéƒ½æ˜¯è½¬å‘çš„æ–¹å¼ã€‚åªä¸è¿‡éƒ½æ˜¯è½¬å‘åˆ°Thymeleafçš„æ¨¡æ¿æ–‡ä»¶xxx.htmlä¸Šã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨Spring MVCä¸­å¦‚ä½•è½¬å‘åˆ°å¦ä¸€ä¸ªControllerä¸Šå‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨Spring MVCçš„<code>forward</code></p>
<p>1ã€ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForwardController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/a&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toA</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›çš„æ˜¯ä¸€ä¸ªé€»è¾‘è§†å›¾åç§°</span></span><br><span class="line">        <span class="comment">//return &quot;a&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡‡ç”¨SpringMVCçš„è½¬å‘æ–¹å¼è·³è½¬åˆ° /b</span></span><br><span class="line">        <span class="comment">// è½¬å‘çš„æ—¶å€™ï¼Œæ ¼å¼æœ‰ç‰¹æ®Šè¦æ±‚ï¼š return &quot;forward:ä¸‹ä¸€ä¸ªèµ„æºçš„è·¯å¾„&quot;;</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªå°±ä¸æ˜¯é€»è¾‘è§†å›¾åç§°äº†ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;forward:/b&quot;</span>; <span class="comment">// åˆ›å»ºInternalResourceViewå¯¹è±¡ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/b&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toB</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›çš„æ˜¯ä¸€ä¸ªé€»è¾‘è§†å›¾åç§°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;b&quot;</span>; <span class="comment">// åˆ›å»ºThymeleafViewå¯¹è±¡ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>b<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page B!!!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµè§ˆå™¨åœ°å€æ ä¸Šè¾“å…¥ï¼š<a href="http://localhost:8080/springmvc/a">http://localhost:8080/springmvc/a</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%AF%B7%E6%B1%82a%E8%BD%AC%E5%8F%91%E5%88%B0b.png"></p>
<p>é€šè¿‡æµ‹è¯•ï¼Œå¯ä»¥é¡ºåˆ©çš„å®Œæˆè½¬å‘ï¼Œè½¬å‘æ˜¯ä¸€æ¬¡è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°åœ°å€æ ä¸Šçš„<strong>åœ°å€æ²¡æœ‰å‘ç”Ÿæ”¹å˜</strong>ã€‚</p>
<blockquote>
<p>æºç å‰–æ</p>
</blockquote>
<p>æˆ‘ä»¬æ¥è·Ÿè¸ªä¸€ä¸‹æºç ï¼Œçœ‹çœ‹ä»¥ä¸Šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºäº†å‡ ä¸ªè§†å›¾å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82%E5%88%9B%E5%BB%BAInternalResourceView%E5%AF%B9%E8%B1%A1.png" alt="è½¬å‘è¯·æ±‚åˆ›å»ºInternalResourceViewå¯¹è±¡"></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82%E5%88%9B%E5%BB%BAThymeleafView%E5%AF%B9%E8%B1%A1.png" alt="è½¬å‘è¯·æ±‚åˆ›å»ºThymeleafViewå¯¹è±¡"></p>
<p>é€šè¿‡æºç çš„è·Ÿè¸ªå¾—çŸ¥ï¼šæ•´ä¸ªè¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä¸€å…±åˆ›å»ºäº†ä¸¤ä¸ªè§†å›¾å¯¹è±¡</p>
<ul>
<li>InternalResourceView</li>
<li>ThymeleafView</li>
</ul>
<p>è¿™è¯´æ˜<strong>è½¬å‘</strong>åº•å±‚åˆ›å»ºçš„è§†å›¾å¯¹è±¡æ˜¯ï¼š<code>InternalResourceView</code>ã€‚</p>
<blockquote>
<p>æ€è€ƒ</p>
</blockquote>
<p>æ—¢ç„¶ä¼šåˆ›å»ºInternalResourceViewï¼Œåº”è¯¥ä¼šå¯¹åº”ä¸€ä¸ªè§†å›¾è§£æå™¨å‘€ï¼ˆInternalResourceViewResolverï¼‰ï¼Ÿä½†æ˜¯æˆ‘åœ¨springmvc.xmlæ–‡ä»¶ä¸­åªé…ç½®äº†ThymeleafViewResolverï¼Œå¹¶æ²¡æœ‰é…ç½®InternalResourceViewResolverå‘€ï¼Ÿè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p>
<p><font color="red"><strong>è¿™æ˜¯å› ä¸º<code>forward:</code> åé¢çš„ä¸æ˜¯<code>é€»è¾‘è§†å›¾å</code>ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>è¯·æ±‚è·¯å¾„</code>ã€‚å› æ­¤è½¬å‘æ˜¯ä¸éœ€è¦è§†å›¾è§£æå™¨çš„ã€‚</strong>ğŸ˜å¦å¤–ï¼Œè½¬å‘ä½¿ç”¨çš„æ˜¯InternalResourceViewï¼Œä¹Ÿè¯´æ˜äº†<strong>è½¬å‘æ˜¯å†…éƒ¨èµ„æºçš„è·³è½¬</strong>ã€‚ï¼ˆInternalæ˜¯å†…éƒ¨çš„æ„æ€ï¼ŒResourceæ˜¯èµ„æºçš„æ„æ€ã€‚ï¼‰</font></p>
<h2 id="4-3-redirect"><a href="#4-3-redirect" class="headerlink" title="4.3 redirect"></a>4.3 redirect</h2><p>redirectæ˜¯ä¸“é—¨å®Œæˆé‡å®šå‘æ•ˆæœçš„ã€‚å’Œforwardè¯­æ³•ç±»ä¼¼ï¼Œåªéœ€è¦å°†ä¹‹å‰çš„ <code>return &quot;forward:/b&quot;</code>ä¿®æ”¹ä¸º <code>return &quot;redirect:/b&quot;</code>å³å¯ã€‚</p>
<p>1ã€Controllerä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/a&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toA</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/b&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/b&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toB</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>b<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Page B!!!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµè§ˆå™¨åœ°å€æ ä¸Šè¾“å…¥ï¼š<a href="http://localhost:8080/springmvc/a">http://localhost:8080/springmvc/a</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%AF%B7%E6%B1%82a%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0b.png" alt="è¯·æ±‚aé‡å®šå‘åˆ°b"></p>
<p>å¯è§ï¼Œé‡å®šå‘æ˜¯ä¸¤æ¬¡è¯·æ±‚ï¼Œåœ°å€æ ä¸Šçš„<strong>åœ°å€å‘ç”Ÿäº†æ”¹å˜</strong>ã€‚</p>
<blockquote>
<p>æºç å‰–æ</p>
</blockquote>
<p>å¯ä»¥çœ‹ä¸€ä¸‹æºç ï¼Œåœ¨é‡å®šå‘çš„æ—¶å€™ï¼ŒSpring MVCåˆ›å»ºå“ªä¸ªè§†å›¾å¯¹è±¡ï¼Ÿ</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%87%8D%E5%AE%9A%E5%90%91%E8%AF%B7%E6%B1%82%E5%88%9B%E5%BB%BARedirectView%E5%AF%B9%E8%B1%A1.png" alt="é‡å®šå‘è¯·æ±‚åˆ›å»ºRedirectViewå¯¹è±¡"></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%87%8D%E5%AE%9A%E5%90%91%E8%AF%B7%E6%B1%82%E5%88%9B%E5%BB%BAThymeleafView%E5%AF%B9%E8%B1%A1.png" alt="é‡å®šå‘è¯·æ±‚åˆ›å»ºThymeleafViewå¯¹è±¡"></p>
<p>é€šè¿‡æ–­ç‚¹è°ƒè¯•å¯ä»¥çœ‹å‡ºï¼Œå½“é‡å®šå‘çš„æ—¶å€™ï¼ŒSpringMVCä¼šåˆ›å»ºä¸€ä¸ª<strong>é‡å®šå‘</strong>è§†å›¾å¯¹è±¡ï¼š**<code>RedirectView</code>**ã€‚è¿™ä¸ªè§†å›¾å¯¹è±¡ä¹Ÿæ˜¯SpringMVCæ¡†æ¶å†…ç½®çš„ã€‚</p>
<p>å¦å¤–å¯ä»¥çœ‹å‡ºé‡å®šå‘ä¹‹åçš„ç¬¬äºŒæ¬¡è¯·æ±‚åˆ›å»ºçš„è§†å›¾å¯¹è±¡å°±æ˜¯<code>ThymeleafView</code>äº†ã€‚</p>
<p><strong>PSï¼šä»springmvcåº”ç”¨é‡å®šå‘åˆ°springmvc2åº”ç”¨ï¼ˆè·¨åŸŸï¼‰ï¼Œ</strong>è¯­æ³•æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/a&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">a</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:http://localhost:8080/springmvc2/b&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¸€ä¸‹ï¼ï¼ï¼</p>
<h1 id="5"><a href="#5" class="headerlink" title="5. &lt;mvc:view-controller&gt;"></a>5. &lt;mvc:view-controller&gt;</h1><p><code>&lt;mvc:view-controller&gt;</code> é…ç½®ç”¨äºå°†æŸä¸ªè¯·æ±‚æ˜ å°„åˆ°ç‰¹å®šçš„è§†å›¾ä¸Šï¼Œå³æŒ‡å®šæŸä¸€ä¸ª URL è¯·æ±‚åˆ°ä¸€ä¸ªè§†å›¾èµ„æºçš„æ˜ å°„ï¼Œä½¿å¾—è¿™ä¸ªè§†å›¾èµ„æºå¯ä»¥è¢«è®¿é—®ã€‚å®ƒç›¸å½“äºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¤„ç†ç¨‹åºï¼Œä¸éœ€è¦ç¼–å†™ä»»ä½• Controllerï¼Œåªéœ€è¦æŒ‡å®š URL å’Œå¯¹åº”çš„è§†å›¾åç§°å°±å¯ä»¥äº†ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>&lt;mvc:view-controller&gt;</code> é…ç½®å¯ä»¥æ›¿ä»£ä¸€äº›æ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„ Controllerï¼Œä¾‹å¦‚é¦–é¡µã€é”™è¯¯é¡µé¢ç­‰ã€‚å½“ç”¨æˆ·è®¿é—®é…ç½®çš„ URL æ—¶ï¼Œæ¡†æ¶å°†ç›´æ¥åŒ¹é…åˆ°å¯¹åº”çš„è§†å›¾ï¼Œè€Œæ— éœ€å†ç»è¿‡å…¶ä»–æ§åˆ¶å™¨çš„å¤„ç†ã€‚</p>
<p><code>&lt;mvc:view-controller&gt;</code> é…ç½®çš„æ ¼å¼å¦‚ä¸‹ï¼š </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/å¦‚ä½•è®¿é—®è¯¥é¡µé¢&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;å¯¹åº”çš„é€»è¾‘è§†å›¾åç§°&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>path</code>ï¼šè¢«æ˜ å°„çš„ URL è·¯å¾„ã€‚</li>
<li><code>view-name</code>ï¼šå¯¹åº”çš„é€»è¾‘è§†å›¾åç§°ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œé…ç½®é¦–é¡µçš„æ˜ å°„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°é…ç½®å°†ä¼šåŒ¹é…ä¸Šè®¿é—®åº”ç”¨ç¨‹åºçš„æ ¹è·¯å¾„ï¼Œå¦‚ï¼š<a href="http://localhost:8080/%E3%80%82%E5%BD%93%E7%94%A8%E6%88%B7%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E8%AE%BF%E9%97%AE%E8%AF%A5%E6%A0%B9%E8%B7%AF%E5%BE%84%E6%97%B6%EF%BC%8C%E5%B0%B1%E4%BC%9A%E7%9B%B4%E6%8E%A5%E6%B8%B2%E6%9F%93%E5%90%8D%E4%B8%BA">http://localhost:8080/ã€‚å½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¯¥æ ¹è·¯å¾„æ—¶ï¼Œå°±ä¼šç›´æ¥æ¸²æŸ“åä¸º</a> <code>index</code> çš„è§†å›¾ã€‚</p>
<p><font color="red"><strong>PSï¼šå½“ä½ ä½¿ç”¨äº† &lt;<code>mvc:view-controller</code>&gt; é…ç½®ï¼Œä¼šè®©ä½ æ•´ä¸ªé¡¹ç›®ä¸­æ‰€æœ‰çš„æ³¨è§£å…¨éƒ¨å¤±æ•ˆï¼Œä½ éœ€è¦ä½¿ç”¨ä»¥ä¸‹çš„é…ç½®æ¥å†æ¬¡å¼€å¯æ³¨è§£ã€‚</strong></font></p>
<h1 id="6"><a href="#6" class="headerlink" title="6. &lt;mvc:annotation-driven&#x2F;&gt;"></a>6. &lt;mvc:annotation-driven&#x2F;&gt;</h1><p>åœ¨SpringMVCä¸­ï¼Œå¦‚æœåœ¨springmvc.xmlæ–‡ä»¶ä¸­é…ç½®äº† <code>&lt;mvc:view-controller&gt;</code>ï¼Œå°±éœ€è¦åŒæ—¶åœ¨springmvc.xmlæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¯¥é…ç½®çš„ä½œç”¨æ˜¯ï¼šå¯ç”¨Spring MVCçš„æ³¨è§£ã€‚</p>
<p><strong>å¦‚æœæ²¡æœ‰ä»¥ä¸Šçš„é…ç½®ï¼ŒControllerå°±æ— æ³•è®¿é—®åˆ°ã€‚</strong>è®¿é—®ä¹‹å‰çš„Controllerä¼šå‘ç”Ÿ 404 é—®é¢˜ã€‚</p>
<h1 id="7-è®¿é—®é™æ€èµ„æº"><a href="#7-è®¿é—®é™æ€èµ„æº" class="headerlink" title="7. è®¿é—®é™æ€èµ„æº"></a>7. è®¿é—®é™æ€èµ„æº</h1><p>ä¸€ä¸ªé¡¹ç›®å¯èƒ½ä¼šåŒ…å«å¤§é‡çš„é™æ€èµ„æºï¼Œæ¯”å¦‚ï¼šcssã€jsã€imagesç­‰ã€‚</p>
<p>ç”±äºæˆ‘ä»¬DispatcherServletçš„url-patterné…ç½®çš„æ˜¯<code>/</code>ï¼Œä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼Œè¿™ä¸ª<code>/</code>ä»£è¡¨çš„æ˜¯é™¤jspè¯·æ±‚ä¹‹å¤–çš„æ‰€æœ‰è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´è®¿é—®åº”ç”¨ä¸­çš„é™æ€èµ„æºï¼Œä¹Ÿä¼šèµ°DispatcherServletï¼Œè¿™ä¼šå¯¼è‡´404é”™è¯¯ï¼Œæ— æ³•è®¿é—®é™æ€èµ„æºï¼Œå¦‚ä½•è§£å†³ï¼Œä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä½¿ç”¨é»˜è®¤ Servlet å¤„ç†é™æ€èµ„æº</li>
<li>ä½¿ç”¨ <code>mvc:resources</code> æ ‡ç­¾é…ç½®é™æ€èµ„æºå¤„ç†</li>
</ul>
<p>è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œè‡ªè¡Œé€‰æ‹©ã€‚</p>
<h2 id="7-1-ä½¿ç”¨é»˜è®¤Servletå¤„ç†é™æ€èµ„æº"><a href="#7-1-ä½¿ç”¨é»˜è®¤Servletå¤„ç†é™æ€èµ„æº" class="headerlink" title="7.1 ä½¿ç”¨é»˜è®¤Servletå¤„ç†é™æ€èµ„æº"></a>7.1 ä½¿ç”¨é»˜è®¤Servletå¤„ç†é™æ€èµ„æº</h2><p>é¦–å…ˆéœ€è¦åœ¨springmvc.xmlæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¼€å¯ <code>é»˜è®¤Servletå¤„ç†é™æ€èµ„æº</code> åŠŸèƒ½ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼€å¯æ³¨è§£é©±åŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å¼€å¯é»˜è®¤Servletå¤„ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨web.xmlæ–‡ä»¶ä¸­æŒ‡å®šä»€ä¹ˆæ ·çš„è·¯å¾„èµ°å…¶ä»–Servletï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>0<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>listings<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šé…ç½®url-patternä½¿ç”¨çš„ä¹Ÿæ˜¯<code>/</code>ï¼Œå’ŒDispatcherServletä¸€æ ·ã€‚è¡¨ç¤ºçš„å«ä¹‰æ˜¯ï¼š<font color="red"><strong>åŒä¸€ä¸ªè¯·æ±‚è·¯å¾„ï¼Œå…ˆèµ°DispatcherServletï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™èµ°é»˜è®¤çš„Servletã€‚</strong></font></p>
<p>é»˜è®¤çš„ Servlet ç±»ä¸­çš„ä»£ç å·²ç»ç”± Tomcat æœåŠ¡å™¨æä¾›äº†å®ç°ï¼Œä¸€èˆ¬ä¸éœ€è¦å¼€å‘è€…è‡ªå·±ç¼–å†™ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº† <code>org.apache.catalina.servlets.DefaultServlet</code>ï¼Œåˆ™ Tomcat æœåŠ¡å™¨ä¼šè‡ªåŠ¨å°†è¯·æ±‚è½¬å‘ç»™è¯¥ç±»å¤„ç†ã€‚åœ¨å¤„ç†æ—¶ï¼Œè¯¥ç±»ä¼šæ ¹æ®è¯·æ±‚çš„ URL å»æŸ¥è¯¢ Web åº”ç”¨çš„é™æ€èµ„æºï¼ˆå¦‚ HTMLã€CSSã€JavaScript å’Œå›¾ç‰‡ç­‰ï¼‰ï¼Œå¹¶å°†å…¶è¿”å›ç»™ç”¨æˆ·ã€‚</p>
<p>å‘Šè¯‰å¤§å®¶ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œä»¥ä¸Šåœ¨web.xmlæ–‡ä»¶ä¸­çš„é…ç½®æˆ‘ä»¬ä¹Ÿå¯ä»¥çœç•¥äº†ï¼Œå› ä¸ºåœ¨TomcatæœåŠ¡å™¨ä¸­å·²ç»ä¸ºæˆ‘ä»¬æå‰é…ç½®å¥½äº†ï¼Œåœ¨<code>CATALINA_HOME/conf/web.xml</code>æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat%E8%87%AA%E5%B8%A6%E7%9A%84servlet%E9%85%8D%E7%BD%AE%E9%A1%B9.png" alt="Tomcatè‡ªå¸¦çš„servleté…ç½®é¡¹" style="zoom: 80%;">

<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat%E8%87%AA%E5%B8%A6%E7%9A%84servlet-mapping%E9%85%8D%E7%BD%AE%E9%A1%B9.png" alt="Tomcatè‡ªå¸¦çš„servlet-mappingé…ç½®é¡¹"></p>
<p>å› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨springmvc.xmlæ–‡ä»¶ä¸­å¯ç”¨è¿™ä¸ªé»˜è®¤çš„Servletå³å¯ï¼š<code>&lt;mvc:default-servlet-handler&gt;</code></p>
<h2 id="7-2-ä½¿ç”¨-mvc-resources-æ ‡ç­¾é…ç½®é™æ€èµ„æº"><a href="#7-2-ä½¿ç”¨-mvc-resources-æ ‡ç­¾é…ç½®é™æ€èµ„æº" class="headerlink" title="7.2 ä½¿ç”¨ mvc:resources æ ‡ç­¾é…ç½®é™æ€èµ„æº"></a>7.2 ä½¿ç”¨ mvc:resources æ ‡ç­¾é…ç½®é™æ€èµ„æº</h2><p>è®¿é—®é™æ€èµ„æºï¼Œä¹Ÿå¯ä»¥åœ¨springmvc.xmlæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼€å¯æ³¨è§£é©±åŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®é™æ€èµ„æºå¤„ç† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/static/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/static/&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºå‡¡æ˜¯è¯·æ±‚è·¯å¾„æ˜¯<code>/static/</code>å¼€å§‹çš„ï¼Œéƒ½ä¼šå»<code>/static/</code>ç›®å½•ä¸‹æ‰¾è¯¥èµ„æºã€‚</p>
<p><font color="red">PSï¼šè¦æƒ³ä½¿ç”¨ <code>&lt;mvc:resources&gt;</code> é…ç½®ï¼Œå¿…é¡»å¼€å¯æ³¨è§£é©±åŠ¨ <code>&lt;mvc:annotation-driven /&gt;</code></font></p>
<h1 id="é™„å½•ï¼šè§†å›¾æœºåˆ¶æºç è·Ÿè¸ª"><a href="#é™„å½•ï¼šè§†å›¾æœºåˆ¶æºç è·Ÿè¸ª" class="headerlink" title="é™„å½•ï¼šè§†å›¾æœºåˆ¶æºç è·Ÿè¸ª"></a>é™„å½•ï¼šè§†å›¾æœºåˆ¶æºç è·Ÿè¸ª</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å‰ç«¯æ§åˆ¶å™¨çš„æ ¸å¿ƒæ–¹æ³•ï¼Œå¤„ç†è¯·æ±‚ï¼Œè¿”å›è§†å›¾ï¼Œæ¸²æŸ“è§†å›¾ï¼Œéƒ½æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å®Œæˆçš„ã€‚</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// æ ¹æ®è¯·æ±‚è·¯å¾„è°ƒç”¨æ˜ å°„çš„å¤„ç†å™¨æ–¹æ³•ï¼Œå¤„ç†å™¨æ–¹æ³•æ‰§è¡Œç»“æŸä¹‹åï¼Œè¿”å›é€»è¾‘è§†å›¾åç§°</span></span><br><span class="line">		<span class="comment">// è¿”å›é€»è¾‘è§†å›¾åç§°ä¹‹åï¼ŒDispatcherServletä¼šå°† é€»è¾‘è§†å›¾åç§°ViewName + Modelï¼Œå°†å…¶å°è£…ä¸ºModelAndViewå¯¹è±¡ã€‚</span></span><br><span class="line">		mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å¤„ç†è§†å›¾</span></span><br><span class="line">		processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">			<span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// æ¸²æŸ“é¡µé¢ï¼ˆå°†æ¨¡æ¿å­—ç¬¦ä¸²è½¬æ¢æˆhtmlä»£ç å“åº”åˆ°æµè§ˆå™¨ï¼‰</span></span><br><span class="line">		render(mv, request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">render</span><span class="params">(ModelAndView mv, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å°† é€»è¾‘è§†å›¾åç§° è½¬æ¢æˆ ç‰©ç†è§†å›¾åç§° ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›è§†å›¾å¯¹è±¡View</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> resolveViewName(viewName, mv.getModelInternal(), locale, request);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// çœŸæ­£çš„å°†æ¨¡æ¿å­—ç¬¦ä¸²è½¬æ¢æˆHTMLä»£ç ï¼Œå¹¶ä¸”å°†HTMLä»£ç å“åº”ç»™æµè§ˆå™¨ã€‚ï¼ˆçœŸæ­£çš„æ¸²æŸ“ã€‚ï¼‰</span></span><br><span class="line">		view.render(mv.getModelInternal(), request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> View <span class="title function_">resolveViewName</span><span class="params">(String viewName, <span class="meta">@Nullable</span> Map&lt;String, Object&gt; model,</span></span><br><span class="line"><span class="params">			Locale locale, HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// å…¶å®è¿™ä¸€è¡Œä»£ç æ‰æ˜¯çœŸæ­£èµ·ä½œç”¨çš„ï¼šå°† é€»è¾‘è§†å›¾åç§° è½¬æ¢æˆ ç‰©ç†è§†å›¾åç§° ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›è§†å›¾å¯¹è±¡View</span></span><br><span class="line">		ViewResolver viewResolver;  <span class="comment">// åº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªThymeleafViewResolver</span></span><br><span class="line">		<span class="comment">// å¦‚æœä½¿ç”¨çš„æ˜¯Thymeleafï¼Œé‚£ä¹ˆè¿”å›çš„è§†å›¾å¯¹è±¡ï¼šThymeleafViewå¯¹è±¡ã€‚</span></span><br><span class="line">		<span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> viewResolver.resolveViewName(viewName, locale); </span><br><span class="line">		<span class="keyword">return</span> view;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆè´Ÿè´£è§†å›¾è§£æçš„ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ViewResolver</span> &#123; <span class="comment">// å¦‚æœä½¿ç”¨Thymeleafï¼Œé‚£ä¹ˆè¯¥æ¥å£çš„å®ç°ç±»å°±æ˜¯ï¼šThymeleafViewResolver</span></span><br><span class="line">	<span class="comment">// è¿™ä¸ªæ–¹æ³•å°±æ˜¯å°†:é€»è¾‘è§†å›¾åç§° è½¬æ¢æˆ ç‰©ç†è§†å›¾åç§° ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›è§†å›¾å¯¹è±¡View</span></span><br><span class="line">	View <span class="title function_">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆè´Ÿè´£å°† æ¨¡æ¿å­—ç¬¦ä¸² è½¬æ¢æˆHTMLä»£ç ï¼Œå“åº”ç»™æµè§ˆå™¨ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">View</span> &#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">render</span><span class="params">(<span class="meta">@Nullable</span> Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">			<span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	æ ¸å¿ƒç±»ï¼šDispatcherServlet</span></span><br><span class="line"><span class="comment">	æ ¸å¿ƒæ¥å£1ï¼šViewResolverï¼ˆå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Thymeleafï¼Œé‚£ä¹ˆåº•å±‚ä¼šåˆ›å»ºThymeleafViewResolverå¯¹è±¡ï¼‰</span></span><br><span class="line"><span class="comment">	æ ¸å¿ƒæ¥å£2ï¼šViewï¼ˆå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Thymeleafï¼Œé‚£ä¹ˆåº•å±‚ä¼šåˆ›å»ºThymeleafViewå¯¹è±¡ï¼‰</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	ç»“è®ºï¼šå¦‚æœä½ è‡ªå·±æƒ³å®ç°å±äºè‡ªå·±çš„è§†å›¾ã€‚ä½ è‡³å°‘éœ€è¦ç¼–å†™ä¸¤ä¸ªç±»ï¼Œ</span></span><br><span class="line"><span class="comment">		ä¸€ä¸ªç±»å®ç°ViewResolveræ¥å£ï¼Œå®ç°å…¶ä¸­çš„resolveViewNameæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">		å¦ä¸€ä¸ªç±»å®ç°Viewæ¥å£ï¼Œå®ç°å…¶ä¸­çš„renderæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬4ç« ã€‘ ä¸‰ä¸ªåŸŸå¯¹è±¡</title>
    <url>/posts/SpringMVC-Chapter-Four-Three-Domain-Object/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-Servletä¸­çš„ä¸‰ä¸ªåŸŸå¯¹è±¡"><a href="#1-Servletä¸­çš„ä¸‰ä¸ªåŸŸå¯¹è±¡" class="headerlink" title="1. Servletä¸­çš„ä¸‰ä¸ªåŸŸå¯¹è±¡"></a>1. Servletä¸­çš„ä¸‰ä¸ªåŸŸå¯¹è±¡</h1><ul>
<li><p>è¯·æ±‚åŸŸï¼š<code>request</code></p>
</li>
<li><p>ä¼šè¯åŸŸï¼š<code>session</code></p>
</li>
<li><p>åº”ç”¨åŸŸï¼š<code>application</code></p>
</li>
</ul>
<p>ä¸‰ä¸ªåŸŸéƒ½æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‘åŸŸä¸­å­˜å‚¨æ•°æ®</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">setAttribute</span><span class="params">(String name, Object obj)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»åŸŸä¸­è¯»å–æ•°æ®</span></span><br><span class="line">Object <span class="title function_">getAttribute</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤åŸŸä¸­çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">removeAttribute</span><span class="params">(String name)</span>;</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯é€šè¿‡ï¼š<code>setAttribute + getAttribute</code> æ–¹æ³•æ¥å®Œæˆåœ¨åŸŸä¸­æ•°æ®çš„<strong>ä¼ é€’</strong>å’Œ<strong>å…±äº«</strong>ã€‚</p>
<h2 id="1-1-request"><a href="#1-1-request" class="headerlink" title="1.1 request"></a>1.1 request</h2><p>æ¥å£åï¼š<code>HttpServletRequest</code></p>
<p>ç®€ç§°ï¼š<code>request</code></p>
<p>requestå¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡è¯·æ±‚ã€‚ä¸€æ¬¡è¯·æ±‚ä¸€ä¸ªrequestã€‚</p>
<p>ä½¿ç”¨è¯·æ±‚åŸŸçš„ä¸šåŠ¡åœºæ™¯ï¼šåœ¨Aèµ„æºä¸­é€šè¿‡è½¬å‘çš„æ–¹å¼è·³è½¬åˆ°Bèµ„æºï¼Œå› ä¸ºæ˜¯è½¬å‘ï¼Œå› æ­¤ä»Aåˆ°Bæ˜¯ä¸€æ¬¡è¯·æ±‚ï¼Œå¦‚æœæƒ³è®©Aèµ„æºå’ŒBèµ„æºå…±äº«åŒä¸€ä¸ªæ•°æ®ï¼Œå¯ä»¥å°†æ•°æ®å­˜å‚¨åˆ°requeståŸŸä¸­ã€‚</p>
<h2 id="1-2-session"><a href="#1-2-session" class="headerlink" title="1.2 session"></a>1.2 session</h2><p>æ¥å£åï¼š<code>HttpSession</code></p>
<p>ç®€ç§°ï¼š<code>session</code></p>
<p>sessionå¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡ä¼šè¯ã€‚ä»æ‰“å¼€æµè§ˆå™¨å¼€å§‹è®¿é—®ï¼Œåˆ°æœ€ç»ˆæµè§ˆå™¨å…³é—­ï¼Œè¿™æ˜¯ä¸€æ¬¡å®Œæ•´çš„ä¼šè¯ã€‚æ¯ä¸ªä¼šè¯sessionå¯¹è±¡éƒ½å¯¹åº”ä¸€ä¸ªJSESSIONIDï¼Œè€ŒJSESSIONIDç”Ÿæˆåä»¥cookieçš„æ–¹å¼å­˜å‚¨åœ¨æµè§ˆå™¨å®¢æˆ·ç«¯ã€‚æµè§ˆå™¨å…³é—­ï¼ŒJSESSIONIDå¤±æ•ˆï¼Œä¼šè¯ç»“æŸã€‚</p>
<p>ä½¿ç”¨ä¼šè¯åŸŸçš„ä¸šåŠ¡åœºæ™¯ï¼š</p>
<ul>
<li>åœ¨Aèµ„æºä¸­é€šè¿‡é‡å®šå‘çš„æ–¹å¼è·³è½¬åˆ°Bèµ„æºï¼Œå› ä¸ºæ˜¯é‡å®šå‘ï¼Œå› æ­¤ä»Aåˆ°Bæ˜¯ä¸¤æ¬¡è¯·æ±‚ï¼Œå¦‚æœæƒ³è®©Aèµ„æºå’ŒBèµ„æºå…±äº«åŒä¸€ä¸ªæ•°æ®ï¼Œå¯ä»¥å°†æ•°æ®å­˜å‚¨åˆ°sessionåŸŸä¸­ã€‚</li>
<li>ç™»å½•æˆåŠŸåä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚</li>
</ul>
<h2 id="1-3-application"><a href="#1-3-application" class="headerlink" title="1.3 application"></a>1.3 application</h2><p>æ¥å£åï¼š<code>ServletContext</code></p>
<p>ç®€ç§°ï¼š<code>application</code></p>
<p>applicationå¯¹è±¡ä»£è¡¨äº†æ•´ä¸ªwebåº”ç”¨ï¼ŒæœåŠ¡å™¨å¯åŠ¨æ—¶åˆ›å»ºï¼ŒæœåŠ¡å™¨å…³é—­æ—¶é”€æ¯ã€‚å¯¹äºä¸€ä¸ªwebåº”ç”¨æ¥è¯´ï¼Œapplicationå¯¹è±¡åªæœ‰ä¸€ä¸ªã€‚</p>
<p>ä½¿ç”¨åº”ç”¨åŸŸçš„ä¸šåŠ¡åœºæ™¯ï¼šè®°å½•ç½‘ç«™çš„åœ¨çº¿äººæ•°ã€‚</p>
<h1 id="2-requeståŸŸå¯¹è±¡"><a href="#2-requeståŸŸå¯¹è±¡" class="headerlink" title="2. requeståŸŸå¯¹è±¡"></a>2. requeståŸŸå¯¹è±¡</h1><p>åœ¨SpringMVCä¸­ï¼Œåœ¨<code>request</code>åŸŸä¸­å…±äº«æ•°æ®æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨åŸç”ŸServlet APIæ–¹å¼</li>
<li>ä½¿ç”¨Modelæ¥å£</li>
<li>ä½¿ç”¨Mapæ¥å£</li>
<li>ä½¿ç”¨ModelMapç±»</li>
<li>ä½¿ç”¨ModelAndViewç±»</li>
</ul>
<h2 id="2-1-ä½¿ç”¨åŸç”ŸServlet-APIæ–¹å¼"><a href="#2-1-ä½¿ç”¨åŸç”ŸServlet-APIæ–¹å¼" class="headerlink" title="2.1 ä½¿ç”¨åŸç”ŸServlet APIæ–¹å¼"></a>2.1 ä½¿ç”¨åŸç”ŸServlet APIæ–¹å¼</h2><p>1ã€æ–°å»ºä¸€ä¸ªæ¨¡å—ï¼ˆæ­¥éª¤å‚è€ƒå‰é¢æ¨¡å—ï¼‰ï¼Œåˆ›å»º <code>IndexController</code> å’Œ <code>index.html</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åˆ›å»ºindex.htmlå¹¶æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•ä¸‰ä¸ªåŸŸå¯¹è±¡<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>æµ‹è¯•requeståŸŸå¯¹è±¡<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testServletAPI&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨åŸç”ŸServlet APIå®ŒæˆrequeståŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨Controllerçš„æ–¹æ³•ä¸Šä½¿ç”¨<code>HttpServletRequest</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestScopeTestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testServletAPI&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testServletAPI</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// å‘requeståŸŸä¸­å­˜å‚¨æ•°æ®</span></span><br><span class="line">        request.setAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCä¸­ä½¿ç”¨åŸç”ŸServlet APIå®ç°requeståŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">        <span class="comment">// è·³è½¬è§†å›¾ï¼Œåœ¨è§†å›¾é¡µé¢å°†requeståŸŸä¸­çš„æ•°æ®å–å‡ºæ¥ï¼Œè¿™æ ·å°±å®Œæˆäº†ï¼šControllerå’ŒViewåœ¨åŒä¸€ä¸ªè¯·æ±‚å½“ä¸­ä¸¤ä¸ªç»„ä»¶ä¹‹é—´æ•°æ®çš„å…±äº«ã€‚</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªè·³è½¬ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ï¼šè½¬å‘çš„æ–¹å¼ã€‚ï¼ˆè½¬å‘forwardæ˜¯ä¸€æ¬¡è¯·æ±‚ï¼‰</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªè¿”å›çš„æ˜¯ä¸€ä¸ªé€»è¾‘è§†å›¾åç§°ï¼Œç»è¿‡è§†å›¾è§£æå™¨è§£æï¼Œå˜æˆç‰©ç†è§†å›¾åç§°ã€‚/WEB-INF/thymeleaf/view.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€åˆ›å»ºview.htmlé¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>view<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;testRequestScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E4%BD%BF%E7%94%A8%E5%8E%9F%E7%94%9FAPI%E6%96%B9%E5%BC%8F%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE.png" alt="æµ‹è¯•ä½¿ç”¨åŸç”ŸAPIæ–¹å¼å…±äº«æ•°æ®"></p>
<p>6ã€ç‚¹å‡»é“¾æ¥åæˆåŠŸè·³è½¬ï¼Œå¹¶ä¸”æºå¸¦æ•°æ®ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%88%90%E5%8A%9F%E8%B7%B3%E8%BD%AC%E4%B8%94%E6%90%BA%E5%B8%A6%E6%95%B0%E6%8D%AE.png" alt="æˆåŠŸè·³è½¬ä¸”æºå¸¦æ•°æ®"></p>
<p>è¿™ç§æ–¹å¼å½“ç„¶å¯ä»¥ï¼Œç”¨SpringMVCæ¡†æ¶ï¼Œä¸å»ºè®®ä½¿ç”¨åŸç”ŸServlet APIã€‚</p>
<h2 id="2-2-ä½¿ç”¨Modelæ¥å£"><a href="#2-2-ä½¿ç”¨Modelæ¥å£" class="headerlink" title="2.2 ä½¿ç”¨Modelæ¥å£"></a>2.2 ä½¿ç”¨Modelæ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModel</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">    <span class="comment">// å‘requeståŸŸå½“ä¸­ç»‘å®šæ•°æ®</span></span><br><span class="line">    model.addAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Modelæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">    System.out.println(model);</span><br><span class="line">    System.out.println(model.getClass().getName());</span><br><span class="line">    <span class="comment">// è½¬å‘</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModel&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Modelæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-3-ä½¿ç”¨Mapæ¥å£"><a href="#2-3-ä½¿ç”¨Mapæ¥å£" class="headerlink" title="2.3 ä½¿ç”¨Mapæ¥å£"></a>2.3 ä½¿ç”¨Mapæ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMap</span><span class="params">(Map&lt;String, Object&gt; map)</span>&#123;</span><br><span class="line">    <span class="comment">// å‘requeståŸŸå½“ä¸­å­˜å‚¨æ•°æ®</span></span><br><span class="line">    map.put(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Mapæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">    System.out.println(map);</span><br><span class="line">    System.out.println(map.getClass().getName());</span><br><span class="line">    <span class="comment">// è½¬å‘</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testMap&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Mapæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-4-ä½¿ç”¨ModelMapç±»"><a href="#2-4-ä½¿ç”¨ModelMapç±»" class="headerlink" title="2.4 ä½¿ç”¨ModelMapç±»"></a>2.4 ä½¿ç”¨ModelMapç±»</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModelMap</span><span class="params">(ModelMap modelMap)</span>&#123;</span><br><span class="line">    <span class="comment">// å‘requeståŸŸå½“ä¸­å­˜å‚¨æ•°æ®</span></span><br><span class="line">    modelMap.addAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCå½“ä¸­ä½¿ç”¨ModelMapç±»å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">    System.out.println(modelMap);</span><br><span class="line">    System.out.println(modelMap.getClass().getName());</span><br><span class="line">    <span class="comment">// è½¬å‘</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModelMap&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨ModelMapç±»å®ŒæˆrequeståŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Modelã€Mapã€ModelMapçš„å…³ç³»</p>
</blockquote>
<p>å¯ä»¥åœ¨ä»¥ä¸ŠModelã€Mapã€ModelMapçš„æµ‹è¯•ç¨‹åºä¸­å°†å…¶å’Œå…¶ç±»åè¾“å‡ºï¼Œçœ‹çœ‹è¾“å‡ºä»€ä¹ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;testRequestScope=åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Modelæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&#125;</span><br><span class="line">org.springframework.validation.support.BindingAwareModelMap</span><br><span class="line"></span><br><span class="line">&#123;testRequestScope=åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Mapæ¥å£å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&#125;</span><br><span class="line">org.springframework.validation.support.BindingAwareModelMap</span><br><span class="line"></span><br><span class="line">&#123;testRequestScope=åœ¨SpringMVCå½“ä¸­ä½¿ç”¨ModelMapç±»å®ŒæˆrequeståŸŸæ•°æ®å…±äº«&#125;</span><br><span class="line">org.springframework.validation.support.BindingAwareModelMap</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯Modelã€Mapè¿˜æ˜¯ModelMapï¼Œåº•å±‚å®ä¾‹åŒ–çš„å¯¹è±¡éƒ½æ˜¯ï¼š<code>BindingAwareModelMap</code></p>
<p>å¯ä»¥æŸ¥çœ‹<code>BindingAwareModelMap</code>çš„ç»§æ‰¿ç»“æ„ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/BindingAwareModelMap%E7%BB%A7%E6%89%BF%E7%BB%93%E6%9E%84.png" alt="BindingAwareModelMapç»§æ‰¿ç»“æ„" style="zoom:50%;">

<p>é€šè¿‡ç»§æ‰¿ç»“æ„å¯ä»¥çœ‹å‡ºï¼š<code>BindingAwareModelMap</code>ç»§æ‰¿äº†<code>ExtendedModelMap</code>ï¼Œè€Œ<code>ExtendedModelMap</code>åˆç»§æ‰¿äº†<code>ModelMap</code>å¹¶ä¸”å®ç°äº†<code>Model</code>æ¥å£ã€‚<code>ModelMap</code>é¡¶å±‚åˆæœ‰ä¸€ä¸ª<code>Map</code>æ¥å£ã€‚å› æ­¤è¡¨é¢ä¸Šæ˜¯é‡‡ç”¨äº†ä¸åŒæ–¹å¼ï¼Œåº•å±‚æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ã€‚</p>
<p>SpringMVCä¹‹æ‰€ä»¥æä¾›äº†è¿™äº›æ–¹å¼ï¼Œç›®çš„å°±æ˜¯æ–¹ä¾¿ç¨‹åºå‘˜çš„ä½¿ç”¨ï¼Œæä¾›äº†å¤šæ ·åŒ–çš„æ–¹å¼ï¼Œå¯è§å®ƒçš„é‡è¦æ€§ã€‚</p>
<h2 id="2-5-ä½¿ç”¨ModelAndViewç±»"><a href="#2-5-ä½¿ç”¨ModelAndViewç±»" class="headerlink" title="2.5 ä½¿ç”¨ModelAndViewç±»"></a>2.5 ä½¿ç”¨ModelAndViewç±»</h2><p>åœ¨SpringMVCæ¡†æ¶ä¸­ä¸ºäº†æ›´å¥½çš„ä½“ç°MVCæ¶æ„æ¨¡å¼ï¼Œæä¾›äº†ä¸€ä¸ªç±»ï¼š<code>ModelAndView</code>ã€‚è¿™ä¸ªç±»çš„å®ä¾‹å°è£…äº†Modelå’ŒViewã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç±»æ—¢å°è£…ä¸šåŠ¡å¤„ç†ä¹‹åçš„æ•°æ®ï¼Œä¹Ÿä½“ç°äº†è·³è½¬åˆ°å“ªä¸ªè§†å›¾ã€‚ä½¿ç”¨å®ƒä¹Ÿå¯ä»¥å®ŒæˆrequeståŸŸæ•°æ®å…±äº«ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelAndView&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">testModelAndView</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºâ€œæ¨¡å‹ä¸è§†å›¾å¯¹è±¡â€</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    <span class="comment">// ç»‘å®šæ•°æ®</span></span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCä¸­ä½¿ç”¨ModelAndViewå®ç°requeståŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">    <span class="comment">// ç»‘å®šè§†å›¾</span></span><br><span class="line">    modelAndView.setViewName(<span class="string">&quot;view&quot;</span>);</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModelAndView&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨ModelAndViewç±»å®ŒæˆrequeståŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ä¸æ˜¯Stringï¼Œè€Œæ˜¯<code>ModelAndViewå¯¹è±¡</code></li>
<li>ModelAndViewä¸æ˜¯å‡ºç°åœ¨æ–¹æ³•çš„å‚æ•°ä½ç½®ï¼Œè€Œæ˜¯åœ¨æ–¹æ³•ä½“ä¸­newçš„</li>
<li>éœ€è¦è°ƒç”¨addObjectå‘åŸŸä¸­å­˜å‚¨æ•°æ®</li>
<li>éœ€è¦è°ƒç”¨setViewNameè®¾ç½®è§†å›¾çš„åå­—</li>
</ul>
<blockquote>
<p>ModelAndViewæºç åˆ†æ</p>
</blockquote>
<p>ä»¥ä¸Šæˆ‘ä»¬é€šè¿‡äº†äº”ç§æ–¹å¼å®Œæˆäº†requeståŸŸæ•°æ®å…±äº«ï¼ŒåŒ…æ‹¬ï¼š<code>åŸç”ŸServlet API</code>ï¼Œ<code>Model</code>ã€<code>Map</code>ã€<code>ModelMap</code>ã€<code>ModelAndView</code>ã€‚</p>
<p>å…¶ä¸­åå››ç§ï¼šModelã€Mapã€ModelMapã€ModelAndViewã€‚è¿™å››ç§æ–¹å¼åœ¨åº•å±‚<code>DispatcherServlet</code>è°ƒç”¨æˆ‘ä»¬çš„Controllerä¹‹åï¼Œè¿”å›çš„å¯¹è±¡éƒ½æ˜¯<code>ModelAndView</code>ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æºç è¿›è¡Œåˆ†æã€‚</p>
<p>åœ¨ä»¥ä¸Šå››ç§æ–¹å¼ä¸­ï¼Œæ‹¿Modelä¸¾ä¾‹ï¼Œæ·»åŠ æ–­ç‚¹è¿›è¡Œè°ƒè¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0%E6%96%AD%E7%82%B9%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95.png" alt="æ·»åŠ æ–­ç‚¹è¿›è¡Œè°ƒè¯•"></p>
<p>debugæ¨¡å¼å¯åŠ¨æœåŠ¡å™¨ï¼Œå‘é€è¯·æ±‚ï¼Œèµ°åˆ°æ–­ç‚¹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%B5%B0%E5%88%B0%E6%96%AD%E7%82%B9.png" alt="èµ°åˆ°æ–­ç‚¹"></p>
<p>æŸ¥çœ‹VM Stackä¿¡æ¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9F%A5%E7%9C%8BVMStack%E4%BF%A1%E6%81%AF.png" alt="æŸ¥çœ‹VM Stackä¿¡æ¯"></p>
<p>æŸ¥çœ‹<code>DispatcherServlet</code>ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/DispatcherServlet%E6%BA%90%E7%A0%81.png" alt="DispatcherServletæºç "></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œï¼Œæ— è®ºä½ ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œæœ€ç»ˆéƒ½è¦è¿”å›ä¸€ä¸ª<code>ModelAndViewå¯¹è±¡</code>ã€‚</p>
<p>PSï¼šå¤§å®¶å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–­ç‚¹è°ƒè¯•æ–¹å¼ï¼Œé‡‡ç”¨ä¸€çº§ä¸€çº§è¿”å›ï¼Œæœ€ç»ˆå¯ä»¥çœ‹åˆ°éƒ½ä¼šè¿”å›ModelAndViewå¯¹è±¡ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/StepOut%E6%8C%89%E9%92%AE.png" alt="Step OutæŒ‰é’®"></p>
<h1 id="3-sessionåŸŸå¯¹è±¡"><a href="#3-sessionåŸŸå¯¹è±¡" class="headerlink" title="3. sessionåŸŸå¯¹è±¡"></a>3. sessionåŸŸå¯¹è±¡</h1><p>åœ¨SpringMVCä¸­ä½¿ç”¨<code>session</code>åŸŸå…±äº«æ•°æ®ï¼Œå®ç°æ–¹å¼æœ‰å¤šç§ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨åŸç”ŸServlet API</li>
<li>ä½¿ç”¨SessionAttributesæ³¨è§£</li>
</ul>
<h2 id="3-1-ä½¿ç”¨åŸç”ŸServlet-API"><a href="#3-1-ä½¿ç”¨åŸç”ŸServlet-API" class="headerlink" title="3.1 ä½¿ç”¨åŸç”ŸServlet API"></a>3.1 ä½¿ç”¨åŸç”ŸServlet API</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionScopeTestController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testSessionServletAPI&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testServletAPI</span><span class="params">(HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ ¸å¿ƒä¸šåŠ¡....</span></span><br><span class="line">        <span class="comment">// å°†æ•°æ®å­˜å‚¨åˆ°sessionä¸­</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;testSessionScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCå½“ä¸­ä½¿ç”¨åŸç”ŸServlet APIå®ŒæˆsessionåŸŸæ•°æ®å…±äº«&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿”å›é€»è¾‘è§†å›¾åç§°ï¼ˆè¿™æ˜¯ä¸€ä¸ªè½¬å‘çš„è¡Œä¸ºï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨view.htmlè§†å›¾é¡µé¢æ·»åŠ ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.testSessionScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>index.htmlæ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>æµ‹è¯•sessionåŸŸå¯¹è±¡<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testSessionServletAPI&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨åŸç”ŸServlet APIå®ŒæˆsessionåŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-ä½¿ç”¨SessionAttributesæ³¨è§£"><a href="#3-2-ä½¿ç”¨SessionAttributesæ³¨è§£" class="headerlink" title="3.2 ä½¿ç”¨SessionAttributesæ³¨è§£"></a>3.2 ä½¿ç”¨SessionAttributesæ³¨è§£</h2><p>ä½¿ç”¨<code>@SessionAttributes</code>æ³¨è§£æ ‡æ³¨Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">//@SessionAttributes(value = &#123;&quot;x&quot;, &quot;y&quot;&#125;)</span></span><br><span class="line"><span class="meta">@SessionAttributes(&#123;&quot;x&quot;, &quot;y&quot;&#125;)</span> <span class="comment">// æ ‡æ³¨xå’Œyéƒ½æ˜¯å­˜æ”¾åˆ°sessionåŸŸä¸­ï¼Œè€Œä¸æ˜¯requeståŸŸã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionScopeTestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testSessionAttributes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testSessionAttributes</span><span class="params">(ModelMap modelMap)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†ä¸šåŠ¡</span></span><br><span class="line">        <span class="comment">// å°†æ•°æ®å­˜å‚¨åˆ°sessionåŸŸå½“ä¸­</span></span><br><span class="line">        modelMap.addAttribute(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;æˆ‘æ˜¯åŸƒå…‹æ–¯&quot;</span>);</span><br><span class="line">        modelMap.addAttribute(<span class="string">&quot;y&quot;</span>, <span class="string">&quot;æˆ‘æ˜¯æ­ª&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿”å›é€»è¾‘è§†å›¾åç§°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>PSï¼šSessionAttributesæ³¨è§£ä½¿ç”¨åœ¨Controllerç±»ä¸Šã€‚æ ‡æ³¨äº†å½“keyæ˜¯ x æˆ–è€… y æ—¶ï¼Œæ•°æ®å°†è¢«å­˜å‚¨åˆ°ä¼šè¯<code>session</code>ä¸­ã€‚å¦‚æœæ²¡æœ‰ <code>@SessionAttributes</code>æ³¨è§£ï¼Œé»˜è®¤å­˜å‚¨åˆ°<code>request</code>åŸŸä¸­ã€‚</strong></font>ğŸ˜…</p>
<p>åœ¨view.htmlè§†å›¾é¡µé¢æ·»åŠ ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.x&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.y&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testSessionAttributes&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨@SessionAttributesæ³¨è§£å®ŒæˆsessionåŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="4-applicationåŸŸå¯¹è±¡"><a href="#4-applicationåŸŸå¯¹è±¡" class="headerlink" title="4. applicationåŸŸå¯¹è±¡"></a>4. applicationåŸŸå¯¹è±¡</h1><p>åœ¨SpringMVCå®ç°<code>application</code>åŸŸæ•°æ®å…±äº«ï¼Œæœ€å¸¸è§çš„æ–¹æ¡ˆå°±æ˜¯ç›´æ¥ä½¿ç”¨Servlet APIäº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationScopeTestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testApplicationScope&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testApplicationScope</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// å°†æ•°æ®å­˜å‚¨åˆ°applicationåŸŸå½“ä¸­</span></span><br><span class="line">        <span class="comment">// è·å–applicationå¯¹è±¡ï¼Œå…¶å®å°±æ˜¯è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="comment">// æ€ä¹ˆè·å–ServletContextå¯¹è±¡ï¼Ÿé€šè¿‡requestï¼Œé€šè¿‡sessionéƒ½å¯ä»¥è·å–ã€‚</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">        application.setAttribute(<span class="string">&quot;testApplicationScope&quot;</span>, <span class="string">&quot;åœ¨SpringMVCä¸­ä½¿ç”¨ServletAPIå®ç°applicationåŸŸå…±äº«&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;view&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨view.htmlè§†å›¾é¡µé¢æ·»åŠ ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;application.testApplicationScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨index.htmlé¡µé¢æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>æµ‹è¯•applicationåŸŸå¯¹è±¡<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testApplicationScope&#125;&quot;</span>&gt;</span>æµ‹è¯•åœ¨SpringMVCå½“ä¸­ä½¿ç”¨Servlet APIå®ç°applicationåŸŸæ•°æ®å…±äº«<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬14ç« ã€‘ SSMæ•´åˆ</title>
    <url>/posts/SpringMVC-Chapter-Fourteen-SSM-Integration/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-å¼•å…¥ç›¸å…³ä¾èµ–"><a href="#1-å¼•å…¥ç›¸å…³ä¾èµ–" class="headerlink" title="1. å¼•å…¥ç›¸å…³ä¾èµ–"></a>1. å¼•å…¥ç›¸å…³ä¾èµ–</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.muyoukule<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm-annotation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springmvc--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--spring jdbc--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis spring--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¾·é²ä¼Šè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--jackson--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.17.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--servlet api--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--logback--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--thymeleafå’Œspring6çš„æ•´åˆä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombokä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="2-SSMæ•´åˆ"><a href="#2-SSMæ•´åˆ" class="headerlink" title="2. SSMæ•´åˆ"></a>2. SSMæ•´åˆ</h1><p>åˆ›å»ºé¡¹ç›®ç»“æ„</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SSM%E6%95%B4%E5%90%88%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" alt="SSMæ•´åˆé¡¹ç›®ç»“æ„" style="zoom: 67%;">



<h2 id="1-1-Springæ•´åˆMyBatis"><a href="#1-1-Springæ•´åˆMyBatis" class="headerlink" title="1.1 Springæ•´åˆMyBatis"></a>1.1 Springæ•´åˆMyBatis</h2><h3 id="1-1-1-ç¼–å†™jdbc-properties"><a href="#1-1-1-ç¼–å†™jdbc-properties" class="headerlink" title="1.1.1 ç¼–å†™jdbc.properties"></a>1.1.1 ç¼–å†™jdbc.properties</h3><p>åœ¨ç±»æ ¹è·¯å¾„ä¸‹åˆ›å»ºå±æ€§é…ç½®æ–‡ä»¶ï¼Œé…ç½®è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼š<code>jdbc.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/spring_db?useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;useSSL=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-ç¼–å†™DataSourceConfig"><a href="#1-1-2-ç¼–å†™DataSourceConfig" class="headerlink" title="1.1.2 ç¼–å†™DataSourceConfig"></a>1.1.2 ç¼–å†™DataSourceConfig</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(driver);</span><br><span class="line">        dataSource.setUrl(url);</span><br><span class="line">        dataSource.setUsername(username);</span><br><span class="line">        dataSource.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-3-ç¼–å†™MyBatisConfig"><a href="#1-1-3-ç¼–å†™MyBatisConfig" class="headerlink" title="1.1.3 ç¼–å†™MyBatisConfig"></a>1.1.3 ç¼–å†™MyBatisConfig</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.mapper.MapperScannerConfigurer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBatisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">SqlSessionFactoryBean</span> <span class="variable">sqlSessionFactoryBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSource);</span><br><span class="line">        sqlSessionFactoryBean.setTypeAliasesPackage(<span class="string">&quot;com.muyoukule.bean&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.muyoukule.dao&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-4-ç¼–å†™SpringConfig"><a href="#1-1-4-ç¼–å†™SpringConfig" class="headerlink" title="1.1.4 ç¼–å†™SpringConfig"></a>1.1.4 ç¼–å†™SpringConfig</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.muyoukule.service&quot;&#125;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;DataSourceConfig.class, MyBatisConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-Springæ•´åˆSpring-MVC"><a href="#1-2-Springæ•´åˆSpring-MVC" class="headerlink" title="1.2 Springæ•´åˆSpring MVC"></a>1.2 Springæ•´åˆSpring MVC</h2><h3 id="1-2-1-ç¼–å†™WebAppInitializerï¼ˆweb-xmlï¼‰"><a href="#1-2-1-ç¼–å†™WebAppInitializerï¼ˆweb-xmlï¼‰" class="headerlink" title="1.2.1 ç¼–å†™WebAppInitializerï¼ˆweb.xmlï¼‰"></a>1.2.1 ç¼–å†™WebAppInitializerï¼ˆweb.xmlï¼‰</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebAppInitializer</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Springçš„é…ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SpringMVCçš„é…ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMvcConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æ¥é…ç½®DispatcherServletçš„ &lt;url-pattern&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="comment">// é…ç½®å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨</span></span><br><span class="line">        <span class="type">CharacterEncodingFilter</span> <span class="variable">characterEncodingFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">        characterEncodingFilter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        characterEncodingFilter.setForceResponseEncoding(<span class="literal">true</span>);</span><br><span class="line">        characterEncodingFilter.setForceRequestEncoding(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// é…ç½®HiddenHttpMethodFilter</span></span><br><span class="line">        <span class="type">HiddenHttpMethodFilter</span> <span class="variable">hiddenHttpMethodFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HiddenHttpMethodFilter</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;characterEncodingFilter, hiddenHttpMethodFilter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-ç¼–å†™SpringMvcConfig"><a href="#1-2-2-ç¼–å†™SpringMvcConfig" class="headerlink" title="1.2.2 ç¼–å†™SpringMvcConfig"></a>1.2.2 ç¼–å†™SpringMvcConfig</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.handler&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•åˆå¹¶èµ·æ¥å°±æ˜¯å¼€å¯è§†å›¾è§£æå™¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ThymeleafViewResolver <span class="title function_">getViewResolver</span><span class="params">(SpringTemplateEngine springTemplateEngine)</span> &#123;</span><br><span class="line">        <span class="type">ThymeleafViewResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThymeleafViewResolver</span>();</span><br><span class="line">        resolver.setTemplateEngine(springTemplateEngine);</span><br><span class="line">        resolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resolver.setOrder(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> resolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SpringTemplateEngine <span class="title function_">templateEngine</span><span class="params">(ITemplateResolver iTemplateResolver)</span> &#123;</span><br><span class="line">        <span class="type">SpringTemplateEngine</span> <span class="variable">templateEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringTemplateEngine</span>();</span><br><span class="line">        templateEngine.setTemplateResolver(iTemplateResolver);</span><br><span class="line">        <span class="keyword">return</span> templateEngine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ITemplateResolver <span class="title function_">templateResolver</span><span class="params">(ApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        <span class="type">SpringResourceTemplateResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringResourceTemplateResolver</span>();</span><br><span class="line">        resolver.setApplicationContext(applicationContext);</span><br><span class="line">        resolver.setPrefix(<span class="string">&quot;/WEB-INF/thymeleaf/&quot;</span>);</span><br><span class="line">        resolver.setSuffix(<span class="string">&quot;.html&quot;</span>);</span><br><span class="line">        resolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        resolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resolver.setCacheable(<span class="literal">false</span>);<span class="comment">//å¼€å‘æ—¶å…³é—­ç¼“å­˜ï¼Œæ”¹åŠ¨å³å¯ç”Ÿæ•ˆ</span></span><br><span class="line">        <span class="keyword">return</span> resolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å¯é™æ€èµ„æºå¤„ç†ï¼Œå¼€å¯é»˜è®¤çš„Servletå¤„ç†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">        configurer.enable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§†å›¾æ§åˆ¶å™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®å¼‚å¸¸å¤„ç†å™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®æ‹¦æˆªå™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-3-æ·»åŠ äº‹åŠ¡æ§åˆ¶"><a href="#1-3-æ·»åŠ äº‹åŠ¡æ§åˆ¶" class="headerlink" title="1.3 æ·»åŠ äº‹åŠ¡æ§åˆ¶"></a>1.3 æ·»åŠ äº‹åŠ¡æ§åˆ¶</h2><p>1ã€åœ¨SpringConfigä¸­å¼€å¯äº‹åŠ¡ç®¡ç†å™¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€åœ¨DataSourceConfigä¸­æ·»åŠ äº‹åŠ¡ç®¡ç†å™¨å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> PlatformTransactionManager <span class="title function_">platformTransactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">    <span class="type">DataSourceTransactionManager</span> <span class="variable">dataSourceTransactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">    dataSourceTransactionManager.setDataSource(dataSource);</span><br><span class="line">    <span class="keyword">return</span> dataSourceTransactionManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨serviceç±»ä¸Šæ·»åŠ å¦‚ä¸‹æ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-å®ç°åŠŸèƒ½æµ‹è¯•ssmæ•´åˆ"><a href="#3-å®ç°åŠŸèƒ½æµ‹è¯•ssmæ•´åˆ" class="headerlink" title="3. å®ç°åŠŸèƒ½æµ‹è¯•ssmæ•´åˆ"></a>3. å®ç°åŠŸèƒ½æµ‹è¯•ssmæ•´åˆ</h1><h2 id="3-1-æ•°æ®åº“è¡¨"><a href="#3-1-æ•°æ®åº“è¡¨" class="headerlink" title="3.1 æ•°æ®åº“è¡¨"></a>3.1 æ•°æ®åº“è¡¨</h2><p>tbl_userï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SSM%E6%95%B0%E6%8D%AE%E8%A1%A8.png" alt="SSMæ•°æ®è¡¨"></p>
<h2 id="3-2-pojoç±»ç¼–å†™"><a href="#3-2-pojoç±»ç¼–å†™" class="headerlink" title="3.2 pojoç±»ç¼–å†™"></a>3.2 pojoç±»ç¼–å†™</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-daoç¼–å†™"><a href="#3-3-daoç¼–å†™" class="headerlink" title="3.3 daoç¼–å†™"></a>3.3 daoç¼–å†™</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">selectById</span><span class="params">(Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-serviceç¼–å†™"><a href="#3-4-serviceç¼–å†™" class="headerlink" title="3.4 serviceç¼–å†™"></a>3.4 serviceç¼–å†™</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getById</span><span class="params">(Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.selectById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-5-handlerç¼–å†™"><a href="#3-5-handlerç¼–å†™" class="headerlink" title="3.5 handlerç¼–å†™"></a>3.5 handlerç¼–å†™</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">detail</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-å‰ç«¯å‘é€ajax"><a href="#3-6-å‰ç«¯å‘é€ajax" class="headerlink" title="3.6 å‰ç«¯å‘é€ajax"></a>3.6 å‰ç«¯å‘é€ajax</h2><p>1ã€å¼•å…¥jsæ–‡ä»¶</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SSM%E6%95%B4%E5%90%88%E5%BC%95%E5%85%A5js%E6%96%87%E4%BB%B6.png" alt="SSMæ•´åˆå¼•å…¥jsæ–‡ä»¶"></p>
<p>2ã€å¼€å¯é™æ€èµ„æºå¤„ç†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">    configurer.enable();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€è§†å›¾æ§åˆ¶å™¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">    registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4ã€ç¼–å†™index.htmlé¡µé¢</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ssmæ•´åˆ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¼•å…¥vue--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue3.4.21.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¼•å…¥axios--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getMessage&quot;</span>&gt;</span>æŸ¥çœ‹id=1çš„ç”¨æˆ·ä¿¡æ¯<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:inline</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span></span><br><span class="line">    Vue.createApp(&#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                message: &#x27;&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            async getMessage() &#123;</span><br><span class="line">                let response = await axios.get([[@&#123;/&#125;]] + &#x27;users/1&#x27;)</span><br><span class="line">                    this.message = response.data</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).mount(&quot;#app&quot;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>5ã€æµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SSM%E6%95%B4%E5%90%88%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="SSMæ•´åˆæµ‹è¯•ç»“æœ"></p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬1ç« ã€‘ åˆè¯†SpringMVC</title>
    <url>/posts/SpringMVC-Chapter-One-Acquaintance-SpringMVC/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="0-å­¦ä¹ å‰çš„çŸ¥è¯†å‚¨å¤‡"><a href="#0-å­¦ä¹ å‰çš„çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="0. å­¦ä¹ å‰çš„çŸ¥è¯†å‚¨å¤‡"></a>0. å­¦ä¹ å‰çš„çŸ¥è¯†å‚¨å¤‡</h1><ul>
<li><strong>JavaSE</strong></li>
<li><strong>HTML+CSS+JavaScript</strong></li>
<li><strong>Vue</strong></li>
<li><strong>AJAX + axios</strong></li>
<li><strong>Thymeleaf</strong></li>
<li><strong>Servlet</strong></li>
<li><strong>Maven</strong></li>
<li><strong>Spring</strong></li>
</ul>
<h1 id="1-ä»€ä¹ˆæ˜¯MVC"><a href="#1-ä»€ä¹ˆæ˜¯MVC" class="headerlink" title="1. ä»€ä¹ˆæ˜¯MVC"></a>1. ä»€ä¹ˆæ˜¯MVC</h1><p>MVCæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼ˆæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„è®¾è®¡æ€æƒ³ï¼Œä¸æ­¢Javaå¼€å‘ä¸­ç”¨åˆ°ï¼Œå…¶å®ƒè¯­è¨€ä¹Ÿéœ€è¦ç”¨åˆ°ï¼‰ï¼Œå®ƒå°†åº”ç”¨åˆ†ä¸ºä¸‰å—ï¼š</p>
<ul>
<li>Mï¼šModelï¼ˆæ¨¡å‹ï¼‰</li>
<li>Vï¼šViewï¼ˆè§†å›¾ï¼‰</li>
<li>Cï¼šControllerï¼ˆæ§åˆ¶å™¨ï¼‰</li>
</ul>
<p>åº”ç”¨ä¸ºä»€ä¹ˆè¦è¢«åˆ†ä¸ºä¸‰å—ï¼Œä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>ä½è€¦åˆï¼Œæ‰©å±•èƒ½åŠ›å¢å¼º</li>
<li>ä»£ç å¤ç”¨æ€§å¢å¼º</li>
<li>ä»£ç å¯ç»´æŠ¤æ€§å¢å¼º</li>
<li>é«˜å†…èšï¼Œè®©ç¨‹åºå‘˜æ›´åŠ ä¸“æ³¨ä¸šåŠ¡çš„å¼€å‘</li>
</ul>
<p>MVCå°†åº”ç”¨åˆ†ä¸ºä¸‰å—ï¼Œæ¯ä¸€å—å„å¸å…¶èŒï¼Œéƒ½æœ‰è‡ªå·±ä¸“æ³¨çš„äº‹æƒ…è¦åšï¼Œä»–ä»¬å±äºåˆ†å·¥åä½œï¼Œäº’ç›¸é…åˆï¼š</p>
<ul>
<li>Modelï¼šè´Ÿè´£ä¸šåŠ¡å¤„ç†åŠæ•°æ®çš„æ”¶é›†ã€‚</li>
<li>Viewï¼šè´Ÿè´£æ•°æ®çš„å±•ç¤º</li>
<li>Controllerï¼šè´Ÿè´£è°ƒåº¦ã€‚å®ƒæ˜¯ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒï¼Œå®ƒæ¥å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨Modelæ¥å¤„ç†ä¸šåŠ¡ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨Viewè§†å›¾æ¥å±•ç¤ºæ•°æ®ã€‚</li>
</ul>
<p>MVCæ¶æ„æ¨¡å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/MVC%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F.png" alt="MVCæ¶æ„æ¨¡å¼"></p>
<p>MVCæ¶æ„æ¨¡å¼çš„æè¿°ï¼šå‰ç«¯æµè§ˆå™¨å‘é€è¯·æ±‚ç»™WebæœåŠ¡å™¨ï¼ŒWebæœåŠ¡å™¨ä¸­çš„Controlleræ¥æ”¶åˆ°ç”¨æˆ·çš„è¯·æ±‚ï¼ŒControllerè´Ÿè´£å°†å‰ç«¯æäº¤çš„æ•°æ®è¿›è¡Œå°è£…ï¼Œç„¶åControllerè°ƒç”¨Modelæ¥å¤„ç†ä¸šåŠ¡ï¼Œå½“Modelå¤„ç†å®Œä¸šåŠ¡åä¼šè¿”å›å¤„ç†ä¹‹åçš„æ•°æ®ç»™Controllerï¼ŒControllerå†è°ƒç”¨Viewæ¥å®Œæˆæ•°æ®çš„å±•ç¤ºï¼Œæœ€ç»ˆå°†ç»“æœå“åº”ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨è¿›è¡Œæ¸²æŸ“å±•ç¤ºé¡µé¢ã€‚</p>
<blockquote>
<p>ä»€ä¹ˆæ˜¯ä¸‰å±‚æ¨¡å‹ï¼ŸMVCæ¶æ„æ¨¡å¼ä¸ä¸‰å±‚æ¨¡å‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
</blockquote>
<p>ä¸‰å±‚æ¨¡å‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%B8%89%E5%B1%82%E6%A8%A1%E5%9E%8B.png" alt="ä¸‰å±‚æ¨¡å‹" style="zoom: 67%;">                            <img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/MVC%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F%E4%B8%8E%E4%B8%89%E5%B1%82%E6%A8%A1%E5%9E%8B.png" alt="MVCæ¶æ„æ¨¡å¼ä¸ä¸‰å±‚æ¨¡å‹" style="zoom: 67%;"></p>
<p>MVCå’Œä¸‰å±‚æ¨¡å‹éƒ½é‡‡ç”¨äº†åˆ†å±‚ç»“æ„æ¥è®¾è®¡åº”ç”¨ç¨‹åºï¼Œéƒ½æ˜¯é™ä½è€¦åˆåº¦ï¼Œæé«˜æ‰©å±•åŠ›ï¼Œæé«˜ç»„ä»¶å¤ç”¨æ€§ã€‚åŒºåˆ«åœ¨äºï¼šä»–ä»¬çš„å…³æ³¨ç‚¹ä¸åŒï¼Œä¸‰å±‚æ¨¡å‹æ›´åŠ å…³æ³¨ä¸šåŠ¡é€»è¾‘ç»„ä»¶çš„åˆ’åˆ†ã€‚</p>
<p>MVCæ¶æ„æ¨¡å¼å…³æ³¨çš„æ˜¯æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å±‚æ¬¡å…³ç³»å’Œåˆ†ç¦»æ€æƒ³ã€‚ç°ä»£çš„å¼€å‘æ–¹å¼å¤§éƒ¨åˆ†éƒ½æ˜¯MVCæ¶æ„æ¨¡å¼ç»“åˆä¸‰å±‚æ¨¡å‹ä¸€èµ·ç”¨ã€‚</p>
<h1 id="2-ä»€ä¹ˆæ˜¯SpringMVC"><a href="#2-ä»€ä¹ˆæ˜¯SpringMVC" class="headerlink" title="2. ä»€ä¹ˆæ˜¯SpringMVC"></a>2. ä»€ä¹ˆæ˜¯SpringMVC</h1><h2 id="2-1-SpringMVCæ¦‚è¿°"><a href="#2-1-SpringMVCæ¦‚è¿°" class="headerlink" title="2.1 SpringMVCæ¦‚è¿°"></a>2.1 SpringMVCæ¦‚è¿°</h2><p>SpringMVCæ˜¯ä¸€ä¸ªå®ç°äº†MVCæ¶æ„æ¨¡å¼çš„Webæ¡†æ¶ï¼Œåº•å±‚åŸºäºServletå®ç°ã€‚</p>
<p>SpringMVCå·²ç»å°†MVCæ¶æ„æ¨¡å¼å®ç°äº†ï¼Œå› æ­¤åªè¦æˆ‘ä»¬æ˜¯åŸºäºSpringMVCæ¡†æ¶å†™ä»£ç ï¼Œç¼–å†™çš„ç¨‹åºå°±æ˜¯ç¬¦åˆMVCæ¶æ„æ¨¡å¼çš„ã€‚ï¼ˆ<strong>MVCçš„æ¶å­æ­å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»æ·»è¡¥è¡¥</strong>ï¼‰</p>
<p>Springæ¡†æ¶ä¸­æœ‰ä¸€ä¸ªå­é¡¹ç›®å«åšSpring Webï¼ŒSpring Webå­é¡¹ç›®å½“ä¸­åŒ…å«å¾ˆå¤šæ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>Spring MVC</li>
<li>Spring WebFlux</li>
<li>Spring Web Services</li>
<li>Spring Web Flow</li>
<li>Spring WebSocket</li>
<li>Spring Web Services Client</li>
</ul>
<p>å¯è§SpringMVCæ˜¯Spring Webå­é¡¹ç›®å½“ä¸­çš„ä¸€ä¸ªæ¨¡å—ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´SpringMVCæ˜¯Springæ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æ‰€ä»¥å­¦ä¹ SpringMVCæ¡†æ¶ä¹‹å‰è¦å…ˆå­¦ä¹ Springæ¡†æ¶ä¸­çš„IoCå’ŒAOPç­‰å†…å®¹ã€‚</p>
<p>å¦å¤–ï¼Œä½¿ç”¨SpringMVCæ¡†æ¶çš„æ—¶å€™åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨IoCå’ŒAOPã€‚</p>
<p>ä»¥ä¸‹å°±æ˜¯Springå®˜æ–¹ç»™å‡ºçš„Springæ¶æ„å›¾ï¼Œå…¶ä¸­Webä¸­çš„servletæŒ‡çš„å°±æ˜¯Spring MVCï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Spring%E6%9E%B6%E6%9E%84%E5%9B%BE.png" alt="Springæ¶æ„å›¾"></p>
<h2 id="2-2-SpringMVCå¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ"><a href="#2-2-SpringMVCå¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ" class="headerlink" title="2.2 SpringMVCå¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ"></a>2.2 SpringMVCå¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ</h2><p>SpringMVCæ¡†æ¶å¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Œä¸çº¯ç²¹çš„Servletå¼€å‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li>å…¥å£æ§åˆ¶ï¼šSpringMVCæ¡†æ¶é€šè¿‡DispatcherServletä½œä¸ºå…¥å£æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚å’Œåˆ†å‘è¯·æ±‚ã€‚è€Œåœ¨Servletå¼€å‘ä¸­ï¼Œéœ€è¦è‡ªå·±ç¼–å†™Servletç¨‹åºï¼Œå¹¶åœ¨web.xmlä¸­è¿›è¡Œé…ç½®ï¼Œæ‰èƒ½æ¥å—å’Œå¤„ç†è¯·æ±‚ã€‚ </li>
<li>åœ¨SpringMVCä¸­ï¼Œè¡¨å•æäº¤æ—¶å¯ä»¥è‡ªåŠ¨å°†è¡¨å•æ•°æ®ç»‘å®šåˆ°ç›¸åº”çš„JavaBeanå¯¹è±¡ä¸­ï¼Œåªéœ€è¦åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸­å£°æ˜è¯¥JavaBeanå¯¹è±¡å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨è·å–å’Œèµ‹å€¼è¡¨å•æ•°æ®ã€‚è€Œåœ¨çº¯ç²¹çš„Servletå¼€å‘ä¸­ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦è‡ªå·±æ‰‹åŠ¨å®Œæˆçš„ã€‚</li>
<li>IoCå®¹å™¨ï¼šSpringMVCæ¡†æ¶é€šè¿‡IoCå®¹å™¨ç®¡ç†å¯¹è±¡ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œç›¸åº”çš„é…ç½®å³å¯è·å–å®ä¾‹å¯¹è±¡ï¼Œè€Œåœ¨Servletå¼€å‘ä¸­éœ€è¦æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚ </li>
<li>ç»Ÿä¸€å¤„ç†è¯·æ±‚ï¼šSpringMVCæ¡†æ¶æä¾›äº†æ‹¦æˆªå™¨ã€å¼‚å¸¸å¤„ç†å™¨ç­‰ç»Ÿä¸€å¤„ç†è¯·æ±‚çš„æœºåˆ¶ï¼Œå¹¶ä¸”å¯ä»¥çµæ´»åœ°é…ç½®è¿™äº›å¤„ç†å™¨ã€‚è€Œåœ¨Servletå¼€å‘ä¸­ï¼Œéœ€è¦è‡ªè¡Œç¼–å†™è¿‡æ»¤å™¨ã€å¼‚å¸¸å¤„ç†å™¨ç­‰ï¼Œå¢åŠ äº†ä»£ç çš„å¤æ‚åº¦å’Œå¼€å‘éš¾åº¦ã€‚ </li>
<li>è§†å›¾è§£æï¼šSpringMVCæ¡†æ¶æä¾›äº†å¤šç§è§†å›¾æ¨¡æ¿ï¼Œå¦‚JSPã€Freemarkerã€Velocityç­‰ï¼Œå¹¶ä¸”æ”¯æŒå›½é™…åŒ–ã€ä¸»é¢˜ç­‰ç‰¹æ€§ã€‚è€Œåœ¨Servletå¼€å‘ä¸­éœ€è¦æ‰‹åŠ¨å¤„ç†è§†å›¾å±‚ï¼Œå¢åŠ äº†ä»£ç çš„å¤æ‚åº¦ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œä¸Servletå¼€å‘ç›¸æ¯”ï¼ŒSpringMVCæ¡†æ¶å¯ä»¥å¸®æˆ‘ä»¬èŠ‚çœå¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›ï¼Œå‡å°‘ä»£ç çš„å¤æ‚åº¦ï¼Œæ›´åŠ ä¸“æ³¨äºä¸šåŠ¡å¼€å‘ã€‚åŒæ—¶ï¼Œä¹Ÿæä¾›äº†æ›´å¤šçš„åŠŸèƒ½å’Œæ‰©å±•æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°æ»¡è¶³ä¼ä¸šçº§åº”ç”¨çš„å¼€å‘éœ€æ±‚ã€‚</p>
<h2 id="2-3-SpringMVCæ¡†æ¶çš„ç‰¹ç‚¹"><a href="#2-3-SpringMVCæ¡†æ¶çš„ç‰¹ç‚¹" class="headerlink" title="2.3 SpringMVCæ¡†æ¶çš„ç‰¹ç‚¹"></a>2.3 SpringMVCæ¡†æ¶çš„ç‰¹ç‚¹</h2><ul>
<li>è½»é‡çº§ï¼šç›¸å¯¹äºå…¶ä»–Webæ¡†æ¶ï¼ŒSpring MVCæ¡†æ¶æ¯”è¾ƒå°å·§è½»ä¾¿ã€‚ï¼ˆåªæœ‰å‡ ä¸ªå‡ ç™¾KBå·¦å³çš„JaråŒ…æ–‡ä»¶ï¼‰ </li>
<li>æ¨¡å—åŒ–ï¼šè¯·æ±‚å¤„ç†è¿‡ç¨‹è¢«åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œä»¥æ¨¡å—åŒ–çš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚<ul>
<li>æ§åˆ¶å™¨æ¨¡å—ï¼šController</li>
<li>ä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼šModel</li>
<li>è§†å›¾æ¨¡å—ï¼šView</li>
</ul>
</li>
<li>ä¾èµ–æ³¨å…¥ï¼šSpring MVCæ¡†æ¶åˆ©ç”¨Springæ¡†æ¶çš„ä¾èµ–æ³¨å…¥åŠŸèƒ½å®ç°å¯¹è±¡çš„ç®¡ç†ï¼Œå®ç°æ¾æ•£è€¦åˆã€‚</li>
<li>æ˜“äºæ‰©å±•ï¼šæä¾›äº†å¾ˆå¤šå£å­ï¼Œå…è®¸å¼€å‘è€…æ ¹æ®éœ€è¦æ’å…¥è‡ªå·±çš„ä»£ç ï¼Œä»¥æ‰©å±•å®ç°åº”ç”¨ç¨‹åºçš„ç‰¹æ®Šéœ€æ±‚ã€‚<ul>
<li>Spring MVCæ¡†æ¶å…è®¸å¼€å‘äººå‘˜é€šè¿‡è‡ªå®šä¹‰æ¨¡å—å’Œç»„ä»¶æ¥æ‰©å±•å’Œå¢å¼ºæ¡†æ¶çš„åŠŸèƒ½ã€‚</li>
<li>Spring MVCæ¡†æ¶ä¸å…¶ä»–Springæ¡†æ¶åŠç¬¬ä¸‰æ–¹æ¡†æ¶é›†æˆå¾—éå¸¸ç´§å¯†ï¼Œè¿™ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥éå¸¸æ–¹ä¾¿åœ°é›†æˆå…¶ä»–æ¡†æ¶ï¼Œä»¥è·å¾—æ›´å¥½çš„åŠŸèƒ½ã€‚</li>
</ul>
</li>
<li>æ˜“äºæµ‹è¯•ï¼šæ”¯æŒå•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œæé«˜ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚ï¼ˆå¯¹SpringMVCä¸­çš„Controlleræµ‹è¯•æ—¶ï¼Œä¸éœ€è¦ä¾é WebæœåŠ¡å™¨ã€‚ï¼‰</li>
<li>è‡ªåŠ¨åŒ–é…ç½®ï¼šæä¾›è‡ªåŠ¨åŒ–é…ç½®ï¼Œå‡å°‘é…ç½®ç»†èŠ‚ã€‚<ul>
<li>Spring MVCæ¡†æ¶åŸºäºçº¦å®šå¤§äºé…ç½®çš„åŸåˆ™ï¼Œå¯¹å¸¸ç”¨çš„é…ç½®çº¦å®šè¿›è¡Œè‡ªåŠ¨åŒ–é…ç½®ã€‚</li>
</ul>
</li>
<li>çµæ´»æ€§ï¼šSpring MVCæ¡†æ¶æ”¯æŒå¤šç§è§†å›¾æŠ€æœ¯ï¼Œå¦‚JSPã€FreeMarkerã€Thymeleafã€FreeMarkerç­‰ï¼Œé’ˆå¯¹ä¸åŒçš„è§†å›¾é…ç½®ä¸åŒçš„è§†å›¾è§£æå™¨å³å¯ã€‚</li>
</ul>
<blockquote>
<p>è‡ªç”¨è½¯ä»¶ç›¸å…³ç‰ˆæœ¬</p>
</blockquote>
<ul>
<li>JDKç‰ˆæœ¬ï¼šJava17</li>
<li>Mavenç‰ˆæœ¬ï¼š3.6.1</li>
<li>Tomcatç‰ˆæœ¬ï¼š10</li>
<li>Springç‰ˆæœ¬ï¼š6.1.4</li>
<li>SpringMVCç‰ˆæœ¬ï¼š6.1.4</li>
<li>IDEAç‰ˆæœ¬ï¼š2022.2</li>
<li>Thymeleafç‰ˆæœ¬ï¼š3.1.2</li>
</ul>
<h1 id="3-ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº"><a href="#3-ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº" class="headerlink" title="3. ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº"></a>3. ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº</h1><h2 id="3-1-åˆ›å»ºMavenæ¨¡å—"><a href="#3-1-åˆ›å»ºMavenæ¨¡å—" class="headerlink" title="3.1 åˆ›å»ºMavenæ¨¡å—"></a>3.1 åˆ›å»ºMavenæ¨¡å—</h2><p>1ã€åˆ›å»ºEmpty Projectï¼Œèµ·åä¸ºspringmvc (<font color="red">PSï¼šè®°å¾—è®¾ç½®é¡¹ç›®JDKç‰ˆæœ¬å’ŒMavenä»“åº“</font>)</p>
<p>2ã€åˆ›å»ºMavenæ¨¡å—ï¼Œèµ·åä¸ºspringmvc-001</p>
<p>3ã€å°†<code>pom.xml</code>æ–‡ä»¶ä¸­çš„æ‰“åŒ…æ–¹å¼ä¿®æ”¹ä¸º<code>war</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.muyoukule<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springmvc-001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ‰“åŒ…æ–¹å¼è®¾ç½®ä¸ºwaræ–¹å¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€æ·»åŠ å¦‚ä¸‹ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring MVCä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ—¥å¿—æ¡†æ¶Logbackä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Servletä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Spring6å’ŒThymeleafæ•´åˆä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-æ·»åŠ webæ”¯æŒ"><a href="#3-2-æ·»åŠ webæ”¯æŒ" class="headerlink" title="3.2 æ·»åŠ webæ”¯æŒ"></a>3.2 æ·»åŠ webæ”¯æŒ</h2><p>1ã€åœ¨mainç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªwebappç›®å½•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/webapp%E7%9B%AE%E5%BD%95.png" alt="webappç›®å½•"></p>
<p>2ã€æ·»åŠ web.xmlé…ç½®æ–‡ä»¶</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0web.xml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" alt="æ·»åŠ web.xmlé…ç½®æ–‡ä»¶" style="zoom:50%;">

<p>æ³¨æ„<code>web.xml</code>æ–‡ä»¶çš„ä½ç½®ï¼š\springmvc-001\ <code>src\main\webapp\</code> WEB-INF\web.xml</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/web.xml%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE.png" alt="web.xmlæ–‡ä»¶çš„ä½ç½®" style="zoom:50%;">

<p>æ·»åŠ webæ”¯æŒåçš„ç›®å½•ç»“æ„ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0web%E6%94%AF%E6%8C%81%E5%90%8E%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" alt="æ·»åŠ webæ”¯æŒåçš„ç›®å½•ç»“æ„" style="zoom:67%;">

<h2 id="3-3-é…ç½®web-xmlæ–‡ä»¶"><a href="#3-3-é…ç½®web-xmlæ–‡ä»¶" class="headerlink" title="3.3 é…ç½®web.xmlæ–‡ä»¶"></a>3.3 é…ç½®web.xmlæ–‡ä»¶</h2><p>Spring MVCæ˜¯ä¸€ä¸ªWebæ¡†æ¶ï¼Œåœ¨JavaWebä¸­è°æ¥è´Ÿè´£æ¥æ”¶è¯·æ±‚ã€å¤„ç†è¯·æ±‚ã€ä»¥åŠå“åº”å‘¢ï¼Ÿ</p>
<p>å½“ç„¶æ˜¯Servletã€‚åœ¨SpringMVCæ¡†æ¶ä¸­å·²ç»ä¸ºæˆ‘ä»¬å†™å¥½äº†ä¸€ä¸ªServletï¼Œå®ƒçš„åå­—å«åšï¼š<code>DispatcherServlet</code>ï¼Œæˆ‘ä»¬ç§°å…¶ä¸º <code>å‰ç«¯æ§åˆ¶å™¨</code> </p>
<p>æ—¢ç„¶æ˜¯Servletï¼Œé‚£ä¹ˆå®ƒå°±éœ€è¦åœ¨web.xmlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SpringMVCæä¾›çš„å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- /* è¡¨ç¤ºä»»ä½•ä¸€ä¸ªè¯·æ±‚éƒ½äº¤ç»™DispatcherServletæ¥å¤„ç† --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- / è¡¨ç¤ºå½“è¯·æ±‚ä¸æ˜¯xx.jspçš„æ—¶å€™ï¼ŒDispatcherServletæ¥è´Ÿè´£å¤„ç†æœ¬æ¬¡è¯·æ±‚--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- jspæœ¬è´¨å°±æ˜¯Servletï¼Œå› æ­¤å¦‚æœè¯·æ±‚æ˜¯jspçš„è¯ï¼Œåº”è¯¥èµ°å®ƒè‡ªå·±çš„Servletï¼Œè€Œä¸åº”è¯¥èµ°DispatcherServlet --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å› æ­¤æˆ‘ä»¬çš„ url-pattern ä½¿ç”¨ / --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>DispatcherServlet</code>æ˜¯SpringMVCæ¡†æ¶ä¸ºæˆ‘ä»¬æä¾›çš„æœ€æ ¸å¿ƒçš„ç±»ï¼Œå®ƒæ˜¯æ•´ä¸ªSpringMVCæ¡†æ¶çš„å‰ç«¯æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¥æ”¶HTTPè¯·æ±‚ã€å°†è¯·æ±‚è·¯ç”±åˆ°å¤„ç†ç¨‹åºã€å¤„ç†å“åº”ä¿¡æ¯ï¼Œæœ€ç»ˆå°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚DispatcherServletæ˜¯Webåº”ç”¨ç¨‹åºçš„ä¸»è¦å…¥å£ç‚¹ä¹‹ä¸€ï¼Œå®ƒçš„èŒè´£åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ¥æ”¶å®¢æˆ·ç«¯çš„HTTPè¯·æ±‚ï¼šDispatcherServletç›‘å¬æ¥è‡ªWebæµè§ˆå™¨çš„HTTPè¯·æ±‚ï¼Œç„¶åæ ¹æ®è¯·æ±‚çš„URLå°†è¯·æ±‚æ•°æ®è§£æä¸ºRequestå¯¹è±¡</li>
<li>å¤„ç†è¯·æ±‚çš„URLï¼šDispatcherServletå°†è¯·æ±‚çš„URLï¼ˆUniform Resource Locatorï¼‰ä¸å¤„ç†ç¨‹åºè¿›è¡ŒåŒ¹é…ï¼Œç¡®å®šè¦è°ƒç”¨å“ªä¸ªæ§åˆ¶å™¨ï¼ˆControllerï¼‰æ¥å¤„ç†æ­¤è¯·æ±‚</li>
<li>è°ƒç”¨ç›¸åº”çš„æ§åˆ¶å™¨ï¼šDispatcherServletå°†è¯·æ±‚å‘é€ç»™æ‰¾åˆ°çš„æ§åˆ¶å™¨å¤„ç†ï¼Œæ§åˆ¶å™¨å°†æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼ˆModelï¼‰</li>
<li>æ¸²æŸ“è§†å›¾ï¼šDispatcherServletå°†è°ƒç”¨è§†å›¾å¼•æ“ï¼Œå°†æ¨¡å‹å¯¹è±¡å‘ˆç°ä¸ºç”¨æˆ·å¯ä»¥æŸ¥çœ‹çš„HTMLé¡µé¢</li>
<li>è¿”å›å“åº”ç»™å®¢æˆ·ç«¯ï¼šDispatcherServletå°†ä¸ºç”¨æˆ·ç”Ÿæˆçš„å“åº”å‘é€å›æµè§ˆå™¨ï¼Œå“åº”å¯ä»¥åŒ…æ‹¬è¡¨å•ã€JSONã€XMLã€HTMLä»¥åŠå…¶å®ƒç±»å‹çš„æ•°æ®</li>
</ul>
<h2 id="3-4-ç¼–å†™æ§åˆ¶å™¨FirstController"><a href="#3-4-ç¼–å†™æ§åˆ¶å™¨FirstController" class="headerlink" title="3.4 ç¼–å†™æ§åˆ¶å™¨FirstController"></a>3.4 ç¼–å†™æ§åˆ¶å™¨FirstController</h2><p>DispatcherServletæ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šæ ¹æ®è¯·æ±‚è·¯å¾„åˆ†å‘åˆ°å¯¹åº”çš„Controllerï¼ŒControlleræ¥è´Ÿè´£å¤„ç†è¯·æ±‚çš„æ ¸å¿ƒä¸šåŠ¡ã€‚åœ¨SpringMVCæ¡†æ¶ä¸­Controlleræ˜¯ä¸€ä¸ªæ™®é€šçš„Javaç±»ï¼ˆä¸€ä¸ªæ™®é€šçš„POJOç±»ï¼Œä¸éœ€è¦ç»§æ‰¿ä»»ä½•ç±»æˆ–å®ç°ä»»ä½•æ¥å£ï¼‰ã€‚</p>
<p><strong>éœ€è¦æ³¨æ„</strong>çš„æ˜¯ï¼šPOJOç±»è¦çº³å…¥IoCå®¹å™¨æ¥ç®¡ç†ï¼ŒPOJOç±»çš„ç”Ÿå‘½å‘¨æœŸç”±Springæ¥ç®¡ç†ï¼Œå› æ­¤è¦ä½¿ç”¨æ³¨è§£æ ‡æ³¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstController</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-5-é…ç½®springmvc-servlet-xmlæ–‡ä»¶"><a href="#3-5-é…ç½®springmvc-servlet-xmlæ–‡ä»¶" class="headerlink" title="3.5 é…ç½®springmvc-servlet.xmlæ–‡ä»¶"></a>3.5 é…ç½®springmvc-servlet.xmlæ–‡ä»¶</h2><p>SpringMVCæ¡†æ¶æœ‰å®ƒè‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œè¯¥é…ç½®æ–‡ä»¶çš„åå­—é»˜è®¤ä¸ºï¼š<code>&lt;servlet-name&gt;-servlet.xml</code>ï¼Œé»˜è®¤å­˜æ”¾çš„ä½ç½®æ˜¯WEB-INFç›®å½•ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ä½œç”¨äºè§†å›¾æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è®¾ç½®è§†å›¾æ¸²æŸ“åè¾“å‡ºæ—¶é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¦‚æœé…ç½®å¤šä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒæ¥å†³å®šä¼˜å…ˆä½¿ç”¨å“ªä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒçš„å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å½“ ThymeleafViewResolver æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œä¼šä½¿ç”¨è¯¥æ¨¡æ¿å¼•æ“æ¥è§£æã€ç¼–è¯‘å’Œæ¸²æŸ“æ¨¡æ¿--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--ç”¨äºæŒ‡å®š Thymeleaf æ¨¡æ¿å¼•æ“ä½¿ç”¨çš„æ¨¡æ¿è§£æå™¨ã€‚æ¨¡æ¿è§£æå™¨è´Ÿè´£æ ¹æ®æ¨¡æ¿ä½ç½®ã€æ¨¡æ¿èµ„æºåç§°ã€æ–‡ä»¶ç¼–ç ç­‰ä¿¡æ¯ï¼ŒåŠ è½½æ¨¡æ¿å¹¶å¯¹å…¶è¿›è¡Œè§£æ--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶çš„ä½ç½®ï¼ˆå‰ç¼€ï¼‰--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶åç¼€ï¼ˆåç¼€ï¼‰ï¼ŒThymeleafæ–‡ä»¶æ‰©å±•åä¸ä¸€å®šæ˜¯htmlï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ï¼Œä¾‹å¦‚txtï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯html--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿ç±»å‹ï¼Œä¾‹å¦‚ï¼šHTML,TEXT,JAVASCRIPT,CSSç­‰--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--ç”¨äºæ¨¡æ¿æ–‡ä»¶åœ¨è¯»å–å’Œè§£æè¿‡ç¨‹ä¸­é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨WEB-INFç›®å½•ä¸‹æ–°å»º<code>springmvc-servlet.xml</code>æ–‡ä»¶ï¼Œå¹¶ä¸”æä¾›ä»¥ä¸Šé…ç½®ä¿¡æ¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%8F%90%E4%BE%9B%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.png" alt="æä¾›é…ç½®ä¿¡æ¯"></p>
<p>ä»¥ä¸Šé…ç½®ä¸»è¦ä¸¤é¡¹ï¼š</p>
<ul>
<li>ç»„ä»¶æ‰«æã€‚Springæ‰«æè¿™ä¸ªåŒ…ä¸­çš„ç±»ï¼Œå°†è¿™ä¸ªåŒ…ä¸­çš„ç±»å®ä¾‹åŒ–å¹¶çº³å…¥IoCå®¹å™¨çš„ç®¡ç†ã€‚</li>
<li>è§†å›¾è§£æå™¨ã€‚è§†å›¾è§£æå™¨ï¼ˆView Resolverï¼‰çš„ä½œç”¨ä¸»è¦æ˜¯å°†Controlleræ–¹æ³•è¿”å›çš„é€»è¾‘è§†å›¾åç§°è§£ææˆå®é™…çš„è§†å›¾å¯¹è±¡ã€‚è§†å›¾è§£æå™¨å°†è§£æå‡ºçš„è§†å›¾å¯¹è±¡è¿”å›ç»™DispatcherServletï¼Œå¹¶æœ€ç»ˆç”±DispatcherServletå°†è¯¥è§†å›¾å¯¹è±¡è½¬åŒ–ä¸ºå“åº”ç»“æœï¼Œå‘ˆç°ç»™ç”¨æˆ·ã€‚</li>
</ul>
<p><font color="red">PSï¼šå¦‚æœé‡‡ç”¨äº†å…¶å®ƒè§†å›¾ï¼Œè¯·é…ç½®å¯¹åº”çš„è§†å›¾è§£æå™¨ã€‚</font>ä¾‹å¦‚ï¼š</p>
<ul>
<li>JSPçš„è§†å›¾è§£æå™¨ï¼šInternalResourceViewResolver</li>
<li>FreeMarkerè§†å›¾è§£æå™¨ï¼šFreeMarkerViewResolver</li>
<li>Velocityè§†å›¾è§£æå™¨ï¼šVelocityViewResolver</li>
</ul>
<h2 id="3-6-æä¾›è§†å›¾"><a href="#3-6-æä¾›è§†å›¾" class="headerlink" title="3.6 æä¾›è§†å›¾"></a>3.6 æä¾›è§†å›¾</h2><p>åœ¨WEB-INFç›®å½•ä¸‹æ–°å»º<code>templates</code>ç›®å½•ï¼Œåœ¨templatesç›®å½•ä¸­æ–°å»ºhtmlæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šfirst.htmlï¼Œå¹¶æä¾›ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æŒ‡å®š th å‘½åç©ºé—´ï¼Œè®© Thymeleaf æ ‡å‡†è¡¨è¾¾å¼å¯ä»¥è¢«è§£æå’Œæ‰§è¡Œ--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--thä¸æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥æŒ‡å®šå…¶å®ƒçš„å‘½åç©ºé—´ï¼Œåªä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ç”¨th--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--è¡¨ç¤ºç¨‹åºä¸­å‡ºç°çš„ th å¼€å¤´çš„åé¢ä»£ç éƒ½æ˜¯ Thymeleaf è¯­æ³•ï¼Œéœ€è¦è¢« Thymeleafè¯†åˆ«--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>first springmvc<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æˆ‘çš„ç¬¬ä¸€ä¸ªSpring MVCç¨‹åº<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºæ¯ä¸€ä¸ªThymeleafæ–‡ä»¶æ¥è¯´ <code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code> æ˜¯å¿…é¡»è¦å†™çš„ï¼Œä¸ºäº†æ–¹ä¾¿åç»­å¼€å‘ï¼Œå¯ä»¥å°†å…¶æ·»åŠ åˆ°htmlæ¨¡æ¿æ–‡ä»¶ä¸­ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0%E5%88%B0html%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6.png" alt="æ·»åŠ åˆ°htmlæ¨¡æ¿æ–‡ä»¶" style="zoom:50%;">

<h2 id="3-7-æ§åˆ¶å™¨FirstControllerå¤„ç†è¯·æ±‚è¿”å›é€»è¾‘è§†å›¾åç§°"><a href="#3-7-æ§åˆ¶å™¨FirstControllerå¤„ç†è¯·æ±‚è¿”å›é€»è¾‘è§†å›¾åç§°" class="headerlink" title="3.7 æ§åˆ¶å™¨FirstControllerå¤„ç†è¯·æ±‚è¿”å›é€»è¾‘è§†å›¾åç§°"></a>3.7 æ§åˆ¶å™¨FirstControllerå¤„ç†è¯·æ±‚è¿”å›é€»è¾‘è§†å›¾åç§°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/haha&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String åå­—éšæ„() &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å¤„ç†è¯·æ±‚....&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿”å›é€»è¾‘è§†å›¾åç§°ï¼ˆå†³å®šè·³è½¬åˆ°å“ªä¸ªé¡µé¢ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;first&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€é…ç½®TomcatæœåŠ¡å™¨</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%85%8D%E7%BD%AETomcat%E6%9C%8D%E5%8A%A1%E5%99%A8.png" alt="é…ç½®TomcatæœåŠ¡å™¨" style="zoom: 50%;">

<p>2ã€éƒ¨ç½²Webæ¨¡å—åˆ°TomcatæœåŠ¡å™¨</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%83%A8%E7%BD%B2Web%E6%A8%A1%E5%9D%97%E5%88%B0Tomcat%E6%9C%8D%E5%8A%A1%E5%99%A8.png" alt="éƒ¨ç½²Webæ¨¡å—åˆ°TomcatæœåŠ¡å™¨" style="zoom: 50%;">

<p>3ã€å¯åŠ¨TomcatæœåŠ¡å™¨</p>
<p>å¦‚æœåœ¨æ§åˆ¶å°è¾“å‡ºçš„ä¿¡æ¯æœ‰ä¸­æ–‡ä¹±ç ï¼Œè¯·ä¿®æ”¹TomcatæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼š<code>apache-tomcat-10.1.19\conf\logging.properties</code></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%A4%84%E7%90%86Tomcat%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B9%B1%E7%A0%81.png" alt="å¤„ç†TomcatæœåŠ¡å™¨ä¹±ç " style="zoom:50%;">

<p>4ã€åœ¨æµè§ˆå™¨åœ°å€æ ä¸Šè¾“å…¥åœ°å€ï¼š<a href="http://localhost:8080/springmvc/haha">http://localhost:8080/springmvc/haha</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AASpringMVC%E7%A8%8B%E5%BA%8F.png" alt="æˆ‘çš„ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº"></p>
<p>5ã€åç«¯æ§åˆ¶å°è¾“å‡ºï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%90%8E%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA.png" alt="åç«¯æ§åˆ¶å°è¾“å‡º"></p>
<h2 id="3-8-æ‰§è¡Œæµç¨‹æ€»ç»“"><a href="#3-8-æ‰§è¡Œæµç¨‹æ€»ç»“" class="headerlink" title="3.8 æ‰§è¡Œæµç¨‹æ€»ç»“"></a>3.8 æ‰§è¡Œæµç¨‹æ€»ç»“</h2><ol>
<li>æµè§ˆå™¨å‘é€è¯·æ±‚ï¼š<a href="http://localhost:8080/springmvc/haha">http://localhost:8080/springmvc/haha</a></li>
<li>SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨DispatcherServletæ¥æ”¶åˆ°è¯·æ±‚</li>
<li>DispatcherServletæ ¹æ®è¯·æ±‚è·¯å¾„ &#x2F;haha æ˜ å°„åˆ° FirstController#åå­—éšæ„()ï¼Œè°ƒç”¨è¯¥æ–¹æ³•</li>
<li>FirstController#åå­—éšæ„() å¤„ç†è¯·æ±‚</li>
<li>FirstController#åå­—éšæ„() è¿”å›é€»è¾‘è§†å›¾åç§° first ç»™è§†å›¾è§£æå™¨</li>
<li>è§†å›¾è§£æå™¨æ‰¾åˆ° <code>/WEB-INF/templates/first.html</code> æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œè§£æï¼Œç”Ÿæˆè§†å›¾è§£æå¯¹è±¡è¿”å›ç»™å‰ç«¯æ§åˆ¶å™¨DispatcherServlet</li>
<li>å‰ç«¯æ§åˆ¶å™¨DispatcherServletå“åº”ç»“æœåˆ°æµè§ˆå™¨</li>
</ol>
<h2 id="3-9-Controllerç¼–å†™å¤šä¸ªæ–¹æ³•"><a href="#3-9-Controllerç¼–å†™å¤šä¸ªæ–¹æ³•" class="headerlink" title="3.9 Controllerç¼–å†™å¤šä¸ªæ–¹æ³•"></a>3.9 Controllerç¼–å†™å¤šä¸ªæ–¹æ³•</h2><p>ä¸€ä¸ªControllerå¯ä»¥æä¾›å¤šä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•é€šå¸¸æ˜¯å¤„ç†å¯¹åº”çš„è¯·æ±‚ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/haha&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String åå­—éšæ„() &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å¤„ç†è¯·æ±‚....&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿”å›é€»è¾‘è§†å›¾åç§°ï¼ˆå†³å®šè·³è½¬åˆ°å“ªä¸ªé¡µé¢ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;first&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/other&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">other</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨å¤„ç†å…¶å®ƒè¯·æ±‚...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;other&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æä¾› other.html æ–‡ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>other<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>other ...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ first.html æ–‡ä»¶ä¸­ï¼Œæ·»åŠ è¶…é“¾æ¥ï¼Œç”¨è¶…é“¾æ¥å‘é€ <code>/other</code> è¯·æ±‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æŒ‡å®š th å‘½åç©ºé—´ï¼Œè®© Thymeleaf æ ‡å‡†è¡¨è¾¾å¼å¯ä»¥è¢«è§£æå’Œæ‰§è¡Œ--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--thä¸æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥æŒ‡å®šå…¶å®ƒçš„å‘½åç©ºé—´ï¼Œåªä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ç”¨th--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--è¡¨ç¤ºç¨‹åºä¸­å‡ºç°çš„ th å¼€å¤´çš„åé¢ä»£ç éƒ½æ˜¯ Thymeleafè¯­æ³•ï¼Œéœ€è¦è¢« Thymeleaf è¯†åˆ«--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>first springmvc<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æˆ‘çš„ç¬¬ä¸€ä¸ªSpring MVCç¨‹åº<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- th: è¡¨ç¤ºåé¢çš„ä»£ç å¯ä»¥ç¼–å†™Thymeleafè¯­æ³•ï¼Œå¯ä»¥è¢«Thymeleafè¯­æ³•è§£æ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Thymeleafæ£€æµ‹åˆ°ä»¥ / å¼€å§‹ï¼Œè¡¨ç¤ºç»å¯¹è·¯å¾„ï¼Œè‡ªåŠ¨ä¼šå°†webappçš„ä¸Šä¸‹æ–‡è·¯å¾„åŠ ä¸Šå» --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼šhref=&quot;/springmvc/other&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/other&#125;&quot;</span>&gt;</span>otherè¯·æ±‚<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨Tomcatï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥è¯·æ±‚è·¯å¾„ï¼š<a href="http://localhost:8080/springmvc/haha">http://localhost:8080/springmvc/haha</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%90%BA%E5%B8%A6%E8%B6%85%E9%93%BE%E6%8E%A5.png" alt="æºå¸¦è¶…é“¾æ¥"></p>
<p>ç‚¹å‡»è¶…é“¾æ¥ï¼šotherè¯·æ±‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%82%B9%E5%87%BB%E8%B6%85%E9%93%BE%E6%8E%A5.png" alt="ç‚¹å‡»è¶…é“¾æ¥"></p>
<h1 id="4-ç¬¬äºŒä¸ªSpringMVCç¨‹åº"><a href="#4-ç¬¬äºŒä¸ªSpringMVCç¨‹åº" class="headerlink" title="4. ç¬¬äºŒä¸ªSpringMVCç¨‹åº"></a>4. ç¬¬äºŒä¸ªSpringMVCç¨‹åº</h1><h2 id="4-1-åˆ›å»ºMavenæ¨¡å—"><a href="#4-1-åˆ›å»ºMavenæ¨¡å—" class="headerlink" title="4.1 åˆ›å»ºMavenæ¨¡å—"></a>4.1 åˆ›å»ºMavenæ¨¡å—</h2><p>1ã€<code>pom.xml</code> æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–</p>
<ul>
<li>springmvcä¾èµ–</li>
<li>logbackä¾èµ–</li>
<li>servletä¾èµ–ï¼ˆscopeä¸ºprovidedï¼‰</li>
<li>thymeleafä¸spring6æ•´åˆä¾èµ–</li>
</ul>
<p>2ã€æ‰“åŒ…æ–¹å¼ <code>war</code></p>
<h2 id="4-2-æ·»åŠ webæ”¯æŒ"><a href="#4-2-æ·»åŠ webæ”¯æŒ" class="headerlink" title="4.2 æ·»åŠ webæ”¯æŒ"></a>4.2 æ·»åŠ webæ”¯æŒ</h2><p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/webapp%E6%B2%A1%E6%9C%89%E5%B0%8F%E8%93%9D%E7%82%B9.png" alt="webappæ²¡æœ‰å°è“ç‚¹"></p>
<blockquote>
<p>webappç›®å½•æ²¡æœ‰å°è“ç‚¹æ€ä¹ˆåŠï¼Ÿ</p>
</blockquote>
<p>æ·»åŠ Webæ”¯æŒï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B7%BB%E5%8A%A0Web%E6%94%AF%E6%8C%81.png" alt="æ·»åŠ Webæ”¯æŒ" style="zoom:50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%BF%AE%E6%94%B9web.xml%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84.png" alt="ä¿®æ”¹web.xmlæ–‡ä»¶è·¯å¾„" style="zoom: 50%;">

<h2 id="4-3-é…ç½®web-xmlæ–‡ä»¶"><a href="#4-3-é…ç½®web-xmlæ–‡ä»¶" class="headerlink" title="4.3 é…ç½®web.xmlæ–‡ä»¶"></a>4.3 é…ç½®web.xmlæ–‡ä»¶</h2><p><font color="red"><strong>PSï¼šSpringMVCé…ç½®æ–‡ä»¶çš„åå­—å’Œè·¯å¾„æ˜¯å¯ä»¥æ‰‹åŠ¨è®¾ç½®çš„ã€‚</strong></font>ğŸ˜® å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®å‰ç«¯æ§åˆ¶å™¨--&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ‰‹åŠ¨è®¾ç½®springmvcé…ç½®æ–‡ä»¶çš„è·¯å¾„åŠåå­—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ä¸ºäº†æé«˜ç”¨æˆ·çš„ç¬¬ä¸€æ¬¡è®¿é—®æ•ˆç‡ï¼Œå»ºè®®åœ¨webæœåŠ¡å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>é€šè¿‡<code>&lt;init-param&gt;</code>æ¥è®¾ç½®SpringMVCé…ç½®æ–‡ä»¶çš„è·¯å¾„å’Œåå­—ï¼Œåœ¨DispatcherServletçš„<code>init</code>æ–¹æ³•æ‰§è¡Œæ—¶è®¾ç½®çš„ã€‚</strong><br><strong><code>&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</code>å»ºè®®åŠ ä¸Šï¼Œè¿™æ ·å¯ä»¥æé«˜ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®çš„æ•ˆç‡ã€‚è¡¨ç¤ºåœ¨webæœåŠ¡å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–DispatcherServletã€‚</strong></p>
<h2 id="4-4-ç¼–å†™IndexController"><a href="#4-4-ç¼–å†™IndexController" class="headerlink" title="4.4 ç¼–å†™IndexController"></a>4.4 ç¼–å†™IndexController</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºè¯·æ±‚è·¯å¾„å¦‚æœæ˜¯ï¼š<a href="http://localhost:8080/springmvc/">http://localhost:8080/springmvc/</a> ï¼Œåˆ™ç›´æ¥è¿›å…¥ <code>/WEB-INF/templates/index.html</code> é¡µé¢ã€‚</p>
<p><strong>è¿™å°±æ˜¯é¡¹ç›®çš„é¦–é¡µæ•ˆæœï¼ï¼ï¼ï¼ï¼</strong></p>
<h2 id="4-5-åœ¨resourcesç›®å½•ä¸‹é…ç½®springmvc-xmlæ–‡ä»¶"><a href="#4-5-åœ¨resourcesç›®å½•ä¸‹é…ç½®springmvc-xmlæ–‡ä»¶" class="headerlink" title="4.5 åœ¨resourcesç›®å½•ä¸‹é…ç½®springmvc.xmlæ–‡ä»¶"></a>4.5 åœ¨resourcesç›®å½•ä¸‹é…ç½®springmvc.xmlæ–‡ä»¶</h2><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%85%8D%E7%BD%AEspringmvc.xml%E6%96%87%E4%BB%B6.png" alt="é…ç½®springmvc.xmlæ–‡ä»¶" style="zoom: 67%;">

<p>é…ç½®å†…å®¹å’Œä¹‹å‰ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯è§†å›¾è§£æå™¨ï¼Œä¸€ä¸ªæ˜¯ç»„ä»¶æ‰«æã€‚</p>
<h2 id="4-6-æä¾›è§†å›¾"><a href="#4-6-æä¾›è§†å›¾" class="headerlink" title="4.6 æä¾›è§†å›¾"></a>4.6 æä¾›è§†å›¾</h2><p>åœ¨WEB-INFç›®å½•ä¸‹æ–°å»º<code>templates</code>ç›®å½•ï¼Œåœ¨templatesç›®å½•ä¸­æ–°å»ºindex.htmlæ–‡ä»¶ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>éƒ¨ç½²åˆ°webæœåŠ¡å™¨ï¼Œå¯åŠ¨webæœåŠ¡å™¨ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œåœ¨åœ°å€æ ä¸Šè¾“å…¥ï¼š<a href="http://localhost:8080/springmvc/">http://localhost:8080/springmvc/</a></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/indexPage.png" alt="indexPage"></p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬6ç« ã€‘ RESTFulç¼–ç¨‹é£æ ¼</title>
    <url>/posts/SpringMVC-Chapter-Six-RESTFul-Coding-Style/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-RESTFulç¼–ç¨‹é£æ ¼"><a href="#1-RESTFulç¼–ç¨‹é£æ ¼" class="headerlink" title="1. RESTFulç¼–ç¨‹é£æ ¼"></a>1. RESTFulç¼–ç¨‹é£æ ¼</h1><h2 id="1-1-RESTFulæ˜¯ä»€ä¹ˆ"><a href="#1-1-RESTFulæ˜¯ä»€ä¹ˆ" class="headerlink" title="1.1 RESTFulæ˜¯ä»€ä¹ˆ"></a>1.1 RESTFulæ˜¯ä»€ä¹ˆ</h2><p>RESTFulæ˜¯<code>WEBæœåŠ¡æ¥å£</code>çš„ä¸€ç§è®¾è®¡é£æ ¼ã€‚</p>
<p>RESTFulå®šä¹‰äº†ä¸€ç»„çº¦æŸæ¡ä»¶å’Œè§„èŒƒï¼Œå¯ä»¥è®©<code>WEBæœåŠ¡æ¥å£</code>æ›´åŠ ç®€æ´ã€æ˜“äºç†è§£ã€æ˜“äºæ‰©å±•ã€å®‰å…¨å¯é ã€‚</p>
<p>RESTFulå¯¹ä¸€ä¸ª<code>WEBæœåŠ¡æ¥å£</code>éƒ½è§„å®šäº†å“ªäº›ä¸œè¥¿ï¼Ÿ</p>
<ul>
<li>å¯¹è¯·æ±‚çš„URLæ ¼å¼æœ‰çº¦æŸå’Œè§„èŒƒ</li>
<li>å¯¹HTTPçš„è¯·æ±‚æ–¹å¼æœ‰çº¦æŸå’Œè§„èŒƒ</li>
<li>å¯¹è¯·æ±‚å’Œå“åº”çš„æ•°æ®æ ¼å¼æœ‰çº¦æŸå’Œè§„èŒƒ</li>
<li>å¯¹HTTPçŠ¶æ€ç æœ‰çº¦æŸå’Œè§„èŒƒ</li>
<li>ç­‰ â€¦â€¦</li>
</ul>
<p>RESTå¯¹è¯·æ±‚æ–¹å¼çš„çº¦æŸæ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>æŸ¥è¯¢å¿…é¡»å‘é€GETè¯·æ±‚</li>
<li>æ–°å¢å¿…é¡»å‘é€POSTè¯·æ±‚</li>
<li>ä¿®æ”¹å¿…é¡»å‘é€PUTè¯·æ±‚</li>
<li>åˆ é™¤å¿…é¡»å‘é€DELETEè¯·æ±‚</li>
</ul>
<p>RESTå¯¹URLçš„çº¦æŸæ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li><p>ä¼ ç»Ÿçš„URLï¼šgetè¯·æ±‚ï¼Œ&#x2F;springmvc&#x2F;getUserById?id&#x3D;1</p>
</li>
<li><p>RESTé£æ ¼çš„URLï¼šgetè¯·æ±‚ï¼Œ&#x2F;springmvc&#x2F;user&#x2F;1</p>
</li>
<li><p>ä¼ ç»Ÿçš„URLï¼šgetè¯·æ±‚ï¼Œ&#x2F;springmvc&#x2F;deleteUserById?id&#x3D;1</p>
</li>
<li><p>RESTé£æ ¼çš„URLï¼šdeleteè¯·æ±‚, &#x2F;springmvc&#x2F;user&#x2F;1</p>
</li>
</ul>
<p>RESTFulå¯¹URLçš„çº¦æŸå’Œè§„èŒƒçš„æ ¸å¿ƒæ˜¯ï¼š<font color="red"><strong>é€šè¿‡é‡‡ç”¨</strong> <code>ä¸åŒçš„è¯·æ±‚æ–¹å¼</code> + <code>URL</code> <strong>æ¥ç¡®å®šWEBæœåŠ¡ä¸­çš„èµ„æºã€‚</strong></font></p>
<p><strong>RESTful çš„è‹±æ–‡å…¨ç§°æ˜¯ Representational State Transferï¼ˆè¡¨è¿°æ€§çŠ¶æ€è½¬ç§»ï¼‰ã€‚ç®€ç§°RESTã€‚</strong></p>
<p>è¡¨è¿°æ€§ï¼ˆRepresentationalï¼‰æ˜¯ï¼šURI + è¯·æ±‚æ–¹å¼ã€‚</p>
<p>çŠ¶æ€ï¼ˆStateï¼‰æ˜¯ï¼šæœåŠ¡å™¨ç«¯çš„æ•°æ®ã€‚</p>
<p>è½¬ç§»ï¼ˆTransferï¼‰æ˜¯ï¼šå˜åŒ–ã€‚</p>
<p>è¡¨è¿°æ€§çŠ¶æ€è½¬ç§»æ˜¯æŒ‡ï¼šé€šè¿‡ URI + è¯·æ±‚æ–¹å¼ æ¥æ§åˆ¶æœåŠ¡å™¨ç«¯æ•°æ®çš„å˜åŒ–ã€‚</p>
<h2 id="1-2-RESTFulé£æ ¼ä¸ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”"><a href="#1-2-RESTFulé£æ ¼ä¸ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”" class="headerlink" title="1.2 RESTFulé£æ ¼ä¸ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”"></a>1.2 RESTFulé£æ ¼ä¸ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”</h2><p>ä¼ ç»Ÿçš„ URL ä¸ RESTful URL çš„åŒºåˆ«æ˜¯ä¼ ç»Ÿçš„ URL æ˜¯åŸºäºæ–¹æ³•åè¿›è¡Œèµ„æºè®¿é—®å’Œæ“ä½œï¼Œè€Œ RESTful URL æ˜¯åŸºäºèµ„æºçš„ç»“æ„å’ŒçŠ¶æ€è¿›è¡Œæ“ä½œçš„ã€‚ä¸‹é¢æ˜¯ä¸€å¼ è¡¨æ ¼ï¼Œå±•ç¤ºä¸¤è€…ä¹‹é—´çš„å…·ä½“åŒºåˆ«ï¼š</p>
<table>
<thead>
<tr>
<th align="center">ä¼ ç»Ÿçš„ URL</th>
<th align="center">RESTful URL</th>
</tr>
</thead>
<tbody><tr>
<td align="center">GET &#x2F;getUserById?id&#x3D;1</td>
<td align="center">GET &#x2F;user&#x2F;1</td>
</tr>
<tr>
<td align="center">GET &#x2F;getAllUser</td>
<td align="center">GET &#x2F;user</td>
</tr>
<tr>
<td align="center">POST &#x2F;addUser</td>
<td align="center">POST &#x2F;user</td>
</tr>
<tr>
<td align="center">POST &#x2F;modifyUser</td>
<td align="center">PUT &#x2F;user</td>
</tr>
<tr>
<td align="center">GET &#x2F;deleteUserById?id&#x3D;1</td>
<td align="center">DELETE &#x2F;user&#x2F;1</td>
</tr>
</tbody></table>
<p>ä»ä¸Šè¡¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä¼ ç»Ÿçš„URLæ˜¯åŸºäºåŠ¨ä½œçš„ï¼Œè€Œ RESTful URL æ˜¯åŸºäºèµ„æºå’ŒçŠ¶æ€çš„ï¼Œå› æ­¤ RESTful URL æ›´åŠ æ¸…æ™°å’Œæ˜“äºç†è§£ï¼Œè¿™ä¹Ÿæ˜¯ REST æ¶æ„é£æ ¼è¢«å¹¿æ³›ä½¿ç”¨çš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚</p>
<h2 id="1-3-RESTFulæ–¹å¼æ¼”ç¤ºæŸ¥è¯¢"><a href="#1-3-RESTFulæ–¹å¼æ¼”ç¤ºæŸ¥è¯¢" class="headerlink" title="1.3 RESTFulæ–¹å¼æ¼”ç¤ºæŸ¥è¯¢"></a>1.3 RESTFulæ–¹å¼æ¼”ç¤ºæŸ¥è¯¢</h2><p>RESTFulè§„èŒƒä¸­è§„å®šï¼Œå¦‚æœè¦æŸ¥è¯¢æ•°æ®ï¼Œéœ€è¦å‘é€GETè¯·æ±‚ã€‚</p>
<h3 id="1-3-1-æŸ¥è¯¢æ‰€æœ‰-GET-api-user"><a href="#1-3-1-æŸ¥è¯¢æ‰€æœ‰-GET-api-user" class="headerlink" title="1.3.1 æŸ¥è¯¢æ‰€æœ‰(GET &#x2F;api&#x2F;user)"></a>1.3.1 æŸ¥è¯¢æ‰€æœ‰(GET &#x2F;api&#x2F;user)</h3><p>1ã€å‡†å¤‡springmvc.xmlæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/thymeleaf/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¯ç”¨æ³¨è§£--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾æ§åˆ¶å™¨æ˜ å°„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€å‡†å¤‡é¦–é¡µindex.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•RESTFulç¼–ç¨‹é£æ ¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--RESTfulé£æ ¼çš„ï¼šæŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span>&gt;</span>æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€æ§åˆ¶å™¨Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAll</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ­£åœ¨æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯....&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ok<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>OK!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ï¼š<a href="http://localhost:8080/springmvc">http://localhost:8080/springmvc</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95RESTFul%E6%96%B9%E5%BC%8F%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89.png" alt="æµ‹è¯•RESTFulæ–¹å¼æŸ¥è¯¢æ‰€æœ‰" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RESTFul%E6%96%B9%E5%BC%8F%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89ok.png" alt="RESTFulæ–¹å¼æŸ¥è¯¢æ‰€æœ‰ok" style="zoom:80%;">

<p>6ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯....</span><br></pre></td></tr></table></figure>

<h3 id="1-3-2-æ ¹æ®idæŸ¥è¯¢-GET-api-user-1"><a href="#1-3-2-æ ¹æ®idæŸ¥è¯¢-GET-api-user-1" class="headerlink" title="1.3.2 æ ¹æ®idæŸ¥è¯¢(GET &#x2F;api&#x2F;user&#x2F;1)"></a>1.3.2 æ ¹æ®idæŸ¥è¯¢(GET &#x2F;api&#x2F;user&#x2F;1)</h3><p>1ã€index.htmlæ·»åŠ è¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--RESTfulé£æ ¼çš„ï¼šæ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/110&#125;&quot;</span>&gt;</span>æŸ¥è¯¢id=110çš„è¿™ä¸ªç”¨æˆ·ä¿¡æ¯<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user/&#123;id&#125;&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ­£åœ¨æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯...ï¼Œç”¨æˆ·idæ˜¯&quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95RESTFul%E6%96%B9%E5%BC%8F%E6%A0%B9%E6%8D%AEid%E6%9F%A5%E8%AF%A2.png" alt="æµ‹è¯•RESTFulæ–¹å¼æ ¹æ®idæŸ¥è¯¢" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RESTFul%E6%96%B9%E5%BC%8F%E6%A0%B9%E6%8D%AEid%E6%9F%A5%E8%AF%A2ok.png" alt="RESTFulæ–¹å¼æ ¹æ®idæŸ¥è¯¢ok" style="zoom: 67%;">

<p>4ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯...ï¼Œç”¨æˆ·idæ˜¯110</span><br></pre></td></tr></table></figure>


<h2 id="1-4-RESTFulæ–¹å¼æ¼”ç¤ºå¢åŠ -POST-api-user"><a href="#1-4-RESTFulæ–¹å¼æ¼”ç¤ºå¢åŠ -POST-api-user" class="headerlink" title="1.4 RESTFulæ–¹å¼æ¼”ç¤ºå¢åŠ (POST &#x2F;api&#x2F;user)"></a>1.4 RESTFulæ–¹å¼æ¼”ç¤ºå¢åŠ (POST &#x2F;api&#x2F;user)</h2><p>RESTFulè§„èŒƒä¸­è§„å®šï¼Œå¦‚æœè¦è¿›è¡Œä¿å­˜æ“ä½œï¼Œéœ€è¦å‘é€POSTè¯·æ±‚ã€‚</p>
<p>1ã€å‡†å¤‡Userå®ä½“ï¼ˆé‡‡ç”¨Lombokç®€åŒ–ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Integer password;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PSï¼šå¦‚éœ€ä½¿ç”¨Lombokï¼Œéœ€è¦åœ¨pom.xmlå¼•å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--lombokä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€index.htmlæ·»åŠ è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--RESTfulé£æ ¼çš„ï¼šæ–°å¢ç”¨æˆ·ä¿¡æ¯ã€‚æ–°å¢å¿…é¡»å‘é€POSTè¯·æ±‚ï¼Œéœ€è¦ä½¿ç”¨formè¡¨å•--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¿å­˜&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ­£åœ¨ä¿å­˜userç”¨æˆ·ä¿¡æ¯...&quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95RESTFul%E6%96%B9%E5%BC%8F%E5%A2%9E%E5%8A%A0.png" alt="æµ‹è¯•RESTFulæ–¹å¼å¢åŠ " style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RESTFul%E6%96%B9%E5%BC%8F%E5%A2%9E%E5%8A%A0ok.png" alt="RESTFulæ–¹å¼å¢åŠ ok" style="zoom:80%;">

<p>5ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨ä¿å­˜userç”¨æˆ·ä¿¡æ¯...User(username=æœ¨åˆæ¯äº†, password=123, age=18)</span><br></pre></td></tr></table></figure>


<h2 id="1-5-RESTFulæ–¹å¼æ¼”ç¤ºä¿®æ”¹"><a href="#1-5-RESTFulæ–¹å¼æ¼”ç¤ºä¿®æ”¹" class="headerlink" title="1.5 RESTFulæ–¹å¼æ¼”ç¤ºä¿®æ”¹"></a>1.5 RESTFulæ–¹å¼æ¼”ç¤ºä¿®æ”¹</h2><p>RESTFulè§„èŒƒä¸­è§„å®šï¼Œå¦‚æœè¦è¿›è¡Œä¿å­˜æ“ä½œï¼Œéœ€è¦å‘é€PUTè¯·æ±‚ã€‚</p>
<p><strong>å¦‚ä½•å‘é€PUTè¯·æ±‚ï¼Ÿ</strong></p>
<ul>
<li>é¦–å…ˆä½ å¿…é¡»æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚ã€‚</li>
<li>åœ¨å‘é€POSTè¯·æ±‚çš„æ—¶å€™ï¼Œæäº¤è¿™æ ·çš„æ•°æ®ï¼š<font color="red"><code>_method=PUT</code></font></li>
<li>åœ¨web.xmlæ–‡ä»¶é…ç½®SpringMVCæä¾›çš„è¿‡æ»¤å™¨ï¼š<code>HiddenHttpMethodFilter</code></li>
</ul>
<p>å®è·µä¸€ä¸‹ï¼š</p>
<p>1ã€index.htmlæ·»åŠ è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--RESTfulé£æ ¼çš„ï¼šä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ã€‚ä¿®æ”¹å¿…é¡»å‘é€PUTè¯·æ±‚ï¼Œè¦å‘é€PUTè¯·æ±‚ï¼Œé¦–å…ˆä½ å¿…é¡»æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--éšè—åŸŸ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¿®æ”¹&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€é…ç½®éšè—çš„HTTPè¯·æ±‚æ–¹å¼è¿‡æ»¤å™¨</p>
<p><font color="red"><strong>PSï¼šå¦‚æœæ·»åŠ äº†å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼Œä¸€å®šè¦åœ¨å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨åé¢é…ç½®ï¼Œå¦åˆ™å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ä¼šå¤±æ•ˆ</strong></font></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨æ˜¯springmvcæå‰å†™å¥½çš„ï¼Œç›´æ¥ç”¨å°±è¡Œäº†ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥å¸®åŠ©ä½ å°†è¯·æ±‚POSTè½¬æ¢æˆPUTè¯·æ±‚/DELETEè¯·æ±‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/api/user&quot;, method = RequestMethod.PUT)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">update</span><span class="params">(String username)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·åï¼š&quot;</span> + username);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€æµ‹è¯•ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95RESTFul%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9.png" alt="æµ‹è¯•RESTFulæ–¹å¼ä¿®æ”¹" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RESTFul%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9ok.png" style="zoom:80%;">

<p>5ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼šUser(username=æœ¨åˆæ¯äº†z, password=123321, age=20)</span><br></pre></td></tr></table></figure>

<h2 id="1-6-RESTFulæ–¹å¼æ¼”ç¤ºåˆ é™¤"><a href="#1-6-RESTFulæ–¹å¼æ¼”ç¤ºåˆ é™¤" class="headerlink" title="1.6 RESTFulæ–¹å¼æ¼”ç¤ºåˆ é™¤"></a>1.6 RESTFulæ–¹å¼æ¼”ç¤ºåˆ é™¤</h2><p>1ã€index.htmlæ·»åŠ åˆ é™¤æŒ‰é’®</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--RESTfulé£æ ¼çš„ï¼šåˆ é™¤ç”¨æˆ·ä¿¡æ¯--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--åˆ é™¤å¿…é¡»å‘é€DELETEè¯·æ±‚ã€‚å’ŒPUTè¯·æ±‚å®ç°æ–¹å¼ç›¸åŒã€‚--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å‘é€DELETEè¯·æ±‚çš„å‰ææ˜¯POSTè¯·æ±‚ï¼Œå¹¶ä¸”éœ€è¦é€šè¿‡éšè—åŸŸæäº¤ _method=delete --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/120&#125;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;del(event)&quot;</span>&gt;</span>åˆ é™¤ç”¨æˆ·id=120çš„ç”¨æˆ·ä¿¡æ¯<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;delForm&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">del</span>(<span class="params">event</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// è·å–è¡¨å•</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> delForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;delForm&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ç»™formçš„actionèµ‹å€¼</span></span></span><br><span class="line"><span class="language-javascript">        delForm.<span class="property">action</span> = event.<span class="property">target</span>.<span class="property">href</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å‘é€POSTè¯·æ±‚æäº¤è¡¨å•</span></span></span><br><span class="line"><span class="language-javascript">        delForm.<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// éå¸¸é‡è¦ï¼Œä½ éœ€è¦é˜»æ­¢è¶…é“¾æ¥çš„é»˜è®¤è¡Œä¸ºã€‚</span></span></span><br><span class="line"><span class="language-javascript">        event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½®éšè—çš„HTTPè¯·æ±‚æ–¹å¼è¿‡æ»¤å™¨</p>
<p><font color="red"><strong>PSï¼šå¦‚æœæ·»åŠ äº†å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼Œä¸€å®šè¦åœ¨å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨åé¢é…ç½®ï¼Œå¦åˆ™å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ä¼šå¤±æ•ˆ</strong></font></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨æ˜¯springmvcæå‰å†™å¥½çš„ï¼Œç›´æ¥ç”¨å°±è¡Œäº†ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥å¸®åŠ©ä½ å°†è¯·æ±‚POSTè½¬æ¢æˆPUTè¯·æ±‚/DELETEè¯·æ±‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user/&#123;id&#125;&quot;, method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">del</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ­£åœ¨åˆ é™¤ç”¨æˆ·ï¼š&quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€æµ‹è¯•ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95RESTFul%E6%96%B9%E5%BC%8F%E5%88%A0%E9%99%A4.png" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RESTFul%E6%96%B9%E5%BC%8F%E5%88%A0%E9%99%A4ok.png" style="zoom: 50%;">

<p>5ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ­£åœ¨åˆ é™¤ç”¨æˆ·ï¼š120</span><br></pre></td></tr></table></figure>

<h2 id="1-7-HiddenHttpMethodFilter"><a href="#1-7-HiddenHttpMethodFilter" class="headerlink" title="1.7 HiddenHttpMethodFilter"></a>1.7 HiddenHttpMethodFilter</h2><p><code>HiddenHttpMethodFilter</code>æ˜¯Spring MVCæ¡†æ¶æä¾›çš„ï¼Œä¸“é—¨ç”¨äºRESTFulç¼–ç¨‹é£æ ¼ã€‚</p>
<p>å®ç°åŸç†å¯ä»¥é€šè¿‡æºç æŸ¥çœ‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/HiddenHttpMethodFilter%E6%BA%90%E7%A0%81(1).png" alt="HiddenHttpMethodFilteræºç (1)" style="zoom: 50%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/HiddenHttpMethodFilter%E6%BA%90%E7%A0%81(2).png" alt="HiddenHttpMethodFilteræºç (2)" style="zoom: 67%;">

<p>é€šè¿‡æºç å¯ä»¥çœ‹åˆ°ï¼Œifè¯­å¥ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºPOSTè¯·æ±‚ï¼Œå¦‚æœæ˜¯POSTè¯·æ±‚ï¼Œè°ƒç”¨<code>request.getParameter(this.methodParam)</code>ã€‚å¯ä»¥çœ‹åˆ°<code>this.methodParam</code>æ˜¯<code>_method</code>ï¼Œè¿™æ ·å°±è¦æ±‚æˆ‘ä»¬åœ¨æäº¤è¯·æ±‚æ–¹å¼çš„æ—¶å€™å¿…é¡»é‡‡ç”¨è¿™ä¸ªæ ¼å¼ï¼š<code>_method=put</code>ã€‚è·å–åˆ°è¯·æ±‚æ–¹å¼ä¹‹åï¼Œè°ƒç”¨äº†<code>toUpperCase</code>è½¬æ¢æˆå¤§å†™äº†ã€‚å› æ­¤å‰ç«¯é¡µé¢ä¸­å°å†™çš„<code>put</code>æˆ–è€…å¤§å†™çš„<code>PUT</code>éƒ½æ˜¯å¯ä»¥çš„ã€‚ifè¯­å¥ä¸­åµŒå¥—çš„ifè¯­å¥è¯´çš„æ˜¯ï¼Œåªæœ‰è¯·æ±‚æ–¹å¼æ˜¯ <code>PUT</code>ï¼Œ<code>DELETE</code>ï¼Œ<code>PATCH</code>çš„æ—¶å€™ä¼šåˆ›å»º<code>HttpMethodRequestWrapper</code>å¯¹è±¡ã€‚è€Œ<code>HttpMethodRequestWrapper</code>å¯¹è±¡çš„æ„é€ æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/HiddenHttpMethodFilter%E6%BA%90%E7%A0%81(3).png" alt="HiddenHttpMethodFilteræºç (3)" style="zoom: 67%;">

<p>è¿™æ ·methodå°±ä»<code>POST</code>å˜æˆäº†ï¼š<code>PUT/DELETE/PATCH</code>ã€‚</p>
<p><font color="red"><strong>PSï¼šé‡ç‚¹æ³¨æ„CharacterEncodingFilterå’ŒHiddenHttpMethodFilterçš„é¡ºåºï¼ï¼ï¼ï¼</strong></font></p>
<p>åœ¨<code>HiddenHttpMethodFilter</code>æºç ä¸­æœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">paramValue</span> <span class="operator">=</span> request.getParameter(<span class="built_in">this</span>.methodParam);</span><br></pre></td></tr></table></figure>

<p>å¤§å®¶æ˜¯å¦è¿˜è®°å¾—ï¼Œå­—ç¬¦ç¼–ç è¿‡æ»¤å™¨æ‰§è¡Œä¹‹å‰ä¸èƒ½è°ƒç”¨<code>request.getParameter()</code>æ–¹æ³•ï¼Œå¦‚æœæå‰è°ƒç”¨äº†ï¼Œä¹±ç é—®é¢˜å°±æ— æ³•è§£å†³äº†ã€‚å› ä¸º<code>request.setCharacterEncoding()</code>æ–¹æ³•çš„æ‰§è¡Œå¿…é¡»åœ¨æ‰€æœ‰<code>request.getParameter()</code>æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚</p>
<p>å› æ­¤è¿™ä¸¤ä¸ªè¿‡æ»¤å™¨å°±æœ‰å…ˆåé¡ºåºçš„è¦æ±‚ï¼Œåœ¨web.xmlæ–‡ä»¶ä¸­ï¼Œåº”è¯¥<font color="red"><strong>å…ˆé…ç½®CharacterEncodingFilterï¼Œç„¶åå†é…ç½®HiddenHttpMethodFilterã€‚</strong></font></p>
<h1 id="2-ä½¿ç”¨RESTFulå®ç°ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ"><a href="#2-ä½¿ç”¨RESTFulå®ç°ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="2. ä½¿ç”¨RESTFulå®ç°ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ"></a>2. ä½¿ç”¨RESTFulå®ç°ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ</h1><h2 id="2-1-é™æ€é¡µé¢å‡†å¤‡"><a href="#2-1-é™æ€é¡µé¢å‡†å¤‡" class="headerlink" title="2.1 é™æ€é¡µé¢å‡†å¤‡"></a>2.1 é™æ€é¡µé¢å‡†å¤‡</h2><p>æ–‡ä»¶åŒ…æ‹¬ï¼šuser.cssã€user_index.htmlã€user_list.htmlã€user_add.htmlã€user_edit.htmlã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<h3 id="2-1-1-user-css"><a href="#2-1-1-user-css" class="headerlink" title="2.1.1 user.css"></a>2.1.1 user.css</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">list-style-type</span>: none;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">14px</span> <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.active</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#111</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#4CAF50</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">form</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span>, <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;email&quot;</span>]</span>, select &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#555</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#4CAF50</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#3e8e41</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">  <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">th</span>, <span class="selector-tag">td</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">th</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">tr</span><span class="selector-pseudo">:nth-child</span>(even) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.add-button</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#4CAF50</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.add-button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#3e8e41</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-user-index-html"><a href="#2-1-2-user-index-html" class="headerlink" title="2.1.2 user_index.html"></a>2.1.2 user_index.html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;active&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user_list.html&quot;</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fuser_index.html.png" alt="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿuser_index.html"></p>
<h3 id="2-1-3-user-list-html"><a href="#2-1-3-user-list-html" class="headerlink" title="2.1.3 user_list.html"></a>2.1.3 user_list.html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;add-button-wrapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;add-button&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user_add.html&quot;</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç¼–å·<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç”¨æˆ·å<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ€§åˆ«<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>é‚®ç®±<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>zhangsan@powernode.com<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">          ä¿®æ”¹</span><br><span class="line">          åˆ é™¤</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>æå››<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>lisi@powernode.com<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">          ä¿®æ”¹</span><br><span class="line">          åˆ é™¤</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fuser_list.html.png" alt="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿuser_list.html"></p>
<h3 id="2-1-4-user-add-html"><a href="#2-1-4-user-add-html" class="headerlink" title="2.1.4 user_add.html"></a>2.1.4 user_add.html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>-- è¯·é€‰æ‹© --<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>ä¿å­˜<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fuser_add.html.png" alt="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿuser_add.html"></p>
<h3 id="2-1-5-user-edit-html"><a href="#2-1-5-user-edit-html" class="headerlink" title="2.1.5 user_edit.html"></a>2.1.5 user_edit.html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>-- è¯·é€‰æ‹© --<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">selected</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan@powernode.com&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fuser_edit.html.png" alt="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿuser_edit.html"></p>
<h2 id="2-2-SpringMVCç¯å¢ƒæ­å»º"><a href="#2-2-SpringMVCç¯å¢ƒæ­å»º" class="headerlink" title="2.2 SpringMVCç¯å¢ƒæ­å»º"></a>2.2 SpringMVCç¯å¢ƒæ­å»º</h2><p>1ã€åˆ›å»ºmoduleï¼šusermgt</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.muyoukule<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>usermgt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ‰“åŒ…æ–¹å¼è®¾ç½®ä¸ºwaræ–¹å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Spring MVCä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ—¥å¿—æ¡†æ¶Logbackä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Servletä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Spring6å’ŒThymeleafæ•´åˆä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombokä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æ·»åŠ webæ”¯æŒ</p>
<p>3ã€é…ç½®web.xmlæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--HTTPè¯·æ±‚æ–¹å¼è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸¤ä¸ªè¿‡æ»¤å™¨Filterçš„é…ç½®é¡ºåºï¼š<font color="red"><strong>å…ˆ</strong></font>é…ç½® <code>CharacterEncodingFilter</code>ï¼Œ<font color="red"><strong>å</strong></font>é…ç½® <code>HiddenHttpMethodFilter</code></p>
<p>4ã€é…ç½®springmvc.xmlæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/thymeleaf/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼€å¯æ³¨è§£--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼€å¯é»˜è®¤Servlet--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>5ã€åˆ›å»ºpackag</p>
<p>6ã€åœ¨WEB-INFç›®å½•ä¸‹æ–°å»ºï¼šthymeleafç›®å½•</p>
<p>æœ€ç»ˆåˆ›å»ºå¥½çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" alt="ç”¨æˆ·ç®¡ç†ç•Œé¢é¡¹ç›®ç»“æ„" style="zoom:67%;">

<h2 id="2-3-æ˜¾ç¤ºé¦–é¡µ"><a href="#2-3-æ˜¾ç¤ºé¦–é¡µ" class="headerlink" title="2.3 æ˜¾ç¤ºé¦–é¡µ"></a>2.3 æ˜¾ç¤ºé¦–é¡µ</h2><p>1ã€åœ¨åº”ç”¨çš„æ ¹ä¸‹æ–°å»ºç›®å½•ï¼š<code>static/css</code>ï¼Œå°†user.cssæ–‡ä»¶æ‹·è´è¿›å»ã€‚</p>
<p>2ã€å°†user_index.htmlæ‹·è´åˆ°WEB-INF&#x2F;thymeleafç›®å½•ä¸‹ï¼š</p>
<p>ä»£ç æœ‰ä¸¤å¤„éœ€è¦ä¿®æ”¹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%BF%AE%E6%94%B9user_index.html%E4%BB%A3%E7%A0%81.png" alt="ä¿®æ”¹user_index.htmlä»£ç " style="zoom: 67%;">

<p>3ã€åœ¨springmvc.xmlæ–‡ä»¶ä¸­é…ç½®è§†å›¾æ§åˆ¶å™¨æ˜ å°„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è§†å›¾æ§åˆ¶å™¨æ˜ å°„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;user_index&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€éƒ¨ç½²ï¼Œé…ç½®å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95user_index.html%E9%A1%B5%E9%9D%A2.png" alt="æµ‹è¯•user_index.htmlé¡µé¢"></p>
<h2 id="2-4-å®ç°ç”¨æˆ·åˆ—è¡¨"><a href="#2-4-å®ç°ç”¨æˆ·åˆ—è¡¨" class="headerlink" title="2.4 å®ç°ç”¨æˆ·åˆ—è¡¨"></a>2.4 å®ç°ç”¨æˆ·åˆ—è¡¨</h2><p>1ã€ä¿®æ”¹user_index.htmlä¸­çš„è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;active&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™pojoï¼šUser</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™UserDaoï¼Œæä¾›selectAllæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10001L</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;zhangsan@example.com&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10002L</span>, <span class="string">&quot;æå››&quot;</span>, <span class="string">&quot;lisi@example.com&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10003L</span>, <span class="string">&quot;ç‹äº”&quot;</span>, <span class="string">&quot;wangwu@example.com&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10004L</span>, <span class="string">&quot;èµµå…­&quot;</span>, <span class="string">&quot;zhaoliu@example.com&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">10005L</span>, <span class="string">&quot;é’±ä¸ƒ&quot;</span>, <span class="string">&quot;qianqi@example.com&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        users.add(user1);</span><br><span class="line">        users.add(user2);</span><br><span class="line">        users.add(user3);</span><br><span class="line">        users.add(user4);</span><br><span class="line">        users.add(user5);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4ã€ç¼–å†™æ§åˆ¶å™¨UserControllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰çš„ç”¨æˆ·</span></span><br><span class="line">        List&lt;User&gt; users = userDao.selectAll();</span><br><span class="line">        <span class="comment">// å­˜å‚¨åˆ°requeståŸŸ</span></span><br><span class="line">        model.addAttribute(<span class="string">&quot;users&quot;</span>, users);</span><br><span class="line">        <span class="comment">// è·³è½¬è§†å›¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user_list&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€å°†user_list.htmlæ‹·è´åˆ°thymeleafç›®å½•ä¸‹ï¼Œå¹¶è¿›è¡Œä»£ç ä¿®æ”¹ï¼Œæ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/static/css/user.css&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;add-button-wrapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;add-button&quot;</span> <span class="attr">href</span>=<span class="string">&quot;user_add.html&quot;</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç¼–å·<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç”¨æˆ·å<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ€§åˆ«<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>é‚®ç®±<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;user : $&#123;users&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.gender == 1 ? &#x27;ç”·&#x27; : &#x27;å¥³&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>6ã€æµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E7%94%A8%E6%88%B7%E6%9F%A5%E8%AF%A2%E5%8A%9F%E8%83%BD%E6%88%90%E5%8A%9F.png" alt="æµ‹è¯•ç”¨æˆ·æŸ¥è¯¢åŠŸèƒ½æˆåŠŸ"></p>
<h2 id="2-5-å®ç°æ–°å¢åŠŸèƒ½"><a href="#2-5-å®ç°æ–°å¢åŠŸèƒ½" class="headerlink" title="2.5 å®ç°æ–°å¢åŠŸèƒ½"></a>2.5 å®ç°æ–°å¢åŠŸèƒ½</h2><h3 id="2-5-1-è·³è½¬åˆ°æ–°å¢é¡µé¢"><a href="#2-5-1-è·³è½¬åˆ°æ–°å¢é¡µé¢" class="headerlink" title="2.5.1 è·³è½¬åˆ°æ–°å¢é¡µé¢"></a>2.5.1 è·³è½¬åˆ°æ–°å¢é¡µé¢</h3><p>1ã€åœ¨ç”¨æˆ·åˆ—è¡¨user_index.htmlé¡µé¢ï¼Œä¿®æ”¹<code>æ–°å¢ç”¨æˆ·</code>çš„è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;add-button&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toAdd&#125;&quot;</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€å°†user_add.htmlæ‹·è´åˆ°thymeleafç›®å½•ä¸‹ï¼Œå¹¶è¿›è¡Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http:www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/static/css/user.css&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ–°å¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>-- è¯·é€‰æ‹© --<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>ä¿å­˜<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨springmvc.xmlæ–‡ä»¶ä¸­é…ç½®<code>è§†å›¾æ§åˆ¶å™¨æ˜ å°„</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/toAdd&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;user_add&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95user_add.html%E9%A1%B5%E9%9D%A2.png" alt="æµ‹è¯•user_add.htmlé¡µé¢"></p>
<h3 id="2-5-2-å®ç°æ–°å¢åŠŸèƒ½"><a href="#2-5-2-å®ç°æ–°å¢åŠŸèƒ½" class="headerlink" title="2.5.2 å®ç°æ–°å¢åŠŸèƒ½"></a>2.5.2 å®ç°æ–°å¢åŠŸèƒ½</h3><p>1ã€å‰ç«¯é¡µé¢å‘é€POSTè¯·æ±‚ï¼Œæäº¤è¡¨å•ï¼Œä¿®æ”¹user_add.htmlä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™æ§åˆ¶å™¨UserControllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨userDaoä¿å­˜ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    userDao.insert(user);</span><br><span class="line">    <span class="comment">// é‡å®šå‘åˆ°ç”¨æˆ·åˆ—è¡¨é¡µé¢ï¼ˆé‡æ–°è®©æµè§ˆå™¨å‘é€ä¸€æ¬¡å…¨æ–°çš„è¯·æ±‚ï¼Œå»è¯·æ±‚åˆ—è¡¨é¡µé¢ï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/user&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>PSï¼šä¿å­˜æˆåŠŸåï¼Œé‡‡ç”¨é‡å®šå‘çš„æ–¹å¼è·³è½¬åˆ°ç”¨æˆ·åˆ—è¡¨ã€‚</strong></p>
<p>3ã€ç¼–å†™UserDaoï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Long <span class="title function_">generateId</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨Stream API</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">maxId</span> <span class="operator">=</span> users.stream().map(user -&gt; user.getId()).reduce((id1, id2) -&gt; id1 &gt; id2 ? id1 : id2).get();</span><br><span class="line">    <span class="keyword">return</span> maxId + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆid</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> generateId();</span><br><span class="line">    <span class="comment">// ç»™userå¯¹è±¡idå±æ€§èµ‹å€¼</span></span><br><span class="line">    user.setId(id);</span><br><span class="line">    <span class="comment">// ä¿å­˜</span></span><br><span class="line">    users.add(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>PSï¼šå•ç‹¬å†™äº†ä¸€ä¸ªæ–¹æ³•ç”Ÿæˆidï¼Œå†…éƒ¨ä½¿ç”¨äº†Stream APIã€‚</strong></p>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%AE%9E%E7%8E%B0%E6%96%B0%E5%A2%9E%E7%94%A8%E6%88%B7%E5%8A%9F%E8%83%BD.png" alt="å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½"></p>
<h2 id="2-6-å®ç°æ–°å¢åŠŸèƒ½"><a href="#2-6-å®ç°æ–°å¢åŠŸèƒ½" class="headerlink" title="2.6 å®ç°æ–°å¢åŠŸèƒ½"></a>2.6 å®ç°æ–°å¢åŠŸèƒ½</h2><h3 id="2-6-1-è·³è½¬åˆ°ä¿®æ”¹é¡µé¢"><a href="#2-6-1-è·³è½¬åˆ°ä¿®æ”¹é¡µé¢" class="headerlink" title="2.6.1 è·³è½¬åˆ°ä¿®æ”¹é¡µé¢"></a>2.6.1 è·³è½¬åˆ°ä¿®æ”¹é¡µé¢</h3><p>1ã€ä¿®æ”¹user_list.htmlä¸­<code>ä¿®æ”¹</code>è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/user/&#x27; + $&#123;user.id&#125;&#125;&quot;</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toUpdate</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id, Model model)</span>&#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.selectById(id);</span><br><span class="line">    <span class="comment">// å°†å¯¹è±¡å­˜å‚¨åˆ°requeståŸŸ</span></span><br><span class="line">    model.addAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">    <span class="comment">// è·³è½¬è§†å›¾</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;user_edit&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€ç¼–å†™UserDaoï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> User <span class="title function_">selectById</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> users.stream().filter(user -&gt; user.getId().equals(id)).findFirst().get();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4ã€å°†user_edit.htmlæ‹·è´thymeleafç›®å½•ä¸‹ï¼Œå¹¶ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/static/css/user.css&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;user.username&#125;&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>-- è¯·é€‰æ‹© --<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">th:field</span>=<span class="string">&quot;$&#123;user.gender&#125;&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">th:field</span>=<span class="string">&quot;$&#123;user.gender&#125;&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;user.email&#125;&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95user_edit.html%E9%A1%B5%E9%9D%A2.png" alt="æµ‹è¯•user_edit.htmlé¡µé¢"></p>
<h3 id="2-6-2-å®ç°ä¿®æ”¹åŠŸèƒ½"><a href="#2-6-2-å®ç°ä¿®æ”¹åŠŸèƒ½" class="headerlink" title="2.6.2 å®ç°ä¿®æ”¹åŠŸèƒ½"></a>2.6.2 å®ç°ä¿®æ”¹åŠŸèƒ½</h3><p>1ã€å°†user_edit.htmlé¡µé¢ä¸­çš„formè¡¨å•ä¿®æ”¹ä¸€ä¸‹ï¼Œæ·»åŠ actionï¼Œæ·»åŠ methodï¼Œéšè—åŸŸçš„æ–¹å¼æäº¤è¯·æ±‚æ–¹å¼putï¼Œéšè—åŸŸçš„æ–¹å¼æäº¤idï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--éšè—åŸŸçš„æ–¹å¼è®¾ç½®è¯·æ±‚æ–¹å¼ä¸ºputè¯·æ±‚--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--éšè—åŸŸçš„æ–¹å¼æäº¤id--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;user.id&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PutMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">modify</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="comment">// æ›´æ–°æ•°æ®</span></span><br><span class="line">    userDao.update(user);</span><br><span class="line">    <span class="comment">// é‡å®šå‘</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/user&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€ç¼–å†™UserDaoï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; users.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (user.getId().equals(users.get(i).getId())) &#123;</span><br><span class="line">            users.set(i, user);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF.png" alt="æµ‹è¯•ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯"></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%88%90%E5%8A%9F.png" alt="ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æˆåŠŸ"></p>
<h2 id="2-7-å®ç°åˆ é™¤åŠŸèƒ½"><a href="#2-7-å®ç°åˆ é™¤åŠŸèƒ½" class="headerlink" title="2.7 å®ç°åˆ é™¤åŠŸèƒ½"></a>2.7 å®ç°åˆ é™¤åŠŸèƒ½</h2><p>åˆ é™¤åº”è¯¥å‘é€DELETEè¯·æ±‚ï¼Œè¦æ¨¡æ‹ŸDELETEè¯·æ±‚ï¼Œå°±éœ€è¦ä½¿ç”¨è¡¨å•æ–¹å¼æäº¤ã€‚å› æ­¤æˆ‘ä»¬ç‚¹å‡»<code>åˆ é™¤</code>è¶…é“¾æ¥æ—¶éœ€è¦é‡‡ç”¨è¡¨å•æ–¹å¼æäº¤ã€‚</p>
<p>1ã€åœ¨user_list.htmlé¡µé¢æ·»åŠ formè¡¨å•ï¼Œå¹¶ä¸”ç‚¹å‡»è¶…é“¾æ¥æ—¶åº”è¯¥æäº¤è¡¨å•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ä¸ºåˆ é™¤æä¾›ä¸€ä¸ªé¼ æ ‡å•å‡»äº‹ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/user/&#x27; + $&#123;user.id&#125;&#125;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;del(event)&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å†™åœ¨bodyæ ‡ç­¾é‡Œé¢ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¸ºåˆ é™¤æ“ä½œå‡†å¤‡ä¸€ä¸ªformè¡¨å•ï¼Œç‚¹å‡»åˆ é™¤æ—¶æäº¤formè¡¨å•--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display: none&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">id</span>=<span class="string">&quot;delForm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">del</span>(<span class="params">event</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// è·å–è¡¨å•</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> delForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;delForm&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// è®¾ç½®è¡¨å•action</span></span></span><br><span class="line"><span class="language-javascript">        delForm.<span class="property">action</span> = event.<span class="property">target</span>.<span class="property">href</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;æ‚¨ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ&quot;</span>))&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// æäº¤è¡¨å•</span></span></span><br><span class="line"><span class="language-javascript">            delForm.<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// é˜»æ­¢è¶…é“¾æ¥é»˜è®¤è¡Œä¸º</span></span></span><br><span class="line"><span class="language-javascript">        event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€ç¼–å†™Controller:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user/&#123;id&#125;&quot;, method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">del</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨daoåˆ é™¤ç”¨æˆ·</span></span><br><span class="line">    userDao.deleteById(id);</span><br><span class="line">    <span class="comment">// é‡å®šå‘åˆ°åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/user&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€ç¼–å†™UserDao:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; users.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (id.equals(users.get(i).getId())) &#123;</span><br><span class="line">            users.remove(i);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E5%8A%9F%E8%83%BD.png" alt="æµ‹è¯•åˆ é™¤ç”¨æˆ·åŠŸèƒ½"></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E6%88%90%E5%8A%9F.png" alt="åˆ é™¤ç”¨æˆ·æˆåŠŸ">
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬13ç« ã€‘ å…¨æ³¨è§£å¼€å‘</title>
    <url>/posts/SpringMVC-Chapter-Thirteen-Full-Annotation-Development/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-web-xmlæ–‡ä»¶çš„æ›¿ä»£"><a href="#1-web-xmlæ–‡ä»¶çš„æ›¿ä»£" class="headerlink" title="1. web.xmlæ–‡ä»¶çš„æ›¿ä»£"></a>1. web.xmlæ–‡ä»¶çš„æ›¿ä»£</h1><h2 id="1-1-Servlet3-0æ–°ç‰¹æ€§"><a href="#1-1-Servlet3-0æ–°ç‰¹æ€§" class="headerlink" title="1.1 Servlet3.0æ–°ç‰¹æ€§"></a>1.1 Servlet3.0æ–°ç‰¹æ€§</h2><p>Servlet3.0æ–°ç‰¹æ€§ï¼šweb.xmlæ–‡ä»¶å¯ä»¥ä¸å†™äº†ã€‚</p>
<p>åœ¨Servlet3.0çš„æ—¶å€™ï¼Œè§„èŒƒä¸­æä¾›äº†ä¸€ä¸ªæ¥å£<code>ServletContainerInitializer</code>ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/ServletContainerInitializer%E6%8E%A5%E5%8F%A3.png" alt="ServletContainerInitializeræ¥å£" style="zoom:67%;">

<p>æœåŠ¡å™¨åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨ä»å®¹å™¨ä¸­æ‰¾ <code>ServletContainerInitializer</code>æ¥å£çš„å®ç°ç±»ï¼Œè‡ªåŠ¨è°ƒç”¨å®ƒçš„<code>onStartup</code>æ–¹æ³•æ¥å®ŒæˆServletä¸Šä¸‹æ–‡çš„åˆå§‹åŒ–ã€‚</p>
<p>åœ¨Spring3.1ç‰ˆæœ¬çš„æ—¶å€™ï¼Œæä¾›äº†è¿™æ ·ä¸€ä¸ªç±»<code>SpringServletContainerInitializer</code>ï¼Œå®ç°ä»¥ä¸Šçš„æ¥å£ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SpringServletContainerInitializer%E7%B1%BB.png" alt="SpringServletContainerInitializerç±»" style="zoom:67%;">

<p>å®ƒçš„æ ¸å¿ƒæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/SpringServletContainerInitializer%E7%B1%BB%E7%9A%84%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95.png" alt="SpringServletContainerInitializerç±»çš„æ ¸å¿ƒæ–¹æ³•" style="zoom: 50%;">

<p>å¯ä»¥çœ‹åˆ°åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šå»åŠ è½½æ‰€æœ‰å®ç°<code>WebApplicationInitializer</code>æ¥å£çš„ç±»ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/WebApplicationInitializer%E6%8E%A5%E5%8F%A3.png" alt="WebApplicationInitializeræ¥å£" style="zoom:67%;">

<p>è¿™ä¸ªæ¥å£ä¸‹æœ‰ä¸€ä¸ªå­ç±»æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼š<code>AbstractAnnotationConfigDispatcherServletInitializer</code></p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/AbstractAnnotationConfigDispatcherServletInitializer%E7%B1%BB.png" alt="AbstractAnnotationConfigDispatcherServletInitializerç±»"></p>
<p>å½“æˆ‘ä»¬ç¼–å†™ç±»ç»§æ‰¿<code>AbstractAnnotationConfigDispatcherServletInitializer</code>ä¹‹åï¼ŒwebæœåŠ¡å™¨åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šæ ¹æ®å®ƒæ¥åˆå§‹åŒ–Servletä¸Šä¸‹æ–‡ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/web%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B9%E6%8D%AEAbstractAnnotationConfigDispatcherServletInitializer%E5%88%9D%E5%A7%8B%E5%8C%96Servlet%E4%B8%8A%E4%B8%8B%E6%96%87.png" alt="webæœåŠ¡å™¨æ ¹æ®AbstractAnnotationConfigDispatcherServletInitializeråˆå§‹åŒ–Servletä¸Šä¸‹æ–‡" style="zoom:67%;">

<h2 id="1-2-ç¼–å†™WebAppInitializer"><a href="#1-2-ç¼–å†™WebAppInitializer" class="headerlink" title="1.2 ç¼–å†™WebAppInitializer"></a>1.2 ç¼–å†™WebAppInitializer</h2><p>ä»¥ä¸‹è¿™ä¸ªç±»å°±æ˜¯ç”¨æ¥ä»£æ›¿web.xmlæ–‡ä»¶çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebAppInitializer</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Springçš„é…ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SpringMVCçš„é…ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMVCConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºé…ç½® DispatcherServlet çš„æ˜ å°„è·¯å¾„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="type">CharacterEncodingFilter</span> <span class="variable">characterEncodingFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">        characterEncodingFilter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        characterEncodingFilter.setForceRequestEncoding(<span class="literal">true</span>);</span><br><span class="line">        characterEncodingFilter.setForceResponseEncoding(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">HiddenHttpMethodFilter</span> <span class="variable">hiddenHttpMethodFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HiddenHttpMethodFilter</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;characterEncodingFilter, hiddenHttpMethodFilter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SpringMVCé…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-Spring-MVCçš„é…ç½®"><a href="#2-Spring-MVCçš„é…ç½®" class="headerlink" title="2. Spring MVCçš„é…ç½®"></a>2. Spring MVCçš„é…ç½®</h1><h2 id="2-1-ç»„ä»¶æ‰«æ"><a href="#2-1-ç»„ä»¶æ‰«æ" class="headerlink" title="2.1 ç»„ä»¶æ‰«æ"></a>2.1 ç»„ä»¶æ‰«æ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å®šè¯¥ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå¯ä»¥å½“é…ç½®æ–‡ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// å¼€å¯ç»„ä»¶æ‰«æ</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-å¼€å¯æ³¨è§£é©±åŠ¨"><a href="#2-2-å¼€å¯æ³¨è§£é©±åŠ¨" class="headerlink" title="2.2 å¼€å¯æ³¨è§£é©±åŠ¨"></a>2.2 å¼€å¯æ³¨è§£é©±åŠ¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å®šè¯¥ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå¯ä»¥å½“é…ç½®æ–‡ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// å¼€å¯ç»„ä»¶æ‰«æ</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.controller&quot;)</span></span><br><span class="line"><span class="comment">// å¼€å¯æ³¨è§£é©±åŠ¨</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-3-è§†å›¾è§£æå™¨"><a href="#2-3-è§†å›¾è§£æå™¨" class="headerlink" title="2.3 è§†å›¾è§£æå™¨"></a>2.3 è§†å›¾è§£æå™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å®šè¯¥ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå¯ä»¥å½“é…ç½®æ–‡ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// å¼€å¯ç»„ä»¶æ‰«æ</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.muyoukule.controller&quot;)</span></span><br><span class="line"><span class="comment">// å¼€å¯æ³¨è§£é©±åŠ¨</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ThymeleafViewResolver <span class="title function_">getViewResolver</span><span class="params">(SpringTemplateEngine springTemplateEngine)</span> &#123;</span><br><span class="line">        <span class="type">ThymeleafViewResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThymeleafViewResolver</span>();</span><br><span class="line">        resolver.setTemplateEngine(springTemplateEngine);</span><br><span class="line">        resolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resolver.setOrder(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> resolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SpringTemplateEngine <span class="title function_">templateEngine</span><span class="params">(ITemplateResolver iTemplateResolver)</span> &#123;</span><br><span class="line">        <span class="type">SpringTemplateEngine</span> <span class="variable">templateEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringTemplateEngine</span>();</span><br><span class="line">        templateEngine.setTemplateResolver(iTemplateResolver);</span><br><span class="line">        <span class="keyword">return</span> templateEngine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ITemplateResolver <span class="title function_">templateResolver</span><span class="params">(ApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        <span class="type">SpringResourceTemplateResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringResourceTemplateResolver</span>();</span><br><span class="line">        resolver.setApplicationContext(applicationContext);</span><br><span class="line">        resolver.setPrefix(<span class="string">&quot;/WEB-INF/thymeleaf/&quot;</span>);</span><br><span class="line">        resolver.setSuffix(<span class="string">&quot;.html&quot;</span>);</span><br><span class="line">        resolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        resolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resolver.setCacheable(<span class="literal">false</span>);<span class="comment">//å¼€å‘æ—¶å…³é—­ç¼“å­˜ï¼Œæ”¹åŠ¨å³å¯ç”Ÿæ•ˆ</span></span><br><span class="line">        <span class="keyword">return</span> resolver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-4-å¼€å¯é»˜è®¤Servletå¤„ç†"><a href="#2-4-å¼€å¯é»˜è®¤Servletå¤„ç†" class="headerlink" title="2.4 å¼€å¯é»˜è®¤Servletå¤„ç†"></a>2.4 å¼€å¯é»˜è®¤Servletå¤„ç†</h2><p>è®©SpringMVCConfigç±»å®ç°è¿™ä¸ªæ¥å£ï¼š<code>WebMvcConfigurer</code></p>
<p>å¹¶ä¸”é‡å†™ä»¥ä¸‹çš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">    configurer.enable();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-5-view-controller"><a href="#2-5-view-controller" class="headerlink" title="2.5 view-controller"></a>2.5 view-controller</h2><p>é‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">    registry.addViewController(<span class="string">&quot;/test&quot;</span>).setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-6-å¼‚å¸¸å¤„ç†å™¨"><a href="#2-6-å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="2.6 å¼‚å¸¸å¤„ç†å™¨"></a>2.6 å¼‚å¸¸å¤„ç†å™¨</h2><p>é‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é…ç½®å¼‚å¸¸å¤„ç†å™¨</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥é…ç½®å¤šä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼Œè¿™æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</span></span><br><span class="line">    <span class="type">SimpleMappingExceptionResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleMappingExceptionResolver</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å…¶ä¸­çš„ exceptionMappings å±æ€§</span></span><br><span class="line">    <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">    prop.setProperty(<span class="string">&quot;java.lang.Exception&quot;</span>, <span class="string">&quot;tip&quot;</span>);</span><br><span class="line">    resolver.setExceptionMappings(prop);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å…¶ä¸­çš„ exceptionAttribute å±æ€§</span></span><br><span class="line">    resolver.setExceptionAttribute(<span class="string">&quot;e&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å¼‚å¸¸å¤„ç†å™¨æ·»åŠ åˆ°Listé›†åˆä¸­ã€‚</span></span><br><span class="line">    resolvers.add(resolver);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-7-æ‹¦æˆªå™¨"><a href="#2-7-æ‹¦æˆªå™¨" class="headerlink" title="2.7 æ‹¦æˆªå™¨"></a>2.7 æ‹¦æˆªå™¨</h2><p>è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨å®ç°<code>HandlerInterceptor</code>æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.interceptors;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyInterceptor&#x27;s preHandle&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyInterceptor&#x27;s postHandle&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyInterceptor&#x27;s afterCompletion&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨SpringMVCConfigç±»é‡å†™ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    <span class="type">MyInterceptor</span> <span class="variable">myInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyInterceptor</span>();</span><br><span class="line">    registry.addInterceptor(myInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>).excludePathPatterns(<span class="string">&quot;/test&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬7ç« ã€‘ HttpMessageConverter</title>
    <url>/posts/SpringMVC-Chapter-Seven-HttpMessageConverter/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-HttpMessageConverter"><a href="#1-HttpMessageConverter" class="headerlink" title="1. HttpMessageConverter"></a>1. HttpMessageConverter</h1><p>HttpMessageConverteræ˜¯Spring MVCä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªæ¥å£ã€‚ç¿»è¯‘ä¸ºï¼šHTTPæ¶ˆæ¯è½¬æ¢å™¨ã€‚è¯¥æ¥å£ä¸‹æä¾›äº†å¾ˆå¤šå®ç°ç±»ï¼Œä¸åŒçš„å®ç°ç±»æœ‰ä¸åŒçš„è½¬æ¢æ–¹å¼ã€‚</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/HttpMessageConverter%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%B1%BB.png" alt="HttpMessageConverterçš„å®ç°ç±»" style="zoom: 67%;">

<h2 id="1-1-ä»€ä¹ˆæ˜¯HTTPæ¶ˆæ¯"><a href="#1-1-ä»€ä¹ˆæ˜¯HTTPæ¶ˆæ¯" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯HTTPæ¶ˆæ¯"></a>1.1 ä»€ä¹ˆæ˜¯HTTPæ¶ˆæ¯</h2><p>HTTPæ¶ˆæ¯å…¶å®å°±æ˜¯HTTPåè®®ã€‚HTTPåè®®åŒ…æ‹¬è¯·æ±‚åè®®å’Œå“åº”åè®®ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä»½HTTP POSTè¯·æ±‚åè®®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /springmvc/user/login HTTP/1.1																												--è¯·æ±‚è¡Œ</span><br><span class="line">Content-Type: application/x-www-form-urlencoded																						--è¯·æ±‚å¤´</span><br><span class="line">Content-Length: 32</span><br><span class="line">Host: www.example.com</span><br><span class="line">User-Agent: Mozilla/5.0</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">                                                                                          --ç©ºç™½è¡Œ</span><br><span class="line">username=admin&amp;password=1234																															--è¯·æ±‚ä½“</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯ä¸€ä»½HTTP GETè¯·æ±‚åè®®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /springmvc/user/del?id=1&amp;name=zhangsan HTTP/1.1																				--è¯·æ±‚è¡Œ</span><br><span class="line">Host: www.example.com																																			--è¯·æ±‚å¤´</span><br><span class="line">User-Agent: Mozilla/5.0</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯ä¸€ä»½HTTPå“åº”åè®®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK																																					--çŠ¶æ€è¡Œ</span><br><span class="line">Date: Thu, 01 Jul 2021 06:35:45 GMT																											--å“åº”å¤´</span><br><span class="line">Content-Type: text/plain; charset=utf-8</span><br><span class="line">Content-Length: 12</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Server: Apache/2.4.43 (Win64) OpenSSL/1.1.1g</span><br><span class="line">                                                                                        --ç©ºç™½è¡Œ</span><br><span class="line">&lt;!DOCTYPE html&gt;																																					--å“åº”ä½“</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;hello&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Hello World!&lt;/h1&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-è½¬æ¢å™¨è½¬æ¢çš„æ˜¯ä»€ä¹ˆ"><a href="#1-2-è½¬æ¢å™¨è½¬æ¢çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="1.2 è½¬æ¢å™¨è½¬æ¢çš„æ˜¯ä»€ä¹ˆ"></a>1.2 è½¬æ¢å™¨è½¬æ¢çš„æ˜¯ä»€ä¹ˆ</h2><p>è½¬æ¢çš„æ˜¯<code>HTTPåè®®</code>ä¸<code>Javaç¨‹åºä¸­çš„å¯¹è±¡</code>ä¹‹é—´çš„äº’ç›¸è½¬æ¢ã€‚è¯·çœ‹ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/FormHttpMessageConverter%E8%B4%9F%E8%B4%A3%E5%B0%86%E8%AF%B7%E6%B1%82%E5%8D%8F%E8%AE%AE%E8%BD%AC%E6%8D%A2%E4%B8%BAJava%E5%AF%B9%E8%B1%A1.png" alt="FormHttpMessageConverterè´Ÿè´£å°†è¯·æ±‚åè®®è½¬æ¢ä¸ºJavaå¯¹è±¡" style="zoom: 80%;">

<p>ä¸Šå›¾æ˜¯æˆ‘ä»¬ä¹‹å‰ç»å¸¸å†™çš„ä»£ç ã€‚è¯·æ±‚ä½“ä¸­çš„æ•°æ®æ˜¯å¦‚ä½•è½¬æ¢æˆuserå¯¹è±¡çš„ï¼Œåº•å±‚å®é™…ä¸Šä½¿ç”¨äº†<code>HttpMessageConverter</code>æ¥å£çš„å…¶ä¸­ä¸€ä¸ªå®ç°ç±»<code>FormHttpMessageConverter</code>ã€‚</p>
<p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡º<code>FormHttpMessageConverter</code>æ˜¯è´Ÿè´£å°†<code>è¯·æ±‚åè®®</code>è½¬æ¢ä¸º<code>Javaå¯¹è±¡</code>çš„ã€‚</p>
<p>å†çœ‹ä¸‹å›¾ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/StringHttpMessageConverter%E8%B4%9F%E8%B4%A3%E5%B0%86Java%E5%AF%B9%E8%B1%A1%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%93%8D%E5%BA%94%E5%8D%8F%E8%AE%AE.png" alt="StringHttpMessageConverterè´Ÿè´£å°†Javaå¯¹è±¡è½¬æ¢ä¸ºå“åº”åè®®">
ä¸Šå›¾çš„ä»£ç ä¹Ÿæ˜¯ä¹‹å‰æˆ‘ä»¬ç»å¸¸å†™çš„ï¼ŒControllerè¿”å›å€¼çœ‹åšé€»è¾‘è§†å›¾åç§°ï¼Œè§†å›¾è§£æå™¨å°†å…¶è½¬æ¢æˆç‰©ç†è§†å›¾åç§°ï¼Œç”Ÿæˆè§†å›¾å¯¹è±¡ï¼Œ`StringHttpMessageConverter`è´Ÿè´£å°†è§†å›¾å¯¹è±¡ä¸­çš„HTMLå­—ç¬¦ä¸²å†™å…¥åˆ°HTTPåè®®çš„å“åº”ä½“ä¸­ã€‚æœ€ç»ˆå®Œæˆå“åº”ã€‚

<p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡º<code>StringHttpMessageConverter</code>æ˜¯è´Ÿè´£å°†<code>Javaå¯¹è±¡</code>è½¬æ¢ä¸º<code>å“åº”åè®®</code>çš„ã€‚</p>
<p>é€šè¿‡ä»¥ä¸Šå†…å®¹çš„å­¦ä¹ ï¼Œå¤§å®¶åº”è¯¥èƒ½å¤Ÿäº†è§£åˆ°<code>HttpMessageConverter</code>æ¥å£æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/HttpMessageConverter%E6%8E%A5%E5%8F%A3%E4%BD%9C%E7%94%A8.png" alt="HttpMessageConverteræ¥å£ä½œç”¨"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š<code>HttpMessageConverter</code>æ¥å£çš„å¯ä»¥å°†è¯·æ±‚åè®®è½¬æ¢æˆJavaå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºå“åº”åè®®ã€‚</p>
<p><strong>HttpMessageConverteræ˜¯æ¥å£ï¼ŒSpringMVCå¸®æˆ‘ä»¬æä¾›äº†éå¸¸å¤šè€Œä¸°å¯Œçš„å®ç°ç±»ã€‚æ¯ä¸ªå®ç°ç±»éƒ½æœ‰è‡ªå·±ä¸åŒçš„è½¬æ¢é£æ ¼ã€‚</strong></p>
<p><strong>å¯¹äºæˆ‘ä»¬ç¨‹åºå‘˜æ¥è¯´ï¼ŒSpring MVCå·²ç»å¸®åŠ©æˆ‘ä»¬å†™å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œé€‰æ‹©åˆé€‚çš„HTTPæ¶ˆæ¯è½¬æ¢å™¨å³å¯ã€‚</strong></p>
<p><strong>æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿå½“ç„¶æ˜¯é€šè¿‡SpringMVCä¸ºæˆ‘ä»¬æä¾›çš„æ³¨è§£ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä¸åŒçš„æ³¨è§£æ¥å¯ç”¨ä¸åŒçš„æ¶ˆæ¯è½¬æ¢å™¨ã€‚</strong></p>
<p>åœ¨HTTPæ¶ˆæ¯è½¬æ¢å™¨è¿™ä¸€å°èŠ‚ï¼Œæˆ‘ä»¬é‡ç‚¹è¦æŒæ¡çš„æ˜¯ä¸¤ä¸ªæ³¨è§£ä¸¤ä¸ªç±»ï¼š</p>
<ul>
<li>@ResponseBody</li>
<li>@RequestBody</li>
<li>ResponseEntity</li>
<li>RequestEntity</li>
</ul>
<h1 id="2-Spring-MVCä¸­çš„AJAXè¯·æ±‚"><a href="#2-Spring-MVCä¸­çš„AJAXè¯·æ±‚" class="headerlink" title="2. Spring MVCä¸­çš„AJAXè¯·æ±‚"></a>2. Spring MVCä¸­çš„AJAXè¯·æ±‚</h1><p>SpringMVC+Vue3+Thymeleaf+Axioså‘é€ä¸€ä¸ªç®€å•çš„AJAXè¯·æ±‚ã€‚</p>
<p>1ã€å¼•å…¥Vueå’ŒAxiosçš„jsæ–‡ä»¶ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%BC%95%E5%85%A5Vue%E5%92%8CAxios%E7%9A%84js%E6%96%87%E4%BB%B6.png" alt="å¼•å…¥Vueå’ŒAxiosçš„jsæ–‡ä»¶"></p>
<p>2ã€springmvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/thymeleaf/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾æ§åˆ¶å™¨æ˜ å°„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼€å¯æ³¨è§£é©±åŠ¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é™æ€èµ„æºå¤„ç†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é‡ç‚¹æ˜¯é™æ€èµ„æºå¤„ç†ã€å¼€å¯æ³¨è§£é©±åŠ¨ã€è§†å›¾æ§åˆ¶å™¨æ˜ å°„ç­‰ç›¸å…³é…ç½®ã€‚</p>
<p>3ã€index.html:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue3.4.21.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getMessage&quot;</span>&gt;</span>è·å–æ¶ˆæ¯<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:inline</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                message : <span class="string">&quot;è¿™é‡Œçš„ä¿¡æ¯å°†è¢«åˆ·æ–°&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">async</span> <span class="title function_">getMessage</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>([[@&#123;/&#125;]] + <span class="string">&#x27;hello&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">message</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">                &#125;<span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>é‡ç‚¹æ¥äº†ï¼ŒControlleræ€ä¹ˆå†™å‘¢ï¼Œä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯ä¼ ç»Ÿçš„è¯·æ±‚ï¼ŒControllerè¿”å›ä¸€ä¸ª<code>é€»è¾‘è§†å›¾å</code>ï¼Œç„¶åäº¤ç»™<code>è§†å›¾è§£æå™¨</code>è§£æã€‚æœ€åè·³è½¬é¡µé¢ã€‚è€ŒAJAXè¯·æ±‚æ˜¯ä¸éœ€è¦è·³è½¬é¡µé¢çš„ï¼Œå› ä¸ºAJAXæ˜¯é¡µé¢å±€éƒ¨åˆ·æ–°ï¼Œä»¥å‰æˆ‘ä»¬åœ¨Servletä¸­ä½¿ç”¨<code>response.getWriter().print(&quot;message&quot;)</code>çš„æ–¹å¼å“åº”ã€‚</strong></p>
<p><strong>åœ¨Spring MVCä¸­æ€ä¹ˆåŠå‘¢ï¼Ÿå½“ç„¶ï¼Œæˆ‘ä»¬åœ¨Spring MVCä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ServletåŸç”ŸAPIæ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½</strong></p>
<p>4ã€ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…è¿™æ ·ä¹Ÿè¡Œï¼šä¸éœ€è¦æœ‰è¿”å›å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š<a href="http://localhost:8080/springmvc/">http://localhost:8080/springmvc/</a></p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E5%8F%91%E9%80%81AJAX%E8%AF%B7%E6%B1%82.png" alt="æµ‹è¯•å‘é€AJAXè¯·æ±‚" style="zoom: 67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%8F%91%E9%80%81AJAX%E8%AF%B7%E6%B1%82%E6%88%90%E5%8A%9F.png" alt="å‘é€AJAXè¯·æ±‚æˆåŠŸ" style="zoom:67%;">

<p><font color="red"><strong>PSï¼šå¦‚æœé‡‡ç”¨è¿™ç§æ–¹å¼å“åº”ï¼Œåˆ™å’Œ springmvc.xml æ–‡ä»¶ä¸­é…ç½®çš„è§†å›¾è§£æå™¨æ²¡æœ‰å…³ç³»ï¼Œä¸èµ°è§†å›¾è§£æå™¨äº†ã€‚</strong></font></p>
<p>éš¾é“æˆ‘ä»¬ä»¥åAJAXè¯·æ±‚éƒ½è¦ä½¿ç”¨åŸç”ŸServlet APIå—ï¼Ÿ</p>
<p>ä¸éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SpringMVCä¸­æä¾›çš„<code>HttpMessageConverter</code>æ¶ˆæ¯è½¬æ¢å™¨ã€‚</p>
<p>æˆ‘ä»¬è¦å‘å‰ç«¯å“åº”ä¸€ä¸ªå­—ç¬¦ä¸²â€helloâ€ï¼Œè¿™ä¸ªâ€helloâ€å°±æ˜¯å“åº”åè®®ä¸­çš„å“åº”ä½“ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@ResponseBody</code> æ³¨è§£æ¥å¯ç”¨å¯¹åº”çš„æ¶ˆæ¯è½¬æ¢å™¨ã€‚è€Œè¿™ç§æ¶ˆæ¯è½¬æ¢å™¨åªè´Ÿè´£å°†Controllerè¿”å›çš„ä¿¡æ¯ä»¥å“åº”ä½“çš„å½¢å¼å†™å…¥å“åº”åè®®ã€‚</p>
<h1 id="3-ResponseBody"><a href="#3-ResponseBody" class="headerlink" title="3. @ResponseBody"></a>3. @ResponseBody</h1><h2 id="3-1-StringHttpMessageConverter"><a href="#3-1-StringHttpMessageConverter" class="headerlink" title="3.1 StringHttpMessageConverter"></a>3.1 StringHttpMessageConverter</h2><p>ä¸Šé¢çš„AJAXæ¡ˆä¾‹ï¼ŒControllerçš„ä»£ç å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ç”±äºä½ ä½¿ç”¨äº† @ResponseBody æ³¨è§£</span></span><br><span class="line">        <span class="comment">// ä»¥ä¸‹çš„returnè¯­å¥è¿”å›çš„å­—ç¬¦ä¸²åˆ™ä¸å†æ˜¯â€œé€»è¾‘è§†å›¾åâ€äº†</span></span><br><span class="line">        <span class="comment">// è€Œæ˜¯ä½œä¸ºå“åº”åè®®çš„å“åº”ä½“è¿›è¡Œå“åº”ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€æ ¸å¿ƒéœ€è¦ç†è§£çš„ä½ç½®æ˜¯ï¼š<code>return &quot;hello&quot;</code>ï¼Œè¿™é‡Œçš„â€helloâ€ä¸æ˜¯é€»è¾‘è§†å›¾åäº†ï¼Œè€Œæ˜¯ä½œä¸ºå“åº”ä½“çš„å†…å®¹è¿›è¡Œå“åº”ã€‚ç›´æ¥è¾“å‡ºåˆ°æµè§ˆå™¨å®¢æˆ·ç«¯ã€‚</p>
<p>ä»¥ä¸Šç¨‹åºä¸­æ·»åŠ <code>@ResponseBody</code>è¿™ä¸ªæ³¨è§£ï¼Œä½¿ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨æ˜¯ï¼š<code>StringHttpMessageConverter</code>ã€‚</p>
<p>é€šå¸¸AJAXè¯·æ±‚éœ€è¦æœåŠ¡å™¨ç»™è¿”å›ä¸€æ®µJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥è¿”å›JSONæ ¼å¼çš„å­—ç¬¦ä¸²å—ï¼Ÿå½“ç„¶å¯ä»¥ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;username\&quot;:\&quot;zhangsan\&quot;,\&quot;password\&quot;:\&quot;1234\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95AJAX%E8%AF%B7%E6%B1%82%E9%9C%80%E8%A6%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%94%E5%9B%9EJSON%E6%A0%BC%E5%BC%8F%E5%AD%97%E7%AC%A6%E4%B8%B2.png" alt="æµ‹è¯•AJAXè¯·æ±‚éœ€è¦æœåŠ¡å™¨è¿”å›JSONæ ¼å¼å­—ç¬¦ä¸²" style="zoom:67%;">

<p>è¿™æ˜¯å®Œå…¨å¯ä»¥çš„ï¼Œæ­¤æ—¶åº•å±‚ä½¿ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨è¿˜æ˜¯ï¼š<code>StringHttpMessageConverter</code></p>
<blockquote>
<p>å¦‚æœåœ¨ç¨‹åºä¸­æ˜¯ä¸€ä¸ªPOJOå¯¹è±¡ï¼Œæ€ä¹ˆå°†POJOå¯¹è±¡ä»¥JSONæ ¼å¼çš„å­—ç¬¦ä¸²å“åº”ç»™æµè§ˆå™¨å‘¢ï¼Ÿ</p>
</blockquote>
<p>ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>è‡ªå·±å†™ä»£ç å°†POJOå¯¹è±¡è½¬æ¢æˆJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œç”¨ä¸Šé¢çš„æ–¹å¼ç›´æ¥returnå³å¯ã€‚</li>
<li>å¯ç”¨<code>MappingJackson2HttpMessageConverter</code>æ¶ˆæ¯è½¬æ¢å™¨ã€‚</li>
</ul>
<h2 id="3-2-MappingJackson2HttpMessageConverter"><a href="#3-2-MappingJackson2HttpMessageConverter" class="headerlink" title="3.2 MappingJackson2HttpMessageConverter"></a>3.2 MappingJackson2HttpMessageConverter</h2><p>å¯ç”¨<code>MappingJackson2HttpMessageConverter</code>æ¶ˆæ¯è½¬æ¢å™¨çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>1ã€å¼•å…¥jacksonä¾èµ–ï¼Œå¯ä»¥å°†javaå¯¹è±¡è½¬æ¢ä¸ºjsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.17.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€å¼€å¯æ³¨è§£é©±åŠ¨</p>
<p>è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼Œå¼€å¯æ³¨è§£é©±åŠ¨åï¼Œåœ¨<code>HandlerAdapter</code>ä¸­ä¼šè‡ªåŠ¨è£…é…ä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨ï¼š<code>MappingJackson2HttpMessageConverter</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€å‡†å¤‡ä¸€ä¸ªPOJOï¼ˆä½¿ç”¨Lombokç®€åŒ–ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€æ§åˆ¶å™¨æ–¹æ³•ä½¿ç”¨<font color="red"> <strong><code>@ResponseBody</code> æ³¨è§£æ ‡æ³¨ï¼ï¼ï¼</strong></font>æ§åˆ¶å™¨æ–¹æ³•è¿”å›è¿™ä¸ªPOJOå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;22222&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95@RestController%E6%B3%A8%E8%A7%A3.png" alt="æµ‹è¯•MappingJackson2HttpMessageConverteræ¶ˆæ¯è½¬æ¢å™¨" style="zoom: 50%;">

<p>ä»¥ä¸Šä»£ç åº•å±‚å¯ç”¨çš„å°±æ˜¯ <code>MappingJackson2HttpMessageConverter</code> æ¶ˆæ¯è½¬æ¢å™¨ã€‚</p>
<p>ä»–çš„åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œå¯ä»¥å°†POJOå¯¹è±¡è½¬æ¢æˆJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å‰ç«¯ã€‚</p>
<p>å…¶å®è¿™ä¸ªæ¶ˆæ¯è½¬æ¢å™¨<code>MappingJackson2HttpMessageConverter</code>æœ¬è´¨ä¸Šåªæ˜¯æ¯”<code>StringHttpMessageConverter</code>å¤šäº†ä¸€ä¸ªjsonå­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå…¶ä»–çš„è¿˜æ˜¯ä¸€æ ·ã€‚</p>
<h1 id="4-RestController"><a href="#4-RestController" class="headerlink" title="4. @RestController"></a>4. @RestController</h1><p>å› ä¸ºæˆ‘ä»¬ç°ä»£çš„å¼€å‘æ–¹å¼éƒ½æ˜¯åŸºäºAJAXæ–¹å¼çš„ï¼Œå› æ­¤ <code>@ResponseBody</code> æ³¨è§£éå¸¸é‡è¦ï¼Œå¾ˆå¸¸ç”¨ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ï¼ŒSpring MVCä¸­æä¾›äº†ä¸€ä¸ªæ³¨è§£ <code>@RestController</code>ã€‚è¿™ä¸€ä¸ªæ³¨è§£ä»£è¡¨äº†ï¼š<code>@Controller</code> + <code>@ResponseBody</code></p>
<p><code>@RestController</code> æ ‡æ³¨åœ¨ç±»ä¸Šå³å¯ã€‚è¢«å®ƒæ ‡æ³¨çš„Controllerä¸­æ‰€æœ‰çš„æ–¹æ³•ä¸Šéƒ½ä¼šè‡ªåŠ¨æ ‡æ³¨ <code>@ResponseBody</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;22222&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95@RestController%E6%B3%A8%E8%A7%A3.png" alt="æµ‹è¯•@RestControlleræ³¨è§£" style="zoom:50%;">

<h1 id="5-RequestBody"><a href="#5-RequestBody" class="headerlink" title="5. @RequestBody"></a>5. @RequestBody</h1><h2 id="5-1-FormHttpMessageConverter"><a href="#5-1-FormHttpMessageConverter" class="headerlink" title="5.1 FormHttpMessageConverter"></a>5.1 FormHttpMessageConverter</h2><p>è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ç›´æ¥å°†è¯·æ±‚ä½“ä¼ é€’ç»™Javaç¨‹åºï¼Œåœ¨Javaç¨‹åºä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªStringç±»å‹çš„å˜é‡æ¥æ”¶è¿™ä¸ªè¯·æ±‚ä½“çš„å†…å®¹ã€‚</p>
<p>åœ¨æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ³¨è§£çš„æ—¶å€™ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œä¿å­˜çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">    userDao.save(user);</span><br><span class="line">    <span class="comment">// ä¿å­˜æˆåŠŸè·³è½¬åˆ°æˆåŠŸé¡µé¢</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“è¯·æ±‚ä½“æäº¤çš„æ•°æ®æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=zhangsan&amp;password=1234&amp;email=zhangsan@example.com</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆSpring MVCä¼šè‡ªåŠ¨ä½¿ç”¨ <code>FormHttpMessageConverter</code>æ¶ˆæ¯è½¬æ¢å™¨ï¼Œå°†è¯·æ±‚ä½“è½¬æ¢æˆuserå¯¹è±¡ã€‚</p>
<p>å½“ä½¿ç”¨è¿™ä¸ªæ³¨è§£çš„æ—¶å€™ï¼š<font color="red"><strong>è¿™ä¸ªæ³¨è§£åªèƒ½å‡ºç°åœ¨æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</strong></font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> String requestBodyStr)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·æ±‚ä½“ï¼š&quot;</span> + requestBodyStr);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Spring MVCä»ç„¶ä¼šä½¿ç”¨ <code>FormHttpMessageConverter</code>æ¶ˆæ¯è½¬æ¢å™¨ï¼Œå°†è¯·æ±‚ä½“ç›´æ¥ä»¥å­—ç¬¦ä¸²å½¢å¼ä¼ é€’ç»™ requestBodyStr å˜é‡ã€‚</p>
<p>æµ‹è¯•è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚ä½“ï¼šusername=zhangsan&amp;password=1234&amp;email=zhangsan@example.com</span><br></pre></td></tr></table></figure>

<h2 id="5-2-MappingJackson2HttpMessageConverter"><a href="#5-2-MappingJackson2HttpMessageConverter" class="headerlink" title="5.2 MappingJackson2HttpMessageConverter"></a>5.2 MappingJackson2HttpMessageConverter</h2><p>å¦å¤–ï¼Œå¦‚æœåœ¨è¯·æ±‚ä½“ä¸­æäº¤çš„æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªJSONå­—ç¬¦ä¸²ä¼ é€’ç»™Spring MVCä¹‹åï¼Œèƒ½ä¸èƒ½å°†JSONå­—ç¬¦ä¸²è½¬æ¢æˆPOJOå¯¹è±¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚</p>
<p>æ­¤æ—¶å¿…é¡»ä½¿ç”¨ <code>@RequestBody</code> æ³¨è§£æ¥å®Œæˆ ã€‚å¹¶ä¸”åº•å±‚ä½¿ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨æ˜¯ï¼š<code>MappingJackson2HttpMessageConverter</code>ã€‚</p>
<blockquote>
<p>JSONå­—ç¬¦ä¸²è½¬æ¢æˆPOJOå¯¹è±¡å®ç°æ­¥éª¤</p>
</blockquote>
<p>1ã€å¼•å…¥jacksonä¾èµ–</p>
<p>2ã€å¼€å¯æ³¨è§£é©±åŠ¨</p>
<p>3ã€åˆ›å»ºPOJOç±»ï¼Œå°†POJOç±»ä½œä¸ºæ§åˆ¶å™¨æ–¹æ³•çš„å‚æ•°ï¼Œå¹¶ä½¿ç”¨ @RequestBody æ³¨è§£æ ‡æ³¨è¯¥å‚æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/send&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">send</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    System.out.println(user.getUsername());</span><br><span class="line">    System.out.println(user.getPassword());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€åœ¨è¯·æ±‚ä½“ä¸­æäº¤jsonæ ¼å¼çš„æ•°æ®</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue3.4.21.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendJSON&quot;</span>&gt;</span>é€šè¿‡POSTè¯·æ±‚å‘é€JSONç»™æœåŠ¡å™¨<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:inline</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> jsonObj = &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1234&quot;</span>&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">message</span>: <span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">async</span> <span class="title function_">sendJSON</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sendjson&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&#x27;/springmvc/send&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(jsonObj), &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;)</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">message</span> = res.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5ã€æµ‹è¯•ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E6%88%90POJO%E5%AF%B9%E8%B1%A1.png" alt="æµ‹è¯•JSONå­—ç¬¦ä¸²è½¬æ¢æˆPOJOå¯¹è±¡" style="zoom:50%;">

<p>6ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User(username=zhangsan, password=1234)</span><br><span class="line">zhangsan</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<h1 id="6-RequestEntity"><a href="#6-RequestEntity" class="headerlink" title="6. RequestEntity"></a>6. RequestEntity</h1><p>RequestEntityä¸æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œæ˜¯ä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»çš„å®ä¾‹å°è£…äº†æ•´ä¸ªè¯·æ±‚åè®®ï¼šåŒ…æ‹¬è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<p>å‡ºç°åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å‚æ•°ä¸Šï¼š</p>
<p>1ã€index.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue3.4.21.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendJSON&quot;</span>&gt;</span>é€šè¿‡POSTè¯·æ±‚å‘é€JSONç»™æœåŠ¡å™¨<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:inline</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> jsonObj = &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1234&quot;</span>&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">message</span>: <span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">async</span> <span class="title function_">sendJSON</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sendjson&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&#x27;/springmvc/send&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(jsonObj), &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;)</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">message</span> = res.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/send&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">send</span><span class="params">(RequestEntity&lt;User&gt; requestEntity)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·æ±‚æ–¹å¼ï¼š&quot;</span> + requestEntity.getMethod());</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·æ±‚URLï¼š&quot;</span> + requestEntity.getUrl());</span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> requestEntity.getHeaders();</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·æ±‚çš„å†…å®¹ç±»å‹ï¼š&quot;</span> + headers.getContentType());</span><br><span class="line">    System.out.println(<span class="string">&quot;è¯·æ±‚å¤´ï¼š&quot;</span> + headers);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> requestEntity.getBody();</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    System.out.println(user.getUsername());</span><br><span class="line">    System.out.println(user.getPassword());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€æµ‹è¯•ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚æ–¹å¼ï¼šPOST</span><br><span class="line">è¯·æ±‚URLï¼šhttp://localhost:8080/springmvc/send</span><br><span class="line">è¯·æ±‚çš„å†…å®¹ç±»å‹ï¼šapplication/json;charset=UTF-8</span><br><span class="line">è¯·æ±‚å¤´ï¼š[host:&quot;localhost:8080&quot;, connection:&quot;keep-alive&quot;, content-length:&quot;41&quot;, sec-ch-ua:&quot;&quot;Microsoft Edge&quot;;v=&quot;123&quot;, &quot;Not:A-Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;123&quot;&quot;, accept:&quot;application/json, text/plain, */*&quot;, sec-ch-ua-mobile:&quot;?0&quot;, user-agent:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0&quot;, sec-ch-ua-platform:&quot;&quot;Windows&quot;&quot;, origin:&quot;http://localhost:8080&quot;, sec-fetch-site:&quot;same-origin&quot;, sec-fetch-mode:&quot;cors&quot;, sec-fetch-dest:&quot;empty&quot;, referer:&quot;http://localhost:8080/springmvc/&quot;, accept-encoding:&quot;gzip, deflate, br, zstd&quot;, accept-language:&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;, cookie:&quot;username-localhost-8888=&quot;2|1:0|10:1712017810|23:username-localhost-8888|192:eyJ1c2VybmFtZSI6ICIzNWI3MjhjZDkyMmI0OGFlYjM1OGYxMmY4NTFlZTMzNCIsICJuYW1lIjogIkFub255bW91cyBBb2VkZSIsICJkaXNwbGF5X25hbWUiOiAiQW5vbnltb3VzIEFvZWRlIiwgImluaXRpYWxzIjogIkFBIiwgImNvbG9yIjogbnVsbH0=|a447ec864609b4c8600bddfe5ddf9ca59ff01b60f92cdc6ee819d5fd84bf761d&quot;; _xsrf=2|810e7615|c7a87f219cbac7ee02d1fe7e6b6c093c|1712017810; id=123456789; Idea-fa2b739c=6fadb531-b45d-4f4b-9773-90a820641d74&quot;, Content-Type:&quot;application/json;charset=UTF-8&quot;]</span><br><span class="line">User(username=zhangsan, password=1234)</span><br><span class="line">zhangsan</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p>åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œå¦‚æœä½ éœ€è¦è·å–æ›´è¯¦ç»†çš„è¯·æ±‚åè®®ä¸­çš„ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨<code>RequestEntity</code></p>
<h1 id="7-ResponseEntity"><a href="#7-ResponseEntity" class="headerlink" title="7. ResponseEntity"></a>7. ResponseEntity</h1><p>ResponseEntityä¸æ˜¯æ³¨è§£ï¼Œæ˜¯ä¸€ä¸ªç±»ã€‚ç”¨è¯¥ç±»çš„å®ä¾‹å¯ä»¥å°è£…å“åº”åè®®ï¼ŒåŒ…æ‹¬ï¼šçŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ä½“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æœä½ æƒ³å®šåˆ¶å±äºè‡ªå·±çš„å“åº”åè®®ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»ã€‚</p>
<p>å‡å¦‚æˆ‘è¦å®Œæˆè¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šå‰ç«¯æäº¤ä¸€ä¸ªidï¼Œåç«¯æ ¹æ®idè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¿”å›nullï¼Œè¯·åœ¨å‰ç«¯æ˜¾ç¤º404é”™è¯¯ã€‚å¦‚æœè¿”å›ä¸æ˜¯nullï¼Œåˆ™è¾“å‡ºè¿”å›çš„userã€‚</p>
<p>1ã€ç¼–å†™UserService.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;13234&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½®ç»„ä»¶æ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller,com.muyoukule.service&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨ index.html æ·»åŠ è¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/2&#125;&quot;</span>&gt;</span>æŸ¥æ‰¾id=1çš„ç”¨æˆ·ä¿¡æ¯<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€ç¼–å†™Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/users/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">getUserById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getUserById(id);</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.status(HttpStatus.NOT_FOUND).body(<span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€æµ‹è¯•ï¼šå½“ç”¨æˆ·ä¸å­˜åœ¨æ—¶</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E5%BD%93%E7%94%A8%E6%88%B7%E4%B8%8D%E5%AD%98%E5%9C%A8%E6%97%B6.png" alt="æµ‹è¯•å½“ç”¨æˆ·ä¸å­˜åœ¨æ—¶" style="zoom:50%;">

<p>6ã€æµ‹è¯•ï¼šå½“ç”¨æˆ·å­˜åœ¨æ—¶</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E5%BD%93%E7%94%A8%E6%88%B7%E5%AD%98%E5%9C%A8%E6%97%B6.png" alt="æµ‹è¯•å½“ç”¨æˆ·å­˜åœ¨æ—¶"></p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬3ç« ã€‘ è·å–è¯·æ±‚æ•°æ®</title>
    <url>/posts/SpringMVC-Chapter-Three-Get-Request-Data/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="0-æ€è€ƒ"><a href="#0-æ€è€ƒ" class="headerlink" title="0. æ€è€ƒ"></a>0. æ€è€ƒ</h1><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼š</p>
<p><code>http://localhost:8080/springmvc/register?name=muyoukule&amp;password=123&amp;email=muyoukule@example.com</code></p>
<p>åœ¨SpringMVCä¸­åº”è¯¥å¦‚ä½•è·å–è¯·æ±‚æäº¤çš„æ•°æ®å‘¢ï¼Ÿ</p>
<p>åœ¨SpringMVCä¸­åˆåº”è¯¥å¦‚ä½•è·å–è¯·æ±‚å¤´ä¿¡æ¯å‘¢ï¼Ÿ</p>
<p>åœ¨SpringMVCä¸­åˆåº”è¯¥å¦‚ä½•è·å–å®¢æˆ·ç«¯æäº¤çš„Cookieæ•°æ®å‘¢ï¼Ÿ</p>
<h1 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h1><p>1ã€åˆ›å»ºæ¨¡å—ï¼Œæ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.muyoukule<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springmvc-004<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ‰“åŒ…æ–¹å¼è®¾ç½®ä¸ºwaræ–¹å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Spring MVCä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ—¥å¿—æ¡†æ¶Logbackä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Servletä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Spring6å’ŒThymeleafæ•´åˆä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€æ·»åŠ webæ”¯æŒ</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/004%E6%A8%A1%E5%9D%97%E6%B7%BB%E5%8A%A0web%E6%94%AF%E6%8C%81.png" alt="004æ¨¡å—æ·»åŠ webæ”¯æŒ" style="zoom: 50%;">

<p>3ã€ç¼–å†™web.xmlæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æ¥æŒ‡å®šspringmvcé…ç½®æ–‡ä»¶çš„è·¯å¾„å’Œåå­—ã€‚--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™åˆå§‹åŒ–DispatcherServletï¼Œæé«˜ç¬¬ä¸€æ¬¡è®¿é—®çš„æ•ˆç‡--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€åˆ›å»ºUserController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toRegisterPage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;register&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€ç¼–å†™springmvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.muyoukule.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;thymeleafViewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ä½œç”¨äºè§†å›¾æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è®¾ç½®è§†å›¾æ¸²æŸ“åè¾“å‡ºæ—¶é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¦‚æœé…ç½®å¤šä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒæ¥å†³å®šä¼˜å…ˆä½¿ç”¨å“ªä¸ªè§†å›¾è§£æå™¨ï¼Œå®ƒçš„å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å½“ ThymeleafViewResolver æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œä¼šä½¿ç”¨è¯¥æ¨¡æ¿å¼•æ“æ¥è§£æã€ç¼–è¯‘å’Œæ¸²æŸ“æ¨¡æ¿--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--ç”¨äºæŒ‡å®š Thymeleaf æ¨¡æ¿å¼•æ“ä½¿ç”¨çš„æ¨¡æ¿è§£æå™¨ã€‚æ¨¡æ¿è§£æå™¨è´Ÿè´£æ ¹æ®æ¨¡æ¿ä½ç½®ã€æ¨¡æ¿èµ„æºåç§°ã€æ–‡ä»¶ç¼–ç ç­‰ä¿¡æ¯ï¼ŒåŠ è½½æ¨¡æ¿å¹¶å¯¹å…¶è¿›è¡Œè§£æ--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶çš„ä½ç½®ï¼ˆå‰ç¼€ï¼‰--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿æ–‡ä»¶åç¼€ï¼ˆåç¼€ï¼‰ï¼ŒThymeleafæ–‡ä»¶æ‰©å±•åä¸ä¸€å®šæ˜¯htmlï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ï¼Œä¾‹å¦‚txtï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯html--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--è®¾ç½®æ¨¡æ¿ç±»å‹ï¼Œä¾‹å¦‚ï¼šHTML,TEXT,JAVASCRIPT,CSSç­‰--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--ç”¨äºæ¨¡æ¿æ–‡ä»¶åœ¨è¯»å–å’Œè§£æè¿‡ç¨‹ä¸­é‡‡ç”¨çš„ç¼–ç å­—ç¬¦é›†--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>6ã€ç¼–å†™register.htmlæ–‡ä»¶</p>
<p>åœ¨WEB-INFç›®å½•ä¸‹æ–°å»º<code>templates</code>ç›®å½•ï¼Œåœ¨templatesç›®å½•ä¸­æ–°å»ºregister.htmlæ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>7ã€éƒ¨ç½²æµ‹è¯•</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%83%A8%E7%BD%B2%E6%B5%8B%E8%AF%95.png" alt="éƒ¨ç½²æµ‹è¯•"></p>
<h1 id="2-ä½¿ç”¨åŸç”Ÿçš„Servlet-APIè¿›è¡Œè·å–"><a href="#2-ä½¿ç”¨åŸç”Ÿçš„Servlet-APIè¿›è¡Œè·å–" class="headerlink" title="2. ä½¿ç”¨åŸç”Ÿçš„Servlet APIè¿›è¡Œè·å–"></a>2. ä½¿ç”¨åŸç”Ÿçš„Servlet APIè¿›è¡Œè·å–</h1><p>åŸç”Ÿçš„Servlet APIæŒ‡çš„æ˜¯ï¼š<code>HttpServletRequest</code></p>
<p>åœ¨SpringMVCå½“ä¸­ï¼Œä¸€ä¸ªControllerç±»ä¸­çš„æ–¹æ³•å‚æ•°ä¸Šå¦‚æœæœ‰<code>HttpServletRequest</code>ï¼ŒSpringMVCä¼šè‡ªåŠ¨å°†<code>å½“å‰è¯·æ±‚å¯¹è±¡</code>ä¼ é€’ç»™è¿™ä¸ªå‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æ¥è·å–è¯·æ±‚æäº¤çš„æ•°æ®ã€‚</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€åœ¨ register.html ä¸­å‡†å¤‡ä¸€ä¸ªæ³¨å†Œçš„è¡¨å•ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/register&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ€§åˆ«ï¼š</span><br><span class="line">    ç”· <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    å¥³ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    çˆ±å¥½ï¼š</span><br><span class="line">    æŠ½çƒŸ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;smoke&quot;</span>&gt;</span></span><br><span class="line">    å–é…’ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;drink&quot;</span>&gt;</span></span><br><span class="line">    çƒ«å¤´ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;perm&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ç®€ä»‹ï¼š<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;60&quot;</span> <span class="attr">name</span>=<span class="string">&quot;intro&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€å…ˆæµ‹è¯•è¿™ä¸ªé¡µé¢æ˜¯å¦å¯ä»¥æ­£å¸¸æ‰“å¼€ï¼Œæ˜¯å¦å¯ä»¥æ­£å¸¸æäº¤æ•°æ®ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BE%93%E5%85%A5%E6%B3%A8%E5%86%8C%E4%BF%A1%E6%81%AF.png" alt="è¾“å…¥æ³¨å†Œä¿¡æ¯" style="zoom:67%;">

<p>3ã€ç‚¹å‡»æ³¨å†Œï¼šF12çš„æ–¹å¼æŸ¥çœ‹æ˜¯å¦æäº¤äº†æ•°æ®ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9F%A5%E7%9C%8B%E6%98%AF%E5%90%A6%E6%8F%90%E4%BA%A4%E4%BA%86%E6%95%B0%E6%8D%AE.png" alt="æŸ¥çœ‹æ˜¯å¦æäº¤äº†æ•°æ®" style="zoom: 80%;">

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼šå¯ä»¥æ­£å¸¸æäº¤æ•°æ®ã€‚</p>
<p>4ã€æ¥ä¸‹æ¥åœ¨æ§åˆ¶å™¨æ·»åŠ ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†è¿™ä¸ªæ³¨å†Œçš„è¯·æ±‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value=&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡å½“å‰è¯·æ±‚å¯¹è±¡è·å–æäº¤çš„æ•°æ®</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">sex</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">    String[] hobbies = request.getParameterValues(<span class="string">&quot;hobby&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">intro</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;intro&quot;</span>);</span><br><span class="line">    System.out.println(username + <span class="string">&quot;,&quot;</span> + password + <span class="string">&quot;,&quot;</span> + sex + <span class="string">&quot;,&quot;</span> + Arrays.toString(hobbies) + <span class="string">&quot;,&quot;</span> + intro);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ³¨å†ŒæˆåŠŸ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ³¨å†ŒæˆåŠŸ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>6ã€æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BE%93%E5%85%A5%E6%B3%A8%E5%86%8C%E4%BF%A1%E6%81%AF.png" alt="è¾“å…¥æ³¨å†Œä¿¡æ¯" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2.png" alt="è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢" style="zoom: 67%;">

<p>7ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule,123,1,[smoke, drink, perm],66666666</span><br></pre></td></tr></table></figure>

<p><strong>è¿™æ ·é€šè¿‡ServletåŸç”Ÿçš„APIè·å–åˆ°æäº¤çš„æ•°æ®ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºæ–¹æ³•çš„å‚æ•°ä¾èµ–ServletåŸç”ŸAPIï¼ŒControllerçš„æµ‹è¯•å°†ä¸èƒ½å•ç‹¬æµ‹è¯•ï¼Œå¿…é¡»ä¾èµ–WEBæœåŠ¡å™¨æ‰èƒ½æµ‹è¯•ã€‚å¦å¤–ï¼Œæ¢å¥è¯è¯´ï¼Œå¦‚æœåœ¨SpringMVCä¸­ä½¿ç”¨äº†åŸç”Ÿçš„Servletï¼Œä½ ä¸ºä»€ä¹ˆè¿˜è¦ç”¨SpringMVCæ¡†æ¶å‘¢ğŸ™„ï¼ï¼ï¼ï¼ï¼</strong></p>
<h1 id="3-ä½¿ç”¨-RequestParamæ³¨è§£æ ‡æ³¨"><a href="#3-ä½¿ç”¨-RequestParamæ³¨è§£æ ‡æ³¨" class="headerlink" title="3. ä½¿ç”¨@RequestParamæ³¨è§£æ ‡æ³¨"></a>3. ä½¿ç”¨@RequestParamæ³¨è§£æ ‡æ³¨</h1><h2 id="3-1-RequestParamæ³¨è§£çš„åŸºæœ¬ä½¿ç”¨"><a href="#3-1-RequestParamæ³¨è§£çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="3.1 @RequestParamæ³¨è§£çš„åŸºæœ¬ä½¿ç”¨"></a>3.1 @RequestParamæ³¨è§£çš„åŸºæœ¬ä½¿ç”¨</h2><p><code>@RequestParam</code>æ³¨è§£ä½œç”¨ï¼šå°†<code>è¯·æ±‚å‚æ•°</code>ä¸æ–¹æ³•ä¸Šçš„<code>å½¢å‚</code>æ˜ å°„</p>
<p>1ã€ä¿®æ”¹registeræ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value = &quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value=&quot;username&quot;)</span></span></span><br><span class="line"><span class="params">        String a,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value=&quot;password&quot;)</span></span></span><br><span class="line"><span class="params">        String b,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value=&quot;sex&quot;)</span></span></span><br><span class="line"><span class="params">        String c,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value=&quot;hobby&quot;)</span></span></span><br><span class="line"><span class="params">        String[] d,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(name=&quot;intro&quot;)</span></span></span><br><span class="line"><span class="params">        String e)</span> &#123;</span><br><span class="line">    System.out.println(a);</span><br><span class="line">    System.out.println(b);</span><br><span class="line">    System.out.println(c);</span><br><span class="line">    System.out.println(Arrays.toString(d));</span><br><span class="line">    System.out.println(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PSï¼šå¯¹äº<code>@RequestParam</code>æ³¨è§£æ¥è¯´ï¼Œå±æ€§æœ‰<code>value</code>å’Œ<code>name</code>ï¼Œè¿™ä¸¤ä¸ªå±æ€§çš„ä½œç”¨ç›¸åŒï¼Œéƒ½æ˜¯ç”¨æ¥æŒ‡å®šæäº¤æ•°æ®çš„nameã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AliasFor(&quot;name&quot;)</span></span><br><span class="line">String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AliasFor(&quot;value&quot;)</span></span><br><span class="line">String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼šå‘é€è¯·æ±‚æ—¶æäº¤çš„æ•°æ®æ˜¯ï¼š<code>name1=value1&amp;name2=value2</code>ï¼Œåˆ™è¿™ä¸ªæ³¨è§£åº”è¯¥è¿™æ ·å†™ï¼š<code>@RequestParam(value=&quot;name1&quot;),@RequestParam(value=&quot;name2&quot;)</code></p>
<p>2ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%BE%93%E5%85%A5%E6%B3%A8%E5%86%8C%E4%BF%A1%E6%81%AF2.png" alt="è¾“å…¥æ³¨å†Œä¿¡æ¯2" style="zoom:67%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2.png" alt="è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢" style="zoom:80%;">

<p>3ã€æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule002</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink]</span><br><span class="line">muyoukule666</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>PSï¼š <code>@RequestParam(value=&quot;name1&quot;)</code> ä¸­valueä¸€å®šè¦ä¸å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°ç›¸åŒï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚</strong></font>ğŸ˜¨</p>
<p>ä¾‹å¦‚ï¼šå‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°ä¸º<code>username</code>ï¼Œè€Œåç«¯æ¥æ”¶å‚æ•°æ—¶å†™çš„æ˜¯<code>@RequestParam(value=&quot;uname&quot;)</code>ï¼Œå°±ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8F%82%E6%95%B0%E4%B8%8D%E5%8C%B9%E9%85%8D%E6%8A%A5%E9%94%99.png" alt="å‰åç«¯å‚æ•°ä¸åŒ¹é…æŠ¥é”™"></p>
<h3 id="3-1-1-PathVariableæ³¨è§£"><a href="#3-1-1-PathVariableæ³¨è§£" class="headerlink" title="3.1.1 @PathVariableæ³¨è§£"></a>3.1.1 @PathVariableæ³¨è§£</h3><p>åœ¨SpringMVCå½“ä¸­ï¼Œå¦‚æœè¯·æ±‚çš„URLä½¿ç”¨çš„æ˜¯RESTFulé£æ ¼çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®åº”è¯¥åœ¨javaç¨‹åºä¸­å¦‚ä½•è·å–å‘¢ï¼Ÿä½¿ç”¨å ä½ç¬¦æ–¹å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/login/&#123;a&#125;/&#123;b&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRESTFulURL</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@PathVariable(&quot;a&quot;)</span></span></span><br><span class="line"><span class="params">        String username,</span></span><br><span class="line"><span class="params">        <span class="meta">@PathVariable(&quot;b&quot;)</span></span></span><br><span class="line"><span class="params">        String password)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ç”¨æˆ·åï¼š&quot;</span> + username + <span class="string">&quot;ï¼Œå¯†ç ï¼š&quot;</span> + password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>@PathVariable</code> è¿™ä¸ªæ³¨è§£æ˜¯å¯ä»¥çœç•¥çš„ï¼Œå¦‚æœ<font color="red">è¯·æ±‚çš„URLå‚æ•°çš„åå­—å’Œå½¢å‚çš„nameç›¸åŒ</font>ï¼Œåˆ™ <code>@PathVariable</code> å¯ä»¥çœç•¥ã€‚</strong></p>
<p>ä½†æœ‰ä¸€ä¸ªå‰æï¼šå¦‚æœä½ é‡‡ç”¨çš„æ˜¯Spring6+ç‰ˆæœ¬ï¼Œä½ éœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­æŒ‡å®šç¼–è¯‘å‚æ•°<code>-parameter</code>ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">compilerArgs</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">arg</span>&gt;</span>-parameters<span class="tag">&lt;/<span class="name">arg</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">compilerArgs</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>PSï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Spring5çš„ç‰ˆæœ¬ï¼Œä»¥ä¸Šçš„é…ç½®æ˜¯ä¸éœ€è¦çš„ã€‚</strong></font>ğŸ˜</p>
<h2 id="3-2-RequestParamæ³¨è§£çš„requiredå±æ€§"><a href="#3-2-RequestParamæ³¨è§£çš„requiredå±æ€§" class="headerlink" title="3.2 @RequestParamæ³¨è§£çš„requiredå±æ€§"></a>3.2 @RequestParamæ³¨è§£çš„requiredå±æ€§</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<p><code>required</code>å±æ€§ç”¨æ¥è®¾ç½®è¯¥æ–¹æ³•å‚æ•°æ˜¯å¦ä¸ºå¿…é¡»çš„ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‚æ•°ä¸º <code>true</code>ï¼Œè¡¨ç¤ºæ–¹æ³•å‚æ•°æ˜¯å¿…éœ€çš„ã€‚å¦‚æœè¯·æ±‚ä¸­ç¼ºå°‘å¯¹åº”çš„å‚æ•°ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>å¯ä»¥å°†å…¶è®¾ç½®ä¸º<code>false</code>ï¼Œfalseè¡¨ç¤ºä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯·æ±‚ä¸­ç¼ºå°‘å¯¹åº”çš„å‚æ•°ï¼Œåˆ™æ–¹æ³•çš„å‚æ•°ä¸º<code>null</code>ã€‚</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€ä¿®æ”¹registeræ–¹æ³•ï¼Œæ·»åŠ ä¸€ä¸ª age å½¢å‚ï¼Œæ²¡æœ‰æŒ‡å®š required å±æ€§æ—¶ï¼Œé»˜è®¤æ˜¯trueï¼Œè¡¨ç¤ºå¿…éœ€çš„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ ä¸€ä¸ª age å½¢å‚</span></span><br><span class="line"><span class="meta">@RequestParam(name = &quot;age&quot;)</span> String age</span><br></pre></td></tr></table></figure>

<p>2ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œä½†å‰ç«¯è¡¨å•ä¸­<strong>æ²¡æœ‰å¡«å†™å¹´é¾„ageçš„è¾“å…¥æ¡†</strong>ï¼Œæˆ‘ä»¬æ¥çœ‹æŠ¥é”™ä¿¡æ¯ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9C%AA%E6%8F%90%E4%BE%9B%E5%8F%82%E6%95%B0age%E6%8A%A5%E9%94%99.png" alt="æœªæä¾›å‚æ•°ageæŠ¥é”™"></p>
<p>é”™è¯¯ä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬ï¼šå‚æ•°ageæ˜¯å¿…éœ€çš„ã€‚æ²¡æœ‰æä¾›è¿™ä¸ªè¯·æ±‚å‚æ•°ï¼ŒHTTPçŠ¶æ€ç  400</p>
<p>3ã€å¦‚æœå°† <code>required</code> å±æ€§è®¾ç½®ä¸º falseã€‚åˆ™è¯¥å‚æ•°åˆ™ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯·æ±‚å‚æ•°ä»ç„¶æœªæä¾›æ—¶ï¼Œæˆ‘ä»¬æ¥çœ‹ç»“æœï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å°† required å±æ€§è®¾ç½®ä¸º false</span></span><br><span class="line"><span class="meta">@RequestParam(name = &quot;age&quot;, required = false)</span> String age</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°</span></span><br><span class="line">System.out.println(<span class="string">&quot;age====&gt;&quot;</span> + age);</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œå¡«å†™ä¿¡æ¯å<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink]</span><br><span class="line">muyoukule66666</span><br><span class="line">age====&gt;null</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œå¦‚æœä¸€ä¸ªå‚æ•°è¢«è®¾ç½®ä¸º<code>ä¸æ˜¯å¿…éœ€çš„</code>ï¼Œå½“æ²¡æœ‰æäº¤å¯¹åº”çš„è¯·æ±‚å‚æ•°æ—¶ï¼Œå½¢å‚é»˜è®¤å€¼<code>null</code>ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœè¯·æ±‚å‚æ•°ä¸­æä¾›äº†ageï¼Œåˆ™ageä¸ºçœŸå®æäº¤çš„æ•°æ®ï¼ˆ<font color="red">PSï¼šæœªå¡«å†™ä¿¡æ¯ä¼šè¿”å›ç»™åç«¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²<code>&quot;&quot;</code></font>ï¼‰</p>
<p>1ã€ç»™register.htmlæ·»åŠ å¦‚ä¸‹è¾“å…¥æ¡†ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œå¡«å†™æ‰€æœ‰ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink, perm]</span><br><span class="line">4245</span><br><span class="line">age====&gt;18</span><br></pre></td></tr></table></figure>

<h2 id="3-3-RequestParamæ³¨è§£çš„defaultValueå±æ€§"><a href="#3-3-RequestParamæ³¨è§£çš„defaultValueå±æ€§" class="headerlink" title="3.3 @RequestParamæ³¨è§£çš„defaultValueå±æ€§"></a>3.3 @RequestParamæ³¨è§£çš„defaultValueå±æ€§</h2><p>defaultValueå±æ€§ç”¨æ¥è®¾ç½®å½¢å‚çš„é»˜è®¤å€¼ï¼Œå½“<code>æ²¡æœ‰æä¾›å¯¹åº”çš„è¯·æ±‚å‚æ•°</code>æˆ–è€…<code>è¯·æ±‚å‚æ•°çš„å€¼æ˜¯ç©ºå­—ç¬¦ä¸²&quot;&quot;</code>çš„æ—¶å€™ï¼Œæ–¹æ³•çš„å½¢å‚ä¼šé‡‡ç”¨é»˜è®¤å€¼ã€‚</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€ç»™ageå½¢å‚çš„<code>@RequestParam</code>æ³¨è§£æ·»åŠ ä¸€ä¸ª<code>defaultValue = &quot;18&quot;</code>å±æ€§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestParam(name = &quot;age&quot;, required = false,defaultValue = &quot;18&quot;)</span> String age</span><br></pre></td></tr></table></figure>

<p>2ã€å½“å‰ç«¯è¡¨å•ä¸­<strong>æ²¡æœ‰å¡«å†™å¹´é¾„ageçš„è¾“å…¥æ¡†</strong>ï¼Œç”¨æˆ·æ­£å¸¸å¡«å†™å…¶ä»–ä¿¡æ¯ï¼Œç‚¹å‡»æ³¨å†ŒåæˆåŠŸè·³è½¬åˆ°æ³¨å†ŒæˆåŠŸç•Œé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule003</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink, perm]</span><br><span class="line">muyoukule003</span><br><span class="line">age====&gt;18</span><br></pre></td></tr></table></figure>

<p>3ã€ç»™register.htmlæ·»åŠ å¦‚ä¸‹è¾“å…¥æ¡†ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€é‡æ–°å¯åŠ¨æœåŠ¡å™¨</p>
<p>4.1. å½“å‰ç«¯é¡µé¢ç”¨æˆ·æœªå¡«å†™ageï¼ˆæäº¤çš„ageæ˜¯ç©ºå­—ç¬¦ä¸²<code>&quot;&quot;</code>ï¼‰çš„æ—¶å€™ï¼Œç‚¹å‡»æ³¨å†ŒåæˆåŠŸè·³è½¬åˆ°æ³¨å†ŒæˆåŠŸç•Œé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule004</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink, perm]</span><br><span class="line">muyoukule004</span><br><span class="line">age====&gt;18</span><br></pre></td></tr></table></figure>

<p>4.2. å½“å‰ç«¯æäº¤çš„ageä¸æ˜¯ç©ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E5%A1%AB%E5%86%99age%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0.png" alt="å¡«å†™ageæäº¤å‚æ•°" style="zoom:67%;">

<p>å¡«å†™ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule005</span><br><span class="line">123</span><br><span class="line">1</span><br><span class="line">[smoke, drink, perm]</span><br><span class="line">muyoukule005</span><br><span class="line">age====&gt;81</span><br></pre></td></tr></table></figure>

<h1 id="4-ä¾é æ§åˆ¶å™¨æ–¹æ³•ä¸Šçš„å½¢å‚åæ¥æ¥æ”¶"><a href="#4-ä¾é æ§åˆ¶å™¨æ–¹æ³•ä¸Šçš„å½¢å‚åæ¥æ¥æ”¶" class="headerlink" title="4. ä¾é æ§åˆ¶å™¨æ–¹æ³•ä¸Šçš„å½¢å‚åæ¥æ¥æ”¶"></a>4. ä¾é æ§åˆ¶å™¨æ–¹æ³•ä¸Šçš„å½¢å‚åæ¥æ¥æ”¶</h1><p><strong><code>@RequestParam</code> è¿™ä¸ªæ³¨è§£æ˜¯å¯ä»¥çœç•¥çš„ï¼Œå¦‚æœæ–¹æ³•å½¢å‚çš„åå­—å’Œæäº¤æ•°æ®æ—¶çš„nameç›¸åŒï¼Œåˆ™ <code>@RequestParam</code> å¯ä»¥çœç•¥ã€‚</strong></p>
<p>ä½†æœ‰ä¸€ä¸ªå‰æï¼šå¦‚æœä½ é‡‡ç”¨çš„æ˜¯Spring6+ç‰ˆæœ¬ï¼Œä½ éœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­æŒ‡å®šç¼–è¯‘å‚æ•°<code>-parameter</code>ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">compilerArgs</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">arg</span>&gt;</span>-parameters<span class="tag">&lt;/<span class="name">arg</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">compilerArgs</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><font color="red"><strong>PSï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Spring5çš„ç‰ˆæœ¬ï¼Œä»¥ä¸Šçš„é…ç½®æ˜¯ä¸éœ€è¦çš„ã€‚</strong></font>ğŸ˜</p>
<p>Controllerä¸­çš„æ–¹æ³•åªéœ€è¦è¿™æ ·å†™ï¼š<font color="red"><strong>å½¢å‚çš„åå­—å¿…é¡»å’Œæäº¤çš„æ•°æ®çš„nameä¸€è‡´ï¼ï¼ï¼ï¼ï¼</strong></font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value=&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(String username, String password, String sex, String[] hobby, String intro)</span>&#123;</span><br><span class="line">    System.out.println(username + <span class="string">&quot;,&quot;</span> + password + <span class="string">&quot;,&quot;</span> + sex + <span class="string">&quot;,&quot;</span> + Arrays.toString(hobby) + <span class="string">&quot;,&quot;</span> + intro);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%BE%9D%E9%9D%A0%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95%E4%B8%8A%E7%9A%84%E5%BD%A2%E5%8F%82%E5%90%8D%E6%9D%A5%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0.png" alt="ä¾é æ§åˆ¶å™¨æ–¹æ³•ä¸Šçš„å½¢å‚åæ¥æ¥æ”¶å‚æ•°" style="zoom:67%;">

<p>å¡«å†™ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule006,123,1,[smoke],muyoukule006</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå½¢å‚åå’Œæäº¤çš„æ•°æ®çš„nameä¸ä¸€è‡´ï¼š</p>
<p>ä¾‹å¦‚å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°ä¸º<code>username</code>ï¼Œè€Œåç«¯æ¥æ”¶å‚æ•°æ—¶å†™çš„æ˜¯<code>String umane</code>ï¼Œå°±ä¼šå‡ºç°<code>uname</code>å€¼ä¸º<code>null</code>çš„æƒ…å†µï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">null,123,1,[smoke],muyoukule007</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œå¯¹äºæäº¤çš„hobbyæ•°æ®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨Stringæ¥æ¥æ”¶ï¼Œä¸ä¸€å®šä½¿ç”¨æ•°ç»„æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value=&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(String username, String password, String sex, String hobby, String intro)</span>&#123;</span><br><span class="line">    System.out.println(username + <span class="string">&quot;,&quot;</span> + password + <span class="string">&quot;,&quot;</span> + sex + <span class="string">&quot;,&quot;</span> + hobby + <span class="string">&quot;,&quot;</span> + intro);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">muyoukule008,123,1,smoke,drink,perm,muyoukule008</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°å¤šä¸ªhobbyæ˜¯é‡‡ç”¨ <code>,</code> è¿›è¡Œè¿æ¥çš„ã€‚</p>
<h1 id="5-ä½¿ç”¨POJOç±»-JavaBeanæ¥æ”¶è¯·æ±‚å‚æ•°"><a href="#5-ä½¿ç”¨POJOç±»-JavaBeanæ¥æ”¶è¯·æ±‚å‚æ•°" class="headerlink" title="5. ä½¿ç”¨POJOç±»&#x2F;JavaBeanæ¥æ”¶è¯·æ±‚å‚æ•°"></a>5. ä½¿ç”¨POJOç±»&#x2F;JavaBeanæ¥æ”¶è¯·æ±‚å‚æ•°</h1><p>ä»¥ä¸Šæ–¹å¼å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå½“æäº¤çš„æ•°æ®éå¸¸å¤šæ—¶ï¼Œæ–¹æ³•çš„å½¢å‚ä¸ªæ•°ä¼šéå¸¸å¤šï¼Œè¿™ä¸æ˜¯å¾ˆå¥½çš„è®¾è®¡ã€‚åœ¨SpringMVCä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>POJOç±»/JavaBean</code> æ¥æ¥æ”¶è¯·æ±‚å‚æ•°ã€‚ä¸è¿‡æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„è¦æ±‚ï¼š<font color="red"><strong><code>POJOç±»çš„å±æ€§å</code> å¿…é¡»å’ŒÂ <code>è¯·æ±‚å‚æ•°çš„å‚æ•°å</code> ä¿æŒä¸€è‡´ï¼ï¼</strong></font>ğŸ˜</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€æä¾›ä»¥ä¸‹çš„JavaBeanï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String[] hobby;</span><br><span class="line">    <span class="keyword">private</span> String intro;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(Long id, String username, String password, String sex, String[] hobby, String intro)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">        <span class="built_in">this</span>.hobby = hobby;</span><br><span class="line">        <span class="built_in">this</span>.intro = intro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getHobby() &#123;</span><br><span class="line">        <span class="keyword">return</span> hobby;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHobby</span><span class="params">(String[] hobby)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hobby = hobby;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getIntro</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> intro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIntro</span><span class="params">(String intro)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.intro = intro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, password=&#x27;&quot;</span> + password + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, hobby=&quot;</span> + Arrays.toString(hobby) +</span><br><span class="line">                <span class="string">&quot;, intro=&#x27;&quot;</span> + intro + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ä½ç½®ä¸Šä½¿ç”¨javabeanæ¥æ¥æ”¶è¯·æ±‚å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€æ‰§è¡Œç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%BD%BF%E7%94%A8POJO%E7%B1%BB%E6%8E%A5%E6%94%B6%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0.png" style="zoom: 67%;">

<p>4ã€å¡«å†™ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;muyoukule&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, perm], intro=&#x27;muyoukulehaoshuaia&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åº•å±‚çš„å®ç°åŸç†ï¼šåå°„æœºåˆ¶ã€‚å…ˆè·å–è¯·æ±‚å‚æ•°çš„åå­—ï¼Œå› ä¸ºè¯·æ±‚å‚æ•°çš„åå­—å°±æ˜¯JavaBeançš„å±æ€§åï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»™å¯¹åº”çš„å±æ€§èµ‹å€¼</strong>ã€‚</p>
<blockquote>
<p>æµ‹è¯•ä¸€ä¸‹ï¼šå½“JavaBeançš„å±æ€§åå’Œè¯·æ±‚å‚æ•°çš„å‚æ•°åä¸ä¸€è‡´æ—¶ï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
</blockquote>
<p><font color="red"><strong>PSï¼šgetterå’Œsetterçš„æ–¹æ³•åä¸ä¿®æ”¹ï¼Œåªä¿®æ”¹å±æ€§å</strong></font>ğŸ˜ƒ</p>
<p>1ã€ä¿®æ”¹å±æ€§å</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.muyoukule.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String uname;</span><br><span class="line">    <span class="keyword">private</span> String upwd;</span><br><span class="line">    <span class="keyword">private</span> String usex;</span><br><span class="line">    <span class="keyword">private</span> String[] uhobby;</span><br><span class="line">    <span class="keyword">private</span> String uintro;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(Long id, String username, String password, String sex, String[] hobby, String intro)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.uname = username;</span><br><span class="line">        <span class="built_in">this</span>.upwd = password;</span><br><span class="line">        <span class="built_in">this</span>.usex = sex;</span><br><span class="line">        <span class="built_in">this</span>.uhobby = hobby;</span><br><span class="line">        <span class="built_in">this</span>.uintro = intro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uname = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> upwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.upwd = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> usex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.usex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getHobby() &#123;</span><br><span class="line">        <span class="keyword">return</span> uhobby;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHobby</span><span class="params">(String[] hobby)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uhobby = hobby;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getIntro</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uintro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIntro</span><span class="params">(String intro)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uintro = intro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + uname + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, password=&#x27;&quot;</span> + upwd + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + usex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, hobby=&quot;</span> + Arrays.toString(uhobby) +</span><br><span class="line">                <span class="string">&quot;, intro=&#x27;&quot;</span> + uintro + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€æµ‹è¯•ï¼Œå¡«å†™å’Œä¸Šé¢ç›¸åŒçš„ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;muyoukule&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, perm], intro=&#x27;muyoukulehaoshuaia&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡æµ‹è¯•ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼š<code>è¯·æ±‚å‚æ•°å</code> å¯ä»¥å’Œ <code>JavaBeançš„å±æ€§å</code> ä¸ä¸€è‡´ã€‚</strong></p>
<p>1ã€æˆ‘ä»¬ç»§ç»­å°†å…¶ä¸­ä¸€ä¸ªå±æ€§çš„setterå’Œgetteræ–¹æ³•åä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¿®æ”¹å‰</span></span><br><span class="line"><span class="comment">/*public String getUsername() &#123;</span></span><br><span class="line"><span class="comment">    return uname;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">public void setUsername(String username) &#123;</span></span><br><span class="line"><span class="comment">    this.uname = username;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUname</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> uname;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUname</span><span class="params">(String uname)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.uname = uname;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€å†æ¬¡æµ‹è¯•ï¼Œå¡«å†™å’Œä¸Šé¢ç›¸åŒçš„ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;null&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, perm], intro=&#x27;muyoukulehaoshuaia&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹åˆ°ï¼šusernameå±æ€§æ²¡æœ‰èµ‹ä¸Šå€¼ã€‚å¯è§è¯·æ±‚å‚æ•°æ˜¯å¦å¯ä»¥èµ‹å€¼åˆ°JavaBeanå¯¹åº”çš„å±æ€§ä¸Šï¼Œä¸æ˜¯å–å†³äºå±æ€§åï¼Œè€Œæ˜¯setteræ–¹æ³•å</strong>ã€‚</p>
<h1 id="6-RequestHeaderæ³¨è§£"><a href="#6-RequestHeaderæ³¨è§£" class="headerlink" title="6. @RequestHeaderæ³¨è§£"></a>6. @RequestHeaderæ³¨è§£</h1><p>è¯¥æ³¨è§£çš„ä½œç”¨æ˜¯ï¼šå°† <code>è¯·æ±‚å¤´ä¿¡æ¯</code> æ˜ å°„åˆ° <code>æ–¹æ³•çš„å½¢å‚ä¸Š</code>ã€‚</p>
<p>å’Œ<code>@RequestParam</code>æ³¨è§£åŠŸèƒ½ç›¸ä¼¼ï¼Œ<code>@RequestParam</code>æ³¨è§£çš„ä½œç”¨ï¼šå°†<code>è¯·æ±‚å‚æ•°</code>æ˜ å°„åˆ°<code>æ–¹æ³•çš„å½¢å‚</code>ä¸Šã€‚</p>
<p>å½“ç„¶ï¼Œå¯¹äº<code>@RequestHeader</code>æ³¨è§£æ¥è¯´ï¼Œä¹Ÿæœ‰ä¸‰ä¸ªå±æ€§ï¼švalueã€requiredã€defaultValueï¼Œå’Œ<code>@RequestParam</code>ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€ç¼–å†™registeræ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user,</span></span><br><span class="line"><span class="params">                       <span class="meta">@RequestHeader(value = &quot;Referer&quot;, required = false, defaultValue = &quot;&quot;)</span></span></span><br><span class="line"><span class="params">                       String referer)</span> &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    System.out.println(referer);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€å¡«å†™ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;muyoukule&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;muyoukulehaoshuaia&#x27;&#125;</span><br><span class="line">http://localhost:8080/springmvc/</span><br></pre></td></tr></table></figure>

<h1 id="7-CookieValueæ³¨è§£"><a href="#7-CookieValueæ³¨è§£" class="headerlink" title="7. @CookieValueæ³¨è§£"></a>7. @CookieValueæ³¨è§£</h1><p>è¯¥æ³¨è§£çš„ä½œç”¨ï¼šå°† <code>è¯·æ±‚æäº¤çš„Cookieæ•°æ®</code> æ˜ å°„åˆ° <code>æ–¹æ³•å½¢å‚</code> ä¸Š</p>
<p>åŒæ ·æ˜¯æœ‰ä¸‰ä¸ªå±æ€§ï¼švalueã€requiredã€defaultValue</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€å‰ç«¯é¡µé¢ä¸­ç¼–å†™å‘é€cookieçš„ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">sendCookie</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;id=123456789; expires=Thu, 18 Dec 2025 12:00:00 UTC; path=/&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">location</span> = <span class="string">&quot;/springmvc/register&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;sendCookie()&quot;</span>&gt;</span>å‘æœåŠ¡å™¨ç«¯å‘é€Cookie<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€åç«¯UserControllerä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user,</span></span><br><span class="line"><span class="params">                       <span class="meta">@RequestHeader(value = &quot;Referer&quot;, required = false, defaultValue = &quot;&quot;)</span></span></span><br><span class="line"><span class="params">                       String referer,</span></span><br><span class="line"><span class="params">                       <span class="meta">@CookieValue(value = &quot;id&quot;, required = false, defaultValue = &quot;2222222222&quot;)</span></span></span><br><span class="line"><span class="params">                       String id)</span> &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    System.out.println(referer);</span><br><span class="line">    System.out.println(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€å¯åŠ¨æœåŠ¡å™¨æ‰“å¼€é¡µé¢ï¼Œç›´æ¥ç‚¹å‡»å‘ <code>æœåŠ¡å™¨ç«¯å‘é€Cookie</code> æŒ‰é’®æµ‹è¯•ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;null&#x27;, password=&#x27;null&#x27;, sex=&#x27;null&#x27;, hobby=null, intro=&#x27;null&#x27;&#125;</span><br><span class="line">http://localhost:8080/springmvc/</span><br><span class="line">123456789</span><br></pre></td></tr></table></figure>

<h1 id="8-è¯·æ±‚çš„ä¸­æ–‡ä¹±ç é—®é¢˜"><a href="#8-è¯·æ±‚çš„ä¸­æ–‡ä¹±ç é—®é¢˜" class="headerlink" title="8. è¯·æ±‚çš„ä¸­æ–‡ä¹±ç é—®é¢˜"></a>8. è¯·æ±‚çš„ä¸­æ–‡ä¹±ç é—®é¢˜</h1><h2 id="8-1-getè¯·æ±‚ä¹±ç "><a href="#8-1-getè¯·æ±‚ä¹±ç " class="headerlink" title="8.1 getè¯·æ±‚ä¹±ç "></a>8.1 getè¯·æ±‚ä¹±ç </h2><p>getè¯·æ±‚æ•°æ®åœ¨URIåé¢æäº¤ï¼Œè¿™ä¸ªä¹±ç é—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p>
<p>è§£å†³åŠæ³•æ˜¯æ‰¾åˆ°<code>CATALINA_HOME/config/server.xml</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°å…¶ä¸­é…ç½®ç«¯å£å·çš„æ ‡ç­¾<code>&lt;Connector&gt;</code>ï¼Œåœ¨è¯¥æ ‡ç­¾ä¸­æ·»åŠ   <code>URIEncoding=&quot;UTF-8&quot;</code></p>
<p>ä½†æ˜¯å¯¹äºé«˜ç‰ˆæœ¬çš„TomcatæœåŠ¡å™¨æ¥è¯´ï¼Œæ˜¯ä¸éœ€è¦è®¾ç½®çš„ï¼Œä¾‹å¦‚Tomcat10ï¼ŒTomcat9ï¼Œæœ‰å¦‚ä¸‹çš„é»˜è®¤é…ç½®ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹URIEncodingä½¿ç”¨çš„å°±æ˜¯<code>UTF-8</code>çš„ç¼–ç æ–¹å¼ã€‚</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat10%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F.png" alt="Tomcat10ç¼–ç æ–¹å¼"></p>
<p>ä½†å¯¹äºä½ç‰ˆæœ¬çš„TomcatæœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼šTomcat8ã€‚URIEncodingçš„é»˜è®¤é…ç½®æ˜¯<code>ISO-8859-1</code>ï¼Œå› æ­¤åœ¨Tomcat8ä¸­éœ€è¦æ‰‹åŠ¨é…ç½®server.xmlæ–‡ä»¶ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat8%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F.png" alt="Tomcat8ç¼–ç æ–¹å¼"></p>
<p>åœ¨ <code>conf</code> ç›®å½•ä¸‹æ‰“å¼€ <code>server.xml</code> æ–‡ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat8%E9%85%8D%E7%BD%AEUTF-8%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F.png" alt="Tomcat8é…ç½®UTF-8ç¼–ç æ–¹å¼"></p>
<blockquote>
<p>æµ‹è¯•é»˜è®¤æƒ…å†µä¸‹ï¼ŒTomcat10æ˜¯å¦å·²ç»è§£å†³äº†getè¯·æ±‚ä¹±ç é—®é¢˜</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/register&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ€§åˆ«ï¼š</span><br><span class="line">        ç”· <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">        å¥³ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    çˆ±å¥½ï¼š</span><br><span class="line">        æŠ½çƒŸ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;smoke&quot;</span>&gt;</span></span><br><span class="line">        å–é…’ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;drink&quot;</span>&gt;</span></span><br><span class="line">        çƒ«å¤´ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;perm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ç®€ä»‹ï¼š<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;60&quot;</span> <span class="attr">name</span>=<span class="string">&quot;intro&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä»¥ä¸Šè¡¨å•å·²ç»ä¿®æ”¹ä¸º<code>get</code>è¯·æ±‚äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95Tomcat10%E6%98%AF%E5%90%A6%E5%A4%84%E7%90%86get%E8%AF%B7%E6%B1%82%E4%B9%B1%E7%A0%81.png" alt="æµ‹è¯•Tomcat10æ˜¯å¦å¤„ç†getè¯·æ±‚ä¹±ç " style="zoom: 80%;">

<img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat10get%E8%AF%B7%E6%B1%82%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F.png" alt="Tomcat10getè¯·æ±‚æ³¨å†ŒæˆåŠŸ" style="zoom:50%;">

<p>æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;æœ¨åˆæ¯äº†&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;æœ¨åˆæ¯äº†å¤ªé…·äº†ï¼&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-2-postè¯·æ±‚ä¹±ç "><a href="#8-2-postè¯·æ±‚ä¹±ç " class="headerlink" title="8.2 postè¯·æ±‚ä¹±ç "></a>8.2 postè¯·æ±‚ä¹±ç </h2><p>postè¯·æ±‚æ˜¯è§£å†³è¯·æ±‚ä½“çš„ä¸­æ–‡ä¹±ç é—®é¢˜ã€‚è§£å†³åŠæ³•å¤§å®¶éƒ½çŸ¥é“ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ï¼Œå¯¹äºé«˜ç‰ˆæœ¬çš„<strong>Tomcat10</strong>æœåŠ¡å™¨æ¥è¯´ï¼Œé’ˆå¯¹è¯·æ±‚ä½“ä¸­çš„å­—ç¬¦ç¼–ç ä¹Ÿæ˜¯é…ç½®å¥½çš„ï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨äº†UTF-8ï¼Œä¸­æ–‡ä¹±ç é—®é¢˜ä¹Ÿè§£å†³äº†ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­é…ç½®çš„ï¼š<code>apache-tomcat-10.1.19\conf\web.xml</code></p>
<p>é…ç½®å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/Tomcat10%E9%92%88%E5%AF%B9%E8%AF%B7%E6%B1%82%E4%BD%93%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E6%98%AF%E9%85%8D%E7%BD%AE%E5%A5%BD%E7%9A%84.png" alt="Tomcat10é’ˆå¯¹è¯·æ±‚ä½“ä¸­çš„å­—ç¬¦ç¼–ç æ˜¯é…ç½®å¥½çš„"></p>
<p>é€šè¿‡ä»¥ä¸Šé…ç½®å¯ä»¥çœ‹åˆ°ï¼ŒTomcat10å¯¹è¯·æ±‚å’Œå“åº”éƒ½è®¾ç½®äº†é»˜è®¤çš„å­—ç¬¦ç¼–ç æ–¹å¼ä¸º<code>UTF-8</code>ã€‚</p>
<p><font color="red">PSï¼šTomcat9ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä»¥ä¸Šçš„é…ç½®æ˜¯æ²¡æœ‰çš„ã€‚</font></p>
<blockquote>
<p>æµ‹è¯•é’ˆå¯¹Tomcat10ï¼ŒSpringMVCä¼šä¸ä¼šæœ‰ä¹±ç é—®é¢˜</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/register&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ€§åˆ«ï¼š</span><br><span class="line">        ç”· <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">        å¥³ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    çˆ±å¥½ï¼š</span><br><span class="line">        æŠ½çƒŸ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;smoke&quot;</span>&gt;</span></span><br><span class="line">        å–é…’ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;drink&quot;</span>&gt;</span></span><br><span class="line">        çƒ«å¤´ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;perm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ç®€ä»‹ï¼š<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;60&quot;</span> <span class="attr">name</span>=<span class="string">&quot;intro&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>PSï¼šä»¥ä¸Šè¡¨å•å·²ç»ä¿®æ”¹ä¸ºpostè¯·æ±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;æœ¨åˆæ¯äº†&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;æœ¨åˆæ¯äº†å¤ªé…·å•¦ï¼ï¼&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹åˆ°åœ¨Tomcat10å½“ä¸­ï¼Œé»˜è®¤SpringMVCï¼Œå‘é€POSTè¯·æ±‚ï¼Œæ˜¯ä¸ä¼šå‡ºç°ä¹±ç é—®é¢˜çš„ã€‚</p>
<blockquote>
<p>æ¨¡æ‹Ÿä¹±ç </p>
</blockquote>
<p>å¦‚æœä¸æ˜¯Tomcat10ï¼Œåˆ™ä¼šå‡ºç°ä¹±ç é—®é¢˜ï¼Œæˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹ä¹±ç çš„äº§ç”Ÿï¼Œå°†<code>apache-tomcat-10.1.19\conf\web.xml</code>æ–‡ä»¶ä¸­çš„<code>UTF-8</code>é…ç½®ä¿®æ”¹ä¸º<code>ISO-8859-1</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Set the default request and response character encodings to ISO-8859-1.   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">request-character-encoding</span>&gt;</span>ISO-8859-1<span class="tag">&lt;/<span class="name">request-character-encoding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">response-character-encoding</span>&gt;</span>ISO-8859-1<span class="tag">&lt;/<span class="name">response-character-encoding</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä¸€å®šè¦é‡å¯Tomcat10</strong>ï¼Œæ–°çš„é…ç½®æ‰èƒ½ç”Ÿæ•ˆï¼Œæ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ä¹±ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;??Â¨?????????&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;??Â¨??????????Â¤?Ã©?Â·?????????&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œåœ¨SpringMVCä¸­å¦‚ä½•è§£å†³è¯·æ±‚ä½“çš„ä¸­æ–‡ä¹±ç é—®é¢˜å‘¢ï¼Ÿ</p>
<p>å½“ç„¶ï¼Œè¿˜æ˜¯ä½¿ç”¨<code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code>ï¼Œä½¿ç”¨å®ƒæœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œè¦æƒ³è§£å†³è¯·æ±‚ä½“ä¹±ç é—®é¢˜ï¼Œä»¥ä¸Šä»£ç å¿…é¡»åœ¨ <code>request.getParameter(&quot;username&quot;)</code>æ‰§è¡Œä¹‹å‰æ‰§è¡Œæ‰æœ‰æ•ˆã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ä»¥ä¸Šä»£ç å¦‚æœæ”¾åœ¨Controllerçš„ç›¸å…³æ–¹æ³•ä¸­æ‰§è¡Œæ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºControllerçš„æ–¹æ³•åœ¨æ‰§è¡Œä¹‹å‰ DispatcherServletå·²ç»è°ƒç”¨äº† <code>request.getParameter(&quot;username&quot;)</code>æ–¹æ³•ã€‚å› æ­¤åœ¨Controlleræ–¹æ³•ä¸­ä½¿ç”¨<code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code>æ— æ•ˆã€‚</p>
<p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼ˆPSï¼šæ³¨æ„è¡¨å•ä¸ºpostè¯·æ±‚ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user, HttpServletRequest request)</span> <span class="keyword">throws</span> UnsupportedEncodingException &#123;</span><br><span class="line">    request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;??Â¨?????????&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;??Â¨??????????Â¤?Ã©?Â·?????????&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹åˆ°ï¼šåœ¨Controllerå½“ä¸­è°ƒç”¨ <code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code> æ˜¯æ— æ³•è§£å†³POSTä¹±ç é—®é¢˜çš„ã€‚</p>
<p>é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿæ€ä¹ˆæ ·æ‰èƒ½åœ¨DispatcherServletä¹‹å‰æ‰§è¡Œ <code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code> å‘¢ï¼Ÿ</p>
<p>æ²¡é”™ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶æƒ³åˆ°äº†ï¼šè¿‡æ»¤å™¨Filterã€‚è¿‡æ»¤å™¨Filterå¯ä»¥åœ¨Servletæ‰§è¡Œä¹‹å‰æ‰§è¡Œã€‚æœ‰äººåˆè¯´äº†ï¼šç›‘å¬å™¨ä¸è¡Œå—ï¼Ÿä¸è¡Œã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸€æ¬¡è¯·æ±‚è§£å†³ä¹±ç ï¼Œè€Œç›‘å¬å™¨åªåœ¨æœåŠ¡å™¨å¯åŠ¨é˜¶æ®µæ‰§è¡Œä¸€æ¬¡ã€‚å› æ­¤è¿™é‡Œè§£å†³æ¯ä¸€æ¬¡è¯·æ±‚çš„ä¹±ç é—®é¢˜ï¼Œåº”è¯¥ä½¿ç”¨è¿‡æ»¤å™¨Filterã€‚</p>
<p>1ã€ç¼–å†™è¿‡æ»¤å™¨<code>CharacterEncodingFilter</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CharacterEncodingFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®è¯·æ±‚ä½“çš„å­—ç¬¦é›†</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®å“åº”çš„å­—ç¬¦é›†</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‰§è¡Œä¸‹ä¸€ä¸ªèµ„æº</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€åœ¨web.xmlé‡Œé…ç½®è¿‡æ»¤å™¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.muyoukule.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€ç¼–å†™æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œå¡«å†™ä¿¡æ¯åç‚¹å‡»æ³¨å†Œ<strong>æˆåŠŸ</strong>è·³è½¬åˆ°æ³¨å†ŒæˆåŠŸé¡µé¢ï¼Œæ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;æœ¨åˆæ¯äº†&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;æœ¨åˆæ¯äº†å¤ªé…·å•¦ï¼ï¼ï¼&#x27;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SpringMVCæ¡†æ¶å†…ç½®å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨CharacterEncodingFilter</p>
</blockquote>
<p>é™¤æ­¤ä»¥å¤–ï¼ŒSpringMVCæ¡†æ¶å†…ç½®äº†å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼Œå«åš <code>CharacterEncodingFilter</code>ï¼Œæˆ‘ä»¬ç›´æ¥é…ç½®å¥½å³å¯ä½¿ç”¨ã€‚</p>
<p><code>CharacterEncodingFilter</code> ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doFilterInternal</span><span class="params">(</span></span><br><span class="line"><span class="params">        HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span></span><br><span class="line">        <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> getEncoding();</span><br><span class="line">    <span class="keyword">if</span> (encoding != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isForceRequestEncoding() || request.getCharacterEncoding() == <span class="literal">null</span>) &#123;</span><br><span class="line">            request.setCharacterEncoding(encoding);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isForceResponseEncoding()) &#123;</span><br><span class="line">            response.setCharacterEncoding(encoding);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    filterChain.doFilter(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ†æä»¥ä¸Šæ ¸å¿ƒæ–¹æ³•å¾—çŸ¥è¯¥è¿‡æ»¤å™¨å¯¹è¯·æ±‚å’Œå“åº”éƒ½è®¾ç½®äº†å­—ç¬¦ç¼–ç æ–¹å¼ã€‚</p>
<ul>
<li>å½“ <code>å¼ºè¡Œä½¿ç”¨è¯·æ±‚å­—ç¬¦ç¼–ç æ–¹å¼ä¸ºtrue</code> æ—¶ï¼Œæˆ–è€… <code>è¯·æ±‚å¯¹è±¡çš„å­—ç¬¦ç¼–ç æ–¹å¼ä¸ºnull</code> æ—¶ï¼Œè®¾ç½®è¯·æ±‚çš„å­—ç¬¦ç¼–ç æ–¹å¼ã€‚</li>
<li>å½“ <code>å¼ºè¡Œä½¿ç”¨å“åº”å­—ç¬¦ç¼–ç æ–¹å¼ä¸ºtrue</code> æ—¶ï¼Œè®¾ç½®å“åº”çš„å­—ç¬¦ç¼–ç æ–¹å¼ã€‚</li>
</ul>
<p>æ ¹æ®ä»¥ä¸Šä»£ç ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹é…ç½®ä¿¡æ¯ï¼Œåœ¨web.xmlæ–‡ä»¶ä¸­å¯¹è¿‡æ»¤å™¨è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ä½¿ç”¨SpringMVCæ¡†æ¶å†…ç½®çš„å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é‡å¯Tomcat10ï¼Œçœ‹çœ‹ä¹±ç æ˜¯å¦èƒ½å¤Ÿè§£å†³ï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User&#123;id=null, username=&#x27;æœ¨åˆæ¯äº†&#x27;, password=&#x27;123&#x27;, sex=&#x27;1&#x27;, hobby=[smoke, drink, perm], intro=&#x27;æœ¨åˆæ¯äº†å¤ªé…·å•¦ï¼ï¼&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>PSï¼šé’ˆå¯¹äºæˆ‘ä»¬<strong>å½“å‰çš„Tomcat10çš„é…ç½®</strong>æ¥è¯´ï¼Œå®ƒæœ‰é»˜è®¤çš„å­—ç¬¦é›†<code>ISO-8859-1</code>ï¼Œå› æ­¤ä»¥ä¸‹åœ¨web.xmlæ–‡ä»¶ä¸­çš„é…ç½®æ˜¯ä¸èƒ½ç¼ºå°‘çš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœç¼ºå°‘å®ƒï¼Œä»ç„¶æ˜¯ä¼šå­˜åœ¨ä¹±ç é—®é¢˜çš„ã€‚è‡ªè¡Œæµ‹è¯•ä¸€ä¸‹ï¼ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬12ç« ã€‘ æ‰‹å†™SpringMVC</title>
    <url>/posts/SpringMVC-Chapter-Twelve-White-SpringMVC/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="æ•´ä¸ªå®Œæ•´ç³»ç»Ÿçš„å‚ä¸è€…"><a href="#æ•´ä¸ªå®Œæ•´ç³»ç»Ÿçš„å‚ä¸è€…" class="headerlink" title="æ•´ä¸ªå®Œæ•´ç³»ç»Ÿçš„å‚ä¸è€…"></a>æ•´ä¸ªå®Œæ•´ç³»ç»Ÿçš„å‚ä¸è€…</h1><p>å¯¹äºä¸€ä¸ªå®Œæ•´çš„webé¡¹ç›®å‚ä¸è€…åŒ…æ‹¬ï¼š</p>
<ul>
<li>Servletè§„èŒƒçš„åˆ¶å®šè€…ï¼ˆå·²æœ‰ï¼‰</li>
<li>å®ç°Servletè§„èŒƒçš„TomcatæœåŠ¡å™¨ï¼ˆå·²æœ‰ï¼‰</li>
<li>Spring MVCæ¡†æ¶çš„å¼€å‘è€…ï¼ˆæ‰‹å†™Spring MVCæ¡†æ¶ï¼‰</li>
<li>ç¼–å†™webappçš„å¼€å‘è€…ï¼ˆç”¨Spring MVCæ¡†æ¶çš„äººï¼‰</li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç¬¬2ç« ã€‘ @RequestMappingæ³¨è§£</title>
    <url>/posts/SpringMVC-Chapter-Two-@RequestMapping/</url>
    <content><![CDATA[<p>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1sC411L76f/">SpringMVCæ•™ç¨‹ï¼ŒSpringMVCä»é›¶åˆ°ç²¾é€šï¼Œè€æœSpringMVCï¼ŒåŠ¨åŠ›èŠ‚ç‚¹SpringMVC</a></p>
<h1 id="1-RequestMappingçš„ä½œç”¨"><a href="#1-RequestMappingçš„ä½œç”¨" class="headerlink" title="1. RequestMappingçš„ä½œç”¨"></a>1. RequestMappingçš„ä½œç”¨</h1><p><code>@RequestMapping</code> æ³¨è§£æ˜¯ Spring MVC æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ§åˆ¶å™¨æ˜ å°„æ³¨è§£ï¼Œç”¨äºå°†è¯·æ±‚æ˜ å°„åˆ°ç›¸åº”çš„å¤„ç†æ–¹æ³•ä¸Šã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¯ä»¥å°†æŒ‡å®š URL çš„è¯·æ±‚ç»‘å®šåˆ°ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•æˆ–ç±»ä¸Šï¼Œä»è€Œå®ç°å¯¹è¯·æ±‚çš„å¤„ç†å’Œå“åº”ã€‚</p>
<h1 id="2-RequestMappingçš„å‡ºç°ä½ç½®"><a href="#2-RequestMappingçš„å‡ºç°ä½ç½®" class="headerlink" title="2. RequestMappingçš„å‡ºç°ä½ç½®"></a>2. RequestMappingçš„å‡ºç°ä½ç½®</h1><p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/RequestMapping%E7%9A%84%E5%87%BA%E7%8E%B0%E4%BD%8D%E7%BD%AE.png" alt="RequestMappingçš„å‡ºç°ä½ç½®"></p>
<p>é€šè¿‡RequestMappingçš„æºç å¯ä»¥çœ‹åˆ°RequestMappingæ³¨è§£åªèƒ½å‡ºç°åœ¨<code>ç±»</code>ä¸Šæˆ–è€…<code>æ–¹æ³•</code>ä¸Šã€‚</p>
<h1 id="3-ç±»ä¸Šä¸æ–¹æ³•ä¸Šç»“åˆä½¿ç”¨"><a href="#3-ç±»ä¸Šä¸æ–¹æ³•ä¸Šç»“åˆä½¿ç”¨" class="headerlink" title="3. ç±»ä¸Šä¸æ–¹æ³•ä¸Šç»“åˆä½¿ç”¨"></a>3. ç±»ä¸Šä¸æ–¹æ³•ä¸Šç»“åˆä½¿ç”¨</h1><p>æˆ‘ä»¬å…ˆæ¥çœ‹ï¼Œåœ¨åŒä¸€ä¸ªwebåº”ç”¨ä¸­ï¼Œæ˜¯å¦å¯ä»¥æœ‰ä¸¤ä¸ªå®Œå…¨ä¸€æ ·çš„<code>RequestMapping</code>ã€‚æµ‹è¯•ä¸€ä¸‹ï¼šå‡è®¾ä¸¤ä¸ªRequestMappingï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯å±•ç¤ºç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå¦ä¸€ä¸ªæ˜¯å±•ç¤ºå•†å“è¯¦ç»†ä¿¡æ¯ã€‚æä¾›ä¸¤ä¸ªControllerï¼Œä¸€ä¸ªæ˜¯<code>UserController</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code>ProductController</code>ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/detail&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;detail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/detail&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;detail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¸¤ä¸ªControllerçš„RequestMappingç›¸åŒï¼Œéƒ½æ˜¯ <code>/detail</code>ï¼Œæˆ‘ä»¬æ¥å¯åŠ¨æœåŠ¡å™¨å¼‚å¸¸å‘ç”Ÿäº†ï¼Œå¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: </span><br><span class="line">Error creating bean with name &#x27;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#x27;: </span><br><span class="line">Ambiguous mapping. Cannot map &#x27;userController&#x27; method </span><br><span class="line">com.powernode.springmvc.controller.UserController#toDetail()</span><br><span class="line">to &#123; [/detail]&#125;: There is already &#x27;productController&#x27; bean method</span><br><span class="line">com.powernode.springmvc.controller.ProductController#toDetail() mapped.</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå¼‚å¸¸ä¿¡æ¯å¤§è‡´çš„æ„æ€æ˜¯ï¼šä¸æ˜ç¡®çš„æ˜ å°„ã€‚æ— æ³•æ˜ å°„UserControllerä¸­çš„toDetail()æ–¹æ³•ï¼Œå› ä¸ºå·²ç»åœ¨ProductControllerä¸­æ˜ å°„è¿‡äº†ï¼ï¼ï¼ï¼</p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œåœ¨åŒä¸€ä¸ªwebappä¸­ï¼ŒRequestMappingå¿…é¡»å…·æœ‰å”¯ä¸€æ€§ã€‚æ€ä¹ˆè§£å†³ä»¥ä¸Šé—®é¢˜ï¼Ÿä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šå°†æ–¹æ³•ä¸ŠRequestMappingçš„æ˜ å°„è·¯å¾„ä¿®æ”¹çš„ä¸ä¸€æ ·ã€‚</li>
<li>ç¬¬äºŒç§æ–¹æ¡ˆï¼šåœ¨ç±»ä¸Šæ·»åŠ RequestMappingçš„æ˜ å°„è·¯å¾„ï¼Œä»¥ç±»ä¸Šçš„RequestMappingä½œä¸ºå‘½åç©ºé—´ï¼Œæ¥åŠ ä»¥åŒºåˆ†ä¸¤ä¸ªä¸åŒçš„æ˜ å°„ã€‚</li>
</ul>
<h2 id="3-1-ç¬¬ä¸€ç§æ–¹æ¡ˆ"><a href="#3-1-ç¬¬ä¸€ç§æ–¹æ¡ˆ" class="headerlink" title="3.1 ç¬¬ä¸€ç§æ–¹æ¡ˆ"></a>3.1 ç¬¬ä¸€ç§æ–¹æ¡ˆ</h2><p>å°†æ–¹æ³•ä¸ŠRequestMappingçš„æ˜ å°„è·¯å¾„ä¿®æ”¹çš„ä¸ä¸€æ ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/user/detail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/user/detail&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/product/detail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/product/detail&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ–°å»º<code>templates</code>ç›®å½•ä¸ºè¿™ä¸¤ä¸ªè¯·æ±‚åˆ†åˆ«æä¾›å¯¹åº”çš„è§†å›¾é¡µé¢ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E4%B8%A4%E4%B8%AA%E8%AF%B7%E6%B1%82%E5%AF%B9%E5%BA%94%E7%9A%84%E8%A7%86%E5%9B%BE%E9%A1%B5%E9%9D%A2.png" alt="ä¸¤ä¸ªè¯·æ±‚å¯¹åº”çš„è§†å›¾é¡µé¢"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å•†å“è¯¦æƒ…é¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>å•†å“è¯¦æƒ…<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·è¯¦æƒ…é¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç”¨æˆ·è¯¦æƒ…<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ–°å¢ä¸€ä¸ª IndexController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨é¦–é¡µé¢æ·»åŠ ä¸¤ä¸ªè¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/detail&#125;&quot;</span>&gt;</span>ç”¨æˆ·è¯¦æƒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/product/detail&#125;&quot;</span>&gt;</span>å•†å“è¯¦æƒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨TomcatæœåŠ¡å™¨å°±æ²¡æœ‰æŠ¥é”™äº†ï¼Œè®¿é—® <code>http://localhost:8080/springmvc/</code> æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E7%94%A8%E6%88%B7%E8%AF%A6%E6%83%85%E5%92%8C%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85.png" alt="ç”¨æˆ·è¯¦æƒ…å’Œå•†å“è¯¦æƒ…"></p>
<p>ç‚¹å‡»ç”¨æˆ·è¯¦æƒ…ï¼Œç‚¹å‡»å•†å“è¯¦æƒ…ï¼Œä¹Ÿéƒ½å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚</p>
<h2 id="3-2-ç¬¬äºŒç§æ–¹æ¡ˆ"><a href="#3-2-ç¬¬äºŒç§æ–¹æ¡ˆ" class="headerlink" title="3.2 ç¬¬äºŒç§æ–¹æ¡ˆ"></a>3.2 ç¬¬äºŒç§æ–¹æ¡ˆ</h2><p>åœ¨ç±»ä¸Šå’Œæ–¹æ³•ä¸Šéƒ½ä½¿ç”¨RequestMappingæ³¨è§£æ¥è¿›è¡Œè·¯å¾„çš„æ˜ å°„ã€‚å‡è®¾åœ¨ç±»ä¸Šæ˜ å°„çš„è·¯å¾„æ˜¯<code>/a</code>ï¼Œåœ¨æ–¹æ³•ä¸Šæ˜ å°„çš„è·¯å¾„æ˜¯<code>/b</code>ï¼Œé‚£ä¹ˆæ•´ä½“è¡¨ç¤ºæ˜ å°„çš„è·¯å¾„å°±æ˜¯ï¼š<code>/a/b</code></p>
<p>åœ¨ç¬¬ä¸€ç§æ–¹æ¡ˆä¸­ï¼Œå‡è®¾UserControllerç±»ä¸­æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•çš„ RequestMappingæ³¨è§£ä¸­éƒ½éœ€è¦ä»¥<code>/user</code>å¼€å§‹ï¼Œæ˜¾ç„¶æ¯”è¾ƒå•°å—¦ï¼Œå¹²è„†å°†<code>/user</code>æå‡åˆ°ç±»çº§åˆ«ä¸Šï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/detail&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/user/detail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/product&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/detail&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toDetail</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/product/detail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡æµ‹è¯•ï¼Œç¨‹åºå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼ï¼ï¼</p>
<h1 id="4-RequestMppingæ³¨è§£çš„valueå±æ€§"><a href="#4-RequestMppingæ³¨è§£çš„valueå±æ€§" class="headerlink" title="4. RequestMppingæ³¨è§£çš„valueå±æ€§"></a>4. RequestMppingæ³¨è§£çš„valueå±æ€§</h1><h2 id="4-1-valueå±æ€§çš„ä½¿ç”¨"><a href="#4-1-valueå±æ€§çš„ä½¿ç”¨" class="headerlink" title="4.1 valueå±æ€§çš„ä½¿ç”¨"></a>4.1 valueå±æ€§çš„ä½¿ç”¨</h2><p>valueå±æ€§æ˜¯è¯¥æ³¨è§£æœ€æ ¸å¿ƒçš„å±æ€§ï¼Œvalueå±æ€§å¡«å†™çš„æ˜¯è¯·æ±‚è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´é€šè¿‡è¯¥è¯·æ±‚è·¯å¾„ä¸å¯¹åº”çš„æ§åˆ¶å™¨çš„æ–¹æ³•ç»‘å®šåœ¨ä¸€èµ·ã€‚å¦å¤–é€šè¿‡æºç å¯ä»¥çœ‹åˆ°valueå±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AliasFor(&quot;path&quot;)</span></span><br><span class="line">String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶æ˜¯æ•°ç»„ï¼Œå°±è¡¨ç¤ºå¯ä»¥æä¾›å¤šä¸ªè·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨SpringMVCä¸­ï¼Œå¤šä¸ªä¸åŒçš„è¯·æ±‚è·¯å¾„å¯ä»¥æ˜ å°„åŒä¸€ä¸ªæ§åˆ¶å™¨çš„åŒä¸€ä¸ªæ–¹æ³•ã€‚</p>
<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<p>1ã€ç¼–å†™æ–°çš„æ§åˆ¶å™¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestMappingTestController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &#123;&quot;/testValue1&quot;, &quot;/testValue2&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testValue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testValue&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test Value<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Test RequestMapping&#x27;s Value<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨index.htmlæ–‡ä»¶ä¸­æ·»åŠ ä¸¤ä¸ªè¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>index page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/detail&#125;&quot;</span>&gt;</span>ç”¨æˆ·è¯¦æƒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/product/detail&#125;&quot;</span>&gt;</span>å•†å“è¯¦æƒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„valueå±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testValue1&#125;&quot;</span>&gt;</span>testValue1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testValue2&#125;&quot;</span>&gt;</span>testValue2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œç‚¹å‡»åˆšåˆšæ·»åŠ çš„ä¸¤ä¸ªè¶…é“¾æ¥ï¼Œå‘é€è¯·æ±‚ï¼Œéƒ½å¯ä»¥æ­£å¸¸è®¿é—®åˆ°åŒä¸€ä¸ªæ§åˆ¶å™¨ä¸Šçš„åŒä¸€ä¸ªæ–¹æ³•ï¼ï¼</p>
<h2 id="4-2-Anté£æ ¼çš„value"><a href="#4-2-Anté£æ ¼çš„value" class="headerlink" title="4.2 Anté£æ ¼çš„value"></a>4.2 Anté£æ ¼çš„value</h2><p>valueæ˜¯å¯ä»¥ç”¨æ¥åŒ¹é…è·¯å¾„çš„ï¼Œè·¯å¾„æ”¯æŒæ¨¡ç³ŠåŒ¹é…ï¼Œæˆ‘ä»¬æŠŠè¿™ç§æ¨¡ç³ŠåŒ¹é…ç§°ä¹‹ä¸ºAnté£æ ¼ã€‚å…³äºè·¯å¾„ä¸­çš„é€šé…ç¬¦åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>?</code>ï¼šä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆé™¤ <code>/</code>ã€ <code>?</code> ä¹‹å¤–çš„å…¶å®ƒå­—ç¬¦ï¼‰<font color="red">PSï¼šä¸€å®šæ˜¯ä¸€ä¸ªå­—ç¬¦å“¦ï¼ä¸èƒ½ç©ºç€ï¼ï¼</font></li>
<li><code>*</code>ï¼šä»£è¡¨0åˆ°Nä¸ªä»»æ„å­—ç¬¦ï¼ˆé™¤ <code>/</code> ã€<code>?</code> ä¹‹å¤–çš„å…¶å®ƒå­—ç¬¦ï¼‰</li>
<li><code>**</code>ï¼šä»£è¡¨0åˆ°Nä¸ªä»»æ„å­—ç¬¦ï¼Œå¹¶ä¸”è·¯å¾„ä¸­å¯ä»¥å‡ºç°è·¯å¾„åˆ†éš”ç¬¦ <code>/</code></li>
</ul>
<p><font color="red">PSï¼š<code>**</code> é€šé…ç¬¦åœ¨ä½¿ç”¨æ—¶ï¼Œå·¦å³ä¸èƒ½å‡ºç°å­—ç¬¦ ï¼Œ<code>**</code> å·¦è¾¹åªèƒ½æ˜¯ <code>/</code></font></p>
<blockquote>
<p>æµ‹è¯• <code>?</code> é€šé…ç¬¦</p>
</blockquote>
<p>1ã€åœ¨ RequestMappingTestController ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/x?z/testValueAnt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testValueAnt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testValueAnt&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test Value Ant<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•RequestMappingæ³¨è§£çš„valueå±æ€§æ”¯æŒæ¨¡ç³ŠåŒ¹é…<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨index.htmlé¡µé¢ä¸­ç¼–å†™è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingæ³¨è§£çš„valueå±æ€§æ”¯æŒæ¨¡ç³ŠåŒ¹é…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/xyz/testValueAnt&#125;&quot;</span>&gt;</span>æµ‹è¯•valueå±æ€§çš„æ¨¡ç³ŠåŒ¹é…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E9%80%9A%E9%85%8D%E7%AC%A6.png" alt="æµ‹è¯•é€šé…ç¬¦"></p>
<p>é€šè¿‡ä¿®æ”¹æµè§ˆå™¨åœ°å€æ ä¸Šçš„è·¯å¾„ï¼Œå¯ä»¥åå¤æµ‹è¯•é€šé…ç¬¦ ? çš„è¯­æ³•ï¼š</p>
<p><a href="http://localhost:8080/springmvc/xaz/testValueAnt">http://localhost:8080/springmvc/xaz/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/x+z/testValueAnt">http://localhost:8080/springmvc/x+z/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/x:z/testValueAnt">http://localhost:8080/springmvc/x:z/testValueAnt</a></p>
<p>ä»¥ä¸Šä¸‰ç§å†™æ³•å‡è®¿é—®<strong>æˆåŠŸ</strong>ã€‚</p>
<p><a href="http://localhost:8080/springmvc/xaaz/testValueAnt">http://localhost:8080/springmvc/xaaz/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/xz/testValueAnt">http://localhost:8080/springmvc/xz/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/x?z/testValueAnt">http://localhost:8080/springmvc/x?z/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/x/z/testValueAnt">http://localhost:8080/springmvc/x/z/testValueAnt</a></p>
<p>ä»¥ä¸Šå››ç§å†™æ³•å‡è®¿é—®<strong>å¤±è´¥</strong>ã€‚</p>
<blockquote>
<p>æµ‹è¯• <code>*</code> é€šé…ç¬¦</p>
</blockquote>
<p>1ã€å°† <code>?</code> é€šé…ç¬¦ä¿®æ”¹ä¸º <code>*</code> é€šé…ç¬¦ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/x*z/testValueAnt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testValueAnt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testValueAnt&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€é‡å¯Tomcatï¼Œæ‰“å¼€æµè§ˆå™¨ç›´æ¥åœ¨åœ°å€æ ä¸Šè¾“å…¥è·¯å¾„è¿›è¡Œæµ‹è¯•ï¼š</p>
<p><a href="http://localhost:8080/springmvc/xaaz/testValueAnt">http://localhost:8080/springmvc/xaaz/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/xz/testValueAnt">http://localhost:8080/springmvc/xz/testValueAnt</a></p>
<p>ä»¥ä¸Šä¸¤ç§å†™æ³•å‡è®¿é—®<strong>æˆåŠŸ</strong>ã€‚</p>
<p><a href="http://localhost:8080/springmvc/xaa/testValueAnt">http://localhost:8080/springmvc/xaa/testValueAnt</a></p>
<p>ä»¥ä¸Šè¿™ç§å†™æ³•è®¿é—®<strong>å¤±è´¥</strong>ã€‚</p>
<blockquote>
<p>æµ‹è¯• <code>**</code> é€šé…ç¬¦</p>
</blockquote>
<p>1ã€å°† <code>*</code> é€šé…ç¬¦ä¿®æ”¹ä¸º <code>**</code> é€šé…ç¬¦ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/x**z/testValueAnt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testValueAnt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testValueAnt&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€é‡å¯Tomcatï¼Œæ‰“å¼€æµè§ˆå™¨ç›´æ¥åœ¨åœ°å€æ ä¸Šè¾“å…¥è·¯å¾„è¿›è¡Œæµ‹è¯•ï¼š</p>
<p><a href="http://localhost:8080/springmvc/xa/az/testValueAnt">http://localhost:8080/springmvc/xa/az/testValueAnt</a></p>
<p>ä»¥ä¸Šè¿™ç§å†™æ³•è®¿é—®<strong>å¤±è´¥</strong>ã€‚</p>
<p><font color="red">PSï¼š<code>/x**z/</code> å®é™…ä¸Šå¹¶æ²¡æœ‰ä½¿ç”¨é€šé…ç¬¦ <code>**</code>ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨çš„ <code>*</code>ï¼Œå› ä¸ºé€šé…ç¬¦ <code>**</code> åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå·¦å³ä¸¤è¾¹éƒ½ä¸èƒ½æœ‰ä»»ä½•å­—ç¬¦ï¼Œå¿…é¡»æ˜¯ <code>/</code></font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/**/testValueAnt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testValueAnt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testValueAnt&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨æœåŠ¡å™¨å‘ç°æŠ¥é”™äº†ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%80%9A%E9%85%8D%E7%AC%A6%E5%AF%BC%E8%87%B4%E9%A1%B9%E7%9B%AE%E6%8A%A5%E9%94%99.png" alt="é€šé…ç¬¦å¯¼è‡´é¡¹ç›®æŠ¥é”™"></p>
<p>ä»¥ä¸Šå†™æ³•åœ¨Spring5çš„æ—¶å€™æ˜¯æ”¯æŒçš„ï¼Œä½†æ˜¯åœ¨Spring6ä¸­è¿›è¡Œäº†ä¸¥æ ¼çš„è§„å®šï¼Œ<code>**</code> é€šé…ç¬¦åªèƒ½å‡ºç°åœ¨è·¯å¾„çš„æœ«å°¾ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testValueAnt/**&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testValueAnt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testValueAnt&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<p><a href="http://localhost:8080/springmvc/testValueAnt">http://localhost:8080/springmvc/testValueAnt</a></p>
<p><a href="http://localhost:8080/springmvc/testValueAnt/a/b/c/d">http://localhost:8080/springmvc/testValueAnt/a/b/c/d</a></p>
<p>ä»¥ä¸Šä¸¤ç§å†™æ³•å‡è®¿é—®<strong>æˆåŠŸ</strong>ã€‚</p>
<h2 id="4-3-valueä¸­çš„å ä½ç¬¦ï¼ˆé‡ç‚¹ï¼‰"><a href="#4-3-valueä¸­çš„å ä½ç¬¦ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="4.3 valueä¸­çš„å ä½ç¬¦ï¼ˆé‡ç‚¹ï¼‰"></a>4.3 valueä¸­çš„å ä½ç¬¦ï¼ˆé‡ç‚¹ï¼‰</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„è¯·æ±‚è·¯å¾„æ˜¯è¿™æ ·çš„æ ¼å¼ï¼š<code>url?name1=value1&amp;name2=value2&amp;name3=value3</code></p>
<p>å…¶å®é™¤äº†è¿™ç§æ–¹å¼ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æ ¼å¼çš„è¯·æ±‚è·¯å¾„ï¼Œæ ¼å¼ä¸ºï¼š<code>url/value1/value2/value3</code>ï¼Œæˆ‘ä»¬å°†è¿™æ ·çš„è¯·æ±‚è·¯å¾„å«åš <code>RESTful</code> é£æ ¼çš„è¯·æ±‚è·¯å¾„ã€‚RESTfulé£æ ¼çš„è¯·æ±‚è·¯å¾„åœ¨ç°ä»£çš„å¼€å‘ä¸­ä½¿ç”¨è¾ƒå¤šã€‚</p>
<p>æ™®é€šçš„è¯·æ±‚è·¯å¾„ï¼š<code>http://localhost:8080/springmvc/login?username=admin&amp;password=123&amp;age=20</code></p>
<p>RESTfulé£æ ¼çš„è¯·æ±‚è·¯å¾„ï¼š<code>http://localhost:8080/springmvc/login/admin/123/20</code></p>
<p>å¦‚æœä½¿ç”¨RESTfulé£æ ¼çš„è¯·æ±‚è·¯å¾„ï¼Œåœ¨æ§åˆ¶å™¨ä¸­åº”è¯¥å¦‚ä½•è·å–è¯·æ±‚ä¸­çš„æ•°æ®å‘¢ï¼Ÿ</p>
<p>å¯ä»¥åœ¨valueå±æ€§ä¸­ä½¿ç”¨å ä½ç¬¦ï¼Œä¾‹å¦‚ï¼š<code>/login/&#123;id&#125;/&#123;username&#125;/&#123;password&#125;</code></p>
<p>1ã€åœ¨ RequestMappingTestController ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testRESTful/&#123;id&#125;/&#123;username&#125;/&#123;age&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRESTful</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="meta">@PathVariable(&quot;id&quot;)</span></span></span><br><span class="line"><span class="params">    <span class="type">int</span> id,</span></span><br><span class="line"><span class="params">    <span class="meta">@PathVariable(&quot;username&quot;)</span></span></span><br><span class="line"><span class="params">    String username,</span></span><br><span class="line"><span class="params">    <span class="meta">@PathVariable(&quot;age&quot;)</span></span></span><br><span class="line"><span class="params">    <span class="type">int</span> age)</span> &#123;</span><br><span class="line">    System.out.println(id + <span class="string">&quot;,&quot;</span> + username + <span class="string">&quot;,&quot;</span> + age);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRESTful&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test RESTful<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•valueå±æ€§ä½¿ç”¨å ä½ç¬¦<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨ index.html é¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingæ³¨è§£çš„valueå±æ€§æ”¯æŒå ä½ç¬¦--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testRESTful/1/zhangsan/20&#125;&quot;</span>&gt;</span>æµ‹è¯•valueå±æ€§ä½¿ç”¨å ä½ç¬¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4ã€å¯åŠ¨æœåŠ¡å™¨æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95%E5%8D%A0%E4%BD%8D%E7%AC%A6.png" alt="æµ‹è¯•å ä½ç¬¦"></p>
<p>5ã€æŸ¥çœ‹æ§åˆ¶å°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1,zhangsan,20</span><br></pre></td></tr></table></figure>

<h1 id="5-RequestMappingæ³¨è§£çš„methodå±æ€§"><a href="#5-RequestMappingæ³¨è§£çš„methodå±æ€§" class="headerlink" title="5. RequestMappingæ³¨è§£çš„methodå±æ€§"></a>5. RequestMappingæ³¨è§£çš„methodå±æ€§</h1><h2 id="5-1-methodå±æ€§çš„ä½œç”¨"><a href="#5-1-methodå±æ€§çš„ä½œç”¨" class="headerlink" title="5.1 methodå±æ€§çš„ä½œç”¨"></a>5.1 methodå±æ€§çš„ä½œç”¨</h2><p>åœ¨Servletå½“ä¸­ï¼Œå¦‚æœåç«¯è¦æ±‚å‰ç«¯å¿…é¡»å‘é€ä¸€ä¸ª<code>post</code>è¯·æ±‚ï¼Œåç«¯å¯ä»¥é€šè¿‡é‡å†™<code>doPost</code>æ–¹æ³•æ¥å®ç°ã€‚åç«¯è¦æ±‚å‰ç«¯å¿…é¡»å‘é€ä¸€ä¸ª<code>get</code>è¯·æ±‚ï¼Œåç«¯å¯ä»¥é€šè¿‡é‡å†™<code>doGet</code>æ–¹æ³•æ¥å®ç°ã€‚å½“é‡å†™çš„æ–¹æ³•æ˜¯<code>doPost</code>æ—¶ï¼Œå‰ç«¯å°±å¿…é¡»å‘é€<code>post</code>è¯·æ±‚ï¼Œå½“é‡å†™<code>doGet</code>æ–¹æ³•æ—¶ï¼Œå‰ç«¯å°±å¿…é¡»å‘é€<code>get</code>è¯·æ±‚ã€‚å¦‚æœå‰ç«¯å‘é€è¯·æ±‚çš„æ–¹å¼å’Œåç«¯çš„å¤„ç†æ–¹å¼ä¸ä¸€è‡´æ—¶ï¼Œä¼šå‡ºç°<code>405</code>é”™è¯¯ã€‚</p>
<p><strong>HTTPçŠ¶æ€ç 405ï¼Œè¿™ç§æœºåˆ¶çš„ä½œç”¨æ˜¯ï¼šé™åˆ¶å®¢æˆ·ç«¯çš„è¯·æ±‚æ–¹å¼ï¼Œä»¥ä¿è¯æœåŠ¡å™¨ä¸­æ•°æ®çš„å®‰å…¨ã€‚</strong></p>
<p>å‡è®¾åç«¯ç¨‹åºè¦å¤„ç†çš„è¯·æ±‚æ˜¯ä¸€ä¸ªç™»å½•è¯·æ±‚ï¼Œä¸ºäº†ä¿è¯ç™»å½•æ—¶çš„ç”¨æˆ·åå’Œå¯†ç ä¸è¢«æ˜¾ç¤ºåˆ°æµè§ˆå™¨çš„åœ°å€æ ä¸Šï¼Œåç«¯ç¨‹åºæœ‰ä¹‰åŠ¡è¦æ±‚å‰ç«¯å¿…é¡»å‘é€ä¸€ä¸ª<code>post</code>è¯·æ±‚ï¼Œå¦‚æœå‰ç«¯å‘é€<code>get</code>è¯·æ±‚ï¼Œåˆ™åº”è¯¥æ‹’ç»ã€‚</p>
<p>é‚£ä¹ˆåœ¨SpringMVCæ¡†æ¶ä¸­åº”è¯¥å¦‚ä½•å®ç°è¿™ç§æœºåˆ¶å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨RequestMappingæ³¨è§£çš„<code>method</code>å±æ€§æ¥å®ç°ã€‚</p>
<p>é€šè¿‡RequestMappingæºç å¯ä»¥çœ‹åˆ°ï¼Œmethodå±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">RequestMethod[] method() <span class="keyword">default</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯ RequestMethodï¼Œè€ŒRequestMethodæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹çš„æ•°æ®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">RequestMethod</span> &#123;</span><br><span class="line">    GET,</span><br><span class="line">    HEAD,</span><br><span class="line">    POST,</span><br><span class="line">    PUT,</span><br><span class="line">    PATCH,</span><br><span class="line">    DELETE,</span><br><span class="line">    OPTIONS,</span><br><span class="line">    TRACE;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// -- skip --</span></span><br><span class="line">    </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>å› æ­¤å¦‚æœè¦æ±‚å‰ç«¯å‘é€POSTè¯·æ±‚ï¼Œè¯¥æ³¨è§£åº”è¯¥è¿™æ ·ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/login&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<p>1ã€åœ¨RequestMappingTestControllerç±»ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/login&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test Method<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Login Success!!!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨index.htmlé¡µé¢ä¸­æä¾›ä¸€ä¸ªç™»å½•çš„formè¡¨å•ï¼Œåç«¯è¦æ±‚å‘é€<code>post</code>è¯·æ±‚ï¼Œåˆ™formè¡¨å•çš„methodå±æ€§åº”è®¾ç½®ä¸º<code>post</code>ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„methodå±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%A1%A8%E5%8D%95post%E6%8F%90%E4%BA%A4.png" alt="è¡¨å•postæäº¤"></p>
<p>é€šè¿‡æµ‹è¯•ï¼Œå‰ç«¯å‘é€çš„è¯·æ±‚æ–¹å¼<code>post</code>ï¼Œåç«¯å¤„ç†è¯·æ±‚çš„æ–¹å¼ä¹Ÿæ˜¯<code>post</code>ï¼Œå°±ä¸ä¼šæœ‰é—®é¢˜ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœåç«¯è¦æ±‚å‰ç«¯å¿…é¡»å‘é€<code>post</code>è¯·æ±‚ï¼Œè€Œå‰ç«¯å‘é€äº†<code>get</code>è¯·æ±‚ï¼Œåˆ™ä¼šå‡ºç°<code>405</code>é”™è¯¯ï¼Œå°†index.htmlä¸­formè¡¨å•æäº¤æ–¹å¼ä¿®æ”¹ä¸º<code>get</code>ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„methodå±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line">&lt;/form</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%A1%A8%E5%8D%95get%E6%8F%90%E4%BA%A4.png" alt="è¡¨å•getæäº¤"></p>
<p><strong>å› æ­¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå¯¹äºRequestMappingæ³¨è§£æ¥è¯´ï¼Œå¤šä¸€ä¸ªå±æ€§ï¼Œå°±ç›¸å½“äºå¤šäº†ä¸€ä¸ªæ˜ å°„çš„æ¡ä»¶ï¼Œå¦‚æœ<code>value</code>å’Œ<code>method</code>å±æ€§éƒ½æœ‰ï¼Œåˆ™è¡¨ç¤ºåªæœ‰å‰ç«¯å‘é€çš„<code>è¯·æ±‚è·¯å¾„ + è¯·æ±‚æ–¹å¼</code>éƒ½æ»¡è¶³æ—¶æ‰èƒ½ä¸æ§åˆ¶å™¨ä¸Šçš„æ–¹æ³•å»ºç«‹æ˜ å°„å…³ç³»ï¼Œåªè¦æœ‰ä¸€ä¸ªä¸æ»¡è¶³ï¼Œåˆ™æ— æ³•å»ºç«‹æ˜ å°„å…³ç³»ã€‚</strong></p>
<p>ä¾‹å¦‚ï¼š<code>@RequestMapping(value=&quot;/login&quot;, method = RequestMethod.POST)</code> è¡¨ç¤ºå½“å‰ç«¯å‘é€çš„è¯·æ±‚è·¯å¾„æ˜¯ <code>/login</code>ï¼Œå¹¶ä¸”å‘é€è¯·æ±‚çš„æ–¹å¼æ˜¯<code>POST</code>çš„æ—¶å€™æ‰ä¼šå»ºç«‹æ˜ å°„å…³ç³»ã€‚å¦‚æœå‰ç«¯å‘é€çš„æ˜¯<code>get</code>è¯·æ±‚ï¼Œæˆ–è€…å‰ç«¯å‘é€çš„è¯·æ±‚è·¯å¾„ä¸æ˜¯ <code>/login</code>ï¼Œåˆ™éƒ½æ˜¯æ— æ³•å»ºç«‹æ˜ å°„çš„ã€‚</p>
<h2 id="5-2-è¡ç”ŸMapping"><a href="#5-2-è¡ç”ŸMapping" class="headerlink" title="5.2 è¡ç”ŸMapping"></a>5.2 è¡ç”ŸMapping</h2><p>å¯¹äºä»¥ä¸Šçš„ç¨‹åºæ¥è¯´ï¼ŒSpringMVCæä¾›äº†å¦ä¸€ä¸ªæ³¨è§£ï¼Œä½¿ç”¨è¿™ä¸ªæ³¨è§£æ›´åŠ çš„æ–¹ä¾¿ï¼Œå®ƒå°±æ˜¯ï¼š<code>@PostMapping</code></p>
<p>ä½¿ç”¨è¯¥æ³¨è§£æ—¶ï¼Œä¸éœ€è¦æŒ‡å®šmethodå±æ€§ï¼Œå› ä¸ºå®ƒé»˜è®¤é‡‡ç”¨çš„å°±æ˜¯<code>POST</code>å¤„ç†æ–¹å¼ï¼š</p>
<p>ä¿®æ”¹RequestMappingTestControllerä»£ç å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@RequestMapping(value=&quot;/login&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMethod</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“å‰ç«¯å‘é€<code>get</code>è¯·æ±‚æ—¶ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%A1%A8%E5%8D%95get%E6%8F%90%E4%BA%A4.png" alt="è¡¨å•getæäº¤"></p>
<p>å½“å‰ç«¯å‘é€<code>post</code>è¯·æ±‚æ—¶ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%A1%A8%E5%8D%95post%E6%8F%90%E4%BA%A4.png" alt="è¡¨å•postæäº¤"></p>
<p>åœ¨SpringMVCä¸­ä¸ä»…æä¾›äº† <code>@PostMaping</code> æ³¨è§£ï¼Œåƒè¿™æ ·çš„æ³¨è§£è¿˜æœ‰å››ä¸ªï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>@GetMapping</code>ï¼šè¦æ±‚å‰ç«¯å¿…é¡»å‘é€<code>get</code>è¯·æ±‚</li>
<li><code>@PutMapping</code>ï¼šè¦æ±‚å‰ç«¯å¿…é¡»å‘é€<code>put</code>è¯·æ±‚</li>
<li><code>@DeleteMapping</code>ï¼šè¦æ±‚å‰ç«¯å¿…é¡»å‘é€<code>delete</code>è¯·æ±‚</li>
<li><code>@PatchMapping</code>ï¼šè¦æ±‚å‰ç«¯å¿…é¡»å‘é€<code>patch</code>è¯·æ±‚</li>
</ul>
<h2 id="5-3-webçš„è¯·æ±‚æ–¹å¼"><a href="#5-3-webçš„è¯·æ±‚æ–¹å¼" class="headerlink" title="5.3 webçš„è¯·æ±‚æ–¹å¼"></a>5.3 webçš„è¯·æ±‚æ–¹å¼</h2><p>å‰ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ–¹å¼åŒ…æ‹¬å“ªäº›ï¼Ÿå…±9ç§ï¼Œå‰5ç§å¸¸ç”¨ï¼Œåé¢ä½œä¸ºäº†è§£ï¼š</p>
<ul>
<li><strong>GET</strong>ï¼šè·å–èµ„æºï¼Œåªå…è®¸è¯»å–æ•°æ®ï¼Œä¸å½±å“æ•°æ®çš„çŠ¶æ€å’ŒåŠŸèƒ½ã€‚ä½¿ç”¨ URL ä¸­ä¼ é€’å‚æ•°æˆ–è€…åœ¨ HTTP è¯·æ±‚çš„å¤´éƒ¨ä½¿ç”¨å‚æ•°ï¼ŒæœåŠ¡å™¨è¿”å›è¯·æ±‚çš„èµ„æºã€‚</li>
<li><strong>POST</strong>ï¼šå‘æœåŠ¡å™¨æäº¤èµ„æºï¼Œå¯èƒ½è¿˜ä¼šæ”¹å˜æ•°æ®çš„çŠ¶æ€å’ŒåŠŸèƒ½ã€‚é€šè¿‡è¡¨å•ç­‰æ–¹å¼æäº¤è¯·æ±‚ä½“ï¼ŒæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ä½“åï¼Œè¿›è¡Œæ•°æ®å¤„ç†ã€‚</li>
<li><strong>PUT</strong>ï¼šæ›´æ–°èµ„æºï¼Œç”¨äºæ›´æ–°æŒ‡å®šçš„èµ„æºä¸Šæ‰€æœ‰å¯ç¼–è¾‘å†…å®¹ã€‚é€šè¿‡è¯·æ±‚ä½“å‘é€éœ€è¦è¢«æ›´æ–°çš„å…¨éƒ¨å†…å®¹ï¼ŒæœåŠ¡å™¨æ¥æ”¶æ•°æ®åï¼Œå°†è¢«æ›´æ–°çš„èµ„æºè¿›è¡Œæ›¿æ¢æˆ–ä¿®æ”¹ã€‚</li>
<li><strong>DELETE</strong>ï¼šåˆ é™¤èµ„æºï¼Œç”¨äºåˆ é™¤æŒ‡å®šçš„èµ„æºã€‚å°†è¦è¢«åˆ é™¤çš„èµ„æºæ ‡è¯†ç¬¦æ”¾åœ¨ URL ä¸­æˆ–è¯·æ±‚ä½“ä¸­ã€‚</li>
<li><strong>HEAD</strong>ï¼šè¯·æ±‚æœåŠ¡å™¨è¿”å›èµ„æºçš„å¤´éƒ¨ï¼Œä¸ GET å‘½ä»¤ç±»ä¼¼ï¼Œä½†æ˜¯æ‰€æœ‰è¿”å›çš„ä¿¡æ¯éƒ½æ˜¯å¤´éƒ¨ä¿¡æ¯ï¼Œä¸èƒ½åŒ…å«æ•°æ®ä½“ã€‚ä¸»è¦ç”¨äºèµ„æºæ£€æµ‹å’Œç¼“å­˜æ§åˆ¶ã€‚</li>
<li>PATCHï¼šéƒ¨åˆ†æ›´æ”¹è¯·æ±‚ã€‚å½“è¢«è¯·æ±‚çš„èµ„æºæ˜¯å¯è¢«æ›´æ”¹çš„èµ„æºæ—¶ï¼Œè¯·æ±‚æœåŠ¡å™¨å¯¹è¯¥èµ„æºè¿›è¡Œéƒ¨åˆ†æ›´æ–°ï¼Œå³æ¯æ¬¡æ›´æ–°ä¸€éƒ¨åˆ†ã€‚</li>
<li>OPTIONSï¼šè¯·æ±‚è·å¾—æœåŠ¡å™¨æ”¯æŒçš„è¯·æ±‚æ–¹æ³•ç±»å‹ï¼Œä»¥åŠæ”¯æŒçš„è¯·æ±‚å¤´æ ‡å¿—ã€‚â€œOPTIONS *â€åˆ™è¿”å›æ”¯æŒå…¨éƒ¨æ–¹æ³•ç±»å‹çš„æœåŠ¡å™¨æ ‡å¿—ã€‚</li>
<li>TRACEï¼šæœåŠ¡å™¨å“åº”è¾“å‡ºå®¢æˆ·ç«¯çš„ HTTP è¯·æ±‚ï¼Œä¸»è¦ç”¨äºè°ƒè¯•å’Œæµ‹è¯•ã€‚</li>
<li>CONNECTï¼šå»ºç«‹ç½‘ç»œè¿æ¥ï¼Œé€šå¸¸ç”¨äºåŠ å¯† SSL&#x2F;TLS è¿æ¥ã€‚</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨è¶…é“¾æ¥ä»¥åŠåŸç”Ÿçš„formè¡¨å•åªèƒ½æäº¤getå’Œpostè¯·æ±‚ï¼Œputã€deleteã€headè¯·æ±‚å¯ä»¥ä½¿ç”¨å‘é€ajaxè¯·æ±‚çš„æ–¹å¼æ¥å®ç°ã€‚</li>
<li>ä½¿ç”¨è¶…é“¾æ¥å‘é€çš„æ˜¯getè¯·æ±‚</li>
<li>ä½¿ç”¨formè¡¨å•ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®methodï¼Œå‘é€getè¯·æ±‚</li>
<li>ä½¿ç”¨formè¡¨å•ï¼Œè®¾ç½®method&#x3D;â€getâ€ï¼Œå‘é€getè¯·æ±‚</li>
<li>ä½¿ç”¨formè¡¨å•ï¼Œè®¾ç½®method&#x3D;â€postâ€ï¼Œå‘é€postè¯·æ±‚</li>
<li><strong>ä½¿ç”¨formè¡¨å•ï¼Œè®¾ç½®method&#x3D;â€put&#x2F;delete&#x2F;headâ€ï¼Œå‘é€getè¯·æ±‚ã€‚ï¼ˆé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼‰</strong></li>
</ul>
<p>å°†index.htmlä¸­ç™»å½•è¡¨å•çš„æäº¤æ–¹å¼methodè®¾ç½®ä¸º<code>put</code>ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„methodå±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;put&quot;</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹RequestMappingTestControllerç±»çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;/login&quot;, method = RequestMethod.PUT)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMethod</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E8%A1%A8%E5%8D%95put%E6%8F%90%E4%BA%A4.png" alt="è¡¨å•putæäº¤"></p>
<p>é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œå³ä½¿formä¸­methodè®¾ç½®ä¸º<code>put</code>æ–¹å¼ï¼Œä½†ä»ç„¶é‡‡ç”¨<code>get</code>æ–¹å¼å‘é€è¯·æ±‚ã€‚</p>
<p>å†æ¬¡ä¿®æ”¹RequestMappingTestControllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;/login&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMethod</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E9%87%87%E7%94%A8get%E6%96%B9%E5%BC%8F%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82.png" alt="é‡‡ç”¨getæ–¹å¼å‘é€è¯·æ±‚"></p>
<h2 id="5-4-GETå’ŒPOSTçš„åŒºåˆ«"><a href="#5-4-GETå’ŒPOSTçš„åŒºåˆ«" class="headerlink" title="5.4 GETå’ŒPOSTçš„åŒºåˆ«"></a>5.4 GETå’ŒPOSTçš„åŒºåˆ«</h2><p>HTTPè¯·æ±‚åè®®ä¹‹<code>GET</code>è¯·æ±‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /springmvc/login?username=lucy&amp;userpwd=1111 HTTP/1.1                           è¯·æ±‚è¡Œ</span><br><span class="line">Host: localhost:8080                                                                    è¯·æ±‚å¤´</span><br><span class="line">Connection: keep-alive</span><br><span class="line">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;95&quot;, &quot;Chromium&quot;;v=&quot;95&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:8080/springmvc/index.html</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">                                                                                        ç©ºç™½è¡Œ</span><br><span class="line">                                                                                        è¯·æ±‚ä½“</span><br></pre></td></tr></table></figure>
<p>HTTPè¯·æ±‚åè®®ä¹‹<code>POST</code>è¯·æ±‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /springmvc/login HTTP/1.1                                                  è¯·æ±‚è¡Œ</span><br><span class="line">Host: localhost:8080                                                                  è¯·æ±‚å¤´</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 25</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;95&quot;, &quot;Chromium&quot;;v=&quot;95&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://localhost:8080</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:8080/springmvc/index.html</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">                                                                                      ç©ºç™½è¡Œ</span><br><span class="line">username=lisi&amp;userpwd=123                                                             è¯·æ±‚ä½“</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<ul>
<li>getè¯·æ±‚å‘é€æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®ä¼šæŒ‚åœ¨URIçš„åé¢ï¼Œå¹¶ä¸”åœ¨URIåé¢æ·»åŠ ä¸€ä¸ª <code>?</code>ï¼Œ<code>?</code> åé¢æ˜¯æ•°æ®ã€‚è¿™æ ·ä¼šå¯¼è‡´å‘é€çš„æ•°æ®å›æ˜¾åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸Šã€‚<code>http://localhost:8080/springmvc/login?username=zhangsan&amp;userpwd=1111</code></li>
<li>postè¯·æ±‚å‘é€æ•°æ®çš„æ—¶å€™ï¼Œåœ¨è¯·æ±‚ä½“å½“ä¸­å‘é€ã€‚ä¸ä¼šå›æ˜¾åˆ°æµè§ˆå™¨çš„åœ°å€æ ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´postå‘é€çš„æ•°æ®ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ ä¸Šçœ‹ä¸åˆ°ã€‚</li>
<li>getè¯·æ±‚åªèƒ½å‘é€æ™®é€šçš„å­—ç¬¦ä¸²ã€‚å¹¶ä¸”å‘é€çš„å­—ç¬¦ä¸²é•¿åº¦æœ‰é™åˆ¶ï¼Œä¸åŒçš„æµè§ˆå™¨é™åˆ¶ä¸åŒã€‚è¿™ä¸ªæ²¡æœ‰æ˜ç¡®çš„è§„èŒƒã€‚getè¯·æ±‚æ— æ³•å‘é€å¤§æ•°æ®é‡ã€‚</li>
<li>postè¯·æ±‚å¯ä»¥å‘é€ä»»ä½•ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ™®é€šå­—ç¬¦ä¸²ï¼Œæµåª’ä½“ç­‰ä¿¡æ¯ï¼šè§†é¢‘ã€å£°éŸ³ã€å›¾ç‰‡ã€‚postè¯·æ±‚å¯ä»¥å‘é€å¤§æ•°æ®é‡ï¼Œç†è®ºä¸Šæ²¡æœ‰é•¿åº¦é™åˆ¶ã€‚</li>
<li>getè¯·æ±‚åœ¨W3Cä¸­æ˜¯è¿™æ ·è¯´çš„ï¼šgetè¯·æ±‚æ¯”è¾ƒé€‚åˆä»æœåŠ¡å™¨ç«¯è·å–æ•°æ®ã€‚</li>
<li>postè¯·æ±‚åœ¨W3Cä¸­æ˜¯è¿™æ ·è¯´çš„ï¼špostè¯·æ±‚æ¯”è¾ƒé€‚åˆå‘æœåŠ¡å™¨ç«¯ä¼ é€æ•°æ®ã€‚</li>
<li>getè¯·æ±‚æ˜¯å®‰å…¨çš„ã€‚å› ä¸ºåœ¨æ­£ç¡®ä½¿ç”¨getè¯·æ±‚çš„å‰æä¸‹ï¼Œgetè¯·æ±‚åªæ˜¯ä¸ºäº†ä»æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</li>
<li>postè¯·æ±‚æ˜¯å±é™©çš„ã€‚å› ä¸ºpostè¯·æ±‚æ˜¯ä¿®æ”¹æœåŠ¡å™¨ç«¯çš„èµ„æºã€‚</li>
<li>getè¯·æ±‚æ”¯æŒç¼“å­˜ã€‚ ä¹Ÿå°±æ˜¯è¯´å½“ç¬¬äºŒæ¬¡å‘é€getè¯·æ±‚æ—¶ï¼Œä¼šèµ°æµè§ˆå™¨ä¸Šæ¬¡çš„ç¼“å­˜ç»“æœï¼Œä¸å†çœŸæ­£çš„è¯·æ±‚æœåŠ¡å™¨ã€‚ï¼ˆæœ‰æ—¶éœ€è¦é¿å…ï¼Œæ€ä¹ˆé¿å…ï¼šåœ¨getè¯·æ±‚è·¯å¾„åæ·»åŠ æ—¶é—´æˆ³ï¼‰</li>
<li>postè¯·æ±‚ä¸æ”¯æŒç¼“å­˜ã€‚æ¯ä¸€æ¬¡å‘é€postè¯·æ±‚éƒ½ä¼šçœŸæ­£çš„èµ°æœåŠ¡å™¨ã€‚</li>
</ul>
<blockquote>
<p>æ€ä¹ˆé€‰æ‹©ï¼Ÿ</p>
</blockquote>
<ul>
<li>å¦‚æœä½ æ˜¯æƒ³ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æºï¼Œå»ºè®®ä½¿ç”¨GETè¯·æ±‚ï¼Œå¦‚æœä½ è¿™ä¸ªè¯·æ±‚æ˜¯ä¸ºäº†å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨POSTè¯·æ±‚ã€‚</li>
<li>å¤§éƒ¨åˆ†çš„formè¡¨å•æäº¤ï¼Œéƒ½æ˜¯postæ–¹å¼ï¼Œå› ä¸ºformè¡¨å•ä¸­è¦å¡«å†™å¤§é‡çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯æ”¶é›†ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯éœ€è¦ä¼ ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†è¿™äº›æ•°æ®ä¿å­˜&#x2F;ä¿®æ”¹ç­‰ã€‚</li>
<li>å¦‚æœè¡¨å•ä¸­æœ‰æ•æ„Ÿä¿¡æ¯ï¼Œå»ºè®®ä½¿ç”¨postè¯·æ±‚ï¼Œå› ä¸ºgetè¯·æ±‚ä¼šå›æ˜¾æ•æ„Ÿä¿¡æ¯åˆ°æµè§ˆå™¨åœ°å€æ ä¸Šã€‚ï¼ˆä¾‹å¦‚ï¼šå¯†ç ä¿¡æ¯ï¼‰</li>
<li>åšæ–‡ä»¶ä¸Šä¼ ï¼Œä¸€å®šæ˜¯postè¯·æ±‚ã€‚è¦ä¼ çš„æ•°æ®ä¸æ˜¯æ™®é€šæ–‡æœ¬ã€‚</li>
<li>å…¶ä»–æƒ…å†µå¤§éƒ¨åˆ†éƒ½æ˜¯ä½¿ç”¨getè¯·æ±‚ã€‚</li>
</ul>
<h1 id="6-RequestMappingæ³¨è§£çš„paramså±æ€§"><a href="#6-RequestMappingæ³¨è§£çš„paramså±æ€§" class="headerlink" title="6. RequestMappingæ³¨è§£çš„paramså±æ€§"></a>6. RequestMappingæ³¨è§£çš„paramså±æ€§</h1><h2 id="6-1-paramså±æ€§çš„ç†è§£"><a href="#6-1-paramså±æ€§çš„ç†è§£" class="headerlink" title="6.1 paramså±æ€§çš„ç†è§£"></a>6.1 paramså±æ€§çš„ç†è§£</h2><p><code>params</code>å±æ€§ç”¨æ¥è®¾ç½®é€šè¿‡è¯·æ±‚å‚æ•°æ¥æ˜ å°„è¯·æ±‚ã€‚</p>
<p>å¯¹äºRequestMappingæ³¨è§£æ¥è¯´ï¼š</p>
<ul>
<li>valueå±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªè¦æ»¡è¶³æ•°ç»„ä¸­çš„ä»»æ„ä¸€ä¸ªè·¯å¾„ï¼Œå°±èƒ½æ˜ å°„æˆåŠŸ</li>
<li>methodå±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªè¦æ»¡è¶³æ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªè¯·æ±‚æ–¹å¼ï¼Œå°±èƒ½æ˜ å°„æˆåŠŸã€‚</li>
<li><strong>paramså±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸è¿‡è¦æ±‚è¯·æ±‚å‚æ•°å¿…é¡»å’Œparamsæ•°ç»„ä¸­è¦æ±‚çš„æ‰€æœ‰å‚æ•°å®Œå…¨ä¸€è‡´åï¼Œæ‰èƒ½æ˜ å°„æˆåŠŸã€‚</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] params() <span class="keyword">default</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-paramså±æ€§çš„4ç§ç”¨æ³•"><a href="#6-2-paramså±æ€§çš„4ç§ç”¨æ³•" class="headerlink" title="6.2 paramså±æ€§çš„4ç§ç”¨æ³•"></a>6.2 paramså±æ€§çš„4ç§ç”¨æ³•</h2><ul>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, params&#x3D;{<strong>â€œusernameâ€</strong>, â€œpasswordâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å‚æ•°ä¸­å¿…é¡»åŒ…å« username å’Œ passwordï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, params&#x3D;{<strong>â€œ!usernameâ€</strong>, â€œpasswordâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å‚æ•°ä¸­ä¸èƒ½åŒ…å«usernameå‚æ•°ï¼Œä½†å¿…é¡»åŒ…å«passwordå‚æ•°ï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, params&#x3D;{<strong>â€œusername&#x3D;adminâ€</strong>, â€œpasswordâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å‚æ•°ä¸­å¿…é¡»åŒ…å«usernameå‚æ•°ï¼Œå¹¶ä¸”å‚æ•°çš„å€¼å¿…é¡»æ˜¯adminï¼Œå¦å¤–ä¹Ÿå¿…é¡»åŒ…å«passwordå‚æ•°ï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, params&#x3D;{<strong>â€œusername!&#x3D;adminâ€</strong>, â€œpasswordâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å‚æ•°ä¸­å¿…é¡»åŒ…å«usernameå‚æ•°ï¼Œä½†å‚æ•°çš„å€¼ä¸èƒ½æ˜¯adminï¼Œå¦å¤–ä¹Ÿå¿…é¡»åŒ…å«passwordå‚æ•°ï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
</ul>
<p><font color="red">PSï¼šå¦‚æœå‰ç«¯æäº¤çš„å‚æ•°ï¼Œå’Œåç«¯è¦æ±‚çš„è¯·æ±‚å‚æ•°ä¸ä¸€è‡´ï¼Œåˆ™å‡ºç°<code>400</code>é”™è¯¯ï¼ï¼ï¼</font></p>
<p><font color="red"><strong>HTTPçŠ¶æ€ç 400çš„åŸå› ï¼šè¯·æ±‚å‚æ•°æ ¼å¼ä¸æ­£ç¡®</strong></font>ğŸ˜†</p>
<h2 id="6-3-æµ‹è¯•paramså±æ€§"><a href="#6-3-æµ‹è¯•paramså±æ€§" class="headerlink" title="6.3 æµ‹è¯•paramså±æ€§"></a>6.3 æµ‹è¯•paramså±æ€§</h2><p>1ã€åœ¨ RequestMappingTestController ç±»ä¸­æ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testParams&quot;, params = &#123;&quot;username&quot;, &quot;password&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParams</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testParams&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>testParams<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•RequestMappingæ³¨è§£çš„Paramså±æ€§<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨index.htmlæ–‡ä»¶ä¸­æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„paramså±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParams(username=&#x27;admin&#x27;,password=&#x27;123&#x27;)&#125;&quot;</span>&gt;</span>æµ‹è¯•paramså±æ€§<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼šè¿™æ ·å†™IDEAä¼šæŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨ã€‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParams?username=admin&amp;password=123&#125;&quot;</span>&gt;</span>æµ‹è¯•paramså±æ€§<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95params%E5%B1%9E%E6%80%A7.png" alt="æµ‹è¯•paramså±æ€§"></p>
<p>å‡å¦‚å‘é€è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰ä¼ é€’usernameå‚æ•°ä¼šæ€æ ·ï¼Ÿ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParams(password=&#x27;123&#x27;)&#125;&quot;</span>&gt;</span>æµ‹è¯•paramså±æ€§<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9C%AA%E4%BC%A0%E9%80%92username%E5%8F%82%E6%95%B0.png" alt="æœªä¼ é€’usernameå‚æ•°"></p>
<p>æç¤ºæ— æ•ˆçš„è¯·æ±‚å‚æ•°ï¼ŒæœåŠ¡å™¨æ— æ³•æˆ–ä¸ä¼šå¤„ç†å½“å‰è¯·æ±‚ã€‚</p>
<p>paramså±æ€§å‰©ä¸‹çš„ä¸‰ç§æƒ…å†µï¼Œè‡ªè¡Œæµ‹è¯•ï¼ï¼ï¼ï¼</p>
<h1 id="7-RequestMappingæ³¨è§£çš„headerså±æ€§"><a href="#7-RequestMappingæ³¨è§£çš„headerså±æ€§" class="headerlink" title="7. RequestMappingæ³¨è§£çš„headerså±æ€§"></a>7. RequestMappingæ³¨è§£çš„headerså±æ€§</h1><h2 id="7-1-è®¤è¯†headerså±æ€§"><a href="#7-1-è®¤è¯†headerså±æ€§" class="headerlink" title="7.1 è®¤è¯†headerså±æ€§"></a>7.1 è®¤è¯†headerså±æ€§</h2><p><code>headers</code>å’Œ<code>params</code>åŸç†ç›¸åŒï¼Œç”¨æ³•ä¹Ÿç›¸åŒã€‚</p>
<p>å½“å‰ç«¯æäº¤çš„è¯·æ±‚å¤´ä¿¡æ¯å’Œåç«¯è¦æ±‚çš„è¯·æ±‚å¤´ä¿¡æ¯ä¸€è‡´æ—¶ï¼Œæ‰èƒ½æ˜ å°„æˆåŠŸã€‚</p>
<p>è¯·æ±‚å¤´ä¿¡æ¯æ€ä¹ˆæŸ¥çœ‹ï¼Ÿ</p>
<p>åœ¨æµè§ˆå™¨ä¸­ï¼ŒF12æ‰“å¼€æ§åˆ¶å°ï¼Œæ‰¾åˆ°Networkï¼Œå¯ä»¥æŸ¥çœ‹å…·ä½“çš„è¯·æ±‚åè®®å’Œå“åº”åè®®ã€‚åœ¨è¯·æ±‚åè®®ä¸­å¯ä»¥çœ‹åˆ°è¯·æ±‚å¤´ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E5%A4%B4%E4%BF%A1%E6%81%AF.png" alt="æŸ¥çœ‹è¯·æ±‚å¤´ä¿¡æ¯"></p>
<p>è¯·æ±‚å¤´ä¿¡æ¯å’Œè¯·æ±‚å‚æ•°ä¿¡æ¯ä¸€æ ·ï¼Œéƒ½æ˜¯é”®å€¼å¯¹å½¢å¼ï¼Œä¾‹å¦‚ä¸Šå›¾ä¸­ï¼š</p>
<ul>
<li><code>Referer: http://localhost:8080/springmvc/</code>     é”®æ˜¯<code>Referer</code>ï¼Œå€¼æ˜¯<code>http://localhost:8080/springmvc/</code></li>
<li><code>Host: localhost:8080</code>     é”®æ˜¯<code>Host</code>ï¼Œå€¼æ˜¯<code>localhost:8080</code></li>
</ul>
<h2 id="7-2-headerså±æ€§çš„4ç§ç”¨æ³•"><a href="#7-2-headerså±æ€§çš„4ç§ç”¨æ³•" class="headerlink" title="7.2 headerså±æ€§çš„4ç§ç”¨æ³•"></a>7.2 headerså±æ€§çš„4ç§ç”¨æ³•</h2><ul>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, headers&#x3D;{<strong>â€œRefererâ€</strong>, â€œHostâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å¤´ä¿¡æ¯ä¸­å¿…é¡»åŒ…å«Refererå’ŒHostï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, headers&#x3D;{<strong>â€œRefererâ€</strong>, â€œ!Hostâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å¤´ä¿¡æ¯ä¸­å¿…é¡»åŒ…å«Refererï¼Œä½†ä¸åŒ…å«Hostï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, headers&#x3D;{<strong>â€œReferer&#x3D;<a href="http://localhost:8080/springmvc/">http://localhost:8080/springmvc/</a>â€œ</strong>, â€œHostâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å¤´ä¿¡æ¯ä¸­å¿…é¡»åŒ…å«Refererå’ŒHostï¼Œå¹¶ä¸”Refererçš„å€¼<strong>å¿…é¡»æ˜¯</strong><code>http://localhost:8080/springmvc/</code>ï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
<li>@RequestMapping(value&#x3D;â€&#x2F;loginâ€, headers&#x3D;{<strong>â€œReferer!&#x3D;<a href="http://localhost:8080/springmvc/">http://localhost:8080/springmvc/</a>â€œ</strong>, â€œHostâ€}) è¡¨ç¤ºï¼šè¯·æ±‚å¤´ä¿¡æ¯ä¸­å¿…é¡»åŒ…å«Refererå’ŒHostï¼Œå¹¶ä¸”Refererçš„å€¼<strong>ä¸æ˜¯</strong><code>http://localhost:8080/springmvc/</code>ï¼Œæ‰èƒ½ä¸å½“å‰æ ‡æ³¨çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ã€‚</li>
</ul>
<p>PSï¼šå¦‚æœå‰ç«¯æäº¤çš„è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå’Œåç«¯è¦æ±‚çš„è¯·æ±‚å¤´ä¿¡æ¯ä¸ä¸€è‡´ï¼Œåˆ™å‡ºç°404é”™è¯¯ï¼ï¼ï¼</p>
<h2 id="7-3-æµ‹è¯•headerså±æ€§"><a href="#7-3-æµ‹è¯•headerså±æ€§" class="headerlink" title="7.3 æµ‹è¯•headerså±æ€§"></a>7.3 æµ‹è¯•headerså±æ€§</h2><p>1ã€åœ¨ RequestMappingTestController ç±»ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testHeaders&quot;, headers = &#123;&quot;Referer=http://localhost:8080/springmvc/&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testHeaders</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æä¾›è§†å›¾é¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test Headers<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•RequestMappingæ³¨è§£çš„headerså±æ€§<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€åœ¨index.htmlé¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æµ‹è¯•RequestMappingçš„headerså±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testHeaders&#125;&quot;</span>&gt;</span>æµ‹è¯•headerså±æ€§<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•ç»“æœï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/%E6%B5%8B%E8%AF%95headers%E5%B1%9E%E6%80%A7.png" alt="æµ‹è¯•headerså±æ€§"></p>
<p>å°†åç«¯æ§åˆ¶å™¨ä¸­çš„headerså±æ€§å€¼è¿›è¡Œä¿®æ”¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;/testHeaders&quot;, headers = &#123;&quot;Referer=http://localhost:8888/springmvc/&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testHeaders</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æµ‹è¯•ï¼š</p>
<p><img src="https://muyoukule-blog-pics.oss-cn-chengdu.aliyuncs.com/SSMIMG/SpringMVC/headers%E9%94%AE%E5%80%BC%E5%AF%B9%E4%B8%8D%E5%8C%B9%E9%85%8D.png" alt="headersé”®å€¼å¯¹ä¸åŒ¹é…"></p>
<p>å…¶ä»–æƒ…å†µè‡ªè¡Œæµ‹è¯•ï¼ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>Java</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
</search>
